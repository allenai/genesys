{
    "title": "Faster Causal Attention Over Large Sequences Through Sparse Flash Attention",
    "acronym": "sfa",
    "s2id": "d203c764fb5dec2b053be667c8b06e516ea6ef10",
    "abstract": "Transformer-based language models have found many diverse applications requiring them to process sequences of increasing length. For these applications, the causal self-attention -- which is the only component scaling quadratically w.r.t. the sequence length -- becomes a central concern. While many works have proposed schemes to sparsify the attention patterns and reduce the computational overhead of self-attention, those are often limited by implementations concerns and end up imposing a simple and static structure over the attention matrix. Conversely, implementing more dynamic sparse attentions often results in runtimes significantly slower than computing the full attention using the Flash implementation from Dao et al. (2022). We extend FlashAttention to accommodate a large class of attention sparsity patterns that, in particular, encompass key/query dropping and hashing-based attention. This leads to implementations with no computational complexity overhead and a multi-fold runtime speedup on top of FlashAttention. Even with relatively low degrees of sparsity, our method improves visibly upon FlashAttention as the sequence length increases. Without sacrificing perplexity, we increase the training speed of a transformer language model by $2.0\\times$ and $3.3\\times$ for sequences of respectively $8k$ and $16k$ tokens.",
    "venue": "arXiv.org",
    "year": 2023,
    "tldr": "This work extends FlashAttention to accommodate a large class of attention sparsity patterns that, in particular, encompass key/query dropping and hashing-based attention, leading to implementations with no computational complexity overhead and a multi-fold runtime speedup on top of FlashAtt attention.",
    "citationCount": 11,
    "influentialCitationCount": 0,
    "seed_ids": [
        "flashattn",
        "cosformer",
        "rfa",
        "bigbird",
        "lineartransformer",
        "longformer",
        "reformer",
        "sparsetransformer",
        "transformer",
        "gpt2"
    ],
    "code": null
}