{"paperId": "60fd96130d83b6e973768adb7d132753bab46a3d", "abstract": "It is a well-known fact that nonconvex optimization is computationally intractable in the worst case. As a result, theoretical analysis of optimization algorithms such as gradient descent often focuses on local convergence to stationary points where the gradient norm is zero or negligible. In this work, we examine the disconnect between the existing theoretical analysis of gradient-based algorithms and actual practice. Speci\ufb01cally, we provide numerical evidence that in large-scale neural network training, such as in ImageNet, ResNet, and WT103 + TransformerXL models, the Neural Network weight variables do not converge to stationary points where the gradient of the loss function vanishes. Remarkably, however, we observe that while weights do not converge to stationary points, the value of the loss function converges. Inspired by this observation, we propose a new perspective based on ergodic theory of dynamical systems. We prove convergence of the distribution of weight values to an approximate invariant measure (without smoothness and assumptions) that explains how the training loss can stabilize without weights necessarily converging to stationary points. We further discuss how this perspective can better align the theory with empirical observations.", "venue": "arXiv.org", "year": 2021, "citationCount": 2, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work examines the disconnect between the existing theoretical analysis of gradient-based algorithms and actual practice, and proposes a new perspective based on ergodic theory of dynamical systems that explains how the training loss can stabilize without weights necessarily converging to stationary points."}, "embedding": {"model": "specter_v2", "vector": [-0.005553431808948517, 0.5628179311752319, -0.6984416246414185, 0.455436110496521, -0.26150938868522644, 0.32612061500549316, 0.14679573476314545, -0.8720422983169556, -0.6929864287376404, 0.11742059886455536, 0.18709489703178406, 0.032173655927181244, 0.1987799108028412, 0.17078323662281036, -0.3215200901031494, -0.558191180229187, -1.2062970399856567, -0.04848235845565796, -0.04665803909301758, -0.06668675690889359, -0.6244856715202332, -0.885654091835022, -0.7461923956871033, -0.25410810112953186, 0.23467929661273956, 0.9436789751052856, -0.1666324883699417, 0.7719541788101196, -0.17338743805885315, 0.4021275043487549, 0.6181527972221375, -0.42027392983436584, 0.9500418901443481, 0.18966145813465118, -0.3524363338947296, 0.018399948254227638, 0.148910790681839, -0.4434655010700226, -0.8144644498825073, 1.1665104627609253, -0.2564038038253784, 0.38928547501564026, 0.3885613977909088, -1.0707385540008545, 0.33888375759124756, 0.2182944416999817, 0.3709949851036072, 0.770835280418396, -0.9535784125328064, -0.3979494869709015, 1.153075933456421, -0.6144044399261475, 0.4630919396877289, 1.180820107460022, 0.9894381165504456, 0.3765814006328583, -0.20468881726264954, -0.7656657695770264, 0.5225302577018738, -0.3086891770362854, -0.6168532967567444, -0.07523443549871445, 0.22079265117645264, -0.16624563932418823, 0.9962168335914612, -0.4183749258518219, 0.11940321326255798, 0.5482755899429321, 0.4007575511932373, 1.4147366285324097, 0.006813768297433853, -0.9323695302009583, 0.09736819565296173, 0.003449784591794014, 0.35096442699432373, 0.8188221454620361, 0.1854497343301773, 0.35538622736930847, -0.8941870927810669, 0.31657376885414124, 0.1242181584239006, 0.3501007556915283, -0.15954753756523132, -0.48572760820388794, 0.12570980191230774, 0.8267412185668945, 0.7376978397369385, 0.3807206451892853, -0.555251955986023, 1.6860132217407227, 0.7838881015777588, 0.43811750411987305, 0.7774199843406677, -0.3396776020526886, 0.009698986075818539, 0.42531439661979675, -0.5277771353721619, -0.3675098419189453, -0.36344781517982483, 0.6530678868293762, -0.07606274634599686, 0.4675320088863373, -0.4802483022212982, 0.26591628789901733, 1.2162516117095947, 0.46603453159332275, 0.8324981927871704, -0.5389792323112488, 0.6541697382926941, -0.7215904593467712, 0.27468645572662354, -0.6229568123817444, -0.32004281878471375, -1.0467299222946167, -0.837849497795105, -0.6835963129997253, -0.3567240834236145, -0.1467963457107544, -0.6806514859199524, 1.0408377647399902, -0.09098102897405624, 0.1482042372226715, 0.11333754658699036, 0.8055428266525269, -0.3818432688713074, 0.835661768913269, 0.28815582394599915, -0.24970684945583344, 0.1656528115272522, -0.16536502540111542, -0.819321870803833, -0.4715658128261566, 0.18301039934158325, -0.26136893033981323, 0.45005592703819275, -0.3547937572002411, -1.0541502237319946, -0.693203330039978, -0.9520214796066284, 0.8629134893417358, -0.46992695331573486, 0.08481419831514359, 1.1985986232757568, 0.401719868183136, -0.7824782133102417, 1.327836036682129, -0.7663472890853882, -0.6279846429824829, 0.7839847803115845, 0.6039786338806152, 0.5378471612930298, 0.0036713143344968557, -0.5486800074577332, 0.8682250380516052, 0.6026237607002258, -0.7786179184913635, -0.013461649417877197, -0.4415685832500458, -0.40658605098724365, 0.18029069900512695, 0.27304333448410034, -0.666576623916626, 1.053067684173584, -0.39737096428871155, -1.2968330383300781, 0.15523719787597656, -0.13299329578876495, -0.10313469916582108, 0.8096334934234619, -0.1538849174976349, -0.47843337059020996, -0.15443259477615356, -0.06836346536874771, 0.23790575563907623, 0.536159336566925, -0.6289446353912354, -0.05711699649691582, -0.017394505441188812, -0.9402666091918945, -0.7098333239555359, -0.8187308311462402, 0.13948126137256622, 0.014598546549677849, -0.25173890590667725, 0.5018354654312134, 0.2875750958919525, 0.08333637565374374, -0.15133178234100342, -0.37979352474212646, -1.2356945276260376, 0.675918698310852, -0.01358548179268837, 0.8110874891281128, -0.6096379160881042, -0.8565512895584106, 0.37169837951660156, -0.08015025407075882, -0.274117648601532, -0.5317794680595398, 0.42186927795410156, -0.630174994468689, 0.6885486245155334, 0.01920073665678501, -0.8770580887794495, 0.05116927623748779, 0.17819811403751373, -1.1031255722045898, 0.36176857352256775, 0.10968925803899765, 0.9245448708534241, -0.8747003674507141, 0.26021233201026917, 0.4331585168838501, -0.1959916055202484, -0.7737829089164734, 0.6246030330657959, 0.1617741882801056, -0.44915804266929626, -0.10385924577713013, -0.15532630681991577, 0.10000447928905487, -0.49890848994255066, 0.7284222841262817, -0.20570166409015656, 0.04811395704746246, 0.23963682353496552, -0.3155762851238251, 1.0470352172851562, -0.441941499710083, 0.9270405173301697, -0.371335506439209, -1.2992318868637085, -0.6591840386390686, 0.6522371768951416, 0.6382007598876953, -0.24360841512680054, 0.8359174728393555, 0.13893477618694305, -0.702103853225708, 0.41598960757255554, 0.03304022550582886, 0.40496715903282166, -0.24290023744106293, 0.4500850439071655, 1.1792584657669067, 0.10957891494035721, 0.3000844120979309, -0.0039010175969451666, 0.17104250192642212, 0.29748597741127014, 0.11373244971036911, -0.46811825037002563, -0.2577596604824066, -0.8241721987724304, -0.21902528405189514, 0.4140302538871765, 0.3716094493865967, 0.4529685974121094, 0.41927585005760193, -0.8652949333190918, -0.8080533742904663, -0.7818499207496643, 0.32944121956825256, 0.9815810918807983, -0.2101803869009018, -0.13500620424747467, -0.740818977355957, -0.3143605887889862, -0.17609903216362, 0.14065131545066833, -0.4547637701034546, -0.3622683584690094, -0.26327139139175415, -1.5755537748336792, 0.4028110206127167, -0.04690035432577133, 1.2024732828140259, -0.07405759394168854, 0.20822370052337646, -0.1492931842803955, 0.1686972677707672, -0.6173660159111023, -0.2861456274986267, 0.34062063694000244, -0.8283964395523071, -0.2602933347225189, -0.14884807169437408, 0.2516503632068634, 0.36655837297439575, -0.6437097787857056, 0.45667991042137146, -0.25661709904670715, 0.08540833741426468, 0.5459830164909363, 1.0817431211471558, -1.326633334159851, -0.3537873327732086, 0.32467976212501526, 0.5818589329719543, -0.04256604611873627, -0.21600870788097382, 0.13097068667411804, 0.01155711617320776, 0.06110607087612152, -0.3997463285923004, -0.10907211899757385, -0.009123054333031178, 0.4169454872608185, 0.13441923260688782, 0.20423144102096558, 0.4855293035507202, -0.31071484088897705, 1.1769102811813354, -0.10028861463069916, -0.6908988356590271, 0.597150981426239, -1.009988784790039, 0.07250557094812393, 0.5189855694770813, -0.8708596229553223, 0.2520782947540283, -1.1851558685302734, 0.6754230260848999, -0.7972571849822998, 0.5328740477561951, -0.06345431506633759, 1.1470786333084106, 0.10774946957826614, 0.24829575419425964, -0.18874624371528625, 0.782993495464325, 0.140365868806839, -0.1170879378914833, -0.927636981010437, 0.2426566481590271, -0.046988897025585175, 0.46988800168037415, 0.3074182868003845, -0.015171179547905922, -0.6014878153800964, -0.5717694163322449, -0.3052041828632355, 0.16927364468574524, -0.9995266199111938, -0.3153269290924072, -0.2013215273618698, -1.2573578357696533, -0.2185668796300888, -0.2658144533634186, -0.44632962346076965, -0.3077944815158844, 0.4430021643638611, -0.3979748487472534, -1.3634639978408813, -1.0494037866592407, -0.8392211198806763, -0.6421381831169128, -0.5991747975349426, -0.005667100194841623, 0.1501787304878235, -0.2498151659965515, -0.5921236872673035, -0.30851271748542786, -0.8770751953125, 1.1248931884765625, -0.19269365072250366, 0.47624191641807556, 0.383252888917923, -0.3248927891254425, -0.5069469809532166, 0.790149986743927, 0.6052034497261047, -0.3020738363265991, 0.14435210824012756, -0.6992540955543518, -0.07736221700906754, -0.35483255982398987, -0.24604691565036774, 0.22318120300769806, 0.8843448758125305, 0.5904226303100586, -0.14929211139678955, -0.4600454568862915, 0.14912009239196777, 1.567862629890442, -0.8224453330039978, 0.1858316957950592, 0.27615559101104736, 0.38046014308929443, 0.09532729536294937, -0.5229358673095703, 0.19036982953548431, -0.5052324533462524, 0.007739216089248657, 0.40940359234809875, -0.4085385203361511, -0.1696390062570572, -0.8053275942802429, 0.5149237513542175, 1.7094571590423584, 0.003993747290223837, -0.1933504045009613, -0.7583164572715759, 0.2754439413547516, -1.4591150283813477, -1.1412843465805054, 1.0052515268325806, 1.197618842124939, -0.10254806280136108, 0.005579645745456219, -0.07293715327978134, 0.1947944611310959, 0.9211915135383606, 0.056336913257837296, -0.22008681297302246, 0.12892648577690125, 0.24942387640476227, 0.3556347191333771, 1.1307862997055054, 0.4101763665676117, -0.12428963929414749, 0.7489190101623535, 14.985708236694336, 0.967635989189148, -0.5459104180335999, 0.7070052623748779, 0.532526969909668, -0.02997586317360401, 0.04758727550506592, -0.4784557819366455, -0.3715243935585022, 0.28316494822502136, 1.0499413013458252, 0.06727330386638641, 0.884303092956543, 0.29731640219688416, 0.09583942592144012, 0.16373156011104584, 0.22917570173740387, 0.6813952326774597, 0.08125589787960052, -1.1919821500778198, 0.3562372922897339, 0.37495121359825134, 0.9260873198509216, 1.2122371196746826, 0.8162888288497925, 0.6755724549293518, 0.5952402949333191, 0.030524950474500656, 0.77748703956604, 0.29275786876678467, 1.0952470302581787, -0.545817494392395, 0.8568183779716492, 0.3463485836982727, -0.676245927810669, -0.1797986775636673, -0.5325844287872314, -1.0772161483764648, -0.09712857753038406, 0.2818753123283386, -0.7662417888641357, -0.2899688482284546, 0.08657224476337433, 0.6211910843849182, 0.7351016998291016, 0.2918969392776489, -0.19495481252670288, 0.9814409613609314, -0.6421525478363037, -0.23817287385463715, 0.2977449595928192, 0.19138318300247192, 0.2829340696334839, -0.5668386220932007, 0.07737956196069717, -0.2045370638370514, 0.32164859771728516, 0.1886816918849945, -0.6518386006355286, -0.16282181441783905, -0.39626479148864746, -0.10642670094966888, -0.43703317642211914, 0.589398205280304, 0.12040264159440994, -0.06621334701776505, 0.2769087255001068, -0.08623494952917099, 0.5399966239929199, 0.6383486986160278, -0.2919272780418396, 0.043114159256219864, 0.7847774028778076, -0.44084709882736206, -0.3233499228954315, 0.2922368049621582, -0.42520415782928467, -1.0267102718353271, -0.5444580912590027, 0.17917172610759735, 0.06251987814903259, -0.8627177476882935, -1.0222772359848022, 0.4056960642337799, -0.27001115679740906, -0.7211951613426208, 0.7226548790931702, -0.8005439043045044, -0.3744640648365021, -0.30519774556159973, -1.2392323017120361, -0.23707477748394012, 0.5449276566505432, 0.243300199508667, -0.3010926842689514, -0.09506084769964218, 0.7009944915771484, 0.131808802485466, -1.086807131767273, 0.16759243607521057, 0.46504685282707214, -0.018873557448387146, -0.8044534921646118, -0.6889296174049377, 0.3326222002506256, 0.5004522204399109, -0.10741162300109863, 0.5793576240539551, -0.0238144863396883, 0.4113669693470001, -0.30988678336143494, 0.0916508361697197, -0.12319723516702652, -0.49480000138282776, 0.2633504569530487, -0.5124950408935547, -0.32478082180023193, 0.3902896046638489, 0.35371866822242737, -0.2659377455711365, -0.18377336859703064, 0.4310186207294464, 0.37266361713409424, -0.8183498978614807, -0.6250982284545898, 0.396237313747406, 0.4023062586784363, -0.6152627468109131, -0.23120121657848358, 0.2694927155971527, -0.04722950607538223, -0.4465603828430176, -0.30747273564338684, -0.09457486867904663, 0.12749087810516357, -0.027300333604216576, 1.0551717281341553, -1.046314001083374, 0.22654908895492554, 0.6164625287055969, -0.23474560678005219, -0.7381296753883362, 0.13692352175712585, -1.3410248756408691, 0.6361184120178223, 0.14916740357875824, 0.16962748765945435, -1.1296539306640625, 0.10073031485080719, 0.38007521629333496, -0.06115813925862312, -0.12545433640480042, -1.4537761211395264, -0.45186150074005127, 0.00028944239602424204, -0.9509339332580566, -0.07027991861104965, -0.08521188050508499, -0.16855213046073914, -0.46733197569847107, 0.3268229365348816, 0.7043919563293457, 0.031232109293341637, -0.9011571407318115, 0.21230724453926086, -0.10771385580301285, 0.6315891146659851, -0.6865308284759521, -0.7293153405189514, -1.2154629230499268, 0.35800883173942566, -1.4864662885665894, -0.17089426517486572, -0.691878080368042, -0.8323178291320801, 0.057113923132419586, -0.8651115298271179, -0.028042171150445938, 0.8590831756591797, -0.2113211303949356, -0.326214462518692, -0.05415119230747223, -0.5509027242660522, 0.9745977520942688, 0.594426691532135, -0.8129732608795166, 0.15359880030155182, 0.4015023708343506, 0.6720517873764038, 0.7931995987892151, 0.9354304075241089, -0.8485205769538879, -0.7415255308151245, -0.7704430818557739, -0.08239384740591049, -0.42462384700775146, -0.006722941994667053, -1.087629795074463, 0.2335069179534912, 0.2263839989900589, 0.3517166078090668, 0.36388206481933594, 0.11838876456022263, -1.4642399549484253, -0.4936210811138153, 0.8673685789108276, -0.4506823420524597, 0.16644279658794403, -0.06672905385494232, -0.26882418990135193, 0.25528720021247864, 0.8262908458709717, 0.39512571692466736, -0.6933678388595581, -0.09636032581329346, 0.5192663073539734, -0.5681259632110596, 0.33170807361602783, -0.06456047296524048, 0.004985910374671221, -1.0043703317642212, -0.21959687769412994, -0.4814607501029968, 0.17516502737998962, -0.31421709060668945, 0.6184538006782532, 0.03509167581796646, -1.5085031986236572, 0.6611612439155579, -0.1749461591243744, -0.43925487995147705, -0.6983680129051208, 0.12173355370759964, 0.1854768991470337, -0.5341794490814209, 0.44179287552833557, 0.24969542026519775, -0.2441062480211258, -0.2549695074558258, -0.04759439453482628, 0.8906487822532654, -0.39315563440322876, -0.36879053711891174, 0.5627219080924988, -0.5350807905197144, -1.205267310142517, 0.26675650477409363, -1.1998555660247803, 0.1914728283882141, -0.4769548177719116, -0.08207061141729355, 0.7433719038963318, -0.2868939936161041, 0.5751986503601074, -0.11770140379667282, 0.4219127297401428, 0.4833280146121979, -0.3078567683696747, 0.4456510841846466, -0.4902105927467346, 0.17082391679286957, 0.9703705906867981, 0.8879069685935974, -0.8811957836151123, -1.0386303663253784, -0.566796600818634, -0.3064870834350586, -0.3480464220046997, 0.20242954790592194, 0.058967698365449905, -1.1154814958572388, 0.5412091016769409, 1.3192940950393677, 0.3465147018432617, 0.07379747182130814, -0.3640162944793701, -0.12571728229522705, 0.49148377776145935, 0.44985756278038025, -0.9960684180259705, -0.28764212131500244, 0.7175535559654236, 1.0184749364852905, -0.7609632611274719, 0.7109934687614441, 0.04753199964761734, -0.6502966284751892, 0.8771880865097046, 0.2113867700099945, -0.6012461185455322, 0.8596583008766174, -0.6614459753036499, -0.024305738508701324, 0.1369277387857437, -0.8144624829292297, -0.4654350280761719, 0.7569746375083923, 0.4749683737754822, -0.03019597753882408, 0.2995920181274414, 0.06978671997785568, 0.4278585612773895, -0.3906538784503937, 0.024374838918447495, 0.4359267055988312, 0.3629824221134186, -0.2232722043991089, 0.47103798389434814, 0.2038801610469818, 0.5824330449104309, -1.109637975692749, -0.31711217761039734, 0.6536672711372375, 1.337298035621643, -0.09389552474021912, 0.48058009147644043, 0.8562207818031311, -0.11057407408952713, 0.35846471786499023, 0.3398248553276062, 0.16696248948574066, 0.0753033459186554, 0.049839332699775696, 0.11370839178562164, -0.8121441602706909, -0.009395520202815533, -0.2886669337749481, -0.4841354787349701, -0.2802004814147949, -0.7562164068222046, -0.21975313127040863, 0.0931934341788292, 0.5471714735031128, 1.0618394613265991, -0.04710372909903526, 0.9010539650917053, 0.059437498450279236, -0.454310804605484, -0.5805884599685669, -0.7280257344245911, 0.16360513865947723, -0.19402055442333221, -0.06687271595001221, -0.29716408252716064, -0.38370493054389954, -0.61277836561203]}, "authors": [{"authorId": "2108030156", "name": "Jingzhao Zhang"}, {"authorId": "2145536854", "name": "Haochuan Li"}, {"authorId": "3072326", "name": "S. Sra"}, {"authorId": "1688304", "name": "A. Jadbabaie"}], "references": [{"paperId": "f454f6b5f2ca9749ddf442eb5134612ef7f758c1", "title": "ResNet strikes back: An improved training procedure in timm"}, {"paperId": "e5b790f633e15ac672a93f54cd9beaa46a369857", "title": "On the Periodic Behavior of Neural Network Training with Batch Normalization and Weight Decay"}, {"paperId": "026bb8a1066f50ddc8797e1341353603149a8cb8", "title": "Gradient Descent on Neural Networks Typically Occurs at the Edge of Stability"}, {"paperId": "6e6ca188d33feeb632c168ccbd53990b35201392", "title": "On the Reproducibility of Neural Network Predictions"}, {"paperId": "f058b9ad5b8cf14988b25590f849518cd033c570", "title": "No-regret learning and mixed Nash equilibria: They do not mix"}, {"paperId": "7dfac3bf747fefc62f5bdaa124a609992a18b974", "title": "Reconciling Modern Deep Learning with Traditional Optimization Analyses: The Intrinsic Learning Rate"}, {"paperId": "740b7fa3e391509f05f4035819618c56778a57f5", "title": "The Heavy-Tail Phenomenon in SGD"}, {"paperId": "f5a626a4f296bc84e07897e8e6116c6c52bfa361", "title": "Stochastic Optimization with Non-stationary Noise"}, {"paperId": "71065d3de6d962596915d3b91d981d7871a3fc68", "title": "On the Impossibility of Global Convergence in Multi-Loss Optimization"}, {"paperId": "140037f78bcf4e160a97f20aade3eb274587334c", "title": "On Complexity of Finding Stationary Points of Nonsmooth Nonconvex Functions"}, {"paperId": "1448562ccd5bf4bab01d4cae4b2e4549ad3b8e8a", "title": "Lower bounds for non-convex stochastic optimization"}, {"paperId": "285bff5a564cb7edfb355a2ffb44994386975f1d", "title": "On Model Stability as a Function of Random Seed"}, {"paperId": "763c7a66be643bfeec7956c0aa1a2baf9bbc3146", "title": "On the convergence of single-call stochastic extra-gradient methods"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "855f943165013e0897b9f2bc54f6748ba08aef2a", "title": "Stochastic Gradient and Langevin Processes"}, {"paperId": "e658741baefd2c4da4742bb43155f69d4cbd79fa", "title": "Why Gradient Clipping Accelerates Training: A Theoretical Justification for Adaptivity"}, {"paperId": "1db0abda41d464ad4fddadc099ec1cff126b548c", "title": "Vortices Instead of Equilibria in MinMax Optimization: Chaos and Butterfly Effects of Online Learning in Zero-Sum Games"}, {"paperId": "2151cc3fcf890ee6b04dd529f0d5a6bcb1237294", "title": "Game dynamics as the meaning of a game"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "21a73d98621927896664ddf358a60cebf3e849fc", "title": "On the Ineffectiveness of Variance Reduced Optimization for Deep Learning"}, {"paperId": "0572951adde832f6f84e26b5fb87da8e1d1ebca5", "title": "SPIDER: Near-Optimal Non-Convex Optimization via Stochastic Path Integrated Differential Estimator"}, {"paperId": "c983653841b6987d9959318f074a595783838576", "title": "On the Convergence of Adam and Beyond"}, {"paperId": "33690ff21ef1efb576410e656f2e60c89d0307d6", "title": "Deep Reinforcement Learning that Matters"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "19e63a447ce61b6aa7a6a5673ffc18ff140bdf64", "title": "Rethinking the limiting dynamics of SGD: modified loss, phase space oscillations, and anomalous diffusion"}, {"paperId": "b47e4c6de3050d5582187208186eda7d32a27005", "title": "How SGD Selects the Global Minima in Over-parameterized Learning : A Dynamical Stability Perspective"}, {"paperId": null, "title": "An example of non convergence of birkhoff sums"}]}