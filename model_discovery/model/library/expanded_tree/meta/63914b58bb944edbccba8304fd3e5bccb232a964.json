{"paperId": "63914b58bb944edbccba8304fd3e5bccb232a964", "abstract": "Large Language models (LLMs) have demonstrated impressive in-context learning (ICL) capabilities, where a LLM makes predictions for a given test input together with a few input-output pairs (demonstrations). Nevertheless, the inclusion of demonstrations leads to a quadratic increase in the computational overhead of the self-attention mechanism. Existing solutions attempt to distill lengthy demonstrations into compact vectors. However, they often require task-specific retraining or compromise LLM's in-context learning performance. To mitigate these challenges, we present Meta dEmonstratioN Distillation (MEND), where a language model learns to distill any lengthy demonstrations into vectors without retraining for a new downstream task. We exploit the knowledge distillation to enhance alignment between MEND and LLM, achieving both efficiency and effectiveness simultaneously. MEND is endowed with the meta-knowledge of distilling demonstrations through a two-stage training process, which includes meta-distillation pretraining and fine-tuning. Comprehensive evaluations across seven diverse ICL task partitions using decoder-only (GPT-2) and encoder-decoder (T5) attest to MEND's prowess. It not only matches but often outperforms the Vanilla ICL as well as other state-of-the-art distillation models, while significantly reducing the computational demands. This innovation promises enhanced scalability and efficiency for the practical deployment of large language models", "venue": "arXiv.org", "year": 2024, "citationCount": 1, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Meta dEmonstratioN Distillation (MEND) is presented, where a language model learns to distill any lengthy demonstrations into vectors without retraining for a new downstream task, and promises enhanced scalability and efficiency for the practical deployment of large language models."}, "embedding": {"model": "specter_v2", "vector": [0.048643920570611954, 0.5187957286834717, -0.24591468274593353, -0.18666072189807892, -0.36576491594314575, -0.1830451339483261, 0.8691115379333496, -0.040474098175764084, -0.6576628088951111, 0.006200849544256926, 0.46952512860298157, -0.42129871249198914, 0.46530234813690186, 0.6231621503829956, -0.45617401599884033, 0.10393760353326797, -0.9382103085517883, 0.10633701086044312, -0.13225892186164856, -0.5039132237434387, -0.2889975905418396, -0.9881219863891602, -0.7211154103279114, 0.15811528265476227, 0.6084986925125122, 0.14767751097679138, 0.7294445633888245, 0.9721957445144653, -0.2628883123397827, 0.09881427139043808, 0.21643151342868805, -0.09477100521326065, 0.3219742178916931, 0.01689339242875576, -0.08470816910266876, -0.36730289459228516, 0.39524200558662415, -0.8079476952552795, -0.4099297821521759, 0.7019622921943665, 0.07985753566026688, 0.16871537268161774, 0.5213302373886108, -0.459886372089386, -0.4878869354724884, 0.8795239925384521, 0.6616560816764832, 0.6458336710929871, -0.1667933464050293, -0.46251794695854187, 1.3738797903060913, -1.6772674322128296, 0.2166077196598053, 1.2293778657913208, 0.24025869369506836, 0.714720606803894, -0.3717857003211975, -0.5840049982070923, 0.9533045291900635, 0.021811284124851227, -0.6073849201202393, -0.051151592284440994, 0.15102802217006683, 0.08373094350099564, 1.9667611122131348, -0.3639620244503021, 0.1205180436372757, 1.0221821069717407, -0.24936246871948242, 1.781129002571106, -0.23695437610149384, -0.9356545209884644, -0.34508320689201355, 0.21920137107372284, 0.2984654903411865, 0.8666420578956604, -0.5423156023025513, 0.6082705855369568, -0.4810284972190857, 0.12795092165470123, 0.2902517318725586, -0.04729679971933365, -0.062377601861953735, -0.2791289687156677, -0.43090498447418213, 0.49136531352996826, 0.5304792523384094, 1.0638878345489502, -0.06951270252466202, 0.7295249700546265, 0.40948519110679626, 0.5043016672134399, 0.08320586383342743, 0.4127172529697418, -0.19893404841423035, 0.27012133598327637, -1.0382758378982544, 0.2739788591861725, -0.07581950724124908, 0.7608508467674255, -0.21655014157295227, 0.17214922606945038, -0.676601767539978, 0.380816251039505, 1.415414810180664, 0.005357489921152592, 0.7978459000587463, -0.7854000329971313, 0.7832155823707581, -0.7948805093765259, 0.01989983581006527, -0.48108139634132385, 0.0232766754925251, -0.2558305561542511, -0.2689085602760315, -1.1082466840744019, -0.7115886807441711, -0.1208176538348198, -0.4610447287559509, 1.2845865488052368, -0.15436559915542603, 0.4361242353916168, 0.3612752854824066, 0.2600763142108917, 0.5219594240188599, 0.6853333711624146, 0.17502695322036743, 0.028057344257831573, 0.47706812620162964, -1.1729578971862793, -0.2794169783592224, -1.0914708375930786, 0.9722130298614502, 0.15074004232883453, 0.32442474365234375, -0.4371486008167267, -1.1047405004501343, -1.26569402217865, -1.5214993953704834, -0.23769201338291168, -0.6353632807731628, 0.17303131520748138, 0.6395835280418396, 0.2999492287635803, -0.7959813475608826, 0.9097515344619751, -0.41150611639022827, 0.07398518174886703, 0.0934063121676445, 0.15329787135124207, 0.12767185270786285, -0.5826639533042908, -1.0343466997146606, 0.20212240517139435, 0.6022163033485413, -0.29513710737228394, -0.5328908562660217, -0.8739981055259705, -1.3330491781234741, -0.3161969482898712, 0.0994843915104866, -0.33109182119369507, 1.5581514835357666, -0.06329658627510071, -0.9794066548347473, 0.37102144956588745, -0.12423142790794373, 0.1808706521987915, 0.5558313727378845, -0.3594692051410675, -0.7813279628753662, -0.5565787553787231, -0.17344972491264343, 1.1295993328094482, 0.001945560215972364, -0.21198469400405884, -0.22478632628917694, 0.22409982979297638, -0.0876624807715416, 0.08018147945404053, -0.10116145759820938, 0.3080950379371643, -0.3413524627685547, -0.3200143873691559, 0.18892018496990204, 0.8581961989402771, 0.0633607730269432, -0.4000018239021301, -0.7202098369598389, -1.1408661603927612, 1.2025707960128784, 0.05741684511303902, 0.6206560730934143, -1.0527456998825073, -0.8541795611381531, -0.4742656648159027, -0.08657439798116684, 0.22560308873653412, -1.2596549987792969, 0.7627124786376953, -0.16199500858783722, 0.2423156499862671, 0.0420248806476593, -1.3475056886672974, 0.3224659860134125, -0.04362550750374794, -0.4144032299518585, -0.694885790348053, 0.16606445610523224, 1.263718605041504, -1.4677542448043823, -0.21091556549072266, 0.06274715065956116, 0.3318004608154297, -1.2763820886611938, 1.3599178791046143, -0.8047158122062683, 0.5147684812545776, -0.2649940252304077, -0.33100858330726624, -0.017073387280106544, -0.07943844050168991, 0.5120800733566284, -0.38639599084854126, 0.015971019864082336, 0.6665964722633362, -0.11896789819002151, 1.921259880065918, -0.6660906672477722, 0.7781739234924316, -0.25981906056404114, -0.7882074117660522, 0.23192842304706573, 0.575145423412323, -0.25527021288871765, -0.5143049955368042, 0.19457301497459412, 0.5664253234863281, -0.3896459937095642, -0.15099593997001648, 0.8232325911521912, 0.912983775138855, -0.15110443532466888, 0.28849828243255615, 0.581503689289093, -0.2479403167963028, 0.6436988115310669, 0.5132808685302734, 0.7032314538955688, 0.7227843999862671, 0.32742348313331604, 0.3007086515426636, 0.31545042991638184, -0.9472882747650146, -0.4171462655067444, 0.4710427224636078, 0.6505504250526428, 0.65414959192276, 0.17662253975868225, -0.35512691736221313, -0.2957739233970642, -0.12534567713737488, 0.9179015159606934, 1.3320610523223877, -0.24410536885261536, -0.023609329015016556, -0.8534890413284302, -0.8576351404190063, -0.11926151067018509, 0.6583033204078674, -0.3853349983692169, -0.10466014593839645, -0.6935480833053589, -0.48070836067199707, 0.5165600180625916, 0.5012410879135132, 1.3036566972732544, -0.5188854932785034, -0.11333420872688293, 0.003963044844567776, 0.15783831477165222, -0.8261358737945557, -0.7533459067344666, 0.30274274945259094, -0.558134138584137, -0.31001734733581543, -0.015353228896856308, -0.3118879497051239, 0.2798617482185364, -0.3954615592956543, 1.0474132299423218, -0.5858550071716309, -0.35196298360824585, 0.26788362860679626, 0.45840874314308167, -0.30105337500572205, -0.9338857531547546, 0.19654050469398499, 0.18733496963977814, -0.6490808129310608, 0.3652797043323517, 0.17112460732460022, -0.2802896797657013, -0.1868770569562912, -0.2552717924118042, 0.4392837882041931, 0.20528441667556763, 0.11021142452955246, 0.6046261787414551, -0.7323570847511292, 0.17012256383895874, -1.2406898736953735, 1.007828950881958, -0.14099349081516266, -0.23535287380218506, 0.22356754541397095, -0.8225297331809998, -0.34004321694374084, 0.3745375871658325, -0.7931281328201294, -0.05689916014671326, -1.249561071395874, 0.1860562562942505, -0.44596999883651733, -0.40717369318008423, 0.18030592799186707, 0.22416771948337555, 0.6666541695594788, 0.19649651646614075, 0.3695732057094574, 0.22843347489833832, -0.3386472761631012, 1.1264619827270508, -0.7331578135490417, 0.5822983384132385, 0.050016481429338455, -0.043171226978302, -0.6310484409332275, -0.3218311071395874, -0.4889928102493286, -0.42814531922340393, -0.14395469427108765, -0.3466251790523529, -0.21925531327724457, 0.2779088616371155, -0.572457492351532, -0.6834828853607178, -0.4930274188518524, -1.1114492416381836, -0.5750401616096497, -0.0680926963686943, -0.2210111916065216, -0.26498308777809143, -0.9654063582420349, -0.7618959546089172, -0.14961200952529907, -0.35911163687705994, -1.0669281482696533, 0.31432992219924927, -0.06589615345001221, -0.47779780626296997, -1.0160707235336304, 0.27939409017562866, -0.5818853378295898, 0.8112325072288513, -0.6374331712722778, 0.7782964706420898, -0.11944085359573364, -0.1783374547958374, -0.29061436653137207, 0.02962351031601429, 0.8653859496116638, -0.08601811528205872, -0.030217638239264488, -1.0298422574996948, -0.0071886200457811356, -0.6146705746650696, -0.554951012134552, -0.08667967468500137, -0.06319712847471237, 0.578976571559906, -0.07740484923124313, -0.8174755573272705, 0.41574421525001526, 1.4280680418014526, -0.51856929063797, -0.2139943540096283, 0.022199008613824844, 0.7869314551353455, -0.012289679609239101, -0.05626651272177696, 0.012651398777961731, 0.33791443705558777, 0.445140540599823, 0.2293500155210495, 0.08170504122972488, -0.28916439414024353, -1.0903193950653076, 0.5118081569671631, 1.520480990409851, 0.6359654664993286, 0.2375640720129013, -0.6680092215538025, 0.6309629678726196, -1.2686402797698975, -0.31710872054100037, 1.0321691036224365, 0.560301661491394, 0.5473850965499878, -0.6822667717933655, -0.46202224493026733, -0.36971017718315125, -0.04273572191596031, 0.497026652097702, -0.5351405739784241, -0.7360435724258423, 0.4258829951286316, 0.14886249601840973, -0.45917776226997375, 0.8400335907936096, -0.305358350276947, 0.3652052879333496, 14.502664566040039, 0.5824592709541321, 0.07941658049821854, 0.9008966088294983, 0.46588101983070374, -0.024580150842666626, -0.3587995171546936, -0.3857359290122986, -1.2583394050598145, -0.02631531096994877, 1.0675945281982422, 0.6137911081314087, 0.3005412817001343, 0.19155675172805786, 0.035073474049568176, 0.21247179806232452, -1.1765823364257812, 0.6193956732749939, 0.49957725405693054, -1.1087605953216553, 0.3123944401741028, 0.1346188634634018, 0.4202488958835602, 0.6463689208030701, 0.9674307703971863, 1.3388537168502808, 0.5327391624450684, -0.059195492416620255, 0.4937531650066376, 0.06987713277339935, 1.18636155128479, 0.13895955681800842, 0.05307619273662567, 0.8711713552474976, -0.45654937624931335, -0.3639688193798065, -0.4573359489440918, -0.9010197520256042, 0.2521928548812866, -0.15970300137996674, -0.8417466878890991, -0.6060450077056885, -0.5683939456939697, 0.7357475757598877, 0.13028652966022491, 0.05094258859753609, -0.5410118699073792, 0.6938418745994568, 0.06974544376134872, -0.2891600430011749, 0.5675404667854309, 0.3798074424266815, 0.2527599632740021, 0.2428436130285263, 0.26884257793426514, -0.07163792848587036, 0.028646979480981827, 0.7300921678543091, -0.5579403638839722, -0.18943139910697937, -0.43835803866386414, -0.004304602742195129, -0.054687630385160446, 0.4868856370449066, 1.2549082040786743, 0.17042595148086548, -0.4891927242279053, 0.5381721258163452, 0.9318143725395203, 0.42741140723228455, -0.2798929810523987, 0.09462194889783859, 0.33198344707489014, -0.615535318851471, 0.0033515379764139652, 0.18319500982761383, 0.4046272039413452, -0.3248167634010315, -0.5887084603309631, -0.21943916380405426, -0.09037000685930252, -1.1029047966003418, -0.6214922666549683, 0.6897684335708618, 0.003947260789573193, -0.6533432006835938, -0.5145043134689331, -0.7715229392051697, -0.4469999670982361, 0.442606657743454, -1.4999345541000366, -0.630946934223175, 0.302788108587265, -0.5313540697097778, -0.16073931753635406, -0.1675909459590912, 1.3517820835113525, 0.24323301017284393, -0.4583781063556671, 0.3543417155742645, 0.26365506649017334, -0.07103576511144638, -0.15392284095287323, -1.0462291240692139, 0.8511494398117065, -0.030351698398590088, 0.17345529794692993, 0.07521083205938339, 0.0080809835344553, 0.16579657793045044, -0.5644469857215881, -0.14003808796405792, 0.6780832409858704, -0.8264378905296326, -0.5000636577606201, -0.7129513025283813, -0.5476418137550354, 0.3942791521549225, 0.7299114465713501, -0.13115669786930084, 0.6131833791732788, 0.21228277683258057, -0.9648780822753906, -0.037768661975860596, -0.7483181357383728, 0.6183983087539673, 0.44779202342033386, -0.46107786893844604, -0.5327494144439697, -0.029533518478274345, 0.8304685354232788, -1.0258278846740723, -0.3866172432899475, -0.43222206830978394, 0.04506584256887436, -0.16975247859954834, 1.18521249294281, -0.4583958089351654, 0.8445531725883484, 1.014967441558838, -0.3280526399612427, -1.0849519968032837, 0.3607890009880066, -0.8777816891670227, -0.2935516834259033, 0.22120848298072815, 0.9363054037094116, -0.26316216588020325, 0.056301288306713104, 0.7680325508117676, 0.22063729166984558, -0.7450537085533142, -0.5401524305343628, -0.5836430191993713, 0.2983201742172241, -0.6818996667861938, 0.33778852224349976, -0.07674435526132584, 0.1666804552078247, 0.43087634444236755, 0.8116477131843567, 0.3540946841239929, -0.23380610346794128, -0.9816648364067078, 0.6519380807876587, 0.4778805673122406, -0.6118714809417725, -0.5001082420349121, -0.3325892984867096, -1.723758339881897, -0.04958989843726158, -1.4889836311340332, -0.14477188885211945, -1.0238261222839355, -0.3789553940296173, -0.22063155472278595, -0.3596917986869812, -0.0753818154335022, 0.11124391853809357, -0.522454023361206, -0.27796241641044617, -0.5921881198883057, -0.5617990493774414, 0.7910688519477844, 1.0190422534942627, -0.8468350172042847, 0.0564504973590374, -0.19055235385894775, 0.0912986695766449, -0.04556731507182121, 0.4397483468055725, -0.1291266530752182, -0.9938176274299622, -1.6424301862716675, 0.24214522540569305, -0.10695777833461761, 0.04954579845070839, -0.8215309381484985, 0.4885663092136383, 0.7104224562644958, -0.16599465906620026, -0.18415942788124084, 0.6202125549316406, -0.9686054587364197, -0.9848899841308594, 0.3147791624069214, -0.8290278911590576, 0.22513316571712494, 0.35906875133514404, -0.30544421076774597, -0.29579299688339233, 0.4441636800765991, -0.2967796325683594, -0.8476329445838928, -0.8795022964477539, 0.2496434599161148, -0.07367511838674545, 0.05894045531749725, -0.3002707362174988, 0.0030370401218533516, -1.171692967414856, -0.2489968240261078, 0.05687102675437927, 0.5475643277168274, -0.7300593852996826, 0.8220816254615784, 0.39797845482826233, -1.2232942581176758, -0.020834464579820633, 0.5185373425483704, 0.022471418604254723, 0.11134474724531174, 0.6461564898490906, 0.3878784775733948, -0.12307929247617722, 0.5247725248336792, 0.4647696018218994, 0.15760737657546997, -0.7879230976104736, 0.23628413677215576, 0.9278509616851807, -0.6586948037147522, -0.1439265012741089, 1.2049713134765625, -0.36815857887268066, -1.3294039964675903, 0.2138746976852417, -1.0979918241500854, -0.2857448160648346, -0.6868435740470886, 0.6311898827552795, 0.0889836996793747, -0.2701486647129059, 0.35601091384887695, -0.0491999052464962, 0.21255625784397125, -0.3444121778011322, -0.8135366439819336, 0.533997654914856, -0.14816758036613464, -0.13312864303588867, 0.7036561369895935, 1.3949586153030396, -0.7330726981163025, -1.1010587215423584, -0.8036379814147949, -0.6832697987556458, 0.017518050968647003, 0.10029207915067673, -0.6512218117713928, -0.3359801769256592, 1.0730152130126953, 0.44545450806617737, 0.11567134410142899, -0.10727351903915405, -0.020769955590367317, 0.2140752524137497, 0.9371238350868225, -0.31221774220466614, -0.4500061571598053, -0.201077401638031, 1.1266409158706665, 1.443294882774353, -1.145627737045288, 0.08642145246267319, 0.12154996395111084, -0.3068424165248871, 0.6010010242462158, 0.4783889651298523, -0.24758747220039368, 1.0381379127502441, -0.37546736001968384, 0.21083998680114746, 0.18960967659950256, -1.126237154006958, 0.1408531218767166, 0.7357692122459412, 1.2859464883804321, 0.9680217504501343, 0.5414465069770813, 0.31879177689552307, 0.6744489073753357, 0.04462292417883873, -0.07506687194108963, 0.05099917948246002, 0.4467906653881073, -0.18101108074188232, -0.4666452705860138, 0.37429454922676086, 0.35192856192588806, -0.12359216809272766, -0.7897588610649109, 0.43357017636299133, 0.8736260533332825, 0.3976338803768158, 0.6164199113845825, 0.9368199706077576, 0.06938769668340683, 0.6269334554672241, 0.3487537205219269, 0.747719943523407, -0.5962920784950256, -0.06708479672670364, -0.4307936429977417, -0.7318128347396851, -0.08783367276191711, -0.099496029317379, -0.5450164079666138, -0.37136730551719666, 0.15667220950126648, 0.3453536927700043, -0.11481425166130066, 0.6334779858589172, 1.1919498443603516, 0.6029564142227173, 0.860755443572998, -0.19390273094177246, -0.42135176062583923, -0.6342684030532837, -1.2091795206069946, 0.31622397899627686, -0.609021008014679, -0.13105204701423645, -0.1136481910943985, 0.03612042963504791, -0.6406183838844299]}, "authors": [{"authorId": "1527105834", "name": "Yichuan Li"}, {"authorId": "2290976665", "name": "Xiyao Ma"}, {"authorId": "34892980", "name": "Sixing Lu"}, {"authorId": "2261475493", "name": "Kyumin Lee"}, {"authorId": "2271351956", "name": "Xiaohu Liu"}, {"authorId": "2291485139", "name": "Chenlei Guo"}], "references": [{"paperId": "b9870e130f61ff900fe00dbcc5782c9b31773d32", "title": "Learning to Compress Prompts with Gist Tokens"}, {"paperId": "eecb45aa040064cbc0b37fd100706c02e7dc880e", "title": "Structured Prompting: Scaling In-Context Learning to 1, 000 Examples"}, {"paperId": "b3d04ab5362b3fb171b5231dcf4c675c4c64ec02", "title": "HyperTuning: Toward Adapting Large Language Models without Back-propagation"}, {"paperId": "cdbd4f9b6ab2e2fd1ddf5400d5ed2c18960635d1", "title": "Scaling Instruction-Finetuned Language Models"}, {"paperId": "8fbd7ddf1ea30c991f3b1152a245df77caa18e16", "title": "Learning by Distilling Context"}, {"paperId": "13a0d8bb38f739990c8cd65a44061c6534f17221", "title": "OPT: Open Pre-trained Transformer Language Models"}, {"paperId": "f4df78183261538e718066331898ee5cad7cad05", "title": "Rethinking the Role of Demonstrations: What Makes In-Context Learning Work?"}, {"paperId": "3dc7dc1bea9a4f70c02b6759a0bda7aca0005a9e", "title": "A General Language Assistant as a Laboratory for Alignment"}, {"paperId": "ffdbd7f0b03b85747b001b4734d5ee31b5229aa4", "title": "The Power of Scale for Parameter-Efficient Prompt Tuning"}, {"paperId": "7fa273f450251523e6b7fcc2eb3fdbdfd4a30493", "title": "CrossFit: A Few-shot Learning Challenge for Cross-task Generalization in NLP"}, {"paperId": "59641c10ed7431a3cf841f308367dc2dc0281b74", "title": "What Makes Good In-Context Examples for GPT-3?"}, {"paperId": "9e42cb2b133bc41600824a1002cb05844c6a46a9", "title": "Learning to Generate Task-Specific Adapters from Task Description"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "ad5970584754cc7a1d91c95ab84a1e210258183a", "title": "UnifiedQA: Crossing Format Boundaries With a Single QA System"}, {"paperId": "e6c561d02500b2596a230b341a8eb8b921ca5bf2", "title": "Scaling Laws for Neural Language Models"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "7cf64265882f7129b127ce0e27ff7bca9173aa58", "title": "The Context"}, {"paperId": "563783de03452683a9206e85fe6d661714436686", "title": "HyperNetworks"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": "70d89d380ca5d20564e1dd8ed2f4c59f5c7b3656", "title": "HINT: Hypernetwork Instruction Tuning for Efficient Zero-Shot Generalisation"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "Pytorch: An imperative style"}, {"paperId": null, "title": ": Training and inference at scale"}]}