{"paperId": "b7e94220176d9d329ee064fd4359229bf92ef360", "abstract": "We present Hidden-State Optimization (HSO), a gradient-based method for improving the performance of transformer language models at inference time. Similar to dynamic evaluation (Krause et al., 2018), HSO computes the gradient of the log-probability the language model assigns to an evaluation text, but uses it to update the cached hidden states rather than the model parameters. We test HSO with pretrained Transformer-XL and GPT-2 language models, finding improvement on the WikiText103 and PG-19 datasets in terms of perplexity, especially when evaluating a model outside of its training distribution. We also demonstrate downstream applicability by showing gains in the recently developed prompt-based few-shot evaluation setting, again with no extra parameters or training data.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2021, "citationCount": 2, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://aclanthology.org/2021.findings-emnlp.346.pdf", "status": "HYBRID"}, "tldr": {"model": "tldr@v2.0.0", "text": "Hidden-State Optimization is presented, a gradient-based method for improving the performance of transformer language models at inference time that computes the gradient of the log-probability the language model assigns to an evaluation text but uses it to update the cached hidden states rather than the model parameters."}, "embedding": {"model": "specter_v2", "vector": [0.25898128747940063, 0.8666895627975464, -0.39734017848968506, -0.17894135415554047, -0.28174322843551636, -0.19713647663593292, 0.9602708220481873, -0.47493889927864075, -0.47413280606269836, -0.404288113117218, 0.9424360990524292, -0.2027912139892578, 0.46138644218444824, 0.30540165305137634, 0.21937087178230286, 0.03801531344652176, -0.6181007623672485, 0.46872755885124207, -0.04809194058179855, -0.6693295836448669, -0.4855929911136627, -0.8583520650863647, -0.7402628660202026, -0.09836486726999283, 0.003145031863823533, 0.11276470124721527, 0.030051741749048233, 0.9006941318511963, -0.20482748746871948, 0.4514870047569275, 0.2408914864063263, -0.732033908367157, 0.13868051767349243, 0.06820285320281982, -0.3929983377456665, 0.1882469356060028, 0.06688040494918823, -0.693630039691925, -0.2611824572086334, 1.007341980934143, -0.24356161057949066, 0.10686217993497849, 0.0685347244143486, -0.7302260398864746, -0.345561146736145, 0.8669809103012085, 0.8614119291305542, 0.6895263195037842, -0.10091625154018402, -0.13225765526294708, 1.6184120178222656, -0.9554582834243774, 0.6919931173324585, 1.49088716506958, 0.12882542610168457, 0.4772525727748871, -0.2645378112792969, -0.25796079635620117, 1.1337050199508667, 0.00852944329380989, -0.5952875018119812, -0.4564741849899292, 0.2835734486579895, -0.011130161583423615, 2.039480209350586, -0.4256470501422882, 0.28633221983909607, 0.9994458556175232, -0.2914031147956848, 1.6595301628112793, -0.15496543049812317, -0.8218755125999451, -0.6810135841369629, 0.40234073996543884, 0.6858489513397217, 1.0398303270339966, -0.8045217394828796, 0.7178784608840942, -0.6124648451805115, -0.010287394747138023, 0.2342519611120224, -0.04770353063941002, -0.33926135301589966, 0.06255960464477539, -0.5177289843559265, 0.6528947949409485, -0.08898213505744934, 0.8008331656455994, -0.1315268874168396, 0.594612717628479, 0.5440526604652405, 0.5076373815536499, 0.3046211898326874, 0.15093767642974854, -0.06903896480798721, -0.02598441392183304, -0.821552574634552, 0.10801186412572861, 0.1641770899295807, 0.4502725601196289, -0.2756238281726837, 0.1062140241265297, -1.2884960174560547, 0.08892268687486649, 1.394665241241455, -0.1404585987329483, 0.3976193070411682, -0.9461421966552734, 0.24173104763031006, -0.8156061172485352, 0.09876225888729095, -0.48289981484413147, -0.06407704204320908, -0.13822226226329803, -0.32768362760543823, -1.2840218544006348, -0.32663387060165405, 0.31131720542907715, -0.8939534425735474, 1.0987944602966309, -0.1016661673784256, -0.14767488837242126, 0.276970773935318, 0.543289303779602, 0.1762714982032776, 0.9929702877998352, 0.23159676790237427, -0.12102280557155609, 0.577349841594696, -0.9934008717536926, -0.9128202795982361, -0.9417611360549927, 0.7482335567474365, -0.11048059910535812, 0.7134562730789185, 0.20212890207767487, -1.0260370969772339, -0.44755125045776367, -0.853043794631958, 0.0017418403876945376, -0.2501755654811859, 0.33891019225120544, 0.8216845393180847, 0.5168972015380859, -1.3445451259613037, 1.019626259803772, -0.533367395401001, -0.2939622104167938, 0.0554865263402462, -0.21547217667102814, 0.34869998693466187, -0.25201183557510376, -1.3571239709854126, 0.45383182168006897, 0.32170647382736206, -0.5751683712005615, -0.1474645882844925, -0.6271683573722839, -0.9548411965370178, 0.007901061326265335, 0.5516650080680847, -0.18029575049877167, 1.7484551668167114, 0.10882526636123657, -1.8547682762145996, 0.648430347442627, -0.33909955620765686, 0.47484374046325684, 0.2900397479534149, -0.1643487811088562, -0.7436442375183105, -0.3083478808403015, -0.1766538769006729, 0.38391637802124023, 0.15396229922771454, 0.29427117109298706, -0.08659541606903076, -0.11707481741905212, -0.10290677100419998, 0.001952999271452427, -0.31646257638931274, 1.0183972120285034, -0.5197734236717224, 0.10476270318031311, 0.11887525767087936, 0.711565375328064, 0.08996541798114777, -0.2378005087375641, -0.567001461982727, -1.5156364440917969, 0.6712744235992432, -0.3610650897026062, 1.0977792739868164, -0.8571751713752747, -0.6363803744316101, -0.29751938581466675, -0.08526606857776642, 0.028329849243164062, -0.7298398017883301, 0.34982219338417053, -0.26817500591278076, 0.47695788741111755, 0.3014720380306244, -1.4816622734069824, 0.416193425655365, -0.10353031754493713, -0.5082272291183472, -0.5150919556617737, 0.19509512186050415, 1.2149484157562256, -1.0577173233032227, -0.1661396026611328, -0.07414357364177704, 0.27452322840690613, -0.7057695388793945, 1.168657660484314, -0.45629188418388367, 0.15084248781204224, -0.07508881390094757, -0.16664205491542816, -0.22430084645748138, -0.5243039727210999, 0.29292482137680054, -0.4322028160095215, -0.2746751308441162, 0.6413167715072632, -0.15080520510673523, 1.264839768409729, -0.07080046087503433, 0.38923290371894836, -0.23440998792648315, -0.5064062476158142, -0.06398843973875046, 0.5189006924629211, -0.33131250739097595, -0.665435791015625, 0.3200712502002716, 0.02601250261068344, -0.8467710018157959, 0.2834319770336151, 0.6266425848007202, 0.44822990894317627, -0.2955031991004944, 0.3192032277584076, 0.7990520596504211, 0.0029605345334857702, 0.7148540616035461, 0.5617820620536804, 0.53204745054245, 0.43962588906288147, 0.2275281548500061, 0.23046448826789856, -0.2271345853805542, -0.6067790389060974, 0.02777419053018093, 0.16159571707248688, 0.3144869804382324, 0.6833392381668091, 0.7874675393104553, -0.48820173740386963, -0.3872750401496887, -0.5130845308303833, 0.8164998888969421, 1.5771228075027466, -0.4074002802371979, -0.4274772107601166, -0.6402330994606018, -0.08417635411024094, -0.8307434916496277, 0.7698715925216675, -0.20905911922454834, -0.4052625000476837, -0.3820478320121765, -0.9089215993881226, 0.8256136178970337, -0.001021818839944899, 0.8472950458526611, -0.3319093883037567, -0.20032094419002533, -0.20146189630031586, 0.033270325511693954, -0.7634356617927551, -0.5227659344673157, 0.19830670952796936, -0.49630171060562134, -0.20348861813545227, -0.1632988601922989, 0.18455015122890472, -0.30327683687210083, -0.9194944500923157, 0.8732067346572876, -0.5022093057632446, 0.01994788832962513, 0.5251770615577698, 0.5926563143730164, -0.5450800657272339, -0.88844233751297, -0.04487759247422218, -0.04559675604104996, -0.39049819111824036, 0.1322932243347168, 0.768781840801239, 0.49275702238082886, -0.1461534947156906, -0.38118427991867065, 0.5524957776069641, -0.1284482777118683, 0.032493531703948975, 0.4555465877056122, -0.49828052520751953, -0.44098982214927673, -0.981273353099823, 0.9480472803115845, 0.3982378840446472, -0.8277580142021179, 0.7879496812820435, -1.090184211730957, -0.18822067975997925, 0.3750196695327759, -0.5954965353012085, -0.6300601363182068, -1.1913589239120483, 0.35880446434020996, -0.3611346483230591, -0.0745430439710617, 0.17553123831748962, 0.21730025112628937, 0.8853788375854492, -0.027128024026751518, 0.29331302642822266, 0.4620913565158844, -0.15164358913898468, 0.4272204041481018, -0.9921651482582092, 0.5549318194389343, 0.4232292175292969, -0.0821528360247612, -0.4404948055744171, -0.43093565106391907, -0.5949223637580872, -0.8070683479309082, -0.27635109424591064, -0.024369142949581146, -0.6224777102470398, 0.2504040598869324, -0.5060462951660156, -0.7550292611122131, 0.03880971670150757, -1.367051601409912, -0.43860769271850586, 0.11500895023345947, -0.45030534267425537, -0.060897331684827805, -0.9938405752182007, -1.1464242935180664, -0.5066860914230347, -0.5844928622245789, -0.9923932552337646, 0.5582885146141052, -0.003649382619187236, -0.36440712213516235, -0.7612364888191223, 0.5540021657943726, -0.2313445657491684, 0.7954308390617371, -0.5883703827857971, 0.6990923881530762, 0.014546667225658894, -0.0635596513748169, -0.18504293262958527, 0.5943374633789062, 0.6894252300262451, -0.39581140875816345, 0.4259592294692993, -0.7064647078514099, 0.2612040936946869, -0.4700309932231903, -0.2513997554779053, 0.09089421480894089, 0.12708793580532074, 0.22282055020332336, -0.15473240613937378, -0.41759777069091797, 0.21010005474090576, 1.2412488460540771, -0.7285752296447754, 0.08395620435476303, 0.031149594113230705, 0.8494570851325989, 0.2726288139820099, -0.05633380264043808, 0.4388161599636078, 0.49436134099960327, 0.5352051854133606, -0.14215457439422607, -0.010590306483209133, -0.08539430052042007, -0.8937859535217285, 1.017173409461975, 1.5158158540725708, 0.3402051031589508, -0.23607176542282104, -0.9307758808135986, 0.4626174569129944, -1.1196144819259644, -0.587816059589386, 0.6933846473693848, 0.45544204115867615, 0.44868963956832886, -0.6011672019958496, -0.3296257257461548, -0.1923835277557373, 0.5059915781021118, 0.5216302275657654, -0.2999832034111023, -0.7520422339439392, -0.028627634048461914, 0.3400847613811493, -0.09725794941186905, 0.8435170650482178, -0.022633221000432968, 1.0806434154510498, 14.827000617980957, 0.5687034726142883, -0.2904360294342041, 0.6617541313171387, 0.6585072875022888, -0.1476946473121643, -0.44484835863113403, 0.11061287671327591, -1.2115099430084229, -0.3443976044654846, 1.3836619853973389, -0.04803100600838661, 0.8037883639335632, -0.0477537140250206, 0.23332594335079193, -0.06471346318721771, -0.584490180015564, 0.47176700830459595, 0.5357484817504883, -0.9957586526870728, 0.36255887150764465, 0.16586808860301971, 0.1262802928686142, 0.9795778393745422, 0.8915029764175415, 0.8623473048210144, 0.6157569885253906, 0.0602136068046093, 0.8213443160057068, 0.3574601411819458, 0.7386112213134766, -0.09101477265357971, 0.19918955862522125, 0.5950420498847961, -0.32846006751060486, -0.16316533088684082, -0.25484180450439453, -1.0010234117507935, 0.7538387775421143, 0.1687392145395279, -0.7820886373519897, -0.6590374112129211, 0.006882756948471069, 0.6168898344039917, -0.011990509927272797, -0.19435153901576996, -0.4972112774848938, 0.8650830388069153, -0.17357109487056732, -0.24736198782920837, 0.639300525188446, 0.21017596125602722, 0.7360824942588806, -0.2717648446559906, 0.008123023435473442, 0.059498995542526245, 0.06752724945545197, 0.8611512184143066, -0.09045548737049103, -0.18201179802417755, -0.3581486940383911, -0.7678620219230652, -0.3240172564983368, 0.6535273790359497, 0.6268414855003357, -0.1436624675989151, -0.14745523035526276, 0.4223964512348175, 0.5644699931144714, 0.24891576170921326, -0.14784444868564606, 0.23876473307609558, 0.4673493206501007, -0.4610396921634674, -0.15402676165103912, 0.5404508709907532, 0.42384305596351624, -0.7690914273262024, -0.5632340908050537, -0.22033680975437164, 0.33258888125419617, -1.1623286008834839, -0.36104193329811096, 0.8029401898384094, -0.025613849982619286, -0.08661209791898727, -0.26992541551589966, -0.7969380617141724, -0.45151716470718384, 0.19832459092140198, -1.489668369293213, -0.7041682600975037, 0.43439626693725586, -0.18857011198997498, -0.49131616950035095, 0.16469179093837738, 1.3347244262695312, -0.03850188106298447, -0.752547025680542, 0.10786568373441696, 0.1650860458612442, -0.0017189657082781196, -0.5105646848678589, -0.832116961479187, 0.8567649722099304, 0.3286009132862091, 0.027830107137560844, 0.03495652973651886, 0.15347075462341309, 0.1871960610151291, -0.5634394884109497, 0.015834584832191467, 0.9088859558105469, -0.8541972637176514, -0.13710917532444, -0.5592809319496155, -0.6239794492721558, 0.3874698579311371, 0.5805256962776184, -0.5175683498382568, 0.11439669132232666, 0.2788376212120056, -0.2508789598941803, 0.10743685066699982, -0.6672617793083191, 0.39228057861328125, 0.6038015484809875, -0.6772340536117554, -0.2923525273799896, 0.17164906859397888, 0.787921667098999, -0.9804319143295288, -0.3703772723674774, -0.4273112714290619, -0.09635591506958008, -0.14369092881679535, 0.6227394938468933, -0.4592452049255371, 0.24982059001922607, 1.0539300441741943, -0.12422651052474976, -1.0286942720413208, -0.13335390388965607, -1.0065339803695679, 0.25213274359703064, 0.4700215458869934, 0.8042216300964355, -0.39750421047210693, -0.044442035257816315, 1.1789997816085815, 0.12195958942174911, -0.4582212567329407, -0.5780129432678223, -0.36996644735336304, 0.06580367684364319, -0.5992347598075867, 0.37747591733932495, -0.2663850784301758, 0.10010968893766403, 0.3962630033493042, 0.5945019125938416, 0.5632709264755249, -0.024855704978108406, -1.1310720443725586, 0.08300141245126724, -0.28778380155563354, -0.06974135339260101, -0.408502995967865, -0.5531488060951233, -1.2847563028335571, 0.1752750277519226, -1.2007609605789185, -0.030345506966114044, -0.8577108979225159, -0.30320578813552856, 0.447809100151062, -0.2912781238555908, 0.2767183780670166, 0.3362230360507965, -0.6952707171440125, -0.3494519889354706, -0.6439681053161621, -0.9464454054832458, 0.952499508857727, 1.0461910963058472, -0.8339909911155701, 0.07920382171869278, -0.22939062118530273, -0.00807688944041729, 0.21703219413757324, 0.44207295775413513, -0.25318294763565063, -0.6567566394805908, -1.625309944152832, 0.2964014410972595, -0.028473056852817535, 0.18399402499198914, -0.3618220090866089, 0.45303839445114136, 0.6133987903594971, -0.5418897867202759, -0.057505007833242416, 0.3453234136104584, -0.48880207538604736, -0.2324889600276947, 0.05256490781903267, -0.8486670851707458, 0.23381482064723969, -0.03352324292063713, -0.6303542852401733, -0.1515611857175827, 0.6176832318305969, -0.07471247762441635, -1.2138053178787231, -0.9127574563026428, 0.5045499205589294, -0.5654358863830566, 0.08429090678691864, -0.5957207083702087, -0.3308897614479065, -0.9280927777290344, -0.166500523686409, -0.1436641365289688, 0.42609313130378723, -0.17007549107074738, 1.024851679801941, 0.27540475130081177, -1.1857681274414062, 0.17569878697395325, 0.09256165474653244, 0.2867680788040161, -0.21459130942821503, 0.3072279095649719, 0.3383994698524475, 0.1242852732539177, 0.41807734966278076, 0.3229306936264038, 0.011226695030927658, -1.0726189613342285, -0.25792261958122253, 0.6643410325050354, -0.9155141711235046, -0.2211962193250656, 0.8501669764518738, -0.672329843044281, -1.2187649011611938, 0.23241236805915833, -1.2683554887771606, -0.48172086477279663, -0.5789349675178528, 0.5392166972160339, 0.20184524357318878, -0.044884227216243744, -0.04630658030509949, -0.05029262229800224, -0.04309329763054848, -0.13368815183639526, -1.0235998630523682, 0.7893972396850586, -0.23988452553749084, -0.22047428786754608, 0.9873453974723816, 1.1794383525848389, -1.3177175521850586, -0.9372632503509521, -0.8091537356376648, -0.4337308704853058, 0.1721261888742447, 0.7953023910522461, -0.6869509220123291, -0.37040597200393677, 0.9181678891181946, 0.8748754858970642, 0.0010372926481068134, -0.03764309734106064, 0.12425342947244644, 0.3625248074531555, 0.7400218844413757, 0.13659168779850006, -1.147172212600708, -0.35718411207199097, 1.5264487266540527, 0.9675003886222839, -1.0032598972320557, 0.03086054138839245, 0.22851800918579102, -0.9573307633399963, 0.6387172937393188, 0.20255330204963684, 0.49884387850761414, 0.8102026581764221, -0.29238399863243103, 0.5085924863815308, -0.19637523591518402, -1.295587420463562, -0.05285035818815231, 0.5918413400650024, 0.9967324733734131, 0.5430129170417786, 0.4741216003894806, 0.33722123503685, 1.0114758014678955, 0.030673732981085777, 0.2814289629459381, 0.4042574465274811, 0.38464775681495667, -0.18182097375392914, -0.043813902884721756, 0.16653603315353394, 0.7073325514793396, -0.4301295876502991, -0.801975667476654, -0.07756059616804123, 0.567758321762085, 0.032344356179237366, 0.592993438243866, 0.8226112723350525, 0.1572355479001999, 0.7209939956665039, 0.33943283557891846, 0.5771276950836182, -0.546768069267273, -0.1795792281627655, -0.24001391232013702, -0.35751962661743164, -0.33166858553886414, -0.06150065362453461, -0.7576030492782593, -0.21281927824020386, -0.11877702176570892, 0.058870382606983185, -0.0023760672193020582, 0.26113027334213257, 1.21829092502594, 0.36889955401420593, 0.2243332415819168, -0.18784008920192719, -0.314653605222702, -0.7572810649871826, -0.9594303965568542, 0.012583696283400059, -0.4129527509212494, -0.11206777393817902, -0.19816219806671143, -0.3189411461353302, -0.384299635887146]}, "authors": [{"authorId": "74884989", "name": "Davis Yoshida"}, {"authorId": "1700980", "name": "Kevin Gimpel"}], "references": [{"paperId": "209f9bde2dee7cf1677801586562ffe56d435d38", "title": "Learning How to Ask: Querying LMs with Mixtures of Soft Prompts"}, {"paperId": "a9fe5bd8da2d9603cf2cf6c6ea8b0f83c6d3a4f9", "title": "How many data points is a prompt worth?"}, {"paperId": "56fa0b9cba4d9aee5ccc327365b3b3a721031c69", "title": "Calibrate Before Use: Improving Few-Shot Performance of Language Models"}, {"paperId": "59641c10ed7431a3cf841f308367dc2dc0281b74", "title": "What Makes Good In-Context Examples for GPT-3?"}, {"paperId": "14c454c27dffd655cea839a0684a2d855117cd58", "title": "Back to the Future: Unsupervised Backprop-based Decoding for Counterfactual and Abductive Commonsense Reasoning"}, {"paperId": "ef3a96d8f42e8caa1994caba2e53ca98121b4d1f", "title": "Plug-and-Play Conversational Models"}, {"paperId": "07bcda1dff9bb696ea9cbc69303eee8bd3d85bd6", "title": "GeDi: Generative Discriminator Guided Sequence Generation"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "a75649771901a4881b44c0ceafa469fcc6e6f968", "title": "How Can We Know What Language Models Know?"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "e04a80263d252a3d8a382ba37a249b9345620570", "title": "Plug and Play Language Models: A Simple Approach to Controlled Text Generation"}, {"paperId": "cd63025532a62fa245a02ec05e32ac4d23089631", "title": "Dynamic Evaluation of Transformer Language Models"}, {"paperId": "29ddc1f43f28af7c846515e32cc167bc66886d0c", "title": "Parameter-Efficient Transfer Learning for NLP"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "3febb2bed8865945e7fddc99efd791887bb7e14f", "title": "Deep Contextualized Word Representations"}, {"paperId": "fa9decd1395cc2f39e9921f870ebc8a8ec2bd08d", "title": "Dynamic Evaluation of Neural Sequence Models"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "51a55df1f023571a7e07e338ee45a3e3d66ef73e", "title": "Character-level Convolutional Networks for Text Classification"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "687bac2d3320083eb4530bf18bb8f8f721477600", "title": "Recursive Deep Models for Semantic Compositionality Over a Sentiment Treebank"}, {"paperId": "53d8b356551a2361020a948f64454a6d599af69f", "title": "Prefix-Tuning: Optimizing Continuous Prompts for Generation"}, {"paperId": null, "title": "Flax: A neural network library and ecosystem for JAX"}, {"paperId": null, "title": "Haiku: Sonnet for JAX"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "JAX: composable transformations of Python+NumPy programs"}]}