{"paperId": "8971d2a43a11b4beca31afadf88d5ed8cda75297", "abstract": "\u2014The amounts of data that need to be transmitted, processed, and stored by the modern deep neural networks have reached truly enormous volumes in the last few years calling for the invention of new paradigms both in hardware and software development. One of the most promising and rapidly advancing frontiers here is the creation of new numerical formats. In this work we focus on the family of block \ufb02oating point numerical formats due to their combination of wide dynamic range, numerical accuracy, and ef\ufb01cient hardware implementation of inner products using simple integer arithmetic. These formats are characterized by a block of mantissas with a shared scale factor. The basic Block Floating Point (BFP) format quantizes the block scales into the nearest powers of two on the right. Its simple modi\ufb01cation - Scaled BFP (SBFP) - stores the same scales in full precision and thus allows higher accuracy. In this paper, we study the statistical behavior of both these formats rigorously. We develop asymptotic bounds on the inner product error in SBFP- and BFP-quantized normally distributed vectors. Next, we re\ufb01ne those asymptotic results to \ufb01nite dimensional settings and derive high-dimensional tight bounds for the same errors. Based on the obtained results we introduce a performance measure assessing accuracy of any block format. This measure allows us to determine the optimal parameters, such as the block size, yielding highest accuracy. In particular, we show that if the precision of the BFP format is \ufb01xed at 4 bits, the optimal block size becomes 64 . All theoretical derivations are supported by numerical experiments and studies on the weights of publicly available pretrained neural networks.", "venue": "arXiv.org", "year": 2022, "citationCount": 2, "influentialCitationCount": 1, "openAccessPdf": {"url": "https://arxiv.org/pdf/2210.05470", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "This work develops asymptotic bounds on the inner product error in SBFP- and BFP-quantized normally distributed vectors and derives high-dimensional tight bounds for the same errors, and introduces a performance measure assessing accuracy of any block format."}, "embedding": {"model": "specter_v2", "vector": [0.09276514500379562, 0.383402943611145, -0.47010648250579834, -0.45930707454681396, -0.13808231055736542, 0.4833746552467346, 0.2825040817260742, -0.2994285225868225, -0.7549126744270325, 0.4224444627761841, 0.08314039558172226, 0.17772746086120605, 0.35054290294647217, -0.1371106654405594, -0.7815009951591492, -0.35930344462394714, -1.2965800762176514, -0.4368762671947479, -0.4383324384689331, -0.35842999815940857, 0.04418884590268135, -0.12304023653268814, -0.8050561547279358, -0.10694971680641174, 0.08874055743217468, 1.9113181829452515, -0.20411843061447144, 0.6549509167671204, -0.5151731371879578, 0.398400217294693, 0.188079372048378, -0.5921881198883057, 0.8415659666061401, 0.2897107005119324, 0.12404733151197433, -0.5688868165016174, 0.4397124648094177, -0.8528172969818115, -1.2636995315551758, 1.4883944988250732, -0.3542311191558838, 0.46136677265167236, 0.21491190791130066, -0.7107155323028564, -0.2407456785440445, 0.09696950763463974, 0.4879494309425354, 0.6246764659881592, -0.70219486951828, -0.2623756527900696, 0.9055541157722473, -0.9314680099487305, -0.186140775680542, 1.1565662622451782, 0.8409619927406311, 0.024191508069634438, -0.29144012928009033, -0.8555450439453125, -0.03758637607097626, -0.15162083506584167, -0.7016947865486145, -0.12116918712854385, 0.029042132198810577, -0.06184251233935356, 1.0653156042099, -0.16023065149784088, -0.027211612090468407, 0.5251637697219849, 0.602199375629425, 0.6802191734313965, 0.6066396236419678, -0.9840471148490906, 0.1930457204580307, 0.05078716576099396, 0.7436053156852722, 0.2521902918815613, 0.1880055069923401, 0.5811372399330139, -1.2483148574829102, -0.1266581118106842, 0.5576381087303162, 0.07526417076587677, -0.10559328645467758, -0.1448865681886673, -0.14361605048179626, 0.7553227543830872, 0.7774511575698853, -0.04553158953785896, -0.4082391560077667, 1.4614008665084839, 0.5608760118484497, 0.2023312896490097, 0.3833991587162018, -0.21577319502830505, -0.04647226631641388, 0.026595212519168854, -0.7428411841392517, -0.012788170017302036, 0.07640571892261505, 1.0191022157669067, -0.17243443429470062, 0.4193125367164612, -0.4448333978652954, 0.17222826182842255, 1.4353280067443848, 0.546531081199646, 0.35356613993644714, -0.3904542624950409, 0.3441447913646698, -0.9224562644958496, 0.3913237154483795, -0.7972542643547058, -0.05237293988466263, -0.5984843373298645, -1.202035665512085, -0.6026100516319275, -0.4436202943325043, -0.16996799409389496, -0.8707135915756226, 0.41323116421699524, -0.3269234895706177, 0.13485780358314514, -0.056503843516111374, 0.5488830208778381, 0.34687909483909607, 0.9975553154945374, -0.2846420109272003, 0.05157144367694855, 0.9745352268218994, -0.4771172106266022, -0.8434880375862122, -0.4273192882537842, 0.3122451603412628, -0.21462032198905945, -0.08797319233417511, 0.1748814731836319, -1.4687223434448242, -1.050217866897583, -1.179073452949524, 0.2080608457326889, -0.6105060577392578, 0.20430921018123627, 1.0841623544692993, 0.4713798761367798, -0.9701765775680542, 0.9201813340187073, -0.4021403193473816, 0.1484517604112625, 0.868251383304596, 0.8254292011260986, 0.2918488681316376, -0.003091163234785199, -1.081438422203064, 0.40468829870224, 0.2703653573989868, -0.3547230362892151, 0.5205156207084656, -0.6116964221000671, -0.860770583152771, 0.4202748239040375, -0.483144611120224, -0.7471537590026855, 0.6767251491546631, -0.004146709106862545, -0.9795171022415161, 0.14982961118221283, 0.1128668263554573, -0.7302300930023193, 0.11770827323198318, -0.07247403264045715, -0.6798000335693359, 0.0589684434235096, -0.6334764361381531, 0.9623908996582031, 0.5876148343086243, -0.08796986192464828, -0.15423975884914398, 0.020000489428639412, -0.337551474571228, -0.4381088614463806, -0.7236036658287048, 0.7916136384010315, -0.016605142503976822, -0.9234610199928284, 0.38343244791030884, 0.41661015152931213, -0.031617458909749985, 0.40377485752105713, -0.0779707133769989, -0.503193199634552, 0.3879643678665161, 0.10192160308361053, 1.1003062725067139, -1.1398931741714478, -1.2785727977752686, 0.24367164075374603, -0.04847569391131401, -0.172799751162529, -0.310162752866745, 0.24859754741191864, -0.477811336517334, 0.25722575187683105, 0.27682191133499146, -0.28297796845436096, 0.04867104813456535, -0.2919202148914337, -1.0003412961959839, 0.2196650505065918, -0.2005654126405716, 0.8345348238945007, -0.10174399614334106, 0.6475042104721069, -0.01642787456512451, 0.32292309403419495, -0.8245267868041992, 0.9897874593734741, 0.08847837150096893, -0.4331907331943512, 0.4778124988079071, -0.4345553517341614, 0.6539141535758972, -0.7457833290100098, -0.1708647608757019, -0.7826396822929382, 0.2407882809638977, 0.6794871687889099, -0.6833570599555969, 1.0867042541503906, -0.1517970710992813, 0.8359522819519043, 0.25848814845085144, -0.5333534479141235, 0.42140331864356995, 0.1121700257062912, -0.05705277621746063, -0.3415175974369049, 0.5504596829414368, 0.201630637049675, -0.4862706661224365, 0.6890305876731873, 0.5821366310119629, 1.0390143394470215, -0.08532384783029556, 0.18905000388622284, 0.5592061281204224, -0.026416532695293427, 0.5611771941184998, 0.03366939723491669, 0.4023559093475342, -0.16916456818580627, 0.8162379264831543, -0.1326947808265686, 0.13037969172000885, -1.1442586183547974, -0.44760218262672424, 0.7326412796974182, 0.25327545404434204, 0.8402771353721619, 0.3160300552845001, -0.6796637177467346, -0.5493311882019043, -0.19825521111488342, 0.14018505811691284, 1.0720317363739014, -0.005136888008564711, -0.11995866149663925, -0.511958122253418, -0.15302450954914093, 0.09390249103307724, -0.5647384524345398, -0.40695711970329285, 0.021556438878178596, -0.5172734260559082, -1.2729970216751099, 0.8013910055160522, 0.4028635025024414, 1.093009114265442, -0.11617568880319595, -0.19015076756477356, -0.7553339600563049, 0.830684244632721, -0.5984346866607666, -0.5670797824859619, 0.751399040222168, -0.6489737629890442, 0.23335573077201843, -0.15265794098377228, 0.23766940832138062, 0.35255804657936096, -0.5350472927093506, 0.5749632716178894, -0.4912150204181671, 0.1479654163122177, 0.031522300094366074, 0.3764556050300598, -0.8254812955856323, -0.36596840620040894, -0.4009626507759094, 0.06446146965026855, -0.004699051380157471, 0.22272294759750366, 0.02298424020409584, -0.43981167674064636, -0.3191835880279541, -0.4353711009025574, -0.06097136437892914, 0.37544897198677063, 0.6264943480491638, 0.375159353017807, -0.5399811863899231, 0.021121961995959282, -0.5661202669143677, 0.8273532390594482, 0.3351611793041229, -0.8217124342918396, -0.016933850944042206, -0.6199647784233093, -0.04926610738039017, 0.3610701262950897, -0.22442340850830078, 0.22901783883571625, -0.959476888179779, 0.059610720723867416, -0.7372488379478455, -0.3170355260372162, -0.0841490775346756, 0.8519699573516846, -0.6013305187225342, 0.5658419728279114, 0.3147094249725342, 0.5586860775947571, 0.2533096671104431, 0.4490479528903961, -0.11074036359786987, 0.7034356594085693, 0.21108917891979218, 0.06309228390455246, 0.13173644244670868, 0.17832885682582855, -0.47665834426879883, -0.37731724977493286, -0.3842286467552185, -0.16002650558948517, -0.1967591792345047, -0.029645079746842384, -0.5995284914970398, -0.5996674299240112, -0.16234999895095825, -0.9994292855262756, 0.3729229271411896, -0.14728739857673645, 0.47601643204689026, -0.47258469462394714, -1.0582292079925537, -1.4709947109222412, -0.5691397786140442, -1.0480934381484985, -0.9616389274597168, 0.22721968591213226, 0.055726319551467896, -0.3021271228790283, -0.2996903359889984, -0.6758575439453125, -0.7973399758338928, 0.9826267957687378, -0.5928828716278076, 0.504601240158081, -0.19821803271770477, 0.008365155197679996, -0.27674639225006104, -0.3334100842475891, 0.7559263110160828, -0.4777001440525055, 0.10276046395301819, -0.7101904153823853, 0.19089309871196747, 0.0972229465842247, -0.24626199901103973, 0.06510384380817413, 0.4622436463832855, 0.8594287037849426, -0.3854031264781952, -0.08539297431707382, 0.8523160219192505, 1.2287333011627197, -0.5713768005371094, 0.1520240157842636, 0.06794777512550354, 0.610916018486023, -0.3662550151348114, -0.27927079796791077, 0.9485835433006287, -0.9407639503479004, 0.26032575964927673, 0.23340679705142975, 0.27300339937210083, -0.15164130926132202, -0.09681553393602371, 0.27027085423469543, 1.3121192455291748, 0.7975648045539856, -0.006870399694889784, -0.44011297821998596, 0.03121344931423664, -0.7058121562004089, -0.9455137252807617, 0.6344754099845886, 1.052290916442871, 0.2866821587085724, 0.191087543964386, -0.3488965630531311, 0.14952312409877777, 0.670929491519928, 0.6314034461975098, -0.20607754588127136, -0.5217839479446411, -0.13358886539936066, 0.740241289138794, 1.0754601955413818, -0.1761758029460907, -0.9050137400627136, -0.3812388479709625, 14.866020202636719, 1.1388107538223267, -0.7558967471122742, 0.17697615921497345, 0.9884279370307922, 0.08608037978410721, 0.25579702854156494, -0.6052501797676086, -1.480697751045227, 0.9277203679084778, 1.4064799547195435, 0.22473300993442535, 0.4495946168899536, 0.6348104476928711, 0.007367302197962999, 0.1476413458585739, -0.43496766686439514, 1.5567289590835571, 0.3630959987640381, -1.9383562803268433, -0.06554390490055084, 0.11554881930351257, 0.6496962308883667, 0.8282440304756165, 1.0113567113876343, 0.2088487446308136, -0.057606425136327744, -0.7644681930541992, 0.6998135447502136, 0.19387368857860565, 1.148224949836731, -0.02483096905052662, 0.5817207098007202, 0.27550745010375977, -0.4277840852737427, 0.15744487941265106, -0.7651427984237671, -1.3866173028945923, -0.2095050811767578, 0.7210848331451416, -0.32104891538619995, -0.5062815546989441, 0.03408108651638031, 0.8078224658966064, 0.3198988437652588, 0.8243741393089294, 0.26973944902420044, 0.9353918433189392, -0.65469890832901, -0.48887965083122253, 0.08458470553159714, 0.06848403066396713, 0.050532951951026917, -0.2674536108970642, 0.5261972546577454, -0.1439920961856842, -0.12882815301418304, 0.5041310787200928, -0.8500728011131287, -0.17443622648715973, -0.12975828349590302, -0.07703544944524765, 0.010755245573818684, 0.8402945399284363, 0.3314194083213806, -0.08571482449769974, -0.4880191385746002, 0.105324387550354, 0.7442289590835571, 0.25255075097084045, -0.38122808933258057, -0.4291391968727112, 0.5544200539588928, -0.732467532157898, 0.3194770812988281, 0.3668338358402252, -1.4683696031570435, -0.49016740918159485, -0.37520676851272583, -0.43202006816864014, 0.1934901475906372, -1.231627345085144, -1.1271263360977173, 0.7468791007995605, -0.22880055010318756, -0.7272739410400391, 0.7396805882453918, -1.436891794204712, -0.09105043858289719, 0.40990209579467773, -0.9010266065597534, 0.0949477106332779, 0.0857560783624649, -0.47516465187072754, -0.594692051410675, 0.04653438180685043, 0.6907486319541931, 0.015897054225206375, -0.22331508994102478, 0.38347721099853516, 0.62387615442276, 0.29772475361824036, -0.11543932557106018, -0.5482684373855591, 0.43812426924705505, 0.4326280653476715, 0.0607575923204422, 0.6624370813369751, -0.08403187990188599, 0.21152879297733307, -0.5348288416862488, 0.04752181097865105, -0.4627695381641388, -0.28546735644340515, 0.4163932502269745, -0.6872628927230835, -0.6141809821128845, 0.21546006202697754, 0.32506898045539856, 0.37777191400527954, 0.10523713380098343, -0.005872298963367939, -0.4403047561645508, -0.6351978778839111, -0.5288469195365906, 0.11056546866893768, 0.04884522780776024, -0.4026607573032379, -0.307478129863739, -0.07782362401485443, -0.026153115555644035, -1.1612569093704224, -1.022517204284668, 0.3072665333747864, 0.0013177575310692191, -0.44956138730049133, 1.0689246654510498, -0.4375961124897003, 0.9724419713020325, 0.848542332649231, -0.6246035099029541, -0.6154494881629944, 0.3899925947189331, -0.9515321850776672, -0.25908970832824707, -0.3175438642501831, 0.22648753225803375, -0.7437838912010193, 0.6240330934524536, 0.7521265149116516, 0.06175639107823372, -0.7735726833343506, -1.0110352039337158, -0.29080918431282043, -0.2867322564125061, -0.5652015805244446, 0.1868499368429184, -0.7913737893104553, -0.009532607160508633, -0.39930933713912964, 0.2775677442550659, 0.3059784471988678, -0.32379940152168274, -0.366462379693985, 0.1831953227519989, 0.14263401925563812, -0.14275936782360077, -0.7059399485588074, -1.109761357307434, -2.2573201656341553, 0.002657665405422449, -1.1563557386398315, -0.19263800978660583, -0.19321000576019287, -0.6114823818206787, -0.04468530789017677, -0.3877512216567993, -0.550794243812561, 0.5977898240089417, 0.498224139213562, -0.37905046343803406, -0.1383463740348816, -0.3307717740535736, 0.8655068278312683, 0.485195130109787, -0.5958843231201172, 0.48492661118507385, -0.10980865359306335, 0.5116953253746033, 0.5933799743652344, 0.3792354464530945, -0.16843248903751373, -0.3258763551712036, -0.8698883056640625, 0.4009593725204468, -0.09084530174732208, 0.07915296405553818, -1.2181570529937744, 0.6651723384857178, 0.4913521111011505, 0.5060815215110779, -0.11484532058238983, 0.7410072088241577, -1.0989733934402466, -0.36427226662635803, 0.4988199472427368, -0.9938247799873352, 0.09201931953430176, 0.1413409262895584, -0.17682674527168274, -0.15964992344379425, 0.469866007566452, 0.19267180562019348, -0.08514285087585449, -0.20784953236579895, 0.46424588561058044, -0.09896516799926758, 0.09543336182832718, 0.17761966586112976, -0.11930671334266663, -1.3236744403839111, -0.32564711570739746, -0.25151342153549194, -0.19315394759178162, -0.37419915199279785, 0.2630990743637085, 0.2928285598754883, -1.4683828353881836, 0.6123778223991394, 0.8667420744895935, -0.265031099319458, -0.43327197432518005, 0.06953555345535278, 0.48577752709388733, -1.2601537704467773, 0.6987632513046265, 0.07651657611131668, -0.1031404584646225, -0.6769194006919861, -0.1210545226931572, 0.3366067111492157, -0.13729073107242584, -0.27775779366493225, 1.2135282754898071, -0.35368096828460693, -0.3591144382953644, 0.5228776335716248, -1.3400028944015503, -0.0012422616127878428, -0.4862101376056671, 0.5285501480102539, 0.5215787887573242, 0.4262996017932892, 0.012053776532411575, 0.036558229476213455, -0.15075910091400146, 0.06418396532535553, -0.2875560224056244, 0.05399608984589577, -0.12010142207145691, -0.45915737748146057, 0.5327746272087097, 1.2688332796096802, -0.7037565112113953, -0.676192581653595, -0.3854369819164276, -0.5930950045585632, -0.6889415383338928, 0.20264706015586853, 0.006022462155669928, -0.6708172559738159, 0.9632163047790527, 0.913443922996521, 0.4333089590072632, 0.3708658814430237, -0.6801571249961853, 0.4920206665992737, 0.6326363682746887, 0.2905484139919281, -0.2810989022254944, -0.6753748059272766, 1.1219500303268433, 1.1320656538009644, -0.6145057082176208, 0.7473365664482117, -0.6445373296737671, 0.20469321310520172, 1.0190792083740234, 0.36672085523605347, -0.5003460049629211, 1.3845181465148926, 0.1172654777765274, -0.17069211602210999, 0.453722208738327, -0.8676589131355286, 0.2992868721485138, 1.163356900215149, 0.5199396014213562, 0.5531333088874817, -0.08496241271495819, -0.17434412240982056, 0.9892662763595581, -0.5126516819000244, 0.07381587475538254, 0.4644724428653717, 0.431812584400177, -0.3413485884666443, 0.5150426626205444, -0.6048301458358765, 1.293168544769287, -0.8799623847007751, -0.7060295939445496, 0.6502164006233215, 0.8194212913513184, -0.2013690024614334, 0.3028131425380707, 1.0644515752792358, 0.040990229696035385, 0.08812987059354782, -0.04915603622794151, 0.5734127163887024, -0.18310996890068054, -0.29343801736831665, -0.2597649097442627, -0.6792487502098083, -0.1558874547481537, -0.21071630716323853, 0.008856155909597874, -0.18127626180648804, -0.6083486676216125, 0.1835404336452484, 0.13156530261039734, 0.36859098076820374, 0.5210861563682556, 0.5164695978164673, 0.3091093897819519, -0.2653641998767853, -0.5961847901344299, -0.7570973634719849, -0.8883760571479797, -0.12200161069631577, -0.18438349664211273, -0.20323775708675385, -0.12829755246639252, -0.1793370395898819, -0.31284859776496887]}, "authors": [{"authorId": "2054192", "name": "I. Soloveychik"}, {"authorId": "3072554", "name": "I. Lyubomirsky"}, {"authorId": "153316152", "name": "Xin Wang"}, {"authorId": "3369003", "name": "S. Bhoja"}], "references": [{"paperId": "f756e993e6eba8d7c3db74838a348ed3a79bc1cc", "title": "Nvidia Hopper GPU and Grace CPU Highlights"}, {"paperId": "090d5c1b5ee2b2ea9bfb68bcb0e839363cff4d00", "title": "The AI Chip Race"}, {"paperId": "6c761cfdb031701072582e434d8f64d436255da6", "title": "AMMUS : A Survey of Transformer-based Pretrained Models in Natural Language Processing"}, {"paperId": "d8d2e574965fe733eb1416e03df2b5c2914fc530", "title": "A Survey of Transformers"}, {"paperId": "0c201c52260963665e0d30b3fe0fa31291af210b", "title": "VS-Quant: Per-vector Scaled Quantization for Accurate Low-Precision Neural Network Inference"}, {"paperId": "16f2d2f2b8103ed0c4a4e6f339a21247e58c5e78", "title": "Bottleneck Transformers for Visual Recognition"}, {"paperId": "1aa219b2069de522081980d2d9d764958197e545", "title": "Pushing the Limits of Narrow Precision Inferencing at Cloud Scale with Microsoft Floating Point"}, {"paperId": "097210dc65924f8ce59523faf444e635523dc714", "title": "TernaryBERT: Distillation-aware Ultra-low Bit BERT"}, {"paperId": "fa5853fdef7d2f6bb68203d187ddacbbddc63a8b", "title": "High-Dimensional Probability: An Introduction with Applications in Data Science"}, {"paperId": "1b0c8b26affd13e10ace5770e85478d60dcc368e", "title": "GOBO: Quantizing Attention-Based NLP Models for Low Latency and Energy Efficient Inference"}, {"paperId": "f4fe039b47490d96b0511fae33ceb240b87baa8f", "title": "TRADI: Tracking deep neural network weight distributions"}, {"paperId": "ce106590145e89ea4b621c99665862967ccf5dac", "title": "Q8BERT: Quantized 8Bit BERT"}, {"paperId": "4fb8fd55b476909a26a8dc594e0ae98d4923ad4d", "title": "Q-BERT: Hessian Based Ultra Low Precision Quantization of BERT"}, {"paperId": "f5dcdf616c3af51210631d39981de7c131682887", "title": "Benchmarking TPU, GPU, and CPU Platforms for Deep Learning"}, {"paperId": "e7fd6848cb29ca221a7e17d823e06fb566f1f135", "title": "Mixed Precision Training"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "086359333f18f422fe9b5a5e86914c2faa1fed4f", "title": "Sur La Distribution Limite Du Terme Maximum D'Une Serie Aleatoire"}, {"paperId": "3388ee254ce41dfe23f0d50b52cf52c43ec23064", "title": "Limiting forms of the frequency distribution of the largest or smallest member of a sample"}, {"paperId": "1107363fc2acf13f5bf5168af5f9042a07bd0a8e", "title": "Hardware-friendly compression and hardware acceleration for transformer: A survey"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "e4fda232836c0d83733c55d70efb0b7a378bce22", "title": "Sur la loi de probabilit\u00e9 de l'\u00e9cart maximum"}, {"paperId": null, "title": "Block floating point (BFP) for efficient deep neural net inference"}, {"paperId": null, "title": "La distribution de la plus grande de n valeurs"}, {"paperId": null, "title": "On a modification of Chebyshev\u2019s inequality and of the error formula of Laplace"}]}