{"paperId": "18b7c2bc5877485b23b50e58bc771b74f6823e30", "abstract": "Recently, pre-trained Transformer [14] based language models such as BERT [3] and GPT [9], have shown great improvement in many Natural Language Processing (NLP) tasks. However, these models contain a large amount of parameters. The emergence of even larger and more accurate models such as GPT2 [8] and Megatron, suggest a trend of large pre-trained Transformer models. As a result, using these models in production environments is a complex task requiring a large amount of compute, memory and power resources. In this work, we show how to perform quantization-aware training during the fine tuning phase of BERT in order to compress BERT by 4\u00d7 with minimal accuracy loss. Furthermore, the produced quantized model can accelerate inference speed by optimizing it to 8bit Integer supporting hardware.", "venue": "", "year": 2019, "citationCount": 5, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work shows how to perform quantization-aware training during the fine tuning phase of BERT in order to compress BERT by 4\u00d7 with minimal accuracy loss and the produced quantized model can accelerate inference speed by optimizing it to 8bit Integer supporting hardware."}, "embedding": {"model": "specter_v2", "vector": [0.38852760195732117, 0.7456573843955994, -0.6057189106941223, -0.20925065875053406, -0.489477276802063, -0.32465383410453796, 0.34473931789398193, 0.10573438555002213, -0.42796364426612854, -0.10462097078561783, 0.40077611804008484, -0.5076315402984619, 0.49984675645828247, -0.10080190002918243, 0.17910996079444885, 0.28397536277770996, -1.0043213367462158, 0.6744920611381531, -0.1641152799129486, -0.16591039299964905, -0.2339424192905426, -0.6113053560256958, -0.59379643201828, 0.21215903759002686, 0.32600581645965576, 0.530949056148529, -0.03249794617295265, 0.7038800716400146, -0.7175730466842651, 0.2739276587963104, 0.32585760951042175, -0.6593241691589355, 0.2526008188724518, 0.3896709978580475, -0.15328849852085114, -0.3924429714679718, 0.21093666553497314, -0.42225319147109985, -0.3657624125480652, 1.0864167213439941, -0.4182654917240143, 0.21047408878803253, 0.41118600964546204, -0.9839249849319458, -0.5483213067054749, 1.3500821590423584, 0.5013555288314819, 0.8442534804344177, -0.5790836215019226, -0.5185100436210632, 1.4519834518432617, -1.065227746963501, 0.11155862361192703, 1.5805983543395996, 0.3111778497695923, 0.39984095096588135, -0.4600527882575989, -0.7820810079574585, 0.12866319715976715, 0.19149459898471832, -0.8976448178291321, -0.37310048937797546, -0.21977989375591278, 0.20795424282550812, 1.9273401498794556, -0.23335206508636475, 0.24605219066143036, 0.3883271813392639, -0.10655151307582855, 1.2381401062011719, 0.0554860420525074, -1.083126187324524, -0.22784742712974548, -0.026442689821124077, -0.07681243866682053, 0.9084405899047852, -0.5188085436820984, 0.4183102250099182, -0.7984374165534973, -0.2613230049610138, 0.3221200704574585, -0.27715203166007996, 0.4936862289905548, 0.21076686680316925, -0.1585291177034378, 0.9678372740745544, 0.4337870478630066, 0.8774637579917908, 0.08971147239208221, 0.8482483625411987, 0.8800452351570129, 0.24468204379081726, -0.23139792680740356, 0.5215909481048584, -0.4061723053455353, 0.1391887366771698, -1.0028432607650757, 0.17889592051506042, -0.005303269252181053, 0.7375631928443909, -0.15351229906082153, 0.4513120949268341, -1.1042921543121338, -0.03880089893937111, 1.0701605081558228, 0.5288880467414856, 0.2331477701663971, -0.7187017798423767, 0.2464986890554428, -0.6627360582351685, 0.08240502327680588, -0.6645752191543579, -0.04473605006933212, -0.05772821605205536, -0.7563960552215576, -1.7138906717300415, -0.5370433330535889, -0.09870468825101852, -1.0179722309112549, 0.6115950345993042, -0.40750852227211, -0.012704766355454922, 0.2641133964061737, 0.2739063501358032, 0.3649316430091858, 0.8777198791503906, 0.24227923154830933, 0.09555722028017044, 1.5040322542190552, -0.6210492253303528, -0.8740565776824951, -1.0923023223876953, 0.7160013318061829, -0.02211904339492321, -0.08804565668106079, -0.30865222215652466, -1.1287990808486938, -0.7707003355026245, -0.38159260153770447, -0.22759082913398743, -0.629465639591217, 0.44747164845466614, 1.1411688327789307, 1.01930570602417, -1.2747985124588013, 0.37233567237854004, -0.2763338088989258, -0.05520222708582878, 0.29689088463783264, 0.17805762588977814, 0.4395606517791748, -0.22044548392295837, -1.6183364391326904, 0.3194839060306549, 0.6284985542297363, -0.2659812867641449, 0.10713499784469604, -0.30552560091018677, -1.1989468336105347, 0.3556549549102783, 0.4080435037612915, -0.2736395299434662, 1.4449342489242554, 0.27351248264312744, -1.4108561277389526, 0.6319769620895386, -0.71079021692276, -0.38662147521972656, -0.4964306652545929, 0.0003598470357246697, -0.5923532843589783, -0.414305180311203, -0.25921404361724854, 0.6090433597564697, 0.2346913069486618, 0.21443255245685577, -0.26667946577072144, 0.08617151528596878, 0.1197143942117691, -0.055970702320337296, -0.3064596652984619, 1.1796469688415527, -0.5111355185508728, -0.0923415869474411, 0.31263792514801025, 0.58808833360672, -0.3371424078941345, 0.00680592330172658, -0.5660356879234314, -1.0095466375350952, 0.7754101157188416, 0.017720893025398254, 0.9946462512016296, -0.9729710817337036, -0.83033686876297, 0.09719692915678024, -0.14612635970115662, 0.16414599120616913, -0.7723553776741028, 0.9263878464698792, -0.38369548320770264, 0.7201097011566162, -0.14823292195796967, -0.8837470412254333, 0.43569087982177734, 0.07586889714002609, -0.9445372223854065, -0.4103251099586487, 0.10363753139972687, 1.2866411209106445, -1.0054948329925537, -0.20774567127227783, 0.2980758547782898, 0.4538002908229828, -1.244013786315918, 0.7245112061500549, -0.7378290891647339, -0.0013741151196882129, -0.15954546630382538, -0.10254517197608948, 0.15848518908023834, -0.022231178358197212, 0.44931095838546753, -0.5709808468818665, -0.5126514434814453, 0.6294795274734497, -0.2058243453502655, 1.2151299715042114, -0.29867660999298096, 0.5469018220901489, -0.10083988308906555, -0.8627796173095703, 0.28902217745780945, 0.6245461106300354, -0.27413317561149597, -0.4700230658054352, 0.2077900469303131, 0.6396678686141968, -0.5024892091751099, 0.31478551030158997, 1.1342668533325195, 0.6706584095954895, -0.2716403901576996, -0.027600040659308434, 0.2969760000705719, -0.6080461740493774, 0.5085904002189636, 0.5119199156761169, 0.5225242376327515, -0.09971898794174194, 0.5405063629150391, -0.019598333165049553, 0.3040158450603485, -0.6854355335235596, 0.03683190792798996, 0.6154993176460266, 0.3504898250102997, 0.5464264750480652, 0.7638394236564636, -0.4325854182243347, -0.24971270561218262, 0.20722998678684235, 0.459842324256897, 1.2650184631347656, -0.5029165744781494, -0.6839702725410461, -0.2842988967895508, -0.29324278235435486, -0.3845411241054535, 0.2994621694087982, -0.09185794740915298, 0.12411074340343475, -0.5973169207572937, -0.8958721160888672, 1.1612493991851807, 0.07859759032726288, 0.6096320748329163, -0.45121780037879944, -0.28493788838386536, -0.3781934678554535, 0.12120512872934341, -1.1531604528427124, -0.2731013894081116, 0.9171444177627563, -0.6021819114685059, 0.0831318274140358, 0.45749780535697937, -0.08538852632045746, 0.03459552302956581, -1.0322904586791992, 0.6794642806053162, -0.6194397807121277, -0.1595340520143509, -0.256933331489563, 0.19807755947113037, -0.5383724570274353, -0.76764315366745, -0.09617916494607925, -0.1195649728178978, -0.5240157842636108, 0.4625064432621002, 0.5357218980789185, 0.19276346266269684, -0.5197958946228027, -0.6338332295417786, 0.09464485198259354, -0.1314484179019928, 0.3533177077770233, 0.5744287371635437, 0.15936627984046936, -0.5434908270835876, -1.0574871301651, 0.6175819635391235, 0.5234360694885254, -0.7734887003898621, 0.021667348220944405, -0.2593837380409241, 0.11424529552459717, 0.8501873016357422, -0.21545089781284332, -0.0746232122182846, -0.7534108757972717, -0.2589428424835205, -0.1706077605485916, 0.058948397636413574, 0.6757060289382935, 0.49408942461013794, 0.3001802861690521, 0.22182129323482513, 0.6220468878746033, 0.27025356888771057, 0.09665847569704056, 0.9078705310821533, -0.43013566732406616, 0.2802022397518158, 0.1795632690191269, 0.4798052906990051, -0.20255272090435028, -0.05470367521047592, -0.6081281304359436, -0.5732007622718811, -0.4020858705043793, -0.07516734302043915, 0.33808574080467224, 0.19345159828662872, -0.3952430784702301, -0.6602888107299805, -0.32226842641830444, -1.0746303796768188, -0.04383485019207001, 0.04373771324753761, -0.3227875530719757, 0.08618545532226562, -0.7340394854545593, -1.3943110704421997, -0.7361328601837158, -0.7931933403015137, -1.1006273031234741, 0.9629358649253845, -0.28741714358329773, -0.020953886210918427, -0.7094277739524841, -0.08046814799308777, -0.2986065149307251, 0.940090000629425, -0.6589145064353943, 1.306900143623352, -0.0930250808596611, -0.0318414606153965, -0.031110664829611778, -0.14351306855678558, 0.25793710350990295, -0.24589818716049194, 0.5460144281387329, -0.6910701394081116, 0.2583869993686676, -0.5634023547172546, -0.5291666388511658, 0.16872696578502655, 0.24222877621650696, 0.9805137515068054, -0.14928577840328217, -0.5250946879386902, 0.41453471779823303, 1.5744080543518066, -0.5554518103599548, 0.35722815990448, -0.23751550912857056, 0.7073203325271606, -0.28203561902046204, -0.088157519698143, 0.5740352869033813, 0.0877433642745018, 0.49347159266471863, 0.3401238024234772, 0.16494351625442505, 0.42827296257019043, -0.2991008460521698, 0.5527800917625427, 1.5154073238372803, 0.5615831017494202, -0.3459760844707489, -1.1621928215026855, 0.3074783980846405, -0.8311397433280945, -0.725810170173645, 0.616936981678009, 0.25137341022491455, 0.7566677331924438, -0.16888242959976196, -0.7091349363327026, 0.058874424546957016, 0.36353394389152527, 0.52259361743927, 0.053159162402153015, -1.0879510641098022, 0.16568079590797424, 0.7558560371398926, 0.5594775676727295, 0.5472384095191956, -0.6130139827728271, 0.8628004789352417, 14.672694206237793, 1.1206727027893066, -0.3502214848995209, 0.1695798933506012, 0.6027647852897644, 0.8129849433898926, -0.4733114242553711, -0.06693441420793533, -1.4631452560424805, -0.3142210841178894, 1.1944550275802612, -0.05766937881708145, 0.5347906947135925, 0.2744787335395813, -0.02044622413814068, 0.16753807663917542, -0.4548974633216858, 0.6057682633399963, 0.45101043581962585, -1.28734290599823, 0.3852197527885437, 0.2341301441192627, -0.15947289764881134, 0.44834405183792114, 0.696223258972168, 0.9873929023742676, 0.5143811106681824, -0.6285808086395264, 0.4809698164463043, -0.26465511322021484, 1.0215301513671875, -0.05850479006767273, 0.6541032791137695, 0.8272820115089417, -1.031563639640808, -0.2792482376098633, -0.7513847351074219, -1.0536777973175049, 0.14190025627613068, 0.3537296950817108, -0.9701907634735107, -0.289424866437912, -0.34749630093574524, 0.5644525289535522, 0.32187286019325256, 0.3533816933631897, -0.23053471744060516, 0.8519780039787292, -0.3254181742668152, -0.2889178395271301, 0.6339887380599976, 0.2889455556869507, 0.4991591274738312, -0.1789831966161728, 0.2266039103269577, 0.112614206969738, 0.34847086668014526, 0.39411529898643494, -0.3892335593700409, -0.15413667261600494, -0.13455238938331604, -0.7975113391876221, -0.035414181649684906, 0.8557644486427307, 0.14503557980060577, 0.30590078234672546, -0.13085930049419403, 0.3957655131816864, 0.9157519340515137, -0.06103958562016487, -0.331695020198822, 0.024318907409906387, 0.08233030140399933, -0.6698973774909973, 0.37514999508857727, 0.3325295150279999, 0.11693911999464035, -0.4742811322212219, -0.9051886200904846, -0.6382570862770081, 0.3989836573600769, -0.6525847911834717, -0.652042806148529, 0.8669447302818298, -0.3164234161376953, -0.25189414620399475, 0.28245359659194946, -1.1657534837722778, 0.2878773808479309, 0.44874274730682373, -1.6996732950210571, -0.6136202812194824, 0.8166977167129517, -0.42351722717285156, -0.5374068021774292, 0.45433810353279114, 1.9776800870895386, -0.04168696701526642, -0.2963235378265381, -0.09590105712413788, 0.6275715231895447, 0.31613245606422424, -0.48273348808288574, -1.0263769626617432, 0.919137716293335, 0.2883886992931366, 0.12234067916870117, 0.43675288558006287, -0.06740409135818481, 0.16290181875228882, -1.0126521587371826, -0.4409097731113434, 0.9891601204872131, -0.7466519474983215, -0.051254335790872574, -1.1206152439117432, -0.25946712493896484, 0.4393526613712311, 0.39032021164894104, -0.2921142578125, 0.29614996910095215, 0.07869476079940796, -0.5129883885383606, -0.12183379381895065, -0.8933544754981995, 0.3395240604877472, 0.37105754017829895, -0.9067517518997192, -0.2296907752752304, -0.015960155054926872, 0.42495331168174744, -1.334497332572937, -0.6329368948936462, -0.10544252395629883, 0.15248939394950867, 0.040552448481321335, 1.009453296661377, -0.17799118161201477, 0.7455312013626099, 0.9844068884849548, -0.4356589615345001, -0.7998505234718323, 0.032932572066783905, -0.6034417748451233, -0.18409013748168945, -0.2935871183872223, 0.6311676502227783, -0.2247256487607956, 0.5240914225578308, 0.8151718378067017, 0.19890862703323364, -0.4546523988246918, -0.8184738159179688, -0.25496143102645874, -0.07317452132701874, -0.5083503127098083, 0.37945979833602905, -0.35983574390411377, 0.29947221279144287, 0.21324415504932404, 0.3567190170288086, 0.6257256865501404, -0.46058395504951477, -0.5318976044654846, 0.053806304931640625, 0.12971088290214539, -0.17068907618522644, -0.06519521772861481, -0.8053556084632874, -1.6301223039627075, 0.13018526136875153, -1.3319802284240723, 0.1875954121351242, -0.8184811472892761, -0.4995400309562683, -0.3688385486602783, -0.13668827712535858, 0.3118017315864563, 0.4270213544368744, -0.02433662675321102, -0.491985946893692, -0.8594093918800354, -0.16752104461193085, 0.9952435493469238, 0.711398184299469, -0.9123510122299194, 0.2881859838962555, -0.246482253074646, 0.14700506627559662, 0.10910914093255997, 0.32158732414245605, -0.39069321751594543, -0.9416654109954834, -1.4802085161209106, 0.47664785385131836, 0.17864103615283966, -0.1774865835905075, -0.5312986969947815, 0.5920122265815735, 0.3466585874557495, -0.5140162110328674, -0.28191807866096497, 0.6851997375488281, -1.1743873357772827, -0.6634103059768677, 0.5455619096755981, -0.6718884706497192, 0.11041798442602158, 0.3951951563358307, -0.6566763520240784, -0.30813494324684143, 0.4364376366138458, -0.2986936867237091, -1.0162136554718018, -0.7502482533454895, 0.5835408568382263, -0.5752260088920593, 0.18321268260478973, -0.4012034237384796, -0.27698975801467896, -0.83156818151474, -0.17198088765144348, 0.10996399819850922, 0.39563724398612976, -0.746198832988739, 0.5456652045249939, 0.37452784180641174, -0.620973527431488, 0.32274308800697327, 0.32469579577445984, -0.08908752351999283, -0.28674253821372986, -0.07343780994415283, 0.06274133175611496, -0.5236517786979675, 1.1058608293533325, 0.2214498072862625, 0.21157698333263397, -0.9901331067085266, -0.053390730172395706, 0.688822329044342, -0.6585951447486877, -0.4744246304035187, 1.2372053861618042, -0.9119789004325867, -1.2562570571899414, 0.2910858392715454, -1.8429635763168335, -0.6074354648590088, -0.5806975364685059, 0.5586735010147095, -0.3790718615055084, 0.08224434405565262, 0.017094440758228302, -0.5562919974327087, -0.22347937524318695, 0.22744756937026978, -0.5975098609924316, 0.3283191919326782, 0.191398486495018, -0.7486497759819031, 0.4908296465873718, 0.8063037395477295, -0.5361847281455994, -0.09520777314901352, -0.5838360786437988, -0.3178819417953491, -0.26679256558418274, 0.43235671520233154, -0.2264256477355957, -0.5941017866134644, 0.8804647326469421, 0.2534377872943878, 0.5198793411254883, 0.1951707899570465, -0.5854499340057373, 0.5648564100265503, 1.1226482391357422, 0.4750441908836365, -0.3030069172382355, -0.7507964968681335, 1.8167836666107178, 0.9182249307632446, -0.8659583330154419, 0.008854084648191929, -0.8491198420524597, -0.5811115503311157, 0.9072181582450867, 0.001756254001520574, 0.2421259880065918, 1.1382925510406494, 0.05560623109340668, -0.05917826667428017, 0.05249246582388878, -0.8662421703338623, -0.30570146441459656, 0.6079314351081848, 0.9153187274932861, 0.7375538945198059, 0.3640422523021698, 0.09010648727416992, 0.8114614486694336, -0.31039461493492126, 0.12844352424144745, 0.3822616636753082, 0.5459146499633789, -0.10111289471387863, -0.2766570746898651, -0.036308202892541885, 0.8917219638824463, -0.6417142152786255, -1.346360683441162, 0.35429641604423523, 0.537329912185669, 0.2798328101634979, 0.6072648763656616, 0.8826887011528015, 0.1570500284433365, 0.37851274013519287, 0.1912127137184143, 0.6124976873397827, -0.8600906133651733, -0.19032347202301025, -0.5121140480041504, -0.44900649785995483, -0.014576642774045467, -0.18519403040409088, -0.19273726642131805, -0.4613149166107178, -0.31342798471450806, 0.09904444962739944, 0.43724188208580017, 0.2795242667198181, 0.8034917712211609, 0.19737139344215393, 0.16282376646995544, -0.49545565247535706, 0.13101260364055634, -0.7077460885047913, -0.7973619699478149, -0.28081175684928894, -0.8987325429916382, -0.20581009984016418, 0.26162436604499817, 0.11412764340639114, -0.19110538065433502]}, "authors": [{"authorId": "1387202086", "name": "Ofir Zafrir"}, {"authorId": "3150063", "name": "Guy Boudoukh"}, {"authorId": "2477428", "name": "Peter Izsak"}, {"authorId": "2134755", "name": "Moshe Wasserblat"}], "references": [{"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "3366e9eb81880d172752d4397cb8e9e6de02b935", "title": "Efficient 8-Bit Quantization of Transformer Neural Machine Language Translation Model"}, {"paperId": "ec4eba83f6b3266d9ae7cabb2b2cb1518f727edc", "title": "Cross-lingual Language Model Pretraining"}, {"paperId": "03f8754ab20732ebda02ce6e65ec9bfcce17528a", "title": "Marian: Cost-effective High-Quality Neural Machine Translation in C++"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "59d0d7ccec2db66cad20cac5721ce54a8a058294", "title": "Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "05dd7254b632376973f3a1b4d39485da17814df5", "title": "SQuAD: 100,000+ Questions for Machine Comprehension of Text"}, {"paperId": "642d0f49b7826adcf986616f4af77e736229990f", "title": "Deep Compression: Compressing Deep Neural Network with Pruning, Trained Quantization and Huffman Coding"}, {"paperId": "eb42cf88027de515750f230b23b1a057dc782108", "title": "Very Deep Convolutional Networks for Large-Scale Image Recognition"}, {"paperId": "62c76ca0b2790c34e85ba1cce09d47be317c7235", "title": "Estimating or Propagating Gradients Through Stochastic Neurons for Conditional Computation"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": "fbeaa499e10e98515f7e1c4ad89165e8c0677427", "title": "Improving the speed of neural networks on CPUs"}, {"paperId": null, "title": "Future directions for nlp in commercial environments"}, {"paperId": null, "title": "Compressing bert for faster prediction"}]}