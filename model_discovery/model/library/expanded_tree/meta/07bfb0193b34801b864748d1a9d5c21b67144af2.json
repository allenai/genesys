{"paperId": "07bfb0193b34801b864748d1a9d5c21b67144af2", "abstract": "We introduce Breadth-First Pipeline Parallelism, a novel training schedule which optimizes the combination of pipeline and data parallelism. Breadth-First Pipeline Parallelism lowers training time, cost and memory usage by combining a high GPU utilization with a small batch size per GPU, and by making use of fully sharded data parallelism. Experimentally, we observed an increase of up to 43% in training throughput for a 52 billion-parameter model using a small batch size per GPU compared to Megatron-LM, which would reduce the training time and cost by the same amount on a large GPU cluster.", "venue": "", "year": 2022, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": null, "embedding": {"model": "specter_v2", "vector": [-0.011827266775071621, 0.27828845381736755, -0.3591947853565216, 0.043302468955516815, 0.03398365527391434, 0.3335765302181244, 0.3957931697368622, -0.20263224840164185, -0.8277103900909424, -0.5915106534957886, 0.19488760828971863, -0.029183659702539444, 0.4795742332935333, 0.16367566585540771, -0.11323502659797668, 0.04386847838759422, -1.1576950550079346, 0.1757187843322754, 0.5908867120742798, -0.2749733030796051, -0.17439043521881104, 0.09918943792581558, -1.5905637741088867, 0.49592241644859314, 0.05427508428692818, 0.6366250514984131, 0.05813395977020264, 0.8532342314720154, -0.18355531990528107, 0.1629227250814438, 0.6105384826660156, 0.3160558342933655, 0.4905286431312561, -0.016034912317991257, -0.3073708713054657, -0.29533326625823975, 0.42967867851257324, -0.3288767635822296, -0.585163950920105, 0.26384252309799194, -0.1707947850227356, 0.5171811580657959, -0.09296082705259323, -1.0744603872299194, 0.9711509943008423, 0.39223676919937134, -0.13194282352924347, 1.2204864025115967, -0.8359434008598328, -0.5831473469734192, 0.8095634579658508, -1.200236439704895, 0.16631582379341125, 1.1793861389160156, 0.584265947341919, 0.3931378722190857, -0.29330316185951233, -0.4334559738636017, 0.3148267865180969, -0.16794951260089874, -0.5483356714248657, -0.13522869348526, 0.02552577666938305, -0.6439512968063354, 2.063809633255005, -0.1390388458967209, 0.15980754792690277, -0.033734582364559174, 0.11060119420289993, 1.1792963743209839, 0.040963999927043915, -0.7278724908828735, -0.06022823229432106, 0.06989520788192749, 0.9553104639053345, 0.5673484206199646, -0.05050806701183319, 0.5251449942588806, -1.6325559616088867, -0.29004135727882385, 0.7400825619697571, 0.06384826451539993, 0.4702582359313965, -0.2123071849346161, -0.15497814118862152, 0.8519079089164734, 0.4513525068759918, 0.5385388135910034, -0.1284540742635727, 0.6486444473266602, 0.7631363272666931, 0.1588248610496521, -0.12133629620075226, 0.14032022655010223, 0.03494622930884361, 0.5778794884681702, -1.0487014055252075, 0.14454872906208038, -0.13343918323516846, 0.8635992407798767, -0.00038293798570521176, 0.40283823013305664, -0.6753127574920654, -0.004075175616890192, 1.2923728227615356, -0.26104453206062317, 0.3098316192626953, -0.29264456033706665, 0.5588743686676025, -0.586711585521698, -0.018980801105499268, -0.4766485095024109, -0.9531282782554626, -0.4673774540424347, -0.9078700542449951, -0.5963805317878723, -0.5964416265487671, -0.19637368619441986, -0.6553593277931213, 0.30276158452033997, 0.09294396638870239, 0.20882806181907654, 0.1591770499944687, 0.7481553554534912, 0.7069617509841919, 0.5083836913108826, 0.5997937321662903, 0.3634226620197296, 1.2334091663360596, -1.6047234535217285, -0.2047453671693802, -0.7884463667869568, 0.38659408688545227, -0.07579106092453003, -0.22538284957408905, -0.3717306852340698, -1.200844168663025, -1.3928412199020386, -1.101410150527954, 0.05714918300509453, -0.21991275250911713, -0.025106698274612427, 1.6570748090744019, 0.20652355253696442, -1.1265989542007446, 1.251631736755371, -0.4725183844566345, -0.04847246780991554, 0.19247756898403168, 0.6224121451377869, 0.24367360770702362, 0.13531745970249176, -1.0996285676956177, -0.15621232986450195, 0.5989626049995422, -0.4336000680923462, -0.32422003149986267, -0.8797422051429749, -0.4567553699016571, -0.034880056977272034, -0.1998312920331955, -0.8633884787559509, 1.1840330362319946, -0.06130803003907204, -1.0922282934188843, 0.7300954461097717, 0.09242061525583267, -0.005087532568722963, 0.3402692377567291, 0.13299378752708435, -0.5369460582733154, -0.12492326647043228, -0.6209744215011597, 0.9753122329711914, 0.44178566336631775, 0.02875560149550438, -0.4847825765609741, -0.3292239010334015, -0.31223976612091064, 0.32782772183418274, -0.6409212946891785, 1.0541739463806152, -0.6788107752799988, -0.05105360969901085, 0.607650876045227, 0.45751452445983887, -0.5023626089096069, -0.3176070749759674, -0.155425563454628, -0.6496773362159729, 0.65269535779953, 0.3081560730934143, 0.8487597107887268, -1.106804609298706, -1.0524839162826538, 0.17989419400691986, 0.11086506396532059, -0.12337124347686768, -0.5118951201438904, 0.7563275098800659, -0.5617175698280334, 0.1722850203514099, 0.20673392713069916, -1.0078699588775635, -0.4682103395462036, -0.23168042302131653, -0.5935855507850647, -0.5069722533226013, -0.06074626371264458, 0.7441442012786865, -0.5908799171447754, 0.09411752969026566, -0.4580591320991516, 0.37814196944236755, -0.9831475019454956, 1.1753169298171997, -0.2883150279521942, 0.4971032738685608, -0.06506191194057465, -0.6684638261795044, 0.40291333198547363, -0.26897257566452026, 0.46824243664741516, -0.5986565947532654, -0.31024035811424255, 0.13855500519275665, -0.5527792572975159, 1.4187874794006348, -0.12369538843631744, 0.13025377690792084, 0.0810011699795723, -0.3047395348548889, 0.13706429302692413, 0.28152355551719666, 0.025907551869750023, -0.3785149157047272, 0.3937118649482727, 0.41755086183547974, -0.3918713331222534, 0.33989042043685913, 0.9005041718482971, 1.2663917541503906, -0.08757162094116211, 0.2905333638191223, 0.5247673988342285, -0.22026778757572174, 0.5547995567321777, 0.32068511843681335, 0.3999485671520233, 0.42896077036857605, -0.20507082343101501, -0.5019669532775879, 0.24570859968662262, -0.37984463572502136, 0.05157249793410301, 0.556506872177124, 0.7377375364303589, 0.4921034872531891, 0.3966079652309418, -0.9233852624893188, -0.6615786552429199, 0.16570010781288147, 0.6983662843704224, 1.6335573196411133, -0.24054309725761414, 0.072115458548069, -0.6575173735618591, -0.34670305252075195, -0.16564100980758667, -0.47585490345954895, -0.21285532414913177, 0.051012083888053894, -0.931621789932251, -1.1342109441757202, 0.6079592108726501, 0.2908473312854767, 1.3167634010314941, -0.5456798672676086, -0.9794114232063293, -0.6592028737068176, 0.9495682716369629, -0.6800848841667175, -0.4733174443244934, 0.6495494246482849, -1.3201484680175781, -0.041458070278167725, 0.13052237033843994, -0.2386447638273239, 0.3782501816749573, -0.09969903528690338, 1.161797285079956, -0.2020629346370697, -0.4317227005958557, -0.310849130153656, 0.7213048934936523, -0.5251779556274414, -0.31112140417099, 0.04136072099208832, -0.07556355744600296, -0.2641788721084595, 0.03524991497397423, 0.30814531445503235, -0.20024895668029785, 0.08884190768003464, -0.36674270033836365, 0.655998945236206, -0.03939071670174599, 0.09142877906560898, 0.9286202192306519, 0.07238952815532684, -0.135162815451622, -1.413623332977295, 0.6506927609443665, 0.11404527723789215, -0.6344897150993347, -0.18701893091201782, -0.3287070691585541, -0.20309627056121826, 0.5759993195533752, -0.4409424960613251, -0.3861943483352661, -0.5278226137161255, -0.03177949786186218, -0.7354673147201538, -0.1287202090024948, -0.14706328511238098, 0.5810517072677612, -0.5927042365074158, 0.5256434082984924, 0.06992883235216141, 0.6193304061889648, -0.225578173995018, 0.21016159653663635, -0.8761212825775146, 0.2598533034324646, 0.2298087179660797, -0.28579282760620117, 0.07910460233688354, 0.30172115564346313, -0.9105911254882812, -0.4779526889324188, -0.7826898694038391, -0.3630632162094116, -0.21037635207176208, 0.1805443912744522, -0.5905230045318604, -1.1125596761703491, 0.20051638782024384, -0.8088484406471252, -0.2978208661079407, 0.1268370896577835, 0.0798785388469696, -0.16201554238796234, -0.9954673051834106, -1.4146747589111328, -0.18343444168567657, -1.2290831804275513, -1.1339929103851318, 0.3432631492614746, 0.586046576499939, 0.0780094712972641, -0.6098942756652832, -0.19549666345119476, -0.5697588920593262, 0.8789982199668884, -0.2631046175956726, 0.5209818482398987, -0.14478525519371033, -0.029526423662900925, 0.03194936364889145, 0.035879433155059814, 0.29511865973472595, -0.7914204597473145, 0.2095133662223816, -0.7955200672149658, 0.2430708259344101, -0.18691560626029968, -0.5548584461212158, 0.6032981276512146, 0.15907268226146698, 1.0368324518203735, 0.4517565369606018, -0.7028318047523499, 0.5335850715637207, 1.5712915658950806, -0.8564589023590088, -0.08780936896800995, -0.293507844209671, 1.147072672843933, 0.16710688173770905, -0.32337120175361633, 0.7102078795433044, -0.0901709794998169, 0.5889972448348999, 0.20129716396331787, -0.5877888798713684, -0.38447871804237366, -0.1664094626903534, -0.15664005279541016, 1.3414533138275146, 0.6670268177986145, 0.3864966034889221, -0.9124543070793152, 0.3193112313747406, -1.1213346719741821, -0.363077849149704, 0.2148437649011612, 1.0023829936981201, 0.21687506139278412, -0.0861845463514328, 0.41792598366737366, -0.3298230469226837, 0.6290166974067688, 0.10507170110940933, -0.5204134583473206, -0.9564334154129028, 0.25591665506362915, 0.5050094723701477, 0.5141093134880066, 0.4572676122188568, -0.3060498535633087, 0.4426558017730713, 14.982064247131348, 0.7569093108177185, -0.11571402102708817, 0.45736807584762573, 0.8780110478401184, 0.23375611007213593, -0.32193249464035034, -0.22976210713386536, -1.7448643445968628, 0.030708275735378265, 1.3917975425720215, 0.5881117582321167, 0.42435696721076965, 0.46851804852485657, -0.044416770339012146, -0.20107506215572357, -0.46103107929229736, 0.6460345983505249, 0.2359720766544342, -1.3864638805389404, -0.10935088247060776, 0.06454456597566605, 0.38256943225860596, 0.9361716508865356, 0.36940798163414, 0.6050831079483032, 0.18059293925762177, -0.20019890367984772, -0.10303109884262085, 0.1860167682170868, 0.7073410153388977, -0.5419691205024719, 0.15126793086528778, 0.5234113335609436, -0.772638738155365, 0.046251002699136734, -0.3749132752418518, -1.0283535718917847, -0.0352819561958313, 0.28161340951919556, -0.5458685159683228, -0.18166464567184448, -0.2608649432659149, 0.18256016075611115, 0.3490963578224182, 0.6376259326934814, -0.03978175297379494, 0.4464549422264099, -0.44305694103240967, -0.01890658028423786, 0.020135547965765, 0.5543967485427856, -0.25998204946517944, 0.022791465744376183, -0.4472131133079529, 0.07353856414556503, 0.2563120126724243, 0.021949466317892075, -0.20618091523647308, -0.37008771300315857, 0.22278143465518951, -0.1999320089817047, -0.2318546026945114, 1.3013479709625244, 0.24272122979164124, 0.39495205879211426, -0.4736897051334381, 0.1051214188337326, 0.5784373879432678, -0.2289956659078598, -0.3628748059272766, 0.025185473263263702, 0.3579436242580414, -0.7867264151573181, -0.2782272696495056, 0.12467093765735626, -0.7737674117088318, -0.237003892660141, -1.1176546812057495, -0.25608202815055847, 0.6519105434417725, -0.2906264364719391, -0.7057580947875977, 0.9393242001533508, -0.112181656062603, -0.356322705745697, 0.5823737978935242, -0.9909389019012451, -0.4668000042438507, 0.8310816287994385, -1.2206228971481323, -0.5077149271965027, -0.003840399207547307, -0.25527024269104004, -0.6810802817344666, 0.07034182548522949, 1.0555403232574463, -0.001515451935119927, -0.5873780250549316, 0.09563051164150238, -0.10689298808574677, -0.36322152614593506, -0.424809068441391, -0.3538382649421692, 1.1483302116394043, 0.2719305753707886, -0.23806509375572205, -0.13880234956741333, -0.275837779045105, 0.20937566459178925, -0.9185191988945007, -0.09671371430158615, 0.3534965217113495, -0.10675402730703354, -0.17369644343852997, -0.8089057207107544, -0.911999523639679, 0.04600159451365471, 0.6102961301803589, 0.10271541029214859, 0.7687426209449768, 0.14734825491905212, -0.23917156457901, -0.3209860920906067, -0.7141901254653931, 0.11565668135881424, 0.4419325888156891, -0.4110925793647766, -0.011597245000302792, 0.22328193485736847, 0.4319438636302948, -1.469303011894226, -0.8773825764656067, -0.2414572834968567, 0.04509784281253815, -0.160110205411911, 0.9066510796546936, -0.22745110094547272, 0.5669723153114319, 0.8861601948738098, 0.3282890021800995, -0.42763519287109375, 0.14117880165576935, -0.6258334517478943, 0.0798434317111969, -0.1967926323413849, 0.4014277756214142, -0.2622844874858856, 0.663806140422821, 0.964433491230011, -0.17802779376506805, -0.5153906941413879, -0.3522861897945404, -0.036346908658742905, -0.20199459791183472, -0.37435251474380493, 0.2039741575717926, -0.34327298402786255, 0.02013392746448517, 0.04710913449525833, 0.5557587146759033, 0.6498253345489502, -0.04111099615693092, -0.277190238237381, 0.3959762156009674, 0.009438718669116497, -0.6410844922065735, -0.6769558191299438, -0.24231331050395966, -1.2478572130203247, -0.465318500995636, -1.0111898183822632, -0.03616943955421448, -0.5220518708229065, -0.5116406083106995, -0.30406713485717773, -0.2527303397655487, 0.25858286023139954, 0.12944258749485016, -0.0803779661655426, -0.6012790203094482, -0.13042739033699036, -0.40205878019332886, 0.47909703850746155, 0.9662798047065735, -0.004493859130889177, -0.20670759677886963, -0.10761294513940811, 0.3932717442512512, 0.06918387115001678, 0.847409188747406, -0.12021392583847046, -0.9235975742340088, -1.2061233520507812, 0.2999638319015503, 0.2702556550502777, -0.317013144493103, -1.1306984424591064, 0.9893770813941956, 0.4155837893486023, 0.09898242354393005, -0.3764811158180237, 0.2659839689731598, -0.7467494010925293, -0.3395889103412628, 0.45204004645347595, -0.4375418722629547, 0.16644920408725739, 0.9734236001968384, -0.7312449216842651, -0.26353922486305237, 0.5745877027511597, 0.06069695204496384, -0.8243215680122375, -1.3828951120376587, 0.6091344356536865, -0.31993725895881653, 0.15601970255374908, -0.0669802725315094, -0.022052407264709473, -1.088607668876648, 0.7191284894943237, -0.13712970912456512, 0.8051329851150513, -0.49380090832710266, 0.6415438652038574, 0.12712058424949646, -0.9399466514587402, 0.3372455835342407, 0.6950922608375549, -0.4001331627368927, 0.18817834556102753, 1.2917088270187378, 0.6922619938850403, -0.6927137970924377, 0.3967791795730591, -0.4625561535358429, 0.08782929927110672, -0.9232702851295471, 0.0680934488773346, 0.8360852003097534, -0.5747305154800415, -0.25503721833229065, 1.3457872867584229, -0.4122564196586609, -0.8331941366195679, -0.0075201112776994705, -0.5848659873008728, -0.8367067575454712, -0.36666449904441833, 0.9898300766944885, 0.3388366997241974, 0.3359619081020355, 0.30392104387283325, -0.6225884556770325, -0.023503823205828667, -0.26517173647880554, -0.47610193490982056, 0.08113117516040802, 0.2543529272079468, -0.31612318754196167, 0.574907660484314, 0.5421128273010254, -0.6780362129211426, -1.1443920135498047, -0.4777224063873291, -0.2751308083534241, -0.14365006983280182, 0.3985051214694977, -0.20163170993328094, -0.8376078009605408, 0.948582112789154, 0.5127156376838684, 0.13625986874103546, 0.42535239458084106, -0.5234953761100769, 0.14363603293895721, 0.11607034504413605, 0.2235194742679596, -0.823614239692688, -0.4862080514431, 1.2539020776748657, 1.1339097023010254, -0.6862393617630005, 0.34670937061309814, -0.5561541318893433, -0.9460400342941284, 1.165413498878479, 0.7655670046806335, -0.5071038007736206, 1.0502463579177856, -0.14787189662456512, -0.29284611344337463, 0.04609180614352226, -0.8053035140037537, -0.24458730220794678, 0.8106257915496826, 0.7982053160667419, 0.5919921398162842, 0.05967187508940697, -0.09679602831602097, 0.7579007148742676, 0.26395413279533386, 0.018784647807478905, 0.23249709606170654, 0.5402045249938965, -0.1648808717727661, -0.12086544930934906, 0.22845128178596497, 0.39154502749443054, -0.5104368925094604, -0.4810146689414978, 0.5320661664009094, 1.032401442527771, 0.24431082606315613, 0.6225275993347168, 1.0318788290023804, -0.2179698795080185, 0.46915194392204285, -0.009219481609761715, 0.5302149653434753, -0.6117275953292847, -0.8610241413116455, 0.12425015866756439, -0.4234013259410858, -0.25519946217536926, 0.07509312033653259, -0.1639505922794342, -0.9286980628967285, -0.29639390110969543, 0.6511270403862, 0.22892309725284576, 0.7263850569725037, 0.6697034239768982, 0.8840980529785156, 0.8474949598312378, 0.12873636186122894, -0.6676241159439087, -0.3639497756958008, -0.7099190950393677, -0.1281864047050476, -0.6445944905281067, -0.7612985372543335, 0.11588369309902191, 0.2014058530330658, -0.5265006422996521]}, "authors": [{"authorId": "1404999623", "name": "J. Lamy-Poirier"}], "references": [{"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "bc8b82e8eb0b0714892e4ec7a54ebdf47c4fde96", "title": "Reducing Activation Recomputation in Large Transformer Models"}, {"paperId": "13a0d8bb38f739990c8cd65a44061c6534f17221", "title": "OPT: Open Pre-trained Transformer Language Models"}, {"paperId": "8342b592fe238f3d230e4959b06fd10153c45db1", "title": "Training Compute-Optimal Large Language Models"}, {"paperId": "7cbc2a7843411a1768ab762930707af0a3c33a19", "title": "Using DeepSpeed and Megatron to Train Megatron-Turing NLG 530B, A Large-Scale Generative Language Model"}, {"paperId": "72dd63d67588a42fc817bbb8d655b397f67425df", "title": "ZeRO-Infinity: Breaking the GPU Memory Wall for Extreme Scale Deep learning"}, {"paperId": "774591fdd988eaaff3917e7c5171d044b0843e63", "title": "Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM"}, {"paperId": "fdacf2a732f55befdc410ea927091cad3b791f13", "title": "Switch Transformers: Scaling to Trillion Parameter Models with Simple and Efficient Sparsity"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "e6c561d02500b2596a230b341a8eb8b921ca5bf2", "title": "Scaling Laws for Neural Language Models"}, {"paperId": "70fe1f854bc59092ded4bf2939a6624a80e5e4c3", "title": "ZeRO: Memory Optimization Towards Training A Trillion Parameter Models"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "eefa0df7c5678fa6004f8b48dbbc1c2696702fee", "title": "An Empirical Model of Large-Batch Training"}, {"paperId": "d79a26226393f687ddbc375e32055b40b8ad8d38", "title": "GPipe: Efficient Training of Giant Neural Networks using Pipeline Parallelism"}, {"paperId": "b2c8e834ac5f7be68b9ca3691d39925036dd74a3", "title": "Measuring the Effects of Data Parallelism on Neural Network Training"}, {"paperId": "2270b8628fd8ca67ae39d277f45bc3c38ac63d5f", "title": "Mesh-TensorFlow: Deep Learning for Supercomputers"}, {"paperId": "c314d97d75b4a988b106ddcec8a40a4d3bcdb8bd", "title": "PipeDream: Fast and Efficient Pipeline Parallel DNN Training"}, {"paperId": "3299aee7a354877e43339d06abb967af2be8b872", "title": "Don't Decay the Learning Rate, Increase the Batch Size"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "and Polosukhin, I. Attention is all you need"}]}