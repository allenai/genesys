{"paperId": "de29959e3eaade5fb871920ef07895c153753285", "abstract": "GEneral Matrix Multiply (GEMM) is a central operation in deep learning and corresponds to the largest chunk of the compute footprint. Therefore, improving its efficiency is an active topic of ongoing research. A popular strategy is the use of low bit-width integers to approximate the original entries in a matrix. This allows efficiency gains, but often requires sophisticated techniques to control the rounding error incurred. In this work, we first verify/check that when the low bit-width restriction is removed, for a variety of Transformer-based models, whether integers are sufficient for all GEMMs need -- for {\\em both} training and inference stages, and can achieve parity with floating point counterparts. No sophisticated techniques are needed. We find that while a large majority of entries in matrices (encountered in such models) can be easily represented by {\\em low} bit-width integers, the existence of a few heavy hitter entries make it difficult to achieve efficiency gains via the exclusive use of low bit-width GEMMs alone. To address this issue, we develop a simple algorithm, Integer Matrix Unpacking (IM-Unpack), to {\\em unpack} a matrix with large integer entries into a larger matrix whose entries all lie within the representable range of arbitrarily low bit-width integers. This allows {\\em equivalence} with the original GEMM, i.e., the exact result can be obtained using purely low bit-width integer GEMMs. This comes at the cost of additional operations -- we show that for many popular models, this overhead is quite small.", "venue": "arXiv.org", "year": 2024, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A simple algorithm is developed, IM-Unpack, to unpack a matrix with large integer entries into a larger matrix whose entries all lie within the representable range of arbitrarily low bit-width integers, which allows equivalence with the original GEMM."}, "embedding": {"model": "specter_v2", "vector": [0.7114912271499634, 0.7358457446098328, -0.571962296962738, 0.05365988239645958, -0.22536002099514008, 0.06866690516471863, 0.514725923538208, 0.23440775275230408, -0.3915773928165436, -0.044686753302812576, 0.004864763934165239, -0.23077012598514557, 0.5842922329902649, -0.34475117921829224, -0.6106801629066467, -0.15297213196754456, -0.9806039333343506, 0.3372620940208435, -0.2765091061592102, -0.10126461833715439, 0.21868431568145752, -0.2416488528251648, -1.0466524362564087, 0.26044097542762756, 0.09615558385848999, 1.1409361362457275, -0.3321242928504944, 0.6890684366226196, -0.36105191707611084, 0.9372493624687195, 0.5493679046630859, -0.9603639841079712, 0.8924625515937805, 0.5654065012931824, -0.1215767040848732, -0.36964672803878784, 0.7078244090080261, -0.8221322298049927, -0.7324612140655518, 1.0805647373199463, -0.44831201434135437, 0.2307637631893158, 0.057532768696546555, -1.2910447120666504, -0.24242942035198212, 0.6857306361198425, 0.20946872234344482, 0.5746556520462036, -0.9893727898597717, -0.4777270257472992, 1.5439399480819702, -1.424850583076477, -0.04934236407279968, 1.142562985420227, 0.8668367266654968, 0.11152632534503937, -0.5729352831840515, -0.7890754342079163, 0.35930919647216797, -0.04130632430315018, -0.6944079995155334, -0.4540195167064667, -0.11457274854183197, 0.09171642363071442, 1.542647361755371, -0.2702048420906067, -0.008354640565812588, 0.1157684251666069, 0.04207198694348335, 1.1316442489624023, 0.04836701601743698, -0.7847703099250793, -0.22145916521549225, -0.1059570461511612, 0.44252246618270874, 1.0037517547607422, 0.22507451474666595, 0.18118996918201447, -1.06782066822052, 0.03869133070111275, 0.47314077615737915, 0.2856571674346924, 0.14238886535167694, -0.4392911195755005, -0.4251590371131897, 0.8904838562011719, 0.6491583585739136, 0.19674564898014069, -0.36116325855255127, 1.3353468179702759, 0.42435067892074585, 0.32920631766319275, -0.1813131719827652, 0.16641858220100403, -0.0523926243185997, 0.6679133772850037, -0.7796493172645569, 0.1625397503376007, 0.14221590757369995, 0.5934653878211975, 0.017652636393904686, 0.24359609186649323, -0.5160317420959473, -0.26189330220222473, 0.9387393593788147, -0.15368999540805817, -0.021453501656651497, -0.45480960607528687, 0.7190194725990295, -0.6014329791069031, -0.04587060213088989, -0.8339104056358337, -0.0031667842995375395, -0.5701310634613037, -0.9712426662445068, -0.7508799433708191, -0.3155709207057953, 0.3454587161540985, -0.7851596474647522, 0.6535459160804749, -0.45851847529411316, 0.587803840637207, 0.05556824803352356, 0.224334254860878, 0.5673190355300903, 0.6511907577514648, -0.10959469527006149, 0.07151823490858078, 1.2572996616363525, -1.071027159690857, -0.3913896381855011, -1.353847622871399, 0.5177651643753052, -0.11276868730783463, -0.02872231788933277, -0.1150733232498169, -1.2901341915130615, -0.9076371192932129, -1.0276604890823364, -0.17220108211040497, -0.6972746253013611, 0.18053904175758362, 1.4580074548721313, 0.364665150642395, -1.037813663482666, 0.6078344583511353, -0.3300939202308655, 0.5340654850006104, 0.47931280732154846, 0.9128662347793579, 0.2471061497926712, -0.2860720753669739, -0.9101226329803467, 0.2508758306503296, 0.3089577257633209, -0.43584144115448, 0.05796961113810539, -0.5143724679946899, -0.9480764865875244, 0.27182310819625854, -0.04908997192978859, -0.5841801762580872, 1.1420742273330688, 0.19000783562660217, -0.3445715606212616, 1.1490124464035034, -0.33578261733055115, -0.6032562255859375, -0.14141319692134857, 0.13722729682922363, -0.20350071787834167, -0.23427614569664001, -0.29318442940711975, 1.0303467512130737, 0.5136940479278564, -0.28620582818984985, 0.13754802942276, -0.20907244086265564, -0.16132155060768127, -0.32176023721694946, -0.4170440435409546, 0.6374218463897705, -0.30657923221588135, -0.6050189137458801, 0.8999255895614624, 0.48249146342277527, -0.3644079864025116, 0.35050347447395325, -0.3362070918083191, -0.5233271718025208, 0.16464391350746155, 0.12389162927865982, 0.8986648321151733, -0.6943185925483704, -0.9056735038757324, 0.2265137881040573, 0.438742071390152, -0.12211423367261887, -0.46814486384391785, 0.35649949312210083, -0.7519552111625671, 0.1524285525083542, 0.05830061435699463, -0.8413602113723755, 0.17335544526576996, -0.17724104225635529, -0.9293434023857117, -0.005870501510798931, 0.1640949845314026, 0.8995872735977173, -0.5753086805343628, 0.31607091426849365, -0.04217529296875, 0.22725220024585724, -1.1906572580337524, 0.621683657169342, -0.19829723238945007, -0.6137279272079468, 0.36427006125450134, -0.023270392790436745, 0.5962806344032288, -0.7368786931037903, 0.6239997744560242, -0.8692349195480347, 0.14687079191207886, 0.6097859144210815, -0.6204708814620972, 0.8334429860115051, -0.07430415600538254, 0.4121791124343872, -0.00862713810056448, -1.106348991394043, 0.025709664449095726, 0.014428595080971718, -0.26227518916130066, -0.38779276609420776, 0.5629106760025024, 0.31246235966682434, -0.5442721247673035, 0.6616734266281128, 1.0276352167129517, 0.5732748508453369, 0.05193167179822922, -0.07933183759450912, 0.4246525764465332, -0.13303373754024506, 0.39465758204460144, 0.2856803238391876, 0.4748208820819855, -0.2354198694229126, 0.6618993878364563, 0.06444215029478073, 0.20060284435749054, -1.1616054773330688, -0.3756968677043915, 0.46158626675605774, 0.7562066912651062, 0.6296961307525635, 0.524978518486023, -0.9903488755226135, -0.310463011264801, -0.08041433990001678, 0.27681392431259155, 1.4102444648742676, -0.06713476032018661, -0.09142497181892395, -0.4563758373260498, -0.057638026773929596, -0.05710853636264801, -0.14949874579906464, -0.30095967650413513, -0.16061381995677948, -0.20463696122169495, -1.4876384735107422, 0.5861489176750183, 0.4923860728740692, 0.927542507648468, 0.14925916492938995, -0.34842073917388916, -0.3562074601650238, 0.24716776609420776, -0.9323984980583191, -0.36748453974723816, 1.2898554801940918, -1.0606290102005005, 0.16962796449661255, 0.2979793846607208, -0.5173966884613037, 0.3315611481666565, -0.5740029215812683, 1.1002568006515503, -0.17809942364692688, -0.13211746513843536, -0.43007344007492065, 1.105441927909851, -0.36841148138046265, -0.3121139705181122, -0.14249444007873535, 0.04398972913622856, 0.033185139298439026, 0.6456025838851929, -0.06013929843902588, 0.0614243783056736, -0.27583083510398865, -0.3424474596977234, 0.2472773790359497, 0.05353698879480362, 0.09368189424276352, 0.9102085828781128, -0.4121755063533783, 0.05724656581878662, -0.8133253455162048, 0.3549496531486511, 0.13878372311592102, -0.43771979212760925, -0.039213940501213074, -0.5843654870986938, 0.20204024016857147, 0.4459172487258911, -0.71217942237854, 0.683377206325531, -0.7382598519325256, 0.05635203793644905, -0.538955569267273, 0.23423108458518982, -0.30333253741264343, 0.45252999663352966, -0.41070249676704407, 0.4636048674583435, 0.16120019555091858, 0.39414265751838684, 0.2432854175567627, 0.5832153558731079, -1.0809768438339233, 0.9443827867507935, -0.10467350482940674, 0.30850696563720703, -0.14466410875320435, 0.1712254136800766, 0.09490316361188889, -0.6585075855255127, -0.07051672041416168, 0.3122977614402771, -0.09075314551591873, -0.119804747402668, -0.914643406867981, -1.0220752954483032, 0.00746255274862051, -0.7571378350257874, -0.036223553121089935, 0.03589407727122307, -0.13504141569137573, -0.1313832402229309, -1.101064920425415, -1.7286432981491089, -0.4755025804042816, -0.8441025018692017, -1.1996748447418213, 0.4124124348163605, 0.15463219583034515, -0.14231379330158234, -0.28621092438697815, -0.8568021059036255, -0.3267698287963867, 0.66689133644104, -0.332467645406723, 0.9244219064712524, -0.22092564404010773, -0.7206941246986389, -0.15517474710941315, -0.6516510248184204, 0.262922078371048, -0.7864783406257629, 0.07035702466964722, -1.0585739612579346, 0.33063364028930664, -0.47964397072792053, -0.5307179689407349, 0.30325180292129517, 0.12882062792778015, 1.0834202766418457, -0.44230493903160095, -0.4894985556602478, 0.716876208782196, 1.652983546257019, -0.7527371644973755, 0.413948655128479, 0.25999024510383606, 0.6820313334465027, -0.2734681963920593, -0.2869526445865631, 0.905483067035675, 0.2916487753391266, 0.1306150257587433, 0.9760285019874573, 0.03185681626200676, 0.02868472971022129, -0.37780386209487915, 0.1756930649280548, 0.7528231143951416, 0.46216776967048645, 0.17057599127292633, -0.7394015789031982, 0.674896240234375, -0.9631472826004028, -0.7914348244667053, 0.5540790557861328, 0.9837263226509094, 0.5532023310661316, 0.1606735736131668, -0.4751494526863098, 0.4263840913772583, 0.553933322429657, 0.7338778376579285, -0.21302124857902527, -0.6569350957870483, 0.03032071143388748, 1.071245789527893, 0.9659688472747803, 0.20664136111736298, -0.25687137246131897, 0.3227953016757965, 14.776557922363281, 0.7783524990081787, -0.059304073452949524, 0.29761233925819397, 1.0537090301513672, 0.17373409867286682, -0.6469266414642334, -0.05343369022011757, -1.488399863243103, -0.13531245291233063, 1.0296844244003296, 0.5611514449119568, 0.7827248573303223, 0.3408268392086029, -0.6387221217155457, 0.21713535487651825, -0.6976763010025024, 1.2163808345794678, 0.5280143618583679, -1.8292478322982788, 0.2220197319984436, 0.26389801502227783, 0.2117995023727417, 0.3720603585243225, 0.9401590824127197, 0.7303286194801331, 0.4371112883090973, -0.7089603543281555, 0.5331618785858154, 0.16999012231826782, 1.126619815826416, -0.2627631723880768, 0.4370138645172119, 0.251842737197876, -0.9825544357299805, -0.1788640171289444, -0.7062042355537415, -1.6664469242095947, -0.3778456747531891, 0.6192790269851685, -0.5802051424980164, -0.8117981553077698, -0.20013490319252014, 0.5811492800712585, 0.05701952055096626, 0.44159066677093506, 0.3731146454811096, 0.12071400880813599, -0.6339990496635437, 0.267290860414505, 0.22482387721538544, 0.1262420415878296, -0.5250877737998962, -0.3851626217365265, 0.39326974749565125, -0.4032559394836426, 0.16195529699325562, 0.3866659104824066, -0.9441375136375427, -0.3546257019042969, -0.27064377069473267, -0.26488223671913147, 0.1761275976896286, 0.9998726844787598, 0.14182493090629578, 0.29423749446868896, -0.387125700712204, 0.29261839389801025, 0.7743098735809326, -0.21102941036224365, -0.8237907886505127, -0.025709781795740128, 0.6292995810508728, -0.598828136920929, 0.0698942318558693, 0.7116881012916565, -0.95490562915802, -0.48707902431488037, -0.7292788028717041, -0.7588306665420532, 0.3695823848247528, -0.7595536112785339, -0.42705848813056946, 0.4755338132381439, -0.6720600724220276, -0.4675825238227844, 0.6648070216178894, -1.2491769790649414, -0.1638178825378418, 0.3139253258705139, -1.318162441253662, -0.38416242599487305, 0.10746504366397858, -0.4855266213417053, -0.6031578183174133, 0.1288687288761139, 1.0599284172058105, 0.30422714352607727, -0.27531078457832336, 0.49979540705680847, -0.1580001562833786, -0.06257617473602295, -0.22653192281723022, -0.5245261788368225, 1.0969232320785522, 0.4038126766681671, 0.18271440267562866, 0.6993617415428162, 0.004267547745257616, 0.7492408752441406, -0.7014612555503845, 0.005664874333888292, 0.7078335881233215, -0.6207608580589294, 0.15218184888362885, -0.38080716133117676, -0.12824244797229767, 0.7653030157089233, 0.2978435158729553, 0.24140691757202148, 0.4490795135498047, -0.08390291780233383, -0.9210752248764038, -0.4225935637950897, -0.8578725457191467, 0.2655726671218872, 0.4782641530036926, -0.7355993986129761, -0.045226480811834335, 0.10705257207155228, 0.24614593386650085, -1.1379319429397583, -0.7550215721130371, 0.028958367183804512, 0.1981831192970276, -0.4914246201515198, 1.592071294784546, -0.30960172414779663, 1.1415168046951294, 0.7052185535430908, -0.7022128105163574, -0.18032598495483398, 0.34966960549354553, -0.7671542763710022, -0.48949134349823, -0.1704513430595398, 0.5030408501625061, -0.619268000125885, 0.6150238513946533, 0.5318847298622131, 0.43172258138656616, -0.6876643896102905, -0.36039191484451294, 0.14105507731437683, -0.2902303636074066, -0.45125263929367065, 0.24344922602176666, 0.06941541284322739, -0.3576580584049225, 0.23045292496681213, 0.2815256118774414, 0.6941108107566833, -0.010775404050946236, -0.3432442545890808, 0.4019966423511505, -0.258617103099823, -0.3832945227622986, -0.3132610619068146, -0.8506783843040466, -1.7575451135635376, -0.2194863259792328, -1.4601554870605469, -0.3979968726634979, -0.9284838438034058, -0.41450050473213196, -0.04641718417406082, -0.12515614926815033, 0.26284268498420715, 0.21182392537593842, 0.5434024333953857, -0.4423430860042572, -0.6964816451072693, -0.3047519326210022, 0.4615646302700043, 0.5239736437797546, -0.4425432085990906, 0.7608896493911743, -0.08672603219747543, -0.2296116054058075, 0.4028928875923157, 0.3523554503917694, -0.2047751545906067, -0.6636645793914795, -0.9667424559593201, 0.820779025554657, 0.13957294821739197, 0.2770931124687195, -1.2850807905197144, 0.5339659452438354, 0.5018373131752014, -0.03085479512810707, -0.5039445161819458, 0.6008725166320801, -1.128650188446045, -0.38972753286361694, 0.6044806838035583, -0.41873452067375183, 0.34201985597610474, 0.4078783690929413, -0.3947424590587616, 0.014546582475304604, 0.3753822445869446, 0.1536855697631836, -0.6830835342407227, -0.6855146884918213, 0.42383691668510437, -0.265093058347702, 0.2674458920955658, -0.2182510793209076, -0.3802473545074463, -1.2792086601257324, -0.10146129876375198, 0.014628123492002487, 0.21014276146888733, -0.2766226530075073, 0.2613498568534851, 0.08915850520133972, -1.2361927032470703, 0.6648882627487183, 0.5883957147598267, 0.04507216811180115, 0.07968363910913467, 0.0015726782148703933, 0.5341258645057678, -0.9166825413703918, 0.10080312192440033, -0.011937315575778484, 0.4285992681980133, -0.7041066288948059, 0.18608851730823517, 0.5427566766738892, -0.8917039036750793, -0.1351483166217804, 1.3442251682281494, -0.20033608376979828, -1.1327285766601562, 0.2954728603363037, -1.6492657661437988, -0.024721158668398857, -0.15678027272224426, 0.6426185369491577, 0.15911991894245148, 0.32744625210762024, 0.4249032437801361, -0.45807990431785583, 0.08708439022302628, 0.12965980172157288, -0.05615076795220375, 0.3430638611316681, 0.3103003203868866, -0.7822417616844177, 0.15281103551387787, 1.0145909786224365, -0.4006977677345276, -0.717860996723175, -0.7605729699134827, -0.6493920087814331, -0.2346756011247635, 0.20115254819393158, 0.08143468201160431, -1.0192995071411133, 0.8514791131019592, 0.28113481402397156, 0.2994086444377899, 0.3534758388996124, -0.7730819582939148, 0.36627987027168274, 0.9494172930717468, 0.2663264572620392, -0.18857711553573608, -0.4192545413970947, 1.0101609230041504, 0.6696890592575073, -0.6385859847068787, 0.3692281246185303, -0.5004896521568298, -0.4452840983867645, 0.8669225573539734, 0.37056413292884827, -0.07006319612264633, 0.647209882736206, 0.5606000423431396, -0.5258088111877441, 0.5078935027122498, -0.908438503742218, -0.23368801176548004, 0.6242431998252869, 0.8350403308868408, 0.735093355178833, 0.139261856675148, 0.3516724407672882, 1.0992412567138672, -0.3472956418991089, 0.11212199181318283, 0.45252057909965515, 0.31305694580078125, -0.3793632984161377, 0.23706336319446564, -0.42356446385383606, 1.0536162853240967, -0.8910751342773438, -1.366521954536438, 0.4957146942615509, 0.7218397259712219, 0.38152390718460083, 0.19056741893291473, 1.0618834495544434, -0.22619086503982544, 0.14254063367843628, 0.33731570839881897, 0.6314514875411987, -0.2731983959674835, -0.3038625121116638, -0.631800651550293, -0.49530237913131714, 0.10790862888097763, -0.10812419652938843, 0.12078877538442612, -0.5858327150344849, -0.7997164726257324, 0.16706758737564087, -0.35715851187705994, 0.09897053986787796, 0.5969422459602356, 0.21552637219429016, 0.7076454162597656, -0.302789568901062, -0.8594485521316528, -0.7777542471885681, -0.3962326645851135, 0.06888587027788162, -0.9039193987846375, -0.26167356967926025, -0.09710855036973953, -0.28741881251335144, -0.3159140944480896]}, "authors": [{"authorId": "35292426", "name": "Zhanpeng Zeng"}, {"authorId": "1720300", "name": "Karthikeyan Sankaralingam"}, {"authorId": "2290838305", "name": "Vikas Singh"}], "references": [{"paperId": "a8b995f0da78a79447dfb18c2337972b044f4239", "title": "LLM-FP4: 4-Bit Floating-Point Quantized Transformers"}, {"paperId": "56b828717f32251a5e0f0be9c0113077f23c8429", "title": "QuIP: 2-Bit Quantization of Large Language Models With Guarantees"}, {"paperId": "b3c64a046d6cfc0f55a2aebc5176bbab69a7e021", "title": "Stable and low-precision training for large-scale vision-language models"}, {"paperId": "529ddd65f6c252aaea91d6a8e5b55b7bc3951841", "title": "RepQ-ViT: Scale Reparameterization for Post-Training Quantization of Vision Transformers"}, {"paperId": "2c994fadbb84fb960d8306ee138dbeef41a5b323", "title": "SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models"}, {"paperId": "b5e71069f091d52f474a2928ed07b6546157af82", "title": "Towards Accurate Post-Training Quantization for Vision Transformer"}, {"paperId": "9fb327c55a30b9771a364f45f33f77778756a164", "title": "I-ViT: Integer-only Quantization for Efficient Vision Transformer Inference"}, {"paperId": "1ee05cd919590eaba129caa0fda5e850c87b75a5", "title": "FQ-ViT: Post-Training Quantization for Fully Quantized Vision Transformer"}, {"paperId": "7b8f3f65a98340d6e5ab94bd9a4ccb8f75704fd8", "title": "I-BERT: Integer-only BERT Quantization"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "962bdacb3941053788d69696826c9b4307652cce", "title": "Towards Unified INT8 Training for Convolutional Neural Network"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "d77123b54dcc8014949584ab624e97298617bcad", "title": "Data-Free Quantization Through Weight Equalization and Bias Correction"}, {"paperId": "9a1093af92d315def21b90918faf08665157051a", "title": "Training Deep Neural Networks with 8-bit Floating Point Numbers"}, {"paperId": "f789425a7af1d012675118d7d10cd50afad09074", "title": "Post training 4-bit quantization of convolutional networks for rapid-deployment"}, {"paperId": "305b2cf37e5dece81e95c92883d5a6e28ac93b22", "title": "Don\u2019t Give Me the Details, Just the Summary! Topic-Aware Convolutional Neural Networks for Extreme Summarization"}, {"paperId": "acdf151b8efc2c6b05662d69f27531afc557dc85", "title": "Training and Inference with Integers in Deep Neural Networks"}, {"paperId": "642d0f49b7826adcf986616f4af77e736229990f", "title": "Deep Compression: Compressing Deep Neural Network with Pruning, Trained Quantization and Huffman Coding"}, {"paperId": "d2c733e34d48784a37d717fe43d9e93277a8c53e", "title": "ImageNet: A large-scale hierarchical image database"}, {"paperId": "363668677c459ebc0ff494655f993a93a0251009", "title": "OPTQ: Accurate Quantization for Generative Pre-trained Transformers"}, {"paperId": "b8b45b14df9029562b8995c6ab7fd90a8810f312", "title": "GPT3.int8(): 8-bit Matrix Multiplication for Transformers at Scale"}, {"paperId": "97e515770a9b9d002396e5afe51eade2222d84a0", "title": "PTQ4ViT: Post-Training Quantization Framework for Vision Transformers"}, {"paperId": null, "title": "The long-document"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Step Figure 9: Loss curves of T5-Large finetuning on 1/4 of XSum dataset for 1 epoch"}]}