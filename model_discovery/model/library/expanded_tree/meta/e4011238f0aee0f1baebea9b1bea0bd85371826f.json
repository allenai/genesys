{"paperId": "e4011238f0aee0f1baebea9b1bea0bd85371826f", "abstract": "Transformer models have achieved remarkable success in various machine learning tasks but suffer from high computational complexity and resource requirements. The quadratic complexity of the self-attention mechanism further exacerbates these challenges when dealing with long sequences and large datasets. Specialized AI hardware accelerators, such as the Habana GAUDI architecture, offer a promising solution to tackle these issues. GAUDI features a Matrix Multiplication Engine (MME) and a cluster of fully programmable Tensor Processing Cores (TPC). This paper explores the untapped potential of using GAUDI processors to accelerate Transformer-based models, addressing key challenges in the process. Firstly, we provide a comprehensive performance comparison between the MME and TPC components, illuminating their relative strengths and weaknesses. Secondly, we explore strategies to optimize MME and TPC utilization, offering practical insights to enhance computational efficiency. Thirdly, we evaluate the performance of Transformers on GAUDI, particularly in handling long sequences and uncovering performance bottlenecks. Lastly, we evaluate the end-to-end performance of two Transformer-based large language models (LLM) on GAUDI. The contributions of this work encompass practical insights for practitioners and researchers alike. We delve into GAUDI\u2019s capabilities for Transformers through systematic profiling, analysis, and optimization exploration. Our study bridges a research gap and offers a roadmap for optimizing Transformer-based model training on the GAUDI architecture.", "venue": "SC Workshops", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://arxiv.org/pdf/2309.16976", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "This study bridges a research gap and offers a roadmap for optimizing Transformer-based model training on the GAUDI architecture through systematic profiling, analysis, and optimization exploration."}, "embedding": {"model": "specter_v2", "vector": [0.30527982115745544, 0.13966035842895508, -0.015345906838774681, 0.22189180552959442, -0.28911370038986206, -0.1696339249610901, 0.7504235506057739, -0.22699962556362152, -0.4022308886051178, -0.5399805903434753, 0.48089799284935, -0.22212353348731995, 0.4316959083080292, 0.1172041967511177, -0.2185899168252945, -0.23948192596435547, -1.0158530473709106, 0.5684900283813477, -0.4719110131263733, -0.4799584150314331, 0.3537267744541168, -0.45269322395324707, -1.3358134031295776, 0.03585974872112274, 0.3490487337112427, 0.9931949377059937, -0.32443293929100037, 0.9463578462600708, -0.4467923939228058, 0.675838828086853, 0.755007803440094, -0.19836008548736572, 0.5042266845703125, 0.2808787524700165, -0.2562711238861084, -0.03176498040556908, 0.5809341669082642, -0.2956627905368805, -0.5226465463638306, 0.8385899066925049, -0.38174548745155334, 0.1313522756099701, 0.3897329270839691, -0.8096576929092407, -0.3240736424922943, 0.6378861665725708, 0.6395719051361084, 0.9916455745697021, -0.38660678267478943, -0.06925399601459503, 1.263319730758667, -1.4513853788375854, -0.20365114510059357, 1.1057378053665161, 0.616764485836029, 0.2185770571231842, -0.3249935507774353, -0.8586365580558777, 0.17220477759838104, -0.04756972938776016, -0.8534998893737793, -0.4913094639778137, 0.04603370651602745, -0.5494610071182251, 1.742111086845398, -0.31760525703430176, 0.0022497319150716066, 0.3070192337036133, 0.48580047488212585, 1.5754247903823853, -0.05055344104766846, -0.866974413394928, 0.043757617473602295, -0.3566661477088928, 0.3228297829627991, 1.0921396017074585, -0.5866780281066895, 0.6128551363945007, -1.0479778051376343, -0.1835307627916336, 0.21804511547088623, -0.2857777178287506, 0.45112907886505127, -0.15867085754871368, -0.733107328414917, 0.8164162039756775, 0.2540571391582489, 0.8327783346176147, -0.5888856053352356, 0.8600276708602905, 0.8938626050949097, 0.303057461977005, 0.15057867765426636, 0.43198704719543457, 0.15597985684871674, 0.11500877141952515, -0.8893757462501526, 0.33309149742126465, 0.03709879890084267, 0.8238743543624878, -0.29949069023132324, 0.7588080167770386, -0.8782138228416443, -0.230454221367836, 1.0365012884140015, 0.05740578845143318, 0.62850421667099, -0.361100971698761, 0.06509410589933395, -0.6584621071815491, -0.031373485922813416, -0.7060154676437378, -0.272225946187973, -0.28434988856315613, -0.914823591709137, -1.378051996231079, -0.4620513319969177, 0.2927911579608917, -1.0358176231384277, 0.44664499163627625, -0.646420955657959, 0.09490784257650375, 0.05578284338116646, 0.4484958052635193, 0.3235992193222046, 0.6644482612609863, 0.5729942917823792, 0.31808555126190186, 1.025933861732483, -0.9542805552482605, -0.3416411578655243, -1.371564507484436, 0.8417667746543884, -0.21204105019569397, 0.24629108607769012, -0.014207848347723484, -1.6159741878509521, -0.7167830467224121, -0.5097000002861023, -0.01639433018863201, -0.045676689594984055, 0.24756310880184174, 1.5166044235229492, 0.18259939551353455, -1.1190788745880127, 0.36695596575737, -0.4261047840118408, 0.11397538334131241, 0.04786846786737442, 0.38747337460517883, 0.5731806755065918, -0.3657029867172241, -1.1219977140426636, 0.10904750972986221, 0.3959601819515228, -0.32345011830329895, -0.4506458640098572, -0.4130626916885376, -1.0564196109771729, 0.09357521682977676, -0.13463345170021057, -0.17190209031105042, 1.3773764371871948, -0.06551788747310638, -0.8490966558456421, 0.7682288885116577, -0.23490400612354279, 0.019636401906609535, -0.28888019919395447, 0.2691075801849365, -0.5008841753005981, -0.42511770129203796, -0.06278518587350845, 0.626735508441925, 0.5763296484947205, 0.170623317360878, -0.020781122148036957, 0.0934782549738884, -0.4218652844429016, 0.05732031166553497, -0.3341203033924103, 1.0773600339889526, -0.24126194417476654, -0.09429483115673065, 0.5301342606544495, 0.16170434653759003, -0.43005070090293884, -0.386227548122406, -0.38800376653671265, -0.8304278254508972, 0.21236968040466309, 0.048235319554805756, 1.0396552085876465, -1.0273082256317139, -0.5666295886039734, -0.2495015263557434, 0.03543790802359581, -0.2850751578807831, -0.6184039115905762, 0.7651476263999939, -0.4425916075706482, 0.06267251819372177, -0.13254308700561523, -0.6516695618629456, -0.040442947298288345, -0.03987428918480873, -0.7681090235710144, -0.24872052669525146, 0.0841405987739563, 1.0572549104690552, -0.9974285364151001, 0.06497408449649811, -0.32465463876724243, -0.12077418714761734, -1.1841187477111816, 1.2162836790084839, -0.39434587955474854, 0.18425031006336212, 0.2697557508945465, 0.06089712306857109, 0.0693400427699089, -0.6045427918434143, 0.3600258529186249, -0.7687034606933594, -0.42339232563972473, 0.5388566851615906, 0.07471786439418793, 1.3755357265472412, -0.31781646609306335, 0.17387685179710388, -0.09789735078811646, -0.6724815964698792, 0.14226511120796204, 0.5483347177505493, 0.16236981749534607, -0.5736675262451172, 0.5417312383651733, 0.6233833432197571, -0.13532795011997223, 0.3615850806236267, 1.2108656167984009, 0.6146103739738464, -0.46553835272789, 0.2007126361131668, 0.6164493560791016, -0.43640899658203125, 1.009239673614502, 0.3043235242366791, 0.47777044773101807, 0.07573442161083221, 0.09405729174613953, -0.5050930380821228, 0.6531690359115601, -0.4072268307209015, -0.30157729983329773, 0.39576661586761475, 0.4949309229850769, 0.39377033710479736, 0.15816465020179749, -1.0973669290542603, -0.4163152575492859, 0.1701871007680893, 0.5494176149368286, 1.7178131341934204, -0.34414443373680115, -0.0981723815202713, -0.34851038455963135, 0.025204088538885117, -0.2667977511882782, 0.008709489367902279, -0.1733636111021042, -0.2876421809196472, -0.7103065848350525, -1.2015708684921265, 0.8545446395874023, 0.2868262231349945, 0.6805733442306519, -0.8912125825881958, -0.39802831411361694, -0.3124595284461975, 0.27290764451026917, -0.7732972502708435, -0.9253835678100586, 0.4322267472743988, -0.6846765279769897, 0.1905774027109146, 0.16838805377483368, -0.24795787036418915, 0.11451888829469681, -0.5161864161491394, 1.2333279848098755, -0.6512114405632019, -0.2370382696390152, 0.02152569591999054, 0.9200642108917236, -0.6689988970756531, -1.0594902038574219, -0.16186025738716125, 0.4788861572742462, -0.18148086965084076, 0.6741271615028381, 0.3273431360721588, 0.11111815273761749, -0.14364118874073029, -0.4882699251174927, 0.39599528908729553, 0.43645521998405457, 0.2676902711391449, 0.5135678648948669, -0.5602805018424988, -0.41750797629356384, -0.711979866027832, 1.1490448713302612, 0.017927372828125954, -0.48388785123825073, 0.12382910400629044, -0.7112756371498108, -0.019145894795656204, 0.5461798906326294, -0.830812394618988, 0.1745465248823166, -0.9161782264709473, 0.3584151268005371, -0.2809806764125824, 0.01290527917444706, 0.38412001729011536, 0.8887414336204529, -0.213471457362175, 0.5438809394836426, 0.9176702499389648, 0.4488895833492279, 0.25961968302726746, 0.43761613965034485, -0.7373051643371582, 0.5003434419631958, -0.17666122317314148, 0.1079365536570549, -0.31182223558425903, -0.07261241227388382, -0.3943805694580078, -0.37693652510643005, -0.12907977402210236, 0.051480844616889954, -0.4100419878959656, 0.08927523344755173, -0.764279305934906, -1.0579100847244263, 0.05691477283835411, -0.8854029178619385, -0.06596657633781433, 0.18445825576782227, -0.22411520779132843, -0.2947733700275421, -1.0850476026535034, -1.6653263568878174, -0.507989227771759, -1.3480879068374634, -1.378190040588379, 0.42285653948783875, -0.07433995604515076, 0.09140666574239731, -0.39378929138183594, -0.10294177383184433, -0.30899518728256226, 1.2818540334701538, -0.9315563440322876, 0.7294328212738037, 0.059905268251895905, -0.22196167707443237, -0.23852455615997314, -0.16270418465137482, 0.3021908402442932, -0.5708197951316833, 0.20664605498313904, -0.5742809176445007, 0.0786624625325203, -0.31253618001937866, -0.47120407223701477, -0.21292735636234283, 0.03398621454834938, 0.6576243042945862, -0.09576472640037537, -0.11344586312770844, 0.3007337749004364, 1.0707918405532837, -0.25605568289756775, -0.004138000775128603, -0.06846174597740173, 1.1465768814086914, -0.2360958606004715, -0.432516485452652, 0.6087034344673157, 0.37040674686431885, 0.35258248448371887, 0.051352180540561676, 0.04925088211894035, 0.17941132187843323, -0.2644492983818054, 0.5155225396156311, 2.1480042934417725, 0.3458631634712219, 0.05072662606835365, -1.299752116203308, 0.6208215355873108, -0.809325098991394, -0.5096017122268677, 0.6840720176696777, 0.6668458580970764, 0.47165733575820923, -0.41612404584884644, -0.2676975727081299, -0.07953456044197083, -0.034171272069215775, 0.2694527804851532, -0.38613083958625793, -1.065224528312683, 0.27753621339797974, 0.6224839091300964, 0.45171815156936646, 0.1206388920545578, -0.3408467769622803, 0.6282787322998047, 14.921393394470215, 0.6899122595787048, -0.32609671354293823, 0.513999879360199, 0.45057305693626404, 0.5738387703895569, -0.3120546340942383, -0.19388239085674286, -0.9667683839797974, -0.11248119175434113, 1.5679823160171509, -0.09172728657722473, 0.9006499648094177, 0.26510199904441833, -0.3806615471839905, 0.2182556539773941, -0.5293788313865662, 0.754401445388794, 0.5684826374053955, -1.3611712455749512, 0.5350366830825806, 0.12945611774921417, 0.24434296786785126, 0.948465883731842, 0.685907244682312, 1.074318528175354, 0.5414330959320068, -0.24463795125484467, 0.5777297616004944, 0.052404630929231644, 1.0017749071121216, 0.09478892385959625, 0.1182500347495079, 0.6419342756271362, -0.940751850605011, -0.2997363209724426, -0.4321197271347046, -1.5099945068359375, 0.0546998605132103, 0.06189802289009094, -0.7501006722450256, -0.4498460292816162, -0.3875044882297516, 0.6686161756515503, 0.2670030891895294, 0.16519688069820404, 0.17462366819381714, 0.7080203890800476, -0.10666154325008392, 0.2857300639152527, 0.5344811081886292, 0.06563560664653778, 0.09822884202003479, -0.03553151711821556, 0.30319729447364807, -0.18533049523830414, 0.5116696953773499, 0.48944801092147827, -0.2432074397802353, -0.18074551224708557, -0.3645819127559662, -0.8464637398719788, -0.5056488513946533, 0.7995198369026184, 0.6059470176696777, 0.2266828864812851, -0.4520944058895111, 0.16187475621700287, 0.5296059846878052, -0.0314752571284771, -0.1628933697938919, 0.3063010573387146, 0.2592751979827881, -0.6785362362861633, -0.37970709800720215, 0.19493624567985535, -0.32158520817756653, -0.8612569570541382, -0.8905680179595947, -0.7097380757331848, 0.2904264032840729, -0.6715173721313477, -0.7713499665260315, 1.1920788288116455, -0.21029676496982574, -0.43651890754699707, -0.1366938054561615, -0.8667861223220825, -0.02919374778866768, 0.47941017150878906, -1.070919394493103, -0.7562938332557678, 0.23607881367206573, -0.23974327743053436, -0.39657264947891235, -0.10970301926136017, 1.4399404525756836, 0.46004629135131836, -0.4656064510345459, 0.09943723678588867, -0.16783370077610016, 0.000958843796979636, -0.7930413484573364, -0.5560933947563171, 1.2307641506195068, 0.41199517250061035, 0.12463856488466263, 0.29340970516204834, 0.23365657031536102, 0.19089938700199127, -1.3758256435394287, 0.2614499032497406, 0.7525753378868103, -0.4881154000759125, 0.14807696640491486, -0.9099395871162415, -0.6357215046882629, 0.4605652689933777, 0.24261070787906647, -0.12416868656873703, 0.19427408277988434, 0.012510772794485092, -0.6060720682144165, 0.08307536691427231, -0.5283879637718201, 0.2560311555862427, 0.3296698331832886, -0.8789023160934448, 0.00817263126373291, 0.4688182473182678, 0.22661834955215454, -1.2357025146484375, -0.4599776864051819, -0.12813282012939453, 0.03810249641537666, -0.09260762482881546, 1.0015599727630615, -0.2335790991783142, 0.8006693720817566, 0.8201711177825928, -0.15106260776519775, -0.4598066806793213, -0.23096485435962677, -0.7120967507362366, -0.03307856619358063, -0.5506969094276428, 0.3624524176120758, -0.25331926345825195, 0.37387070059776306, 1.167697787284851, 0.01843944750726223, -0.22543762624263763, -0.5964929461479187, -0.2849213778972626, -0.1596839725971222, -0.7242727279663086, 0.09950032830238342, -0.19297654926776886, 0.06851299852132797, 0.19149115681648254, 0.05759258195757866, 0.26032087206840515, -0.1767747402191162, -0.4026000201702118, 0.2553485631942749, 0.049341972917318344, 0.06533868610858917, -0.5406203866004944, -0.5128834843635559, -1.1455127000808716, -0.13666173815727234, -1.427674651145935, 0.06147507205605507, -0.41384053230285645, -0.359478235244751, -0.19682577252388, -0.24893411993980408, 0.14118629693984985, 0.5023444890975952, -0.010817238129675388, -0.5105234384536743, -0.11601792275905609, -0.27481764554977417, 0.7846819758415222, 0.7956964373588562, -0.7398641109466553, 0.03435030207037926, -0.3350299894809723, 0.2827930152416229, 0.03821985423564911, 0.26291099190711975, -0.26092666387557983, -0.5925411581993103, -1.2534149885177612, 0.2978998124599457, 0.07260004431009293, -0.38537248969078064, -1.2503962516784668, 0.6419923901557922, 0.09470091015100479, -0.7361331582069397, 0.3486143946647644, 0.24947814643383026, -0.7518454790115356, -0.32978132367134094, 0.510188639163971, -0.7070002555847168, 0.878523051738739, 0.5733952522277832, -0.993678092956543, -0.39402779936790466, 0.9031882286071777, -0.18100909888744354, -1.0751335620880127, -0.7251204252243042, 0.6108241677284241, -0.6357280015945435, 0.015186307951807976, -0.34398898482322693, 0.08573600649833679, -0.7389792799949646, -0.14677773416042328, 0.357298880815506, 0.23817403614521027, -0.44536808133125305, 0.9239421486854553, 0.4174211621284485, -1.0201071500778198, 0.18195249140262604, 0.9303788542747498, 0.1689772754907608, -0.276324599981308, 0.46301645040512085, 0.6419931650161743, -0.5754317045211792, 0.7868885397911072, -0.20088782906532288, 0.14270725846290588, -0.5390592813491821, 0.28357505798339844, 0.4981759786605835, -0.8413102626800537, -0.04395994171500206, 1.053734302520752, -0.14799384772777557, -1.0997576713562012, -0.1587185263633728, -1.1294811964035034, -0.47185400128364563, -0.6852496266365051, 0.6470708250999451, -0.1923496276140213, 0.06564987450838089, -0.2822272479534149, -0.46466079354286194, -0.09683763980865479, -0.18983231484889984, -0.5979369282722473, 0.18056179583072662, 0.24950848519802094, -0.6662771701812744, 0.715118944644928, 0.5093023180961609, -0.6174785494804382, -0.1996852308511734, -0.7583954930305481, -0.3152214586734772, 0.05787064880132675, 0.5166482329368591, -0.30370453000068665, -0.7719579339027405, 0.8626211881637573, 0.47469839453697205, 0.07927644997835159, 0.26745039224624634, -0.7259173393249512, 0.5259511470794678, 0.4999848008155823, 0.37255558371543884, -0.12884734570980072, -0.5124090909957886, 1.6887201070785522, 1.1947499513626099, -0.7489049434661865, 0.022194113582372665, -0.018172206357121468, -0.9233339428901672, 0.8058414459228516, 0.3831581771373749, -0.040903810411691666, 0.7197197675704956, 0.10863219946622849, 0.06349212676286697, -0.165913388133049, -1.0431960821151733, -0.2175302803516388, 1.0795069932937622, 0.3889094889163971, 1.1702072620391846, 0.4385487139225006, -0.2583664357662201, 0.42301487922668457, 0.10070651769638062, 0.6322935819625854, 0.43135175108909607, 0.5568176507949829, 0.06918840855360031, -0.08486005663871765, -0.05627553537487984, 0.7617218494415283, -0.6280563473701477, -1.1411168575286865, 0.7075030207633972, 0.29501548409461975, -0.04765521362423897, 0.3835047483444214, 1.1422839164733887, -0.3785289525985718, 0.24009548127651215, 0.3055642545223236, 0.434241384267807, -0.21980471909046173, -0.5024743676185608, -0.3679482340812683, -0.7079958319664001, 0.0869537889957428, 0.038053371012210846, -0.2803250849246979, -0.31613630056381226, -0.3152430057525635, 0.44019314646720886, 0.06361749768257141, 0.6600627899169922, 0.7742192149162292, 0.6959260106086731, 0.3592093884944916, -0.5041903853416443, -0.7216190695762634, -0.616919994354248, -0.9719367623329163, 0.05009213462471962, -0.20132756233215332, -0.48734617233276367, -0.14764197170734406, -0.04388074576854706, -0.49971771240234375]}, "authors": [{"authorId": "2155988523", "name": "Chengming Zhang"}, {"authorId": "2189423368", "name": "Baixi Sun"}, {"authorId": "2249766451", "name": "Xiaodong Yu"}, {"authorId": "2251530025", "name": "Zhen Xie"}, {"authorId": "2249726854", "name": "Weijian Zheng"}, {"authorId": "1700811", "name": "K. Iskra"}, {"authorId": "2266333392", "name": "Pete Beckman"}, {"authorId": "3058378", "name": "Dingwen Tao"}], "references": [{"paperId": "5ce7d930b87a16ae9a7b5f789181a6e021f4df5d", "title": "Bamboo: Making Preemptible Instances Resilient for Affordable Training of Large DNNs"}, {"paperId": "76cb108e37d9d2a06f5a49df04e993f5fb123c26", "title": "The Carbon Footprint of Machine Learning Training Will Plateau, Then Shrink"}, {"paperId": "952305d9bbdaeaf7adb7ef12b94f221570c5d52d", "title": "LightSeq2: Accelerated Training for Transformer-Based Models on GPUs"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "3fbf6339273c50b04e886fa9bd4ad18c952a683d", "title": "Rethinking Attention with Performers"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "c71532fec21abf5847ebbf0399c51c10b689aaf6", "title": "Habana Labs Purpose-Built AI Inference and Training Processor Architectures: Scaling AI Training Systems Using Standard Ethernet With Gaudi Processor"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "59d0d7ccec2db66cad20cac5721ce54a8a058294", "title": "Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "642d0f49b7826adcf986616f4af77e736229990f", "title": "Deep Compression: Compressing Deep Neural Network with Pruning, Trained Quantization and Huffman Coding"}, {"paperId": "0e6824e137847be0599bb0032e37042ed2ef5045", "title": "Aligning Books and Movies: Towards Story-Like Visual Explanations by Watching Movies and Reading Books"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": null, "title": "Gaudi Training Platform White Paper"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}]}