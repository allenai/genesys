{"paperId": "02ffeb8cb7a1d1336e0e135c7c1000610ae7b942", "abstract": "Amidst the rapid advancements in generative language models, the investigation of how training data shapes the performance of GPT models is still emerging. This paper presents GPTfluence, a novel approach that leverages a featurized simulation to assess the impact of training examples on the training dynamics of GPT models. Our approach not only traces the influence of individual training instances on performance trajectories, such as loss and other key metrics, on targeted test points but also enables a comprehensive comparison with existing methods across various training scenarios in GPT models, ranging from 14 million to 2.8 billion parameters, across a range of downstream tasks. Contrary to earlier methods that struggle with generalization to new data, GPTfluence introduces a parameterized simulation of training dynamics, demonstrating robust generalization capabilities to unseen training data. This adaptability is evident across both fine-tuning and instruction-tuning scenarios, spanning tasks in natural language understanding and generation. We will make our code and data publicly available.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "GPTfluence introduces a parameterized simulation of training dynamics, demonstrating robust generalization capabilities to unseen training data across both fine-tuning and instruction-tuning scenarios, spanning tasks in natural language understanding and generation."}, "embedding": {"model": "specter_v2", "vector": [0.2689223885536194, 0.4024980664253235, -0.2459201216697693, -0.17026060819625854, -0.42979517579078674, -0.3161192238330841, 0.8760136961936951, -0.45598453283309937, -0.24832704663276672, -0.48522210121154785, -0.10678975284099579, -0.09233080595731735, 0.29837384819984436, 0.03220956772565842, -0.3263544738292694, 0.11245069652795792, -0.8183798789978027, 0.8363306522369385, -0.14618846774101257, -0.3571798801422119, -0.3353694975376129, -0.8845405578613281, -1.44599449634552, -0.1286538988351822, 0.8144059777259827, 0.4911469519138336, 0.07636576890945435, 1.2711960077285767, -0.13949182629585266, -0.5691626667976379, 0.20907165110111237, -0.7490965127944946, 0.3684023320674896, 0.018123917281627655, 0.2815724015235901, 0.21860283613204956, 0.3992614448070526, -0.3135391175746918, -0.36194655299186707, 0.5036066174507141, 0.05827522277832031, 0.27783793210983276, 0.5275626182556152, -0.7399455904960632, -0.5157824158668518, 0.5656360387802124, 0.572668731212616, 0.6940828561782837, -0.2240990400314331, -0.08982950448989868, 1.0508705377578735, -1.4603022336959839, 0.0941271185874939, 1.3655908107757568, 0.5725358724594116, 0.5569170117378235, -0.6419016122817993, -0.537875235080719, 0.48612555861473083, -0.783885657787323, -0.29638272523880005, -0.04089479148387909, -0.4091121554374695, 0.14576557278633118, 1.8756989240646362, -0.4247377812862396, 0.289722740650177, 0.8783321380615234, -0.06882724165916443, 1.7459946870803833, -0.23672810196876526, -0.8941227197647095, -0.4301251471042633, 0.07106851041316986, 0.3077647387981415, 0.9973015785217285, -0.357857882976532, 0.856717586517334, -0.9779797792434692, -0.012982689775526524, 0.41042008996009827, -0.39095038175582886, 0.06092338636517525, -0.1027064323425293, 0.022354476153850555, 0.824837863445282, 0.11126857250928879, 0.8507727384567261, 0.23969604074954987, 1.0505867004394531, 0.27537479996681213, 0.3346583843231201, 0.5511825084686279, 0.25747501850128174, -0.11914563179016113, -0.04745377600193024, -0.8920676112174988, 0.2607250511646271, 0.05366544798016548, 0.8940771818161011, 0.07232958823442459, 0.21238429844379425, -0.9219088554382324, 0.4456225335597992, 1.2680920362472534, 0.1868169754743576, 0.8153121471405029, -0.485311895608902, 0.5612655282020569, -0.6387938261032104, -0.033880725502967834, -0.3930012881755829, 0.2893379330635071, -0.8055101037025452, -0.2910202741622925, -1.3246876001358032, -0.3255487382411957, -0.033222496509552, -1.274606704711914, 0.9446679353713989, -0.07877220958471298, 0.18383848667144775, -0.018914995715022087, 0.4089713394641876, 0.512727677822113, 0.8668903112411499, 0.23345279693603516, 0.3821853995323181, 0.29318228363990784, -0.5455442667007446, -0.3037937581539154, -1.2811920642852783, 1.1007142066955566, -0.24984177947044373, 0.7374493479728699, -0.18108128011226654, -1.495200753211975, -1.2063171863555908, -0.7537999749183655, 0.1851787120103836, -0.2123924344778061, 0.6408604979515076, 1.361206293106079, 0.9442261457443237, -1.127478837966919, 0.9818664789199829, -0.5613526701927185, -0.0370120108127594, 0.3775146007537842, 0.548194408416748, 0.2737013101577759, -0.5631851553916931, -1.0476140975952148, -0.14110727608203888, 0.44669458270072937, -0.558202862739563, -0.5248867273330688, -0.9211013913154602, -1.000166416168213, 0.18316014111042023, 0.28781649470329285, -0.8469988107681274, 1.4514650106430054, -0.16674095392227173, -1.1617680788040161, 0.7981701493263245, -0.22253824770450592, 0.007857661694288254, 0.4528142511844635, 0.027485283091664314, -0.331991583108902, -0.7785253524780273, -0.20121783018112183, 0.760224461555481, 0.29447242617607117, -0.07174374908208847, -0.0013600350357592106, 0.3636360764503479, -0.5525002479553223, -0.039734240621328354, -0.22994987666606903, 0.11964187026023865, -0.7558120489120483, -0.2787170112133026, 0.49982571601867676, 0.4249729514122009, 0.19171664118766785, -0.4536716341972351, -0.4881041944026947, -1.4489874839782715, 0.7271709442138672, -0.10236992686986923, 0.9262011647224426, -1.0759289264678955, -0.9601883888244629, 0.038022104650735855, -0.3455022871494293, -0.03598068654537201, -0.7576814889907837, 0.6170409917831421, -0.0737496167421341, 0.8870235085487366, -0.27520257234573364, -1.4032171964645386, 0.5401039123535156, -0.263085275888443, -0.29363662004470825, -0.5379454493522644, 0.5204616189002991, 1.324521541595459, -0.9400877356529236, 0.23011837899684906, -0.17419616878032684, 0.30912870168685913, -1.1635607481002808, 1.1008665561676025, -0.6923168897628784, 0.26267150044441223, -0.4393247663974762, -0.24062353372573853, -0.03971720486879349, -0.2878488600254059, 0.10655531287193298, -0.04340843856334686, 0.28196489810943604, 0.6387711763381958, -0.17824259400367737, 1.4758249521255493, -0.23974527418613434, 0.029335999861359596, -0.5419721007347107, -0.5838809013366699, 0.4398908019065857, 0.4462801218032837, -0.5153226852416992, -0.6855497360229492, 0.5871495604515076, 0.7650788426399231, -0.3624383211135864, 0.44856712222099304, 0.7078045010566711, 0.5518232583999634, -0.36290356516838074, 0.5374335646629333, 0.9145077466964722, -0.5175787806510925, 0.8434089422225952, 0.23833921551704407, 0.4808461368083954, 0.6256359815597534, -0.1016160324215889, 0.013646189123392105, -0.05954515561461449, -0.7712969183921814, -0.2378220111131668, 0.5160642266273499, 0.6961833834648132, 0.8539095520973206, 0.19186493754386902, -0.6586940288543701, -0.3635595440864563, -0.3122817277908325, 0.711490273475647, 1.655800461769104, -0.5524492859840393, 0.06668165326118469, -0.8131616711616516, -0.3428930342197418, -0.07438249886035919, 0.38115009665489197, -0.6566610932350159, -0.2918040156364441, -0.4898214638233185, -1.3321906328201294, 0.6133658289909363, 0.0032637619879096746, 0.9732959866523743, -0.6196901202201843, -0.0820687934756279, -0.24866817891597748, 0.5666304230690002, -0.46666571497917175, -0.6185587048530579, 0.18566274642944336, -0.831008791923523, 0.07104448229074478, 0.08105970174074173, -0.07554937154054642, -0.045947082340717316, -0.806997537612915, 1.2177808284759521, 0.045183539390563965, -0.20502206683158875, 0.3354918956756592, 0.6083580851554871, -0.6921985745429993, -1.0716689825057983, 0.4466199576854706, -0.05666431039571762, -0.2721257209777832, -0.1434917449951172, 0.3212888836860657, 0.28120723366737366, 0.4860426187515259, -0.3440551161766052, 0.22241702675819397, 0.08457820117473602, 0.13916611671447754, 1.103265643119812, -0.21487963199615479, 0.06435973942279816, -1.3395283222198486, 0.9587010741233826, -0.015018853358924389, -0.5233418941497803, 0.6016509532928467, -0.7068667411804199, -0.05544595792889595, 0.3586083948612213, -0.7525107264518738, -0.5925711393356323, -1.251759648323059, 0.4678989350795746, -0.17280732095241547, -0.020337319001555443, 0.2288847416639328, 0.5344995260238647, 0.3159897029399872, 0.39713039994239807, 0.4536972641944885, 0.07522771507501602, -0.015523277223110199, 0.4515574872493744, -1.4640792608261108, 0.3042018413543701, -0.08106245845556259, 0.2723693549633026, -0.5481365919113159, -0.43358173966407776, -0.2636658251285553, -0.42815637588500977, 0.18271471560001373, 0.04306146875023842, -0.5300177931785583, -0.14650069177150726, -0.34395021200180054, -0.7690224051475525, -0.14427512884140015, -0.4073588252067566, -0.36521098017692566, 0.26700058579444885, -0.30475327372550964, -0.2165611833333969, -1.4350271224975586, -1.1208668947219849, -0.6340129375457764, -0.5129587054252625, -1.0472960472106934, 0.620823085308075, 0.197245791554451, -0.08530628681182861, -0.9821763634681702, 0.17294804751873016, -0.21093878149986267, 0.8142122626304626, -0.40577957034111023, 0.7873718738555908, -0.014831533655524254, -0.42240116000175476, -0.3600371778011322, 0.7029398083686829, 0.4730983376502991, -0.5587745904922485, 0.6659496426582336, -1.1278773546218872, -0.20728744566440582, -0.2153729498386383, -0.4243929088115692, 0.1449388861656189, 0.3965790271759033, 0.5483238697052002, 0.2047717571258545, -0.7795573472976685, 0.6821073889732361, 1.3308297395706177, -0.5659621953964233, -0.25810256600379944, 0.048039354383945465, 0.6690608859062195, 0.1821105033159256, -0.29651862382888794, 0.08621133118867874, 0.0172117967158556, 0.17994768917560577, 0.13576802611351013, 0.28388556838035583, -0.004773296415805817, -1.0805538892745972, 0.46433764696121216, 1.5149327516555786, 0.3884373903274536, -0.8486121892929077, -1.1892170906066895, 0.19578126072883606, -0.9961773157119751, -0.15802137553691864, 0.5700711607933044, 1.0123289823532104, 0.21409739553928375, -0.1458400934934616, -0.41721850633621216, -0.13583214581012726, 0.4802071154117584, 0.1647116243839264, -0.6692194938659668, -0.5374814867973328, -0.02220044657588005, 0.6622741222381592, -0.22131240367889404, 0.32092347741127014, 0.03907273709774017, 0.5838013291358948, 14.511070251464844, 1.1792563199996948, 0.2533958852291107, 0.6530066132545471, 1.1451423168182373, 0.11164244264364243, -0.7775996327400208, -0.43680721521377563, -1.0605859756469727, -0.015563581138849258, 1.2896044254302979, 0.15796823799610138, 0.7292370200157166, -0.03244802728295326, -0.07081390172243118, 0.03725912421941757, -0.6196839213371277, 0.4564891457557678, 0.25804823637008667, -1.0579242706298828, 0.6373969912528992, 0.25821512937545776, 0.9145519733428955, 0.7126912474632263, 1.384306788444519, 0.9815158843994141, 0.5557411313056946, -0.43464377522468567, 0.5473049283027649, 0.18458624184131622, 0.9416170716285706, -0.058081693947315216, 0.21134676039218903, 0.5163935422897339, -0.5642980337142944, 0.0920385792851448, -0.3906312584877014, -0.9957926273345947, 0.05064651370048523, 0.028755508363246918, -1.1511287689208984, -0.36958423256874084, -0.29464632272720337, 0.8511450886726379, -0.1837235391139984, 0.13594231009483337, -0.48144471645355225, 1.1578243970870972, -0.40091195702552795, 0.06431517004966736, 0.40057411789894104, 0.3958691656589508, 0.1717378944158554, -0.14500556886196136, 0.7422552108764648, -0.17088152468204498, -0.06472764164209366, 0.9514312744140625, -0.6832362413406372, -0.07419610768556595, -0.20580722391605377, -0.3169628083705902, -0.07988347858190536, 0.47831952571868896, 0.2427988052368164, 0.3516428470611572, -0.08532726764678955, 0.14729022979736328, 0.785585343837738, 0.3283174932003021, -0.16223035752773285, 0.8907357454299927, 0.12174714356660843, -0.565118134021759, 0.0565706342458725, 0.605609118938446, -0.1371651291847229, -0.3347958028316498, -0.3804587125778198, -0.41488057374954224, 0.07262073457241058, -0.9063908457756042, -0.9270943403244019, 0.6497092247009277, -0.1893509179353714, -0.2757565677165985, -0.2628016471862793, -0.5333930850028992, -0.45891061425209045, 0.6789175271987915, -1.1492915153503418, -0.7439947128295898, 0.6598471999168396, -0.5856819152832031, -0.3968670666217804, -0.23057852685451508, 0.9721278548240662, -0.222382590174675, -0.6447290778160095, 0.6450877785682678, 0.013627594336867332, -0.25390323996543884, -0.5521514415740967, -0.9218010306358337, 1.6341984272003174, 0.16858987510204315, 0.2540994882583618, 0.1606595814228058, 0.19066578149795532, 0.24890778958797455, -0.8054922819137573, 0.1001715213060379, 0.44261717796325684, -1.1453982591629028, -0.5708354115486145, -0.5841037631034851, -0.7958042621612549, 0.4148249924182892, 0.23783868551254272, -0.5448334813117981, 0.41799482703208923, 0.36561650037765503, -0.33219650387763977, 0.18256206810474396, -0.9193951487541199, -0.20264947414398193, 0.6949995160102844, -0.28262293338775635, -0.1803600937128067, 0.022541271522641182, 0.35273197293281555, -1.2695026397705078, -0.29985764622688293, -0.07961076498031616, 0.13496214151382446, -0.6389099955558777, 0.7298136353492737, -0.19116339087486267, 0.33643096685409546, 1.060184359550476, 0.07551887631416321, -1.0866612195968628, 0.04970830678939819, -0.8270443677902222, 0.3127330541610718, 0.2831878066062927, 1.1253938674926758, -0.49491041898727417, 0.6093197464942932, 0.7239333987236023, -0.1322348415851593, -0.4847252368927002, -0.6590280532836914, -0.22700254619121552, 0.13737057149410248, -0.7120369076728821, 0.5813685059547424, -0.22804155945777893, -0.8442937135696411, -0.07233476638793945, 0.6381276249885559, 0.6279166340827942, -0.30897757411003113, -0.8899275660514832, 0.5933291912078857, -0.20956090092658997, -0.6389211416244507, -0.507784366607666, -0.11213206499814987, -1.2296178340911865, -0.2277408093214035, -1.5425300598144531, -0.20528057217597961, -0.8411697745323181, -0.5556448101997375, -0.46190401911735535, -0.1845138520002365, -0.11328773200511932, 0.1844235211610794, -0.4492155611515045, -0.3922823965549469, -0.39944973587989807, -0.20608143508434296, 0.8860628008842468, 1.219451904296875, -0.5112091302871704, -0.033444859087467194, 0.16734305024147034, 0.2754070460796356, 7.777348218951374e-05, 0.6409328579902649, -0.5730702877044678, -1.036171317100525, -1.9650858640670776, 0.4314861297607422, -0.1392325460910797, -0.04145660623908043, -1.0702061653137207, 0.4056461751461029, 0.8290797472000122, -0.08396225422620773, 0.16095437109470367, 0.42405572533607483, -0.36157992482185364, -0.1461850255727768, 0.0685761421918869, -0.5374409556388855, 0.459458589553833, 0.5172606706619263, -0.38123661279678345, -0.29548895359039307, 0.5450512766838074, -0.4991969168186188, -0.8582050800323486, -0.3983331620693207, 0.784372866153717, -0.07664501667022705, 0.4259946048259735, -0.5120028853416443, -0.4217666685581207, -0.8995419144630432, -0.4272826015949249, -0.059463124722242355, 0.5695275664329529, -0.182573601603508, 0.7302032113075256, 0.31289026141166687, -1.1041651964187622, -0.0442265048623085, 0.7606929540634155, -0.09064916521310806, 0.1001754030585289, 0.5778506398200989, 0.12973132729530334, -0.2209322154521942, 0.48805558681488037, 0.5221506357192993, -0.10416974872350693, -0.548843264579773, -0.32573238015174866, 1.066102147102356, -0.82086580991745, -0.06674166023731232, 1.4732288122177124, 0.010010269470512867, -1.5688644647598267, -0.09879649430513382, -1.18943452835083, -0.10901635885238647, -0.6567327976226807, 0.13944239914417267, -0.07541053742170334, -0.13915228843688965, 0.19590860605239868, 0.2055600881576538, 0.312325119972229, -0.21179986000061035, -0.7364107966423035, 0.3235158622264862, 0.07929475605487823, 0.2582850754261017, 0.6895303726196289, 0.7344040274620056, -1.1147540807724, -1.197136402130127, -0.6413879990577698, -0.5062864422798157, -0.20699100196361542, 0.09923753887414932, -0.6824154257774353, -0.7439029216766357, 0.9123432636260986, 0.4799974858760834, 0.4364953637123108, 0.12210461497306824, -0.06459445506334305, 0.09600690752267838, 0.33710503578186035, 0.4400237798690796, -0.2980605363845825, -0.3170747458934784, 1.129855990409851, 1.0028825998306274, -1.2062071561813354, -0.0999038815498352, -0.38658657670021057, -0.7451855540275574, 0.653612494468689, 0.38042449951171875, -0.18495582044124603, 0.7110790014266968, -0.6670061945915222, -0.24353604018688202, -0.023879656568169594, -1.2749143838882446, 0.09994031488895416, 1.0083919763565063, 1.1436903476715088, 0.9801014065742493, 0.48284199833869934, 0.15214978158473969, 0.6952300071716309, -0.5810000896453857, 0.12275124341249466, 0.03142596781253815, 0.3306061923503876, -0.33215221762657166, -0.3495500087738037, 0.27687355875968933, 0.9577939510345459, -0.588453471660614, -0.6788433790206909, 0.2189413458108902, 0.9909184575080872, 0.46509820222854614, 0.6570092439651489, 0.6210288405418396, -0.09306018054485321, 0.6625497341156006, 0.2972617745399475, 0.7302278280258179, -0.7327980995178223, -0.4843447506427765, -0.136392742395401, -0.6468471884727478, 0.18872874975204468, -0.056309375911951065, -0.563490092754364, -0.28166332840919495, -0.2834281325340271, 0.11401847749948502, 0.22096700966358185, 0.29413172602653503, 1.079238772392273, 0.3966462016105652, 0.3527955710887909, -0.27980366349220276, -0.4030078053474426, -0.19964155554771423, -1.0835754871368408, 0.2682335376739502, -0.36368328332901, -0.4185618758201599, -0.47932687401771545, -0.3192402124404907, -0.6122862100601196]}, "authors": [{"authorId": "2293668934", "name": "Qingyi Liu"}, {"authorId": "1395701436", "name": "Yekun Chai"}, {"authorId": "104463827", "name": "Shuohuan Wang"}, {"authorId": "2296100360", "name": "Yu Sun"}, {"authorId": "2293923705", "name": "Keze Wang"}, {"authorId": "2190177674", "name": "Hua Wu"}], "references": [{"paperId": "18e7ab056c16928d8f9539509a4b366889106d97", "title": "StarCoder 2 and The Stack v2: The Next Generation"}, {"paperId": "95898b1f82cf7ad7d96fcc85b4def7f086325af5", "title": "LESS: Selecting Influential Data for Targeted Instruction Tuning"}, {"paperId": "d6a546b23c3b67aa2dc2d03ef3e7692f031ebd2d", "title": "DsDm: Model-Aware Dataset Selection with Datamodels"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "be55e8ec4213868db08f2c3168ae666001bea4b8", "title": "Pythia: A Suite for Analyzing Large Language Models Across Training and Scaling"}, {"paperId": "4f2ae5fa2dc74af9c36ee57b359a4b3241006a92", "title": "TRAK: Attributing Model Behavior at Scale"}, {"paperId": "163b4d6a79a5b19af88b8585456363340d9efd04", "title": "GPT-4 Technical Report"}, {"paperId": "c926bd6ebdbcf0bfabb55c1f0171055bc2dbe516", "title": "Simfluence: Modeling the Influence of Individual Training Examples by Simulating Training Runs"}, {"paperId": "e1b732e02cd6f41e4e1eb793ec4b356cee2587f1", "title": "ERNIE-Code: Beyond English-Centric Cross-lingual Pretraining for Programming Languages"}, {"paperId": "13a0d8bb38f739990c8cd65a44061c6534f17221", "title": "OPT: Open Pre-trained Transformer Language Models"}, {"paperId": "907c6845109dc1b282cc0e1b05a4ebb400879674", "title": "Revisiting Methods for Finding Influential Examples"}, {"paperId": "ff0b2681d7b05e16c46dfb71d980cc2f605907cd", "title": "Finetuned Language Models Are Zero-Shot Learners"}, {"paperId": "a8ca46b171467ceb2d7652fbfb67fe701ad86092", "title": "LoRA: Low-Rank Adaptation of Large Language Models"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "c94e49617f569204f989643e5462691b9b3a482b", "title": "Estimating Training Data Influence by Tracking Gradient Descent"}, {"paperId": "2a3bad4004f175519f6973f74eb0aa2c3dd2da87", "title": "Input Similarity from the Neural Network Perspective"}, {"paperId": "a34954d9e36ea6c57743f55124a6ae444b951c2c", "title": "Representer Point Selection for Explaining Deep Neural Networks"}, {"paperId": "08ad8fad21f6ec4cda4d56be1ca5e146b7c913a1", "title": "Understanding Black-box Predictions via Influence Functions"}, {"paperId": "60b05f32c32519a809f21642ef1eb3eaf3848008", "title": "ROUGE: A Package for Automatic Evaluation of Summaries"}, {"paperId": "d7da009f457917aa381619facfa5ffae9329a6e9", "title": "Bleu: a Method for Automatic Evaluation of Machine Translation"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "2023. Gemini: a family of highly capable multimodal models"}, {"paperId": null, "title": "2023. Mistral 7b"}, {"paperId": null, "title": "2022. Data-models: Predicting predictions from training data"}]}