{"paperId": "e51a3a5e909d889f042ea08cdbb0053cea3ee4d8", "abstract": "When the predicted sequence length exceeds the length seen during training, the transformer's inference accuracy diminishes. Existing relative position encoding methods, such as those based on the ALiBi technique, address the length extrapolation challenge exclusively through the implementation of a single kernel function, which introduces a constant bias to every post-softmax attention scores according to their distance. These approaches do not investigate or employ multiple kernel functions to address the extrapolation challenge. Drawing on the ALiBi approach, this study proposes a novel relative positional encoding method, called MEP, which employs a weighted average to combine distinct kernel functions(such as the exponential kernel and the Gaussian kernel) to generate a bias that is applied to post-softmax attention scores. Initially, the framework utilizes various kernel functions to construct multiple kernel functions. Each kernel function adheres to a consistent mean weight coefficient, harnessing the synergistic advantages of different kernels to formulate an innovative bias function. Subsequently, specific slopes are tailored for each kernel function, applying penalties at varying rates, to enhance the model's extrapolation capabilities. Finally, this bias is seamlessly incorporated as a penalty to the post-softmax scores. We present two distinct versions of our method: a parameter-free variant that requires no new learnable parameters, which enhances length extrapolation capabilities without compromising training efficiency, and a parameterized variant capable of integrating state-of-the-art techniques. Empirical evaluations across diverse datasets have demonstrated that both variants of our method achieve state-of-the-art performance, outperforming traditional parameter-free and parameterized approaches.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A novel relative positional encoding method, called MEP, which employs a weighted average to combine distinct kernel functions to generate a bias that is applied to post-softmax attention scores, and is seamlessly incorporated as a penalty to the post-softmax scores."}, "embedding": {"model": "specter_v2", "vector": [0.4578370749950409, 0.629033088684082, -0.7932952642440796, -0.5807039141654968, -0.46100708842277527, -0.11799009144306183, 0.05379549041390419, -0.11898333579301834, -0.5954124331474304, -0.30185335874557495, 0.5094557404518127, 0.008869821205735207, 0.08922146260738373, 0.08137163519859314, -0.43378564715385437, -0.23682279884815216, -0.9555173516273499, 0.1241382583975792, 0.270708829164505, -0.1608962118625641, -0.11545677483081818, -0.725829541683197, -0.6232619285583496, 0.07503955066204071, 0.18351173400878906, 0.7977902889251709, 0.14764489233493805, 0.8842470049858093, -0.2529040277004242, 0.22872710227966309, 0.3134536147117615, -0.7191480398178101, 0.35545870661735535, -0.06696593761444092, -0.33417242765426636, -0.13743287324905396, 0.1467868834733963, -0.5466299057006836, -0.5817920565605164, 1.042922019958496, -0.3204067349433899, 0.2963627874851227, 0.32939383387565613, -0.687476634979248, -0.6663395166397095, 1.2437374591827393, 0.5100303888320923, 0.5893426537513733, -0.4340378940105438, -0.6811808347702026, 1.3392446041107178, -1.0329734086990356, -0.26607546210289, 0.9992582201957703, 0.9547396302223206, 0.09759680181741714, -0.11104227602481842, -0.22835130989551544, 0.5542188882827759, 0.1492312252521515, -0.896746039390564, -0.3469368815422058, 0.06257499754428864, -0.29542475938796997, 1.7552123069763184, -0.4571493864059448, -0.13194431364536285, 0.31082257628440857, -0.16685886681079865, 1.3482482433319092, -0.36911556124687195, -0.8486252427101135, -0.38185563683509827, -0.002486256882548332, 0.39278581738471985, 0.8654161691665649, -0.8535816669464111, 0.5530376434326172, -0.9788089394569397, -0.18582770228385925, 0.37029844522476196, -0.31321147084236145, 0.3269108831882477, 0.014904353767633438, -0.36100396513938904, 0.39587441086769104, 0.20420780777931213, -0.09059955179691315, -0.26835575699806213, 0.9714773893356323, 0.5219579339027405, 0.13464060425758362, 0.43448153138160706, -0.05776265263557434, -0.2662322223186493, 0.2302306890487671, -0.9455772042274475, 0.1136692687869072, -0.558417797088623, 0.9783679246902466, -0.13647052645683289, 0.31638404726982117, -0.6087914109230042, 0.3056045174598694, 1.300567626953125, -0.3325808644294739, 0.2230086475610733, -0.5618085861206055, 0.39893341064453125, -0.664545476436615, 0.10806548595428467, -0.28960251808166504, -0.1855757087469101, -0.08276674151420593, -0.22413665056228638, -0.7095101475715637, -0.3129922151565552, 0.1590750813484192, -0.5625733137130737, 0.9271703958511353, -0.48718273639678955, 0.30797693133354187, 0.32496964931488037, 0.22698654234409332, 0.2698482275009155, 0.5314810276031494, 0.15940704941749573, 0.2972681522369385, 0.918178379535675, -1.2199095487594604, -0.25753775238990784, -0.7473353743553162, 0.8619279861450195, -0.38122448325157166, -0.01707114465534687, -0.32247194647789, -1.3159335851669312, -0.945224404335022, -1.1652071475982666, 0.06108726188540459, -0.5129235982894897, 0.5577990412712097, 0.8218477964401245, 0.06669609993696213, -0.7547335028648376, 1.1162196397781372, -0.06575175374746323, 0.13392287492752075, 0.3161182701587677, -0.020810939371585846, 0.42257094383239746, -0.005849321838468313, -1.6650811433792114, 0.4361839294433594, 0.9981756210327148, -0.4003369212150574, 0.4417897164821625, -0.7523714303970337, -1.0923980474472046, 0.014253638684749603, 0.23183193802833557, -0.3882365822792053, 1.2022018432617188, -0.008156003430485725, -1.5291794538497925, 0.651399552822113, 0.07094153016805649, -0.23723234236240387, 0.38961857557296753, -0.19985750317573547, -0.4385668933391571, -0.7065542936325073, -0.5697382688522339, 0.5673632025718689, 0.32454153895378113, 0.5371794104576111, -0.4590543210506439, 0.26074129343032837, -0.16552932560443878, -0.02961459755897522, -0.3806402087211609, 0.9774532914161682, -0.17810995876789093, -0.6332430243492126, 0.3106960654258728, 0.44903093576431274, -0.020144550129771233, -0.09203855693340302, -0.11556027829647064, -0.9809690713882446, 0.6521170139312744, -0.29593801498413086, 1.1333073377609253, -0.6393828988075256, -0.5754420757293701, -0.28392738103866577, -0.37082234025001526, -0.08509989827871323, -0.634880006313324, 0.40251365303993225, -0.34937795996665955, -0.10120312869548798, -0.04031218960881233, -0.6744633316993713, -0.015101100318133831, -0.5446983575820923, -0.3603419065475464, 0.04107020050287247, -0.04694623872637749, 1.2597659826278687, -1.1095020771026611, 0.22173509001731873, -0.13986742496490479, 0.1989624798297882, -0.5151697397232056, 1.1084504127502441, -0.42297035455703735, -0.19125507771968842, 0.480896919965744, -0.11396898329257965, 0.047011371701955795, -0.41504722833633423, -0.09346691519021988, -0.41918516159057617, -0.14204667508602142, 0.5049645304679871, 0.004831405356526375, 1.6621694564819336, -0.03026207908987999, 0.4793434739112854, -0.5034357309341431, -0.44101250171661377, 0.5550056099891663, 0.39882826805114746, -0.07793601602315903, -0.20251604914665222, 0.34292158484458923, 0.1578039675951004, -0.7786275148391724, 0.2152509242296219, 0.680016279220581, 1.0515087842941284, -0.375249445438385, -0.2098592221736908, 0.36209535598754883, 0.445933997631073, 0.3244587182998657, -0.03525353968143463, 0.3889171779155731, 0.8139297962188721, 0.5883896350860596, -0.0420084111392498, 0.28092387318611145, -0.9664525389671326, 0.1253412961959839, 0.25488150119781494, 0.3930535316467285, 0.6687195897102356, 0.18215307593345642, -0.909719705581665, -0.7675079703330994, 0.004793105646967888, 0.5779892206192017, 1.7841111421585083, -0.2644987404346466, -0.034372419118881226, -0.6792644262313843, -0.4839083254337311, -0.08154164999723434, -0.01059699710458517, -0.38821613788604736, -0.5260330438613892, -0.4098796248435974, -1.245300054550171, 1.3152259588241577, 0.6225879192352295, 0.5981017351150513, -0.38136136531829834, -0.36308175325393677, -0.01618141308426857, 0.014427101239562035, -0.7787122130393982, -0.8457807898521423, 0.576718807220459, -0.36994507908821106, 0.2860376536846161, 0.025489669293165207, -0.02359597757458687, 0.03256484121084213, -1.0242998600006104, 0.5048607587814331, -1.04594087600708, -0.5588259696960449, -0.2419842630624771, 0.30036258697509766, -0.6882564425468445, -0.9023858904838562, 0.5528947710990906, -0.0017712650587782264, -0.3447597920894623, 0.6353482007980347, 0.6386182308197021, -0.12289655953645706, -0.01870429888367653, -0.3078920245170593, 0.4347120225429535, 0.34305793046951294, -0.03003453090786934, 0.5454614162445068, -0.4830019474029541, 0.4646892547607422, -0.7521015405654907, 0.8719907999038696, 0.2592834532260895, -0.8004891276359558, 0.4238007366657257, -0.8557525873184204, -0.03412218391895294, 0.48595720529556274, -0.65093994140625, -0.35210031270980835, -0.5909814238548279, -0.011444357223808765, -0.4562406837940216, -0.4754718244075775, 0.22349916398525238, 0.5938384532928467, 0.22354182600975037, 0.40839633345603943, 0.6479702591896057, 0.6085063815116882, -0.14997459948062897, 0.610828161239624, -0.5944061279296875, 0.7490479946136475, 0.23852862417697906, -0.34750086069107056, -0.547560453414917, 0.1289326250553131, -0.45681288838386536, -0.6504659652709961, -0.5852988362312317, -0.7802474498748779, -0.2877027690410614, 0.0044784448109567165, -0.3094087839126587, -0.9660744667053223, 0.11813565343618393, -0.9668295979499817, -0.2860338091850281, 0.09525302052497864, -0.15847186744213104, -0.5878857970237732, -0.9933651089668274, -1.312865972518921, -0.4802184998989105, -0.8497802019119263, -1.1764612197875977, 0.19210754334926605, -0.07042857259511948, -0.37592869997024536, -0.6527201533317566, -0.06887901574373245, -0.3518425524234772, 0.8916980028152466, -0.6367906332015991, 0.834630012512207, -0.07887262850999832, 0.032748445868492126, -0.3801090717315674, 0.19318725168704987, 0.693295419216156, 0.029311876744031906, 0.3129017651081085, -0.7090083360671997, 0.5009680986404419, -0.7412528395652771, -0.21545127034187317, 0.08795997500419617, 0.347604900598526, 0.949129581451416, -0.1778409779071808, -0.3364553451538086, 0.4498918950557709, 1.2225565910339355, -0.5611388087272644, -0.03438185900449753, 0.342879980802536, 0.6519314646720886, 0.3981480002403259, 0.05125447362661362, 0.8334767818450928, -0.03441837802529335, 0.9112507104873657, 0.13861285150051117, -0.035036031156778336, -0.33835524320602417, -0.4828910827636719, 0.43570810556411743, 1.2273342609405518, 0.25462326407432556, 0.09309926629066467, -0.7539266347885132, 0.4507850706577301, -1.7194520235061646, -1.1180452108383179, 0.8123266100883484, 0.8475388884544373, 0.6365492939949036, -0.42838922142982483, 0.00415082648396492, -0.262918084859848, 0.38160082697868347, 0.31129196286201477, -0.3716011643409729, -0.6371244192123413, 0.13257789611816406, -0.3838147819042206, 0.48900464177131653, 0.6021527647972107, -0.6132879257202148, 0.7520338892936707, 15.06380844116211, 0.8805524110794067, -0.23187285661697388, 0.16963917016983032, 0.7035491466522217, 0.3453221619129181, 0.07516270130872726, -0.3572550415992737, -1.6976003646850586, 0.40279579162597656, 1.4201115369796753, 0.17511127889156342, 0.6158580183982849, 0.4585651457309723, -0.027702726423740387, 0.38560837507247925, -0.6618215441703796, 0.6136574745178223, 0.6421442627906799, -1.4467114210128784, 0.07925254106521606, -0.32957878708839417, 0.049525558948516846, 0.4565446674823761, 0.9476535320281982, 0.4119296073913574, 0.22313512861728668, -0.33023694157600403, 0.9237998723983765, 0.47940582036972046, 0.8601857423782349, -0.42966321110725403, 0.6021404266357422, 0.4943493902683258, -0.87822026014328, -0.038847070187330246, -0.7745850086212158, -0.9742714166641235, 0.45873239636421204, 0.30181998014450073, -1.1118839979171753, -0.20769187808036804, -0.3142577111721039, 0.8270342350006104, 0.39481523633003235, 0.568042516708374, -0.22483320534229279, 0.6067108511924744, 0.32317686080932617, 0.22014665603637695, 0.28846877813339233, 0.13086406886577606, -0.06761163473129272, 0.36653923988342285, 0.01540995854884386, -0.3011792004108429, 0.010387305170297623, 0.34556394815444946, -0.3279464542865753, -0.13406552374362946, -0.09797526895999908, -0.06248977780342102, -0.13261137902736664, 0.6751929521560669, 0.5722820162773132, 0.142555832862854, -0.5776208639144897, 0.6484848260879517, 1.0317952632904053, 0.2705729007720947, -0.9569028615951538, -0.44423216581344604, 0.6617259979248047, -0.7780811786651611, -0.1918078511953354, 0.8274659514427185, -0.3404020667076111, -0.055979471653699875, -0.8963563442230225, 0.12309746444225311, 0.3477974236011505, -0.6003426313400269, -0.777876079082489, 0.6597281694412231, -0.23228847980499268, -0.3610457181930542, 0.2247888743877411, -0.7285992503166199, 0.17885521054267883, 0.6616693139076233, -1.320256233215332, -0.7073710560798645, 0.43966856598854065, -0.6217744946479797, -0.17954926192760468, 0.034088440239429474, 1.1082608699798584, 0.24125106632709503, -0.3923771381378174, 0.630091667175293, 0.2724689841270447, 0.08181405812501907, 0.33027559518814087, -0.4737137258052826, 0.8824218511581421, 0.1703934371471405, -0.42507845163345337, 0.25124064087867737, -0.21717047691345215, 0.22992751002311707, -0.22172138094902039, -0.583791196346283, 0.40432053804397583, -0.65458083152771, -0.24614587426185608, -0.42244982719421387, -0.7403684854507446, 0.7002918124198914, 0.13129553198814392, -0.21821564435958862, 0.629639744758606, 0.20365454256534576, -0.7649219036102295, -0.18765462934970856, -0.40587058663368225, -0.205777108669281, 0.4095507264137268, -0.4596060514450073, -0.2332797795534134, -0.17502325773239136, 0.7104275226593018, -1.055685043334961, -0.9246929287910461, 0.18835394084453583, 0.41007503867149353, 0.09961453080177307, 1.4384040832519531, -0.5350307822227478, 0.8139145374298096, 0.7728061079978943, 0.0008686460787430406, -0.6516501307487488, -0.6103717088699341, -0.459943562746048, -0.3233335316181183, 0.17783842980861664, 0.9067258834838867, -0.43803027272224426, 0.5307432413101196, 0.5258992910385132, -0.20573429763317108, -0.8403668999671936, -0.2661910355091095, -0.47706353664398193, -0.05878620967268944, -0.3681601881980896, 0.43132513761520386, -0.3687423765659332, 0.36476385593414307, -0.1862763911485672, -0.028966177254915237, 0.8536680340766907, -0.07256831973791122, -0.6495431661605835, -0.1985984444618225, -0.0159953273832798, -0.36542555689811707, -0.8320393562316895, -0.9187137484550476, -1.6697072982788086, 0.0931989997625351, -1.4907442331314087, 0.4776627719402313, -0.6464795470237732, -0.3125157356262207, -0.03847081586718559, -0.6764004230499268, 0.11072432994842529, 0.1095878854393959, -0.5335779190063477, -0.9405490756034851, -0.6557779908180237, -0.46233227849006653, 0.5415154695510864, 0.3558037281036377, -0.6458295583724976, 0.2350366860628128, 0.3522922098636627, 0.538809061050415, 0.43553850054740906, 0.8092201948165894, -0.355230450630188, -0.9017821550369263, -1.2973483800888062, 0.6635745167732239, 0.035076551139354706, -0.16367250680923462, -0.5204496383666992, 0.7472695112228394, 0.17903302609920502, -0.04850497469305992, -0.30188480019569397, 0.46630069613456726, -0.7492402791976929, -0.46093666553497314, 0.34179985523223877, -1.1872384548187256, 0.0032242650631815195, 0.018452828750014305, -0.39669665694236755, 0.01279494259506464, 0.33665916323661804, 0.12152615934610367, -0.7095627188682556, -0.9622237086296082, 0.5712127089500427, -0.452889621257782, -0.3618583381175995, 0.010636935010552406, -0.21159975230693817, -1.0635383129119873, 0.08836344629526138, -0.00806458294391632, 0.08503932505846024, -0.2943341135978699, 1.0346291065216064, 0.7339224815368652, -1.2982151508331299, 0.050485387444496155, 0.2153816521167755, 0.5352392792701721, -0.10313067585229874, 0.3443835973739624, 0.6280849575996399, -0.30107730627059937, 0.6270200610160828, 0.1767977774143219, 0.4666731059551239, -1.304876446723938, 0.2233804315328598, 0.4029555022716522, -0.04163816198706627, -0.29212522506713867, 1.4999749660491943, -0.48750659823417664, -1.072775959968567, 0.5079560875892639, -1.1885648965835571, -0.13539713621139526, -0.40728408098220825, 0.7976235747337341, 0.8128502368927002, 0.15046902000904083, 0.017878621816635132, -0.29948076605796814, -0.051336176693439484, -0.27646562457084656, -0.39108866453170776, 0.18472594022750854, -0.2485082447528839, -0.3644307851791382, 0.5383605360984802, 0.7669463157653809, -0.8540692329406738, -1.0501288175582886, -0.8554716110229492, -0.12086175382137299, -0.12004587054252625, 0.11598164588212967, -0.20105841755867004, -0.3367834687232971, 0.495578408241272, 0.28533637523651123, -0.24501562118530273, -0.06003416329622269, 0.11985470354557037, 0.2311411052942276, 0.5623849630355835, -0.08079622685909271, -0.476685106754303, -0.5815104246139526, 1.1115163564682007, 1.0043561458587646, -0.8815577626228333, 0.028391441330313683, -0.35790032148361206, -0.3699495792388916, 1.2248468399047852, 0.3004157841205597, 0.3552611172199249, 0.7023289203643799, 0.051537007093429565, 0.10691390186548233, 0.3771933317184448, -0.7478618621826172, 0.011256379075348377, 0.8828262686729431, 0.8076044321060181, 0.846432089805603, 0.3746377229690552, 0.43834394216537476, 0.7402665615081787, 0.12562768161296844, 0.11787465214729309, 0.1621505469083786, 0.45708176493644714, -0.5697343349456787, -0.15388186275959015, 0.13071773946285248, 0.6126737594604492, -0.7185912728309631, -0.6101515293121338, 0.43169692158699036, -0.10017628967761993, 0.3118080794811249, 0.3506471514701843, 0.6658682823181152, -0.10475444793701172, 0.19724677503108978, 0.461467444896698, 0.45911845564842224, -0.19252969324588776, 0.012271437793970108, -0.4367770552635193, -0.6743510365486145, 0.04264969378709793, 0.14408007264137268, -0.21523019671440125, -0.6229144930839539, -0.15074042975902557, 0.2023194134235382, -0.1320568174123764, 0.34636572003364563, 0.7961219549179077, 0.6001072525978088, 0.88658207654953, -0.5484798550605774, -0.17342683672904968, -0.511402428150177, -0.7317246198654175, 0.17204618453979492, -0.47446611523628235, -0.19595389068126678, 0.3109557628631592, 0.26929324865341187, 0.18202833831310272]}, "authors": [{"authorId": "2293779771", "name": "Weiguo Gao"}], "references": [{"paperId": "819bbdc2dac9e13d9ca3e2508a6e063186ce5e40", "title": "YaRN: Efficient Context Window Extension of Large Language Models"}, {"paperId": "6f6e2e0311589a9af045f6acd00b7dee6d19fce4", "title": "The Impact of Positional Encoding on Length Generalization in Transformers"}, {"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "5735e49e501c8e51e9be4079592e46e047747b03", "title": "Dissecting Transformer Length Extrapolation via the Lens of Receptive Field Analysis"}, {"paperId": "d6c5aab433d9871cabc01ffb1e5e1ea89141155b", "title": "KERPLE: Kernelized Relative Positional Embedding for Length Extrapolation"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "acbdbf49f9bc3f151b93d9ca9a06009f4f6eb269", "title": "Evaluating Large Language Models Trained on Code"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "db46b0de44c5113c47f0ec5392eb91d0726497bf", "title": "A Simple and Effective Positional Encoding for Transformers"}, {"paperId": "7072db6eddb85ecd2c117365d91bd694760f726e", "title": "Position Information in Transformers: An Overview"}, {"paperId": "db1afe3b3cd4cd90e41fbba65d3075dd5aebb61e", "title": "The Pile: An 800GB Dataset of Diverse Text for Language Modeling"}, {"paperId": "725264948d7b6946259af5b8d966e996b9570f99", "title": "DeepSpeed: System Optimizations Enable Training Deep Learning Models with Over 100 Billion Parameters"}, {"paperId": "f4061bd225b3be5b3f5b18eb1a229ce991efefeb", "title": "PEGASUS: Pre-training with Extracted Gap-sentences for Abstractive Summarization"}, {"paperId": "f3f90b45f4d9916d65731a1b11e0c2483605c79f", "title": "On the Relation between Position Information and Sentence Length in Neural Machine Translation"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "7a84a692327534fd227fa1e07fcb3816b633c591", "title": "Neural Tangent Kernel: Convergence and Generalization in Neural Networks"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "9a7332e7af8e9faf832c59c1fb0b985bfccd0b53", "title": "Multiple Kernel Learning Algorithms"}, {"paperId": "d26a48aff2abc3460c1018d5b410766f698d696c", "title": "Large Scale Multiple Kernel Learning"}, {"paperId": "52b7bf3ba59b31f362aa07f957f1543a29a4279e", "title": "Support-Vector Networks"}, {"paperId": "dc48bc1a4d81e0f37603013fd2a95644dc233bd0", "title": "Functional Interpolation for Relative Positions Improves Long Context Transformers"}, {"paperId": "3689b7ca7b07924b6135b8a71b9f1b7937b0a3d5", "title": "Length Extrapolation of Transformers: A Survey from the Perspective of Position Encoding"}, {"paperId": null, "title": "GPT-NeoX: Large scale autoregressive language modeling in pytorch"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "OpenAI"}]}