{"paperId": "55f1cde49846c58b0bedebde15b8f7d939f39432", "abstract": "Recent studies have highlighted a phenomenon in large language models (LLMs) known as\"the reversal curse,\"in which the order of knowledge entities in the training data biases the models' comprehension. For example, if a model is trained on sentences where entity A consistently appears before entity B, it can respond to queries about A by providing B as the answer. However, it may encounter confusion when presented with questions concerning B. We contend that the reversal curse is partially a result of specific model training objectives, particularly evident in the prevalent use of the next-token prediction within most causal language models. For the next-token prediction, models solely focus on a token's preceding context, resulting in a restricted comprehension of the input. In contrast, we illustrate that the GLM, trained using the autoregressive blank infilling objective where tokens to be predicted have access to the entire context, exhibits better resilience against the reversal curse. We propose a novel training method, BIdirectional Casual language modeling Optimization (BICO), designed to mitigate the reversal curse when fine-tuning pretrained causal language models on new data. BICO modifies the causal attention mechanism to function bidirectionally and employs a mask denoising optimization. In the task designed to assess the reversal curse, our approach improves Llama's accuracy from the original 0% to around 70%. We hope that more attention can be focused on exploring and addressing these inherent weaknesses of the current LLMs, in order to achieve a higher level of intelligence.", "venue": "arXiv.org", "year": 2023, "citationCount": 11, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A novel training method is proposed, BIdirectional Casual language modeling Optimization (BICO), designed to mitigate the reversal curse when fine-tuning pretrained causal language models on new data and improves Llama's accuracy from the original 0% to around 70%."}, "embedding": {"model": "specter_v2", "vector": [0.05726959928870201, 0.7133521437644958, -0.2831515371799469, -0.1982690542936325, -0.14882472157478333, -0.2643531262874603, 1.0307482481002808, -0.2951471507549286, -0.5088378190994263, -0.08728312700986862, 0.7099668979644775, -0.675750195980072, 0.14953531324863434, 0.02829660475254059, -0.35950741171836853, -0.2119440883398056, -1.095586895942688, 0.7137773036956787, -0.3467741906642914, -0.11310487985610962, 0.04294193908572197, -0.4040878415107727, -0.6954771280288696, 0.18131369352340698, 0.3011109530925751, 0.20830774307250977, 0.10262642055749893, 0.6154026389122009, -0.18556064367294312, 0.8722361922264099, 0.5067874193191528, -0.3761637806892395, 0.11066902428865433, 0.32908424735069275, -0.37327396869659424, -0.28099972009658813, 0.34049493074417114, -0.5725247263908386, -0.7280879616737366, 0.29129502177238464, -0.1883280724287033, 0.07028478384017944, 0.42665567994117737, -0.5636675953865051, -0.542824387550354, 1.0310468673706055, 0.5743502378463745, 1.0311375856399536, 0.18000435829162598, -0.5903444290161133, 1.458274245262146, -1.3050132989883423, 0.5054680705070496, 1.7815278768539429, 0.4656258523464203, 0.37263360619544983, -0.19018609821796417, -0.6458275318145752, 1.156838297843933, 0.4430977404117584, -1.0938960313796997, -0.14011836051940918, -0.40610966086387634, -0.16476038098335266, 1.5746960639953613, -0.40679818391799927, -0.5598435997962952, 0.6976431012153625, -0.35861366987228394, 1.1159040927886963, 0.08216726034879684, -0.8798700571060181, -0.45426931977272034, 0.2593727707862854, 0.38977840542793274, 0.6295909285545349, -0.3395199775695801, 0.8002755045890808, -1.0979931354522705, -0.1490047574043274, 0.4817814826965332, -0.5647002458572388, -0.5753378868103027, 0.2224397510290146, -0.07090894877910614, 0.575271487236023, 0.3273061513900757, 0.8381519913673401, -0.27305254340171814, 0.530101478099823, 0.09293350577354431, 0.5265525579452515, -0.23479732871055603, 0.2980065643787384, -0.2952433228492737, 0.2722909152507782, -0.5681383013725281, 0.11333804577589035, 0.5687187314033508, 0.39560186862945557, -0.4760357141494751, 0.23450227081775665, -0.44211772084236145, 0.026264041662216187, 1.4731698036193848, -0.5459067821502686, 0.537387490272522, -0.564267098903656, 0.4559483826160431, -0.6244359612464905, 0.507958710193634, -0.8070721626281738, -0.4123668372631073, -0.2257191240787506, -0.5277045369148254, -1.3214802742004395, 0.036542702466249466, 0.180014967918396, -0.8212644457817078, 0.7691760063171387, -0.2846093475818634, 0.21319971978664398, -0.11285096406936646, 0.6891934871673584, 0.5400698184967041, 0.6449518203735352, 0.6649737358093262, 0.036547739058732986, 0.5007517337799072, -0.3777586817741394, -0.5742732882499695, -1.2628045082092285, 0.5855496525764465, -0.31493616104125977, 0.08093545585870743, -0.11779434233903885, -1.0091335773468018, -0.9496121406555176, -1.052363634109497, 0.006079009734094143, -0.6553234457969666, -0.17379160225391388, 1.181331753730774, 0.2755325734615326, -0.7137383222579956, 0.7394564151763916, -0.11077655851840973, -0.22250473499298096, 0.30999836325645447, -0.0007155928760766983, -0.2102731615304947, -0.7163490653038025, -1.2821078300476074, 0.8553698658943176, 0.45698875188827515, -0.3522079885005951, -0.46918541193008423, -0.7160090208053589, -0.9663341045379639, -0.0034616650082170963, 0.5185667872428894, -0.6077056527137756, 1.0672277212142944, 0.307609885931015, -0.19077567756175995, 0.5710726976394653, -0.795670747756958, 0.11327420920133591, 0.8884499669075012, -0.20629139244556427, -0.6810864806175232, -0.6104180216789246, 0.027612201869487762, 0.4940446615219116, 0.15225954353809357, -0.8510368466377258, -0.33231988549232483, 0.07065054029226303, -0.13996616005897522, -0.33905133605003357, 0.03156257048249245, 0.24699334800243378, -0.10510014742612839, -0.14019347727298737, 0.5072890520095825, 1.1493436098098755, 0.09573955833911896, -0.18410669267177582, -0.16044852137565613, -1.2865421772003174, 0.46211880445480347, -0.4418129324913025, 0.9937046766281128, -0.49003252387046814, -0.6009828448295593, -0.17290647327899933, -0.07133437693119049, -0.6018068194389343, -0.7196027040481567, 0.5531800985336304, -0.6330733895301819, 1.0583006143569946, -0.196487694978714, -1.0907268524169922, -0.20861968398094177, 0.03516454994678497, -1.0017348527908325, -0.2289997637271881, 0.07097182422876358, 0.8698345422744751, -0.8911893963813782, 0.07256121188402176, -0.058759480714797974, 0.4522646963596344, -0.6132779717445374, 1.3547346591949463, -0.2961297631263733, 0.36455100774765015, 0.0374319963157177, -0.011991221457719803, 0.2269039750099182, -0.26974961161613464, 0.2908896505832672, -0.440817266702652, -0.3941096365451813, 0.7419653534889221, -0.30950579047203064, 0.6282451152801514, -0.4868665635585785, 0.44437897205352783, -0.18201284110546112, -0.7128189206123352, -0.27829140424728394, 0.5144094228744507, -0.20722922682762146, -0.5591475963592529, 0.10858810693025589, 0.27854490280151367, -0.5621930360794067, 0.050250377506017685, 0.36945709586143494, 0.314609169960022, 0.060399360954761505, 0.12484973669052124, 0.33014926314353943, -0.2549710273742676, 0.8066275715827942, 0.28938430547714233, 0.6467239856719971, 0.4061218500137329, 0.2684972882270813, 0.3454938232898712, 0.18540821969509125, -0.656126081943512, 0.22738991677761078, 0.8202374577522278, 0.9059315323829651, 1.0624337196350098, 0.5856597423553467, -0.8583624362945557, -0.38843971490859985, -0.04697997123003006, 0.05554238706827164, 1.2906399965286255, -0.33985447883605957, -0.37197327613830566, -0.2777297794818878, -0.3463281989097595, -0.16148796677589417, 0.6875787973403931, -0.7124584317207336, -0.13855823874473572, -0.5264745950698853, -1.3904865980148315, 0.5837147831916809, 0.347423255443573, 0.9157995581626892, -0.34768208861351013, 0.17212624847888947, -0.09995067864656448, -0.17902570962905884, -0.697660505771637, 0.012701979838311672, 0.2315695583820343, -0.3569532036781311, -0.291696697473526, 0.28371989727020264, -0.16171102225780487, 0.05736236274242401, -0.6984771490097046, 1.077518105506897, -0.06474944949150085, -0.26781317591667175, 0.3745344579219818, 0.3597392141819, -0.7007102966308594, -0.8871447443962097, -0.16935773193836212, -0.07081462442874908, -0.32468271255493164, 0.43661803007125854, 0.46357613801956177, -0.025122078135609627, 0.2412262111902237, -0.5578351616859436, 0.334602415561676, 0.27689072489738464, 0.37402838468551636, 0.16506491601467133, -0.10059592127799988, 0.21542660892009735, -1.104881763458252, 0.5397149324417114, -0.4405430853366852, -0.3842974007129669, 0.16076704859733582, -0.8471651077270508, -0.5320373177528381, 0.40778449177742004, -0.42839688062667847, -0.41875767707824707, -1.2631847858428955, 0.2381516695022583, 0.06305242329835892, -0.29592517018318176, 0.7592942714691162, 0.3156302869319916, 0.41713887453079224, 0.1358107179403305, 0.3415001332759857, -0.010614622384309769, -0.5395464301109314, 0.1788596510887146, -0.7273254990577698, 0.6493291854858398, 0.20937471091747284, 0.4342130422592163, -0.011300269514322281, -0.2916099429130554, -0.619732141494751, -0.594996452331543, -0.32730549573898315, -0.4685063362121582, -0.08112039417028427, 0.034293077886104584, -0.6957839727401733, -0.8548462390899658, 0.11172065883874893, -1.200071930885315, -0.362402081489563, 0.3329160809516907, -0.1708528995513916, 0.05383244901895523, -1.00515615940094, -1.0863349437713623, -0.4645006060600281, 0.24189823865890503, -0.5558696985244751, 0.08983168005943298, -0.12187311053276062, -0.5395141839981079, -0.5930667519569397, -0.263945609331131, 0.2545003294944763, 0.8719137907028198, -0.6296759843826294, 1.1885457038879395, 0.06538067758083344, -0.45515990257263184, -0.43480974435806274, -0.07982999086380005, 0.18302513659000397, -0.27003225684165955, -0.18375293910503387, -0.9893990159034729, 0.1191115602850914, 0.244400754570961, -0.05106039717793465, 0.2125486582517624, -0.2812027335166931, 0.5626435279846191, -0.044820450246334076, -0.7551962733268738, 0.21812781691551208, 1.4250158071517944, -0.4453243017196655, 0.36745041608810425, 0.1862892061471939, 1.2136391401290894, 0.8325077295303345, -0.11857248842716217, 0.3574710488319397, 0.3915165662765503, -0.15301690995693207, 0.10866018384695053, -0.0662534236907959, 0.0814426988363266, -1.0463346242904663, 0.28992030024528503, 1.1876747608184814, -0.05556785315275192, 0.10580537468194962, -1.3439955711364746, 0.80983966588974, -1.165591835975647, -0.6622279286384583, 0.6417264938354492, 0.6117615103721619, 0.43726569414138794, -0.4899493157863617, -0.9901862740516663, -0.26461273431777954, 0.34484410285949707, 0.16976867616176605, -0.32171785831451416, -0.15542560815811157, -0.09396827220916748, 0.01972060091793537, 0.23141297698020935, 0.7843279242515564, -0.43698960542678833, 0.4631918966770172, 15.238994598388672, 0.6628576517105103, 0.15353509783744812, 0.7320183515548706, 0.8554983139038086, 0.4605478346347809, -0.43389394879341125, 0.02069881372153759, -1.2598474025726318, -0.3484227955341339, 0.9772013425827026, 0.23355688154697418, 0.4333518445491791, -0.24138779938220978, 0.5472162961959839, -0.06905825436115265, -0.5540989637374878, 0.48894375562667847, 0.7996443510055542, -1.0938334465026855, 0.7129976153373718, 0.09682849794626236, 0.16312043368816376, 0.5302098393440247, 0.7000684142112732, 0.6987440586090088, 0.6211936473846436, -1.27886962890625, 0.5999503135681152, 0.06932152807712555, 0.5031126737594604, 0.15467429161071777, 0.6115326285362244, 0.5842449069023132, -0.536003053188324, -0.6574739813804626, -0.3841380774974823, -0.9259335398674011, 0.478446364402771, -0.16597364842891693, -0.8154715895652771, -0.5591655969619751, 0.07917602360248566, 0.43844300508499146, -0.25399407744407654, 0.38276228308677673, -0.1488509625196457, 0.539246678352356, 0.06658150255680084, 0.45112907886505127, 0.19583424925804138, 0.6573331356048584, 0.35807231068611145, -0.271763414144516, -0.037665512412786484, -0.035496633499860764, -0.025563066825270653, 0.6267644166946411, -0.5778634548187256, -0.1790713518857956, -0.6271918416023254, -0.43676087260246277, -0.0818239226937294, 0.4340038001537323, 0.7533668279647827, 0.28861573338508606, -0.6278795003890991, -0.010836874134838581, 0.8542104959487915, 0.25148093700408936, -0.10470492392778397, 0.3044717609882355, 0.22674660384655, -0.06096793711185455, -0.086390420794487, 0.45739132165908813, -0.5108804106712341, -0.4783300757408142, -0.5021297931671143, -0.42131927609443665, 0.4901282489299774, -1.0447707176208496, -1.0837854146957397, 0.6053637862205505, -0.16432034969329834, -0.0540505088865757, 0.11527644842863083, -0.8232132792472839, -0.01008936483412981, 0.25057855248451233, -1.226327657699585, -0.7763376235961914, -0.07844125479459763, -0.3001490533351898, -0.3533557057380676, 0.12845371663570404, 1.3208765983581543, 0.2364083081483841, -0.320206880569458, -0.2604946494102478, 0.009175824001431465, 0.09430232644081116, 0.03877817094326019, -1.1887725591659546, 0.5066551566123962, 0.15352186560630798, -0.08483384549617767, 0.6371116638183594, 0.3296809792518616, -0.04285620525479317, -0.5699812173843384, 0.09119093418121338, 1.1519492864608765, -1.2542662620544434, -0.0931592658162117, -0.4076770842075348, -0.9800273180007935, 0.6023316383361816, 0.2902185022830963, -0.6783143281936646, 0.04073820263147354, 0.3229375183582306, -0.6749057173728943, 0.006962459068745375, -0.6985240578651428, 0.43672701716423035, 0.7243809103965759, -0.6985630989074707, -0.8850098252296448, 0.1316981315612793, 0.29759010672569275, -0.6676445007324219, -0.6686263680458069, 0.1902436763048172, -0.1378501057624817, -0.06167233735322952, 0.7830258011817932, -0.5914399027824402, 0.4478608965873718, 0.6130712032318115, -0.20096954703330994, -0.7617156505584717, -0.02930174581706524, -0.6204491853713989, 0.41874265670776367, 0.3357544541358948, 0.8662450313568115, -0.4413309395313263, -0.024795575067400932, 1.2344361543655396, 0.39335212111473083, 0.1496136635541916, -0.7420303225517273, 0.1854984164237976, 0.3346001207828522, -0.804785966873169, 0.192827969789505, 0.13041262328624725, -0.062395431101322174, 0.09981729835271835, 0.3629845678806305, 1.0682448148727417, -0.31686142086982727, -0.6130310297012329, -0.02436203695833683, 0.08023887872695923, -0.016288558021187782, 0.037717606872320175, -0.4356878101825714, -1.3080090284347534, 0.06686742603778839, -0.6916257739067078, 0.09806501865386963, -1.144256591796875, -0.514430582523346, -0.03296338766813278, 0.03128049522638321, -0.013076414354145527, 0.34032702445983887, -0.27634456753730774, -0.47168174386024475, -0.6086454391479492, -0.06770090013742447, 0.3364734947681427, 0.7793322801589966, -0.792273998260498, 0.38689059019088745, -0.2282392680644989, -0.3638913035392761, 0.6675079464912415, 0.33250826597213745, -0.4245298206806183, -0.44107335805892944, -1.4102989435195923, 0.4422345757484436, -0.18817469477653503, 0.4623124897480011, -0.21950994431972504, 0.9036495685577393, 0.43443313241004944, 0.2377522736787796, -0.04430083557963371, 0.4579971134662628, -1.1112730503082275, -0.34376275539398193, 0.10552752017974854, -0.6417282819747925, 0.23058703541755676, -0.1323268711566925, -0.42838940024375916, -0.35376685857772827, 0.4122607409954071, -0.12773104012012482, -1.3128043413162231, -0.7571734189987183, 0.09589580446481705, -0.8871782422065735, 0.08342257142066956, -0.3051653802394867, 0.09151533991098404, -1.2182174921035767, -0.25586721301078796, -0.4425526261329651, 0.6900750398635864, -0.464212030172348, 1.1699572801589966, 0.3320779800415039, -0.7604877948760986, -0.02757168561220169, 0.1932191252708435, -0.19241200387477875, 0.2752875089645386, 0.3950682282447815, 0.15801537036895752, -0.34998980164527893, 0.7043266296386719, 0.5481265783309937, 0.5599607229232788, -0.7921583652496338, -0.15536905825138092, 0.8259166479110718, -0.31313303112983704, -0.05430862307548523, 0.7934526801109314, 0.040242910385131836, -1.1047600507736206, 0.6168708205223083, -0.8062692284584045, -0.8265650272369385, -0.051669251173734665, 0.6984105706214905, 0.44257891178131104, -0.06362701207399368, -0.17201362550258636, -0.17695868015289307, 0.058856699615716934, -0.23063425719738007, -0.4950358271598816, 0.5611595511436462, -0.4724857807159424, -0.4885164201259613, 0.8179017305374146, 0.7125583291053772, -0.6768773198127747, -0.5664089918136597, -0.3023078739643097, -0.16182498633861542, -0.4583961069583893, 0.3435344099998474, -0.8131213784217834, -0.19172728061676025, 0.5572258830070496, 0.44754186272621155, 0.3882059156894684, -0.4523546099662781, 0.05892554670572281, -0.07646240293979645, 0.5753750801086426, 0.04192781448364258, -0.49171942472457886, -0.9237061738967896, 0.9141168594360352, 1.6552362442016602, -1.047038197517395, 0.2410041242837906, -0.11702049523591995, -0.6053358316421509, 0.7427884936332703, 0.839538037776947, 0.4431001842021942, 0.9187233448028564, -0.09916241466999054, 0.49618783593177795, -0.05662728101015091, -1.0851503610610962, 0.003922987263649702, 0.5290142893791199, 1.210982084274292, 0.7222427725791931, 0.10348257422447205, -0.11386799812316895, 0.8267961740493774, -0.18435177206993103, 0.25513723492622375, 0.59869384765625, 0.3702237606048584, 0.12519744038581848, -0.08400555700063705, -0.20232996344566345, 0.5954546928405762, -0.7632849216461182, -0.7674350142478943, -0.25359249114990234, 1.0093258619308472, 0.19603514671325684, 0.806503176689148, 1.0052181482315063, 0.291012167930603, 0.592495858669281, 0.5140966773033142, 0.13529908657073975, -0.21508368849754333, -0.27500131726264954, -0.3703806698322296, -0.12347802519798279, 0.1496690958738327, -0.300627201795578, -0.6791328191757202, -0.3116370141506195, -0.37922215461730957, 0.21697363257408142, -0.01647801510989666, 0.07727615535259247, 1.1500519514083862, 0.30480286478996277, 0.20519569516181946, -0.4353451132774353, -0.3440764546394348, -0.29520586133003235, -0.9334177374839783, 0.2884763479232788, -0.49201419949531555, -0.12770943343639374, -0.2213010936975479, -0.9134417772293091, -0.09820009768009186]}, "authors": [{"authorId": "66261602", "name": "Ang Lv"}, {"authorId": "2266486204", "name": "Kaiyi Zhang"}, {"authorId": "1889683", "name": "Shufang Xie"}, {"authorId": "2071635049", "name": "Quan Tu"}, {"authorId": "2266420263", "name": "Yuhan Chen"}, {"authorId": "2263887786", "name": "Ji-Rong Wen"}, {"authorId": "2172312251", "name": "Rui Yan"}], "references": [{"paperId": "beaf64df85f8204b8cd89a7f46827608e6d16922", "title": "MusicAgent: An AI Agent for Music Understanding and Generation with Large Language Models"}, {"paperId": "1256cd7ecea1c312b854c6673fab0c2908276d8a", "title": "Untying the Reversal Curse via Bidirectional Language Model Editing"}, {"paperId": "8eafec7014d08043517834b5a2ed26384f188873", "title": "The Reversal Curse: LLMs trained on \"A is B\" fail to learn \"B is A\""}, {"paperId": "77b1f1c6d1658d120456b9046667cf009ceb39ce", "title": "MetaMath: Bootstrap Your Own Mathematical Questions for Large Language Models"}, {"paperId": "24d52678c887331b9da0368e8a2f58bec07f7203", "title": "Exploring Large Language Models for Communication Games: An Empirical Study on Werewolf"}, {"paperId": "28c6ac721f54544162865f41c5692e70d61bccab", "title": "A Survey on Large Language Model based Autonomous Agents"}, {"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "1d26c947406173145a4665dd7ab255e03494ea28", "title": "GLM-130B: An Open Bilingual Pre-trained Model"}, {"paperId": "a8ca46b171467ceb2d7652fbfb67fe701ad86092", "title": "LoRA: Low-Rank Adaptation of Large Language Models"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "f64e1d6bc13aae99aab5449fc9ae742a9ba7761e", "title": "UniLMv2: Pseudo-Masked Language Models for Unified Language Model Pre-Training"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "1c71771c701aadfd72c5866170a9f5d71464bb88", "title": "Unified Language Model Pre-training for Natural Language Understanding and Generation"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "6c2b28f9354f667cd5bd07afc0471d8334430da7", "title": "A Neural Probabilistic Language Model"}, {"paperId": "d7da009f457917aa381619facfa5ffae9329a6e9", "title": "Bleu: a Method for Automatic Evaluation of Machine Translation"}, {"paperId": "d1120d67b700e4dfe8b39eb1e48fbdea4e1a0c43", "title": "HuggingGPT: Solving AI Tasks with ChatGPT and its Friends in Hugging Face"}, {"paperId": "b76e98a0a023d37c6534aa2ead09c8ff595f0bae", "title": "A Robustly Optimized BERT Pre-training Approach with Post-training"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "general language model pretraining with autoregressive blank"}]}