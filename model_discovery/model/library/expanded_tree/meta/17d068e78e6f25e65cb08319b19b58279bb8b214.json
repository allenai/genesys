{"paperId": "17d068e78e6f25e65cb08319b19b58279bb8b214", "abstract": "Diffusion models have shown incredible capabilities as generative models; indeed, they power the current state-of-the-art models on text-conditioned image generation such as Imagen and DALL-E 2. In this work we review, demystify, and unify the understanding of diffusion models across both variational and score-based perspectives. We first derive Variational Diffusion Models (VDM) as a special case of a Markovian Hierarchical Variational Autoencoder, where three key assumptions enable tractable computation and scalable optimization of the ELBO. We then prove that optimizing a VDM boils down to learning a neural network to predict one of three potential objectives: the original source input from any arbitrary noisification of it, the original source noise from any arbitrarily noisified input, or the score function of a noisified input at any arbitrary noise level. We then dive deeper into what it means to learn the score function, and connect the variational perspective of a diffusion model explicitly with the Score-based Generative Modeling perspective through Tweedie's Formula. Lastly, we cover how to learn a conditional distribution using diffusion models via guidance.", "venue": "arXiv.org", "year": 2022, "citationCount": 186, "influentialCitationCount": 19, "openAccessPdf": {"url": "http://arxiv.org/pdf/2208.11970", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "This work derives Variational Diffusion Models (VDM) as a special case of a Markovian Hierarchical Variational Autoencoder, where three key assumptions enable tractable computation and scalable optimization of the ELBO."}, "embedding": {"model": "specter_v2", "vector": [0.6514765620231628, 0.5270993709564209, 0.06476889550685883, 0.05211678892374039, -0.7205531597137451, -0.13135157525539398, 0.6106776595115662, -0.4545319974422455, -0.23785226047039032, -0.46051016449928284, 0.2744073271751404, 0.21190513670444489, -0.23878821730613708, -0.2763437032699585, -0.35804155468940735, -0.4790157377719879, -0.8064409494400024, 0.10649915039539337, -0.12405476719141006, -0.39175915718078613, -0.34798020124435425, -0.4398908317089081, -0.9655221104621887, -0.0737752839922905, 0.2905680239200592, 0.8733057379722595, -0.019550129771232605, 1.8061574697494507, -0.21459554135799408, 0.34224313497543335, 0.45763877034187317, -0.4738858938217163, 0.5485119819641113, -0.4620499908924103, -0.15577280521392822, 0.16044758260250092, 0.0571625791490078, -0.4809190034866333, -0.66139155626297, 0.9422104954719543, -0.18162329494953156, 0.32548654079437256, 1.1667951345443726, -0.30930620431900024, -0.6941096782684326, 0.21928811073303223, 0.2951592803001404, 1.1442663669586182, -0.3096117079257965, -0.6715177297592163, 1.464269757270813, -1.0155441761016846, 0.7011486887931824, 1.2753221988677979, 0.22082899510860443, 0.692839503288269, -0.568570077419281, -0.2896139919757843, 0.5809291005134583, -0.126702219247818, -0.8290977478027344, 0.25200405716896057, 0.10108675062656403, -0.5649072527885437, 0.804973304271698, -0.4154994487762451, 0.13380509614944458, 1.1879819631576538, 0.42527344822883606, 1.704343557357788, 0.049128275364637375, -0.8329679369926453, 0.14887626469135284, 0.1816103756427765, -0.47641775012016296, 0.668865978717804, -0.7018092274665833, 0.683010458946228, -0.7836315631866455, 0.23365384340286255, 0.6489471793174744, 0.0033342773094773293, -0.04616589844226837, -0.25180885195732117, 0.2281176596879959, 0.9551548361778259, 0.4416868984699249, 0.5389561057090759, -0.32727181911468506, 1.0867161750793457, 0.11097974330186844, 0.3099818229675293, 0.38533613085746765, -0.35694602131843567, 0.30410322546958923, 0.35578134655952454, -1.243893027305603, 0.4048100709915161, -0.20146001875400543, 0.47790905833244324, -0.041579000651836395, 0.3061898350715637, -0.724161684513092, 0.2043178826570511, 1.4649369716644287, 0.19563306868076324, 0.24969255924224854, -0.8019103407859802, 0.006850307807326317, -1.1660596132278442, 0.1487889289855957, -0.8628298044204712, 0.25505441427230835, -0.34667298197746277, -1.1447967290878296, -0.49060776829719543, -0.5619823336601257, -0.19394251704216003, -1.2760074138641357, 0.8555013537406921, -0.19455893337726593, -0.09397277235984802, -0.1243208721280098, 0.8800661563873291, -0.3886081874370575, 1.1018620729446411, 0.04529046639800072, 0.2032174915075302, 0.14590321481227875, -0.4716823995113373, -0.9922606348991394, -0.5813233256340027, 0.19612807035446167, -0.34403958916664124, 0.13081765174865723, 0.13245874643325806, -1.445676565170288, -1.0876929759979248, -1.0772565603256226, 0.2766871154308319, -0.11713697761297226, 0.14235417544841766, 0.9660146236419678, 0.4163042902946472, -1.0408377647399902, 0.9392282366752625, -0.8195191025733948, -0.1271076649427414, 0.6046649813652039, 0.109481081366539, 0.4654613435268402, -0.24644145369529724, -0.8377857208251953, 0.15670974552631378, -0.355680376291275, -0.7389088869094849, -0.5453193187713623, -0.13145002722740173, -0.5459766983985901, 0.003363264026120305, 0.31798702478408813, -0.8374155163764954, 1.1767312288284302, -0.5523635149002075, -1.1621482372283936, 0.12990248203277588, -0.5005201697349548, 0.18965482711791992, 0.6081091165542603, -0.19979000091552734, -0.4758957624435425, -0.0988236591219902, 0.0008157951524481177, 0.4866940379142761, 0.5402114391326904, -0.5801303386688232, -0.31390443444252014, -0.09041012078523636, -0.6771463751792908, -0.5151870250701904, -0.019881976768374443, 0.2847577929496765, -0.23925183713436127, -0.7244133353233337, 0.10907571762800217, 0.5343844890594482, -0.5263279676437378, 0.06366588920354843, -0.2050677388906479, -0.8917824625968933, 0.7747959494590759, -0.19074204564094543, 0.7220544219017029, -0.7149210572242737, -0.11494683474302292, 0.12946192920207977, 0.18152005970478058, -0.6556426286697388, -0.7502023577690125, 0.3380982279777527, 0.03831293806433678, 0.7572314739227295, -0.47011736035346985, -1.0914127826690674, 0.06254182010889053, -0.031742725521326065, -0.6516456604003906, -0.45548853278160095, 0.6072863340377808, 0.9821934103965759, -0.50553297996521, 0.16930095851421356, -0.44822362065315247, 0.4889596104621887, -0.8966097831726074, 1.2073734998703003, -0.42511701583862305, 0.4623631238937378, -0.4032650589942932, -0.5027822256088257, 0.09249810129404068, -0.287042498588562, 0.11069116741418839, 0.2970035970211029, 0.44681987166404724, -0.2487410306930542, -0.8703111410140991, 1.5284545421600342, -0.1400093287229538, 0.8897484540939331, 0.06296573579311371, -0.6352254748344421, 0.3084985017776489, 0.34878289699554443, 0.11346671730279922, -0.13342829048633575, 0.43516141176223755, 0.18163169920444489, -0.5787372589111328, 0.23932133615016937, 0.35817864537239075, 0.3646557927131653, -0.12730109691619873, 0.5512771010398865, 0.7268598675727844, -0.41610562801361084, 0.5608248710632324, 0.8267494440078735, 0.9545642733573914, 0.5363410115242004, -0.1557634472846985, 0.15234385430812836, -0.2189432680606842, -0.9132972359657288, -0.32896316051483154, 0.9411512613296509, 0.6524569988250732, 1.0435140132904053, 0.3787585198879242, -0.6779178977012634, -0.6114794611930847, -0.8373610973358154, 0.8244443535804749, 1.0087409019470215, -0.2069767713546753, -0.33178240060806274, -0.9608239531517029, -0.2224525809288025, -0.28315526247024536, 0.028988126665353775, -1.2140586376190186, -0.10622265934944153, -0.04459034278988838, -1.2177668809890747, 0.663002073764801, 0.3588540554046631, 0.6909656524658203, -0.08512523025274277, 0.13686805963516235, -0.23120702803134918, 0.37360820174217224, -0.36771172285079956, -0.7362015247344971, 0.07815463095903397, -0.15638485550880432, 0.42149588465690613, -0.556669294834137, 0.3406071066856384, -0.0011092462809756398, -0.9026055932044983, 0.39759424328804016, -0.3987707495689392, -0.5891553163528442, 0.6432085037231445, 0.5937502384185791, -0.925516664981842, -1.0219932794570923, 0.12401235103607178, -0.044199418276548386, 0.33598223328590393, -0.17039428651332855, 0.3353552520275116, -0.22461950778961182, 0.19459697604179382, -0.9227615594863892, -0.004876399878412485, 0.20939914882183075, 0.02402525395154953, 0.7565582990646362, -0.07033395022153854, -0.2617383897304535, -0.6781100034713745, 1.2310240268707275, 0.016434509307146072, -0.5309274792671204, 0.11498027294874191, -0.9721475839614868, -0.18603205680847168, -0.027719272300601006, -0.79002445936203, -0.6445748209953308, -0.899101197719574, 0.06604298949241638, -0.21719780564308167, -0.42622384428977966, 0.0766349732875824, 0.8346167802810669, 0.3069581091403961, 0.6259764432907104, 0.16744685173034668, 0.3887178301811218, 0.004453797359019518, 0.5539237856864929, -1.0507560968399048, 0.3310179114341736, 0.14850622415542603, 0.4922831952571869, 0.48055946826934814, 0.1682669222354889, -0.44622647762298584, -0.5514827966690063, -0.203436478972435, -0.5133457779884338, -1.0868852138519287, 0.8642337918281555, -0.3633344769477844, -0.7725822925567627, -0.25340983271598816, -1.0051010847091675, -0.3015156090259552, 0.08003178983926773, -0.518265962600708, -0.34051865339279175, -1.1479488611221313, -1.285569667816162, -0.9630061984062195, -0.17162498831748962, -1.1263560056686401, 0.4582904577255249, 0.06995682418346405, -0.2860204875469208, -0.9247456192970276, 0.10845164209604263, -0.31745320558547974, 1.0018219947814941, -0.2673775255680084, 0.6246773600578308, 0.4878799319267273, -0.758673369884491, -0.20740468800067902, 0.5354617834091187, 0.6428289413452148, -0.5627561211585999, 0.5276744961738586, -0.6180322170257568, 0.23616629838943481, -0.34539660811424255, -0.17987018823623657, 0.37289121747016907, 0.6969890594482422, 0.23521295189857483, 0.2049204409122467, -0.5546380877494812, 0.34700149297714233, 1.5944212675094604, -0.38411661982536316, -0.05645851418375969, -0.012507970444858074, 0.7315012216567993, 0.3091506063938141, -0.8486549854278564, 0.491450697183609, -0.02813962660729885, 0.32162970304489136, -0.11323753744363785, 0.01622668467462063, -0.32614850997924805, -1.0143190622329712, 0.6224353313446045, 1.4924733638763428, -0.020254535600543022, -0.4609326720237732, -0.8924391865730286, 0.42353153228759766, -1.2426390647888184, -0.8817830681800842, 0.5702561140060425, 0.3071492314338684, -0.3571133017539978, -0.4107308089733124, -0.24855999648571014, -0.10176172852516174, 0.2196430116891861, 0.33317407965660095, -0.48033279180526733, -0.20399896800518036, -0.24283182621002197, 0.6589658260345459, 0.13412004709243774, 0.8096322417259216, 0.08838460594415665, 0.24526812136173248, 14.88278865814209, 1.1747945547103882, 0.0596354603767395, 0.9299737215042114, 0.7884200811386108, -0.056792814284563065, -0.6983998417854309, -0.15926708281040192, -0.7697442770004272, -0.24219442903995514, 1.0344957113265991, 0.41582104563713074, 0.46028342843055725, 0.0690431222319603, 0.10189130157232285, 0.21622082591056824, 0.0282931849360466, 0.5372335910797119, 0.39020732045173645, -1.4977134466171265, 0.49791133403778076, 0.5599051117897034, 0.9381648302078247, 0.8264553546905518, 0.9821286201477051, 0.36447277665138245, 0.8334696888923645, -0.2844832241535187, 0.8765178918838501, 0.6959775686264038, 0.7185831665992737, 0.1566186398267746, 0.10169666260480881, 0.4928092658519745, -0.7346367835998535, -0.2896818220615387, -0.5560894012451172, -0.7625300288200378, 0.6660378575325012, 0.36674821376800537, -0.1825435310602188, -0.407809853553772, 0.29009199142456055, 0.5816952586174011, 0.3132895231246948, -0.1389567106962204, -0.4069765508174896, 0.9546493291854858, -0.23388731479644775, 0.22697924077510834, 0.33691075444221497, 0.17976626753807068, 0.6618073582649231, -0.23701947927474976, 0.4949534237384796, 0.07255031168460846, 0.09739580005407333, 0.9308550953865051, -0.395670086145401, 0.16427834331989288, -0.24407042562961578, 0.007986175827682018, -0.9404033422470093, 0.44804057478904724, 0.27940133213996887, 0.3431573808193207, -0.08623723685741425, 0.7144396901130676, 0.43809980154037476, 0.5244688987731934, 0.010665442794561386, -0.1014540046453476, 0.3475533425807953, -0.11948524415493011, 0.38527557253837585, 0.30349433422088623, -0.08257856220006943, -0.5529474020004272, -0.6785603165626526, 0.006571728270500898, 0.13263656198978424, -1.2690619230270386, -1.132149338722229, 1.1384103298187256, -0.42311257123947144, 0.2926170527935028, 0.40761011838912964, -0.6572233438491821, -0.3023079037666321, 0.44176343083381653, -1.0595667362213135, -0.39421236515045166, 0.47495073080062866, -0.053930193185806274, -0.1482817679643631, 0.07177219539880753, 0.7544402480125427, -0.18964475393295288, -0.2664397954940796, -0.20334452390670776, 0.3806873857975006, 0.1094249039888382, -0.21597598493099213, -1.1028417348861694, 0.8508901596069336, 0.42031049728393555, 0.5066045522689819, -0.095384880900383, 0.13909539580345154, -0.036924563348293304, -0.22399172186851501, 0.3650912046432495, -0.027270890772342682, -1.3827033042907715, -0.45428773760795593, -0.7054702043533325, -0.6989079117774963, 0.054017324000597, 0.5396128296852112, -0.4906423091888428, 0.1710992157459259, -0.12148292362689972, -0.16009165346622467, -0.27657759189605713, -0.3261309862136841, 0.07276220619678497, 0.3584534227848053, -0.4713100790977478, 0.05230182781815529, -0.11918391287326813, -0.047555845230817795, -0.8513914942741394, -0.162730410695076, -0.34015533328056335, 0.17880800366401672, -0.5240386724472046, 0.6055981516838074, -0.4353586733341217, 0.8073928952217102, 0.8316616415977478, -0.23052766919136047, -0.8150612115859985, -0.4655747711658478, -1.226219892501831, 0.5144321918487549, 0.223189115524292, 0.637380838394165, 0.07431816309690475, 0.5244634747505188, 0.5283278822898865, 0.7811631560325623, -0.45343512296676636, -0.7633798122406006, 0.024141548201441765, 0.37603864073753357, -1.141343355178833, 0.17524997889995575, -0.6915248036384583, -0.874351978302002, -0.1982080489397049, -0.017588121816515923, 0.9079787731170654, -0.04405827447772026, -1.0907224416732788, 0.5560190677642822, -0.4323403239250183, -0.13628192245960236, -0.780788242816925, -0.5252222418785095, -1.7671540975570679, -0.3910523056983948, -1.2286745309829712, -0.13730525970458984, -1.1194238662719727, -0.510962724685669, 0.2609962224960327, -0.2501068115234375, -0.7044683694839478, 0.4723752439022064, -0.277171790599823, -0.025555595755577087, -0.44894346594810486, -0.37212255597114563, 0.8247255682945251, 1.1954230070114136, -1.0257861614227295, 0.3160591125488281, 0.06928060203790665, 0.21387505531311035, 0.34687015414237976, 0.18842892348766327, -0.9726406335830688, -0.8259600400924683, -1.3106003999710083, 0.5695888996124268, 0.05460534617304802, 0.008892225101590157, -0.9524217844009399, 0.46965134143829346, 0.33234700560569763, 0.45063239336013794, 0.3706832528114319, 0.3556935489177704, -0.6574928760528564, -0.18437667191028595, -0.02497781813144684, -1.2021126747131348, 0.18067395687103271, -0.418750524520874, 0.45865684747695923, -0.08689476549625397, 0.6427337527275085, 0.06470219045877457, -0.9301666617393494, -0.007577421143651009, 0.8363105654716492, -1.085141658782959, 0.03939557075500488, -0.3199833929538727, -0.16654887795448303, -0.3967399597167969, -0.9452199339866638, -0.6666817665100098, -0.14367343485355377, -0.25233742594718933, 0.9808105230331421, 0.43211615085601807, -0.9300926327705383, 0.06904491037130356, 0.2402818650007248, -0.3352525532245636, -0.11741103231906891, 1.1004841327667236, -0.08503027260303497, -0.017659788951277733, 0.06551018357276917, 0.4276917576789856, 0.15995532274246216, -0.4190797805786133, -0.12193286418914795, 0.8032890558242798, -0.692918598651886, -0.11558374017477036, 1.219092607498169, -0.07234153151512146, -0.7823992967605591, -0.15618786215782166, -0.6255321502685547, -0.19173313677310944, -0.5594778060913086, 0.4405193328857422, 0.10021384805440903, -0.591373085975647, 0.03200193867087364, 0.18365372717380524, 0.6450772285461426, -0.03739597648382187, -1.1100502014160156, 0.44238144159317017, -0.6180747747421265, 0.11862575262784958, 0.6156414151191711, 0.5642457008361816, -0.4907333254814148, -1.1340875625610352, -0.5646560788154602, -0.5427111983299255, -0.2421911507844925, 0.4989594519138336, -0.5330426692962646, -0.812702476978302, 1.2190308570861816, 1.201187014579773, 0.4213537275791168, 0.21414633095264435, 0.1393248438835144, 0.4080342650413513, -0.06835529953241348, -0.18015973269939423, -0.7919010519981384, -0.0969487875699997, 0.6490440368652344, 1.0604931116104126, -0.44563817977905273, 0.25062328577041626, 0.09425073117017746, -0.920198380947113, 0.9082653522491455, 0.015280501917004585, 0.06560395658016205, 1.23623788356781, -0.04152131453156471, 0.564793586730957, 0.008133121766149998, -1.040872573852539, -0.1762852519750595, 1.150398850440979, 1.1649465560913086, 0.05036775767803192, 0.23988665640354156, 0.4130609333515167, 0.928683876991272, 0.15015994012355804, 0.134145125746727, 0.6912063956260681, 0.2292218953371048, -0.012253664433956146, -0.12711723148822784, -0.14352795481681824, 0.528164267539978, -1.2157186269760132, -0.02454228885471821, 0.23131074011325836, 0.4200209677219391, 0.4152946174144745, 0.7157471776008606, 0.5616104602813721, 0.01950020343065262, 0.331708699464798, -0.048219725489616394, 0.4664911925792694, 0.014186414889991283, 0.03827890008687973, 0.18176409602165222, -1.3126757144927979, 0.21990616619586945, -0.355674684047699, -0.6167693138122559, -0.06296740472316742, -0.16457287967205048, 0.19424085319042206, -0.06292805820703506, 0.4775433838367462, 1.1331130266189575, 0.5926281213760376, 0.3132045567035675, -0.1727745682001114, -0.5152405500411987, -0.1770564615726471, -0.6186551451683044, -0.22904567420482635, 0.05565180629491806, 0.1293659806251526, -0.48561331629753113, -0.579921305179596, 0.1856997013092041]}, "authors": [{"authorId": "51136567", "name": "Calvin Luo"}], "references": [{"paperId": "af9f365ed86614c800f082bd8eb14be76072ad16", "title": "Classifier-Free Diffusion Guidance"}, {"paperId": "9695824d7a01fad57ba9c01d7d76a519d78d65e7", "title": "Photorealistic Text-to-Image Diffusion Models with Deep Language Understanding"}, {"paperId": "c57293882b2561e1ba03017902df9fc2f289dea2", "title": "Hierarchical Text-Conditional Image Generation with CLIP Latents"}, {"paperId": "94bcd712aed610b8eaeccc57136d65ec988356f2", "title": "Variational Diffusion Models"}, {"paperId": "0f183bcfe65781c06b1a48a6f56e0f3c63e8e4a4", "title": "Cascaded Diffusion Models for High Fidelity Image Generation"}, {"paperId": "64ea8f180d0682e6c18d1eb688afdb2027c02794", "title": "Diffusion Models Beat GANs on Image Synthesis"}, {"paperId": "5d556dd3afff529de8cb694f88916b2d95fbdd3a", "title": "How to Train Your Energy-Based Models"}, {"paperId": "633e2fbfc0b21e959a244100937c5853afca4853", "title": "Score-Based Generative Modeling through Stochastic Differential Equations"}, {"paperId": "5c126ae3421f05768d8edd97ecd44b1364e2c99a", "title": "Denoising Diffusion Probabilistic Models"}, {"paperId": "1156e277fa7ec195b043161d3c5c97715da17658", "title": "Improved Techniques for Training Score-Based Generative Models"}, {"paperId": "965359b3008ab50dd04e171551220ec0e7f83aba", "title": "Generative Modeling by Estimating Gradients of the Data Distribution"}, {"paperId": "81664382e5db10bc6598db0b8814a8e765d30576", "title": "Sliced Score Matching: A Scalable Approach to Density and Score Estimation"}, {"paperId": "cba68428ee755091710ef98d7203f73ac61848e5", "title": "Deep Energy Estimator Networks"}, {"paperId": "6a97d2668187965743d1b825b306defccbabbb4c", "title": "Improved Variational Inference with Inverse Autoregressive Flow"}, {"paperId": "64d698ecd01eab99e81e586400e86d3d70b9cba7", "title": "Ladder Variational Autoencoders"}, {"paperId": "2dcef55a07f8607a819c21fe84131ea269cc2e3c", "title": "Deep Unsupervised Learning using Nonequilibrium Thermodynamics"}, {"paperId": "484ad17c926292fbe0d5211540832a8c8a8e958b", "title": "Stochastic Backpropagation and Approximate Inference in Deep Generative Models"}, {"paperId": "dd63a63ef76d23c898f122f0f757ac307b836c19", "title": "Tweedie\u2019s Formula and Selection Bias"}, {"paperId": "872bae24c109f7c30e052ac218b17a8b028d08a0", "title": "A Connection Between Score Matching and Denoising Autoencoders"}, {"paperId": "9966e890f2eedb4577e11b9d5a66380a4d9341fe", "title": "Estimation of Non-Normalized Statistical Models by Score Matching"}, {"paperId": null, "title": "Guidance: a cheat code for diffusion models, 2022"}, {"paperId": "4d506e43beab82d04473a11e92fb4a194cdcceba", "title": "Journey to the BAOAB-limit: \ufb01nding effective MCMC samplers for score-based models"}, {"paperId": null, "title": "What are diffusion models? lilianweng"}, {"paperId": "ef4f5a50837a7c1b3e87b9300ffc7ba00d461a0f", "title": "AUTO-ENCODING VARIATIONAL BAYES"}, {"paperId": "7fc604e1a3e45cd2d2742f96d62741930a363efa", "title": "A Tutorial on Energy-Based Learning"}, {"paperId": null, "title": "(cid:69) q ( x T \u2212 1 | x 0 ) [ D KL ( q ( x T | x T \u2212 1 )"}, {"paperId": null, "title": "(cid:69) q ( x t \u2212 1 , x t +1 | x 0 ) [ D KL ( q ( x t | x t \u2212 1 ) (cid:107) p \u03b8 ( x t | x t +1 ))] is a consistency term"}]}