{"paperId": "d8f3ff9e36bdb0d97623584c37d830baf436c559", "abstract": "AlphaFold2 has been hailed as a breakthrough in protein folding. It can rapidly predict protein structures with lab-grade accuracy. However, its implementation does not include the necessary training code. OpenFold is the first trainable public reimplementation of AlphaFold. AlphaFold training procedure is prohibitively time-consuming, and gets diminishing benefits from scaling to more compute resources. In this work, we conducted a comprehensive analysis on the AlphaFold training procedure based on Openfold, identified that inefficient communications and overhead-dominated computations were the key factors that prevented the AlphaFold training from effective scaling. We introduced ScaleFold, a systematic training method that incorporated optimizations specifically for these factors. ScaleFold successfully scaled the AlphaFold training to 2080 NVIDIA H100 GPUs with high resource utilization. In the MLPerf HPC v3.0 benchmark, ScaleFold finished the OpenFold benchmark in 7.51 minutes, shown over $6\\times$ speedup than the baseline. For training the AlphaFold model from scratch, ScaleFold completed the pretraining in 10 hours, a significant improvement over the seven days required by the original AlphaFold pretraining baseline.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "ScaleFold was introduced, a systematic training method that incorporated optimizations specifically for inefficient communications and overhead-dominated computations that prevented the AlphaFold training from effective scaling and successfully scaled the AlphaFold training to 2080 NVIDIA H100 GPUs with high resource utilization."}, "embedding": {"model": "specter_v2", "vector": [0.20951208472251892, 0.4568256437778473, -0.15890610218048096, -0.2747492492198944, 0.1831429898738861, 0.1368263065814972, -0.011206249706447124, -0.09337395429611206, -0.4643605649471283, 0.08505242317914963, 0.443389356136322, -0.631952166557312, 0.8125149011611938, -0.06724946200847626, -0.39759406447410583, -0.4991225004196167, -1.1205977201461792, 0.12673436105251312, -0.12844730913639069, 0.19141383469104767, -0.19893445074558258, -0.01556540559977293, -1.212106466293335, 0.81513911485672, 0.6349539160728455, 0.8393078446388245, -0.12428444623947144, 1.136991024017334, -0.527917742729187, 0.03627476096153259, 0.45370611548423767, -0.06700780242681503, 0.1361147165298462, -0.10641149431467056, -0.7562943696975708, 0.02889958582818508, 0.3743852376937866, -0.3056797385215759, -0.48015666007995605, 0.3885372281074524, 0.19556239247322083, 0.3535655736923218, 0.24174608290195465, -0.4112425446510315, 0.1878299117088318, 0.12836118042469025, 0.48910531401634216, 0.7405171990394592, -0.5009699463844299, 0.0015519818989560008, 0.7540728449821472, -1.8293706178665161, 0.3290170729160309, 0.660395085811615, 1.1589449644088745, 0.1455388218164444, -0.8755427598953247, -0.07344260811805725, -0.06247808039188385, -0.08690313994884491, -0.6765618920326233, -0.15500223636627197, -0.6911291480064392, -0.37020620703697205, 2.1318888664245605, -0.17341363430023193, -0.04632357880473137, 0.15650701522827148, 0.4235767722129822, 0.592548131942749, 0.7128896117210388, -0.5558700561523438, 0.506488561630249, 0.05924368277192116, 0.5309217572212219, 0.5577324628829956, -0.29486194252967834, 0.12428849190473557, -1.092390537261963, -0.6120754480361938, -0.045957136899232864, 0.017549509182572365, 0.3640471398830414, -0.05900834500789642, -0.17588184773921967, 0.3399665951728821, 0.7067545652389526, 0.32751110196113586, -0.687167763710022, 0.32485949993133545, 0.5762014985084534, 0.3191448152065277, 0.16380548477172852, 0.3986065089702606, -0.3471912741661072, 0.28387337923049927, -0.49000945687294006, -0.20971868932247162, 0.24190518260002136, 0.5014379024505615, 0.42497873306274414, -0.16951020061969757, -0.5460744500160217, -0.030849536880850792, 0.751242995262146, -0.3647947311401367, 0.12517115473747253, -0.3604671061038971, 0.08171272277832031, -0.09959865361452103, 0.2642947733402252, -0.22428344190120697, -0.5370916724205017, -0.17548589408397675, -1.1898900270462036, -0.5296441316604614, -0.6931465268135071, -0.5209092497825623, -1.0375642776489258, -0.004112070892006159, 0.3930343985557556, 0.1469545215368271, 0.32626864314079285, 0.9716094136238098, 0.9301819205284119, 0.4677453935146332, 0.32077428698539734, -0.14015193283557892, 0.966210663318634, -1.1622989177703857, -0.2474077343940735, -0.4548220634460449, 0.22645722329616547, -0.3223951458930969, 0.06109637767076492, -0.3874532878398895, -1.0935862064361572, -0.9425125122070312, -0.9063661098480225, 0.3777872323989868, -0.4327300190925598, 0.20775675773620605, 1.668135166168213, 0.11644352972507477, -0.5907046794891357, 1.4256975650787354, -0.36115625500679016, -0.5916817784309387, 0.23469331860542297, 0.47511589527130127, -0.14896421134471893, 0.05705150589346886, -1.1016987562179565, 0.042437367141246796, 0.4872084856033325, -0.7967634797096252, -0.41173943877220154, -1.1797467470169067, -0.1327698826789856, -0.05942303687334061, -0.10854442417621613, -0.642846941947937, 1.1761395931243896, -0.29068881273269653, -0.7403733134269714, 0.45889073610305786, -0.22408728301525116, 0.05093475058674812, 0.734715461730957, 0.02522663027048111, -0.3635590672492981, 0.039130840450525284, -0.45896220207214355, 0.21498794853687286, 0.19342243671417236, -0.2929413318634033, 0.3937203586101532, 0.21664339303970337, -0.23558083176612854, 0.056257136166095734, -0.22934451699256897, 0.456951767206192, 0.0018165216315537691, -0.17697909474372864, 0.33965423703193665, 0.6705635786056519, -0.40722402930259705, 0.15068018436431885, -0.23415260016918182, -0.43973609805107117, 0.6939166784286499, 0.08452938497066498, 0.9013172388076782, -0.8262016177177429, -0.5637206435203552, 0.24064376950263977, 0.1267540007829666, -0.21964479982852936, 0.19014786183834076, 1.2319570779800415, -0.6125267744064331, 0.2517344653606415, -0.4460235834121704, -0.48625072836875916, -0.40383753180503845, -0.22280016541481018, -0.41627466678619385, -0.031824782490730286, 0.18408194184303284, 0.7819394469261169, -0.519934356212616, 0.24274224042892456, -0.02455510012805462, 0.5679397583007812, -1.110428810119629, 1.5669103860855103, -0.3476649522781372, 0.3115619421005249, 0.34092339873313904, -0.015163516625761986, 0.6643986105918884, -0.9854272603988647, 1.1860016584396362, -0.9644099473953247, -0.44908204674720764, 0.16995663940906525, -0.36217430233955383, 1.1542586088180542, -0.15111801028251648, -0.2155817449092865, 0.2179238349199295, -0.3427504897117615, -0.03980556130409241, 0.23346315324306488, 0.5216679573059082, -0.03592173010110855, 0.2395847886800766, 0.1901136040687561, -0.6239346265792847, -0.0010989428265020251, 0.1840263456106186, 0.7257686257362366, 0.2788475453853607, 0.22521725296974182, 0.7024490833282471, 0.2907915413379669, 0.09189055114984512, 0.5558720231056213, 0.9684187173843384, 0.4717027544975281, 0.10617171972990036, -0.7631540298461914, 0.05754667520523071, -0.5488836169242859, -0.34782713651657104, 0.19203035533428192, 0.7251638770103455, 0.6911389231681824, 0.4501917064189911, -1.5553510189056396, -0.7859604954719543, 0.16950605809688568, 0.39008525013923645, 1.649777889251709, -0.04556393250823021, -0.38793760538101196, -1.101464033126831, -0.8648049235343933, 0.25998204946517944, -0.44026800990104675, -0.3941565155982971, -0.15859755873680115, -0.2994650900363922, -1.7975906133651733, 0.3909510374069214, 0.2714075446128845, 1.0132458209991455, -0.45588716864585876, -0.49426037073135376, -0.42165830731391907, 0.50533127784729, -0.5333994626998901, -0.42965614795684814, 0.7786619663238525, -0.6117592453956604, -0.6196061968803406, 0.35230281949043274, -0.03169079124927521, 0.6112633347511292, -0.4329576790332794, 1.0794514417648315, 0.21329112350940704, -0.6500933766365051, -0.34788814187049866, 0.40132126212120056, 0.002692336682230234, -0.4886549115180969, 0.17807050049304962, 0.4740379750728607, 0.11278657615184784, 0.33343490958213806, -0.3242310583591461, -0.41484785079956055, 0.4192134141921997, -0.4330367147922516, 0.48176708817481995, 0.4667606055736542, 0.40885549783706665, 0.6365351676940918, -0.6559133529663086, 0.07191850244998932, -0.9896565675735474, 0.5325276851654053, -0.03187672793865204, -0.13223354518413544, 0.029021158814430237, -1.061416506767273, 0.04289327561855316, 0.785701334476471, -0.49929556250572205, -0.1642635464668274, -0.6231233477592468, -0.41272395849227905, -0.20624378323554993, -0.12807199358940125, -0.09060941636562347, 0.39350804686546326, -0.6186133623123169, 0.6989869475364685, 0.17884203791618347, 0.7375811338424683, -0.49957746267318726, 0.31736132502555847, -0.7579953074455261, 0.19039615988731384, -0.019698740914463997, -0.19273225963115692, -0.35518068075180054, 0.20765605568885803, -0.78068608045578, -0.29828599095344543, -0.3358110189437866, -0.42402172088623047, -0.45622825622558594, 0.3387375473976135, -0.238604336977005, -1.5549951791763306, -0.2991395592689514, -0.6324136257171631, -0.2529352307319641, 0.41040268540382385, 0.044609494507312775, 0.0014985117595642805, -0.8315631747245789, -1.311361312866211, 0.0544615276157856, -1.2435276508331299, -1.1262332201004028, 0.24011407792568207, 0.09852064400911331, -0.19297470152378082, -0.13239239156246185, -0.3922070860862732, -0.6647365093231201, 0.8617479205131531, -0.26478785276412964, 0.7624421715736389, 0.3170042634010315, 0.13554835319519043, 0.5805519223213196, -0.24062147736549377, 0.40675094723701477, -0.6210852861404419, 0.19003088772296906, -0.6002652049064636, -0.14030353724956512, -0.7252127528190613, -0.7675734758377075, 0.36886653304100037, -0.27639636397361755, 0.9476416110992432, -0.23653973639011383, -0.4699232578277588, 1.0243526697158813, 1.4508111476898193, -1.2463258504867554, 0.1304570883512497, -0.009989654645323753, 0.8125872015953064, -0.04238414019346237, -0.08319281786680222, 0.9037818908691406, -0.4458853006362915, 0.22893503308296204, 0.3152712881565094, -0.7475458383560181, -0.19005660712718964, -0.37805649638175964, 0.10696353018283844, 1.1756669282913208, 0.08063182234764099, 0.6661596298217773, -1.2583733797073364, 0.0017132802167907357, -1.0464097261428833, -0.6113832592964172, 0.5892806053161621, 0.7734597325325012, 0.6274468302726746, -0.6826478242874146, -0.1910647749900818, -0.46066269278526306, 0.3800356090068817, -0.08914312720298767, -0.9382351040840149, -0.5639448761940002, 0.03227517753839493, 0.5052435994148254, 0.5598846673965454, 0.5095756649971008, -0.31825530529022217, 0.1537783443927765, 15.026766777038574, 0.2898322641849518, -0.005332837346941233, 0.5097151398658752, 0.9983840584754944, 0.4082278311252594, -0.04562859237194061, 0.007088146638125181, -0.8507831692695618, 0.2732374370098114, 1.41213858127594, 0.3254848122596741, 0.49390795826911926, 0.6234344840049744, -0.012253859080374241, 0.09050140529870987, 0.15501391887664795, 0.5818967819213867, 0.08688022941350937, -1.6586722135543823, 0.140816792845726, 0.2796189486980438, 0.5154016613960266, 0.46863624453544617, 0.057971879839897156, 0.720667839050293, 0.16510552167892456, -0.4609670639038086, -0.15839749574661255, 0.2588667571544647, 1.378696084022522, -0.5820356011390686, 0.8795191049575806, 0.1530412882566452, -0.9259493947029114, 0.31675848364830017, -0.6546247005462646, -1.055376648902893, 0.060039784759283066, 0.6142638325691223, -1.299715518951416, -0.17363277077674866, 0.21224325895309448, 0.358105331659317, 0.2854151427745819, 0.15554720163345337, 0.3830137550830841, 0.7002142667770386, 0.29907312989234924, 0.05529075488448143, -0.10736294835805893, 0.23041102290153503, -0.3709169924259186, 0.14990532398223877, -0.5506108999252319, 0.43926572799682617, 0.6480119228363037, -0.07344608753919601, -0.8825288414955139, 0.04029903933405876, 0.3615504503250122, -0.015200292691588402, -0.415671706199646, 1.1731473207473755, 0.23005813360214233, 0.14703787863254547, -0.4793053865432739, 0.27090150117874146, 0.9202175736427307, 0.09253525733947754, -0.36687132716178894, -0.09989582747220993, 0.7633399963378906, 0.09899962693452835, -0.25494492053985596, 0.41474205255508423, -0.3076002299785614, -0.34528636932373047, -0.6834051609039307, -0.5979241728782654, 0.01522930059581995, -0.6242125630378723, -0.9051313996315002, 0.9421215653419495, -0.6146409511566162, -0.12798936665058136, 1.0879018306732178, -1.0658246278762817, 0.0020409596618264914, 0.6940021514892578, -0.6590973138809204, -0.04367401823401451, -0.21360228955745697, -0.7770867943763733, -0.7275265455245972, 0.20502568781375885, 1.3088949918746948, 0.34198665618896484, -0.15359336137771606, -0.3610818088054657, 0.4144652485847473, -0.2645893394947052, 0.10435700416564941, -0.8471288681030273, 1.2186882495880127, 0.2590468227863312, -1.0821619033813477, 0.4638995826244354, 0.2651236653327942, -0.14781798422336578, -1.091349482536316, -0.40146809816360474, 0.16626742482185364, -0.5814530849456787, -0.10596491396427155, -0.9207630157470703, -1.2379320859909058, -0.3154298961162567, 0.48981642723083496, 0.2541193664073944, 0.6780158877372742, -0.05775001645088196, -0.1862955540418625, -0.3206639885902405, -0.9606255888938904, -0.5058010220527649, 1.0052701234817505, -0.5859364867210388, -0.29567787051200867, 0.5651410818099976, 0.6231412291526794, -0.8355756402015686, -1.510199785232544, 0.25131478905677795, 0.13982853293418884, -0.5761714577674866, 0.872774064540863, -1.0773811340332031, 0.5351980924606323, 0.6084643602371216, -0.1696796417236328, -0.7911259531974792, 0.15793798863887787, -1.1575547456741333, -0.17245934903621674, -0.32224854826927185, 0.31541749835014343, -0.5102064609527588, 0.615084171295166, 0.6502087712287903, -0.08278412371873856, -1.1142836809158325, -0.4754982590675354, 0.3512062728404999, -0.18325860798358917, 0.48585647344589233, 0.3618422746658325, 0.02355772815644741, 0.036985378712415695, 0.05658388510346413, 0.5714851021766663, 0.7824671864509583, -0.2501014173030853, -0.2510388493537903, 0.45553696155548096, 0.03113551437854767, -0.44940027594566345, 0.2005748450756073, -0.3669561445713043, -1.1744120121002197, -0.3353370726108551, -1.1674995422363281, 0.11009413003921509, -0.5755839943885803, -0.01837255246937275, -0.002907414920628071, -0.17522963881492615, 0.20547030866146088, -0.12706255912780762, -0.07898473739624023, -0.9616202116012573, -0.31034672260284424, -0.488457053899765, 0.6037280559539795, 0.7325573563575745, -0.35757920145988464, 0.29107433557510376, -0.17907710373401642, 0.19108423590660095, -0.04907913878560066, 0.605482280254364, 0.02135298028588295, -0.36706605553627014, -0.7240033149719238, 0.1801973432302475, -0.30276715755462646, -0.26056450605392456, -1.0368149280548096, 0.4674675762653351, 0.386234849691391, 0.4569984972476959, -0.07348772883415222, -0.0782691165804863, -0.9047508239746094, 0.18232178688049316, 0.5948408842086792, -0.17211800813674927, 0.5866073369979858, 0.17795754969120026, -0.818977952003479, 0.1490386426448822, 1.0376302003860474, 0.23909683525562286, -0.937277615070343, -0.5542740225791931, 0.480912446975708, -0.4653013050556183, -0.15391814708709717, 0.1461476981639862, 0.13319897651672363, -1.2580548524856567, 0.5578007698059082, -0.5757873058319092, 0.3027058243751526, 0.392132431268692, 0.1247531995177269, 0.22614900767803192, -1.0492380857467651, 0.5008895397186279, 0.5726122856140137, -0.372293621301651, -0.2824997007846832, 0.6499052047729492, 0.7306696176528931, -0.8979446887969971, 0.09438937902450562, -0.2398487776517868, 0.19431309401988983, -0.96807461977005, 0.41165095567703247, 0.8160936832427979, -0.09532414376735687, -0.17630380392074585, 0.8905364871025085, -0.634248673915863, -1.1264673471450806, 0.05838446319103241, -0.5642675757408142, -0.046699509024620056, -0.6162809729576111, 0.857602596282959, 0.5865700244903564, 0.7560965418815613, -0.18880333006381989, -0.8593534827232361, -0.07498901337385178, 0.08330362290143967, 0.030842581763863564, 0.5685427784919739, -0.024302950128912926, -0.5664088129997253, 0.19988436996936798, 0.3616180121898651, -0.6118066906929016, -1.0792264938354492, -0.19802437722682953, -0.6283343434333801, -0.29426565766334534, 0.006787403952330351, -0.6614653468132019, -0.23749200999736786, 0.5619392991065979, 0.7765135765075684, 0.20609185099601746, 0.5563413500785828, -0.4186019003391266, -0.002759099006652832, 0.7180525064468384, 0.3684443235397339, -0.37719079852104187, -0.618150532245636, 0.8159723877906799, 0.6796997785568237, -0.984483003616333, 0.9401823282241821, -0.1502017378807068, -1.116855263710022, 1.1227394342422485, 0.8781583309173584, 0.2527065575122833, 0.8863370418548584, -0.27169325947761536, -0.058942023664712906, 0.0514465793967247, -1.0792646408081055, -0.1300276666879654, 0.5829328894615173, 0.6131455302238464, 0.7848720550537109, 0.1667422652244568, -0.10057584196329117, 0.6573557257652283, 0.34105008840560913, 0.07703626155853271, 0.3214417099952698, 0.946474015712738, -0.36011579632759094, 0.09657707065343857, 0.009124417789280415, 0.6517919301986694, -0.7829071283340454, -0.42196470499038696, -0.16242726147174835, 0.3510473966598511, 0.37645798921585083, 0.3985625207424164, 0.5500469207763672, -0.2792836129665375, 0.5840460658073425, 0.3408139944076538, 0.03648228570818901, -0.3103926181793213, -0.8031585812568665, -0.46167194843292236, -0.41310930252075195, -0.5210573077201843, -0.22540602087974548, 0.04579221457242966, -0.7971876263618469, -1.1510391235351562, 0.6790832877159119, 0.9328027963638306, 0.5553670525550842, 0.7939321398735046, 1.4087412357330322, 0.7276349067687988, 0.09323347359895706, -0.9503551125526428, -0.5637791156768799, -1.1381314992904663, 0.2543138265609741, -0.4388611316680908, -0.4352737367153168, -0.013291317969560623, -0.14176736772060394, -0.28317850828170776]}, "authors": [{"authorId": "2239252362", "name": "Feiwen Zhu"}, {"authorId": "2191900755", "name": "Arkadiusz Nowaczynski"}, {"authorId": "2297151773", "name": "Rundong Li"}, {"authorId": "2296994105", "name": "Jie Xin"}, {"authorId": "2297145128", "name": "Yifei Song"}, {"authorId": "2239205910", "name": "Michal Marcinkiewicz"}, {"authorId": "32842496", "name": "S. Eryilmaz"}, {"authorId": "2239497846", "name": "June Yang"}, {"authorId": "47304697", "name": "M. Andersch"}], "references": [{"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "315ae320de0d6b31c94d70999b23028b688c272d", "title": "FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours"}, {"paperId": "b7ee7b1e343097352088904719507f979e41c3ed", "title": "MLPerf HPC: A Holistic Benchmark Suite for Scientific Machine Learning on HPC Systems"}, {"paperId": "dc32a984b651256a8ec282be52310e6bd33d9815", "title": "Highly accurate protein structure prediction with AlphaFold"}, {"paperId": "661d142c23cb2a3207d5f1ba2ac7ff61f2d4fb2f", "title": "Triton: an intermediate language and compiler for tiled neural network computations"}, {"paperId": "09b9b2f1b98e5028c4c52dfe703e8f3d9d1007a6", "title": "Gradient Coding: Avoiding Stragglers in Distributed Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "942deb7d865b7782c03176d95e3a0d56cb71009e", "title": "Training Deep Nets with Sublinear Memory Cost"}, {"paperId": null, "title": "Accuratepredictionofproteinstructuresandinteractionsusingathree-trackneuralnetwork"}, {"paperId": null, "title": "2023. DS4Sci_EvoformerAttention: eliminating memory explosion problems for scaling Evoformer-centric structural biology models"}]}