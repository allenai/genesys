{"paperId": "80b6dc33cf1bac8d7fb19ec43b0ee216984605e0", "abstract": "In-context learning (ICL) refers to the ability of a model to condition on a few in-context demonstrations (input-output examples of the underlying task) to generate the answer for a new query input, without updating parameters. Despite the impressive ICL ability of LLMs, it has also been found that ICL in LLMs is sensitive to input demonstrations and limited to short context lengths. To understand the limitations and principles for successful ICL, we conduct an investigation with ICL linear regression of transformers. We characterize several Out-of-Distribution (OOD) cases for ICL inspired by realistic LLM ICL failures and compare transformers with DeepSet, a simple yet powerful architecture for ICL. Surprisingly, DeepSet outperforms transformers across a variety of distribution shifts, implying that preserving permutation invariance symmetry to input demonstrations is crucial for OOD ICL. The phenomenon specifies a fundamental requirement by ICL, which we termed as ICL invariance. Nevertheless, the positional encodings in LLMs will break ICL invariance. To this end, we further evaluate transformers with identical positional encodings and find preserving ICL invariance in transformers achieves state-of-the-art performance across various ICL distribution shifts", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "To understand the limitations and principles for successful ICL, an investigation with ICL linear regression of transformers is conducted and preserving ICL invariance in transformers achieves state-of-the-art performance across various ICL distribution shifts."}, "embedding": {"model": "specter_v2", "vector": [0.388556569814682, 0.05442723631858826, -0.5152314305305481, -0.41904306411743164, -0.18732912838459015, -0.7453100681304932, 0.6758458018302917, -0.19826236367225647, -0.44904154539108276, 0.14645221829414368, -0.06729069352149963, -0.008301624096930027, -0.03444993123412132, 0.2834206819534302, -0.6135075092315674, 0.04045548662543297, -0.9526491165161133, 0.40158185362815857, 0.4531014859676361, -0.1811905801296234, -0.029449889436364174, -0.4773513972759247, -1.0915987491607666, 0.49466681480407715, 0.175824373960495, 0.6253405809402466, 0.33095410466194153, 1.0182017087936401, -0.41955873370170593, 0.39616459608078003, 0.0632643923163414, -0.4063321352005005, 0.2810703217983246, 0.12501955032348633, -0.22983691096305847, -0.8579096794128418, 0.4633709192276001, -0.32397738099098206, -0.7639690637588501, 0.4365887939929962, -0.008467419072985649, 0.17507001757621765, 0.602664053440094, -0.8605131506919861, -0.37875989079475403, 0.4750663638114929, 1.0486886501312256, 0.5179315805435181, -0.09674076735973358, -0.6054092049598694, 1.8146097660064697, -1.4672411680221558, 0.3816312849521637, 1.455852746963501, 0.4384477436542511, 0.5479023456573486, -0.32750487327575684, -0.48329415917396545, 0.7027108669281006, 0.3454059064388275, -0.37953007221221924, -0.03243397921323776, -0.26757267117500305, 0.383088082075119, 1.6013612747192383, -0.2821331024169922, -0.08511544018983841, 0.6780502200126648, 0.01742720417678356, 1.6134103536605835, -0.07513061910867691, -0.6908240914344788, -0.007623051293194294, 0.0706542506814003, 0.10766035318374634, 0.5107999444007874, -0.11638833582401276, 0.2502051293849945, -1.0252150297164917, -0.03636300936341286, 0.5472150444984436, 0.20360855758190155, 0.11600937694311142, -0.4538639485836029, -0.21969746053218842, 0.37665385007858276, 0.7934869527816772, 0.8428067564964294, -0.16274665296077728, 1.2300130128860474, 0.3479764461517334, 0.7134883999824524, -0.47005200386047363, 0.6137204170227051, -0.45357251167297363, -0.060280099511146545, -0.15591652691364288, 0.2093019336462021, 0.2682422697544098, 0.7944669723510742, -0.12662242352962494, -0.150368332862854, -0.4490227997303009, 0.07676758617162704, 1.1164630651474, 0.07166244834661484, 0.5579209327697754, -0.6951853036880493, 0.3636085093021393, -0.40580815076828003, 0.30598026514053345, -0.3778662085533142, -0.07348234951496124, -0.4257363975048065, 0.1545010656118393, -1.3262015581130981, -0.2290298044681549, 0.4298001229763031, -0.4215589165687561, 0.9088655114173889, -0.41911089420318604, 0.1587049663066864, 0.06613162904977798, 0.30925360321998596, 0.2313554286956787, 0.47889959812164307, 0.20356588065624237, 0.2931884527206421, 0.039440855383872986, -0.661902904510498, -0.12008480727672577, -0.7835021018981934, 0.783372700214386, -0.14383497834205627, 0.7703820466995239, -0.27883532643318176, -0.8380805850028992, -1.2694838047027588, -1.083008885383606, 0.197884202003479, -0.7038382887840271, -0.086993508040905, 1.0664995908737183, 0.27804237604141235, -0.8455637693405151, 1.0478767156600952, -0.1826068013906479, 0.03503190726041794, 0.306216299533844, 0.8003441095352173, -0.014252654276788235, -0.8319124579429626, -1.1610180139541626, 0.06603594869375229, 0.31553009152412415, -0.5618886947631836, -0.688495934009552, -0.840880811214447, -1.2315424680709839, 0.1796274483203888, 0.5177071690559387, -0.5585120916366577, 1.4036778211593628, -0.28503385186195374, -0.8082564473152161, 0.14058683812618256, -0.2802991271018982, 0.2730386257171631, 0.3625134825706482, 0.03665729984641075, -0.5201650261878967, -0.6043807864189148, -0.1463574469089508, 0.8965031504631042, 0.3899123966693878, -0.41899019479751587, -0.3976873457431793, 0.07888954132795334, 0.20177429914474487, 0.04103096202015877, -0.08733206242322922, 0.13800451159477234, -0.15053850412368774, 0.040408264845609665, 0.5309398174285889, 0.4300699532032013, 0.4193042516708374, 0.19575686752796173, -0.12951704859733582, -1.4667763710021973, 0.9639067649841309, 0.6231355667114258, 0.7814549803733826, -0.9915574193000793, -0.8448675870895386, -0.26301637291908264, -0.2389448583126068, -0.22811317443847656, -0.9245608448982239, 0.7653301954269409, -0.3442116677761078, 0.3637169301509857, -0.29708343744277954, -1.0663700103759766, 0.32004305720329285, 0.1989622563123703, -0.5165930390357971, -0.3509919345378876, 0.2491980344057083, 1.2414911985397339, -1.273725152015686, 0.34431192278862, 0.15107591450214386, 0.029101064428687096, -1.140263319015503, 1.007525086402893, -0.7520093321800232, -0.006767173297703266, -0.07017048448324203, 0.040513064712285995, -0.2228357046842575, -0.3608071804046631, 0.5370056629180908, -0.3605731129646301, 0.2819945812225342, 0.7240728735923767, -0.3510954976081848, 1.6480728387832642, -0.6824431419372559, 0.5045228004455566, -0.5661779642105103, -0.7920944094657898, -0.10812811553478241, 0.22961919009685516, -0.04824679717421532, -0.36762240529060364, -0.15879575908184052, 0.5140474438667297, -0.0017237152205780149, -0.05443502962589264, 0.3472070097923279, 0.8576890826225281, -0.37699782848358154, 0.05109734088182449, 0.683313250541687, -0.42849352955818176, 0.3480430543422699, 0.07640083879232407, 0.7827415466308594, 0.7125063538551331, 0.4223198890686035, 0.12475672364234924, 0.3462727963924408, -1.0240219831466675, -0.15811945497989655, 0.9123661518096924, 0.6339173316955566, 0.6352607011795044, 0.40538644790649414, -0.8499016165733337, -0.04049612581729889, -0.34321531653404236, 0.48833662271499634, 1.5568534135818481, 0.15424637496471405, -0.5094471573829651, -0.46701735258102417, -0.9022685885429382, 0.12729118764400482, 0.44975996017456055, -0.7563728094100952, -0.1659325361251831, -0.4838327467441559, -0.832385778427124, 0.49490422010421753, 0.49008145928382874, 1.2044600248336792, -0.7402868866920471, 0.00555391376838088, 0.051460716873407364, 0.5172703266143799, -0.662054181098938, -0.548917293548584, 0.4452155530452728, -0.23283827304840088, -0.5625097751617432, 0.33479830622673035, -0.3374498188495636, 0.3257107436656952, -0.5881357192993164, 0.7201456427574158, -0.5348390340805054, -0.36690640449523926, 0.5615506172180176, 0.7172778844833374, -0.6646524667739868, -0.488136887550354, 0.3150216341018677, 0.019650060683488846, -0.21148017048835754, 0.39335083961486816, 0.25025230646133423, -0.2169862687587738, 0.5254880785942078, -0.5774903297424316, -0.2123682051897049, 0.31166934967041016, 0.28536319732666016, 0.6855205297470093, -0.178614541888237, 0.5413513779640198, -1.370379090309143, 0.8858725428581238, -0.05044496804475784, -0.25734949111938477, 0.3916126489639282, -0.8261471390724182, -0.29930949211120605, 0.8005282282829285, -0.8330860733985901, 0.05948217213153839, -0.8533862829208374, 0.4152265787124634, -0.2652772068977356, -0.32631227374076843, 0.13810081779956818, 0.23094213008880615, 0.27020952105522156, 0.49219292402267456, 0.5350261926651001, 0.2855180501937866, 0.14185236394405365, 0.42055556178092957, -1.0218091011047363, 0.3103034794330597, -0.2925628423690796, 0.1521492302417755, -0.3322955369949341, 0.042120832949876785, -0.43042904138565063, -0.2772883176803589, -0.3296824097633362, -0.10394967347383499, -0.011159559711813927, -0.1595866084098816, -0.31218358874320984, -1.1258493661880493, -0.19720306992530823, -0.5527945160865784, -0.5537027716636658, -0.005175624508410692, -0.4685306251049042, -0.19294637441635132, -1.3325798511505127, -0.6732142567634583, -0.35472920536994934, 0.18431887030601501, -1.1373027563095093, 0.4179486930370331, 0.034339021891355515, -0.450452595949173, -0.8001139163970947, -0.20989641547203064, -0.8370822668075562, 1.184023380279541, -0.6310594081878662, 0.8259912133216858, -0.15671148896217346, -0.6152809858322144, -0.4243820607662201, 0.3270794749259949, 0.43530938029289246, 0.4280853569507599, 0.11419954150915146, -1.2245986461639404, 0.1671895682811737, -0.34531188011169434, -0.49645549058914185, 0.019423266872763634, 0.0552443228662014, 1.1688621044158936, 0.1107243150472641, -0.6501719951629639, 0.10655060410499573, 1.3462976217269897, 0.0027470190543681383, 0.012874194420874119, -0.088313989341259, 0.7206000089645386, 0.44034162163734436, 0.03111245296895504, 0.11762022227048874, 0.19881634414196014, 0.33313530683517456, 0.15587876737117767, 0.5495690107345581, -0.09069723635911942, -1.0406376123428345, 0.548262357711792, 0.7689899802207947, 0.5896774530410767, 0.05215651914477348, -0.6952455043792725, 0.3462187945842743, -1.404395580291748, -0.5843656063079834, 1.124874234199524, 0.9598408937454224, 0.46633797883987427, -0.09297820925712585, -0.4943276643753052, -0.13386571407318115, -0.08964970707893372, 0.18229450285434723, -0.659829318523407, -0.11166994273662567, 0.22077831625938416, 0.4763847589492798, -0.14788158237934113, 0.746623694896698, -0.24966606497764587, 0.21135570108890533, 14.850838661193848, 0.818486213684082, -0.09172718971967697, 0.3539954125881195, 0.5376690626144409, 0.4873685836791992, -0.621772289276123, -0.10989399999380112, -1.087739109992981, 0.23794370889663696, 0.862169086933136, 0.5234092473983765, 0.6126708984375, 0.30407649278640747, -0.5101473331451416, 0.13554033637046814, -1.4176450967788696, 0.7109804749488831, 0.48764756321907043, -1.229843020439148, 0.32138141989707947, -0.06468480080366135, 0.3622249364852905, 0.30545952916145325, 1.0113734006881714, 0.9077281355857849, 0.34685179591178894, -0.5474395751953125, 0.2843453884124756, 0.1767837405204773, 1.3258634805679321, 0.21817588806152344, 0.3004567623138428, 0.3903455138206482, -0.8219879865646362, -0.4829236567020416, -0.6315133571624756, -0.8418806195259094, -0.4732389748096466, -0.4190749526023865, -1.2300180196762085, -0.4605153501033783, -0.20434612035751343, 0.9506703615188599, 0.029980730265378952, 0.2519010007381439, -0.6588404178619385, 0.625961184501648, -0.05949193984270096, -0.3064456880092621, -0.05725007504224777, 0.8027018904685974, -0.03025245852768421, -0.1566208153963089, -0.03339165449142456, -0.39833763241767883, 0.10822524130344391, 0.4570549726486206, -0.5936142802238464, -0.17210395634174347, -0.4133151173591614, 0.04417923465371132, 0.13533909618854523, 0.5133018493652344, 0.7032251954078674, 0.42854782938957214, -0.2825278639793396, 0.30112123489379883, 0.5305695533752441, 0.402675598859787, -0.15129408240318298, 0.16794562339782715, 0.46696561574935913, -0.5583418011665344, -0.016320032998919487, 0.6922131776809692, -0.08482341468334198, -0.26875633001327515, -0.41358456015586853, -0.11656081676483154, 0.33819547295570374, -0.7942838668823242, -0.9805692434310913, 0.4939429759979248, -0.014931564219295979, -0.5815210342407227, 0.2219584584236145, -0.969985842704773, -0.39328598976135254, 0.13048218190670013, -1.5652179718017578, -0.5263552069664001, -0.007229140494018793, -0.33053961396217346, 0.055697452276945114, -0.273862361907959, 1.442732334136963, 0.265251100063324, -0.24011829495429993, 0.19986620545387268, 0.07172141224145889, -0.5317333340644836, 0.3712853789329529, -1.6001691818237305, 0.8740897178649902, -0.10169170796871185, 0.07034866511821747, 0.6366414427757263, -0.29129382967948914, 0.3918543756008148, -0.47379767894744873, 0.06589774787425995, 0.4343356788158417, -1.3811289072036743, -0.5185558795928955, -0.7283793687820435, -0.5056555867195129, 0.6048024296760559, 0.16670231521129608, -0.1944148987531662, 0.6518120169639587, -0.1581960767507553, -0.6494671702384949, -0.6887320876121521, -0.7923782467842102, 0.3512204587459564, 0.8517528176307678, -0.5222516059875488, -0.34148889780044556, -0.1852126121520996, 0.526846706867218, -0.9688356518745422, -0.31843817234039307, -0.08788911998271942, 0.2541670501232147, 0.0068730320781469345, 1.1172564029693604, -0.7872626781463623, 0.8594849109649658, 0.29467278718948364, -0.4428040683269501, -0.9237663745880127, 0.07462859898805618, -0.8933411240577698, 0.2177552729845047, -0.3455902934074402, 0.9790773987770081, -1.056682825088501, 0.20229414105415344, 0.677803099155426, -0.006291580386459827, -0.5653544664382935, -0.49040740728378296, -0.2195543646812439, -0.18732064962387085, -0.3839002847671509, 0.42449477314949036, -0.03758144751191139, -0.4322633147239685, 0.2112981528043747, 1.0090806484222412, 0.49977195262908936, -0.5958099961280823, -0.5937828421592712, 0.6174915432929993, -0.04137110337615013, -0.6838635802268982, -0.3733304738998413, -0.4921308159828186, -1.5630649328231812, -0.18450672924518585, -1.482622742652893, -0.04699093848466873, -0.819543182849884, -0.7383416295051575, -0.37513646483421326, -0.5725580453872681, 0.06931237131357193, 0.2723688781261444, -0.7355451583862305, -0.4898489713668823, -0.3758418560028076, -0.5877066850662231, 0.40733927488327026, 1.01885187625885, -0.6079922318458557, 0.3275940418243408, 0.4547111392021179, -0.10013839602470398, -0.21198689937591553, 0.4245520234107971, -0.47948136925697327, -1.3547067642211914, -0.9855471253395081, 0.47007861733436584, -0.5498443245887756, -0.20986801385879517, -0.508400559425354, 0.6408078670501709, 0.43524986505508423, 0.3037026822566986, 0.12211921811103821, 0.6346733570098877, -1.4299370050430298, -0.5089219212532043, 0.5750885605812073, -1.104931354522705, 0.31194502115249634, 0.0875587910413742, -0.13895118236541748, -0.2752554714679718, 0.26533243060112, -0.2606342136859894, -0.8039634823799133, -0.9013314843177795, 0.27799659967422485, -0.10257788002490997, 0.05473805591464043, -0.2204495668411255, 0.045718640089035034, -1.2866765260696411, -0.3386949300765991, -0.09424073994159698, 0.44545644521713257, -0.45196986198425293, 0.7851652503013611, 0.4935606122016907, -1.052592396736145, 0.427799791097641, 0.5630238652229309, 0.21684713661670685, 0.40816807746887207, 0.2655470371246338, 0.18309785425662994, -0.5712268352508545, 0.3548019528388977, 0.19500096142292023, 0.04960662126541138, -0.5370922684669495, -0.00413564033806324, 1.0035580396652222, -0.445828914642334, 0.3306922912597656, 1.0559288263320923, 0.06834472715854645, -1.5139877796173096, 0.32789885997772217, -1.3509019613265991, -0.19466149806976318, -0.6080666184425354, 0.4946041405200958, 0.0541837252676487, -0.12937891483306885, 0.8027347326278687, -0.40256747603416443, 0.01017096359282732, -0.2007995992898941, -0.2476019710302353, 0.40297937393188477, 0.27285242080688477, -0.215414896607399, 0.7002055644989014, 1.0069618225097656, -0.6205693483352661, -0.8585593700408936, -0.6743484735488892, -0.3385046720504761, -0.40191441774368286, -0.5779403448104858, -0.7537668943405151, -0.1388072371482849, 0.6646451354026794, 0.2005126178264618, 0.2775115966796875, -0.3108992278575897, -0.10378296673297882, -0.3124729096889496, 1.0489327907562256, 0.04963518679141998, -0.10486255586147308, 0.13307970762252808, 0.8478752970695496, 1.5120171308517456, -1.1532683372497559, -0.010857154615223408, -0.41714906692504883, -0.2869499623775482, 1.1986274719238281, 0.8629108667373657, -0.24466076493263245, 0.949639618396759, -0.4973308742046356, -0.16355489194393158, 0.21702316403388977, -1.1313550472259521, 0.29711610078811646, 0.9725759029388428, 1.2300361394882202, 0.5675800442695618, 0.40146249532699585, 0.47662538290023804, 0.661958634853363, -0.06888115406036377, -0.15066958963871002, 0.2949219048023224, 0.5363690257072449, -0.050079818814992905, -0.37674573063850403, 0.5306477546691895, 0.6479271650314331, -0.2922387421131134, -0.3383362591266632, 0.04200153425335884, 0.9567170143127441, 0.22477294504642487, 0.27836933732032776, 0.7062255144119263, 0.226863294839859, 0.7458221912384033, 0.48714545369148254, 0.7870275974273682, -0.85478675365448, -0.12791506946086884, -0.6882053017616272, -0.775594174861908, -0.12565423548221588, -0.1985405534505844, -0.5290610790252686, -0.5261908769607544, 0.33226796984672546, 0.3586491048336029, -0.21892602741718292, 0.39776650071144104, 0.7872265577316284, 0.5723599195480347, 0.6322829723358154, -0.07724063098430634, -0.24034783244132996, -0.7017244100570679, -0.8338530659675598, 0.6841223239898682, -0.467305988073349, -0.06818564981222153, -0.3555525243282318, -0.33039072155952454, -0.6089728474617004]}, "authors": [{"authorId": "2108962670", "name": "Yongqiang Chen"}, {"authorId": "2051756680", "name": "Binghui Xie"}, {"authorId": "2075360362", "name": "Kaiwen Zhou"}, {"authorId": "2257285009", "name": "Bo Han"}, {"authorId": "2264279118", "name": "Yatao Bian"}, {"authorId": "2257380794", "name": "James Cheng"}], "references": [{"paperId": "28a7ced384549eaae74ea9ad3ee21189a0625afe", "title": "Mitigating Label Biases for In-context Learning"}, {"paperId": "f32fb177deec417b825eb7b2b64fdf08357ecede", "title": "A Closer Look at In-Context Learning under Distribution Shifts"}, {"paperId": "8f936af93fb2b52b9678ff8f17c1ebe8de236a88", "title": "Large Language Models Can be Lazy Learners: Analyze Shortcuts in In-Context Learning"}, {"paperId": "dd889342b0de45f7434cdfa7543e3bd46ec824cb", "title": "Measuring Inductive Biases of In-Context Learning with Underspecified Demonstrations"}, {"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "5c7353fac22a8fdc43fc2f5c006b5d6902c47e75", "title": "On the Robustness of ChatGPT: An Adversarial and Out-of-distribution Perspective"}, {"paperId": "3d68522abfadfc8ee6b7ec9edaaf91f1b2f38e5e", "title": "Large Language Models Can Be Easily Distracted by Irrelevant Context"}, {"paperId": "95915aa592fdfc73f039c13472a21d3e4220f129", "title": "On the Compositional Generalization Gap of In-Context Learning"}, {"paperId": "cdbd4f9b6ab2e2fd1ddf5400d5ed2c18960635d1", "title": "Scaling Instruction-Finetuned Language Models"}, {"paperId": "de32da8f5c6a50a6c311e9357ba16aa7d05a1bc9", "title": "What Can Transformers Learn In-Context? A Case Study of Simple Function Classes"}, {"paperId": "f843233f76a5dff07bfa93a71a1cf13d8aa6a94a", "title": "Exploring Length Generalization in Large Language Models"}, {"paperId": "316206a2f89eb94ce02a81fba1dc304586f21b39", "title": "Ground-Truth Labels Matter: A Deeper Look into Input-Label Demonstrations"}, {"paperId": "26218bdcc3945c7edae7aa2adbfba4cd820a2df3", "title": "Flamingo: a Visual Language Model for Few-Shot Learning"}, {"paperId": "a2fc77f075f666b462d9350e7576f0ba9845c61b", "title": "Transformer Language Models without Positional Encodings Still Learn Positional Information"}, {"paperId": "6f870f7f02a8c59c3e23f407f3ef00dd1dcf8fc4", "title": "Learning Transferable Visual Models From Natural Language Supervision"}, {"paperId": "56fa0b9cba4d9aee5ccc327365b3b3a721031c69", "title": "Calibrate Before Use: Improving Few-Shot Performance of Language Models"}, {"paperId": "59641c10ed7431a3cf841f308367dc2dc0281b74", "title": "What Makes Good In-Context Examples for GPT-3?"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "a456265138c088a894301c0433dae938705a9bec", "title": "Deep Sets"}, {"paperId": "fc05299c68af1dc42a24ad08533268fbb67dd4db", "title": "Discovering Causal Signals in Images"}, {"paperId": "8de174ab5419b9d3127695405efd079808e956e8", "title": "Curriculum learning"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}]}