{"paperId": "1c8f9fd695aba1fa06d77619540f8277e91fca1a", "abstract": "In Transformer-based architectures, the attention mechanism is inherently permutation-invariant with respect to the input sequence's tokens. To impose sequential order, token positions are typically encoded using a scheme with either fixed or learnable parameters. We introduce Hyperbolic Positional Encoding (HyPE), a novel method that utilizes hyperbolic functions' properties to encode tokens' relative positions. This approach biases the attention mechanism without the necessity of storing the $O(L^2)$ values of the mask, with $L$ being the length of the input sequence. HyPE leverages preliminary concatenation operations and matrix multiplications, facilitating the encoding of relative distances indirectly incorporating biases into the softmax computation. This design ensures compatibility with FlashAttention-2 and supports the gradient backpropagation for any potential learnable parameters within the encoding. We analytically demonstrate that, by careful hyperparameter selection, HyPE can approximate the attention bias of ALiBi, thereby offering promising generalization capabilities for contexts extending beyond the lengths encountered during pretraining. The experimental evaluation of HyPE is proposed as a direction for future research.", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Hyperbolic Positional Encoding (HyPE), a novel method that utilizes hyperbolic functions' properties to encode tokens' relative positions, is introduced, offering promising generalization capabilities for contexts extending beyond the lengths encountered during pretraining."}, "embedding": {"model": "specter_v2", "vector": [0.4594983160495758, 0.9221236705780029, -0.5672402381896973, -0.25792810320854187, -0.37993890047073364, -0.14874905347824097, 0.5380843281745911, -0.24532175064086914, -0.5834669470787048, -0.3903758227825165, 0.7132824063301086, 0.15234936773777008, -0.13699500262737274, -0.09534268081188202, -0.21112237870693207, -0.46580925583839417, -1.0170434713363647, 0.3604992628097534, 0.33310768008232117, -0.2002401053905487, 0.39826565980911255, -0.6770787239074707, -0.9765515327453613, 0.46411341428756714, -0.3179455101490021, 0.9388303756713867, 0.46841010451316833, 0.9055582284927368, -0.43729373812675476, 0.5116590261459351, 0.18714550137519836, -0.3841775059700012, 0.41442298889160156, -0.0714430958032608, -0.6068587303161621, -0.5827776789665222, 0.39462339878082275, -0.22705231606960297, -0.9861000180244446, 0.7118582725524902, -0.1693190634250641, 0.2724105715751648, 0.3104749023914337, -0.5924456119537354, -0.37991341948509216, 1.382248878479004, 0.7299743294715881, 0.9467571377754211, -0.5158851146697998, -0.817402720451355, 1.5178215503692627, -1.2890658378601074, -0.09411709010601044, 1.2495992183685303, 0.7401322722434998, 0.11709750443696976, 0.22617116570472717, -0.14767348766326904, 0.6623652577400208, 0.5559693574905396, -0.7355250716209412, -0.22240230441093445, 0.33016207814216614, 0.0032682842575013638, 1.2810462713241577, -0.013113563880324364, 0.18894988298416138, 0.47114646434783936, -0.2539052367210388, 1.6039280891418457, 0.16393694281578064, -0.8701289296150208, -0.41090142726898193, 0.2936862111091614, 0.6558710336685181, 0.6631279587745667, -0.5446908473968506, 0.43193164467811584, -1.0189012289047241, 0.3133460581302643, 0.27000442147254944, -0.13522997498512268, 0.2294968217611313, -0.02806202881038189, -0.18699024617671967, 0.36602967977523804, 0.8767801523208618, 0.7530642747879028, -0.5880388021469116, 1.023138403892517, 0.19792751967906952, 0.03024059161543846, -0.32375359535217285, 0.315349280834198, 0.3469157814979553, 0.12160205841064453, -0.7449410557746887, -0.036059487611055374, -0.5050408840179443, 0.9364914894104004, -0.1600767821073532, 0.511529803276062, -0.8293325304985046, 0.10247696191072464, 1.4516067504882812, -0.1619650423526764, 0.4516582787036896, -0.6543917059898376, 0.16080090403556824, -0.926462709903717, 0.19557252526283264, -1.0090404748916626, 0.14292357861995697, -0.5145335793495178, -0.3073963522911072, -1.188753604888916, -0.37087684869766235, 0.6073867678642273, -0.8178311586380005, 0.7611376047134399, -0.5909597277641296, 0.17188431322574615, -0.11410682648420334, 0.3760529160499573, 0.4115622341632843, 0.7111925482749939, -0.024874160066246986, 0.41498762369155884, 0.9810600280761719, -0.7864430546760559, -0.6270561218261719, -1.0596755743026733, 0.23556353151798248, -0.1850133240222931, 0.22849571704864502, -0.24958768486976624, -1.3338258266448975, -0.9669408798217773, -0.9594410061836243, 0.09315799921751022, -0.9080352783203125, 0.010999755933880806, 0.7250246405601501, 0.3784845769405365, -1.183205008506775, 0.8942585587501526, -0.3932042717933655, 0.23655526340007782, 0.8655629754066467, 0.3541855216026306, 0.6228652596473694, 0.07588033378124237, -1.5285606384277344, 0.34347003698349, 0.7206112742424011, -0.17790648341178894, 0.31285858154296875, -0.9108293652534485, -1.00022292137146, 0.15384334325790405, 0.07030686736106873, -0.11257057636976242, 1.177117943763733, 0.1345098316669464, -1.194387674331665, 0.6486475467681885, -0.11632426828145981, 0.08113133162260056, 0.2469216138124466, -0.06796620786190033, -0.12653683125972748, -0.3146663308143616, -0.4546184837818146, 0.8721033334732056, 0.2617160975933075, -0.33145880699157715, -0.43080952763557434, 0.12493930757045746, -0.40177106857299805, 0.04889440909028053, -0.6917094588279724, 0.7850483059883118, -0.3248332440853119, -0.45808762311935425, 0.6591207981109619, 0.5003959536552429, 0.22165007889270782, -0.43908822536468506, -0.41133666038513184, -0.8368584513664246, 0.7207094430923462, 0.172010600566864, 1.1738158464431763, -0.8731048107147217, -0.7846456170082092, 0.06945786625146866, -0.270471453666687, -0.04467606171965599, -0.5310627222061157, 0.269276887178421, -0.373922735452652, 0.21615244448184967, 0.07830481976270676, -0.7439819574356079, 0.26660725474357605, -0.10986805707216263, -0.49664005637168884, -0.16287517547607422, -0.21993429958820343, 1.245100736618042, -1.0479141473770142, -0.11593861877918243, 0.11609776318073273, 0.24177302420139313, -0.8572193384170532, 1.207476258277893, 0.17086796462535858, -0.21434934437274933, 0.13168014585971832, -0.43087121844291687, 0.04841906577348709, -0.198322132229805, 0.2729087471961975, -0.46830660104751587, -0.1269877701997757, 1.1687707901000977, -0.43954744935035706, 1.0007368326187134, -0.0752205178141594, 0.8574070930480957, -0.357859343290329, -0.7650641798973083, 0.30305278301239014, 0.2144889533519745, 0.01734960824251175, -0.6334408521652222, 0.5449484586715698, 0.208657905459404, -0.5236013531684875, 0.2710304260253906, 1.0111466646194458, 0.9475789070129395, -0.4082862138748169, -0.15675967931747437, 0.3593999743461609, 0.03026920184493065, 0.11294250935316086, 0.24266131222248077, 0.3746459186077118, 0.3982076942920685, 0.25530052185058594, -0.2847353518009186, -0.1029583141207695, -1.0072823762893677, -0.015462876297533512, 0.7883887887001038, 0.4916580021381378, 1.0055160522460938, 0.28037333488464355, -0.8526449203491211, -0.349867582321167, -0.1462375968694687, 0.31311702728271484, 1.3046295642852783, 0.0964534804224968, -0.11330802738666534, -0.6304006576538086, -0.13460515439510345, -0.33721521496772766, -0.05312500149011612, -0.6457880735397339, -0.5579423904418945, -0.8255296945571899, -1.1608608961105347, 0.8730402588844299, 0.8469271659851074, 0.9213204979896545, -0.780794084072113, -0.6523364782333374, -0.35278576612472534, 0.2683940529823303, -0.5538749694824219, -0.8486782908439636, 0.6468343734741211, -0.11301679164171219, 0.048608098179101944, 0.21159735321998596, -0.33413439989089966, 0.06966056674718857, -0.6669514179229736, 0.6885472536087036, -0.7865124940872192, -0.21653999388217926, -0.16718065738677979, 0.5592243075370789, -0.5809860229492188, -0.5422853231430054, 0.3972398340702057, -0.07740321755409241, 0.10505422949790955, 0.26501184701919556, 0.36169445514678955, -0.43891826272010803, 0.21906839311122894, -0.08344659209251404, 0.05352294072508812, 0.2903915047645569, 0.09977356344461441, 0.699436604976654, -0.4852147102355957, 0.020677627995610237, -1.0416980981826782, 0.38504114747047424, 0.4468167722225189, -0.3643607497215271, -0.09427184611558914, -0.5618686676025391, -0.34492775797843933, 0.2963998019695282, -0.3558697998523712, -0.07822371274232864, -0.9978457093238831, 0.0128024248406291, -0.43108049035072327, -0.3077371418476105, 0.0947142168879509, 0.10809315741062164, 0.16175678372383118, 0.18132780492305756, 0.5055039525032043, -0.017314516007900238, 0.04732917994260788, 0.5603763461112976, -0.4386325478553772, 0.9041346907615662, 0.45387130975723267, -0.1366768479347229, -0.40173250436782837, -0.11152349412441254, -0.7166211009025574, -0.4914107322692871, -0.4396795630455017, -0.32583922147750854, -0.324480801820755, 0.1322866827249527, 0.10492296516895294, -1.2160178422927856, 0.145621657371521, -0.7207773923873901, -0.43592900037765503, -0.2362145632505417, -0.1841464787721634, -0.3522725999355316, -1.309562087059021, -1.2866703271865845, -0.603946328163147, -0.5082879066467285, -0.9310562014579773, -0.10498510301113129, 0.08059143275022507, -0.5283646583557129, -0.640480637550354, -0.2518245577812195, -0.32455337047576904, 1.2350363731384277, -0.7138513922691345, 0.6895772218704224, -0.23923242092132568, -0.3766016960144043, -0.45128142833709717, 0.42024537920951843, 0.43981197476387024, 0.04354478418827057, 0.30677688121795654, -0.8121467232704163, 0.4615524709224701, -0.327743262052536, 0.004805154167115688, 0.07619550824165344, 0.46785590052604675, 1.094756007194519, -0.49504345655441284, -0.4325605034828186, 0.4430539906024933, 1.1579296588897705, -0.09826832264661789, 0.4877488911151886, 0.37353259325027466, 0.9676375985145569, 0.4259257912635803, -0.0896812304854393, 0.5082037448883057, 0.34560757875442505, 0.7496961355209351, 0.45231831073760986, 0.030362704768776894, -0.4478583335876465, -0.5686308145523071, -0.059477098286151886, 1.474152684211731, 0.3400101065635681, -0.1544981747865677, -0.9927328824996948, 0.8922533988952637, -0.93522047996521, -1.3157379627227783, 0.7898935079574585, 0.9698166251182556, 0.22543470561504364, -0.27139967679977417, -0.24010153114795685, 0.27028313279151917, 0.7484647631645203, 0.7559324502944946, 0.24212941527366638, -0.44691282510757446, 0.12248300760984421, 0.42912057042121887, 0.2693154513835907, 0.9744042754173279, -0.5571724772453308, 0.6796224117279053, 15.099843978881836, 0.5236831307411194, -0.19721773266792297, 0.27620646357536316, 0.7282353043556213, 0.1974463313817978, -0.2868969142436981, -0.36258941888809204, -1.2246787548065186, 0.6391719579696655, 1.0550801753997803, 0.5804618000984192, 0.3087712526321411, 0.10478383302688599, -0.16639508306980133, 0.529523491859436, -0.487700879573822, 0.6731434464454651, 0.48590514063835144, -1.3926688432693481, -0.04482901096343994, 0.085891954600811, 0.06023368611931801, 0.25565361976623535, 1.2796180248260498, 0.3803601562976837, 0.37716761231422424, -0.43104419112205505, 1.0819100141525269, 0.18265564739704132, 0.47481077909469604, -0.2702881097793579, 0.3241907060146332, -0.11097466945648193, -1.040895938873291, -0.24098645150661469, -0.4685947299003601, -0.797152042388916, 0.1816963404417038, -0.02741897478699684, -0.7473044395446777, -0.5411423444747925, 0.04253069683909416, 0.686674952507019, 0.3012756407260895, 0.5065269470214844, -0.28282204270362854, 0.6708205342292786, 0.07024436444044113, -0.16130240261554718, 0.7238337397575378, 0.5217448472976685, 0.09489032626152039, 0.13932956755161285, 0.019561471417546272, 0.10579092800617218, -0.08160993456840515, 0.4712091386318207, -0.33997243642807007, -0.4024997353553772, -0.2958180010318756, -0.13323934376239777, 0.47931864857673645, 0.7766678333282471, 0.3528200089931488, 0.2626345157623291, 0.07887725532054901, 0.18720382452011108, 0.38706740736961365, 0.009086137637495995, -0.6269691586494446, -0.6242512464523315, 0.5624260902404785, -0.42524340748786926, 0.2421702742576599, 0.8683501482009888, -0.4461442828178406, 0.29764747619628906, -0.8650175333023071, 0.05092102289199829, 0.32342758774757385, -0.8148631453514099, -0.13027413189411163, 1.1725865602493286, -0.06388406455516815, -0.23046424984931946, 0.39197462797164917, -0.8642207980155945, -0.01690511219203472, 0.15152111649513245, -1.2117698192596436, -0.4068686068058014, -0.16699565947055817, -0.43773314356803894, -0.5544075965881348, 0.16959145665168762, 0.8153759241104126, 0.23544980585575104, -0.1424700766801834, 0.5669654011726379, -0.1355908215045929, 0.12611627578735352, -0.2993459701538086, -1.06870698928833, 0.5845447778701782, 0.10406549274921417, 0.04912776127457619, 0.13560204207897186, -0.006838747765868902, 0.763287365436554, -0.3367210626602173, -0.06440860778093338, 0.7116663455963135, -0.8498033881187439, -0.47331443428993225, -0.6697466969490051, -0.8521004915237427, 0.682904064655304, 0.579418420791626, 0.010245614685118198, 0.38689881563186646, -0.09681332111358643, -0.4977654814720154, -0.4474218785762787, -0.4435778558254242, -0.17950648069381714, 0.5437119007110596, -0.6920352578163147, -0.7834686636924744, -0.3503507971763611, 0.12276366353034973, -1.154794692993164, -0.5268476009368896, -0.16839012503623962, 0.16361162066459656, -0.24250264465808868, 1.390755295753479, -0.642573893070221, 0.5596412420272827, 0.8918731212615967, -0.28110843896865845, -0.8373588919639587, -0.6372418999671936, -0.7420132160186768, 0.10521968454122543, 0.189761221408844, 0.5617006421089172, -0.5435150265693665, 0.6755517721176147, 0.28605690598487854, -0.440956711769104, -0.49060142040252686, -0.5168680548667908, -0.18077963590621948, -0.10649440437555313, -0.3300185203552246, 0.37634214758872986, 0.05112764239311218, 0.12764258682727814, -0.2279297411441803, 0.42449286580085754, 0.6346626281738281, -0.3927164077758789, -0.5897444486618042, -0.36339056491851807, 0.14538154006004333, 0.0013029311085119843, -1.011561393737793, -0.9928423762321472, -1.5609866380691528, -0.25069665908813477, -1.2402372360229492, 0.551080048084259, -0.861897885799408, -0.5210509896278381, -0.2805529534816742, -0.9698203206062317, 0.3758833110332489, 0.053888946771621704, -0.05573451519012451, -0.6176336407661438, -0.6434704065322876, -0.49893394112586975, 0.6214696168899536, 0.41497504711151123, -0.5824888348579407, 0.1513734757900238, 0.12190619111061096, -0.03898141160607338, 0.12694858014583588, 0.5533977746963501, -0.5933438539505005, -0.751087486743927, -1.3546828031539917, 0.22886201739311218, -0.2873173952102661, -0.22968333959579468, -0.7810652852058411, 0.9398940801620483, 0.461783766746521, -0.41059741377830505, -0.16602253913879395, 0.7169229388237, -0.903250515460968, -0.45379361510276794, 0.5122477412223816, -1.0617817640304565, 0.2675189673900604, -0.1413964033126831, -0.6840099096298218, -0.25142380595207214, 0.4746723175048828, 0.24839992821216583, -0.7990595698356628, -0.6323714256286621, 0.5175226330757141, -0.6756727695465088, 0.1665409356355667, -0.15438228845596313, -0.5501143336296082, -1.2748430967330933, -0.15203140676021576, -0.005167336203157902, 0.004856704734265804, -0.6551840901374817, 0.8801794052124023, 0.5553255081176758, -1.328751802444458, 0.29104098677635193, 0.45531150698661804, -0.13759417831897736, -0.20606257021427155, 0.19429850578308105, 0.6171586513519287, -0.5305314660072327, 0.7645416855812073, -0.048941366374492645, 0.1764092892408371, -0.9284268617630005, -0.09484657645225525, 0.8834816813468933, -0.015192306600511074, -0.046661246567964554, 1.4518163204193115, -0.4950767159461975, -0.8938953876495361, 0.5781686902046204, -1.0467931032180786, -0.4684394896030426, -0.0048451730981469154, 0.6365589499473572, 0.5232110023498535, -0.012101217173039913, -0.1675185263156891, -0.6406258940696716, 0.13923104107379913, -0.10677382349967957, -0.46519821882247925, 0.3368566632270813, 0.15205813944339752, -0.15986908972263336, 0.4598355293273926, 0.820955216884613, -0.8546668887138367, -0.8288953304290771, -0.7424271702766418, -0.25908559560775757, -0.5564945340156555, 0.2792946696281433, -0.15784941613674164, -1.0624560117721558, 0.9659536480903625, 0.5453423261642456, 0.32791996002197266, -0.09275756031274796, -0.01123895589262247, -0.18818673491477966, 0.41796454787254333, -0.05735453963279724, -0.39940643310546875, -0.0793745368719101, 1.1816117763519287, 0.9698709845542908, -0.35722386837005615, -0.21508614718914032, -0.37065356969833374, -0.2710798978805542, 0.5297462344169617, 0.3190126121044159, 0.08184893429279327, 0.7391403317451477, 0.07800222933292389, 0.20752927660942078, 0.27088233828544617, -0.5501814484596252, 0.07148802280426025, 0.6788361072540283, 1.1035361289978027, 0.607462465763092, 0.2812170386314392, 0.3436846137046814, 0.8197274804115295, -0.26515305042266846, -0.5478606224060059, 0.20746086537837982, 0.7771589756011963, -0.4393594563007355, -0.04931997135281563, 0.0968097522854805, 0.33136430382728577, -0.755687952041626, -0.5691832900047302, 0.10309438407421112, 0.5935776233673096, 0.051376789808273315, 0.42345625162124634, 1.1778788566589355, -0.1213684007525444, 0.5603837966918945, 0.14264027774333954, 0.6573711633682251, -0.20424968004226685, -0.39499232172966003, -0.5189451575279236, -0.7728265523910522, -0.08388373255729675, 0.04272601008415222, -0.502918004989624, -0.3773588538169861, -0.23990057408809662, 0.3559667468070984, 0.2445269227027893, 0.21730506420135498, 0.7592740654945374, 0.5549364686012268, 0.9089238047599792, -0.1079975813627243, -0.5978657007217407, -0.3750505745410919, -0.8741054534912109, 0.23007845878601074, -0.34954264760017395, -0.2240782380104065, -0.1228410005569458, 0.047647830098867416, -0.3188554048538208]}, "authors": [{"authorId": "2264234723", "name": "Giorgio Angelotti"}], "references": [{"paperId": "823ca4778e1027f2f0b356df051d762dcecaaba0", "title": "FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning"}, {"paperId": "5a9cb1b3dc4655218b3deeaf4a2417a9a8cd0891", "title": "DINOv2: Learning Robust Visual Features without Supervision"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "f864d4d2267abba15eb43db54f58286aef78292b", "title": "Offline Reinforcement Learning as One Big Sequence Modeling Problem"}, {"paperId": "c1ad5f9b32d80f1c65d67894e5b8c2fdf0ae4500", "title": "Decision Transformer: Reinforcement Learning via Sequence Modeling"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "84476fdf6ead3553f4493dff8e02308439d6222b", "title": "Improve Transformer Models with Better Relative Position Embeddings"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "foundation language models"}, {"paperId": null, "title": "Falcon-40b: an open large language model with state-of-the-art performance"}]}