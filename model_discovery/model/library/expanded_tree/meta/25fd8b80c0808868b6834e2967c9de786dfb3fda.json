{"paperId": "25fd8b80c0808868b6834e2967c9de786dfb3fda", "abstract": "Transformer networks have outperformed recurrent neural networks and convolutional neural networks in various sequential tasks. However, scaling transformer networks for long sequences has been challenging because of memory and compute bottlenecks. Transformer networks are impeded by memory bandwidth limitations because of their low operation per byte ratio resulting in low utilization of GPU's computing resources. In-memory processing can mitigate memory bottlenecks by eliminating the transfer time between memory and compute units. Furthermore, transformer networks use neural attention mechanisms to characterize the relationships between sequence elements. Efficient hardware solutions have been proposed to implement efficient attention mechanisms, which include ternary content addressable memories (TCAM), crossbar arrays (XBars), and processing in-memory (PIM). However, these solutions do not implement a multi-head self-attention mechanism. We propose using a combination of XBars and CAMs to accelerate transformer networks. We improve the speed of transformer networks by (1) computing in-memory, thus minimizing the memory transfer overhead, (2) caching reusable parameters to reduce the number of operations, (3) exploiting the available parallelism in the attention mechanism, and (4) using locality sensitive hashing to filter the number of sequence elements by their importance. Our approach achieves a 200x speedup and 41x energy improvement for a sequence length of 4098.", "venue": "Design, Automation and Test in Europe", "year": 2021, "citationCount": 14, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This approach achieves a 200x speedup and 41x energy improvement for a sequence length of 4098 by improving the speed of transformer networks by computing in-memory, thus minimizing the memory transfer overhead and using locality sensitive hashing to filter the number of sequence elements by their importance."}, "embedding": {"model": "specter_v2", "vector": [0.07960695028305054, -0.10591676086187363, -0.21020661294460297, 0.12850306928157806, -0.10737941414117813, -0.006655535660684109, 0.16167032718658447, -0.060797907412052155, -0.5834633111953735, -0.3305596113204956, 0.7239425778388977, -0.04468652233481407, 0.6420679688453674, -0.3812297582626343, -0.10074585676193237, -0.3528156876564026, -0.7725915312767029, -0.10114363580942154, 0.6625731587409973, 0.016898220404982567, 0.4215537905693054, -0.278445839881897, -1.6569695472717285, 0.43673235177993774, -0.04071621596813202, 1.17124605178833, 0.18637681007385254, 0.8878794312477112, -0.4131370782852173, 0.5487750172615051, 0.7255043387413025, -0.1259283423423767, 0.12255292385816574, 0.013437746092677116, -0.10561051219701767, -0.4108966588973999, 0.43383151292800903, -0.1036272719502449, -0.37551161646842957, 0.6234437227249146, -0.14857611060142517, 0.3217589259147644, 0.057723548263311386, -0.6337777972221375, 0.26605939865112305, 0.5468018651008606, 0.48755142092704773, 1.0124948024749756, -0.5848307013511658, -0.49450525641441345, 1.138858437538147, -1.1477007865905762, -0.12322469055652618, 1.0566084384918213, 0.8352658748626709, 0.0652424544095993, 0.34592944383621216, -0.46449708938598633, 0.0176071859896183, 0.12076839804649353, -0.3331224322319031, -0.5725671648979187, 0.040202610194683075, -0.18648028373718262, 2.0114834308624268, -0.18945693969726562, 0.6130565404891968, 0.15884283185005188, 0.5187052488327026, 1.0314449071884155, -0.3499906361103058, -0.8075571656227112, 0.054097339510917664, -0.5802384614944458, 0.9678379893302917, 1.2237375974655151, -0.18407416343688965, 0.367984801530838, -1.3066149950027466, -0.1324559450149536, 0.7587808966636658, 0.37587085366249084, 0.5921928882598877, -0.17076683044433594, -0.5246337056159973, 0.8852382302284241, 0.5020729899406433, 0.6275960206985474, -0.16579170525074005, 0.8028947710990906, 0.9904186725616455, -0.06688103824853897, -0.33950746059417725, 0.19036421179771423, 0.6159580945968628, -0.06125520169734955, -0.8161328434944153, -0.24125073850154877, -0.22848893702030182, 1.0706915855407715, -0.4155149459838867, 0.6302260160446167, -0.28266605734825134, 0.04565346986055374, 0.8210631012916565, -0.2528507709503174, 0.859511137008667, -0.12061916291713715, -0.3287765383720398, -0.5418168902397156, -0.260928213596344, -0.4628453552722931, -0.2976026237010956, -0.5643714666366577, -0.8161494731903076, -1.0992090702056885, -0.43289870023727417, 0.6802608370780945, -1.036245584487915, 0.07382958382368088, -0.5344473123550415, 0.4548640847206116, -0.11580342799425125, -0.03294099494814873, 0.5985494256019592, 0.6130727529525757, 0.36538487672805786, 0.25096404552459717, 1.3985552787780762, -1.5306397676467896, -0.357383131980896, -0.7901330590248108, -0.010493408888578415, -0.4736073613166809, -0.018694613128900528, -0.5634146332740784, -1.146918535232544, -1.237199306488037, -0.99381023645401, 0.005807364359498024, -0.6701348423957825, -0.5176938772201538, 1.20768141746521, 0.07742246240377426, -1.3332390785217285, 0.8938044905662537, -0.6690347194671631, -0.4859073758125305, 0.23212742805480957, 0.051050711423158646, 0.7863824963569641, 0.13787001371383667, -1.0438926219940186, 0.14513924717903137, 0.2875796854496002, -0.6764278411865234, -0.23782488703727722, -0.5623887181282043, -0.8302201628684998, 0.3544021546840668, -0.3182719945907593, -0.419676274061203, 1.1897070407867432, -0.022441141307353973, -0.4914998412132263, 0.5826920866966248, -0.051565010100603104, -0.1924842894077301, -0.29904618859291077, 0.07958829402923584, -0.46438631415367126, -0.12111187726259232, -0.1623391956090927, 0.5197016000747681, 0.7299851775169373, -0.041993651539087296, -0.42806434631347656, 0.018650300800800323, -0.4536076784133911, -0.03924915939569473, -0.586396336555481, 1.1185733079910278, -0.7192856669425964, -0.38724884390830994, 0.535609245300293, 0.39530298113822937, -0.09363845735788345, -0.18378129601478577, -0.06273511797189713, -0.4705817401409149, 0.8270257711410522, 0.3859536647796631, 1.041036605834961, -0.9466764330863953, -1.2648510932922363, -0.1369110494852066, -0.1628623604774475, -0.165795236825943, -0.47616487741470337, 0.356998085975647, -0.5590618252754211, -0.12908509373664856, 0.4561214745044708, -0.4377017319202423, -0.5869113802909851, -0.25765883922576904, -0.9209866523742676, -0.46322351694107056, -0.29141008853912354, 0.9916263818740845, -1.0000743865966797, 0.03791257366538048, -0.2922418415546417, 0.3070726692676544, -0.6704489588737488, 1.3437494039535522, -0.18494698405265808, -0.24653135240077972, 0.09342992305755615, 0.17991404235363007, -0.0034147414844483137, -0.76116943359375, 0.3942415118217468, -0.9266490936279297, -0.48070162534713745, 0.480015367269516, 0.6217190027236938, 0.9168117046356201, 0.04446862265467644, 0.5137490034103394, -0.4994504153728485, -0.5116870403289795, 0.24730171263217926, 0.3644845485687256, 0.007582510821521282, -0.6846413612365723, 0.7628173828125, 0.027104195207357407, -0.31651291251182556, 0.4182860255241394, 1.1516886949539185, 1.0006824731826782, -0.4876774251461029, 0.3596722483634949, 0.5866178274154663, 0.15934401750564575, 0.4983605742454529, 0.031455110758543015, 0.47068747878074646, 0.2940390110015869, 0.1960737407207489, -0.24791081249713898, 0.20612463355064392, -0.7093123197555542, -0.034154247492551804, 0.6006103157997131, 0.49217575788497925, 0.7059333324432373, 0.35794317722320557, -1.0530883073806763, -0.9412287473678589, 0.34941282868385315, 0.47730985283851624, 1.3907314538955688, -0.1322091817855835, 0.0253888089209795, -0.6208485960960388, -0.018466925248503685, -0.5640108585357666, -0.37450090050697327, -0.06962267309427261, -0.43778496980667114, -0.48059749603271484, -1.2030656337738037, 0.9103802442550659, 0.8538681864738464, 1.3064409494400024, -0.7230749130249023, -1.2148476839065552, -0.16996464133262634, 0.3433290719985962, -0.5546668767929077, -0.8646358251571655, 0.7979057431221008, -0.918796718120575, 0.08571990579366684, 0.28796401619911194, -0.4013293981552124, 0.027552878484129906, -0.28999659419059753, 1.2109501361846924, -0.28682100772857666, -0.4782620072364807, -0.2575172781944275, 0.4743933379650116, -0.4363601803779602, -0.5207803249359131, 0.22873207926750183, -0.06914065778255463, -0.5290619730949402, 0.662670373916626, 0.04590422660112381, -0.1475074291229248, -0.1145140752196312, -0.22021424770355225, 0.08495740592479706, 0.11514419317245483, 0.3024381101131439, 0.2907879054546356, -0.38039711117744446, -0.12088780105113983, -0.640904426574707, 0.6516188979148865, 0.24798576533794403, -0.40276628732681274, 0.03031616285443306, -0.5021721720695496, -0.06901983916759491, 0.6374463438987732, -0.5999729037284851, 0.08342739194631577, -0.8273574113845825, -0.009452984668314457, -0.632257878780365, 0.2504584789276123, -0.05611812695860863, 0.42185288667678833, -0.3470197916030884, 0.03107740357518196, 0.7248327732086182, 0.5181984305381775, 0.3577392101287842, -0.24709022045135498, -0.9068318009376526, 0.6962281465530396, 0.06380808353424072, -0.3539870083332062, -0.12472851574420929, 0.1544351428747177, -0.5931486487388611, -0.36918240785598755, -0.3783060610294342, -0.18892604112625122, -0.6001681089401245, 0.1335015743970871, -0.3984658122062683, -1.2001854181289673, 0.01732529141008854, -0.9630317091941833, 0.06082451716065407, 0.446541428565979, -0.3304945230484009, -0.28837060928344727, -0.9892556071281433, -1.5101393461227417, -0.43605366349220276, -1.4215660095214844, -1.176738977432251, 0.11650178581476212, 0.39590105414390564, -0.24973127245903015, -0.25451019406318665, -0.34039512276649475, -0.7298079133033752, 1.3664324283599854, -0.33253011107444763, 0.6412391066551208, 0.121444471180439, -0.5367335677146912, 0.2507602572441101, -0.02128152921795845, 0.007177984807640314, -0.24685469269752502, 0.26921141147613525, -0.7074891924858093, 0.3271368443965912, -0.2655774652957916, -0.09573952108621597, 0.5017330050468445, 0.03323237970471382, 0.9239868521690369, 0.2465800642967224, -0.595744252204895, 0.2581701874732971, 1.398476481437683, 0.21470366418361664, 0.48949524760246277, 0.014834607020020485, 0.7184496521949768, -0.29256075620651245, 0.1738024652004242, 0.3941047489643097, -0.43238991498947144, 0.47440001368522644, 0.12928587198257446, -0.33039721846580505, -0.0343334823846817, -0.12224344164133072, 0.2393612116575241, 1.524889349937439, 0.44775503873825073, 0.2780781090259552, -0.7871613502502441, 0.6601443886756897, -1.329224705696106, -0.7270532250404358, 0.7178025841712952, 0.7657577395439148, 0.36820554733276367, -0.04159221798181534, 0.1615731567144394, -0.033082347363233566, 0.43952664732933044, 0.29419058561325073, -0.5252141356468201, -0.9604153633117676, 0.06141429767012596, 0.6911212205886841, 0.7559980750083923, 0.443372905254364, -0.42755234241485596, 0.4295632541179657, 15.032605171203613, 0.5430101156234741, -0.4758298993110657, 0.49858036637306213, 0.5861025452613831, 0.41894638538360596, 0.21367968618869781, 0.022657403722405434, -1.2979092597961426, 0.3294641971588135, 1.6100659370422363, 0.34063684940338135, -0.06756613403558731, 0.43341755867004395, -0.20857447385787964, 0.002311161020770669, -0.3623453378677368, 0.6960620880126953, 0.8009328246116638, -1.682804822921753, 0.2497989684343338, 0.22095198929309845, -0.24882753193378448, 0.3110065460205078, 0.8214188814163208, 0.23025056719779968, 0.559126079082489, -0.022160271182656288, 0.1871551275253296, 0.3719733953475952, 0.942031741142273, -0.634145200252533, 0.48670804500579834, -0.2666749954223633, -1.0957825183868408, 0.18672677874565125, -0.7923569083213806, -0.8726913928985596, 0.06543406844139099, 0.22930198907852173, -0.7771143317222595, -0.525271475315094, 0.09375496953725815, 0.5147384405136108, 0.37037035822868347, 0.607082724571228, 0.04785652831196785, 0.21712632477283478, 0.2663227915763855, -0.27102041244506836, 0.3205088973045349, 0.41879692673683167, -0.29216814041137695, 0.12440666556358337, 0.15717069804668427, 0.13435757160186768, 0.039608217775821686, 0.02078988589346409, -0.17466455698013306, -0.6798129677772522, -0.11615452170372009, -0.4061071276664734, -0.17825254797935486, 0.8256682753562927, -0.08255834132432938, 0.12893235683441162, -0.3819437623023987, 0.3566684126853943, 0.27217674255371094, -0.35272911190986633, -0.8187899589538574, -0.3797486126422882, 0.5523426532745361, -0.5364106297492981, 0.30746251344680786, 0.4410976767539978, -0.45125046372413635, -0.6599007248878479, -1.1923761367797852, -0.4767993688583374, 0.6597981452941895, -0.8525532484054565, -0.4388261139392853, 1.433145523071289, -0.7201000452041626, -0.5053078532218933, 0.43764761090278625, -1.0030773878097534, -0.2279718667268753, 0.23497836291790009, -0.8962759971618652, -0.3151850998401642, -0.37207847833633423, -0.25129932165145874, -0.39677777886390686, 0.18506823480129242, 1.3218321800231934, 0.16170509159564972, -0.2175992876291275, 0.03486591577529907, -0.27873992919921875, -0.05593187361955643, -0.17831309139728546, -0.3378598690032959, 1.0840182304382324, 0.3625706732273102, -0.4958619773387909, 0.4345178008079529, 0.02926681749522686, 0.037493400275707245, -0.9458980560302734, -0.12698796391487122, 0.5840604901313782, -0.28234872221946716, -0.18456673622131348, -0.9382957220077515, -0.9388223886489868, 0.47506871819496155, 0.6240736842155457, -0.23968690633773804, 0.4721127152442932, -0.11684175580739975, -0.6515980958938599, -0.33814486861228943, -0.4943051338195801, 0.13885438442230225, 0.6518651843070984, -0.643945038318634, -0.17168067395687103, -0.5727546215057373, 0.27487191557884216, -1.040465235710144, -0.7832970023155212, -0.14798469841480255, 0.3811302185058594, -0.4827219843864441, 1.1157997846603394, -0.18555918335914612, 0.9192728400230408, 0.7690174579620361, 0.18766839802265167, -0.26894131302833557, -0.07729534804821014, -0.475341260433197, -0.07110802084207535, 0.033603087067604065, -0.005129254423081875, -0.31745386123657227, 0.8588582277297974, 0.6457096934318542, -0.03168601170182228, -0.313378244638443, -0.21654251217842102, -0.03753754869103432, -0.6527818441390991, -0.23555982112884521, 0.287254273891449, 0.058416545391082764, 0.32269787788391113, 0.17954963445663452, 0.3467088043689728, 0.17116421461105347, 0.05146609991788864, -0.021978091448545456, -0.09798361361026764, -0.1462138593196869, -0.04030024632811546, -0.5389325022697449, -0.9131335020065308, -1.099273920059204, -0.18418575823307037, -0.835360586643219, 0.06357919424772263, -0.2550487220287323, -0.056635938584804535, -0.09905771166086197, -0.40515419840812683, 0.2464894950389862, 0.23473775386810303, 0.07417334616184235, -0.6636335253715515, -0.5632551312446594, -0.5579420328140259, 0.5336995124816895, 0.49453791975975037, -0.2574903666973114, 0.40901604294776917, -0.4759151041507721, 0.11340884119272232, 0.12442246079444885, 0.41761836409568787, -0.15760493278503418, -0.6110254526138306, -0.8296372294425964, -0.08523590117692947, 0.05208020657300949, -0.4236602187156677, -1.188982367515564, 1.193861722946167, 0.5484361052513123, 0.056214042007923126, -0.7534070014953613, 0.33661186695098877, -0.6396886706352234, -0.17609195411205292, 0.7729001641273499, -0.5172595381736755, 0.757104754447937, 0.7359596490859985, -0.978071391582489, -0.33536043763160706, 0.6003342866897583, 0.330959677696228, -1.0430690050125122, -1.168271780014038, 0.4069599509239197, -0.6914081573486328, -0.04635148495435715, -0.30748268961906433, -0.35670971870422363, -1.1947201490402222, -0.19715936481952667, 0.1740393042564392, 0.130996435880661, -0.16014698147773743, 0.929832398891449, 0.8611564636230469, -1.0691121816635132, 0.4430676996707916, 0.6061168313026428, -0.14350180327892303, -0.3279266655445099, 0.5298094749450684, 0.26299843192100525, -0.6769638657569885, 0.6424006819725037, -0.6019572019577026, 0.1520056426525116, -1.3603383302688599, 0.5112407207489014, 0.6853861808776855, -0.4159073531627655, 0.0766620934009552, 0.8501414656639099, -0.49610012769699097, -0.37738484144210815, 0.05093947798013687, -1.0064705610275269, -0.5072720050811768, -0.08394061028957367, 0.9009669423103333, 0.1540035754442215, 0.3537982106208801, -0.12463587522506714, -0.6120543479919434, 0.12656298279762268, -0.27383163571357727, -0.3527643084526062, 0.30623719096183777, 0.4098733067512512, -0.727648913860321, 0.4499334692955017, 0.7803155183792114, -0.7568138837814331, -0.45737284421920776, -0.6616898775100708, -0.16001184284687042, -0.2454027682542801, 0.14157433807849884, 0.3450697660446167, -0.9494134187698364, 0.6702261567115784, 0.6699386835098267, 0.0144862812012434, 0.4418894350528717, -0.4640953242778778, 0.5873534679412842, 0.12546004354953766, 0.17644740641117096, -0.2412146031856537, -0.23249264061450958, 1.713361382484436, 0.8394554853439331, -0.17287778854370117, 0.1775805801153183, -0.3723585307598114, -0.23136235773563385, 1.4059040546417236, 0.6859907507896423, -0.20702588558197021, 0.829537570476532, 0.727878212928772, 0.11679384112358093, 0.15169411897659302, -1.0096673965454102, -0.265270471572876, 0.3024733066558838, 0.8150551319122314, 0.978408694267273, -0.12994088232517242, 0.15358565747737885, 0.51199871301651, 0.22906333208084106, 0.19603128731250763, 0.39427438378334045, 0.7901608347892761, -0.26839393377304077, -0.23021432757377625, -0.16329018771648407, 0.74789959192276, -0.6277843117713928, -1.1800003051757812, 0.6015749573707581, 0.5521371364593506, -0.16963931918144226, 0.3053765892982483, 1.6547667980194092, -0.44095665216445923, 0.36337846517562866, 0.1277192384004593, 0.38292238116264343, -0.1711919754743576, -0.7135262489318848, 0.004759323317557573, -0.3841583728790283, -0.06749726086854935, -0.13809189200401306, -0.6769017577171326, -0.5663974285125732, -0.3138720691204071, 0.5225025415420532, 0.0949888527393341, 0.23355409502983093, 0.17639929056167603, 0.6955533027648926, 1.0543378591537476, -0.4971965253353119, -0.5604833960533142, -0.31239762902259827, -0.674272358417511, 0.37489065527915955, -0.6430851221084595, -0.20159883797168732, -0.1586274355649948, -0.02538159117102623, -0.3290841579437256]}, "authors": [{"authorId": "2086240", "name": "Ann Franchesca Laguna"}, {"authorId": "153208721", "name": "A. Kazemi"}, {"authorId": "2751894", "name": "M. Niemier"}, {"authorId": "2157546161", "name": "X. S. Hu"}], "references": [{"paperId": "933397743ef4617dc035dd12080a8dbd640dc99f", "title": "Hardware Implementation of a Softmax-Like Function for Deep Learning"}, {"paperId": "62aa3f35c30702d87c5faf90a450369ee4da8db9", "title": "FARM: A Flexible Accelerator for Recurrent and Memory Augmented Neural Networks"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "647cc5d6bb2de6d7e1c62b34642a22b688d79a8e", "title": "A Fast and Energy Efficient Computing-in-Memory Architecture for Few-Shot Learning Applications"}, {"paperId": "8771679aac0e90371340bd8c657317f5be113e81", "title": "Train Large, Then Compress: Rethinking Model Size for Efficient Training and Inference of Transformers"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "0e22d8a86c17c415d9c1f737fb8cb7ada5e75656", "title": "Ferroelectric ternary content-addressable memory for one-shot learning"}, {"paperId": "ce106590145e89ea4b621c99665862967ccf5dac", "title": "Q8BERT: Quantized 8Bit BERT"}, {"paperId": "7a064df1aeada7e69e5173f7d4c8606f4470365b", "title": "ALBERT: A Lite BERT for Self-supervised Learning of Language Representations"}, {"paperId": "1cf1ec50e75f2c9f3064a411ea1428695a1df910", "title": "Fully Quantized Transformer for Improved Translation"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "bd4cd0d7e954abc298b5ee46511578ef07858875", "title": "X-MANN: A Crossbar based Architecture for Memory Augmented Neural Networks"}, {"paperId": "a52f9317ae528087324b1126923cef8bd46e3f13", "title": "Ferroelectric FET Based In-Memory Computing for Few-Shot Learning"}, {"paperId": "c0b317be2ab7e6434c4d5a36f7cc4e87f6f6289d", "title": "Design of Hardware-Friendly Memory Enhanced Neural Networks"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "c5d9c2d338f56441f6b9929dfa1c1ee97e0d8576", "title": "Acceleration of Deep Neural Network Training with Resistive Cross-Point Devices: Design Considerations"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}]}