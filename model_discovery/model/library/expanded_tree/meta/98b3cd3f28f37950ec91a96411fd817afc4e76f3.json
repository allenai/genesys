{"paperId": "98b3cd3f28f37950ec91a96411fd817afc4e76f3", "abstract": "Runtime and scalability of large neural networks can be significantly affected by the placement of operations in their dataflow graphs on suitable devices. With increasingly complex neural network architectures and heterogeneous device characteristics, finding a reasonable placement is extremely challenging even for domain experts. Most existing automated device placement approaches are impractical due to the significant amount of compute required and their inability to generalize to new, previously held-out graphs. To address both limitations, we propose an efficient end-to-end method based on a scalable sequential attention mechanism over a graph neural network that is transferable to new graphs. On a diverse set of representative deep learning models, including Inception-v3, AmoebaNet, Transformer-XL, and WaveNet, our method on average achieves 16% improvement over human experts and 9.2% improvement over the prior art with 15\u00d7 faster convergence. To further reduce the computation cost, we pre-train the policy network on a set of dataflow graphs and use a superposition network to fine-tune it on each individual graph, achieving state-of-the-art performance on large hold-out graphs with over 50k nodes, such as an 8-layer GNMT.", "venue": "", "year": 2019, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work proposes an efficient end-to-end method based on a scalable sequential attention mechanism over a graph neural network that is transferable to new graphs that achieves state-of-the-art performance on large hold-out graphs with over 50k nodes, such as an 8-layer GNMT."}, "embedding": {"model": "specter_v2", "vector": [0.2843240201473236, 0.6630927920341492, -0.5048859715461731, 0.206261545419693, 0.4593697786331177, -0.2580828368663788, 0.6523486375808716, 0.1921529471874237, -0.24175694584846497, -0.17992956936359406, 0.5574128031730652, 0.07270181179046631, 0.3390843868255615, -0.19617357850074768, -0.28563565015792847, 0.4719562828540802, -1.142150640487671, 0.03684662654995918, 0.33686742186546326, 0.1816762536764145, 0.16977523267269135, -0.20982442796230316, -1.1544725894927979, -0.16256220638751984, 0.16493268311023712, 1.217340350151062, 0.04564695805311203, 0.8672090172767639, -0.48854929208755493, 0.6305570602416992, 0.29043301939964294, -0.49229031801223755, 0.1458476483821869, 0.14296570420265198, -0.5354066491127014, -0.2716861963272095, 0.53290855884552, -0.3375837802886963, -0.378943532705307, 1.1332331895828247, -0.24457716941833496, 0.3958672881126404, 0.059331342577934265, -1.115269660949707, -0.11879268288612366, 0.91583651304245, 0.5211982131004333, 0.5043274760246277, 0.044401418417692184, -0.6902154684066772, 1.6509424448013306, -0.9302862286567688, 0.2749854028224945, 1.396787405014038, 0.5091858506202698, -0.09765983372926712, -0.09170367568731308, -0.47703975439071655, 0.7298754453659058, 0.0911857932806015, -0.4494990110397339, -0.006994806695729494, 0.15564340353012085, 0.004809228703379631, 1.870147705078125, -0.34379804134368896, 0.227041095495224, 0.6714709401130676, -0.15872329473495483, 0.915299654006958, -0.25073951482772827, -0.6753609776496887, -0.025768477469682693, -0.17762528359889984, 0.2334935963153839, 0.9478042125701904, 0.17405498027801514, 0.11485252529382706, -0.567328155040741, -0.17364874482154846, 0.3259403109550476, 0.5020598769187927, 0.6822875738143921, -0.28350767493247986, 0.09655912965536118, 0.2785097360610962, 0.958899736404419, 0.571490466594696, -0.32832738757133484, 1.11298406124115, 0.7952272295951843, 0.03505418449640274, -0.4386812746524811, 0.08297887444496155, 0.2608605623245239, 0.5625705122947693, -0.2794230580329895, -0.1636132299900055, 0.22941546142101288, 0.9485354423522949, -0.35339832305908203, 0.2669883966445923, -0.07879593223333359, -0.08966434001922607, 1.3936100006103516, -0.09028660506010056, 0.21705354750156403, -0.7254496216773987, 0.15228271484375, -0.22619618475437164, -0.21907079219818115, -1.1475653648376465, -0.04511139914393425, -0.2714819014072418, -0.9941336512565613, -0.9012829661369324, -0.6693712472915649, 0.09936566650867462, -0.6624312996864319, 0.5192580223083496, -0.7329258322715759, 0.5430036187171936, -0.2552925646305084, 0.14610067009925842, 0.6138485074043274, 0.4268186688423157, 0.1678657978773117, 0.8255757689476013, 0.4484888017177582, -1.0600305795669556, -0.33984512090682983, -0.9015160799026489, 0.6144222617149353, -0.10270658135414124, 0.06529869884252548, -0.19956931471824646, -1.0996532440185547, -1.122795820236206, -0.649810791015625, 0.46270817518234253, -0.8203010559082031, -0.159682035446167, 1.0156495571136475, 0.5408679246902466, -1.1380983591079712, 1.0736924409866333, -0.1315305233001709, -0.7149344086647034, 0.6401103734970093, 0.6696425080299377, 0.27536678314208984, -0.30773231387138367, -0.9456050395965576, 0.18304958939552307, 0.3140667974948883, -0.20985791087150574, 0.011484043672680855, -0.2820400893688202, -1.0385899543762207, 0.4273374378681183, 0.42617833614349365, -0.6408611536026001, 0.7876155972480774, -0.07301833480596542, -0.797812819480896, 0.5048602223396301, 0.29910218715667725, -0.06888853758573532, 0.16076044738292694, 0.1584954559803009, -0.676806628704071, -0.32230934500694275, -0.15371087193489075, 0.31568989157676697, -0.020677421241998672, -0.2170516550540924, -0.323510080575943, 0.1496238112449646, 0.07898639887571335, -0.2456018179655075, -0.6976634860038757, 1.1869088411331177, -0.5195891261100769, 0.23939500749111176, -0.07185351848602295, 0.5886186361312866, -0.4059566259384155, 0.08094296604394913, -0.8532258868217468, -0.7905902862548828, 0.6760098338127136, 0.14244481921195984, 0.8618643879890442, -0.837252676486969, -0.6874582171440125, 0.2924855649471283, 0.14891748130321503, -0.00931470189243555, -0.8299817442893982, 0.5118140578269958, -0.4131726324558258, 0.7818443775177002, 0.31759387254714966, -0.9881348013877869, -0.05174758657813072, 0.16065964102745056, -0.21142970025539398, -0.33063119649887085, -0.1325916349887848, 1.0086621046066284, -0.9635928273200989, -0.033437710255384445, 0.2811359167098999, 0.16905048489570618, -0.9058863520622253, 1.0382499694824219, -0.24477709829807281, -0.35613879561424255, -0.4901559352874756, 0.00889296643435955, 0.15571749210357666, -0.522497832775116, 0.7805212736129761, -0.3812904953956604, 0.3392695486545563, 0.5811001062393188, -0.5173982977867126, 1.4091038703918457, -0.3845904767513275, 0.12423762679100037, 0.30428528785705566, -0.8660817742347717, 0.6266584992408752, -0.009373306296765804, 0.2107761651277542, -0.3167533278465271, 0.3107598125934601, 0.39075109362602234, -0.4893440306186676, 0.23308905959129333, 0.5636782646179199, 1.497052550315857, -0.552132785320282, -0.017728140577673912, 0.5531986951828003, 0.13178323209285736, 0.42857420444488525, 0.6088792085647583, 1.000386357307434, 0.20099955797195435, 0.43823620676994324, 0.022767888382077217, 0.27981284260749817, -1.0860341787338257, -0.04240249842405319, 0.644284725189209, 0.4532696306705475, 0.5360958576202393, 0.7956765294075012, -0.7549286484718323, -0.3904127776622772, -0.13735270500183105, 0.9571680426597595, 0.9832781553268433, 0.23432984948158264, -0.18132907152175903, -0.3835769593715668, -0.6081979870796204, 0.046324264258146286, -0.32497888803482056, -0.30643603205680847, 0.032646503299474716, -0.5346556901931763, -0.6334080100059509, 0.595262348651886, 0.5532000064849854, 0.9920626878738403, -1.0654301643371582, -0.03387140482664108, -0.42551353573799133, 0.5062626600265503, -1.2330440282821655, -0.36696919798851013, 0.25711414217948914, -0.20466448366641998, -0.3592781722545624, 0.505585253238678, -0.2890894412994385, 0.5649624466896057, -0.8399927616119385, 1.069894552230835, 0.019869055598974228, -0.17767125368118286, 0.38290509581565857, 0.28466635942459106, -0.4789358377456665, -0.15621685981750488, 0.3556192219257355, 0.09340374916791916, -0.09528952836990356, 0.26146256923675537, -0.12859004735946655, -0.24713623523712158, -0.2896425426006317, -0.4169550836086273, -0.3800562918186188, 0.08408968150615692, -0.29027068614959717, 0.09497839212417603, -0.028467323631048203, -0.15245115756988525, -1.1034846305847168, 0.8995847702026367, -0.3450818657875061, -0.5045073628425598, -0.059571824967861176, -0.5611456632614136, -0.511297881603241, 1.091437578201294, -0.31115812063217163, 0.30403995513916016, -0.7976632714271545, 0.4498805105686188, -0.8760252594947815, -0.6206940412521362, 0.2538260817527771, 0.16678842902183533, 0.04203404486179352, -0.019628500565886497, 0.007861659862101078, 0.34615254402160645, -0.13923336565494537, 0.3648281395435333, -0.7951712012290955, 0.8434783220291138, 0.04069714620709419, -0.011707549914717674, 0.008413366973400116, 0.5487004518508911, -0.49226510524749756, -0.2804909646511078, -0.22138744592666626, -0.30496084690093994, -0.12656760215759277, 0.15909911692142487, -0.3257843255996704, -1.1512608528137207, -0.25332996249198914, -1.1010496616363525, -0.2386542558670044, 0.07445372641086578, -0.5073962211608887, 0.3173742890357971, -0.8211477994918823, -0.8556537628173828, -0.4932986795902252, -0.5567592978477478, -0.8509409427642822, -0.020573815330863, 0.33186861872673035, -0.4384441077709198, -1.0252670049667358, -0.4523504674434662, -0.7813549041748047, 0.6721813678741455, 0.2395690679550171, 0.26213255524635315, -0.18318355083465576, -0.3826807737350464, -0.4505820870399475, -0.2666986882686615, 0.4632704555988312, 0.0982571616768837, 0.4597937762737274, -0.44400033354759216, 0.4375295341014862, -1.1549532413482666, -0.1483030915260315, 0.07145171612501144, 0.44648197293281555, 1.2737070322036743, 0.15494683384895325, -0.4072083830833435, 0.5442186594009399, 1.4637782573699951, -0.754585862159729, 0.2839778661727905, 0.08980613946914673, 1.1154789924621582, 0.22009310126304626, -0.7258132100105286, 0.45461031794548035, 0.09215928614139557, 0.446246862411499, 0.7354711890220642, -0.24409639835357666, -0.34310322999954224, -0.8249286413192749, 0.30407804250717163, 1.1649394035339355, 0.40103259682655334, -0.41508832573890686, -0.7043727040290833, 0.826442539691925, -1.236984133720398, -0.5875276923179626, 0.47449520230293274, 0.3605629801750183, -0.5150403380393982, 0.025296397507190704, 0.09941639751195908, -0.25697043538093567, 0.8543077707290649, 0.5450329780578613, -0.29964151978492737, -1.058905005455017, 0.15972383320331573, 0.5934033989906311, 0.5596239566802979, 0.4543246626853943, -0.2438380867242813, 0.22810274362564087, 15.206586837768555, 0.3893488347530365, 0.03678265959024429, -0.20612382888793945, 0.6254006028175354, 0.4216761291027069, -0.2671734094619751, 0.025799257680773735, -0.9961536526679993, 0.5379869341850281, 1.229691505432129, 0.3448789417743683, 0.4608510434627533, 0.21701213717460632, -0.17278122901916504, 0.26488354802131653, -0.7505602240562439, 0.7706671357154846, 0.5025284290313721, -1.2363171577453613, -0.0032775928266346455, 0.28843024373054504, 0.28516125679016113, 0.7436289191246033, 0.8593186140060425, 0.17339396476745605, 1.0942168235778809, -0.42632949352264404, 0.31040242314338684, 0.22316153347492218, 1.2247941493988037, 0.29928871989250183, 0.45211130380630493, -0.08057081699371338, -1.096156120300293, -0.37164321541786194, -0.6992608904838562, -1.3166265487670898, 0.33372876048088074, 0.09823092073202133, -0.5047073364257812, -0.0348067432641983, 0.08648239821195602, 1.2384015321731567, 0.07662864029407501, 0.5528606176376343, -0.5064515471458435, 0.19522987306118011, -0.458290159702301, -0.4051222801208496, 0.0344412736594677, 0.2283509075641632, 0.050025954842567444, -0.29714059829711914, 0.035515058785676956, -0.32235729694366455, 0.678601086139679, 0.5843811631202698, -1.1005769968032837, -0.3123548924922943, -0.49301251769065857, -0.39435315132141113, 0.2954271733760834, 1.076776146888733, 0.18656934797763824, 0.10864019393920898, -0.7280389070510864, 0.46197786927223206, 0.4546845257282257, 0.23485901951789856, -0.28175175189971924, -0.3146359324455261, 0.5516411066055298, -0.34472668170928955, -0.2970408499240875, 0.7381955981254578, -0.3185279369354248, -0.39097946882247925, -0.7513667345046997, 0.08236996084451675, 0.6653969287872314, -0.8836583495140076, -0.7879164814949036, 0.8951789736747742, -0.677719235420227, -0.37925055623054504, 0.09900077432394028, -1.1270605325698853, -0.6766437888145447, 0.5085822939872742, -1.4577000141143799, -0.6810623407363892, -0.26080945134162903, -0.20140822231769562, -0.7813007831573486, -0.12256131321191788, 1.2394425868988037, 0.24438096582889557, -0.623277485370636, -0.10263460129499435, -0.3035650849342346, 0.282426118850708, -0.3294009566307068, -0.9992649555206299, 1.0373696088790894, 0.5424565076828003, 0.09638688713312149, -0.12001806497573853, -0.11033902317285538, -0.02578945830464363, -0.326944500207901, -0.22848966717720032, 0.1637578308582306, -0.6710641384124756, 0.1967407464981079, -0.6776280999183655, -0.4762534201145172, 0.8311753869056702, 0.5681632161140442, 0.48099368810653687, 0.026132557541131973, 0.10106920450925827, -0.6292953491210938, -0.13737429678440094, -0.7283763289451599, 0.05842768773436546, 0.8778380751609802, -0.5745496153831482, 0.09951958060264587, -0.14589060842990875, 0.15357157588005066, -0.62075275182724, -0.5702516436576843, 0.032224878668785095, 0.027962349355220795, -0.25644299387931824, 1.1553031206130981, -0.664857029914856, 0.9891040921211243, 0.9647960066795349, 0.033057864755392075, -0.7563143968582153, -0.1624036580324173, -1.130405306816101, -0.37015843391418457, -0.14347323775291443, 0.340497761964798, -0.5951284766197205, 0.8444534540176392, 0.6171253323554993, 0.13598087430000305, -0.4110095202922821, 0.022634334862232208, -0.2685551941394806, -0.3886120319366455, -0.07696361839771271, 0.5219638347625732, 0.14346416294574738, -0.13450537621974945, 0.08235155045986176, 0.5208194255828857, 0.5261738300323486, 0.032239899039268494, -0.6803726553916931, 0.2581075429916382, -0.5960180163383484, -0.2802216112613678, -0.6630777716636658, -0.8971222639083862, -1.2747331857681274, 0.19017472863197327, -1.2253594398498535, -0.39788955450057983, -0.9622747302055359, -0.524649977684021, -0.000616315403021872, -0.5880250334739685, 0.07070619612932205, 0.5077738165855408, -0.28481441736221313, -0.3885706663131714, -0.6859545111656189, -0.8622869253158569, 0.4585973918437958, 0.695713996887207, -0.3493233621120453, 0.10757090151309967, -0.3103896677494049, -0.15870806574821472, 0.26407599449157715, 0.419450044631958, -0.18032942712306976, -0.7010756731033325, -1.3854643106460571, 0.36555472016334534, -0.4169684648513794, -0.02944590523838997, -0.773170530796051, 0.8845048546791077, 0.4851909577846527, -0.12022548168897629, 0.23469576239585876, 0.24309226870536804, -0.98863685131073, -0.5720076560974121, 0.3584263324737549, -0.5912895202636719, 0.34468919038772583, 0.06907043606042862, -0.26107072830200195, -0.0627971887588501, 0.6009988784790039, -0.22529269754886627, -0.6127000451087952, -0.9600205421447754, 0.5760344862937927, -0.15540073812007904, -0.1299775391817093, -0.21606850624084473, -0.3551318347454071, -1.2790684700012207, -0.4776901602745056, -0.3135175406932831, 0.26236724853515625, -0.3837096393108368, 0.914334237575531, 0.18702584505081177, -1.1400530338287354, 0.05975579097867012, 0.29002994298934937, -0.40933701395988464, 0.023902179673314095, -0.04802251234650612, 0.3617694079875946, -0.7624815702438354, -0.013242644257843494, -0.23195098340511322, 0.33810463547706604, -0.7346809506416321, 0.2698165476322174, 0.5745807886123657, -0.4399586617946625, -0.32712021470069885, 1.0839087963104248, -0.6900381445884705, -0.9627243876457214, 0.31674355268478394, -1.0258063077926636, -0.502938985824585, -0.48015111684799194, 0.15639638900756836, 0.21875227987766266, -0.05905469134449959, 0.16737930476665497, -0.5213959217071533, -0.14564292132854462, 0.10523448139429092, 0.26550233364105225, 0.6191201210021973, -0.018194982782006264, -0.4768369197845459, -0.09189245849847794, 1.066007375717163, -0.6406781673431396, -0.3318948447704315, -0.8673697710037231, -0.15858356654644012, -0.35104992985725403, 0.07982107251882553, 0.0964817926287651, -1.173114538192749, 0.7091034054756165, 0.2605483829975128, 0.64947509765625, 0.31976282596588135, -0.022745629772543907, 0.34731408953666687, 0.6182637214660645, -0.07420568913221359, -0.49090245366096497, -0.03250318020582199, 0.8281069993972778, 1.0677742958068848, -0.5759578347206116, 0.614918053150177, -0.8761544227600098, -0.2492973953485489, 0.6431422233581543, 0.3664948046207428, -0.6437559127807617, 1.0228824615478516, 0.2369091808795929, -0.42705008387565613, 0.07724064588546753, -0.6224811673164368, -0.3019493818283081, 0.4417293667793274, 0.9902740716934204, 0.4196212589740753, 0.19870297610759735, 0.3994705379009247, 0.5246761441230774, 0.0856190025806427, -0.19075575470924377, 0.44068560004234314, 0.37044548988342285, 0.31175917387008667, -0.2516949474811554, 0.15689724683761597, 0.8524659872055054, -0.40056800842285156, -0.26950135827064514, -0.3532174825668335, 0.28693288564682007, 0.04499085247516632, 0.6841196417808533, 1.351391315460205, -0.30936354398727417, 0.9003716111183167, -0.6667684316635132, 0.26142528653144836, -0.5540851950645447, -0.3570043444633484, -0.2710176408290863, -0.29538363218307495, -0.7494059205055237, -0.20693881809711456, -0.4835444390773773, -0.5962063074111938, -0.6331316232681274, 0.40935271978378296, -0.28888824582099915, 0.19211851060390472, 0.5640024542808533, 0.8041530847549438, 0.9366986751556396, -0.016448091715574265, -0.4538043141365051, -0.0016163382679224014, -0.7245707511901855, -0.27688610553741455, 0.19608339667320251, -0.4979609251022339, -0.07655851542949677, -0.2683001756668091, -0.6910668611526489]}, "authors": [{"authorId": "72715744", "name": "Dataflow Graphs"}], "references": [{"paperId": "2319e4f2d73c78820d498a347d74ed5ef3a185d3", "title": "Placeto: Learning Generalizable Device Placement Algorithms for Distributed Machine Learning"}, {"paperId": "3c00fbd601e1bc148cf9eee490db6236d5fcf4aa", "title": "REGAL: Transfer Learning For Fast Optimization of Computation Graphs"}, {"paperId": "48f8882739d9f22f56016d133b5688e082db0d08", "title": "Superposition of many models into one"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "d79a26226393f687ddbc375e32055b40b8ad8d38", "title": "GPipe: Efficient Training of Giant Neural Networks using Pipeline Parallelism"}, {"paperId": "62ed9bf1d83c8db1f9cbf92ea2f57ea90ef683d9", "title": "How Powerful are Graph Neural Networks?"}, {"paperId": "f971658ab845d7573c4bbb760d5e7e5332025254", "title": "Beyond Data and Model Parallelism for Deep Neural Networks"}, {"paperId": "dd97a44fdc5923d1d3fd9d7c3dc300fb6f4f04ed", "title": "Spotlight: Optimizing Device Placement for Training Deep Neural Networks"}, {"paperId": "d9f836a2062864e4808e12224e2286a353498202", "title": "Graph Convolutional Policy Network for Goal-Directed Molecular Graph Generation"}, {"paperId": "e6a83abec5cffb0bf1669f2f2c1efdf2b15cb171", "title": "TADAM: Task dependent adaptive metric for improved few-shot learning"}, {"paperId": "0f885fd46064d271d4404cf9bb3d758e1a6f8d55", "title": "Exploring the Limits of Weakly Supervised Pretraining"}, {"paperId": "22ba3276c8797fddeb5d9db083ed1010da182549", "title": "A Hierarchical Model for Device Placement"}, {"paperId": "50bdda28de3dcf82a0e10f9ec13eea248b19edb5", "title": "Regularized Evolution for Image Classifier Architecture Search"}, {"paperId": "a1c922be467d1c0c64b963e65dae41778b81b2a0", "title": "Deep Learning Scaling is Predictable, Empirically"}, {"paperId": "bfbd10ebffc9494423770a5bd30ebd0f9cbce66d", "title": "Device Placement Optimization with Reinforcement Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "6b7d6e6416343b2a122f8416e69059ce919026ef", "title": "Inductive Representation Learning on Large Graphs"}, {"paperId": "510e26733aaff585d65701b9f1be7ca9d5afc586", "title": "Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer"}, {"paperId": "df0402517a7338ae28bc54acaac400de6b456a46", "title": "WaveNet: A Generative Model for Raw Audio"}, {"paperId": "2f2d8f8072e5cc9b296fad551f65f183bdbff7aa", "title": "Exploring the Limits of Language Modeling"}, {"paperId": "23ffaa0fe06eae05817f527a47ac3291077f9e58", "title": "Rethinking the Inception Architecture for Computer Vision"}, {"paperId": "cea967b59209c6be22829699f05b8b1ac4dc092d", "title": "Sequence to Sequence Learning with Neural Networks"}, {"paperId": "f264e8b33c0d49a692a6ce2c4bcb28588aeb7d97", "title": "Recurrent Neural Network Regularization"}, {"paperId": "df86d2a8c217776786bac9019d8b20029e4c0dd5", "title": "A Fast and High Quality Multilevel Scheme for Partitioning Irregular Graphs"}, {"paperId": null, "title": "Improving deep generative modeling with applications"}, {"paperId": null, "title": "Proximal policy optimization algorithms. CoRR, abs/1707.06347, 2017"}]}