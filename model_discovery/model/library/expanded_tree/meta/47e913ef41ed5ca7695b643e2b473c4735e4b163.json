{"paperId": "47e913ef41ed5ca7695b643e2b473c4735e4b163", "abstract": "This work examines the deep disconnect between existing theoretical analyses of gradient-based algorithms and the practice of training deep neural networks. Specifically, we provide numerical evidence that in large-scale neural network training (e.g., ImageNet + ResNet101, and WT103 + TransformerXL models), the neural network's weights do not converge to stationary points where the gradient of the loss is zero. Remarkably, however, we observe that even though the weights do not converge to stationary points, the progress in minimizing the loss function halts and training loss stabilizes. Inspired by this observation, we propose a new perspective based on ergodic theory of dynamical systems to explain it. Rather than studying the evolution of weights, we study the evolution of the distribution of weights. We prove convergence of the distribution of weights to an approximate invariant measure, thereby explaining how the training loss can stabilize without weights necessarily converging to stationary points. We further discuss how this perspective can better align optimization theory with empirical observations in machine learning practice.", "venue": "International Conference on Machine Learning", "year": 2021, "citationCount": 8, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work provides numerical evidence that in large-scale neural network training, the neural network's weights do not converge to stationary points where the gradient of the loss is zero and proposes a new perspective based on ergodic theory of dynamical systems to explain it."}, "embedding": {"model": "specter_v2", "vector": [-0.013836704194545746, 0.5510389804840088, -0.5737027525901794, 0.38366684317588806, -0.06974062323570251, 0.1374589204788208, 0.3919007182121277, -0.8602069020271301, -0.7993965148925781, -0.2082725167274475, 0.13778740167617798, 0.12589901685714722, 0.06333913654088974, 0.09721829742193222, -0.2601242661476135, -0.43138521909713745, -1.2883855104446411, 0.06625265628099442, -0.009686148725450039, -0.13330645859241486, -0.3694039285182953, -0.6859629154205322, -0.892744779586792, -0.30421876907348633, 0.039335478097200394, 0.9763663411140442, -0.16294972598552704, 0.9693116545677185, -0.19569925963878632, 0.4549207389354706, 0.5862631797790527, -0.48609447479248047, 0.9065491557121277, -0.09543376415967941, -0.39157751202583313, -0.1477588415145874, 0.11263372004032135, -0.34525352716445923, -0.9559965133666992, 1.3330588340759277, -0.4016823470592499, 0.2783114016056061, 0.42956602573394775, -1.0638034343719482, 0.17595915496349335, 0.14687559008598328, 0.34431082010269165, 0.9144669771194458, -0.9339726567268372, -0.32908520102500916, 1.215462565422058, -0.665128231048584, 0.25130078196525574, 1.4362152814865112, 0.9004621505737305, 0.4050930440425873, -0.21536362171173096, -0.8752309679985046, 0.856601357460022, -0.3305933177471161, -0.7042614817619324, -0.07161309570074081, 0.11773761361837387, -0.26025620102882385, 0.804781436920166, -0.5293689966201782, 0.1834607571363449, 0.5788624882698059, 0.35077568888664246, 1.2142925262451172, -0.00825540442019701, -1.0085384845733643, 0.007830343209207058, 0.04133251681923866, 0.5395287275314331, 0.934058666229248, 0.2647726237773895, 0.3719749450683594, -0.975024402141571, 0.229696124792099, 0.12962865829467773, 0.2731415331363678, 0.03298411890864372, -0.5256484746932983, 0.01630868948996067, 0.9206870198249817, 0.6730930805206299, 0.2178625911474228, -0.3632761240005493, 1.6760789155960083, 0.5767785906791687, 0.39769789576530457, 0.6975991725921631, -0.1950475126504898, -0.017803458496928215, 0.49424660205841064, -0.4044385254383087, -0.15588568150997162, -0.06999777257442474, 0.4117239713668823, -0.10928555577993393, 0.3235481381416321, -0.4748309850692749, 0.25048351287841797, 1.389750599861145, 0.32632213830947876, 0.8742901682853699, -0.6385934352874756, 0.5536394119262695, -0.5582188963890076, 0.3051074147224426, -0.8630056977272034, -0.49912574887275696, -0.9434006810188293, -0.8797329664230347, -0.8171566724777222, -0.2612135410308838, -0.04282352700829506, -0.6774862408638, 1.1809450387954712, -0.15566982328891754, 0.11060387641191483, 0.05079231411218643, 0.7683789134025574, -0.5213940739631653, 0.8663339018821716, 0.10516534000635147, -0.030843839049339294, 0.28678688406944275, -0.09293584525585175, -0.9410697817802429, -0.6650791764259338, 0.10930436849594116, -0.4153808057308197, 0.6189121007919312, -0.497807115316391, -1.1717650890350342, -0.6441036462783813, -1.090694546699524, 0.9510372281074524, -0.42913955450057983, 0.061202287673950195, 1.2787662744522095, 0.38296762108802795, -0.6420144438743591, 1.4320087432861328, -0.6088005304336548, -0.47642913460731506, 0.7779191732406616, 0.5509247183799744, 0.8227096796035767, 0.04206817224621773, -0.7414692640304565, 0.7413787841796875, 0.44925737380981445, -0.7627357244491577, 0.12057264894247055, -0.4641556441783905, -0.5167781114578247, 0.15836907923221588, 0.25203102827072144, -0.7723504900932312, 1.2563180923461914, -0.22763970494270325, -1.22858726978302, 0.26051074266433716, 0.0635438933968544, -0.011452541686594486, 0.7099032402038574, -0.1778741031885147, -0.48602575063705444, -0.22983504831790924, -0.24366497993469238, 0.28015971183776855, 0.46705299615859985, -0.38023579120635986, -0.07256744801998138, 0.11660657078027725, -0.9146696925163269, -0.6531745791435242, -0.8572698831558228, 0.22850143909454346, 0.002084738342091441, -0.2264443188905716, 0.5244619250297546, 0.0654086321592331, 0.0671771988272667, -0.24298790097236633, -0.3123548626899719, -1.208769679069519, 0.416720986366272, 0.1609998196363449, 0.991482138633728, -0.5831677317619324, -0.873757541179657, 0.38021039962768555, -0.12976880371570587, -0.3862060606479645, -0.39086103439331055, 0.17825967073440552, -0.5211536884307861, 0.7558618187904358, 0.052856121212244034, -1.0261156558990479, 0.3555396795272827, 0.08618519455194473, -0.8351810574531555, 0.4071885645389557, 0.12075455486774445, 0.79908686876297, -0.9111601710319519, 0.22052001953125, 0.20773249864578247, -0.1952446550130844, -0.8696897029876709, 0.513795793056488, 0.25216785073280334, -0.5149149894714355, 0.05248255282640457, -0.44126272201538086, 0.06957758963108063, -0.7593383193016052, 0.6718338131904602, -0.1761224865913391, 0.0946577787399292, 0.27773651480674744, -0.4243431091308594, 1.1418955326080322, -0.3292170763015747, 0.9109578132629395, -0.5289765000343323, -1.1986050605773926, -0.6578894257545471, 0.34725990891456604, 0.509762167930603, -0.25647303462028503, 0.530238926410675, -0.005367771256715059, -0.5615537166595459, 0.5924339890480042, 0.03908388689160347, 0.5587067008018494, -0.39945629239082336, 0.4624367654323578, 1.1163203716278076, 0.11647217720746994, 0.415761798620224, 0.11085087060928345, 0.5063267350196838, 0.08970923721790314, 0.06638586521148682, -0.5306311845779419, -0.229976087808609, -0.8585226535797119, -0.0976153016090393, 0.4678966999053955, 0.44399240612983704, 0.5567749738693237, 0.5100341439247131, -1.0377517938613892, -0.7056165337562561, -0.9148637652397156, 0.42374444007873535, 0.8882805705070496, -0.028263332322239876, 0.05767875909805298, -0.7544669508934021, -0.1923418492078781, -0.24669554829597473, -0.035511523485183716, -0.5982397198677063, -0.6196807026863098, -0.2326240986585617, -1.6180343627929688, 0.48082926869392395, -0.33031338453292847, 1.2360519170761108, -0.155716672539711, -0.03458075970411301, -0.29296159744262695, 0.22080564498901367, -0.6160344481468201, -0.6947275996208191, 0.3645605146884918, -0.5384405255317688, -0.25774428248405457, -0.18443867564201355, 0.36508485674858093, 0.25348713994026184, -0.6700513958930969, 0.7317168712615967, -0.42622968554496765, -0.1557910293340683, 0.5780153870582581, 1.2548340559005737, -1.4970544576644897, -0.4648410677909851, 0.2301074117422104, 0.7754467725753784, -0.07802817225456238, -0.226054847240448, 0.30946630239486694, -0.4395965039730072, 0.15599839389324188, -0.5884755253791809, -0.10038644820451736, 0.04570288211107254, 0.39627355337142944, 0.09663776308298111, 0.05006028339266777, 0.4904343783855438, -0.371845006942749, 1.2244399785995483, -0.012649220414459705, -0.8062376976013184, 0.6213424205780029, -1.0879735946655273, 0.3287562131881714, 0.27282264828681946, -0.9509177207946777, 0.19237837195396423, -1.2084736824035645, 0.7226898074150085, -0.7048928141593933, 0.5567703247070312, -0.20085732638835907, 1.1454386711120605, 0.14079231023788452, 0.37332674860954285, -0.34896358847618103, 0.7584412097930908, 0.17334850132465363, -0.1716340333223343, -0.9271240830421448, 0.3720852732658386, 0.25653982162475586, 0.4480394423007965, 0.11116939783096313, 0.12438491731882095, -0.3502049148082733, -0.8771181106567383, -0.22348779439926147, 0.2129417508840561, -0.9565646648406982, -0.23565585911273956, -0.30288103222846985, -1.1868243217468262, -0.23355980217456818, -0.3976134657859802, -0.4741075932979584, -0.3469257652759552, 0.34735289216041565, -0.4361490309238434, -1.3950761556625366, -1.0499229431152344, -0.8484306931495667, -0.6233603954315186, -0.48267868161201477, 0.023128502070903778, 0.24931390583515167, -0.455767422914505, -0.45265573263168335, -0.08026503026485443, -1.034847617149353, 0.9817043542861938, -0.36889898777008057, 0.5445867776870728, 0.38167065382003784, -0.19727562367916107, -0.5767346024513245, 0.7267962694168091, 0.396461546421051, -0.399148553609848, 0.30471470952033997, -0.7238541841506958, 0.09927238523960114, -0.6492132544517517, -0.23511996865272522, 0.17985162138938904, 0.7243545651435852, 0.6933998465538025, -0.2614791691303253, -0.2841363251209259, 0.1454458087682724, 1.4112355709075928, -0.7811502814292908, -0.0003737267979886383, 0.3212811052799225, 0.2208491414785385, 0.09740439802408218, -0.7883296012878418, 0.3811402916908264, -0.2835857570171356, 0.00529020419344306, 0.25423163175582886, -0.2556389570236206, -0.2381344735622406, -0.9586281180381775, 0.5791082978248596, 1.6294844150543213, 0.44661638140678406, -0.09138407558202744, -0.8462398052215576, 0.31595057249069214, -1.4337178468704224, -1.0579416751861572, 1.1375375986099243, 1.2139408588409424, -0.10549192875623703, 0.11619072407484055, -0.15965402126312256, 0.1483895182609558, 0.8829261660575867, -0.011675084941089153, -0.539126992225647, -0.061828769743442535, 0.13926488161087036, 0.2483201026916504, 1.1238250732421875, 0.31494972109794617, -0.21081413328647614, 0.6387090682983398, 14.879484176635742, 0.7552398443222046, -0.3785541355609894, 0.6582933664321899, 0.5176900029182434, -0.09369517862796783, 0.002558350097388029, -0.4905604124069214, -0.4904745817184448, 0.3679478168487549, 1.2658984661102295, 0.1459447592496872, 0.7735397219657898, 0.2423822432756424, -0.045832883566617966, 0.2808230519294739, 0.11282020807266235, 0.7680490016937256, -0.039406146854162216, -1.3637207746505737, 0.2087317407131195, 0.39235982298851013, 0.8244342803955078, 1.2692434787750244, 0.9826558232307434, 0.6561475396156311, 0.9192292094230652, 0.20776759088039398, 0.8105834722518921, 0.6319736838340759, 0.891158401966095, -0.5882043242454529, 0.6601129174232483, 0.40802934765815735, -0.5352300405502319, -0.13230852782726288, -0.5601366758346558, -1.0016181468963623, -0.11085715889930725, 0.4320807158946991, -0.5543578863143921, -0.44285500049591064, 0.26401203870773315, 0.33762818574905396, 0.5892869830131531, 0.3833286762237549, 0.08536937087774277, 0.7840535640716553, -0.7158958315849304, -0.13286161422729492, 0.26077595353126526, 0.21740932762622833, 0.2420913130044937, -0.48291516304016113, 0.15751369297504425, -0.3698667585849762, 0.2769278585910797, 0.2890128493309021, -0.7039679288864136, -0.21380093693733215, -0.37800002098083496, -0.33624470233917236, -0.3025725781917572, 0.6104993224143982, -0.03756789490580559, -0.01740064099431038, 0.31253403425216675, 0.12837432324886322, 0.3976026773452759, 0.488102525472641, -0.0725724995136261, 0.10360477864742279, 1.0200912952423096, -0.6012217998504639, -0.5925470590591431, 0.2218463271856308, -0.3956747055053711, -0.9375055432319641, -0.6635510325431824, 0.2030506581068039, 0.22954200208187103, -0.8769400119781494, -1.0011669397354126, 0.34039169549942017, -0.28945091366767883, -0.42681220173835754, 0.6129751801490784, -0.7281675338745117, -0.2215023785829544, -0.1549377143383026, -1.263187050819397, 0.11676602810621262, 0.40149980783462524, 0.06972489506006241, -0.3217960298061371, -0.24279442429542542, 0.8258644938468933, 0.06080785393714905, -1.1709320545196533, 0.1732347458600998, 0.41681259870529175, 0.08230020850896835, -0.6541902422904968, -0.7759699821472168, 0.6125349998474121, 0.5073596835136414, 0.1250046044588089, 0.5625694990158081, 0.19147206842899323, 0.4223398268222809, -0.4101001024246216, 0.24069716036319733, -0.3298714756965637, -0.7459102869033813, 0.3439129590988159, -0.37202557921409607, -0.2879524528980255, 0.1436588317155838, 0.18953761458396912, -0.007383547257632017, -0.08500102907419205, 0.4262709319591522, 0.09089615941047668, -0.6923995018005371, -0.5527346134185791, 0.4471951127052307, 0.49828970432281494, -0.6272228956222534, -0.08998481184244156, 0.2672037184238434, 0.07995537668466568, -0.5037264227867126, -0.15465833246707916, 0.051109567284584045, 0.28986549377441406, -0.10099834203720093, 1.1209015846252441, -1.0182545185089111, 0.21848748624324799, 0.7023954391479492, -0.08408387005329132, -0.8127233982086182, -0.0774773508310318, -1.2020353078842163, 0.4090803265571594, -0.04092371463775635, 0.14523403346538544, -1.1352146863937378, 0.24576175212860107, 0.4811021089553833, 0.059282559901475906, -0.13528873026371002, -1.2777509689331055, -0.49476125836372375, -0.1587248295545578, -0.7469022274017334, 0.019554737955331802, -0.09605254232883453, -0.2401610165834427, -0.3061903715133667, 0.35920172929763794, 0.7116315960884094, 0.25556501746177673, -0.8426913022994995, 0.12237381935119629, -0.37147676944732666, 0.5143773555755615, -1.0065498352050781, -0.9015935659408569, -1.0761241912841797, 0.25828713178634644, -1.295509696006775, -0.2428118884563446, -0.5022489428520203, -0.7997756004333496, 0.047188516706228256, -0.8915732502937317, -0.28821009397506714, 0.793502926826477, -0.24149173498153687, -0.36018404364585876, 0.03433086723089218, -0.49772918224334717, 0.8095260262489319, 0.3119366466999054, -0.679819643497467, 0.11486882716417313, 0.5121816396713257, 0.4958062767982483, 0.8729338645935059, 0.9095534086227417, -0.6683233976364136, -0.6167543530464172, -0.9108527302742004, 0.3898000419139862, -0.5633252263069153, -0.0532483346760273, -1.0385688543319702, 0.5255824327468872, 0.3042609989643097, 0.4456961452960968, 0.2565537095069885, 0.04529166966676712, -1.293491244316101, -0.45979079604148865, 0.9032948017120361, -0.6200010180473328, 0.3463045060634613, 0.016874318942427635, -0.0010236215312033892, 0.2966670095920563, 0.6740075945854187, 0.42912691831588745, -0.6312555074691772, -0.146825909614563, 0.5693032741546631, -0.6288452744483948, 0.20044776797294617, -0.23873504996299744, 0.15379396080970764, -0.939657986164093, -0.39363282918930054, -0.19675937294960022, 0.1724098175764084, -0.43496406078338623, 0.7959376573562622, -0.04400932043790817, -1.4978840351104736, 0.713402509689331, -0.13371320068836212, -0.20177419483661652, -0.582942545413971, 0.21547140181064606, -0.002620689570903778, -0.4565746784210205, 0.46862852573394775, 0.3742925226688385, -0.24300725758075714, -0.2518525719642639, -0.05022918060421944, 1.0125596523284912, -0.3606851100921631, -0.3275868594646454, 0.6939774751663208, -0.4143376350402832, -1.1869646310806274, 0.34883418679237366, -1.023034691810608, 0.19700504839420319, -0.17256063222885132, 0.04789714515209198, 0.5204198956489563, -0.15010850131511688, 0.6827183365821838, -0.13791407644748688, 0.3575073182582855, 0.5353512167930603, -0.3682318329811096, 0.34473955631256104, -0.555568516254425, 0.2781662940979004, 1.190234661102295, 0.9453398585319519, -0.9723219871520996, -1.0734870433807373, -0.7939856052398682, -0.02465321309864521, -0.2568463683128357, 0.25152474641799927, 0.164814293384552, -1.0744343996047974, 0.5368334650993347, 1.5682212114334106, 0.2595716714859009, -0.005444440990686417, -0.35931870341300964, -0.19821994006633759, 0.5510912537574768, 0.2523984909057617, -1.092897891998291, -0.1448303461074829, 0.8260635733604431, 0.986158549785614, -0.7038509845733643, 0.709289014339447, 0.3024621903896332, -0.5188177824020386, 0.7931938767433167, 0.1746671348810196, -0.32251495122909546, 0.78525710105896, -0.4559914469718933, -0.05213792249560356, 0.01990632340312004, -0.7639505863189697, -0.5507107973098755, 0.8598030805587769, 0.08052531629800797, -0.07311861962080002, 0.23184636235237122, 0.21281610429286957, 0.47746190428733826, -0.3661608099937439, -0.08567363768815994, 0.44586682319641113, 0.39133894443511963, -0.263954758644104, 0.40010353922843933, 0.13126184046268463, 0.6303027272224426, -1.1498934030532837, -0.1539640724658966, 0.45503872632980347, 1.0987399816513062, -0.20744027197360992, 0.2476060390472412, 1.0928235054016113, -0.1708040088415146, 0.4120573401451111, 0.48958534002304077, 0.3009383976459503, -0.005633223801851273, 0.12521976232528687, -0.2226445972919464, -0.8736886382102966, 0.032301656901836395, -0.3959059417247772, -0.5790775418281555, -0.1313575953245163, -0.6782863140106201, -0.2090841382741928, 0.042316991835832596, 0.7564180493354797, 0.8978040218353271, -0.04930838197469711, 0.9530659914016724, 0.23085685074329376, -0.44138431549072266, -0.5366609692573547, -0.7465454339981079, 0.32662099599838257, -0.21310880780220032, -0.10513181984424591, -0.39544573426246643, -0.5446471571922302, -0.707872211933136]}, "authors": [{"authorId": "50561307", "name": "J. Zhang"}, {"authorId": "2145536854", "name": "Haochuan Li"}, {"authorId": "3072326", "name": "S. Sra"}, {"authorId": "1688304", "name": "A. Jadbabaie"}], "references": [{"paperId": "c5fe21d1d7ca0d315c01d74edf20675f7dde1cc6", "title": "The Limiting Dynamics of SGD: Modified Loss, Phase-Space Oscillations, and Anomalous Diffusion"}, {"paperId": "e5b790f633e15ac672a93f54cd9beaa46a369857", "title": "On the Periodic Behavior of Neural Network Training with Batch Normalization and Weight Decay"}, {"paperId": "026bb8a1066f50ddc8797e1341353603149a8cb8", "title": "Gradient Descent on Neural Networks Typically Occurs at the Edge of Stability"}, {"paperId": "6e6ca188d33feeb632c168ccbd53990b35201392", "title": "On the Reproducibility of Neural Network Predictions"}, {"paperId": "f058b9ad5b8cf14988b25590f849518cd033c570", "title": "No-regret learning and mixed Nash equilibria: They do not mix"}, {"paperId": "7dfac3bf747fefc62f5bdaa124a609992a18b974", "title": "Reconciling Modern Deep Learning with Traditional Optimization Analyses: The Intrinsic Learning Rate"}, {"paperId": "f5a626a4f296bc84e07897e8e6116c6c52bfa361", "title": "Stochastic Optimization with Non-stationary Noise"}, {"paperId": "71065d3de6d962596915d3b91d981d7871a3fc68", "title": "On the Impossibility of Global Convergence in Multi-Loss Optimization"}, {"paperId": "1448562ccd5bf4bab01d4cae4b2e4549ad3b8e8a", "title": "Lower bounds for non-convex stochastic optimization"}, {"paperId": "285bff5a564cb7edfb355a2ffb44994386975f1d", "title": "On Model Stability as a Function of Random Seed"}, {"paperId": "763c7a66be643bfeec7956c0aa1a2baf9bbc3146", "title": "On the convergence of single-call stochastic extra-gradient methods"}, {"paperId": "855f943165013e0897b9f2bc54f6748ba08aef2a", "title": "Stochastic Gradient and Langevin Processes"}, {"paperId": "e658741baefd2c4da4742bb43155f69d4cbd79fa", "title": "Why Gradient Clipping Accelerates Training: A Theoretical Justification for Adaptivity"}, {"paperId": "1db0abda41d464ad4fddadc099ec1cff126b548c", "title": "Vortices Instead of Equilibria in MinMax Optimization: Chaos and Butterfly Effects of Online Learning in Zero-Sum Games"}, {"paperId": "2151cc3fcf890ee6b04dd529f0d5a6bcb1237294", "title": "Game dynamics as the meaning of a game"}, {"paperId": "fa260bd84ebb6e87fdba500d12b08e8c643f1b02", "title": "Mean-field theory of two-layers neural networks: dimension-free bounds and kernel limit"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "21a73d98621927896664ddf358a60cebf3e849fc", "title": "On the Ineffectiveness of Variance Reduced Optimization for Deep Learning"}, {"paperId": "0572951adde832f6f84e26b5fb87da8e1d1ebca5", "title": "SPIDER: Near-Optimal Non-Convex Optimization via Stochastic Path Integrated Differential Estimator"}, {"paperId": "7a84a692327534fd227fa1e07fcb3816b633c591", "title": "Neural Tangent Kernel: Convergence and Generalization in Neural Networks"}, {"paperId": "9c7de616d16e5643e9e29dfdf2d7d6001c548132", "title": "On the Global Convergence of Gradient Descent for Over-parameterized Models using Optimal Transport"}, {"paperId": "c983653841b6987d9959318f074a595783838576", "title": "On the Convergence of Adam and Beyond"}, {"paperId": "3b0d7003a201150844cb73e75b4f16836a5d5200", "title": "Lower bounds for finding stationary points I"}, {"paperId": "33690ff21ef1efb576410e656f2e60c89d0307d6", "title": "Deep Reinforcement Learning that Matters"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "b47e4c6de3050d5582187208186eda7d32a27005", "title": "How SGD Selects the Global Minima in Over-parameterized Learning : A Dynamical Stability Perspective"}, {"paperId": null, "title": "An example of non convergence of birkhoff sums"}, {"paperId": null, "title": "The heavytail phenomenon in sgd"}]}