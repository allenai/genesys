{"paperId": "0822f8d7e6a72a65e65f147d3a8d8fccd485da40", "abstract": "Increasing the input length has been a driver of progress in language modeling with transformers. We identify conditions where shorter inputs are not harmful, and achieve perplexity and efficiency improvements through two new methods that decrease input length. First, we show that initially training a model on short subsequences before moving on to longer ones both reduces overall training time and, surprisingly, substantially improves perplexity. Second, we show how to improve the efficiency of recurrence methods in transformers, which let models condition on previously processed tokens when generating sequences that exceed the maximal length the transformer can handle at once. Existing methods require computationally expensive relative position embeddings; we introduce a simple alternative of adding absolute position embeddings to queries and keys instead of to word embeddings, which efficiently produces superior results. We show that these recurrent models also benefit from short input lengths. Combining these techniques speeds up training by a factor of 1.65, reduces memory usage, and substantially improves perplexity on WikiText-103, without adding any parameters.", "venue": "Annual Meeting of the Association for Computational Linguistics", "year": 2021, "citationCount": 75, "influentialCitationCount": 9, "openAccessPdf": {"url": "https://aclanthology.org/2021.acl-long.427.pdf", "status": "HYBRID"}, "tldr": {"model": "tldr@v2.0.0", "text": "This work identifies conditions where shorter inputs are not harmful, and achieves perplexity and efficiency improvements through two new methods that decrease input length, and shows how to improve the efficiency of recurrence methods in transformers."}, "embedding": {"model": "specter_v2", "vector": [0.09779541194438934, 0.3753569722175598, -0.2662593126296997, -0.13256578147411346, -0.12380212545394897, -0.5189821124076843, 0.6301373243331909, -0.27402421832084656, -0.7058959007263184, -0.3351304829120636, 0.7645888924598694, -0.28318509459495544, 0.3810855746269226, 0.17616106569766998, -0.0009499493171460927, 0.20991148054599762, -0.7448926568031311, 0.22144968807697296, -0.20775334537029266, -0.20499232411384583, -0.21885886788368225, -0.4252529442310333, -0.9824804663658142, 0.029960907995700836, 0.061529453843832016, -0.025734353810548782, 0.2710120379924774, 0.8367616534233093, -0.6388193964958191, 0.5466951727867126, 0.3813500702381134, -0.2247486114501953, 0.08018534630537033, -0.017504163086414337, -0.3364448547363281, -0.5494238138198853, 0.3603963553905487, -0.24766018986701965, -0.36657580733299255, 0.32668718695640564, -0.41434383392333984, 0.3918755352497101, 0.10750547796487808, -0.6981160044670105, -0.16736117005348206, 1.4289679527282715, 0.7800145149230957, 0.6720401048660278, -0.09021997451782227, -0.5279093980789185, 1.6380492448806763, -1.2520650625228882, 0.49120834469795227, 1.3417516946792603, 0.6847761273384094, 0.3085983097553253, -0.22580082714557648, -0.7291310429573059, 0.8967433571815491, -0.06164313852787018, -0.8197076320648193, -0.4889051020145416, -0.222272589802742, 0.03810340166091919, 2.1390576362609863, -0.07651115953922272, 0.0987018421292305, 0.6093863248825073, -0.17169667780399323, 1.2467952966690063, -0.2794296145439148, -0.6741459965705872, -0.774613082408905, 0.16612569987773895, 0.48988446593284607, 0.7285380959510803, -0.5543926954269409, 0.3917398154735565, -0.7157993912696838, -0.042035073041915894, 0.5441544055938721, 0.34147948026657104, -0.21816477179527283, 0.0903058722615242, -0.588516354560852, 0.5129944086074829, 0.24732957780361176, 1.132277250289917, -0.2694445848464966, 0.8354384303092957, 0.26143190264701843, 0.5095662474632263, -0.038189467042684555, 0.34330880641937256, -0.27727070450782776, 0.10645568370819092, -0.778030276298523, 0.41287532448768616, -0.022651653736829758, 0.558735728263855, -0.2647898495197296, 0.3597570061683655, -0.5281738042831421, 0.10897042602300644, 1.364136815071106, 0.03627997636795044, 0.5277822017669678, -0.8272983431816101, 0.3198215961456299, -0.7723237872123718, 0.09405576437711716, -0.30142098665237427, -0.3575025498867035, -0.2799428403377533, -0.252469927072525, -1.6426829099655151, -0.12210060656070709, 0.3351688086986542, -0.8010733127593994, 0.9246399998664856, -0.5133763551712036, 0.45431867241859436, 0.2504608929157257, 0.3230203688144684, 0.5097718834877014, 0.9044285416603088, 0.41243046522140503, -0.030481619760394096, 0.6746164560317993, -0.7583614587783813, -0.48626092076301575, -0.9227221608161926, 1.3264209032058716, -0.17652802169322968, 0.2988346815109253, -0.24808962643146515, -0.9700254201889038, -0.8163422346115112, -0.7067485451698303, 0.03767356276512146, -0.8267475962638855, 0.2215813398361206, 0.9367623925209045, 0.47694745659828186, -1.1441069841384888, 0.8917656540870667, -0.3330250084400177, -0.44077038764953613, -0.2460482269525528, -0.19201074540615082, 0.1504243165254593, -0.5035055875778198, -1.3594883680343628, 0.20847350358963013, 0.05243644118309021, -0.607128381729126, 0.09981213510036469, -1.0643712282180786, -1.324297308921814, -0.14023816585540771, 0.0909491553902626, -0.32842501997947693, 1.4098596572875977, 0.12064262479543686, -1.1791707277297974, 0.6545872688293457, -0.48958632349967957, 0.15018509328365326, 0.15876290202140808, -0.3531859517097473, -0.6577725410461426, -0.8051608204841614, -0.2030283361673355, 0.191489577293396, 0.047640956938266754, -0.05501263216137886, -0.03490307182073593, -0.02793414331972599, -0.2571091949939728, -0.27835845947265625, -0.09981393814086914, 1.0961048603057861, -0.1885068118572235, -0.4396924376487732, 0.25114113092422485, 0.7245992422103882, -0.36912617087364197, -0.37963929772377014, -0.15202151238918304, -1.2053223848342896, 0.5253982543945312, -0.16827508807182312, 1.089624285697937, -0.7823666930198669, -0.6427159905433655, -0.16172723472118378, -0.2236628532409668, -0.03599005937576294, -1.0425899028778076, 1.0982235670089722, -0.7648824453353882, 0.7635201215744019, 0.085569828748703, -1.2944401502609253, 0.012057879939675331, 0.19253331422805786, -0.9526673555374146, -0.36152389645576477, -0.011531365104019642, 1.1229029893875122, -1.0125020742416382, 0.12085673213005066, -0.0346202477812767, 0.19224897027015686, -0.656019926071167, 1.1032136678695679, -0.23470517992973328, -0.11129946261644363, 0.26503151655197144, -0.38844841718673706, 0.1397789865732193, -0.09141316264867783, 0.33301880955696106, -0.25563567876815796, -0.669522762298584, 0.6886508464813232, -0.389457106590271, 1.2757512331008911, -0.39887693524360657, 0.017723793163895607, -0.29278093576431274, -0.5215296149253845, 0.0031375715043395758, 0.19911085069179535, 0.07592600584030151, -0.561450183391571, -0.12565816938877106, 0.3892151415348053, -0.7083662152290344, 0.12272477895021439, 0.6653134226799011, 0.7009071111679077, -0.3193694055080414, 0.43117639422416687, 0.5569098591804504, 0.03312905132770538, 0.6914782524108887, 0.5826518535614014, 0.6623138189315796, 0.46924540400505066, 0.06449141353368759, 0.3639659285545349, 0.09052852541208267, -0.9048239588737488, 0.24011535942554474, 0.6047576665878296, 0.970724880695343, 0.6654792428016663, 0.24512135982513428, -0.5143461227416992, -0.508752167224884, -0.0175889004021883, 0.7825237512588501, 1.613042950630188, -0.503668487071991, -0.6682004928588867, -0.2563322186470032, -0.18610328435897827, -0.12039704620838165, 0.2487865835428238, -0.12051122635602951, 0.06709124147891998, -0.9714459776878357, -0.6718651056289673, 1.0495864152908325, 0.5778936147689819, 0.391975075006485, -0.5226152539253235, -0.3762192130088806, -0.2577177882194519, 0.1830843985080719, -0.6455475687980652, -0.4833921492099762, 0.3231305181980133, -0.6500532627105713, -0.20465894043445587, -0.19291822612285614, -0.2024129182100296, -0.06423844397068024, -0.5951899886131287, 0.8310380578041077, -0.17902076244354248, -0.4461958706378937, 0.12114480137825012, 0.2945939600467682, -0.4774078130722046, -0.6127375960350037, 0.17355287075042725, 0.22677648067474365, -0.5860702991485596, 0.1462693214416504, 0.4509045481681824, 0.38199755549430847, -0.09894364327192307, -0.5273585915565491, 0.2922585904598236, 0.030435366556048393, -0.03318221867084503, 0.41160842776298523, -0.45688676834106445, -0.08700494468212128, -1.3113890886306763, 0.5608987808227539, 0.21975818276405334, -0.4550631642341614, 0.43839049339294434, -0.8630326390266418, -0.11836931109428406, 0.6118351221084595, -0.48611295223236084, 0.02439098432660103, -0.9850599765777588, 0.18133853375911713, -0.32177549600601196, -0.04856821894645691, 0.6657810807228088, 0.34690964221954346, 0.6854720711708069, -0.24049429595470428, 0.6705288290977478, 0.5555672645568848, -0.5258108377456665, 0.6192104816436768, -0.7731235027313232, 0.18988677859306335, 0.5533921718597412, 0.26639384031295776, -0.588550865650177, -0.27353981137275696, -0.9127081632614136, -0.08836610615253448, -0.6831215023994446, -0.3163219392299652, -0.16083694994449615, -0.21387039124965668, -0.26955026388168335, -0.7641183137893677, 0.05533168092370033, -1.17581307888031, -0.27627062797546387, 0.1933024674654007, -0.27165383100509644, 0.15897318720817566, -0.969026505947113, -1.2621887922286987, -0.8107668161392212, -0.36187079548835754, -0.5632379651069641, 0.286246120929718, -0.09030664712190628, -0.5729135870933533, -0.44684848189353943, 0.38474833965301514, -0.4179477095603943, 0.7705025672912598, -0.7051488161087036, 0.9097328782081604, -0.06655700504779816, -0.19392424821853638, -0.15322646498680115, 0.3983812630176544, 0.4087991714477539, -0.14414279162883759, 0.5507793426513672, -0.47429993748664856, 0.19489282369613647, -0.7462009191513062, -0.1566486656665802, 0.4075791537761688, -0.0037605089601129293, 0.5561351180076599, -0.28138142824172974, -0.6674458384513855, 0.19458729028701782, 1.2296432256698608, -0.4930148124694824, 0.3837377727031708, -0.23426590859889984, 0.8956357836723328, 0.4458756744861603, -0.18878857791423798, 0.4477371275424957, 0.42284291982650757, 0.25884369015693665, -0.23866496980190277, -0.07159386575222015, 0.06901093572378159, -0.8073122501373291, 0.6742339730262756, 1.6711320877075195, 0.33094489574432373, -0.11677086353302002, -1.12274169921875, 0.6906570792198181, -1.1729029417037964, -1.0114983320236206, 0.42928940057754517, 0.5878731608390808, 0.49072471261024475, -0.7772941589355469, -0.11526965349912643, 0.03512760251760483, -0.12854906916618347, 0.6761465668678284, -0.1682358682155609, -0.5790145993232727, -0.056570783257484436, 0.6976195573806763, 0.3181091248989105, 0.7726091146469116, 0.15307477116584778, 0.7605143785476685, 15.096501350402832, 0.41163110733032227, -0.3451349139213562, 0.42518749833106995, 0.3063550591468811, -0.07131125032901764, -0.7130836844444275, -0.05922594666481018, -1.2714818716049194, 0.0273237694054842, 1.2825769186019897, -0.11273184418678284, 0.6204108595848083, -0.10240137577056885, 0.569646954536438, 0.1377166509628296, -0.5325754880905151, 0.8109408617019653, 0.4040607810020447, -1.1712247133255005, 0.4426386058330536, 0.0816270112991333, -0.15067675709724426, 0.48563340306282043, 0.7537046074867249, 0.8196032047271729, 0.6158907413482666, -0.7176893353462219, 0.4929415285587311, 0.6920273900032043, 0.6201278567314148, -0.30959030985832214, 0.4243759512901306, 0.5948818922042847, -0.9134737849235535, -0.18922586739063263, -0.3638366162776947, -1.1251509189605713, 0.24788600206375122, 0.1384497433900833, -0.8538185358047485, -0.26500287652015686, -0.18036103248596191, 1.135870099067688, 0.055075302720069885, 0.2954927980899811, 0.041869815438985825, 0.7318034768104553, -0.19087448716163635, -0.17697884142398834, 0.3342418372631073, 0.22940073907375336, 0.05295595899224281, 0.11132030934095383, 0.19072751700878143, 0.09764133393764496, 0.191578209400177, 0.3946476876735687, -0.26042667031288147, 0.11154526472091675, -0.593501091003418, -0.8623502850532532, 0.10191786289215088, 0.5416405200958252, 0.6121717095375061, 0.30277344584465027, -0.0957685112953186, 0.2625148296356201, 0.5434189438819885, 0.3829985558986664, -0.20585979521274567, -0.16785593330860138, 0.8007368445396423, -0.024993058294057846, -0.1786760836839676, 0.25964483618736267, 0.09251626580953598, -0.26957589387893677, -0.8768247961997986, -0.24539001286029816, 0.6362968683242798, -0.8625147342681885, -0.4755993187427521, 0.642894983291626, -0.3412436544895172, -0.2888346314430237, -0.17744052410125732, -1.0156408548355103, -0.16852277517318726, 0.8515551686286926, -1.2507400512695312, -0.6176483631134033, 0.3026827275753021, -0.3984743654727936, -0.33280351758003235, 0.5056000351905823, 1.4705034494400024, 0.07881046086549759, -0.6640522480010986, 0.03786537051200867, 0.2209370732307434, 0.06237144395709038, -0.2154255360364914, -0.6049904823303223, 0.7737962603569031, 0.34997186064720154, 0.07417265325784683, 0.7715674042701721, 0.07636945694684982, 0.016912255436182022, -0.7269043922424316, -0.10002217441797256, 1.2699108123779297, -0.9564140439033508, -0.24657629430294037, -0.7907349467277527, -0.6596694588661194, 0.6084526181221008, 0.17671486735343933, -0.6720240712165833, 0.5478331446647644, 0.16346682608127594, -0.6785959601402283, -0.3902597725391388, -0.33562517166137695, 0.07965487241744995, 0.9214928150177002, -0.8743356466293335, -0.13890212774276733, -0.16417551040649414, 0.6393337249755859, -0.6665417551994324, -0.40551263093948364, -0.19630010426044464, 0.2723710536956787, 0.26353585720062256, 0.8435606360435486, -0.7959598898887634, 0.505638599395752, 0.8715507984161377, -0.035663262009620667, -0.8798701167106628, -0.0992463082075119, -0.7297677993774414, 0.19664998352527618, 0.10118057578802109, 0.8596473336219788, -0.5428571701049805, 0.1484324336051941, 0.6191756725311279, 0.3780011832714081, -0.41793331503868103, -0.4448951780796051, -0.5759314298629761, 0.023980403319001198, -0.5985198616981506, 0.35782375931739807, 0.15220676362514496, 0.10654707998037338, -0.01923096925020218, 0.5332881212234497, 0.4623297452926636, -0.4787497818470001, -0.8765432834625244, 0.2592696249485016, -0.3465534746646881, 0.15567812323570251, -0.663602352142334, -0.46733421087265015, -1.362444281578064, 0.21763165295124054, -1.083150029182434, -0.05289408192038536, -1.2131541967391968, -0.6843916773796082, -0.23861491680145264, -0.33754631876945496, 0.29719674587249756, 0.463017076253891, -0.5499505400657654, -0.5300514101982117, -0.6930041313171387, -0.342132568359375, 0.5322943329811096, 0.6243926286697388, -0.5766148567199707, 0.21406136453151703, -0.1134931892156601, 0.22947362065315247, -0.2652682662010193, 0.3160252571105957, -0.39654579758644104, -0.8460522890090942, -1.3686648607254028, 0.6618175506591797, -0.06156511604785919, -0.11632755398750305, -0.28278881311416626, 0.45160889625549316, 0.09010009467601776, -0.17414920032024384, -0.29338884353637695, 0.3142871558666229, -0.45411381125450134, 0.04019700735807419, 0.37470653653144836, -0.7490666508674622, 0.7511855959892273, -0.03744346275925636, -0.7482936382293701, 0.13261154294013977, 0.6314510703086853, -0.312360942363739, -1.2363675832748413, -0.6976528763771057, 0.4754824936389923, -0.8181626200675964, -0.20762962102890015, -0.4181431233882904, -0.3371334671974182, -0.8552960753440857, -0.28923165798187256, -0.009996871463954449, 0.48978692293167114, -0.2039872407913208, 1.3136118650436401, 0.5804557204246521, -0.9006420373916626, 0.07847276329994202, 0.27542421221733093, 0.011371953412890434, -0.3559398055076599, 0.18836534023284912, 0.4176027476787567, -0.20840628445148468, 0.7553209066390991, 0.4045940935611725, 0.33519044518470764, -1.3730902671813965, -0.17524567246437073, 0.7048109173774719, -0.6089296936988831, -0.08678975701332092, 1.2443326711654663, -0.6099588871002197, -1.181574821472168, 0.22130204737186432, -1.5029401779174805, -0.7059783935546875, -0.18673788011074066, 0.7609913349151611, 0.21788974106311798, 0.027649428695440292, -0.2761175334453583, -0.5877673029899597, -0.0018519527511671185, -0.18733733892440796, -0.5799434185028076, 0.8628110885620117, -0.08766971528530121, -0.42407655715942383, 1.014815092086792, 0.8700466752052307, -0.6094101667404175, -0.21380408108234406, -0.72724848985672, -0.23149950802326202, -0.08775261789560318, 0.11980041861534119, -0.39428144693374634, -0.30618029832839966, 0.6410093307495117, 0.20450405776500702, 0.2519821226596832, -0.35987573862075806, -0.044491253793239594, 0.2785733938217163, 0.6533608436584473, 0.21811209619045258, -0.5434119701385498, -0.40610021352767944, 1.6857125759124756, 1.33387291431427, -0.38680702447891235, -0.09186108410358429, -0.12779173254966736, -0.516281247138977, 0.7365061640739441, 0.29136884212493896, 0.355477899312973, 0.8127880692481995, 0.019777409732341766, 0.6143457293510437, 0.18723727762699127, -1.058489441871643, -0.24502746760845184, 0.4141172468662262, 1.054280161857605, 0.9918913245201111, 0.20949368178844452, 0.11493487656116486, 1.034034252166748, -0.16585862636566162, 0.02580866403877735, 0.2709643244743347, 0.6616133451461792, 0.03915739059448242, -0.348959356546402, 0.2546210289001465, 0.5915691256523132, -0.4128217101097107, -0.7537214756011963, -0.12065104395151138, 0.4273352026939392, 0.18629790842533112, 0.45361950993537903, 0.9651473164558411, 0.2664344906806946, 0.7036694288253784, 0.5764235854148865, 0.5122032761573792, -0.6389299035072327, -0.23652653396129608, -0.5416872501373291, -0.3449392318725586, -0.44963300228118896, -0.012515886686742306, -0.6270647644996643, -0.444028377532959, -0.42928460240364075, 0.3845708966255188, 0.0711783692240715, 0.14482294023036957, 1.0309151411056519, 0.538381040096283, 0.31969842314720154, -0.09594464302062988, -0.1640174835920334, -0.5264098644256592, -1.0917857885360718, -0.1580013483762741, -0.42601534724235535, -0.16065073013305664, 0.06639532744884491, -0.11328975111246109, -0.3094779849052429]}, "authors": [{"authorId": "40170001", "name": "Ofir Press"}, {"authorId": "144365875", "name": "Noah A. Smith"}, {"authorId": "35084211", "name": "M. Lewis"}], "references": [{"paperId": "7e5709d81558d3ef4265de29ea75931afeb1f2dd", "title": "Efficient Transformers: A Survey"}, {"paperId": "8256f48f759cf85044db251cc512f965834945b3", "title": "Rethinking Positional Encoding in Language Pre-training"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "657329c633709dd1ac34a30d57341b186b1a47c2", "title": "Efficient Content-Based Sparse Attention with Routing Transformers"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "3ff8d265f4351e4b1fdac5b586466bee0b5d6fff", "title": "Improving Transformer Models by Reordering their Sublayers"}, {"paperId": "7be8c119dbe065c52125ee7716601751f3116844", "title": "Generalization through Memorization: Nearest Neighbor Language Models"}, {"paperId": "395de0bd3837fdf4b4b5e5f04835bcc69c279481", "title": "BART: Denoising Sequence-to-Sequence Pre-training for Natural Language Generation, Translation, and Comprehension"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "f4238bd2385a52413ccbacfd9e409a650235bd13", "title": "Adaptive Attention Span in Transformers"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "d170bd486e4c0fe82601e322b0e9e0dde63ab299", "title": "Adaptive Input Representations for Neural Language Modeling"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "424aef7340ee618132cc3314669400e23ad910ba", "title": "Tying Word Vectors and Word Classifiers: A Loss Framework for Language Modeling"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "63e39cdf1ad884da6bc69096bb3413b5b1100559", "title": "Using the Output Embedding to Improve Language Models"}, {"paperId": "0e6824e137847be0599bb0032e37042ed2ef5045", "title": "Aligning Books and Movies: Towards Story-Like Visual Explanations by Watching Movies and Reading Books"}, {"paperId": "8de174ab5419b9d3127695405efd079808e956e8", "title": "Curriculum learning"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "Add the position embedding of each index to the token at that index: X = X + P"}, {"paperId": null, "title": "Feed X through each transformer layer"}, {"paperId": null, "title": "Total time it takes to train each model, as a fraction of the time it takes to train the baseline"}]}