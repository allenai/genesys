{"paperId": "52ba35523e01b1146f2519ca31bab52c4a54fe74", "abstract": "Deriving formal bounds on the expressivity of transformers, as well as studying transformers that are constructed to implement known algorithms, are both effective methods for better understanding the computational power of transformers. Towards both ends, we introduce the temporal counting logic $\\textbf{K}_\\text{t}$[#] alongside the RASP variant $\\textbf{C-RASP}$. We show they are equivalent to each other, and that together they are the best-known lower bound on the formal expressivity of future-masked soft attention transformers with unbounded input size. We prove this by showing all $\\textbf{K}_\\text{t}$[#] formulas can be compiled into these transformers. As a case study, we demonstrate on paper how to use $\\textbf{C-RASP}$ to construct simple transformer language models that, using greedy decoding, can only generate sentences that have given properties formally specified in $\\textbf{K}_\\text{t}$[#].", "venue": "arXiv.org", "year": 2024, "citationCount": 3, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "It is proved that all $\\textbf{K}_\\text{t}$[#] formulas can be compiled into these transformers, and that together they are the best-known lower bound on the formal expressivity of future-masked soft attention transformers with unbounded input size."}, "embedding": {"model": "specter_v2", "vector": [0.9266630411148071, 1.4432624578475952, -0.5053648352622986, -0.040715113282203674, -0.7270188331604004, -0.416294664144516, 0.7550981044769287, -0.38983485102653503, -0.122903011739254, -0.35804635286331177, 0.39596524834632874, -0.20712769031524658, 0.34323588013648987, -0.1402055323123932, -0.11322936415672302, 0.12552763521671295, -0.9229114651679993, 0.15647006034851074, 0.4029833674430847, -0.24873988330364227, -0.21277692914009094, -0.772820770740509, -1.1479579210281372, 0.3845866620540619, 0.05610613152384758, 0.889191746711731, -0.5747491717338562, 0.7594417333602905, -0.18251709640026093, 0.9436390399932861, 0.4678137004375458, -0.6271474957466125, 0.3577452600002289, 0.43964508175849915, -0.61860591173172, 0.13183917105197906, 0.04795053228735924, -0.1900589019060135, -0.7105361819267273, 0.8051709532737732, -0.5875564813613892, 0.07155780494213104, -0.08919018507003784, -1.153605580329895, 0.04446995630860329, 1.356091856956482, 0.2766282856464386, 0.6178473234176636, -0.3582068383693695, -0.5512571930885315, 1.6361067295074463, -0.8888550400733948, -0.29820963740348816, 1.0683188438415527, 0.07519955933094025, 0.7500889301300049, -0.3478107154369354, -0.3516451418399811, 0.8143852353096008, 0.34626689553260803, -0.8219563364982605, -0.9437318444252014, -0.19395142793655396, 0.2722475826740265, 1.879091501235962, -0.23905880749225616, -0.08256593346595764, -0.18359147012233734, -0.45822736620903015, 1.3922981023788452, 0.1408567726612091, -1.1689468622207642, -0.3520409166812897, 0.33070138096809387, 0.2644067406654358, 0.9573334455490112, -0.5150964260101318, 0.3701561689376831, -1.1896764039993286, 0.020007217302918434, -0.17395946383476257, -0.11559522151947021, -0.061565104871988297, -0.4714793562889099, 0.0437091700732708, 0.5245568156242371, -0.16715431213378906, 0.7336774468421936, 0.356330007314682, 1.2277277708053589, 0.4662019610404968, 0.41068923473358154, 0.19543519616127014, -0.028521688655018806, -0.34128537774086, 0.3403048515319824, -1.0951991081237793, -0.26512235403060913, -0.0849524736404419, 0.8953713178634644, -0.24306312203407288, 0.34868448972702026, -0.9536203145980835, -0.28936153650283813, 1.2757318019866943, 0.4146419167518616, 0.12552499771118164, -0.8230104446411133, 0.27128851413726807, -0.31413084268569946, 0.13469965755939484, 0.03151138126850128, 0.15985047817230225, 0.0647330954670906, -0.3166320323944092, -1.073980689048767, -0.18578943610191345, 0.3751623034477234, -1.1569633483886719, 1.0455125570297241, -0.6935282945632935, -0.16290879249572754, -0.021073684096336365, 0.33805349469184875, 0.16129548847675323, 0.6849510073661804, 0.22357933223247528, -0.5561262965202332, 1.1366275548934937, -0.3803340792655945, -0.43729984760284424, -1.1703729629516602, 0.7479458451271057, 0.10529773682355881, 0.2349732518196106, 0.13069139420986176, -1.5824079513549805, -0.2916678786277771, -0.8802002668380737, 0.3753848373889923, -0.4591865539550781, 0.11652569472789764, 0.9458460211753845, 1.2444980144500732, -1.622275710105896, 0.156653493642807, -0.563355028629303, 0.02689940296113491, 0.7355044484138489, 0.5383654236793518, 0.29997146129608154, -0.20215661823749542, -1.1529788970947266, 0.5220777988433838, 0.10933686047792435, -0.8624839782714844, -0.439410924911499, -0.42546913027763367, -1.1962473392486572, 0.4285300672054291, 1.0557880401611328, -0.12950362265110016, 1.571160078048706, 0.06907352805137634, -1.3052316904067993, 1.1843349933624268, -0.7576441168785095, -0.4583721458911896, 0.24217170476913452, -0.12453518807888031, -0.5211281180381775, -0.4880872070789337, -0.20547664165496826, -0.044650956988334656, 0.38175591826438904, -0.30707454681396484, -0.5604981780052185, 0.007161903660744429, -0.1790667623281479, -0.454597145318985, -0.40691807866096497, 1.1329203844070435, 0.022956430912017822, 0.24686764180660248, 0.04242738336324692, 0.9577192664146423, -0.16967704892158508, -0.11057836562395096, -0.48828908801078796, -1.2270638942718506, 0.4414663314819336, 0.46405133605003357, 1.3175725936889648, -0.7409763932228088, -0.6372250914573669, 0.018419308587908745, 0.05619533732533455, 0.08466704189777374, -0.4642358720302582, 0.2864868640899658, -0.543260931968689, 0.5928662419319153, -0.2172119915485382, -0.44024983048439026, 0.26026129722595215, -0.372264564037323, -0.9760122895240784, 0.01647414267063141, 0.05671992897987366, 1.028913140296936, -0.2967131435871124, -0.013997809961438179, 0.36566656827926636, -0.1988449990749359, -0.7194010615348816, 1.079771876335144, -0.3992066979408264, -0.17195071280002594, 0.024844065308570862, -0.2704363465309143, -0.11190132796764374, -0.7185121774673462, 0.40983426570892334, -0.022683260962367058, -0.13037274777889252, 0.37318548560142517, -0.21031320095062256, 0.8017182946205139, -0.337050199508667, 0.2842988073825836, -0.011812434531748295, -1.261634111404419, 0.12227575480937958, 0.5655153393745422, -0.16634982824325562, -0.7220606803894043, 0.1917000263929367, 0.026966189965605736, -0.6292374134063721, 0.05832725018262863, 0.2967078685760498, 0.24154555797576904, -0.35705435276031494, 0.3328430652618408, 0.4143684208393097, -0.14332576096057892, 0.3826442062854767, 0.4743238389492035, 0.9561862349510193, 0.053338464349508286, 0.47683122754096985, -0.003936585504561663, 0.8368952870368958, -0.6348350644111633, 0.02915138751268387, 0.5615829229354858, 0.5994293093681335, 0.26436617970466614, 0.5242874622344971, -0.7893510460853577, -0.33975738286972046, -0.09615184366703033, 0.48141852021217346, 1.6584240198135376, -0.140290766954422, -0.4177469313144684, -0.5745586156845093, -0.2620052099227905, -0.6835181713104248, 0.4552447497844696, -0.2007341980934143, -0.4979258179664612, -0.8923923969268799, -1.048194408416748, 0.9664936065673828, 0.6990953087806702, 0.6410656571388245, -0.2917219400405884, -0.31461742520332336, -0.38039565086364746, 0.047543130815029144, -1.034658432006836, -0.27989229559898376, 0.6361162662506104, -0.24045808613300323, -0.13384000957012177, 0.0534580834209919, -0.010805131867527962, 0.2838873863220215, -0.9413758516311646, 0.5513691902160645, -0.49140411615371704, -0.22558696568012238, 0.4204614758491516, 0.7915023565292358, -0.36376476287841797, -0.6128361225128174, 0.1098380833864212, -0.42017149925231934, -0.19311760365962982, 0.5157994031906128, 0.37617048621177673, 0.4714100658893585, 0.18926577270030975, -0.25173163414001465, 0.17722737789154053, -0.05455270782113075, 0.031806521117687225, 0.10171163082122803, 0.07478127628564835, -0.26752790808677673, -1.0861880779266357, 0.30957692861557007, 0.39671826362609863, -0.9040164351463318, 0.6652382016181946, -0.7577768564224243, -0.024607272818684578, 0.4035874903202057, -0.7384544014930725, -0.20811431109905243, -0.6339800357818604, 0.7148697376251221, 0.08421282470226288, 0.22079209983348846, -0.009431136772036552, 0.14653043448925018, 0.25077658891677856, -0.022978728637099266, 0.9010805487632751, 0.024017347022891045, 0.45636415481567383, 0.7510127425193787, -0.9056087732315063, 0.3251289129257202, -0.116635762155056, 0.6150942444801331, -0.03045036457479, 0.15600937604904175, -0.30857178568840027, -0.6073355674743652, -0.10397376120090485, 0.2669880986213684, -0.40907856822013855, -0.18553195893764496, -0.29261499643325806, -1.723288655281067, -0.006407775916159153, -0.8484248518943787, -0.7143539786338806, -0.30214938521385193, -0.9040799140930176, -0.5145987868309021, -1.0859428644180298, -0.9960121512413025, -1.3737317323684692, -0.26002728939056396, -0.8733745217323303, 0.590087890625, 0.005626068450510502, -0.10802501440048218, -0.25290143489837646, -0.3237500786781311, -0.06982166320085526, 1.1542123556137085, -0.721498966217041, 1.2330976724624634, -0.24339811503887177, -0.6625970005989075, -0.1980830281972885, 0.2256462275981903, 0.005492338445037603, -0.5670487284660339, -0.008946694433689117, -1.0900825262069702, 0.2865123748779297, -0.4748455882072449, -0.4030141532421112, 0.11249686777591705, 0.4434792101383209, 1.0947401523590088, -0.3591988682746887, -0.8721190094947815, -0.22336025536060333, 1.3815112113952637, -0.2014513909816742, 0.373868852853775, 0.2688588798046112, 0.5266422629356384, 0.2578905522823334, -0.051405973732471466, 0.4472894072532654, 0.30012014508247375, 0.6082549691200256, 0.16889767348766327, 0.23743148148059845, 0.28874751925468445, -0.33461520075798035, 0.7091407775878906, 0.758916974067688, 0.2830972373485565, -0.18991264700889587, -1.1674261093139648, 0.8557952642440796, -1.417399525642395, -0.8694358468055725, 0.8599206805229187, 1.1168975830078125, 0.41817423701286316, 0.07863239198923111, 0.014069171622395515, 0.7406557202339172, 0.7605573534965515, 0.07050272077322006, 0.11481572687625885, -0.7350834012031555, -0.07216785848140717, 1.1229264736175537, 0.7371165156364441, 0.6817597150802612, -0.1859113872051239, 0.7981337904930115, 14.769354820251465, 1.0267090797424316, 0.1307888776063919, 0.8063218593597412, 0.6632621884346008, -0.010798524133861065, -0.43485909700393677, 0.39595940709114075, -1.1470067501068115, -0.2669236361980438, 1.1230813264846802, -0.24590066075325012, 0.8250059485435486, -0.051457811146974564, -0.3352600038051605, 0.05624527856707573, -0.40733999013900757, 0.0017303327331319451, 0.1793200671672821, -1.0136103630065918, 0.1321697235107422, 0.17170500755310059, -0.1806516796350479, -0.03311702981591225, 0.6951544284820557, 0.7080904245376587, 1.1118557453155518, -0.7911185622215271, 0.7769701480865479, -0.11863040924072266, 1.2520382404327393, -0.013029912486672401, 0.29689592123031616, 0.24472464621067047, -1.1289116144180298, -0.5249939560890198, -0.08683047443628311, -1.291443943977356, 0.2645743489265442, 0.5647438764572144, -0.3492740988731384, -0.7211734056472778, -0.15960268676280975, 0.2185012847185135, 0.6968763470649719, 0.056621186435222626, -0.27629852294921875, 0.7589002251625061, -0.33306053280830383, -0.05421450361609459, -0.5189806222915649, 1.1546558141708374, 0.0570652149617672, -0.445028156042099, 0.23375295102596283, 0.25572288036346436, 0.027748240157961845, 0.21587204933166504, -0.33810725808143616, -0.5073257088661194, -0.19648106396198273, -0.5378429889678955, 0.1827528029680252, 0.8253149390220642, 0.4512426555156708, 0.06498977541923523, -0.3602481484413147, -0.32425111532211304, 0.3284115195274353, -0.07331836968660355, -0.2872824966907501, 0.10566435009241104, 0.2000313699245453, 0.08483043313026428, 0.0547645203769207, 0.8480641841888428, -0.3084062933921814, -0.47513699531555176, -0.6491526961326599, -0.42184746265411377, 0.9321140050888062, -0.7934445738792419, -0.33979466557502747, 0.6691282391548157, -0.2963702380657196, -0.3867418169975281, 0.8853359222412109, -0.7490000128746033, -0.10804383456707001, -0.07679753005504608, -1.2905851602554321, -0.8773163557052612, 0.49698227643966675, 0.07511502504348755, -0.47953808307647705, 0.3274962604045868, 1.168662428855896, -0.34718915820121765, -0.12610456347465515, 0.16883596777915955, -0.8507605195045471, -0.08033256232738495, -0.34793993830680847, -1.040528416633606, 0.6040667295455933, 0.6726921796798706, -0.07893409579992294, 0.3629254698753357, 0.08503785729408264, 0.41229671239852905, -0.7954214215278625, 0.23317407071590424, 1.036363959312439, -1.014303207397461, 0.10880739986896515, -0.7260356545448303, -0.3488539159297943, 0.9766566753387451, 0.33780190348625183, -0.09017357230186462, -0.19445247948169708, 0.009846186265349388, -0.6960768699645996, -0.5346443057060242, -0.8590088486671448, 0.07441005110740662, 0.9132653474807739, -0.7350558638572693, -0.12758490443229675, -0.3849788010120392, 0.04023859649896622, -0.8788608908653259, -0.4569064676761627, 0.23830565810203552, 0.1759766936302185, 0.11300128698348999, 0.6656666398048401, -0.2254418432712555, 0.6183854341506958, 0.46989113092422485, -0.22512860596179962, -0.37161386013031006, -0.26229995489120483, -1.2961562871932983, -0.1654416024684906, 0.5817269086837769, 0.760103166103363, -0.7634332180023193, 0.5067969560623169, 0.9155468940734863, 0.3993843197822571, -0.05635847523808479, -1.0738329887390137, 0.09903202950954437, 0.027514025568962097, -0.6662439107894897, 0.4398070275783539, -0.15806539356708527, 0.6726166605949402, -0.4160010516643524, 0.1457505077123642, 0.8720642328262329, -0.26913461089134216, -0.6245760917663574, 0.0632176399230957, -0.26855894923210144, 0.12644870579242706, -0.7971411943435669, -0.8445873856544495, -0.9482553601264954, 0.09394755214452744, -1.2832043170928955, 0.4932468831539154, -0.6535041332244873, -0.21898230910301208, 0.2623436152935028, -0.11360688507556915, 0.7024341225624084, 0.6424562335014343, -0.383095383644104, -0.8446096181869507, -0.9224249124526978, -0.48967990279197693, 0.32820773124694824, 0.40958720445632935, -1.0440818071365356, 0.747972309589386, 0.33413195610046387, -0.4387979209423065, 0.11909550428390503, 0.43833985924720764, -0.6304217576980591, -0.5142291188240051, -0.7534189820289612, 0.6576603055000305, 0.21909594535827637, -0.1640719622373581, -0.32333892583847046, 0.775555431842804, 0.09780091047286987, -0.3700293302536011, 0.6796702742576599, 0.3884233832359314, -1.1650114059448242, -0.5458354353904724, 0.49576008319854736, -1.2167549133300781, -0.4119335114955902, 0.11459558457136154, -0.7140361070632935, -0.0440034344792366, 0.845108687877655, 0.015078281983733177, -1.0699028968811035, -0.45191648602485657, 0.22115005552768707, -1.180226445198059, 0.19022518396377563, -0.1229139044880867, -0.27186763286590576, -1.5109668970108032, -0.41432926058769226, -0.3548978865146637, 0.4412855803966522, -0.2779993414878845, 0.7125256657600403, -0.04317489638924599, -0.7812361717224121, 0.30468034744262695, 0.0459139421582222, 0.23238354921340942, -0.14388492703437805, 0.1583307832479477, 0.34790220856666565, 0.22121350467205048, 0.4252447485923767, 0.41467592120170593, 0.18816035985946655, -1.027116298675537, 0.016595223918557167, 0.7064751386642456, -0.6459112167358398, -0.17637823522090912, 0.9505606889724731, -0.235192209482193, -0.47506457567214966, 0.14269402623176575, -1.1281203031539917, -0.3039371967315674, -0.7535589337348938, 0.55925452709198, 0.10405872762203217, -0.12967196106910706, 0.3136455714702606, -1.1274768114089966, 0.5772942900657654, 0.09090428054332733, -0.7542376518249512, 0.5514571666717529, -0.12377247959375381, -0.6010991930961609, 0.3571731448173523, -0.023103216663002968, -0.36409443616867065, -0.11247356235980988, -0.9738184213638306, 0.08260168880224228, -0.0642489641904831, 0.2881351113319397, -0.284991592168808, -0.8063312768936157, 0.9584804773330688, 0.4788491725921631, 0.9949016571044922, 0.44358327984809875, 0.10822779685258865, -0.26211708784103394, 0.1511462926864624, 0.7811059951782227, -0.2312362939119339, -0.7538079619407654, 0.7249187231063843, 0.48968926072120667, -0.41829344630241394, 0.12628278136253357, -0.7858012914657593, -0.5649245381355286, 0.7976120114326477, 0.3632374703884125, 0.3192472457885742, 0.5203065276145935, 0.7058271765708923, 0.029529698193073273, 0.2739342749118805, -1.3067758083343506, -0.4869476854801178, 0.37739697098731995, 1.0117241144180298, 0.4942067861557007, 0.31804269552230835, 0.33656296133995056, 1.0017473697662354, 0.01673312857747078, 0.394028902053833, 0.7300137281417847, 0.6576277613639832, -0.5390772223472595, -0.1314285844564438, 0.16895939409732819, 0.7094240784645081, -1.1314444541931152, -0.6210170388221741, 0.07950963824987411, 0.4517514407634735, -0.1686464548110962, 0.9454614520072937, 0.5453361868858337, -0.04994068294763565, 0.2832961678504944, 0.372052937746048, 0.9263237714767456, -0.5029194355010986, 0.13149906694889069, -0.5613693594932556, -0.17768391966819763, 0.14249397814273834, -0.4198276698589325, -0.25221335887908936, -0.22442704439163208, -0.4107031524181366, -0.33811476826667786, 0.15482735633850098, -0.17168954014778137, 1.319732427597046, 0.06721310317516327, 0.4272265136241913, -0.11415781080722809, -0.08473116159439087, -0.1646847128868103, -0.5073525309562683, 0.23738239705562592, -1.2427899837493896, -0.21920743584632874, -0.05185139924287796, -0.23826095461845398, -0.029852569103240967]}, "authors": [{"authorId": "2261279248", "name": "Andy Yang"}, {"authorId": "2295664515", "name": "David Chiang"}], "references": [{"paperId": "09ebb5f26bbecbe3d604af2da3c65fc6f38833d8", "title": "What Formal Languages Can Transformers Express? A Survey"}, {"paperId": "7d4c74a7f0b3a80de37acd77deef97c426c033c3", "title": "Masked Hard-Attention Transformers Recognize Exactly the Star-Free Languages"}, {"paperId": "75c19f3249f644f5cb2182282fc117c089fd3f65", "title": "The Expressive Power of Transformers with Chain of Thought"}, {"paperId": "de34832e7e706e8f54ddc8b4e2ad490a87d5b9ed", "title": "Logical Languages Accepted by Transformer Encoders with Hard Attention"}, {"paperId": "0b1e673aa93698744b09108080b608928afff484", "title": "INTERLEAVING LOGIC AND COUNTING"}, {"paperId": "d078b6e88bc4749f4eb83f289537a88b4aaf54e6", "title": "On the Expressivity Role of LayerNorm in Transformers' Attention"}, {"paperId": "114b733f6fff0c2b4f2b149d2265bc1c7496a3c9", "title": "Tighter Bounds on the Expressivity of Transformer Encoders"}, {"paperId": "a5cc5edcabba4c9c62cfbc3379daa140084a2a24", "title": "Tracr: Compiled Transformers as a Laboratory for Interpretability"}, {"paperId": "a85a0f91474c8848e81393627912341993f6f1d7", "title": "A Logic for Expressing Log-Precision Transformers"}, {"paperId": "0735fb79bf34698c1df4461a05ed51c232c412e4", "title": "Thinking Like Transformers"}, {"paperId": "f10a04a77fd1cd719792de374a60f3fd03f6b944", "title": "Effects of Parameter Norm Growth During Transformer Training: Inductive Bias from Gradient Descent"}, {"paperId": "10c86505de83647c7b4157595ab10f64e97c94ef", "title": "On the Ability and Limitations of Transformers to Recognize Formal Languages"}, {"paperId": "6398cb8f2af1c988a097ed1e1cefb380195edfb8", "title": "(Preprint)"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "9375729d21a344a5ccccd5f53556ddf90b957cd9", "title": "Understanding Deep Neural Networks with Rectified Linear Units"}, {"paperId": "8a32e75f58909253c3c8d465f1dbc1b1002d953b", "title": "An Introduction to Practical Formal Methods Using Temporal Logic"}, {"paperId": "59c12e11cef79f12731bff82ee69884c1e5950ab", "title": "Complexity of modal logics with Presburger constraints"}, {"paperId": "a9d1a3abb90c2ca267257b184562c5ac976b4250", "title": "Hierarchies of Piecewise Testable Languages"}, {"paperId": "aa089be31c15671e5179329513c5c240bf0796e7", "title": "Tight bounds on the complexity of cascaded decomposition of automata"}, {"paperId": "f22f6972e66bdd2e769fa64b0df0a13063c0c101", "title": "Multilayer feedforward networks are universal approximators"}, {"paperId": "beb91dfc9e101903fc2b8fc171c52d5f1c74a583", "title": "On the temporal analysis of fairness"}, {"paperId": "c4cb90a67f45e7cbacb5286e934b309e89843922", "title": "Attention is Turing-Complete"}, {"paperId": null, "title": "A mathematical framework for transformer circuits"}, {"paperId": null, "title": "Temporal Logic , volume 3"}]}