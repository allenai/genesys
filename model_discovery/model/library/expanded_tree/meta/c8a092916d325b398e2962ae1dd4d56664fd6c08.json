{"paperId": "c8a092916d325b398e2962ae1dd4d56664fd6c08", "abstract": "Large language models (LLMs) call for extension of context to handle many critical applications. However, the existing approaches are prone to expensive costs and inferior quality of context extension. In this work, we propose Extensible Embedding, which realizes high-quality extension of LLM's context with strong flexibility and cost-effectiveness. Extensible embedding stand as an enhancement of typical token embedding, which represents the information for an extensible scope of context instead of a single token. By leveraging such compact input units of higher information density, the LLM can access to a vast scope of context even with a small context window. Extensible embedding is systematically optimized in architecture and training method, which leads to multiple advantages. 1) High flexibility of context extension, which flexibly supports ad-hoc extension of diverse context lengths. 2) Strong sample efficiency of training, which enables the embedding model to be learned in a cost-effective way. 3) Superior compatibility with the existing LLMs, where the extensible embedding can be seamlessly introduced as a plug-in component. Comprehensive evaluations on long-context language modeling and understanding tasks verify extensible embedding as an effective, efficient, flexible, and compatible method to extend the LLM's context.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Comprehensive evaluations on long-context language modeling and understanding tasks verify extensible embedding as an effective, efficient, flexible, and compatible method to extend the LLM's context."}, "embedding": {"model": "specter_v2", "vector": [-0.0708596333861351, 0.1316336989402771, -0.5290458798408508, -0.1980533003807068, -0.4263131320476532, -0.21325668692588806, 0.30070096254348755, -0.24375499784946442, -0.7468332052230835, 0.002487221034243703, 0.865555465221405, -0.06140490621328354, 0.6784828901290894, 0.4505082368850708, 0.12452274560928345, 0.18485654890537262, -1.2384194135665894, -0.26675650477409363, -0.22779180109500885, -0.0644432082772255, -0.30506277084350586, -0.466715008020401, -0.6612936854362488, 0.39087793231010437, 0.4005420207977295, 0.1075802743434906, 1.0790724754333496, 0.9737328886985779, -0.6012319326400757, -0.05614888668060303, 0.42684051394462585, -0.22279639542102814, 0.1402193307876587, 0.2828551232814789, 0.018078874796628952, -0.21125970780849457, 0.17217057943344116, -0.8389275670051575, -0.2992684543132782, 0.549421489238739, -0.2955079972743988, 0.3802696168422699, -0.14228351414203644, -0.5592822432518005, -0.36578798294067383, 1.235074758529663, 0.6914724111557007, 0.4067841172218323, -0.4039163589477539, -0.7636452913284302, 1.555269479751587, -1.621459722518921, 0.1492924839258194, 1.2936152219772339, 0.29996737837791443, 0.6968175768852234, -0.15420252084732056, -0.5247745513916016, 1.1934773921966553, 0.002248968230560422, -0.48659467697143555, -0.22522754967212677, 0.13409020006656647, 0.12443047016859055, 2.0127346515655518, -0.3908759355545044, 0.20143045485019684, 0.860967755317688, 0.18241356313228607, 1.3677046298980713, -0.10275319963693619, -1.1938143968582153, -0.25068792700767517, -0.019385436549782753, 0.44086790084838867, 0.3841951787471771, -0.3133564591407776, 0.325250506401062, -0.549016535282135, -0.04314078763127327, 0.30006855726242065, 0.34596529603004456, 0.6685566902160645, 0.14752916991710663, -0.44899213314056396, 0.4791419506072998, 0.2057897299528122, 1.1091833114624023, 0.11356329917907715, 1.048501968383789, 0.7568090558052063, 0.031749363988637924, 0.09446548670530319, 0.270504355430603, -0.2976530194282532, 0.165873721241951, -1.0087839365005493, 0.3291594088077545, -0.34988123178482056, 0.7712351679801941, -0.2851904630661011, 0.056494906544685364, -0.5432799458503723, 0.46017637848854065, 1.30852472782135, 0.05875146761536598, 0.5975013375282288, -0.5379230380058289, 0.6121370196342468, -0.5028737187385559, 0.1930537074804306, -0.49894627928733826, -0.2841441333293915, -0.2264723777770996, -0.6134324073791504, -1.2093305587768555, -0.7574648261070251, -0.08600218594074249, -0.1693027764558792, 1.2212163209915161, -0.135384663939476, 0.5744401812553406, 0.21840699017047882, -0.0288104135543108, 0.310417115688324, 0.8080248236656189, 0.22653743624687195, 0.01727147214114666, 0.9901927709579468, -1.170153260231018, -0.9758877158164978, -1.4637457132339478, 0.993392825126648, -0.2243969440460205, 0.6496672630310059, -0.6699578762054443, -0.6324178576469421, -1.1147738695144653, -1.3898533582687378, -0.009274926967918873, -0.9912950396537781, 0.38245221972465515, 0.7920017242431641, 0.42247435450553894, -0.8252357840538025, 0.8251230120658875, -0.33511021733283997, -0.08618627488613129, -0.2519393861293793, 0.03836468979716301, 0.21220549941062927, -0.4442632496356964, -1.804360270500183, 0.3360174000263214, 0.7876359820365906, -0.3613740801811218, -0.14240950345993042, -0.3807497024536133, -1.4016612768173218, -0.16676512360572815, 0.34377795457839966, -0.4630494713783264, 0.9791392683982849, 0.003924430347979069, -1.3400603532791138, 0.1478109508752823, -0.28516915440559387, 0.36806148290634155, 0.00520101236179471, -0.3970973491668701, -0.9392352104187012, -0.5841324329376221, -0.09607287496328354, 0.41398322582244873, 0.21953074634075165, 0.0516771636903286, -0.3341180682182312, -0.0007318409625440836, -0.1450924128293991, 0.27158376574516296, -0.5726497173309326, 0.8446322083473206, -0.30306363105773926, -0.5320211052894592, -0.053780876100063324, 0.8202942609786987, -0.4127735197544098, -0.4251061677932739, -0.16137856245040894, -0.9280332326889038, 1.391926884651184, -0.0025725795421749353, 1.4952479600906372, -0.8493316173553467, -0.7643327713012695, -0.38263294100761414, -0.0571037121117115, -0.07493093609809875, -1.1169157028198242, 1.0556082725524902, -0.18331515789031982, 0.5220450758934021, 0.1985274851322174, -1.3266074657440186, 0.4225522577762604, 0.03978927433490753, -0.6939584612846375, -0.697084367275238, -0.12831899523735046, 1.0435622930526733, -1.2246592044830322, 0.13586999475955963, 0.1048455685377121, 0.254589319229126, -0.668860912322998, 1.1293617486953735, -0.49594441056251526, -0.15085315704345703, -0.031804706901311874, -0.24790546298027039, -0.13079971075057983, -0.024588529020547867, 0.6851221919059753, -0.0896984413266182, -0.06056923046708107, 0.519328236579895, -0.8275431990623474, 1.509972333908081, -0.9713512063026428, 0.6109745502471924, -0.004948588088154793, -0.07392770051956177, -0.08341763913631439, 0.4364711344242096, -0.31480011343955994, 0.09295579791069031, -0.05049791932106018, 0.2858840823173523, -0.889452338218689, 0.04209243506193161, 1.2550956010818481, 0.792447030544281, -0.5772175192832947, 0.23038609325885773, 0.28919312357902527, 0.2514096796512604, 0.4765545427799225, 0.4865151047706604, 0.36980071663856506, 0.47482600808143616, 0.6949642300605774, 0.18248960375785828, 0.3160606622695923, -1.512421727180481, 0.13021935522556305, 0.33130359649658203, 0.3409993052482605, 0.23154163360595703, 0.3417515754699707, -0.2973300814628601, -0.6090819835662842, 0.31254732608795166, 0.6280013918876648, 1.7442958354949951, -0.26840656995773315, -0.5652977228164673, -0.7950466275215149, -0.6463188529014587, -0.12478349357843399, 0.028517432510852814, -0.15705396234989166, 0.1876838505268097, -0.467991441488266, -0.7388774752616882, 0.8047274947166443, 0.7664370536804199, 0.8748238682746887, -0.5159116387367249, -0.16187456250190735, 0.2533509135246277, 0.050743620842695236, -1.0831903219223022, -0.8864414691925049, 0.18691925704479218, -0.6256428360939026, 0.10948847979307175, 0.49531617760658264, -0.06523781269788742, -0.1270352154970169, -0.7405458092689514, 0.6796613931655884, -0.4685172736644745, -0.16742263734340668, 0.25033658742904663, 0.39568963646888733, -0.2542214095592499, -0.7987586855888367, 0.39920446276664734, 0.4617612361907959, -0.31965699791908264, 0.5139577984809875, 0.8021906614303589, 0.2167976051568985, -0.013811417855322361, -0.3794666528701782, 0.15780699253082275, 0.0767006129026413, 0.28496745228767395, 0.8135855793952942, -0.2047903835773468, 0.5456401705741882, -1.2021880149841309, 0.8669525384902954, 0.05323838070034981, -0.37621626257896423, 0.3831586539745331, -0.5933418869972229, -0.35456767678260803, 0.8415015935897827, -0.6643987894058228, -0.2960755228996277, -1.0238615274429321, 0.25236180424690247, -0.14857926964759827, -0.4225260317325592, 0.3082852363586426, -0.38100454211235046, 0.39474672079086304, -0.29257771372795105, 0.3764234781265259, -0.12796244025230408, -0.1270175576210022, 0.8459625244140625, -0.38372403383255005, -0.028854118660092354, 0.09645901620388031, -0.18767134845256805, -0.4931538999080658, -0.18899817764759064, -1.0060590505599976, -0.19866777956485748, -0.6711204648017883, -0.45939040184020996, -0.2416902631521225, 0.06748839467763901, -0.5377522706985474, -0.3920619785785675, -0.19451123476028442, -0.8913628458976746, -0.09588569402694702, 0.14043587446212769, -0.15269862115383148, 0.0985768660902977, -0.744208037853241, -1.2053077220916748, -0.3957996368408203, -0.5380894541740417, -1.2837029695510864, 0.218072772026062, -0.06549248844385147, -0.1536412537097931, -1.3412411212921143, -0.0831289067864418, -0.5431232452392578, 0.859291136264801, -0.3964363634586334, 0.7220900058746338, -0.08912400901317596, -0.015020247548818588, -0.5712888836860657, 0.1045398861169815, 0.7970754504203796, 0.10601208359003067, 0.22742407023906708, -1.1085615158081055, -0.05097108334302902, -0.0805528461933136, 0.050433214753866196, 0.04582376778125763, 0.31514889001846313, 0.6867967247962952, -0.14952023327350616, -0.6847050189971924, 0.23140282928943634, 1.708909511566162, -0.8233805298805237, -0.014274966903030872, -0.026522230356931686, 1.0743485689163208, -0.012503566220402718, -0.2010277360677719, 0.41629597544670105, 0.14220356941223145, 0.4876825213432312, 0.06154877319931984, -0.13166050612926483, -0.060094814747571945, -0.6876465678215027, 0.7367685437202454, 1.9112308025360107, 0.5231869220733643, 0.2616848349571228, -0.8872226476669312, 0.5409334301948547, -1.2570980787277222, -0.9040984511375427, 1.2737343311309814, 0.6747768521308899, 0.3734545409679413, -0.28297683596611023, -0.544960618019104, -0.25785431265830994, 0.6176882982254028, 0.614885687828064, -0.6076993346214294, -0.8814727067947388, 0.15974903106689453, -0.17087425291538239, -0.17190442979335785, 1.0130016803741455, -0.46104896068573, 0.7860685586929321, 14.350780487060547, 1.0193500518798828, 0.18101799488067627, 0.6252356171607971, 0.626767098903656, 0.04370562732219696, -0.39160844683647156, 0.14610408246517181, -1.8397479057312012, 0.15317174792289734, 1.4003455638885498, 0.3459092974662781, 0.37322762608528137, 0.22305172681808472, 0.33148476481437683, 0.311784565448761, -0.8532785177230835, 0.5607931613922119, 0.582471489906311, -1.3269579410552979, 0.56074458360672, 0.2790091037750244, 0.4018695652484894, 0.47719091176986694, 0.5744739174842834, 0.940436840057373, 0.17800022661685944, -0.3054787218570709, 0.22029374539852142, 0.13951292634010315, 1.147794246673584, -0.44361966848373413, 0.6238178610801697, 0.5281880497932434, -1.3294864892959595, -0.44223344326019287, -0.7274860143661499, -1.0770319700241089, -0.015378052368760109, 0.3356383442878723, -0.6819621920585632, -0.37338992953300476, -0.5449771881103516, 1.0630273818969727, -0.06761879473924637, 0.09493653476238251, -0.3145708441734314, 0.494718998670578, 0.11275207251310349, -0.04106352850794792, 0.6234831213951111, 0.3000932037830353, 0.566863477230072, 0.37834665179252625, -0.19102522730827332, -0.17324022948741913, 0.6154130697250366, 0.16357450187206268, -0.6136168241500854, 0.11450762301683426, -0.6039475202560425, -0.17687055468559265, 0.33592912554740906, 1.072914719581604, 0.5926676392555237, 0.11661740392446518, -0.39646437764167786, 0.21858547627925873, 0.6807944774627686, 0.44991815090179443, -0.19570259749889374, -0.5632900595664978, 0.5832773447036743, -0.6676885485649109, -0.3099968135356903, 0.3178682029247284, -0.06890785694122314, -0.7218157052993774, -0.5027523040771484, -0.14816080033779144, 0.0513748824596405, -0.6187467575073242, -0.7014639973640442, 0.8165416121482849, 0.018294282257556915, -0.4885426163673401, -0.0005624133627861738, -0.9474906921386719, -0.3827722668647766, 0.4796069860458374, -1.3704924583435059, -1.139245867729187, 0.9239077568054199, -0.604840874671936, -0.22911351919174194, 0.0878034383058548, 1.2754405736923218, 0.002555731451138854, -1.007418155670166, 0.3473760187625885, 0.6351426839828491, 0.2699783742427826, -0.026730885729193687, -1.0440620183944702, 0.7682148218154907, 0.6830498576164246, -0.12452100962400436, 0.4456753432750702, -0.3629802167415619, 0.20719903707504272, -0.3828246593475342, -0.5238245129585266, 0.8218891620635986, -0.8719919919967651, -0.22253157198429108, -1.2587209939956665, -0.6815266013145447, 0.5210659503936768, 0.847391664981842, -0.3217928111553192, 0.9300720691680908, 0.480478435754776, -0.5609909296035767, -0.42157313227653503, -0.8070905804634094, 0.5507476925849915, 0.3842313885688782, -0.9156776070594788, -0.44340986013412476, -0.15249332785606384, 0.6799926161766052, -0.7939541339874268, -0.7794097065925598, -0.5074802041053772, 0.21495284140110016, 0.17863433063030243, 1.065086007118225, -0.40723875164985657, 0.8848167061805725, 0.9864877462387085, -0.425285667181015, -0.8335588574409485, 0.13163629174232483, -0.8451223969459534, -0.15402650833129883, 0.36791926622390747, 0.5362674593925476, -0.5077545642852783, -0.18883422017097473, 0.7099695801734924, 0.28779101371765137, -0.9446115493774414, -0.6928145885467529, -0.4087980091571808, 0.21028071641921997, -0.7998443841934204, 0.6341275572776794, -0.04384516552090645, 0.35716333985328674, 0.014691132120788097, 0.5162163972854614, 0.8926991820335388, -0.009181312285363674, -0.7282890677452087, -0.06292303651571274, 0.4860024154186249, -0.23973090946674347, -0.6129425168037415, -0.7742444276809692, -1.4669663906097412, 0.3187667727470398, -1.3385909795761108, -0.18203195929527283, -0.8877230286598206, -0.3370925188064575, -0.1318989396095276, -0.5802932381629944, 0.1051395982503891, -0.1241077110171318, -0.5906273722648621, -0.1300031840801239, -0.7796315550804138, -0.5197876691818237, 0.650397002696991, 0.7914497256278992, -0.40441304445266724, 0.3135499060153961, -0.06460359692573547, 0.314748078584671, 0.2849087417125702, 0.43497416377067566, -0.025205690413713455, -0.8480919003486633, -1.3714475631713867, 0.33621615171432495, -0.1952609121799469, -0.10142116993665695, -0.522896945476532, 0.4616921544075012, 0.1949300467967987, 0.2647358179092407, -0.20540685951709747, 0.3177465498447418, -0.9675703048706055, -0.6258965730667114, 0.19056163728237152, -1.0164794921875, 0.5551776885986328, 0.44630032777786255, -0.3265141248703003, -0.25223278999328613, 0.3042497932910919, -0.3148212432861328, -0.8514373898506165, -1.1663811206817627, 0.3670107424259186, -0.6786345839500427, 0.11501666158437729, -0.10658106952905655, -0.010086005553603172, -0.8981286287307739, 0.02353435568511486, -0.09060956537723541, 0.40857788920402527, -0.22155210375785828, 0.818109929561615, 0.8577551245689392, -1.3605774641036987, 0.04255460947751999, 0.5474019646644592, -0.018727881833910942, -0.24693524837493896, 0.575529932975769, -0.08688485622406006, 0.026722420006990433, 0.3456405997276306, 0.5972528457641602, 0.2518560588359833, -1.2249300479888916, 0.13858798146247864, 0.5922080278396606, -0.8562667965888977, -0.37943121790885925, 0.8809003829956055, -0.5336650609970093, -0.9943391680717468, 0.17996971309185028, -1.6177154779434204, -0.48547881841659546, -0.39905890822410583, 1.2608178853988647, 0.21054355800151825, -0.3025412857532501, 0.18377016484737396, -0.44578301906585693, 0.26553288102149963, -0.5033780932426453, -0.4518046975135803, 0.2807154655456543, -0.6676102876663208, -0.579192042350769, 1.0083212852478027, 0.8382808566093445, -0.5172674059867859, -0.9669947028160095, -0.5607374310493469, -0.24461466073989868, -0.4383803606033325, 0.38375306129455566, -0.3784492611885071, 0.010899828746914864, 0.4515637755393982, 0.691611111164093, 0.41429001092910767, 0.07644301652908325, -0.3801940679550171, 0.461527943611145, 0.811120331287384, 0.19350644946098328, -0.8260570764541626, -0.5706378221511841, 1.1485706567764282, 1.312412142753601, -1.0340408086776733, 0.3516351580619812, 0.35552582144737244, -0.5530580878257751, 0.9042845964431763, 0.37879493832588196, 0.17558597028255463, 1.0259807109832764, 0.18400850892066956, 0.09006098657846451, 0.824518084526062, -1.3566579818725586, 0.2502211630344391, 0.6490302085876465, 1.0576268434524536, 0.7407456040382385, 0.5617015361785889, 0.23146198689937592, 0.9719981551170349, 0.33857306838035583, -0.34343600273132324, 0.6847923398017883, 0.4955693483352661, -0.07337991893291473, -0.5246825218200684, -0.07988788932561874, 0.30303752422332764, -0.6885997653007507, -0.737152099609375, 0.3233411908149719, 0.6081858277320862, 0.17905756831169128, 0.8057184815406799, 0.5837346911430359, 0.13155044615268707, 0.15347141027450562, 0.4383433163166046, 0.3381401598453522, -0.8483155369758606, -0.4318118989467621, -0.18423745036125183, -0.7070445418357849, -0.23953327536582947, 0.007822000421583652, -0.123099185526371, -0.49805864691734314, -0.12647195160388947, 0.1627214252948761, -0.1518433839082718, 0.5904901623725891, 1.1721467971801758, 0.586777925491333, 0.5030495524406433, -0.07630384713411331, -0.4353397488594055, -0.5271390676498413, -1.058199405670166, -0.21974952518939972, -0.5100884437561035, -0.17225401103496552, 0.2353845238685608, 0.06062810868024826, -0.4913996756076813]}, "authors": [{"authorId": "2278431511", "name": "Ninglu Shao"}, {"authorId": "2051175765", "name": "Shitao Xiao"}, {"authorId": "2240687341", "name": "Zheng Liu"}, {"authorId": "2153419738", "name": "Peitian Zhang"}], "references": [{"paperId": "fdc53c2c10742464087c0525f77e32604827a21d", "title": "Efficient Streaming Language Models with Attention Sinks"}, {"paperId": "aa638d5ffb01a84bed00d4c890da3cfcb386a8fa", "title": "Adapting Large Language Models to Domains via Reading Comprehension"}, {"paperId": "b31a5884a8ebe96b6300839b28608b97f8f8ef76", "title": "LongBench: A Bilingual, Multitask Benchmark for Long Context Understanding"}, {"paperId": "0b0debb710366cdff461938c80763eace1651af6", "title": "Code Llama: Open Foundation Models for Code"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "823ca4778e1027f2f0b356df051d762dcecaaba0", "title": "FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning"}, {"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "a0a79dad89857a96f8f71b14238e5237cbfc4787", "title": "Judging LLM-as-a-judge with MT-Bench and Chatbot Arena"}, {"paperId": "2f7364d8e5cf94315bf8905f57de9c5543e9a4bf", "title": "Adapting Language Models to Compress Contexts"}, {"paperId": "b9870e130f61ff900fe00dbcc5782c9b31773d32", "title": "Learning to Compress Prompts with Gist Tokens"}, {"paperId": "a8ca46b171467ceb2d7652fbfb67fe701ad86092", "title": "LoRA: Low-Rank Adaptation of Large Language Models"}, {"paperId": "db1afe3b3cd4cd90e41fbba65d3075dd5aebb61e", "title": "The Pile: An 800GB Dataset of Diverse Text for Language Modeling"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": null, "title": "2023b. Lon-glora: Efficient fine-tuning of long-context large language models"}, {"paperId": null, "title": "2023. In-context autoencoder for context compression in a large language model"}, {"paperId": null, "title": "2023. Focused transformer: Con-trastive training for context scaling"}, {"paperId": null, "title": "2023. Llmlingua: Compressing prompts for accelerated inference of large language models"}, {"paperId": null, "title": "2023. How long can open-source llms truly promise on context length?"}, {"paperId": null, "title": "Localllama. ntk-aware scaled rope allows llama models to have extended (8k+) context size without any fine-tuning and minimal perplexity degradation"}, {"paperId": null, "title": "2023. Lm-infinite: Simple on-the-fly length generalization for large language models"}, {"paperId": null, "title": "Together Computer"}, {"paperId": null, "title": "2022. Recurrent memory transformer"}]}