{"paperId": "20db5ac6e88e2457c82856354a2e5d521482f360", "abstract": "While pre-training and fine-tuning, e.g., BERT~\\citep{devlin2018bert}, GPT-2~\\citep{radford2019language}, have achieved great success in language understanding and generation tasks, the pre-trained models are usually too big for online deployment in terms of both memory cost and inference speed, which hinders them from practical online usage. In this paper, we propose LightPAFF, a Lightweight Pre-training And Fine-tuning Framework that leverages two-stage knowledge distillation to transfer knowledge from a big teacher model to a lightweight student model in both pre-training and fine-tuning stages. In this way the lightweight model can achieve similar accuracy as the big teacher model, but with much fewer parameters and thus faster online inference speed. LightPAFF can support different pre-training methods (such as BERT, GPT-2 and MASS~\\citep{song2019mass}) and be applied to many downstream tasks. Experiments on three language understanding tasks, three language modeling tasks and three sequence to sequence generation tasks demonstrate that while achieving similar accuracy with the big BERT, GPT-2 and MASS models, LightPAFF reduces the model size by nearly 5x and improves online inference speed by 5x-7x.", "venue": "arXiv.org", "year": 2020, "citationCount": 17, "influentialCitationCount": 2, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Experiments on three language understanding tasks, three language modeling tasks and three sequence to sequence generation tasks demonstrate that while achieving similar accuracy with the big BERT, GPT-2 and MASS models, LightPAFF reduces the model size by nearly 5x and improves online inference speed by 5x-7x."}, "embedding": {"model": "specter_v2", "vector": [0.1691206991672516, 0.7073290348052979, -0.08349855244159698, 0.04613729566335678, -0.0636569932103157, -0.5777794122695923, 0.8242928981781006, -0.11551252007484436, -0.47101154923439026, -0.0017072639893740416, 0.19647258520126343, -0.6758970022201538, 0.5479620695114136, -0.02244311012327671, -0.3236105740070343, 0.2725251615047455, -0.38126835227012634, 0.8300389051437378, -0.06892750412225723, -0.4518027901649475, -0.3311992585659027, -0.9420202970504761, -0.8532264828681946, -0.24333134293556213, 0.9982283115386963, 0.3355230689048767, 0.522360622882843, 1.1063599586486816, -0.5953094363212585, 0.19997888803482056, 0.5237444639205933, -0.3536342680454254, 0.3018653392791748, 0.01636347360908985, -0.6363728046417236, -0.2516259551048279, 0.2233346700668335, -0.6039804220199585, -0.12965801358222961, 0.6217171549797058, 0.10748571157455444, 0.3568577170372009, 0.4571508467197418, -0.5355538725852966, -0.6668902039527893, 1.0260472297668457, 0.47229090332984924, 0.6178002953529358, -0.1093376874923706, -0.11228597909212112, 1.203507900238037, -1.437528133392334, -0.08993560075759888, 1.5232765674591064, 0.45770925283432007, 0.7321577072143555, -0.41146624088287354, -0.6591755747795105, 0.5803631544113159, 0.05794968456029892, -0.8153458833694458, -0.04951292648911476, -0.28248870372772217, -0.2830457091331482, 1.8948525190353394, -0.4454711675643921, 0.0952964723110199, 0.4317021369934082, -0.8835412263870239, 1.5855624675750732, -0.0420306958258152, -0.6759968400001526, -0.7046074271202087, 0.0023040296509861946, 0.33932986855506897, 1.1490576267242432, -0.22843271493911743, 0.3185826539993286, -0.8565847277641296, 0.014552383683621883, 0.379469633102417, -0.5327215790748596, -0.24340559542179108, 0.00806056335568428, -0.22184306383132935, 0.7232214212417603, 0.15408185124397278, 0.8089746832847595, 0.052428312599658966, 0.6564607620239258, 0.4664480686187744, 0.4119908809661865, -0.01117008738219738, 0.5174956321716309, -0.4619637131690979, 0.019996630027890205, -0.9135580658912659, 0.2645534574985504, 0.1695897877216339, 0.7936812043190002, 0.021775607019662857, 0.318898469209671, -0.8015697598457336, 0.21689483523368835, 1.41338050365448, 0.08325070887804031, 0.809554934501648, -0.8695738911628723, 0.36286410689353943, -0.7673042416572571, -0.10186431556940079, -0.3513798415660858, 0.102828748524189, -0.044477492570877075, -0.6204124093055725, -1.330759882926941, -0.21196897327899933, -0.18217921257019043, -1.0474587678909302, 1.0040547847747803, -0.09101226925849915, 0.5326045155525208, -0.005725008435547352, 0.4880430996417999, 0.921389102935791, 0.8576776385307312, 0.32683390378952026, 0.1229240819811821, 0.8811550140380859, -1.0538727045059204, -0.3805480897426605, -1.0647732019424438, 0.8706488013267517, -0.02600850537419319, 0.34558483958244324, -0.03131939098238945, -1.4603636264801025, -1.294463872909546, -0.7239155769348145, -0.4002864360809326, -0.6358019113540649, 0.27010101079940796, 1.073368787765503, 0.7956490516662598, -0.7052995562553406, 0.6116285920143127, -0.0070273494347929955, -0.14635257422924042, 0.1696510761976242, 0.011565076187252998, 0.212165966629982, -0.6669871807098389, -1.6278083324432373, 0.23940692842006683, 0.8955264687538147, -0.49982190132141113, -0.47393375635147095, -0.9926817417144775, -0.8786129951477051, -0.07385101914405823, 0.42995959520339966, -0.9804590940475464, 1.6187770366668701, -0.09405079483985901, -1.5917507410049438, 0.7950084209442139, -0.1968085616827011, -0.04008257016539574, 0.5506117939949036, -0.1867629885673523, -0.2667573094367981, -0.8661755919456482, -0.2294357568025589, 0.6901634335517883, 0.21396304666996002, 0.049716077744960785, -0.1287091076374054, 0.540407121181488, -0.006844386458396912, -0.02861827053129673, 0.11034903675317764, 0.5103753209114075, -0.5347586870193481, -0.3344247043132782, 0.2680918574333191, 0.7631086111068726, 0.22906626760959625, -0.42095720767974854, -0.5144346356391907, -1.334853172302246, 0.6812016367912292, -0.03919515386223793, 0.8160744309425354, -0.7767508625984192, -0.5832595229148865, -0.1572982668876648, 0.0580841600894928, 0.2995002269744873, -0.9038317203521729, 0.4100955128669739, -0.21718943119049072, 0.48262083530426025, -0.25565099716186523, -1.0964938402175903, 0.42403802275657654, -0.1307554990053177, -0.6384454369544983, -0.5423785448074341, -0.008257710374891758, 1.1839487552642822, -1.124218463897705, 0.22296904027462006, 0.07228086143732071, 0.20718012750148773, -1.2173755168914795, 1.3862682580947876, -0.8267629146575928, 0.5638514161109924, -0.14622123539447784, -0.38992607593536377, 0.12929533421993256, -0.21535542607307434, 0.15922825038433075, -0.18002456426620483, 0.1428980976343155, 0.7438346743583679, -0.8723684549331665, 1.8149034976959229, -0.4430330991744995, 0.3687785565853119, -0.13462229073047638, -0.796077311038971, 0.49064901471138, 0.44939717650413513, -0.5258433222770691, -0.15661528706550598, 0.05575702711939812, 0.9160535335540771, -0.20429831743240356, 0.24484245479106903, 0.5972443222999573, 0.4100908637046814, -0.0618307925760746, 0.5698813796043396, 0.7076172232627869, -0.6906395554542542, 0.771466076374054, 0.43374764919281006, 0.5679060816764832, 0.6008704304695129, 0.33254754543304443, 0.11167234182357788, 0.7466132044792175, -0.9093455672264099, -0.09183657169342041, 0.7936824560165405, 0.7650647163391113, 0.835696280002594, 0.1488472819328308, -0.6206010580062866, -0.07972527295351028, -0.010403219610452652, 1.0132434368133545, 1.8936642408370972, -0.23965945839881897, -0.10092151910066605, -0.6660759449005127, -0.4972875714302063, -0.0760597288608551, 0.45561352372169495, -0.23214782774448395, -0.22683794796466827, -0.6074405908584595, -0.9844545125961304, 0.7262787222862244, 0.3848111033439636, 1.399161458015442, -0.3900984525680542, 0.017724530771374702, -0.14618827402591705, 0.05148586630821228, -0.6976227760314941, -0.5809202194213867, 0.08655447512865067, -0.2684931457042694, -0.23588235676288605, 0.048726942390203476, -0.17347529530525208, 0.020020630210638046, -0.6536104679107666, 1.1586065292358398, -0.3302878141403198, -0.37196576595306396, 0.036199502646923065, 0.606122612953186, -0.6000241041183472, -0.8068426251411438, 0.4736282229423523, 0.12188230454921722, -0.29340264201164246, 0.44190776348114014, 0.34844765067100525, 0.15019963681697845, -0.0032959419768303633, -0.2619130611419678, 0.4929453432559967, -0.21159003674983978, -0.1028842180967331, 0.7036066651344299, -0.17000743746757507, -0.12906301021575928, -1.5892187356948853, 0.8784633874893188, 0.14627115428447723, -0.49790963530540466, 0.28935426473617554, -0.6343254446983337, -0.16614006459712982, 0.6145832538604736, -0.6991872191429138, -0.3855115473270416, -1.151434302330017, 0.024058939889073372, -0.0536310076713562, -0.20430324971675873, 0.34993037581443787, 0.26348692178726196, 0.2757330536842346, 0.22547507286071777, 0.45809194445610046, 0.1880633682012558, -0.4717963635921478, 1.1916933059692383, -1.1087092161178589, 0.5052410364151001, -0.17409834265708923, 0.5249740481376648, -0.6235153079032898, -0.35035836696624756, -0.3242650330066681, -0.7762566208839417, -0.2736223042011261, -0.33276811242103577, 0.2304287850856781, 0.30193379521369934, -0.8847917318344116, -0.9247112274169922, 0.041886791586875916, -1.0735622644424438, -0.6256435513496399, -0.10196558386087418, -0.26560649275779724, -0.2853747308254242, -0.9105954170227051, -1.0637086629867554, -0.20869512856006622, -0.7458630204200745, -1.056371808052063, 0.44085973501205444, -0.033325307071208954, -0.359109103679657, -0.8793237209320068, 0.32888153195381165, -0.12976224720478058, 0.9500709772109985, -0.9217530488967896, 1.0630152225494385, -0.17839926481246948, -0.2573733627796173, 0.12536707520484924, 0.08704540133476257, 0.6020229458808899, -0.37041348218917847, 0.1575208604335785, -1.0382757186889648, -0.09218747168779373, -0.5931079387664795, -0.6777679324150085, 0.47048869729042053, 0.13744397461414337, 0.6207722425460815, 0.10563098639249802, -0.48754414916038513, 0.6294559240341187, 1.1919931173324585, -0.9016109108924866, -0.12402969598770142, 0.13385580480098724, 1.4432644844055176, -0.019549721851944923, -0.2567562758922577, 0.3265419602394104, 0.515586793422699, 0.17872457206249237, -0.03931499645113945, -0.03242721036076546, -0.2738249897956848, -0.7155176997184753, 0.4087042510509491, 1.6194988489151, 0.010754547081887722, -0.1856893002986908, -1.2930505275726318, 0.6192429661750793, -1.2115790843963623, -0.41466882824897766, 0.5799229741096497, 0.7211953401565552, 0.9530669450759888, -0.5506323575973511, -0.41754573583602905, -0.2920789122581482, 0.2581540048122406, 0.37302812933921814, -0.4984676241874695, -0.9227856397628784, 0.27626273036003113, 0.47489309310913086, -0.13714726269245148, 0.7793883085250854, -0.16952362656593323, 0.7421700358390808, 14.417701721191406, 1.0835267305374146, 0.15426956117153168, 0.8037624955177307, 0.6283206939697266, 0.3546644449234009, -0.5598130226135254, -0.28175514936447144, -1.4504106044769287, -0.176675945520401, 0.915025532245636, 0.12459349632263184, 0.7298756837844849, 0.23680426180362701, -0.08679434657096863, 0.23085248470306396, -0.6348565816879272, 0.7668666839599609, 0.38545873761177063, -1.033390998840332, 0.5923104882240295, 0.09257479012012482, 0.6453151702880859, 0.4214564561843872, 0.7577318549156189, 1.3309214115142822, 0.6439950466156006, -0.4727432131767273, 0.2674151360988617, 0.20094943046569824, 0.857282817363739, -0.021606216207146645, 0.3919365108013153, 0.7642838358879089, -0.7218758463859558, -0.22467537224292755, -0.5345278382301331, -1.22909414768219, 0.21993982791900635, 0.2939942181110382, -0.5367786288261414, -0.6416358351707458, -0.5598592758178711, 0.747248649597168, 0.2306288182735443, 0.19641157984733582, -0.7115107178688049, 0.8330276608467102, -0.11974045634269714, 0.17632174491882324, 0.29201576113700867, 0.25059473514556885, 0.21632441878318787, -0.17369580268859863, 0.47129932045936584, 0.13512201607227325, 0.3839387595653534, 0.8087120652198792, -0.7625147700309753, -0.31395602226257324, -0.14523017406463623, -0.20041322708129883, 0.057017356157302856, 0.6763594150543213, 0.8030543923377991, 0.23724110424518585, -0.32299768924713135, 0.18366771936416626, 0.6836473345756531, -0.014957462437450886, -0.328508585691452, 0.05060213431715965, 0.15241077542304993, -0.2628432810306549, 0.0965486690402031, 0.34193769097328186, -0.11723404377698898, -0.4354737401008606, -0.927473247051239, -0.6219955682754517, 0.11684702336788177, -0.744748592376709, -0.629494845867157, 0.44247007369995117, -0.4324621260166168, 0.021058032289147377, -0.21531561017036438, -0.6939308643341064, -0.5548274517059326, 0.9393592476844788, -1.6384375095367432, -0.7926402688026428, 0.32534050941467285, -0.4849339723587036, -0.24024531245231628, -0.22978748381137848, 1.2835725545883179, -0.03600231558084488, -0.5664511919021606, 0.06684822589159012, 0.178847998380661, 0.007080444600433111, -0.1660533845424652, -1.0644080638885498, 1.243056297302246, 0.31925758719444275, 0.038912512362003326, 0.14810888469219208, -0.10429741442203522, 0.18613658845424652, -0.8989625573158264, -0.12631864845752716, 0.7378585934638977, -0.7237831950187683, -0.3465297520160675, -0.8256502151489258, -0.7839891314506531, 0.407701700925827, 0.560991644859314, -0.30022770166397095, 0.5579495429992676, 0.19554784893989563, -0.8404302000999451, 0.130550816655159, -0.7184792757034302, -0.012332910671830177, 0.3706420660018921, -0.7206209301948547, -0.5751194953918457, 0.024617234244942665, 0.5399954319000244, -0.99388587474823, -0.5893593430519104, -0.25458183884620667, -0.002852171892300248, 0.24230875074863434, 1.2425851821899414, -0.16799698770046234, 0.4528892934322357, 0.8050824999809265, 0.1564963012933731, -1.2330563068389893, -0.12493690848350525, -1.0920339822769165, -0.2181272804737091, 0.26079386472702026, 0.8592203855514526, -0.40517377853393555, -0.04200151935219765, 0.8866285085678101, 0.39562085270881653, -0.2882043421268463, -0.24834367632865906, -0.327780544757843, 0.3435409367084503, -0.5309057831764221, 0.5348300933837891, 0.20682238042354584, -0.21890218555927277, 0.5658963322639465, 0.7371959686279297, 0.4682723581790924, -0.5057443976402283, -0.6726558804512024, 0.7469341158866882, -0.15993469953536987, -0.6926025748252869, -0.6203504800796509, 0.001423389883711934, -1.6632716655731201, 0.08945629000663757, -1.394932746887207, 0.05412926897406578, -1.1375914812088013, -0.49054238200187683, -0.24252738058567047, 0.013677174225449562, 0.1824301928281784, -0.22101245820522308, -0.18785551190376282, -0.4493378698825836, -0.7534187436103821, -0.28889575600624084, 0.7138602137565613, 0.9517292976379395, -0.6685851812362671, 0.07538148760795593, -0.06974047422409058, -0.006045746151357889, 0.31672126054763794, 0.4136027693748474, -0.13325783610343933, -1.0310076475143433, -1.6955432891845703, 0.3218572437763214, -0.2376999408006668, -0.2619914412498474, -0.5297709107398987, 0.5895103812217712, 0.4852534234523773, -0.3140527904033661, 0.14494727551937103, 0.16321633756160736, -0.6117188334465027, -0.797335147857666, 0.46290066838264465, -0.5829687714576721, -0.06697455048561096, 0.39590272307395935, -0.698914110660553, -0.1717013716697693, 0.2448527216911316, -0.15985563397407532, -1.2518905401229858, -0.9167470932006836, 0.5318455696105957, -0.46216151118278503, 0.5352886319160461, -0.5088651776313782, -0.04463917016983032, -1.1236964464187622, -0.459293007850647, 0.026582513004541397, 0.53983473777771, -0.8448753356933594, 0.6106331944465637, 0.10354413092136383, -1.0142388343811035, -0.17750127613544464, 0.6268654465675354, -0.26271960139274597, 0.24975940585136414, 0.4314747750759125, 0.3981401324272156, -0.39469292759895325, 0.4358888864517212, 0.5094133019447327, 0.4786381125450134, -0.7193077206611633, -0.058308195322752, 0.794546365737915, -0.77986741065979, -0.07843776047229767, 1.5343832969665527, -0.24805797636508942, -1.5100678205490112, 0.17193064093589783, -0.8689299821853638, -0.2992524802684784, -0.41022008657455444, 0.7836349010467529, 0.28725922107696533, -0.2513747811317444, 0.2203379124403, -0.16827981173992157, 0.26549896597862244, -0.17997367680072784, -0.5132102966308594, 0.5489658713340759, -0.2135462760925293, -0.5117101073265076, 0.5941984057426453, 0.7522984743118286, -0.7566506266593933, -0.5798608660697937, -0.8772281408309937, -0.37998348474502563, -0.15676595270633698, 0.3292941451072693, -0.8033872246742249, -0.5726109743118286, 1.093682050704956, 0.1645844280719757, 0.4140816032886505, 0.035877421498298645, -0.44235900044441223, 0.39507928490638733, 0.9831564426422119, -0.06424809992313385, -0.6805431842803955, -0.604981005191803, 1.6095452308654785, 1.0243738889694214, -1.2889262437820435, -0.008196132257580757, -0.367029070854187, -0.6029025316238403, 0.8205746412277222, 0.4132380187511444, 0.006373644340783358, 0.7667096853256226, -0.6289508938789368, -0.2815529704093933, 0.3524802029132843, -0.8294169306755066, -0.5972707271575928, 1.0144968032836914, 1.1899820566177368, 1.068503499031067, 0.12074168026447296, 0.3452606797218323, 0.7658302783966064, -0.15639729797840118, 0.015403910540044308, 0.33582988381385803, 0.20577849447727203, -0.3134934604167938, -0.14795534312725067, 0.15155500173568726, 0.5012977123260498, -0.4137038290500641, -0.8063065409660339, 0.1465507298707962, 0.5963059663772583, 0.5401261448860168, 0.5069953203201294, 0.6126319169998169, 0.582217276096344, 0.43159011006355286, 0.44975268840789795, 0.7535040378570557, -0.6772438883781433, -0.2877572774887085, -0.32819417119026184, -0.6508135199546814, -0.0011976273963227868, -0.1154121607542038, -0.2398969680070877, -0.5407869815826416, -0.4583868086338043, 0.21322093904018402, 0.03298051282763481, 0.3363971710205078, 1.3796025514602661, 0.40160802006721497, 0.6579220294952393, -0.5179673433303833, -0.15757660567760468, -0.2493334263563156, -1.080005168914795, 0.013695520348846912, -0.5725471377372742, -0.4579710364341736, -0.19205674529075623, -0.021007448434829712, -0.33552464842796326]}, "authors": [{"authorId": "50982078", "name": "Kaitao Song"}, {"authorId": null, "name": "Hao Sun"}, {"authorId": "2112780268", "name": "Xu Tan"}, {"authorId": "143826491", "name": "Tao Qin"}, {"authorId": "2152960206", "name": "Jianfeng Lu"}, {"authorId": "2109502875", "name": "Hongzhi Liu"}, {"authorId": "2110264337", "name": "Tie-Yan Liu"}], "references": [{"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "80cf2a6af4200ecfca1c18fc89de16148f1cd4bf", "title": "Patient Knowledge Distillation for BERT Model Compression"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "81f5810fbbab9b7203b9556f4ce3c741875407bc", "title": "SpanBERT: Improving Pre-training by Representing and Predicting Spans"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "145b8b5d99a2beba6029418ca043585b90138d12", "title": "MASS: Masked Sequence to Sequence Pre-training for Language Generation"}, {"paperId": "5fd20d2fd9a5408221a76c37675c329a9310963d", "title": "Model Compression with Multi-Task Knowledge Distillation for Web-scale Question Answering System"}, {"paperId": "a08293b2c9c5bcddb023cc7eb3354d4d86bfae89", "title": "Distilling Task-Specific Knowledge from BERT into Simple Neural Networks"}, {"paperId": "1b24b7b4ac2427d20ab60c8451563eb8d99caf9c", "title": "Multilingual Neural Machine Translation with Knowledge Distillation"}, {"paperId": "ec4eba83f6b3266d9ae7cabb2b2cb1518f727edc", "title": "Cross-lingual Language Model Pretraining"}, {"paperId": "c864e3785a9aecf25296781c272980eaed78e51a", "title": "Knowledge Distillation by On-the-Fly Native Ensemble"}, {"paperId": "4f9e19e349a0e034d840496caca0c9377d8c5ce4", "title": "Knowledge Distillation in Generations: More Tolerant Teachers Educate Better Students"}, {"paperId": "5ded2b8c64491b4a67f6d39ce473d4b9347a672e", "title": "A Broad-Coverage Challenge Corpus for Sentence Understanding through Inference"}, {"paperId": "b6583fe9c9dc52bb129aff4cefc60519349f3b4c", "title": "Entropy-SGD: biasing gradient descent into wide valleys"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "8ec5896b4490c6e127d1718ffc36a3439d84cb81", "title": "On Large-Batch Training for Deep Learning: Generalization Gap and Sharp Minima"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": "687bac2d3320083eb4530bf18bb8f8f721477600", "title": "Recursive Deep Models for Semantic Compositionality Over a Sentiment Treebank"}, {"paperId": "4d6e574c76e4a5ebbdb5f6e382d06c058090e4b7", "title": "KL-divergence regularized deep neural network adaptation for improved large vocabulary speech recognition"}, {"paperId": "30c9bb327b7f2b9f1d1e5b69b9d0c97b410948d9", "title": "Model compression"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "First quora dataset release"}, {"paperId": "9819b600a828a57e1cde047bbe710d3446b30da5", "title": "Recurrent neural network based language model"}, {"paperId": "089f6615cdff312985da3e6ceec3fe12a2b49996", "title": "An Efficient Way to Learn Rules for Grapheme-to-Phoneme Conversion in Chinese"}]}