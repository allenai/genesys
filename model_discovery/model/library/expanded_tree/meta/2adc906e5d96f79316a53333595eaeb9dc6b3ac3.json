{"paperId": "2adc906e5d96f79316a53333595eaeb9dc6b3ac3", "abstract": "The time complexity of the standard attention mechanism in a transformer scales quadratically with the length of the sequence. We introduce a method to reduce this to linear scaling with time, based on defining attention via latent vectors. The method is readily usable as a drop-in replacement for the standard attention mechanism. Our\"Latte Transformer\"model can be implemented for both bidirectional and unidirectional tasks, with the causal version allowing a recurrent implementation which is memory and time-efficient during inference of language generation tasks. Whilst next token prediction scales linearly with the sequence length for a standard transformer, a Latte Transformer requires constant time to compute the next token. The empirical performance of our method is comparable to standard attention, yet allows scaling to context windows much larger than practical in standard attention.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A method to reduce the time complexity of the standard attention mechanism in a transformer to linear scaling with time, based on defining attention via latent vectors is introduced, which allows scaling to context windows much larger than practical in standard attention."}, "embedding": {"model": "specter_v2", "vector": [0.5048984885215759, 0.7183540463447571, 0.055629875510931015, 0.14149059355258942, -0.4148333668708801, -0.6298955678939819, 1.1460477113723755, -0.17835459113121033, -0.33227941393852234, -0.28405526280403137, 0.739543080329895, -0.046259790658950806, 0.17552469670772552, -0.23847024142742157, -0.3035755753517151, -0.12872549891471863, -0.5314204096794128, 0.3755652606487274, 0.057244595140218735, -0.044101182371377945, 0.26252126693725586, -0.6333869695663452, -1.0779403448104858, 0.23764649033546448, 0.07043920457363129, 0.10520671308040619, 0.31117507815361023, 1.0553092956542969, -0.31151139736175537, 0.36145374178886414, 0.53309565782547, -0.48337292671203613, 0.28835031390190125, -0.05358607694506645, -0.4744481146335602, -0.28220781683921814, 0.3420424461364746, -0.32946881651878357, -0.5859254002571106, 0.4593525528907776, -0.23284682631492615, 0.002441236050799489, 0.15657705068588257, -0.7489795088768005, -0.2915421426296234, 1.2481422424316406, 0.6661551594734192, 0.8588187098503113, 0.11244320869445801, -0.5113965272903442, 1.4729578495025635, -1.1784580945968628, 0.4177899956703186, 1.7901248931884766, 0.5572410225868225, 0.24056270718574524, -0.3486841022968292, -0.522858738899231, 1.1453419923782349, 0.388359010219574, -0.6120545864105225, -0.5201744437217712, -0.09250235557556152, -0.025997070595622063, 2.003878116607666, -0.38338595628738403, 0.49368947744369507, 0.5432984232902527, -0.12741397321224213, 1.5317953824996948, -0.03241770341992378, -1.0499862432479858, -0.48829492926597595, 0.29274263978004456, 0.16733761131763458, 0.6139218211174011, -0.44300347566604614, 0.5468713641166687, -1.0165040493011475, -0.07355616986751556, 0.660365879535675, -0.2647112011909485, 0.08761566132307053, -0.22755545377731323, -0.5837082862854004, 0.5582519173622131, -0.031176114454865456, 0.8366106748580933, -0.1480005383491516, 1.0758756399154663, 0.7082430720329285, 0.28173381090164185, -0.12442146986722946, 0.25437888503074646, 0.19213441014289856, 0.10030649602413177, -0.734694242477417, 0.2044641375541687, -0.2521912157535553, 0.8477596640586853, -0.1545894593000412, 0.5156959891319275, -1.2155075073242188, 0.05034475028514862, 1.0813919305801392, 0.08029747009277344, 0.7198776602745056, -0.740237295627594, 0.1785418838262558, -0.7541998624801636, -0.017196353524923325, -0.6149083375930786, 0.30480554699897766, -0.22023950517177582, -0.5219378471374512, -1.0739468336105347, -0.23408450186252594, 0.46401160955429077, -0.7418586611747742, 0.8749706149101257, -0.3739631175994873, 0.21836401522159576, -0.10161377489566803, 0.06812332570552826, -0.20542952418327332, 0.6783831119537354, 0.09881783276796341, -0.14900483191013336, 0.8241718411445618, -0.4368527829647064, -0.6150935292243958, -0.9817482233047485, 0.3754393756389618, -0.2721508741378784, 0.03148913010954857, 0.02265743725001812, -1.4948704242706299, -1.049668550491333, -0.5167693495750427, -0.03798331320285797, -0.5425370931625366, 0.1553150862455368, 1.3327938318252563, 0.5141862034797668, -1.145806908607483, 0.733178436756134, -0.48234590888023376, -0.11879748851060867, 0.3572292923927307, 0.2709782123565674, 0.19223818182945251, -0.2686927020549774, -1.183972954750061, 0.324954628944397, 0.11276353150606155, -0.337944358587265, -0.5484221577644348, -0.7166011333465576, -1.1193782091140747, -0.07270915806293488, 0.0698319748044014, -0.3246128559112549, 1.3033370971679688, -0.06985066086053848, -1.2485986948013306, 0.5953845977783203, -0.7716351747512817, -0.0883420929312706, 0.2714787423610687, -0.3590719699859619, -0.060080386698246, -0.7279890775680542, 0.30739933252334595, 0.5568623542785645, 0.7227440476417542, -0.04718773812055588, -0.6484414339065552, 0.09872598946094513, -0.23218584060668945, -0.2397463172674179, -0.14318500459194183, 0.7943122386932373, -0.35812652111053467, -0.2513575851917267, 0.22664307057857513, 0.537107527256012, 0.10814140737056732, -0.7207272052764893, -0.2893628478050232, -1.508864402770996, 0.43659940361976624, 0.11255647242069244, 0.9443193674087524, -0.6368376612663269, -0.5757427215576172, -0.3234984874725342, -0.20999255776405334, -0.4963468015193939, -0.6897495985031128, 0.8009285926818848, -0.8640676736831665, 0.20063477754592896, 0.12547603249549866, -0.7388598322868347, 0.14236150681972504, -0.42064332962036133, -1.0904265642166138, -0.07272101193666458, 0.1481514722108841, 1.121973991394043, -1.1274330615997314, 0.1711977869272232, 0.34542912244796753, 0.29873374104499817, -0.7418243885040283, 1.3556512594223022, 0.1831476241350174, -0.15303711593151093, 0.041442226618528366, -0.5797023177146912, -0.25117772817611694, 0.01673884131014347, 0.386942595243454, -0.17865405976772308, -0.34500715136528015, 0.7691473364830017, -0.37906187772750854, 1.2445398569107056, -0.4592926800251007, 0.7573426365852356, -0.43607622385025024, -0.8309969902038574, -0.0165252722799778, 0.6493682265281677, -0.40900906920433044, -0.2949357032775879, 0.008641119115054607, 0.13297498226165771, -0.5928008556365967, 0.37882715463638306, 0.3758074641227722, 0.6227294206619263, -0.4291232228279114, 0.280076801776886, 0.6938158273696899, -0.23376759886741638, 0.6980375051498413, 0.5235317349433899, 0.7750316262245178, 0.781471848487854, 0.3844609558582306, 0.1592193990945816, 0.16492299735546112, -0.9073505997657776, -0.052597686648368835, 0.6375731229782104, 1.009539246559143, 0.5544512271881104, 0.548410177230835, -0.9757890105247498, -0.6072004437446594, -0.0835169330239296, 0.8064247369766235, 1.3318971395492554, -0.5667507648468018, -0.3120989203453064, -0.6359124779701233, -0.04982203617691994, -0.416643351316452, 0.5446750521659851, -0.48189035058021545, -0.43614867329597473, -0.7219623327255249, -0.6975497603416443, 0.8985079526901245, 0.5949962139129639, 0.4716903567314148, -0.7882662415504456, -0.35920974612236023, 0.21284343302249908, 0.3175621032714844, -0.9590749740600586, -0.5605812072753906, 0.2808741331100464, -0.46165820956230164, -0.01292418222874403, 0.20601128041744232, 0.08093816787004471, 0.1011434867978096, -0.7955949902534485, 0.8246349096298218, -0.5073412656784058, -0.5015325546264648, 0.21534688770771027, 0.7797456979751587, -0.7202039361000061, -0.40884527564048767, 0.31745901703834534, 0.22617140412330627, -0.13947968184947968, 0.37200653553009033, 0.2131577730178833, 0.01071840338408947, -0.2404172122478485, -0.10706359893083572, 0.5703160762786865, -0.1091213971376419, 0.22752632200717926, 0.26497337222099304, -0.25767701864242554, -0.20124325156211853, -1.180354356765747, 0.7754986882209778, 0.4542701542377472, -0.725671112537384, 0.11683548241853714, -0.8791344165802002, -0.29957643151283264, 0.3720371723175049, -0.526944637298584, -0.3538222908973694, -0.617689311504364, 0.3302289545536041, -0.19480830430984497, -0.40268170833587646, -0.1434384286403656, 0.3917551636695862, 0.5419555306434631, -0.24754874408245087, 0.5943731069564819, -0.12791983783245087, 0.14413458108901978, 0.7019765377044678, -1.002538800239563, 0.6031326651573181, 0.19478116929531097, 0.4883994162082672, 0.004466701298952103, -0.20618651807308197, -0.53216153383255, -0.5133011341094971, -0.28731611371040344, -0.4535396099090576, -0.342703253030777, 0.20855021476745605, -0.53914475440979, -1.20359206199646, -0.04968206584453583, -1.503258466720581, -0.26858603954315186, 0.07008171081542969, -0.33994778990745544, -0.2876759469509125, -1.035057783126831, -1.139351725578308, -0.9274753928184509, -0.3966168463230133, -0.8725374341011047, 0.5396130084991455, -0.08397869020700455, -0.5748186111450195, -0.6360184550285339, 0.11301473528146744, -0.3815765380859375, 0.7499895095825195, -0.5454421639442444, 0.7229864001274109, 0.2039320468902588, -0.7753108143806458, -0.3064674735069275, 0.3489013910293579, 0.18230055272579193, -0.35001039505004883, 0.17389406263828278, -1.0116428136825562, -0.08417434245347977, -0.4307894706726074, -0.1906944066286087, 0.0933302789926529, 0.27541449666023254, 0.7048808336257935, -0.07509717345237732, -0.7801719307899475, 0.1983623504638672, 1.5457422733306885, -0.36992985010147095, 0.03816363960504532, 0.34827011823654175, 1.1235120296478271, 0.43366509675979614, -0.2097245752811432, 0.3916817307472229, 0.4574960172176361, 0.6957616806030273, 0.05408458039164543, -0.19473864138126373, -0.11428666114807129, -0.7906187176704407, 0.7158148884773254, 1.3089512586593628, -0.027294721454381943, 0.07498586177825928, -0.9591792821884155, 1.1383353471755981, -1.4461348056793213, -1.1496363878250122, 0.6675087809562683, 0.7893401384353638, 0.18524417281150818, -0.3277604579925537, -0.45606473088264465, 0.3064686357975006, 0.69036465883255, -0.05645834282040596, -0.22215820848941803, -0.8745486736297607, 0.1299165040254593, 0.6652953624725342, 0.20939210057258606, 0.9771943688392639, -0.08638634532690048, 0.8664682507514954, 14.995017051696777, 0.6361092329025269, 0.20186249911785126, 0.6927955150604248, 0.38625937700271606, 0.08896012604236603, -0.5816164612770081, 0.31461605429649353, -1.4427480697631836, -0.20034761726856232, 0.9413493871688843, -0.2148103415966034, 0.8793256878852844, -0.16726458072662354, 0.12496036291122437, 0.34971868991851807, -0.9024578928947449, 0.5200705528259277, 0.6232813596725464, -1.1548452377319336, 0.5426084399223328, 0.2731555104255676, 0.04360666871070862, 0.23079949617385864, 0.4672997295856476, 0.7958217859268188, 0.7899174690246582, -0.5094709992408752, 0.575577974319458, 0.342477411031723, 0.8945491313934326, -0.1433596909046173, 0.17263180017471313, 0.13641275465488434, -1.2597564458847046, -0.22171132266521454, -0.5088788866996765, -1.2859858274459839, 0.3104279935359955, 0.09497272223234177, -0.6770228147506714, -0.5933429002761841, -0.09560392051935196, 0.781456470489502, 0.09761583805084229, 0.11929907649755478, -0.48071926832199097, 0.6593392491340637, -0.008260298520326614, 0.3166026175022125, 0.24789103865623474, 0.5725206732749939, 0.0990162193775177, 0.15766286849975586, 0.1857093870639801, -0.0025464515201747417, -0.23807676136493683, 0.5763677954673767, -0.15571734309196472, -0.3099586069583893, -0.5497651100158691, -0.328561395406723, 0.1649397760629654, 0.8147120475769043, 0.39873331785202026, 0.18808585405349731, -0.029666004702448845, 0.5245708227157593, 0.7404334545135498, 0.12604959309101105, -0.3225795030593872, -0.2161303609609604, 0.2567996084690094, -0.42097094655036926, 0.24607865512371063, 0.5874108076095581, -0.0031919211614876986, -0.3833928108215332, -0.9600166082382202, -0.25036799907684326, 0.2915656268596649, -0.8364826440811157, -0.6340265870094299, 0.7746350765228271, -0.11812044680118561, -0.08517869561910629, -0.03922736644744873, -0.7527983784675598, -0.47859495878219604, 0.3286336660385132, -1.235572338104248, -0.8933712244033813, 0.24372750520706177, -0.18409305810928345, -0.01562211662530899, -0.10422860085964203, 1.25755774974823, -0.2576773762702942, -0.2859460115432739, 0.04721588268876076, -0.226755753159523, -0.168831005692482, -0.29616811871528625, -1.0785804986953735, 0.995682954788208, 0.48805513978004456, 0.1668912023305893, 0.6220759153366089, 0.15432283282279968, 0.2959458827972412, -0.7404911518096924, 0.21884283423423767, 1.1030882596969604, -1.213287115097046, -0.2635937035083771, -1.0613783597946167, -0.6044607162475586, 0.6259946823120117, 0.7396888732910156, -0.5235412120819092, 0.08492033183574677, 0.29830437898635864, -0.5008947849273682, -0.39637166261672974, -0.13180530071258545, 0.004161408171057701, 0.5856596827507019, -0.9023934006690979, -0.5378220677375793, -0.1360519826412201, 0.329642117023468, -0.8139775395393372, -0.28039923310279846, -0.4542553126811981, 0.33536839485168457, -0.13744796812534332, 1.0274311304092407, -0.3465936481952667, 0.4095098376274109, 0.6436805725097656, 0.4667358994483948, -0.8056193590164185, -0.5492473244667053, -1.1333189010620117, 0.17479659616947174, 0.7398210167884827, 0.4844825267791748, -0.29871946573257446, 0.08704151213169098, 0.4921117424964905, 0.3860595226287842, 0.022549305111169815, -0.700933039188385, -0.01086900569498539, -0.0022209000308066607, -0.8711457252502441, 0.418697327375412, -0.1137160137295723, 0.0006832631770521402, 0.40641653537750244, 0.40697070956230164, 0.49969998002052307, -0.00119125097990036, -0.4800660014152527, 0.1944313943386078, 0.07048827409744263, 0.2802900969982147, -0.5945483446121216, -0.49570342898368835, -1.063575029373169, 0.12246054410934448, -1.075523018836975, -0.020079821348190308, -1.4287890195846558, -0.3984485864639282, -0.06672843545675278, -0.2850116789340973, 0.257443368434906, 0.3112897574901581, -0.16657152771949768, -0.5124994516372681, -0.8175495266914368, -0.3718087077140808, 0.5474571585655212, 0.3519059419631958, -0.6669193506240845, 0.4430776834487915, 0.013712935149669647, 0.05534326285123825, 0.3457145392894745, 0.3151780664920807, -0.6122384667396545, -0.8063116669654846, -1.4785544872283936, 0.7389279007911682, -0.0693383514881134, 0.06457877159118652, -0.477395623922348, 0.6519591212272644, 0.4296647608280182, -0.0010993381729349494, -0.16980710625648499, 0.3019251823425293, -0.6414958238601685, -0.32499587535858154, 0.2490357756614685, -0.8659798502922058, 0.3191423714160919, 0.1653275489807129, -0.5420172810554504, -0.08894015103578568, 0.7654224634170532, -0.3167476952075958, -1.3074885606765747, -0.4034692049026489, 0.436218798160553, -0.8989198207855225, -0.004646127112209797, -0.20736826956272125, -0.5570866465568542, -0.7796782851219177, -0.30528372526168823, 0.2645163834095001, 0.235311359167099, -0.560049831867218, 1.348978042602539, 0.5664915442466736, -1.1264245510101318, 0.04286311939358711, 0.3051950931549072, -0.15551908314228058, -0.2240278720855713, 0.03145280480384827, 0.07593996077775955, -0.061852551996707916, 0.8579919934272766, 0.07663596421480179, 0.21039877831935883, -1.076688528060913, 0.11715777218341827, 0.5079026818275452, -0.4985235035419464, -0.33513444662094116, 1.0869182348251343, -0.16706912219524384, -0.8879205584526062, 0.13582751154899597, -1.093721866607666, -0.6505104899406433, -0.15316283702850342, 0.6941193342208862, 0.28372371196746826, -0.21503300964832306, 0.1268998682498932, -0.3618539273738861, 0.47601205110549927, 0.048635173588991165, -0.7813870310783386, 0.7383748888969421, -0.22179058194160461, -0.6006885766983032, 0.8534013032913208, 0.31665492057800293, -0.5901603698730469, -0.48413410782814026, -0.5046505928039551, -0.5828632712364197, -0.3095557689666748, 0.5119948983192444, -0.10213722288608551, -0.30741435289382935, 1.111751914024353, 0.7525703310966492, 0.46133527159690857, -0.27025702595710754, -0.12258073687553406, -0.08953989297151566, 0.34279972314834595, 0.2559211850166321, -0.6029477715492249, -0.686793327331543, 1.2727705240249634, 1.1552821397781372, -0.39420774579048157, -0.04084252193570137, -0.03081931732594967, -0.4986077845096588, 0.9890488386154175, 0.4309098422527313, -0.12499566376209259, 0.3050993084907532, -0.0399056039750576, 0.008794154971837997, 0.23481974005699158, -1.4832199811935425, -0.32340100407600403, 0.6481537818908691, 1.295744776725769, 0.9489437341690063, 0.2116592824459076, 0.07066655158996582, 0.6238144040107727, -0.05886971950531006, 0.1349496692419052, 0.41503751277923584, 0.23234142363071442, 0.17837291955947876, -0.37682121992111206, -0.052298132330179214, 0.5207644104957581, -0.7785890698432922, -0.7899675965309143, 0.31403714418411255, 0.28479209542274475, 0.45393598079681396, 0.554373025894165, 1.0415586233139038, 0.5121524333953857, 0.6843473315238953, 0.14870904386043549, 0.8712545037269592, -0.427528440952301, -0.3274993300437927, -0.13590627908706665, -0.4668513834476471, -0.23982852697372437, -0.1053389236330986, -0.8735860586166382, -0.17082113027572632, -0.00029358346364460886, 0.056343723088502884, 0.12664306163787842, 0.18349137902259827, 1.094916582107544, 0.22214995324611664, 0.7467588186264038, -0.38499197363853455, -0.68266761302948, 0.08390067517757416, -0.8192933201789856, 0.5066342949867249, -0.5801708102226257, -0.15450827777385712, -0.16388948261737823, -0.015831677243113518, 0.11603930592536926]}, "authors": [{"authorId": "2114855562", "name": "Rares Dolga"}, {"authorId": "3238115", "name": "Marius Cobzarenco"}, {"authorId": "2287831296", "name": "David Barber"}], "references": [{"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "5a77b508302771fc083bf24e0bcda8553c9b5421", "title": "Hungry Hungry Hippos: Towards Language Modeling with State Space Models"}, {"paperId": "6d7d141c75af752ffc0d8a6184cca3f9323d6c74", "title": "Simplified State Space Layers for Sequence Modeling"}, {"paperId": "53c3940f35b8b45d55ed49056282e1961954513d", "title": "Self-attention Does Not Need $O(n^2)$ Memory"}, {"paperId": "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51", "title": "Efficiently Modeling Long Sequences with Structured State Spaces"}, {"paperId": "b3bf9fe13195e9aa70e1dac04e01fcff7008e812", "title": "Perceiver: General Perception with Iterative Attention"}, {"paperId": "3a906b77fa218adc171fecb28bb81c24c14dcc7b", "title": "Transformers in Vision: A Survey"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "7e5709d81558d3ef4265de29ea75931afeb1f2dd", "title": "Efficient Transformers: A Survey"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "d27669c82faf78ea08cceaa0a171b540cccc304d", "title": "ETC: Encoding Long and Structured Inputs in Transformers"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "5f4a22ee70ca613d9c0630eafc96364fe365fdf8", "title": "Efficient Attention: Attention with Linear Complexities"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "f63e917638553414526a0cc8550de4ad2d83fe7a", "title": "Fast and Accurate Deep Network Learning by Exponential Linear Units (ELUs)"}, {"paperId": "1c61f9ef06fe74505775a833ff849185757199e7", "title": "Learning Word Vectors for Sentiment Analysis"}, {"paperId": "67107f78a84bdb2411053cb54e94fa226eea6d8e", "title": "Deep Sparse Rectifier Neural Networks"}, {"paperId": "1f53e69f94a1020b48ea7d282221c576555c38a3", "title": "ClusterFormer: Neural Clustering Attention for Efficient and Effective Transformer"}, {"paperId": null, "title": "Linear Unified Nested Attention"}, {"paperId": null, "title": "Linformer"}, {"paperId": null, "title": "Rethinking Attention with Perform-ers"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "OpenWebText Corpus"}, {"paperId": null, "title": "JAX: Compos-able Transformations of Python+NumPy Programs"}, {"paperId": "5d90f06bb70a0a3dced62413346235c02b1aa086", "title": "Learning Multiple Layers of Features from Tiny Images"}, {"paperId": "0a31c7d13b1664adab085294d6c94d40d6c64dc1", "title": "Human Knowledge"}]}