{"paperId": "7d755929690577dbd4b8c187238ed44c3e3a247a", "abstract": "Inspired by the Bloch Sphere representation, we propose a novel rotary position encoding on a three-dimensional sphere, named 3D Rotary Position Encoding (3D-RPE). 3D-RPE is an advanced version of the widely used 2D Rotary Position Encoding (RoPE), with two major advantages for modeling long contexts: controllable long-term decay and improved position resolution. For controllable long-term decay, 3D-RPE allows for the regulation of long-term decay within the chunk size, ensuring the modeling of relative positional information between tokens at a distant relative position. For enhanced position resolution, 3D-RPE can mitigate the degradation of position resolution caused by position interpolation on RoPE. We have conducted experiments on long-context Natural Language Understanding (NLU) and long-sequence Language Modeling (LM) tasks. From the experimental results, 3D-RPE achieved performance improvements over RoPE, especially in long-context NLU tasks.", "venue": "arXiv.org", "year": 2024, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "3D-RPE is an advanced version of the widely used 2D Rotary Position Encoding (RoPE), with two major advantages for modeling long contexts: controllable long-term decay and improved position resolution."}, "embedding": {"model": "specter_v2", "vector": [0.06657407432794571, 0.6778193712234497, -0.6098944544792175, -0.019677650183439255, -0.1432727873325348, -0.09336651861667633, 0.47954240441322327, 0.1803424209356308, -0.5717930793762207, 0.11828459054231644, 1.040181040763855, -0.3700433075428009, 0.21516980230808258, 0.3335278332233429, -0.36199840903282166, 0.008910824544727802, -0.8564103841781616, 0.09530965983867645, -0.13165117800235748, -0.15248341858386993, 0.13604073226451874, -0.6715615391731262, -0.8200564980506897, 0.5173003673553467, 0.6818534731864929, 0.3681113123893738, 0.9525335431098938, 0.8297213912010193, -0.889941394329071, 0.5403562188148499, 0.2526259124279022, 0.07892559468746185, 0.17571452260017395, -0.12361716479063034, -0.24494624137878418, -0.5550559759140015, 0.10476930439472198, -0.33329135179519653, -0.37113112211227417, 0.684874415397644, -0.16905471682548523, 0.1586282104253769, 0.3556179702281952, -0.33072444796562195, -0.31768056750297546, 1.2098966836929321, 0.7598560452461243, 0.3673858046531677, 0.030001506209373474, -1.1812597513198853, 1.4187127351760864, -1.4697130918502808, 0.3658609986305237, 1.3051133155822754, 0.7873358726501465, 0.5836856961250305, 0.08170527964830399, -0.41213464736938477, 0.7612688541412354, 0.2885926067829132, -0.7643169164657593, -0.3751778304576874, -0.4233872592449188, -0.13943499326705933, 1.6861608028411865, -0.25741562247276306, 0.060336023569107056, 0.33926597237586975, -0.2993048429489136, 1.5023961067199707, -0.12553353607654572, -1.060712218284607, -0.3562559485435486, -0.2678033709526062, 0.5657127499580383, 0.5099683403968811, -0.26387208700180054, 0.4001210331916809, -0.9316927194595337, 0.0007529905997216702, 0.686356782913208, -0.07041528075933456, -0.07442668825387955, -0.24873225390911102, -0.5200932025909424, 0.05565633624792099, 0.25923487544059753, 0.8273172974586487, -0.3044677972793579, 0.5345897078514099, 0.5101370215415955, -0.002432967768982053, 0.3086062967777252, 0.21244266629219055, -0.11102119833230972, -0.27465903759002686, -0.9729742407798767, 0.19912004470825195, 0.12967178225517273, 0.7350026369094849, -0.4516039192676544, -0.045249924063682556, -0.6913226842880249, 0.43925294280052185, 1.540516972541809, -0.1601095050573349, 0.4973480999469757, -0.6986581087112427, 0.19805893301963806, -0.7890194654464722, 0.6707968711853027, -0.5625303387641907, -0.13242504000663757, -0.012746484950184822, -0.4575924873352051, -1.1151220798492432, -0.19383428990840912, 0.15994256734848022, -0.4540279507637024, 0.9143720269203186, -0.1594294309616089, 0.7902820706367493, 0.3240088224411011, 0.3533906638622284, 0.25430354475975037, 1.0908364057540894, 0.06416300684213638, -0.3098350763320923, 0.7611222863197327, -1.100438117980957, -0.9792147278785706, -0.7597798705101013, 1.0830104351043701, -0.1508316546678543, 0.08960652351379395, -0.4601058065891266, -1.2581732273101807, -1.0321807861328125, -0.9858428239822388, -0.1721542626619339, -0.6850072741508484, 0.49764564633369446, 0.5971342325210571, 0.2825687527656555, -0.9857416152954102, 1.0434211492538452, -0.42519715428352356, 0.15363477170467377, 0.5032747387886047, -0.4357704222202301, 0.42873266339302063, -0.5559922456741333, -1.6844066381454468, 0.5475948452949524, 0.4193723797798157, -0.21572154760360718, -0.00855093915015459, -0.7728155851364136, -1.408227562904358, -0.04169536009430885, 0.394284188747406, -0.43207648396492004, 1.0719400644302368, 0.5997439026832581, -1.5555555820465088, 0.0017088772729039192, -0.5589455366134644, 0.02898699976503849, 0.19408470392227173, -0.5594545602798462, -0.5799916982650757, -0.46095067262649536, 0.01187131553888321, 0.1746199131011963, 0.07853543758392334, -0.28449517488479614, -0.5592380166053772, 0.012030129320919514, -0.3535647988319397, 0.3120899200439453, 0.15608708560466766, 0.8289711475372314, -0.24853065609931946, -0.3352208435535431, 0.453084260225296, 0.8302634358406067, -0.024476181715726852, -0.14016734063625336, -0.1386643499135971, -0.9697678685188293, 0.735849916934967, -0.055099714547395706, 1.382379412651062, -0.8741978406906128, -0.5053324699401855, -0.588131308555603, -0.33929580450057983, 0.186349555850029, -0.7123367786407471, 0.40651747584342957, -0.20552437007427216, 0.4396625757217407, -0.11953233182430267, -0.9926295876502991, 0.2953278124332428, -0.11377805471420288, -0.7960314154624939, -0.3748296797275543, -0.3308347165584564, 0.951197624206543, -1.3248800039291382, 0.15637339651584625, 0.11199051141738892, 0.2689945697784424, -0.45236071944236755, 1.0542657375335693, -0.4998672604560852, 0.012991352006793022, 0.1463160216808319, -0.34947681427001953, 0.04639448598027229, -0.013442744500935078, 0.36234748363494873, -0.32557645440101624, -0.29363104701042175, 0.9313281178474426, -0.8647167086601257, 1.5669914484024048, -0.5018203258514404, 0.6405238509178162, 0.08480237424373627, -0.20517174899578094, -0.033624663949012756, 0.6450285315513611, -0.12839502096176147, -0.06327427923679352, -0.07237401604652405, 0.3501777648925781, -0.5714463591575623, 0.24167069792747498, 1.0290964841842651, 0.7444179654121399, -0.45661264657974243, 0.7185466289520264, 0.09078202396631241, -0.05152154713869095, 0.5215661525726318, 0.5718507766723633, 0.3529687523841858, 0.7303980588912964, 0.7912803888320923, -0.11867226660251617, 0.4443032443523407, -0.8865181803703308, -0.048295751214027405, 0.7387616038322449, 0.2731366455554962, 0.7410068511962891, 0.359163761138916, -0.3781234920024872, -0.7544953227043152, 0.44636961817741394, 0.49864527583122253, 1.7794463634490967, 0.09476814419031143, -0.5220792889595032, -0.7335386872291565, -0.4389444887638092, -0.1553102731704712, 0.31739237904548645, -0.21770697832107544, 0.18065619468688965, -0.63344407081604, -0.576749861240387, 1.1668126583099365, 0.6885122060775757, 0.8323113918304443, -0.6768631935119629, 0.009668930433690548, 0.011586222797632217, 0.2612835764884949, -0.8499343991279602, -0.6768220663070679, 0.11791358143091202, -0.2864822447299957, -0.43693503737449646, 0.007298990152776241, -0.1774798482656479, 0.21136397123336792, -0.40963199734687805, 0.7769372463226318, -0.49450355768203735, -0.17691324651241302, -0.017547737807035446, 0.08501482009887695, -0.6698641777038574, -0.965770959854126, 0.10482381284236908, 0.2975904643535614, -0.6872929930686951, 0.4437887966632843, 0.9856270551681519, 0.2206193506717682, 0.05982249602675438, -0.19188494980335236, 0.4199744164943695, 0.24138794839382172, 0.010240205563604832, 0.6837545037269592, -0.33551305532455444, 0.417151540517807, -1.1430903673171997, 1.036253809928894, 0.3419385254383087, -0.29692545533180237, 0.5013165473937988, -0.5540293455123901, -0.3752490282058716, 0.4753206670284271, -0.3816870152950287, -0.48592743277549744, -1.2307753562927246, 0.23671892285346985, 0.14324462413787842, -0.5205349326133728, 0.2594606280326843, 0.22599013149738312, 0.5433262586593628, 0.04147278144955635, 0.7405438423156738, 0.542564332485199, -0.33880704641342163, 1.015514850616455, -0.1212659627199173, 0.4220983684062958, 0.032608021050691605, -0.4900340735912323, -0.39217883348464966, -0.34250712394714355, -1.012565016746521, -0.5819526314735413, -0.7750165462493896, -0.8083657622337341, 0.038002800196409225, 0.16762423515319824, -0.490965336561203, -0.6416215896606445, -0.14267906546592712, -1.3257442712783813, -0.27049559354782104, 0.0602869838476181, -0.07268267124891281, -0.1825011968612671, -0.7837527990341187, -1.5213899612426758, -0.5852867364883423, -0.3597329556941986, -0.7768024802207947, 0.37417343258857727, -0.42822906374931335, -0.3467290699481964, -0.46249425411224365, 0.02383347600698471, -0.49511492252349854, 0.8029264211654663, -0.9047464728355408, 0.9365377426147461, 0.003263596910983324, -0.15636233985424042, -0.12696793675422668, 0.06122473254799843, 0.7236377000808716, 0.10548597574234009, -0.04000241309404373, -0.14815345406532288, 0.42521432042121887, -0.017932189628481865, -0.046600788831710815, 0.06621653586626053, 0.35108545422554016, 0.6557351350784302, 0.16223014891147614, -0.6081796288490295, 0.16036632657051086, 0.9663033485412598, -0.5378495454788208, 0.09986434131860733, -0.07375135272741318, 1.2180875539779663, 0.3551117181777954, 0.09782642871141434, 0.4153825342655182, 0.1983746737241745, 0.2826886773109436, 0.16026081144809723, 0.3345361053943634, -0.3896191120147705, -0.45343130826950073, 0.4544733166694641, 1.878075122833252, 0.13265207409858704, 0.09235738962888718, -1.0214887857437134, 0.5523890852928162, -1.507889747619629, -0.8870993256568909, 0.6891494989395142, 0.7455591559410095, 0.4523422420024872, -0.6695859432220459, -0.5232165455818176, -0.2054751217365265, 0.7725033760070801, 0.8527612090110779, -0.17888887226581573, -0.4130527675151825, 0.14726854860782623, -0.30154064297676086, -0.164737269282341, 0.8837243318557739, -0.3523465692996979, 0.6840272545814514, 14.65314769744873, 0.8802508115768433, 0.13228027522563934, 0.551156222820282, 0.5600569248199463, 0.2819538414478302, -0.1014237031340599, -0.3686006963253021, -1.5362626314163208, 0.26018184423446655, 1.1707069873809814, -0.05860843509435654, 0.3154996931552887, 0.16423337161540985, 0.312835693359375, 0.27404317259788513, -0.6687198877334595, 0.5870452523231506, 0.4995185136795044, -1.4840425252914429, 0.4136350750923157, -0.057647954672575, 0.41548678278923035, 0.2684948146343231, 0.6180994510650635, 0.8296053409576416, 0.1716853231191635, -0.40960997343063354, 0.5629369616508484, -0.004874203819781542, 0.8734560608863831, -0.14150959253311157, 0.5157827138900757, 0.9258723855018616, -0.8623211979866028, -0.14007078111171722, -0.9053909182548523, -1.2572698593139648, 0.42517462372779846, 0.250251442193985, -0.6811334490776062, -0.39759761095046997, -0.5898210406303406, 1.0513991117477417, 0.4276198446750641, 0.3764021396636963, -0.45539528131484985, 0.42740514874458313, 0.17239384353160858, -0.12999652326107025, 0.33929696679115295, 0.3200111985206604, 0.5179099440574646, 0.006388686131685972, 0.3292003571987152, 0.3300398290157318, -0.047950685024261475, 0.2755270004272461, -0.42336973547935486, -0.07097163796424866, -0.37213972210884094, -0.0920790284872055, 0.24560582637786865, 0.17268840968608856, 0.7913544178009033, -0.040858227759599686, -0.2441522181034088, 0.37967780232429504, 0.7551862597465515, 0.02483437955379486, -0.17734582722187042, -0.07680603861808777, 0.44466301798820496, -0.37164291739463806, 0.2045900970697403, 0.2518720030784607, -0.3982756435871124, -0.48273420333862305, -0.7336598634719849, -0.09131290763616562, -0.14941255748271942, -0.7955458164215088, -0.6063873171806335, 0.9261439442634583, -0.3520122766494751, -0.6271333694458008, 0.045937374234199524, -0.8438206911087036, -0.03411616012454033, 0.36137717962265015, -1.3058133125305176, -0.5537573099136353, 0.573350727558136, -0.6037791967391968, -0.2768906056880951, 0.3080042600631714, 1.369782567024231, 0.24496924877166748, -0.44073235988616943, -0.37128233909606934, 0.8000138998031616, -0.013182350434362888, 0.049983348697423935, -1.1321543455123901, 0.4856546223163605, 0.2877107858657837, -0.1889849156141281, 0.5586464405059814, -0.24525325000286102, -0.22547046840190887, -0.16455434262752533, -0.333497554063797, 0.8580257296562195, -0.9068296551704407, -0.5020381212234497, -0.8687605261802673, -1.2193928956985474, 0.23590019345283508, 0.3559153378009796, -0.024275828152894974, 0.6381858587265015, 0.20332594215869904, -0.38513636589050293, 0.09015674889087677, -0.6152957677841187, 0.13078519701957703, 0.5601935386657715, -0.959240734577179, -0.75077885389328, -0.14377553761005402, 0.7333709001541138, -1.3351004123687744, -0.5880561470985413, -0.20691917836666107, 0.20454195141792297, -0.0169505812227726, 1.2108491659164429, -0.287306547164917, 0.886574923992157, 0.565352737903595, -0.10863731056451797, -1.065573811531067, 0.02206304296851158, -0.7776374816894531, -0.41435614228248596, 0.0369613878428936, 0.696729302406311, -0.03858505189418793, 0.3455338180065155, 0.6336165070533752, -0.0433228462934494, -0.8170502185821533, -0.5778201818466187, -0.4425191879272461, 0.11166077107191086, -0.6868128776550293, 0.46162205934524536, -0.04908299073576927, 0.3134031593799591, 0.012715197168290615, 0.30968379974365234, 0.8095903992652893, -0.3634628355503082, -0.6093509197235107, -0.0008524280274286866, 0.23179678618907928, 0.1559755504131317, -0.720774233341217, -0.3280685245990753, -2.0226101875305176, 0.13666203618049622, -1.073538899421692, 0.44319939613342285, -0.9982788562774658, -0.8139265179634094, -0.15086853504180908, -0.5442602038383484, -0.2902202606201172, 0.045734256505966187, -0.6725961565971375, -0.23847255110740662, -0.3728863596916199, -1.067821741104126, 0.7118292450904846, 1.059898853302002, -0.3159634470939636, -0.015638351440429688, 0.19667981564998627, 0.24057486653327942, 0.3576200604438782, 0.38304924964904785, -0.2645748555660248, -0.7231343984603882, -1.3060698509216309, 0.27858784794807434, 0.06334372609853745, -0.3340255618095398, -0.5043441653251648, 0.8662962913513184, 0.6240103244781494, -0.2723906934261322, -0.4244617223739624, 0.2799403667449951, -0.9329146146774292, -0.8030828833580017, 0.3696901500225067, -1.155838966369629, -0.16875146329402924, 0.002543041715398431, -0.17750483751296997, -0.49248191714286804, 0.40866589546203613, -0.47536712884902954, -1.0335798263549805, -0.8441197276115417, 0.21124596893787384, -0.4294854700565338, -0.08554433286190033, -0.05313931033015251, -0.18816830217838287, -1.218167781829834, -0.267309308052063, -0.2830630838871002, 0.21081875264644623, -0.26944541931152344, 0.7592054605484009, 0.5981588959693909, -1.2361109256744385, 0.1279578059911728, 0.2972352206707001, -0.31084907054901123, 0.3265104591846466, 0.5688754916191101, 0.1437530666589737, -0.4404856264591217, 1.0251436233520508, 0.5301209092140198, 0.40472349524497986, -1.0532203912734985, -0.05812766030430794, 0.5424991250038147, -0.36823010444641113, -0.2817295789718628, 1.0646032094955444, -0.6767692565917969, -1.1636818647384644, 0.4554826021194458, -1.257020115852356, -0.69239741563797, -0.40256229043006897, 1.1766815185546875, 0.5001430511474609, -0.5639268159866333, -0.2353486865758896, -0.4958025813102722, 0.08180393278598785, -0.2863518297672272, -0.47625961899757385, 0.6319042444229126, -0.47885146737098694, -0.6718847155570984, 0.8223810791969299, 0.6871588826179504, -0.5738369822502136, -1.0493431091308594, -0.6217972636222839, -0.1764582246541977, -0.5718839764595032, 0.25437459349632263, -0.44154033064842224, 0.22265219688415527, 0.702332615852356, 0.21276916563510895, 0.6788933277130127, -0.5035122036933899, -0.18776123225688934, 0.42156749963760376, 0.6005095839500427, 0.19571402668952942, -0.47783389687538147, -0.711916983127594, 1.61376953125, 1.4271153211593628, -0.865780770778656, 0.3045285940170288, -0.2916191816329956, -0.5358211994171143, 1.0050660371780396, 0.19983555376529694, 0.1695028841495514, 0.8091175556182861, -0.24206854403018951, 0.19974367320537567, 0.4136612117290497, -0.829195499420166, 0.0017575724050402641, 0.617168128490448, 1.1741946935653687, 0.8606709241867065, 0.19610148668289185, 0.11224643886089325, 1.0494515895843506, 0.3394366204738617, 0.08190754801034927, 0.6623817086219788, 0.6475024819374084, -0.514347493648529, -0.4339469373226166, 0.07578258961439133, 0.502007782459259, -0.6052967309951782, -0.8741123676300049, 0.3522472381591797, 0.2874596416950226, 0.2689073383808136, 0.3975277841091156, 0.7629179954528809, 0.4095492959022522, 0.09261982142925262, 0.51511549949646, 0.5261777639389038, -0.9928253889083862, 0.10368824005126953, -0.4079541563987732, -0.5537754893302917, -0.2527029514312744, -0.40217483043670654, -0.38384562730789185, -0.8157663345336914, -0.05585620552301407, 0.17005109786987305, 0.36943498253822327, 0.6809049844741821, 1.1898789405822754, 1.0687822103500366, 0.6342638731002808, -0.625568151473999, -0.32095614075660706, -0.520649790763855, -1.1510170698165894, -0.2002446949481964, -0.5751243233680725, -0.09862077236175537, 0.07862649857997894, 0.11093772947788239, -0.3942596912384033]}, "authors": [{"authorId": "66568860", "name": "Xindian Ma"}, {"authorId": "2306862256", "name": "Wenyuan Liu"}, {"authorId": "2307125966", "name": "Peng Zhang"}, {"authorId": "2306784870", "name": "Nan Xu"}], "references": [{"paperId": "cf7ab5df804575bad88a9fcf0fbf7707bf500944", "title": "Training-Free Long-Context Scaling of Large Language Models"}, {"paperId": "2b8439f319dfa73df62ca8957ff6d0c1f3c7a73c", "title": "Soaring from 4K to 400K: Extending LLM's Context with Activation Beacon"}, {"paperId": "fdc53c2c10742464087c0525f77e32604827a21d", "title": "Efficient Streaming Language Models with Attention Sinks"}, {"paperId": "b6346f9fa093b8e85df712485a2b851b9f680dac", "title": "LongLoRA: Efficient Fine-tuning of Long-Context Large Language Models"}, {"paperId": "819bbdc2dac9e13d9ca3e2508a6e063186ce5e40", "title": "YaRN: Efficient Context Window Extension of Large Language Models"}, {"paperId": "b31a5884a8ebe96b6300839b28608b97f8f8ef76", "title": "LongBench: A Bilingual, Multitask Benchmark for Long Context Understanding"}, {"paperId": "b0db25e317cf856f1ec1ca3df0e573d850ed4696", "title": "L-Eval: Instituting Standardized Evaluation for Long Context Language Models"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "823ca4778e1027f2f0b356df051d762dcecaaba0", "title": "FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning"}, {"paperId": "b069c32fcd77160f944ab3ba71ab6f0cfb782c68", "title": "Focused Transformer: Contrastive Training for Context Scaling"}, {"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "094ff971d6a8b8ff870946c9b3ce5aa173617bfb", "title": "PaLM: Scaling Language Modeling with Pathways"}, {"paperId": "38115e80d805fb0fb8f090dc88ced4b24be07878", "title": "CodeGen: An Open Large Language Model for Code with Multi-Turn Program Synthesis"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "50796b0f3edf9cb5ff1e447c298b33755378aa4f", "title": "GLM: General Language Model Pretraining with Autoregressive Blank Infilling"}, {"paperId": "d0e28f5dc1feae19e41087a92a87992977fd85af", "title": "Encoding word order in complex embeddings"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "d07284a6811f1b2745d91bdb06b040b57f226882", "title": "Decoupled Weight Decay Regularization"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": null, "title": "Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality"}, {"paperId": null, "title": "How long can open-source llms truly promise on context length?"}, {"paperId": null, "title": "Gpt-j-6b: A 6 billion parameter autoregressive language model"}, {"paperId": "d77d03fb7ae5572ad0d9e728ff05c73263852278", "title": "& Computer"}, {"paperId": null, "title": "Ntk-aware scaled rope allows llama models to have extended (8k+) context size without any fine-tuning and minimal perplexity degradation"}, {"paperId": null, "title": "Long alpaca: Long-context instruction-following models"}, {"paperId": null, "title": "How long can context length of open-source llms truly promise?"}]}