{"paperId": "1d84b38af8174dc606c1b4ef979ec887b5db6613", "abstract": "Algorithmic generalization in machine learning refers to the ability to learn the underlying algorithm that generates data in a way that generalizes out-of-distribution. This is generally considered a difficult task for most machine learning algorithms. Here, we analyze algorithmic generalization when counting is required, either implicitly or explicitly. We show that standard Transformers are based on architectural decisions that hinder out-of-distribution performance for such tasks. In particular, we discuss the consequences of using layer normalization and of normalizing the attention weights via softmax. With ablation of the problematic operations, we demonstrate that a modified transformer can exhibit a good algorithmic generalization performance on counting while using a very lightweight architecture.", "venue": "arXiv.org", "year": 2023, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://arxiv.org/pdf/2310.08661", "status": "CLOSED"}, "tldr": {"model": "tldr@v2.0.0", "text": "This work shows that standard Transformers are based on architectural decisions that hinder out-of-distribution performance for such tasks, and discusses the consequences of using layer normalization and of normalizing the attention weights via softmax."}, "embedding": {"model": "specter_v2", "vector": [0.40820589661598206, 0.7232410311698914, -0.329284131526947, -0.31722724437713623, -0.3481435775756836, -0.22380511462688446, 0.5002453923225403, -0.1077173724770546, -0.5909453630447388, -0.3037177324295044, 0.32947537302970886, 0.08305530995130539, 0.33580562472343445, -0.0009865828324109316, -0.15903599560260773, 0.08639182895421982, -0.6223317384719849, 0.2231219857931137, 0.09932366013526917, -0.18857990205287933, -0.11033738404512405, -0.47490444779396057, -1.290141224861145, 0.5720991492271423, 0.32936108112335205, 1.1544156074523926, -0.23921555280685425, 0.8384320139884949, -0.8459674119949341, 0.45906829833984375, -0.085848368704319, -0.683859646320343, 0.4093492925167084, 0.21392317116260529, -0.47120243310928345, -0.12991265952587128, 0.7881918549537659, -0.15651436150074005, -0.277589350938797, 0.7652098536491394, -0.3263188600540161, 0.28781285881996155, 0.5180341005325317, -1.0340700149536133, -0.16229531168937683, 1.049010157585144, 0.5516725778579712, 0.8357839584350586, -0.4886346459388733, -0.48936477303504944, 1.313269019126892, -1.0544229745864868, -0.14750592410564423, 1.1226410865783691, 0.6605886816978455, 0.7766653299331665, -0.48337751626968384, -0.8938997983932495, 0.6523110866546631, 0.12467749416828156, -0.9331048130989075, -0.1691700667142868, -0.08240263164043427, -0.07796182483434677, 1.5930529832839966, -0.49592533707618713, -0.40520820021629333, 0.06131913512945175, -0.21451714634895325, 1.6299755573272705, 0.10039885342121124, -0.4604039490222931, 0.17549370229244232, 0.0033131600357592106, 0.35040202736854553, 0.7113886475563049, -0.15192441642284393, -0.043916281312704086, -1.3498493432998657, -0.12559689581394196, 0.11738637089729309, -0.11067981272935867, 0.15937262773513794, -0.32977810502052307, 0.29518231749534607, 0.5863872766494751, 0.7753889560699463, 0.39991262555122375, -0.5459398031234741, 1.3042415380477905, 0.6383020877838135, 0.09459499269723892, 0.11162714660167694, 0.4737456738948822, -0.37733155488967896, 0.44351446628570557, -1.1460744142532349, 0.07915125787258148, -0.1527068167924881, 1.1231489181518555, 0.1290035843849182, 0.42484405636787415, -0.4803735911846161, 0.18684065341949463, 0.8576912879943848, -0.18612602353096008, 0.7698920965194702, -0.49422237277030945, 0.4688754081726074, -0.0855066329240799, -0.22001196444034576, -0.07299260795116425, -0.48438987135887146, -0.7125794291496277, -0.8676362037658691, -0.8662354946136475, -0.5298838019371033, 0.09819591790437698, -1.061989426612854, 0.8654336333274841, -0.871844470500946, 0.0919535756111145, -0.03557828813791275, 0.41509556770324707, 0.2226548194885254, 0.19108961522579193, 0.8363139629364014, 0.1792336255311966, 0.5925942659378052, -0.473621666431427, -0.20725814998149872, -0.7200347781181335, 0.7558930516242981, -0.28712210059165955, 0.4510379731655121, -0.10358021408319473, -1.1427550315856934, -1.0561846494674683, -1.0319052934646606, 0.21414759755134583, -0.810524046421051, 0.10367853939533234, 1.2420434951782227, 1.0519838333129883, -1.136295199394226, 0.817771315574646, -0.3321576416492462, -0.08189708739519119, 1.200870394706726, 0.7289109826087952, 0.31830015778541565, -0.28404438495635986, -0.6008304357528687, 0.11380301415920258, 0.7609131932258606, -1.034360408782959, -0.0882188156247139, -1.0357069969177246, -0.8143349885940552, 0.24118293821811676, 0.17898406088352203, -0.8688172101974487, 1.6008881330490112, -0.3958715796470642, -0.9957411289215088, 0.5811963677406311, -0.1665249913930893, 0.01578989066183567, 0.3662857115268707, -0.1738385558128357, -0.2697574496269226, -0.5814663171768188, -0.2884639501571655, 0.6155068874359131, 0.4265877902507782, -0.3369878828525543, -0.38766708970069885, 0.1760461926460266, -0.1630435287952423, -0.27766624093055725, -0.5521317720413208, 0.27689704298973083, 0.36207354068756104, -0.3817780613899231, 0.6509129405021667, 1.02250337600708, 0.02204175852239132, -0.4782898426055908, -0.3642871081829071, -1.5124160051345825, 0.6134889721870422, 0.594622015953064, 0.8311511874198914, -0.861940324306488, -0.9114949107170105, 0.05616119131445885, 0.05271010845899582, -0.1790398210287094, -0.7208905816078186, 0.2420823872089386, -0.6607668399810791, 0.8718357682228088, -0.18796059489250183, -1.0765529870986938, 0.36062490940093994, -0.18275412917137146, -0.736200213432312, -0.3232090473175049, 0.33465203642845154, 0.9010223746299744, -0.756618082523346, 0.555400550365448, -0.21846704185009003, -0.2328992336988449, -1.3991708755493164, 1.05772066116333, -0.6241728663444519, -0.43124258518218994, 0.11981656402349472, -0.20052193105220795, 0.5893186926841736, -0.6074202060699463, 0.21535085141658783, -0.3286270797252655, 0.27718016505241394, 0.7877367734909058, -0.5533888339996338, 1.4311481714248657, -0.7369545698165894, 0.08126946538686752, -0.5615659952163696, -0.9293094277381897, -0.029255947098135948, 0.19654594361782074, -0.2439100295305252, -0.27857115864753723, 0.2923135459423065, 0.4605870246887207, -0.5317562818527222, 0.3495667576789856, 0.9966570734977722, 0.48795631527900696, -0.3933076858520508, 0.3705517649650574, 1.0842841863632202, -0.3184009790420532, 0.47417664527893066, 0.27730727195739746, 0.8516802191734314, 0.12606069445610046, 0.2843335270881653, -0.1366737335920334, 0.3019731938838959, -0.8752623200416565, -0.16174308955669403, 0.8116225600242615, 1.131957769393921, 0.672996461391449, 0.22089006006717682, -0.9137964844703674, -0.36349761486053467, -0.6015309691429138, 0.598498523235321, 1.8807260990142822, -0.3050170838832855, -0.4678056240081787, -0.6213374137878418, -0.708371102809906, -0.20877261459827423, 0.4693460166454315, -0.46385499835014343, -0.30813857913017273, -0.24158859252929688, -1.3429162502288818, 0.8725687265396118, 0.7790988087654114, 1.1739654541015625, 0.027355032041668892, -0.259312242269516, -0.4158935248851776, 0.2118687629699707, -0.659025251865387, -0.4018506407737732, 0.6217319369316101, -0.7079634666442871, -0.06164313107728958, 0.3507913649082184, 0.252885103225708, 0.43375518918037415, -0.7498044371604919, 0.9300300478935242, -0.25100836157798767, -0.18133516609668732, 0.18816541135311127, 0.962851881980896, -0.8100118637084961, -0.5712761878967285, 0.7772167921066284, 0.015165234915912151, -0.08306727558374405, 0.8179336190223694, 0.22889724373817444, 0.09604616463184357, 0.2621035575866699, -0.656308114528656, -0.12434908747673035, 0.14796224236488342, -0.08942420035600662, 0.36943379044532776, -0.060592494904994965, 0.27390560507774353, -1.4116158485412598, 1.0108160972595215, -0.07323019206523895, -0.32373788952827454, 0.12908490002155304, -0.5217582583427429, 0.07609665393829346, 0.8333626389503479, -0.9092857837677002, -0.052712373435497284, -0.7202476263046265, 0.47900477051734924, -0.38138431310653687, -0.10997475683689117, 0.03628668189048767, 0.19886791706085205, 0.15443338453769684, 0.6739501357078552, 0.42546987533569336, 0.14007045328617096, -0.04009111598134041, 0.6469330787658691, -0.769743800163269, 0.42975053191185, 0.06128652021288872, 0.30573421716690063, -0.2257571816444397, -0.0531274788081646, -0.3385249078273773, -0.6361615657806396, -0.303422212600708, 0.1358579695224762, -0.25460466742515564, -0.10060975700616837, -0.27416306734085083, -1.1967098712921143, 0.0033011806663125753, -0.749321699142456, -0.3598352372646332, -0.2976577579975128, -0.3936113119125366, -0.42522522807121277, -1.554122805595398, -0.8414304852485657, -0.5758695602416992, -0.2534906566143036, -0.9416849613189697, 0.1473347246646881, 0.3651132881641388, -0.477293998003006, -0.5235586762428284, -0.7500940561294556, -0.4698646068572998, 1.5386004447937012, -0.6117858290672302, 1.0059599876403809, -0.38770586252212524, -0.5691998600959778, -0.13647760450839996, -0.0015622311038896441, 0.43204107880592346, -0.587848961353302, -0.1931018978357315, -1.4969326257705688, 0.43930235505104065, -0.35618430376052856, -0.5621904134750366, 0.4147705137729645, 0.15116490423679352, 1.3951696157455444, -0.25080183148384094, -0.2688720226287842, 0.41149693727493286, 1.524481177330017, -0.991057813167572, 0.09963744878768921, 0.08210565894842148, 0.8672109246253967, 0.08573175966739655, -0.7651187777519226, 0.4275411069393158, 0.23102901875972748, 0.2530175447463989, 0.22238631546497345, 0.2005710005760193, -0.21628320217132568, -0.6467440724372864, 0.19465094804763794, 0.9679324626922607, 0.26595693826675415, 0.022347724065184593, -0.9081349968910217, 0.2575518488883972, -1.110644817352295, -0.6358650326728821, 0.787162721157074, 1.0327606201171875, 0.11251683533191681, -0.21379442512989044, -0.2582343518733978, 0.04009096324443817, 0.2260758876800537, 0.05353701859712601, -0.2375282347202301, -0.88271164894104, 0.13337211310863495, 1.1171526908874512, 0.9848175048828125, 0.46115800738334656, 0.01531048770993948, 0.5096198916435242, 14.635567665100098, 1.1322319507598877, -0.03308334946632385, 0.6861298680305481, 0.7538890838623047, 0.2481110692024231, -0.6154218912124634, -0.29207971692085266, -1.2085680961608887, 0.059069015085697174, 0.7406083941459656, 0.08145006746053696, 0.8256791234016418, 0.24118532240390778, -0.5233524441719055, 0.28349927067756653, -0.6987476944923401, 0.7198745608329773, 0.36017921566963196, -1.5674667358398438, 0.652657151222229, 0.06847786158323288, 0.5551740527153015, 0.43669894337654114, 0.7261123657226562, 0.8618285655975342, 0.5781610012054443, -0.7543672323226929, 0.5393462777137756, 0.1411692202091217, 0.9854507446289062, -0.19689799845218658, 0.7371959090232849, 0.4704936742782593, -0.9482882618904114, -0.2740240693092346, -0.5340441465377808, -1.181581735610962, -0.19394278526306152, 0.19203215837478638, -0.8098510503768921, -0.3753003776073456, -0.38868117332458496, 0.40854308009147644, 0.03063022717833519, 0.48832887411117554, -0.49817705154418945, 0.6079158186912537, -0.5107064247131348, 0.05907519534230232, -0.040248218923807144, 1.1360329389572144, -0.18065668642520905, -0.19983194768428802, -0.01648017391562462, -0.11891943961381912, 0.4079430401325226, 0.47233471274375916, -1.0018892288208008, -0.03967447206377983, 0.19446000456809998, -0.026545682922005653, -0.017579905688762665, 0.7031399607658386, 0.5618689060211182, 0.1105993464589119, -0.051535654813051224, 0.14310608804225922, 0.7288098931312561, 0.29273614287376404, -0.05757412686944008, 0.10713213682174683, 0.36208441853523254, -0.11201367527246475, -0.11920320987701416, 0.8872402906417847, -0.8030674457550049, -0.26050424575805664, -0.5271981358528137, -0.016813402995467186, 1.006471037864685, -0.690222442150116, -0.9756177067756653, 0.46601736545562744, -0.054916366934776306, -0.49804964661598206, 0.4575034976005554, -0.8164210915565491, -0.38813620805740356, 0.4948478639125824, -1.296155333518982, -0.6959129571914673, -0.17546944320201874, -0.3349727392196655, -0.30397090315818787, -0.36618712544441223, 1.2411489486694336, -0.02483624964952469, 0.1804603487253189, 0.5841751098632812, -0.5973875522613525, -0.3361547887325287, -0.4303600788116455, -1.1607221364974976, 0.847104012966156, -0.004797837696969509, -0.37765365839004517, 0.43558064103126526, -0.20632140338420868, 0.7768912315368652, -0.1405000239610672, -0.1381913721561432, 0.5714184641838074, -0.6625224947929382, -0.2707301378250122, -0.4738250970840454, -0.7832490801811218, 0.4486311078071594, 0.4324958026409149, -0.40325507521629333, 0.5826131701469421, 0.4082948863506317, -0.9844470024108887, -0.21903693675994873, -0.8649967312812805, 0.11729349195957184, 0.7267334461212158, -0.4599561095237732, -0.34844574332237244, -0.07073283195495605, -0.15463991463184357, -0.9944433569908142, -0.40571728348731995, -0.26488372683525085, -0.11501344293355942, -0.07262969017028809, 0.8659767508506775, -0.6899831891059875, 0.7773634791374207, 0.5023740530014038, -0.06693530827760696, -0.8212124705314636, 0.063641257584095, -0.8761647343635559, 0.42282792925834656, 0.1087653860449791, 0.7204866409301758, -0.797143816947937, 0.8493440747261047, 0.6837035417556763, 0.022702770307660103, -0.19508324563503265, -0.5967245697975159, -0.044650640338659286, 0.19082334637641907, -0.6536603569984436, 0.7060986757278442, 0.08070006966590881, -0.29593878984451294, -0.0013761958107352257, 0.9924495220184326, 0.6580869555473328, -0.08043830841779709, -0.837373673915863, 0.59212327003479, -0.3030385971069336, 0.047823887318372726, -1.0784666538238525, -1.0980453491210938, -1.6310603618621826, 0.1624843180179596, -1.6316876411437988, -0.2510544955730438, -0.6231463551521301, -0.4803747534751892, -0.27523601055145264, -0.36893367767333984, 0.18114490807056427, 0.3390011191368103, -0.2921546399593353, -0.39753204584121704, -0.5820316672325134, -0.27687573432922363, 0.36510491371154785, 0.18250146508216858, -0.44537243247032166, 0.2245098054409027, 0.24899174273014069, -0.2837495505809784, 0.48558419942855835, 0.859374463558197, -0.739794909954071, -0.825691819190979, -1.0609886646270752, 0.4779161214828491, -0.699279248714447, -0.06448337435722351, -0.854977548122406, 0.9378888010978699, 0.4052767753601074, 0.24664300680160522, 0.07280751317739487, 0.2093837857246399, -0.9723917245864868, -0.7654451131820679, 0.3602558672428131, -1.0674793720245361, 0.4089701473712921, 0.41851291060447693, -0.5142650604248047, 0.10522241145372391, 0.3127448856830597, 0.15923111140727997, -0.7948419451713562, -0.7907326817512512, 0.27978748083114624, -0.45509034395217896, 0.5906065702438354, -0.3199766278266907, -0.25450146198272705, -1.4450641870498657, -0.11391424387693405, -0.09354212135076523, 0.4872794449329376, -0.19481191039085388, 0.5408526062965393, 0.03268488124012947, -1.1024315357208252, 0.3314371109008789, 0.4249705374240875, 0.0495927631855011, 0.27128535509109497, 0.5008098483085632, 0.36418434977531433, -0.5037553906440735, -0.12919941544532776, 0.2655578553676605, 0.1734435111284256, -0.541623592376709, -0.16189752519130707, 0.8568358421325684, -0.5200101733207703, -0.05328809469938278, 1.372191071510315, -0.3025185167789459, -1.2938724756240845, 0.07869856804609299, -1.217297077178955, -0.1947837918996811, -0.30332237482070923, 0.6581755876541138, 0.16597682237625122, 0.24214300513267517, 0.60797119140625, -0.48693937063217163, -0.12400144338607788, -0.04345452040433884, -0.2626437842845917, 0.3283640146255493, 0.3280520737171173, -0.10556475818157196, 0.5081458687782288, 0.6181817650794983, -0.7742388844490051, -0.4125867486000061, -0.8273694515228271, 0.05477076768875122, -0.4177124798297882, 0.1025848537683487, -0.3794015944004059, -0.9756264686584473, 0.8153084516525269, 0.2969217002391815, 0.36737677454948425, 0.2841075360774994, -0.25599852204322815, -0.27869147062301636, 0.42298296093940735, 0.2438119798898697, -0.6429527401924133, -0.3468495309352875, 1.043837070465088, 0.808510959148407, -0.6203935742378235, 0.35770633816719055, -0.6471351981163025, -0.40257033705711365, 1.2008864879608154, 0.5190561413764954, -0.12769882380962372, 0.588760256767273, 0.025718603283166885, -0.014547045342624187, 0.23062515258789062, -1.0749385356903076, -0.3120623230934143, 0.6567544937133789, 0.932494044303894, 0.7273285984992981, 0.45217812061309814, 0.23281610012054443, 0.8227006793022156, -0.48457208275794983, 0.12139637768268585, 0.7764069437980652, 0.4468608498573303, -0.13716770708560944, 0.028420457616448402, 0.2810259461402893, 0.8466088175773621, -0.9279922842979431, -0.527955174446106, 0.2320546805858612, 0.8468725085258484, 0.3284439146518707, 0.5215045213699341, 0.8811344504356384, -0.054317329078912735, 0.6777331233024597, 0.6126835346221924, 0.5139240622520447, -0.6722338795661926, -0.5267965197563171, -0.9496089816093445, -0.7311866283416748, -0.17094655334949493, -0.3739544153213501, -0.08922655880451202, -0.4440200626850128, -0.44088640809059143, 0.16986322402954102, -0.19529809057712555, 0.4570031762123108, 1.1894958019256592, 0.39748838543891907, 0.8416627049446106, -0.23359954357147217, -0.5524591207504272, -0.7161959409713745, -0.8351563215255737, 0.2021917998790741, -0.3836241066455841, -0.3583745062351227, -0.18723459541797638, -0.4250175654888153, -0.21970050036907196]}, "authors": [{"authorId": "2258551871", "name": "Simon Ouellette"}, {"authorId": "2258551294", "name": "Rolf Pfister"}, {"authorId": "2258551078", "name": "Hansueli Jud"}], "references": [{"paperId": "bab6f0823c3ca64f8c5c9f56f2467c27aabc80f6", "title": "Exploring the Long-Term Generalization of Counting Behavior in RNNs"}, {"paperId": "7691c40975cf25fae4b7a55278a65d2dcb361646", "title": "Transformers discover an elementary calculation system exploiting local attention and grid-like problem representation"}, {"paperId": "10c86505de83647c7b4157595ab10f64e97c94ef", "title": "On the Ability and Limitations of Transformers to Recognize Formal Languages"}, {"paperId": "b3564be8b79f25585acb035f3deaf4ae93c26d8f", "title": "Theoretical Limitations of Self-Attention in Neural Sequence Models"}, {"paperId": "da6ba9f19581bd7e28bc280c53385a1327eb09dd", "title": "LSTM Networks Can Perform Dynamic Counting"}, {"paperId": "ac4dafdef1d2b685b7f28a11837414573d39ff4e", "title": "Universal Transformers"}, {"paperId": "06354570d5f6be803d4a79bf59ecbb097bca8755", "title": "On the Practical Computational Power of Finite Precision RNNs for Language Recognition"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "618784f1c811dd3df9a0fb95de9868575b38f7a4", "title": "Improving the Neural GPU Architecture for Algorithm Learning"}, {"paperId": "0bb487b9cfefd56e79be0a5be5f1e05742683301", "title": "Extensions and Limitations of the Neural GPU"}, {"paperId": "5e4eb58d5b47ac1c73f4cf189497170e75ae6237", "title": "Neural GPUs Learn Algorithms"}, {"paperId": "f48eed915cbb9c6592cdb9df80c1edaeb46959af", "title": "A measure of intelligence"}, {"paperId": null, "title": "These inputs correspond to the relevant embeddings multiplied by their respective weight matrices W"}, {"paperId": null, "title": "decoder block\u2019s second attention phase, Query and Key are the encoder\u2019s output, while Value is the output of the previous attention phase (which is self-attention to the target sentence"}, {"paperId": null, "title": "\u201drel-evant embeddings\u201d fed to each of the 3 inputs (Query, Key, Value) depend on the context. For self-attention, the Query, Key and Value embeddings are the same"}, {"paperId": null, "title": "we can see 3 examples of the task to learn. Each row is an example, where the left grid is the input, and the right right is the expected output"}, {"paperId": null, "title": "Full-Transformer-CountV2"}]}