{"paperId": "d5f8cd232b66942afd985e963bc66030b8049510", "abstract": "Current large language models (LLMs) often perform poorly on simple fact retrieval tasks. Here we investigate if coupling a dynamically adaptable external memory to a LLM can alleviate this problem. For this purpose, we test Larimar, a recently proposed language model architecture which uses an external associative memory, on long-context recall tasks including passkey and needle-in-the-haystack tests. We demonstrate that the external memory of Larimar, which allows fast write and read of an episode of text samples, can be used at test time to handle contexts much longer than those seen during training. We further show that the latent readouts from the memory (to which long contexts are written) control the decoder towards generating correct outputs, with the memory stored off of the GPU. Compared to existing transformer-based LLM architectures for long-context recall tasks that use larger parameter counts or modified attention mechanisms, a relatively smaller size Larimar is able to maintain strong performance without any task-specific training or training on longer contexts.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Larimar, a recently proposed language model architecture which uses an external associative memory, is tested on long-context recall tasks including passkey and needle-in-the-haystack tests and it is demonstrated that the external memory of Larimar can be used at test time to handle contexts much longer than those seen during training."}, "embedding": {"model": "specter_v2", "vector": [-0.27711746096611023, 0.4126732349395752, -0.29223933815956116, -0.06306224316358566, -0.5835863947868347, -0.21950964629650116, 0.8972470760345459, -0.022555598989129066, -0.7715718746185303, -0.3075104057788849, 0.2638372778892517, -0.1903989613056183, 0.2857200801372528, -0.008683542720973492, 0.05496902018785477, 0.2807154059410095, -1.0388203859329224, 0.3983333110809326, 0.24951471388339996, -0.18166357278823853, -0.06033341586589813, -0.626940131187439, -0.8166598677635193, 0.11729294806718826, 0.1347760111093521, 0.3420773446559906, 0.064839668571949, 1.1519628763198853, -0.2832837700843811, 0.33585435152053833, 0.37757551670074463, -0.663198709487915, -0.010096644051373005, 0.269126832485199, -0.4216746687889099, -0.42157334089279175, 0.41949909925460815, -0.3974415063858032, -0.7882455587387085, 0.26271966099739075, -0.09228263050317764, 0.49694395065307617, 0.07715125381946564, -0.17038308084011078, -0.3273525834083557, 0.738619863986969, 0.60392826795578, 0.8648251891136169, -0.15729178488254547, -0.4775002896785736, 1.1692421436309814, -1.9073808193206787, 0.30608996748924255, 1.3843722343444824, 0.5943390130996704, 0.21687665581703186, -0.024150703102350235, -0.4362100660800934, 0.8913879990577698, -0.10496692359447479, -0.9520769715309143, -0.27356967329978943, -0.5114887952804565, 0.43739306926727295, 2.019305944442749, -0.3419610857963562, 0.03277880325913429, 0.9706641435623169, 0.18119338154792786, 1.729116439819336, -0.11537466943264008, -0.7042754292488098, -0.43610015511512756, 0.16479983925819397, 0.736224353313446, 0.9561545252799988, -0.21464700996875763, 0.31482356786727905, -0.9378432631492615, -0.1608693152666092, 0.3889830410480499, -0.088872991502285, -0.058271996676921844, 0.01850970834493637, -0.23280756175518036, 0.522722065448761, 0.4484315812587738, 0.8303374648094177, -0.1158481016755104, 0.5509586334228516, 0.2424956113100052, 0.37107041478157043, 0.0900256559252739, 0.2263719141483307, -0.17007285356521606, 0.36778292059898376, -1.3279751539230347, 0.4372658133506775, 0.06938822567462921, 0.7758595943450928, -0.4244442284107208, 0.15263265371322632, -0.8960949778556824, 0.43103814125061035, 1.1991735696792603, 0.37797635793685913, 0.8204716444015503, -0.16485920548439026, 0.20190760493278503, -0.8889306783676147, 0.1538977324962616, -0.6777670383453369, -0.3520994782447815, -0.8040550947189331, -0.18719063699245453, -1.5112875699996948, -0.45938315987586975, 0.1874639242887497, -0.5208426117897034, 0.6621930599212646, -0.18581345677375793, 0.057265520095825195, 0.12283174693584442, 0.2496645152568817, 0.39597073197364807, 0.5989860892295837, 0.5902649164199829, 0.05647747218608856, 0.9291155338287354, -1.0117645263671875, -0.47323063015937805, -1.3137011528015137, 1.0964428186416626, -0.19244123995304108, 0.5391691327095032, -0.012649321928620338, -1.456292986869812, -1.0976015329360962, -0.8079615831375122, -0.31041842699050903, -1.0175049304962158, 0.2755928635597229, 1.0093308687210083, 0.4601810872554779, -1.0647238492965698, 0.6757158637046814, -0.08215555548667908, -0.3867558240890503, 0.29275059700012207, 0.35780492424964905, 0.23307067155838013, -0.7638696432113647, -1.1250691413879395, 0.1934240311384201, 0.269487202167511, -0.5475201606750488, -0.008088318631052971, -0.37231701612472534, -1.0018788576126099, -0.058598171919584274, 0.5025650858879089, -0.3751317858695984, 1.3017634153366089, 0.0733959898352623, -0.9139899015426636, 0.8298895359039307, -0.39094242453575134, 0.014649581164121628, 0.09312501549720764, -0.45971328020095825, -0.8893029689788818, -0.3211226165294647, -0.537500262260437, 0.5382819771766663, 0.2505192160606384, -0.09573280811309814, -0.17602093517780304, 0.07779145240783691, -0.45937085151672363, -0.3112812340259552, -0.06935744732618332, 0.5783767700195312, -0.635495126247406, -0.26937568187713623, 0.3081854283809662, 0.5162769556045532, 0.3148212432861328, -0.3874358534812927, -0.01683657057583332, -1.059543251991272, 0.6417729258537292, -0.09720812737941742, 1.4082143306732178, -0.9816128611564636, -1.0841431617736816, 0.10661979019641876, -0.27726101875305176, 0.15200252830982208, -1.0177109241485596, 0.6868391633033752, -0.2137981355190277, 0.4447766840457916, 0.0916856974363327, -0.9506934881210327, 0.008932934142649174, -0.4154449701309204, -0.9505058526992798, -0.44854289293289185, 0.17965452373027802, 1.424597978591919, -1.0144163370132446, 0.08966574817895889, -0.3664523959159851, 0.1250164657831192, -0.8393841981887817, 1.2957305908203125, -0.5280689001083374, -0.26521170139312744, -0.36479899287223816, -0.3229379951953888, 0.17348496615886688, -0.22837741672992706, 0.4707355499267578, -0.15322989225387573, 0.009225225076079369, 0.571385383605957, -0.051778100430965424, 1.1599743366241455, -0.5540505647659302, 0.41584452986717224, -0.22703653573989868, -0.16538235545158386, 0.18005378544330597, 0.4300333261489868, -0.592788577079773, -0.5939849615097046, 0.24559685587882996, 0.7026456594467163, -0.63858962059021, 0.04262278228998184, 1.2597283124923706, 0.6528409719467163, -0.4121215343475342, 0.4157896041870117, 0.6314979195594788, -0.04209169000387192, 0.5145161151885986, 0.5932072997093201, 0.783262312412262, 0.5097259283065796, 0.3065502345561981, 0.0013716385001316667, 0.4582976996898651, -0.867831289768219, -0.44523417949676514, 0.7364985346794128, 0.8900979161262512, 0.7130406498908997, 0.17358769476413727, -0.5443230271339417, -0.2545817494392395, -0.21804042160511017, 0.4984169900417328, 1.2549326419830322, -0.42914149165153503, -0.26261889934539795, -0.6411736011505127, -0.5973730683326721, -0.34529635310173035, 0.3440130949020386, -0.22350949048995972, -0.4797417223453522, -0.7284945845603943, -0.9579768180847168, 0.9457265734672546, 0.47978511452674866, 1.0219752788543701, -0.758930504322052, -0.22043739259243011, -0.2544655501842499, 0.36956456303596497, -0.7137361168861389, -0.6634776592254639, 0.25288182497024536, -0.7575644254684448, -0.12213264405727386, 0.016072362661361694, 0.0598343163728714, 0.0305990781635046, -0.30327194929122925, 1.107266902923584, -0.020925594493746758, -0.3260648250579834, 0.699118435382843, 0.4718945622444153, -0.18107697367668152, -0.42918872833251953, 0.3809627592563629, 0.19541409611701965, -0.13292215764522552, 0.6258477568626404, 0.74822998046875, -0.23856700956821442, 0.09329186379909515, -0.6467588543891907, 0.003336763707920909, 0.2654614746570587, 0.1910385936498642, 0.5790398716926575, -0.5741865634918213, 0.3079293370246887, -1.4060732126235962, 0.9274261593818665, -0.08284520357847214, -0.05864260718226433, 0.6669594049453735, -0.6780458092689514, -0.39895957708358765, 0.3659347891807556, -0.7585474848747253, -0.12522444128990173, -1.4536147117614746, 0.18148882687091827, -0.07067558914422989, 0.03388097882270813, 0.40629029273986816, 0.3298491835594177, 0.44049862027168274, 0.010397621430456638, 0.4184703826904297, 0.08427450805902481, -0.1469108760356903, 0.3524478077888489, -0.8756638765335083, 0.35036081075668335, 0.07763396203517914, 0.15692222118377686, -0.4604651629924774, -0.23314236104488373, -0.6390951871871948, -0.5231181383132935, -0.319963276386261, -0.3392511010169983, -0.20804370939731598, -0.10931755602359772, -0.4212949275970459, -0.9606980085372925, -0.1839359998703003, -0.6140196919441223, -0.6928732395172119, 0.03919760882854462, -0.14149610698223114, -0.17700260877609253, -1.24326753616333, -1.4436620473861694, -0.7697702646255493, -0.42528003454208374, -0.463801771402359, 0.3824748396873474, 0.1241028755903244, -0.7411380410194397, -0.8203952312469482, -0.050653126090765, -0.517234742641449, 1.0426528453826904, -0.9597142934799194, 0.919557511806488, -0.11437486112117767, -0.5849202871322632, -0.5820519924163818, 0.2649517059326172, 0.19729134440422058, -0.6832865476608276, -0.010809707455337048, -1.0903968811035156, -0.14038145542144775, -0.050817377865314484, -0.411681205034256, 0.5072583556175232, 0.07539375126361847, 0.5825479030609131, 0.08333265036344528, -0.9816763401031494, -0.01133740320801735, 1.406714916229248, -0.586290717124939, 0.060606349259614944, -0.10048779845237732, 0.6304599046707153, 0.23504701256752014, 0.08392645418643951, 0.1532779335975647, 0.01466977410018444, 0.16486342251300812, -0.5027894377708435, -0.05295208469033241, -0.2491689771413803, -0.9348562955856323, 0.5065914988517761, 1.7228280305862427, 0.5483328700065613, -0.4365878999233246, -0.9494093656539917, 0.5181804299354553, -1.0081099271774292, -0.4105156362056732, 0.5591244697570801, 1.202890396118164, 0.18661613762378693, -0.2551611065864563, -0.4231503903865814, -0.2972012758255005, -0.0008469726890325546, 0.3404480218887329, -0.11013836413621902, -0.6860988736152649, -0.07862698286771774, 0.7792370319366455, 0.12530845403671265, 0.6831849813461304, -0.2772286832332611, 0.8349215984344482, 14.844876289367676, 0.8617530465126038, 0.030642572790384293, 0.6911404132843018, 0.5855618715286255, -0.21907846629619598, -0.313326358795166, -0.21762268245220184, -1.1862263679504395, -0.6112498641014099, 1.6459689140319824, 0.37464725971221924, 0.40927210450172424, -0.05328398942947388, -0.1317214071750641, -0.16347214579582214, -0.6884022355079651, 0.5924963355064392, 0.7996516823768616, -0.8628082871437073, 0.5703446865081787, 0.15040341019630432, 0.06756860017776489, 0.5430151224136353, 1.2143926620483398, 1.1870118379592896, 0.24994885921478271, -0.32541540265083313, 0.5318865776062012, 0.647158682346344, 0.7083272337913513, -0.05663610249757767, 0.2685372233390808, 0.3341600000858307, -0.5520617365837097, -0.418902188539505, -0.6575212478637695, -0.6155859231948853, 0.02957533858716488, -0.10570469498634338, -0.6192375421524048, -0.4705098569393158, -0.40773865580558777, 0.4623194634914398, -0.5539242625236511, 0.3941926658153534, 0.17634892463684082, 0.6621342897415161, -0.09557458013296127, 0.01723845675587654, 0.4254722595214844, 0.6015207171440125, 0.3638956844806671, 0.06389813870191574, 0.409086674451828, 0.08246848732233047, -0.07825968414545059, 0.3170796036720276, -0.5603023767471313, 0.03954411670565605, -0.6179139018058777, -0.13065144419670105, -0.2747863829135895, 0.6968372464179993, 0.30061694979667664, 0.23923996090888977, -0.38077548146247864, 0.3945721983909607, 0.9344223737716675, 0.4207760989665985, -0.01427452638745308, 0.523425817489624, 0.0964759960770607, -0.21949632465839386, 0.25067779421806335, 0.10949095338582993, 0.13612176477909088, -0.5262863039970398, -0.5428804159164429, -0.30511581897735596, 0.48126885294914246, -0.8117251992225647, -0.5942667722702026, 0.9487923383712769, -0.3802186846733093, -0.4695096015930176, 0.13667705655097961, -1.06458580493927, -0.14541488885879517, 0.3105486333370209, -1.3296356201171875, -0.6685968041419983, 0.5390876531600952, -0.3459666073322296, -0.21257758140563965, 0.030282359570264816, 1.4828308820724487, -0.0043348283506929874, -0.31218186020851135, 0.34572741389274597, 0.05937180295586586, -0.04293708875775337, -0.05363777279853821, -0.5218353271484375, 0.552108645439148, 0.13902534544467926, 0.3248263895511627, 0.8255296349525452, -0.20453913509845734, -0.07038506865501404, -0.9259454011917114, -0.12610146403312683, 0.9218979477882385, -1.4001948833465576, -0.6129829287528992, -0.8227155208587646, -0.9443079233169556, 0.5166910886764526, 0.35657021403312683, -0.11213453859090805, 0.5369694232940674, 0.48774537444114685, -0.7598575353622437, -0.22836969792842865, -0.5889672040939331, 0.4019639790058136, 0.39403799176216125, -0.8502623438835144, -0.15717409551143646, -0.14232566952705383, 0.19088232517242432, -0.877234697341919, -0.23778480291366577, -0.41180917620658875, 0.12474136799573898, -0.10757576674222946, 0.8993585705757141, -0.4546651542186737, 0.6645781993865967, 0.9569267630577087, -0.05841881409287453, -0.7562150359153748, 0.025294136255979538, -0.4086143672466278, -0.09814959764480591, 0.3104204535484314, 0.8541937470436096, -0.5382336378097534, -0.3024541735649109, 1.0595872402191162, 0.4838479459285736, -0.6098719239234924, -0.38908037543296814, -0.21183311939239502, 0.3706425428390503, -0.5369061231613159, 0.13575385510921478, -0.3512103259563446, 0.026206357404589653, 0.2139653116464615, 0.7423287034034729, 0.6955878734588623, -0.47396185994148254, -0.7103328704833984, 0.3507273197174072, 0.10530154407024384, -0.028442198410630226, -0.46343693137168884, -0.19239892065525055, -1.5239205360412598, -0.1931220144033432, -1.374495267868042, -0.12387458980083466, -0.6110717058181763, -0.5599697232246399, -0.18420201539993286, -0.372414231300354, -0.28096142411231995, 0.2239159345626831, -0.3597525656223297, -0.5626996159553528, -0.7584245800971985, -0.747735321521759, 0.5296021103858948, 0.620937168598175, -0.5310739874839783, 0.16513368487358093, -0.1169402226805687, 0.2701523005962372, -0.0067962161265313625, 0.3217746317386627, -0.477058470249176, -0.8040177226066589, -1.2180737257003784, 0.612411618232727, 0.08325457572937012, 0.12493541091680527, -0.9977045655250549, 0.6847468614578247, 0.6332820653915405, 0.18139924108982086, -0.07740963250398636, 0.44180458784103394, -0.8569995760917664, -0.7303135395050049, 0.13774646818637848, -0.9674055576324463, 0.5724100470542908, 0.44943636655807495, -0.4448948800563812, -0.2881048619747162, 0.5411750078201294, -0.40647321939468384, -1.1346056461334229, -0.4698024392127991, 0.4240168035030365, -0.6822222471237183, -0.05097825452685356, -0.5481808185577393, 0.07038530707359314, -1.0590163469314575, -0.2040073275566101, 3.264398401370272e-05, 0.6443800330162048, -0.3174434304237366, 1.2747323513031006, 0.5124885439872742, -0.9398728609085083, 0.20291666686534882, 0.5011518001556396, -0.027525058016180992, -0.19967308640480042, 0.8478797674179077, 0.4486982524394989, -0.09807530045509338, 0.6890642642974854, 0.6944872736930847, 0.39515191316604614, -0.9576821327209473, 0.3013433814048767, 0.8100039958953857, -0.7930057644844055, -0.30982574820518494, 0.8993947505950928, -0.21138978004455566, -1.1039050817489624, -0.18270224332809448, -1.0733246803283691, -0.4521632492542267, -0.5870649814605713, 0.8617174029350281, -0.20917019248008728, 0.1406015157699585, 0.21913936734199524, -0.1420212984085083, 0.20679940283298492, -0.3365497291088104, -0.8247181177139282, 0.3988601565361023, -0.32435646653175354, -0.27497920393943787, 1.082758903503418, 0.743610680103302, -0.40287092328071594, -0.3966575860977173, -0.7895404100418091, -0.20427371561527252, -0.16161999106407166, 0.3202638030052185, -0.5398072600364685, -0.3941119313240051, 0.7990850806236267, 0.593899130821228, 0.3143664598464966, -0.1499185413122177, -0.3474242687225342, 0.35757407546043396, 0.8492076992988586, 0.23437736928462982, -0.7711954712867737, -0.378306120634079, 1.5452229976654053, 1.1859490871429443, -0.5257619619369507, 0.035461846739053726, -0.051140934228897095, -0.44190913438796997, 0.8919718265533447, 0.34497085213661194, -0.09379393607378006, 1.0545029640197754, -0.15388794243335724, 0.13281665742397308, 0.04909448325634003, -1.3417329788208008, -0.045143261551856995, 0.7456281781196594, 0.6864799857139587, 1.046556830406189, 0.363349974155426, -0.10795281082391739, 1.0253498554229736, -0.0455169752240181, 0.16604000329971313, 0.33125466108322144, 0.47701430320739746, -0.07010982930660248, -0.32818204164505005, 0.05493323877453804, 0.5225415229797363, -0.7396024465560913, -0.8441592454910278, 0.35751625895500183, 0.8398188352584839, 0.019294502213597298, 0.4507574737071991, 0.9776342511177063, 0.369596391916275, 0.5000144243240356, 1.0410157442092896, 0.7839444279670715, -0.5030707716941833, -0.6482171416282654, -0.4469585418701172, -0.4167676866054535, 0.04596185311675072, 0.1899253875017166, -0.6068549156188965, -0.2947251498699188, -0.09585375338792801, 0.451251357793808, -0.13277189433574677, -0.12702034413814545, 1.1040798425674438, 0.4096543490886688, 0.3691810369491577, -0.4600425064563751, 0.01361026056110859, -0.29823818802833557, -0.9294342398643494, -0.1611694097518921, -0.528566837310791, -0.1762041449546814, -0.12758402526378632, 0.20911788940429688, -0.5929790139198303]}, "authors": [{"authorId": "2292186979", "name": "Elliot Nelson"}, {"authorId": "2282965905", "name": "Georgios Kollias"}, {"authorId": "2294567177", "name": "Payel Das"}, {"authorId": "2273691507", "name": "Subhajit Chaudhury"}, {"authorId": "2292199652", "name": "Soham Dan"}], "references": [{"paperId": "89d786457591d39091cf6ef4831f2bbd72698caf", "title": "TransformerFAM: Feedback attention is working memory"}, {"paperId": "3fd5bc3077d04965eaa3498372c39bbdd09d55e4", "title": "Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"}, {"paperId": "5372f4364fe5b7991c81ea19ee944c717afe6e0a", "title": "Larimar: Large Language Models with Episodic Memory Control"}, {"paperId": "817f5a9504e59a6afc83cc745dff758f59e0b0a4", "title": "In Search of Needles in a 11M Haystack: Recurrent Memory Finds What LLMs Miss"}, {"paperId": "60b35c6d68acced19b0c66edcfc0ee0a2c11efed", "title": "Landmark Attention: Random-Access Infinite Context Length for Transformers"}, {"paperId": "42a14d824caa3348046eb34c37e2ab7985faa7a3", "title": "High-throughput Generative Inference of Large Language Models with a Single GPU"}, {"paperId": "51bf7a3aee6b1f61b902625f6badffedf200d31a", "title": "Rewriting a Deep Generative Model"}, {"paperId": "168fc3525f7b97695a97b04e257ee9bd1e832acb", "title": "Memory Transformer"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "00696ba295d66f049d70272219f7fea4266171be", "title": "Optimus: Organizing Sentences via Pre-trained Modeling of a Latent Space"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "bb84fa21b9376e3fcbd3f69b0659066d6f275834", "title": "Representation of Associated Data by Matrix Operators"}, {"paperId": "5bbc8681584b307eff08ebcaf1bbef4cc91bdd16", "title": "Generative Pseudo-Inverse Memory"}, {"paperId": null, "title": "Potential Risks paper describes an approach to long-context"}, {"paperId": null, "title": "2023. Needle In A Haystack - pressure testing LLMs"}, {"paperId": null, "title": "recall for language models using an external memory. Language models with increased memory and recall capabilities introduce potential risks via mis-use, and should only be deployed with appropriate"}]}