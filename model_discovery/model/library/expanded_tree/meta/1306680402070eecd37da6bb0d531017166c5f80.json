{"paperId": "1306680402070eecd37da6bb0d531017166c5f80", "abstract": "Autoregressive models are now capable of generating high-quality minute-long expressive MIDI piano performances. Even though this progress suggests new tools to assist music composition, we observe that generative algorithms are still not widely used by artists due to the limited control they offer, prohibitive inference times or the lack of integration within musicians' workflows. In this work, we present the Piano Inpainting Application (PIA), a generative model focused on inpainting piano performances, as we believe that this elementary operation (restoring missing parts of a piano performance) encourages human-machine interaction and opens up new ways to approach music composition. Our approach relies on an encoder-decoder Linear Transformer architecture trained on a novel representation for MIDI piano performances termed Structured MIDI Encoding. By uncovering an interesting synergy between Linear Transformers and our inpainting task, we are able to efficiently inpaint contiguous regions of a piano performance, which makes our model suitable for interactive and responsive A.I.-assisted composition. Finally, we introduce our freely-available Ableton Live PIA plugin, which allows musicians to smoothly generate or modify any MIDI clip using PIA within a widely-used professional Digital Audio Workstation.", "venue": "arXiv.org", "year": 2021, "citationCount": 21, "influentialCitationCount": 4, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work presents the Piano Inpainting Application (PIA), a generative model focused on inpainting piano performances, as it believes that this elementary operation (restoring missing parts of a piano performance) encourages human-machine interaction and opens up new ways to approach music composition."}, "embedding": {"model": "specter_v2", "vector": [0.678108274936676, 0.6418560743331909, -0.007216733414679766, 0.747309684753418, -1.0600789785385132, -0.045513175427913666, 0.30845561623573303, -0.5753177404403687, 0.6160779595375061, -0.37103378772735596, 0.770601749420166, 0.47399547696113586, -0.5522546172142029, 0.06504236906766891, -0.44254520535469055, -0.4017907679080963, -1.174898386001587, 0.3254756033420563, -0.051993343979120255, -0.07859443128108978, 0.026461737230420113, -0.3415766656398773, -1.1698933839797974, 0.7562666535377502, 0.18712638318538666, 1.1421809196472168, -0.04637826606631279, 1.2274233102798462, -0.017634542658925056, 0.6551992893218994, 0.5802025198936462, -0.304516464471817, 0.4778740704059601, -0.611480712890625, 0.03589474782347679, 0.06409960985183716, 0.4207766354084015, -0.16204413771629333, -0.341308057308197, 0.24983544647693634, -0.21201713383197784, 0.048079926520586014, 0.8971011638641357, -0.5629571080207825, -0.270677775144577, 0.6589069366455078, 0.5940077900886536, 0.7810744643211365, 0.21194638311862946, -0.7876535654067993, 1.310727596282959, -1.3457996845245361, -0.03587106987833977, 1.721306324005127, 1.07584810256958, 0.07020650804042816, -0.2843207120895386, -0.2620123028755188, 0.16823183000087738, 0.2724112868309021, -0.5010516047477722, -0.6476035714149475, 0.4942784607410431, -0.250869482755661, 1.0287326574325562, -0.05549783259630203, 0.2640640437602997, 0.2794879674911499, 0.4416905641555786, 1.6191225051879883, -0.24443994462490082, -1.1434991359710693, 0.062254149466753006, -0.10987691581249237, -0.4101063311100006, 0.4832647144794464, -0.9529051184654236, 0.6117569804191589, -1.2943114042282104, 0.04504542052745819, 0.9118313193321228, -0.2561214864253998, 0.06552940607070923, 0.020788822323083878, 0.09258167445659637, 0.4703700840473175, 0.25634151697158813, 1.008798599243164, -0.49339213967323303, 0.9727184176445007, 0.49179890751838684, 0.3358283042907715, -0.1326650083065033, 0.39822930097579956, 0.27506765723228455, -0.007812084164470434, -0.8411809206008911, 0.12725289165973663, 0.19518063962459564, 0.3814055919647217, -0.4421740770339966, 0.4831281304359436, -0.842850387096405, 0.4282759726047516, 1.0158815383911133, -0.3826216757297516, 0.6302266120910645, -1.1302754878997803, 0.1592360883951187, -1.115890383720398, 0.11539479345083237, -0.8673600554466248, -0.08093442022800446, -0.22964787483215332, -0.8104472756385803, -0.4193863570690155, -0.39626607298851013, 0.3492544889450073, -0.6663447022438049, 0.2695513665676117, -0.43460240960121155, 0.26365429162979126, -0.14261245727539062, 0.2451794594526291, 0.15073324739933014, 0.8882094025611877, -0.2937116026878357, -0.19697599112987518, 1.0440406799316406, -0.8755528926849365, -0.7913148403167725, -0.7549439072608948, -0.3241894841194153, -0.3781244456768036, 0.3063896894454956, 0.48091915249824524, -1.7529727220535278, -1.1998244524002075, -0.7617789506912231, -0.18480396270751953, 0.38364177942276, 0.3716961741447449, 1.2259477376937866, 0.05281934514641762, -0.8281872868537903, 1.0297919511795044, -0.3095863461494446, 0.3319522440433502, 0.4550492763519287, -0.13155850768089294, 0.32327502965927124, -0.007630240637809038, -0.6441800594329834, -0.4201861321926117, -0.27839285135269165, -0.40320271253585815, -0.21933715045452118, -1.0680369138717651, -0.7174624800682068, 0.26674455404281616, 0.2813120186328888, -0.6409536004066467, 1.2399687767028809, -0.3159216046333313, -1.583513855934143, 0.22151465713977814, -0.25997215509414673, -0.15308836102485657, 0.22058801352977753, -0.4998473823070526, -0.25777778029441833, 0.017421195283532143, -0.06765713542699814, 0.41625499725341797, 0.8057266473770142, -0.44652995467185974, -0.2082279473543167, 0.11250065267086029, -0.27079927921295166, -0.14946794509887695, 0.15600456297397614, 0.7081030011177063, -0.7305514216423035, -0.8886705636978149, 0.742268443107605, 0.3225407302379608, 0.07942774146795273, 0.07928283512592316, -0.4011077284812927, -0.3802093267440796, 0.808797299861908, -0.44027113914489746, 1.0615609884262085, -1.1969507932662964, -0.514312744140625, -0.1943899393081665, -0.6835218071937561, -0.6569120287895203, -0.5259830355644226, 0.6084801554679871, -0.41909554600715637, -0.07374389469623566, -0.0002733457658905536, -0.7118016481399536, -0.16256967186927795, -0.23934750258922577, -1.226599097251892, -0.7311971187591553, 0.5021740198135376, 1.09666907787323, -0.6353052854537964, 0.015418882481753826, -0.217732772231102, 0.39216330647468567, -0.9679709672927856, 1.0448483228683472, -0.3711302876472473, 0.6281456351280212, -0.10379683971405029, 0.2817958891391754, -0.22454923391342163, 0.32218778133392334, -0.04092332720756531, -0.579410970211029, 0.11411559581756592, 0.8581888675689697, -0.6710714101791382, 1.4688259363174438, -0.4852748215198517, 0.34685397148132324, 0.13231395184993744, -0.7182689309120178, 0.18921582400798798, 0.8773580193519592, 0.2045697420835495, -0.36394020915031433, 0.2553980052471161, 0.1490250676870346, -0.5435371398925781, 0.1745443493127823, 0.3900202810764313, 0.2646998167037964, -0.428722083568573, 0.23891142010688782, 0.7280488610267639, -0.7583789229393005, 0.6797369122505188, 0.2847785949707031, 0.5002511143684387, 0.9182909727096558, 0.2750740349292755, 0.2596183121204376, 0.012776263989508152, -0.7288293242454529, 0.3303501009941101, 0.5657879114151001, 0.844441831111908, 1.8007911443710327, 0.5713086128234863, -0.6721005439758301, -0.12025677412748337, -0.12138048559427261, 1.0301529169082642, 1.0464519262313843, -0.6146643161773682, -0.01518437173217535, -0.5963485240936279, 0.11264687031507492, -0.32272645831108093, -0.10165689885616302, -0.6477170586585999, -0.06198763847351074, -0.3043212592601776, -0.5489273071289062, 0.6590971946716309, 0.5325632691383362, 0.66335129737854, -1.1631284952163696, 0.041035473346710205, 0.18604229390621185, 0.34450680017471313, -0.11519521474838257, -0.7658568024635315, 0.3928283452987671, -0.7633951902389526, 0.016913827508687973, -0.06860309839248657, -0.1685859113931656, -0.3837020993232727, -0.9217023253440857, 1.0513406991958618, -1.0565645694732666, -0.9539693593978882, 0.2961096167564392, 0.7797537446022034, -0.9369465112686157, -0.9694110155105591, -0.24234996736049652, -0.15990924835205078, 0.0019978752825409174, -0.48073580861091614, -0.7315971255302429, 0.2373688966035843, -0.2827920615673065, -0.3805318772792816, 0.16499263048171997, 0.019110197201371193, -0.16489094495773315, 1.2440470457077026, -0.1348712146282196, -0.03281784802675247, -0.9519214630126953, 1.0256856679916382, 0.3466627597808838, -0.18191100656986237, -0.10583259910345078, -0.15528614819049835, -0.2446107417345047, 0.4302762746810913, -0.660355269908905, -0.4562549591064453, -0.6433831453323364, 0.0968896672129631, -0.3868245780467987, -0.3798462152481079, 0.10021133720874786, 0.04229893907904625, 0.4409898519515991, 0.4011967182159424, 0.2142307609319687, 0.260309100151062, -0.4368113577365875, 0.47889986634254456, -1.3121535778045654, 0.8906245827674866, 0.0779862031340599, 0.33080658316612244, 0.0679503083229065, 0.11907326430082321, -0.26757118105888367, -0.4119724929332733, -0.23117202520370483, -0.4802838861942291, -0.6995293498039246, -0.0865514799952507, -0.538224458694458, -0.6925112009048462, -0.34016573429107666, -0.7095697522163391, -0.011776810511946678, -0.5804582238197327, -0.31254178285598755, -1.1099424362182617, -1.1013152599334717, -1.2295377254486084, -0.890049159526825, -0.7708570957183838, -0.7667176723480225, 0.34416463971138, 0.32539546489715576, -0.4686813950538635, -0.2996363043785095, 0.21124443411827087, -0.23152288794517517, 0.6097410917282104, -0.3136671185493469, 0.5633223652839661, 0.5887318253517151, -0.4163320064544678, -0.11252783983945847, 0.6179591417312622, 0.47163301706314087, 0.24074724316596985, 0.3270041048526764, -0.7405305504798889, 0.7593931555747986, -0.22885408997535706, -0.25010982155799866, 0.2079174816608429, 0.4773772954940796, 0.35537391901016235, -0.14534425735473633, -0.20302245020866394, 0.2769198715686798, 0.9862929582595825, 0.14267198741436005, 0.49154800176620483, 0.013785192742943764, 0.6397024393081665, 0.29539525508880615, 0.14335143566131592, 0.6055677533149719, -0.6712883114814758, 0.5725552439689636, -0.005288470070809126, 0.13527612388134003, -0.831291675567627, -0.9916660189628601, 0.5151399374008179, 1.0576581954956055, -0.1837441474199295, 0.4399605393409729, -0.34082671999931335, 0.6761066317558289, -1.1625927686691284, -1.0919567346572876, 1.0033175945281982, 0.6321114301681519, 0.37325239181518555, -0.32002776861190796, -0.12587010860443115, 0.6577327251434326, -0.01710759475827217, -0.05101326107978821, -0.33160749077796936, -0.8167904615402222, 0.16592444479465485, 0.5667018294334412, -0.5683461427688599, 0.6419240832328796, -0.35224562883377075, -0.035787906497716904, 14.883264541625977, 1.0773440599441528, -0.050401363521814346, 0.19541513919830322, 0.6982606649398804, 0.3098943829536438, -0.3393888771533966, -0.05161570385098457, -0.6518467664718628, -0.21668709814548492, 0.83598792552948, 0.3515118360519409, 0.8641455769538879, 0.4081956148147583, 0.3938555419445038, 0.4486686587333679, -0.4078422784805298, 0.7299664616584778, 0.4863934814929962, -1.3648114204406738, 0.41293665766716003, 0.241376593708992, 0.4518491327762604, -0.038886673748493195, 0.7417815923690796, 0.5290660262107849, -0.07983039319515228, -0.2951411008834839, 0.6981344819068909, 0.6717559695243835, 0.7149847149848938, -0.42118459939956665, -0.29931631684303284, 0.1736408919095993, -1.1251554489135742, -0.48173269629478455, -0.42851272225379944, -1.070468783378601, 0.44187894463539124, 0.1766645908355713, -0.6207916140556335, -0.3960229158401489, 0.3638635277748108, 0.6692872643470764, 0.3287033438682556, 0.4959270656108856, -0.2658016085624695, 0.9857421517372131, -0.23155948519706726, 0.8705726861953735, -0.22664883732795715, -0.03187258169054985, 0.4075216054916382, -0.30044201016426086, 0.6375539302825928, 0.30919158458709717, -0.31545573472976685, 0.6805025935173035, -0.35062795877456665, -0.06450226902961731, -0.43575212359428406, -0.15723618865013123, -0.7491111159324646, 0.9020546674728394, 0.44538092613220215, 0.6207185983657837, 0.016763869673013687, 0.5509182214736938, 0.040059201419353485, 0.041965387761592865, -0.14130540192127228, -0.09349024295806885, 0.31340691447257996, 0.2257985770702362, 0.3197580575942993, 0.7839086055755615, -0.47322526574134827, -0.2234210968017578, -0.40428751707077026, -0.28024858236312866, 0.24238154292106628, -1.2708309888839722, -0.9523798227310181, 1.1015653610229492, -0.2393326312303543, -1.0106042623519897, -0.17939791083335876, -0.2719699740409851, -0.8093752861022949, 0.08548897504806519, -0.6489527225494385, -0.6261210441589355, 0.24981631338596344, -0.46521344780921936, -0.0703587457537651, 0.06782858073711395, 1.0127875804901123, 0.13584370911121368, 0.19799396395683289, -0.04168223589658737, 0.31368038058280945, -0.46056637167930603, -0.08305945992469788, -0.7204198241233826, 0.570962131023407, 0.28348812460899353, 0.7496693134307861, -0.3063230514526367, 0.366925448179245, 0.5637528300285339, -0.41936469078063965, 0.25160282850265503, 0.3740885257720947, -0.722263753414154, -0.4879962205886841, -0.4358505606651306, -0.9677625894546509, 0.27876025438308716, 0.2817503809928894, -0.1811937689781189, 0.347038596868515, -0.1937357783317566, -0.10318975895643234, -0.6100805401802063, -0.8887430429458618, -0.24205568432807922, 0.25694510340690613, -0.35870981216430664, -0.3841434717178345, -0.1196388378739357, 0.17261894047260284, -0.6628133058547974, -0.39471328258514404, -0.3908359408378601, 0.43914252519607544, -0.6484311819076538, 1.113079309463501, -0.030898025259375572, 0.7975729703903198, 0.49200543761253357, 0.1321430802345276, -0.7123191356658936, -0.3919033110141754, -1.304721713066101, -0.006829026620835066, 0.7067602872848511, 0.24264687299728394, 0.1501334011554718, 0.5586488842964172, 0.5148683190345764, -0.15095262229442596, -0.2912757396697998, -0.6363016963005066, 0.009386282414197922, -0.1941530704498291, -0.8888011574745178, -0.2064022272825241, -0.9804760217666626, -0.10844039171934128, 0.08514806628227234, 0.03711122274398804, 0.4575542211532593, -0.19048874080181122, -0.16216622292995453, 0.5111966133117676, -0.10790175199508667, -0.5793842077255249, -0.17519885301589966, -0.34967267513275146, -1.1281547546386719, -0.6551832556724548, -0.7656351923942566, 0.22257013618946075, -1.1275415420532227, -0.4883717894554138, 0.27699071168899536, -0.26120737195014954, -0.09731623530387878, 0.5141158699989319, 0.26795336604118347, -0.013089090585708618, -0.3241004943847656, -0.3141929805278778, 0.6637987494468689, 1.2291021347045898, -0.9647243618965149, -0.39441245794296265, 0.42030206322669983, -0.3509017527103424, 0.6425055861473083, 0.1780538111925125, -0.544567346572876, -0.8643484115600586, -0.5976195931434631, 0.014126276597380638, 0.19165551662445068, -0.13567307591438293, -1.7979778051376343, 0.48102593421936035, 0.6931478977203369, 0.20200397074222565, -0.2282545119524002, 0.5901340842247009, -0.8708808422088623, 0.2821327745914459, 0.05310104042291641, -0.8081734776496887, -0.16097836196422577, 0.252402126789093, -0.522668182849884, -0.8213033080101013, 0.5073801279067993, -0.023089943453669548, -0.9797182679176331, -0.5431315302848816, 0.2454720139503479, -0.7245110869407654, -0.14983858168125153, -0.6069702506065369, -0.19877290725708008, -0.010004020296037197, -0.744016170501709, -0.4179403781890869, -0.5534370541572571, -0.6669686436653137, 0.9650865197181702, 0.21978382766246796, -1.2270172834396362, 0.2804204225540161, 0.5322771668434143, -0.1332152932882309, -0.31341198086738586, 0.853122353553772, 0.2637617588043213, -0.28015992045402527, 0.29145941138267517, -0.19272123277187347, 0.25579652190208435, -0.7606295347213745, -0.004461144562810659, 0.7057369947433472, -0.9544191956520081, -0.35415446758270264, 0.8582866787910461, -0.047038543969392776, -0.501218855381012, 0.0012864868622273207, -1.1817070245742798, -0.6884276270866394, -0.19722025096416473, 1.1284043788909912, 0.09128382056951523, -0.16666153073310852, 0.10030429810285568, -0.06713207811117172, 0.6067941784858704, 0.18547670543193817, -0.8490196466445923, 0.4944700598716736, -0.012505223043262959, -0.08276652544736862, 0.8049336671829224, 0.3701587915420532, -0.13552460074424744, -1.2596338987350464, -0.3403480350971222, -0.8429265022277832, -0.22422553598880768, -0.13868512213230133, -0.5702334642410278, -0.818698525428772, 0.9123244285583496, 0.6448954939842224, 0.11818839609622955, 0.6203028559684753, 0.10891854763031006, 0.2824641764163971, 0.2950282096862793, 0.06980252265930176, -0.44098398089408875, 0.18313533067703247, 0.8279228210449219, 1.8324179649353027, -0.3007620573043823, 0.32478147745132446, -0.39245617389678955, -1.0413717031478882, 0.9407376050949097, -0.18540053069591522, -0.3659636676311493, 1.2121201753616333, 0.10361170768737793, 0.22943240404129028, 0.4242722988128662, -1.0075675249099731, 0.06439525634050369, 1.0977838039398193, 1.3933876752853394, 0.708574116230011, -0.004307376686483622, 0.19010140001773834, 1.5059077739715576, -0.09414815157651901, 0.5344231724739075, 0.3157842755317688, 0.4037497043609619, -0.06545354425907135, -0.00838131457567215, -0.480474591255188, 0.38359564542770386, -0.8924785852432251, -0.12022346258163452, 0.25896772742271423, 0.4603785574436188, 0.48733219504356384, 0.7479286193847656, 0.7561783790588379, 0.1879565268754959, 0.8853147625923157, 0.04115622490644455, 0.7187252640724182, -0.3256012499332428, -0.403249055147171, 0.3829285502433777, -1.0055209398269653, -0.14739850163459778, 0.1466892510652542, -0.6251027584075928, -0.342855304479599, 0.47910985350608826, 0.5930320024490356, 0.17451104521751404, 0.13931307196617126, 0.5845104455947876, 1.0626890659332275, 0.7007006406784058, -0.4202784597873688, -1.2336580753326416, -0.01560825016349554, -1.010835886001587, -0.2941892445087433, -0.3535802960395813, -0.3816743493080139, -0.37826669216156006, -0.1991281360387802, 0.34908443689346313]}, "authors": [{"authorId": "3254356", "name": "Ga\u00ebtan Hadjeres"}, {"authorId": "3468368", "name": "L\u00e9opold Crestel"}], "references": [{"paperId": "9030732d41b53dbe1bed8d301da61a63ddda40e1", "title": "MuseNet"}, {"paperId": "eb0931c39904a40c6cb4aa35c9b21d5e3b7dc856", "title": "Compound Word Transformer: Learning to Compose Full-Song Music over Dynamic Directed Hypergraphs"}, {"paperId": "415ce76382607e7253cdf5085945bbf37a932142", "title": "GiantMIDI-Piano: A large-scale MIDI dataset for classical piano music"}, {"paperId": "850a42d3d57d6658cc63be4e8021bab33d0c91dd", "title": "High-Resolution Piano Transcription With Pedals by Regressing Onset and Offset Times"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "de7032ee638659b93e0b5e3684ab0327f3ba16fb", "title": "Vector Quantized Contrastive Predictive Coding for Template-based Music Generation"}, {"paperId": "b45d656ac8cc2e940609580cf291ee76ffcac20a", "title": "On Layer Normalization in the Transformer Architecture"}, {"paperId": "ce510c6cfeac703706460680e977c54554840830", "title": "Pop Music Transformer: Beat-based Modeling and Generation of Expressive Pop Piano Compositions"}, {"paperId": "59a916cdc943f0282908e6f3fa0360f4c5fb78d0", "title": "Stabilizing Transformers for Reinforcement Learning"}, {"paperId": "936d8c76f130aa1a8eb3d994ddfc6e632edaef7a", "title": "Image Inpainting: A Review"}, {"paperId": "e3fa5116ac050a61682093df07c117718536a074", "title": "NONOTO: A Model-agnostic Web Interface for Interactive Music Composition by Inpainting"}, {"paperId": "93a4b704ac9034ac76c1329ddb946f45b0f6f88d", "title": "Approachable Music Composition with Machine Learning at Scale"}, {"paperId": "24a70db0bbb5f486126477e32a6a44ab917a4b11", "title": "LakhNES: Improving Multi-instrumental Music Generation with Cross-domain Pre-training"}, {"paperId": "f1ad8c2e6327ebbefb734ad79980f1f6241eca4f", "title": "Learning to Traverse Latent Spaces for Musical Score Inpainting"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "cf4aa38ae31b43fd07abe13b4ffdb265babb7be1", "title": "The Curious Case of Neural Text Degeneration"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "dea40e67081e8342d7dcbf4ab9b5ce8845ca9915", "title": "Anticipation-RNN: enforcing unary constraints in sequence generation, with application to interactive music generation"}, {"paperId": "71e5a76ea53877e6d295dad67759a3683636854f", "title": "Piano Genie"}, {"paperId": "fb507ada871d1e8c29e376dbf7b7879689aa89f9", "title": "Music Transformer: Generating Music with Long-Term Structure"}, {"paperId": "0ec95fac7c5a923862ef4d443bbda2bd1e37f8a1", "title": "This time with feeling: learning expressive musical performance"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "719f830664832afe8b1e4d0b5691b24e616cc167", "title": "GLSR-VAE: Geodesic latent space regularization for variational autoencoder architectures"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "a066233a0b52a0e07197540ff2c73f42daf198f4", "title": "DeepBach: a Steerable Model for Bach Chorales Generation"}, {"paperId": "bc606e5b684fc95227edad4cc6451baefd5c5573", "title": "Modelling Symbolic Music: Beyond the Piano Roll"}, {"paperId": "1680c198b166a77ae639b8d3747ebf9d933b57cd", "title": "Magenta Studio: Augmenting Creativity with Deep Learning in Ableton Live"}]}