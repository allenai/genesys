{"paperId": "e28f4687b9ddf562807d12d9799add07aa191d51", "abstract": "Self-attention matrices of Transformers are often highly sparse because the relevant context of each token is typically limited to just a few other tokens in the sequence. To reduce the computational burden of self-attention on Transformer inference, we propose static, structured, sparse attention masks that split attention matrices into dense regions, skipping computations outside these regions while reducing computations inside these regions. To support the proposed mask structure, we design an entropy-aware finetuning algorithm to naturally encourage attention sparsity while maximizing task accuracy. Furthermore, we extend a typical dense deep learning accelerator to efficiently exploit our structured sparsity pattern. Compared to a dense baseline, we achieve 56.6% reduction in energy consumption, 58.9% performance improvement with <1% accuracy loss and 2.6% area overhead.", "venue": "Design Automation Conference", "year": 2023, "citationCount": 4, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work proposes static, structured, sparse attention masks that split attention matrices into dense regions, skipping computations outside these regions while reducing computations inside these regions to reduce the computational burden of self-attention on Transformer inference."}, "embedding": {"model": "specter_v2", "vector": [0.20171363651752472, 0.8368098139762878, -0.6631073355674744, 0.27493494749069214, -0.21364447474479675, -0.10354815423488617, 0.5937330722808838, 0.13263370096683502, -0.1179528757929802, -0.2881180942058563, 0.739439845085144, 0.17008130252361298, 0.8773133158683777, -0.08340834081172943, -0.29620540142059326, 0.19041500985622406, -0.8403217196464539, 0.2790725529193878, 0.374735563993454, -0.06587148457765579, 0.08321920782327652, -0.8260108232498169, -1.3040111064910889, 0.2324296087026596, 0.500141441822052, 0.8905429244041443, 0.42081135511398315, 0.31293612718582153, -0.6719632744789124, 0.7866083383560181, 0.29971635341644287, -0.2928287386894226, 0.10763586312532425, 0.16089676320552826, -0.5026530027389526, -0.34950268268585205, 0.22700011730194092, -0.19225500524044037, -0.5062096118927002, 0.9819809198379517, -0.30422618985176086, 0.13971251249313354, 0.18795208632946014, -0.7809432744979858, -0.08015083521604538, 1.0800395011901855, 0.4702930152416229, 0.9997218251228333, -0.47934576869010925, -0.6320635080337524, 1.515072226524353, -1.3620517253875732, 0.027153385803103447, 1.2713751792907715, 0.21639901399612427, 0.1770719587802887, -0.11383325606584549, -0.6398618817329407, 0.8851444721221924, 0.6742499470710754, -0.751586377620697, -0.6040520071983337, -0.017086081206798553, -0.15509477257728577, 2.353977918624878, -0.4103474020957947, 0.4622151553630829, 0.3516737222671509, 0.0316113717854023, 1.5514172315597534, -0.23131564259529114, -0.5910835266113281, -0.11188675463199615, -0.06514755636453629, 0.3630644381046295, 0.9227066040039062, -0.08773398399353027, 0.08656129240989685, -1.2789758443832397, 0.053252775222063065, 0.2745189368724823, 0.019070081412792206, 0.7202611565589905, -0.2382841408252716, -0.22737866640090942, 0.49376893043518066, 0.19898779690265656, 1.0825128555297852, -0.18528451025485992, 0.8052424192428589, 0.9939291477203369, 0.02831360511481762, -0.23501615226268768, 0.30496788024902344, 0.16757139563560486, -0.12675637006759644, -0.8965334892272949, 0.023595008999109268, -0.09328794479370117, 0.9919353127479553, 0.023232683539390564, 0.8923125863075256, -0.9084186553955078, 0.042528726160526276, 1.0677322149276733, 0.2900239825248718, 0.5004948973655701, -0.172184020280838, 0.25750091671943665, -0.6975646018981934, -0.14861883223056793, -0.4843541979789734, 0.21814687550067902, -0.3292093575000763, -0.9558418393135071, -1.2616604566574097, -0.5715266466140747, 0.42386433482170105, -0.8639514446258545, 0.4842524528503418, -0.5358991026878357, 0.4388008713722229, -0.3091086447238922, 0.10380113124847412, 0.4526631832122803, 0.3576970398426056, 0.06553426384925842, 0.27385127544403076, 1.2793469429016113, -1.2387222051620483, -0.9174700379371643, -1.155613660812378, 0.24129831790924072, -0.35957422852516174, -0.09665802866220474, -0.3081775903701782, -1.2753058671951294, -0.7644336819648743, -0.653378427028656, -0.06193799525499344, -0.4922686815261841, -0.19638492166996002, 1.1123042106628418, 0.34949991106987, -1.2634457349777222, 0.5049772262573242, -0.6042576432228088, 0.22393295168876648, 0.7846186757087708, 0.3414188623428345, 0.6658753156661987, -0.03697822988033295, -1.5191680192947388, 0.5103200078010559, 0.16831918060779572, -0.6922917366027832, -0.6333396434783936, -0.8512418866157532, -1.5011783838272095, 0.4815860390663147, 0.24599036574363708, -0.19603680074214935, 1.3069093227386475, -0.0953662246465683, -1.2443286180496216, 0.6523367166519165, -0.76690673828125, -0.15953104197978973, -0.023006251081824303, 0.11944056302309036, -0.2462785243988037, -0.3928433358669281, 0.25526925921440125, 0.31674835085868835, 0.7688968181610107, 0.05486566200852394, -0.3383418917655945, 0.16278459131717682, -0.401302695274353, -0.06627676635980606, -0.24651555716991425, 1.0306369066238403, -0.2860054075717926, -0.22625981271266937, 0.15029217302799225, 0.8672011494636536, -0.004332310054451227, -0.5299838185310364, -0.6268872022628784, -1.109002709388733, 0.8614897727966309, 0.11739390343427658, 0.8752928972244263, -0.8906546831130981, -1.1368261575698853, 0.18986327946186066, 0.022471610456705093, -0.04269722104072571, -0.3780194818973541, 0.30670130252838135, -0.6153348684310913, 0.054017212241888046, 0.1529429405927658, -0.8503520488739014, 0.21104571223258972, -0.33823147416114807, -0.8547663688659668, -0.3110417425632477, 0.06725047528743744, 1.0621838569641113, -1.1174241304397583, -0.29080864787101746, 0.21201667189598083, 0.4144273102283478, -0.9762994050979614, 1.2567849159240723, -0.19964438676834106, -0.16102957725524902, -0.16344155371189117, 0.06169766187667847, 0.09422305226325989, -0.4516450762748718, 0.522980809211731, -0.6846176981925964, -0.02995060198009014, 0.8915106654167175, -0.07013187557458878, 1.1813241243362427, -0.7075332403182983, 0.5304785370826721, -0.03975513204932213, -0.9337907433509827, 0.34105485677719116, 0.2810777425765991, 0.14994868636131287, -0.8200953006744385, 0.15708306431770325, -0.062431614845991135, -0.4568313658237457, 0.310678094625473, 1.0726345777511597, 0.9290216565132141, -0.25324368476867676, 0.12310928106307983, 0.5278474688529968, -0.12255021184682846, 0.49222078919410706, 0.6283671855926514, 1.0105994939804077, 0.17039264738559723, 0.3769432008266449, -0.26659461855888367, 0.1675747036933899, -0.891313374042511, 0.0460391566157341, 0.5832950472831726, 0.5982060432434082, 0.37048983573913574, 0.6042535901069641, -0.6691228747367859, -0.5716855525970459, 0.061663106083869934, 0.5642452836036682, 1.387943983078003, -0.17848849296569824, -0.23469321429729462, -0.6720855236053467, -0.39494746923446655, -0.3910391926765442, -0.010141641832888126, -0.09036079049110413, -0.211008220911026, -0.37611547112464905, -0.8246912956237793, 0.8113793134689331, 0.41714122891426086, 1.298893690109253, -0.6581659913063049, -0.5394555330276489, -0.1013178750872612, 0.1853920966386795, -1.0987021923065186, -0.6292129755020142, 0.7456451654434204, -0.3675602078437805, 0.014904964715242386, 0.5118688941001892, -0.27367883920669556, 0.29743650555610657, -0.7180467247962952, 1.280695915222168, -0.5060145258903503, -0.31689178943634033, -0.13127242028713226, 0.572799563407898, -0.36280152201652527, -0.34488537907600403, 0.5043738484382629, -0.1001843735575676, -0.21944254636764526, 0.47000306844711304, 0.051436081528663635, 0.11035960912704468, 0.03881009295582771, -0.06844156235456467, 0.03745078667998314, 0.1874314546585083, 0.28506410121917725, 0.4940912127494812, -0.041214458644390106, -0.14100617170333862, -1.0744595527648926, 0.2753126919269562, 0.021107008680701256, -0.3232126235961914, -0.056408144533634186, -0.5872538685798645, -0.03935104236006737, 0.7105162143707275, -0.38297221064567566, -0.48505643010139465, -0.5590819120407104, 0.06401719897985458, -0.5047702193260193, -0.11877547204494476, -0.1564875692129135, 0.027789566665887833, 0.03449191153049469, -0.03062044084072113, 0.969463586807251, 0.2971940040588379, 0.21747149527072906, 0.24821385741233826, -0.9038059115409851, 0.37503015995025635, -0.011424213647842407, 0.20812161266803741, 0.11999960243701935, -0.3165923058986664, -0.5925847291946411, -0.5100834369659424, -0.23620378971099854, 0.09762734174728394, -0.14149357378482819, 0.04169440641999245, -0.771763801574707, -1.1928014755249023, 0.0606575533747673, -1.0744280815124512, -0.567168653011322, -0.05184951052069664, -0.6043825149536133, -0.1583925485610962, -0.9134135842323303, -1.2353947162628174, -0.7244973182678223, -0.8750397562980652, -1.3104225397109985, 0.49891239404678345, -0.07061300426721573, -0.3156932592391968, -0.5895890593528748, -0.4087967574596405, -0.4653337001800537, 1.2752437591552734, -0.8024175763130188, 0.35923612117767334, -0.24400539696216583, -0.7367866635322571, 0.021745357662439346, 0.049694377928972244, 0.08277545869350433, -0.05063534528017044, -0.09184837341308594, -0.9747829437255859, 0.38831156492233276, -0.3987867832183838, -0.24140043556690216, 0.21464157104492188, 0.2504265308380127, 1.187474250793457, -0.10265512019395828, -0.7506927251815796, 0.2160908579826355, 1.3315306901931763, -0.39327698945999146, 0.36491453647613525, 0.1839807778596878, 1.1351299285888672, -0.24413549900054932, -0.2283342033624649, 0.5256058573722839, 0.6258429884910583, 0.7258839011192322, 0.3204110264778137, -0.05297282338142395, -0.06368172913789749, -0.3954748809337616, 0.7010630965232849, 1.3590046167373657, 0.562920093536377, 0.2650430202484131, -0.822306215763092, 1.045420527458191, -1.2822952270507812, -1.1583739519119263, 0.7514635920524597, 0.5792027711868286, 0.32010650634765625, -0.1530868113040924, -0.36498787999153137, 0.10683771967887878, 0.8869720101356506, 0.5394980311393738, -0.5601887106895447, -0.9048925042152405, 0.23870393633842468, 0.8000868558883667, 0.6226089596748352, 0.6650499701499939, -0.23778888583183289, 0.7981962561607361, 14.772263526916504, 1.1855831146240234, 0.04688207805156708, 0.8102225065231323, 0.8112719655036926, 0.3096834421157837, -0.49979397654533386, 0.06207443028688431, -1.3941287994384766, 0.06702212989330292, 1.0173940658569336, 0.06056556478142738, 0.6775588393211365, 0.31215018033981323, -0.005496330559253693, 0.08114584535360336, -0.5543094277381897, 0.594747006893158, 0.5136220455169678, -1.477134108543396, 0.09318381547927856, 0.0019204679410904646, 0.10755765438079834, 0.37490588426589966, 0.8094196915626526, 0.7390354871749878, 0.9214270114898682, -0.40574726462364197, 0.601473867893219, -0.04385931044816971, 1.0527054071426392, -0.09534677118062973, 0.20203958451747894, 0.0674612820148468, -1.3593320846557617, 0.025437215343117714, -0.3365000784397125, -1.3016973733901978, 0.1857941746711731, 0.763386070728302, -0.8085623979568481, -0.5790753364562988, -0.14969965815544128, 0.9394271373748779, 0.468555212020874, 0.28635072708129883, -0.41867387294769287, 0.5694719552993774, 0.0980854406952858, -0.12116918712854385, 0.10890080034732819, 0.968709409236908, 0.04135088995099068, 0.19333529472351074, -0.14196516573429108, -0.26605334877967834, 0.07884128391742706, 0.5594523549079895, -0.2714940905570984, -0.5802074670791626, -0.36266785860061646, -0.05951720476150513, 0.21066997945308685, 1.0865631103515625, 0.36970919370651245, 0.026720494031906128, -0.45576992630958557, 0.2813400328159332, 0.5748597979545593, -0.26900365948677063, -0.5186375975608826, -0.14615026116371155, 0.41577962040901184, -0.503874659538269, 0.27211058139801025, 0.7540580630302429, -0.3897402882575989, -0.7947792410850525, -0.8666964769363403, -0.3992812931537628, 0.545508623123169, -0.5900834202766418, -0.5116882920265198, 0.88457190990448, -0.3650609850883484, -0.21151548624038696, 0.07298821955919266, -0.40481722354888916, -0.36859509348869324, 0.17389585077762604, -1.361430287361145, -0.45737698674201965, 0.26000598073005676, -0.18299761414527893, -0.35112786293029785, -0.06681065261363983, 1.0530608892440796, 0.2894994020462036, -0.19408324360847473, 0.4517196714878082, -0.273526132106781, 0.17947524785995483, -0.38426774740219116, -0.9092510342597961, 1.117560625076294, 0.4273117184638977, -0.21241158246994019, 0.1069338396191597, 0.10162834823131561, 0.16700398921966553, -0.8937650322914124, -0.4066496193408966, 0.8328433036804199, -0.6216705441474915, -0.1276436448097229, -1.0060945749282837, -0.586705207824707, 0.525111198425293, 0.7858194708824158, 0.06677886843681335, 0.22888188064098358, 0.11446778476238251, -0.6390875577926636, -0.3764806389808655, -0.9547217488288879, -0.10829680413007736, 0.598470151424408, -0.894827663898468, -0.2791941165924072, -0.16594168543815613, 0.05935048684477806, -1.354801893234253, -0.6280050873756409, -0.4942794144153595, -0.04071633517742157, -0.1271267980337143, 1.0097121000289917, 0.2522814869880676, 0.7389283776283264, 0.7350232005119324, 0.2869780659675598, -0.7468620538711548, -0.09525660425424576, -0.8323041200637817, -0.34002891182899475, 0.31395694613456726, 0.4857313930988312, -0.5187252163887024, 0.5917834639549255, 0.840608537197113, 0.026957238093018532, -0.36311113834381104, -0.9219357967376709, -0.2101113349199295, -0.40583428740501404, -0.33973026275634766, 0.4024870693683624, 0.23135139048099518, 0.4582969844341278, 0.12878407537937164, 0.4836871325969696, 0.36122846603393555, 0.1338645964860916, -0.5979820489883423, 0.060756586492061615, 0.2348875254392624, 0.06882946193218231, -0.5801094174385071, -0.7570044994354248, -1.233456015586853, 0.3459664285182953, -1.1653833389282227, 0.16322192549705505, -0.8470177054405212, -0.23195666074752808, -0.060461487621068954, -0.2677667438983917, 0.6235755085945129, 0.3161236345767975, -0.21707336604595184, -0.6974425911903381, -0.7468385100364685, -0.7442258596420288, 0.792707622051239, 0.5658547282218933, -0.9723764061927795, 0.4195585250854492, -0.40355971455574036, -0.17543351650238037, 0.07227932661771774, 0.4992635250091553, -0.44391313195228577, -0.39262092113494873, -1.114148497581482, 0.18038059771060944, -0.14655239880084991, -0.2746502459049225, -0.6556272506713867, 0.8889896869659424, 0.5439348816871643, -0.16102440655231476, -0.07606085389852524, 0.10045499354600906, -0.9577682018280029, -0.4709082543849945, 0.6262989640235901, -0.6067630648612976, 0.1953478455543518, 0.38357338309288025, -0.787929892539978, -0.4235631823539734, 0.7541864514350891, 0.012590272352099419, -1.2881006002426147, -0.9260184168815613, 0.5086653828620911, -0.9219781160354614, 0.5531330108642578, -0.26424771547317505, -0.06027825176715851, -1.1847409009933472, -0.43407586216926575, 0.09786549210548401, 0.32075613737106323, -0.5427371859550476, 0.9083943963050842, 0.2323325127363205, -1.0946736335754395, 0.36963966488838196, 0.38002389669418335, -0.28885921835899353, 0.24845194816589355, 0.44867897033691406, 0.4250144958496094, -0.13081733882427216, 0.4177151918411255, 0.0649660974740982, 0.2556561231613159, -0.5952370762825012, 0.08537796884775162, 0.846274733543396, -0.8359089493751526, -0.13451868295669556, 0.6968172192573547, -0.43727102875709534, -0.49922969937324524, 0.21162071824073792, -1.3832907676696777, -0.425275981426239, -0.2619665563106537, 0.5851592421531677, 0.04480179399251938, 0.10999657958745956, -0.05584608018398285, -0.8829047083854675, -0.1363687515258789, -0.3188765347003937, -0.4652247428894043, 0.3376789093017578, 0.1261054128408432, -0.5611485838890076, 0.26082003116607666, 0.5749006867408752, -0.6043291091918945, -0.5046197772026062, -0.6886139512062073, -0.5020796060562134, -0.2026313692331314, 0.5376306772232056, -0.09936448186635971, -1.2294572591781616, 0.5758466124534607, 0.29000088572502136, 0.5522968769073486, -0.07011640816926956, -0.19410642981529236, 0.2082173228263855, 0.6039977669715881, 0.28497764468193054, -0.49637702107429504, -0.33165931701660156, 1.5101045370101929, 0.6435663104057312, -0.5127400159835815, -0.09410205483436584, -0.44823503494262695, -0.6133164763450623, 0.4909457862377167, 0.6715925335884094, -0.024917416274547577, 0.8075063824653625, 0.565769612789154, -0.3016102910041809, 0.2323678880929947, -1.0088554620742798, -0.5368348360061646, 0.17530332505702972, 1.2369297742843628, 0.6591813564300537, 0.03812064602971077, 0.4863744378089905, 0.6804215312004089, 0.26409152150154114, 0.04991297051310539, 0.49148884415626526, 0.3162313401699066, -0.08729154616594315, -0.08049103617668152, -0.008615560829639435, 0.8957722187042236, -0.9406826496124268, -0.9876351952552795, 0.5879645347595215, 0.32102909684181213, 0.1825847029685974, 0.4020220637321472, 1.132978916168213, 0.0014622136950492859, 0.3184640407562256, 0.0026824537198990583, 0.5649411082267761, -0.543513834476471, -0.4890872836112976, -0.4021698534488678, -0.529327929019928, -0.30290308594703674, -0.10904910415410995, -0.6347023248672485, -0.5387604236602783, -0.06527529656887054, 0.23574994504451752, 0.2771066129207611, 0.27372246980667114, 0.9662017226219177, 0.7508487105369568, 0.9072326421737671, -0.10537682473659515, -0.6833807229995728, 0.013411585241556168, -0.8311079740524292, 0.2330193817615509, -0.5452251434326172, -0.15624617040157318, -0.31719017028808594, -0.019466809928417206, -0.38451600074768066]}, "authors": [{"authorId": "2211601385", "name": "Steve Dai"}, {"authorId": "2241620437", "name": "Hasan Genc"}, {"authorId": "3172075", "name": "Rangharajan Venkatesan"}, {"authorId": "2125244", "name": "Brucek Khailany"}], "references": [{"paperId": "ec34748a74c84f67edde7cc763922fa6d4486022", "title": "Transformer Acceleration with Dynamic Sparse Attention"}, {"paperId": "4badd753be64c5c5b57dd2bb2e515fbe0c0720d8", "title": "SparseBERT: Rethinking the Importance Analysis in Self-attention"}, {"paperId": "6fa1cfc4f97f03a8485692418c7aa1a06c574a85", "title": "Nystr\u00f6mformer: A Nystr\u00f6m-Based Algorithm for Approximating Self-Attention"}, {"paperId": "73e0f38ab49b19b86321016b773e15f1d02e3a72", "title": "SpAtten: Efficient Sparse Attention Architecture with Cascade Token and Head Pruning"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "962dc29fdc3fbdc5930a10aba114050b82fe5a3e", "title": "End-to-End Object Detection with Transformers"}, {"paperId": "c9d3c181d999b0e11c6e4c51b3f9aefd01489e0f", "title": "Integer Quantization for Deep Learning Inference: Principles and Empirical Evaluation"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "d3c6c635b9cfd8890c7244d3db4be53d45944963", "title": "A^3: Accelerating Attention Mechanisms in Neural Networks with Approximation"}, {"paperId": "2cf3bd0cc1382f35384e259d99e4f9744eeaed28", "title": "Blockwise Self-Attention for Long Document Understanding"}, {"paperId": "f9b990566338411ca302787687a5d0c5dc68b692", "title": "MAGNet: A Modular Accelerator Generator for Neural Networks"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "7edacd94dc1509803d9bbcc1d92fea780d71cb3e", "title": "MnnFast: A Fast and Scalable System Architecture for Memory-Augmented Neural Networks"}, {"paperId": "1c71771c701aadfd72c5866170a9f5d71464bb88", "title": "Unified Language Model Pre-training for Natural Language Understanding and Generation"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "1db9bd18681b96473f3c82b21edc9240b44dc329", "title": "Image Transformer"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "05dd7254b632376973f3a1b4d39485da17814df5", "title": "SQuAD: 100,000+ Questions for Machine Comprehension of Text"}, {"paperId": "aee835ea79cdc045568a4092a3883b3129599445", "title": "Statistical machine translation"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Speech understanding systems: A summary of results of the five-year research effort"}]}