{"paperId": "852513e5ee60ad8cd22110be384b47e3867c0241", "abstract": "Recent works on kernel-based attention such as [8] offer an alternative to classical attention with linear rather than quadratic time complexity, enabling transformer-like models to efficiently process long sequences. However, when implemented naively, these algorithms greatly underperform classical attention in speed and memory usage. In this work, we demonstrate a hardware-aware linear attention algorithm, specially optimized for the Tensor Processing Unit (TPU) chip, that is substantially faster than all baselines.", "venue": "", "year": null, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work demonstrates a hardware-aware linear attention algorithm, specially optimized for the Tensor Processing Unit (TPU) chip, that is substantially faster than all baselines."}, "embedding": {"model": "specter_v2", "vector": [0.2995896637439728, 0.6133687496185303, -0.23125562071800232, 0.2872658967971802, -0.16761673986911774, 0.17609193921089172, 0.4346066117286682, -0.27948659658432007, -0.22790542244911194, -0.7483750581741333, 0.47471827268600464, 0.3371337950229645, 0.7083448171615601, 0.2815755009651184, 0.01283893920481205, 0.04344179481267929, -0.7479965090751648, 0.10796011984348297, 0.3241679072380066, -0.01580478623509407, 0.6482765078544617, -0.5619350075721741, -1.265812635421753, 0.23101599514484406, -0.04238997399806976, 1.152876377105713, 0.15987756848335266, 0.9694969654083252, -0.2024807184934616, 0.528131902217865, 0.4265427589416504, -0.2536475956439972, 0.21241585910320282, 0.24793455004692078, -0.43305474519729614, -0.14633537828922272, 0.8088527321815491, -0.17894919216632843, -0.6266512870788574, 0.9570141434669495, -0.2647872567176819, 0.07162129133939743, 0.3561755120754242, -0.7491102814674377, -0.2847989797592163, 0.9006457924842834, 0.5094435811042786, 1.140805959701538, -0.5523223280906677, -0.42255109548568726, 1.3943058252334595, -1.3807687759399414, 0.24249133467674255, 1.3857207298278809, 0.4745243787765503, 0.1648784875869751, -0.2939780056476593, -0.25331395864486694, 0.5246121287345886, 0.48657384514808655, -0.730713427066803, -0.3475724458694458, 0.12094099819660187, -0.19428479671478271, 1.782900094985962, -0.6525924801826477, -0.06069321185350418, 0.26732808351516724, 0.42938363552093506, 1.7443790435791016, -0.10135413706302643, -0.6512233018875122, -0.23540881276130676, 0.08034324645996094, 0.7460570931434631, 0.5885465145111084, -0.4572661519050598, 0.37471285462379456, -0.9527834057807922, 0.003121846355497837, 0.7067224979400635, -0.03850667178630829, 0.17913579940795898, -0.3400176465511322, -0.7819234728813171, 0.5999699234962463, 0.5167510509490967, 0.7797818779945374, -0.6811928749084473, 1.1396456956863403, 1.0610430240631104, -0.012585889548063278, -0.26690441370010376, 0.47097983956336975, 0.28831467032432556, 0.10069259256124496, -0.9910538792610168, -0.0656619444489479, -0.19709743559360504, 1.219025731086731, 0.15034061670303345, 0.9861807227134705, -0.5917084813117981, -0.19632132351398468, 0.7850872278213501, 0.15046395361423492, 0.4638633131980896, -0.5419039130210876, -0.26593178510665894, -0.8054010272026062, -0.12154863774776459, -1.1835408210754395, 0.018910393118858337, -0.18665683269500732, -0.7191838026046753, -1.2511036396026611, -0.6675222516059875, 0.262561559677124, -0.8509611487388611, 0.23746411502361298, -0.5582134127616882, 0.36420944333076477, -0.46397683024406433, 0.43195047974586487, 0.36049434542655945, 0.407053142786026, 0.3139498829841614, 0.39566507935523987, 1.3685221672058105, -1.0467182397842407, -0.7093092799186707, -0.8970146775245667, 0.28262242674827576, -0.25042030215263367, 0.00639770831912756, -0.036643385887145996, -1.0706775188446045, -1.2044427394866943, -0.6443595290184021, -0.19218215346336365, -0.3136880397796631, 0.40428426861763, 1.1907695531845093, 0.1277710646390915, -1.0164622068405151, 0.8890382051467896, -0.4165092706680298, 0.09234404563903809, 0.31643208861351013, 0.09248363971710205, 0.8084731698036194, -0.0027093153912574053, -1.1699105501174927, 0.263320654630661, 0.20346811413764954, -0.3763272762298584, -0.5911107063293457, -0.918804943561554, -1.1403119564056396, 0.15506602823734283, 0.2878354787826538, -0.15206365287303925, 1.3834742307662964, -0.020912237465381622, -1.0434225797653198, 0.5119318962097168, -0.5481623411178589, -0.23643545806407928, -0.4564543664455414, -0.16515585780143738, -0.33928003907203674, -0.006325349677354097, -0.17540578544139862, 0.7062413096427917, 1.0970661640167236, 0.10605129599571228, -0.24811601638793945, 0.29134684801101685, -0.4303340017795563, -0.5215339660644531, -0.25692084431648254, 1.131096363067627, -0.2544064521789551, -0.2598001956939697, 0.17418915033340454, 0.30057719349861145, 0.022022414952516556, -0.7483541369438171, -0.4582371115684509, -1.1852624416351318, 0.6545411944389343, -0.002368527464568615, 1.244650959968567, -1.0232088565826416, -0.4556843340396881, -0.22595378756523132, 0.02967057004570961, -0.33838632702827454, -0.39378464221954346, 0.43736621737480164, -0.8853808641433716, 0.21063750982284546, 0.32023975253105164, -0.9331391453742981, 0.23062820732593536, -0.5656421184539795, -0.8046322464942932, -0.11444836854934692, 0.23205070197582245, 1.0851117372512817, -0.8670371770858765, -0.17340324819087982, -0.10190189629793167, 0.24282675981521606, -0.9369433522224426, 1.139205813407898, -0.0878114253282547, -0.09109225869178772, 0.20725466310977936, 0.016399478539824486, -0.30107298493385315, -0.4069511294364929, 0.22057804465293884, -1.2607935667037964, -0.31263861060142517, 0.6297432780265808, -0.08025720715522766, 0.9645182490348816, -0.23673701286315918, 1.0303854942321777, -0.18153202533721924, -0.6294244527816772, 0.3666273355484009, 0.48518648743629456, -0.0623113252222538, -0.3446173369884491, 0.7584612369537354, 0.199532151222229, -0.566918134689331, 0.2169216424226761, 0.9928925037384033, 1.1000010967254639, -0.3342195451259613, 0.2229081690311432, 0.6868484020233154, -0.15206141769886017, 0.22540776431560516, 0.4897921085357666, 0.48589494824409485, 0.3242848217487335, 0.2609996795654297, -0.32392120361328125, 0.1548076868057251, -0.5343597531318665, -0.05650336295366287, 0.4851156771183014, 0.4000818133354187, 0.8208656907081604, 0.5753400921821594, -1.2168177366256714, -0.8075700998306274, 0.5709875226020813, 0.4795975089073181, 1.6245888471603394, -0.15813156962394714, -0.07492301613092422, -0.7342244386672974, -0.08235476166009903, -0.3284158408641815, 0.06857012957334518, -0.6182137727737427, -0.12273168563842773, -0.755886435508728, -1.0370452404022217, 0.8216902017593384, 0.5386792421340942, 0.7086020112037659, -0.8534219264984131, -0.8337110280990601, -0.26685649156570435, 0.5858792066574097, -1.0007450580596924, -1.1297281980514526, 0.39865899085998535, -0.5568086504936218, -0.211118683218956, 0.23514221608638763, 0.06293509900569916, 0.2966808080673218, -0.34284693002700806, 0.8461596369743347, -0.768647313117981, -0.4967179298400879, 0.32418134808540344, 0.5760632753372192, -0.6692031621932983, -0.33246880769729614, 0.22464583814144135, 0.2785834074020386, 0.28099608421325684, 0.3881966471672058, 0.42571786046028137, -0.05878875404596329, 0.14470753073692322, -0.38722410798072815, 0.1297648400068283, 0.26307758688926697, 0.21184177696704865, 0.7237583994865417, -0.3979882597923279, -0.19716277718544006, -0.7676485776901245, 0.6656415462493896, 0.32707688212394714, -0.27854612469673157, -0.14235681295394897, -0.6031135320663452, -0.15044604241847992, 0.36477261781692505, -0.8441922664642334, -0.16629278659820557, -0.7192208766937256, 0.6199823617935181, -0.8233132362365723, -0.3347257673740387, 0.15220540761947632, 0.6967459321022034, -0.3687622547149658, 0.3862282633781433, 0.63960862159729, 0.052477866411209106, 0.07298272848129272, 0.24510295689105988, -0.9779595136642456, 0.5857563614845276, 0.012562849558889866, 0.08446554839611053, -0.22163435816764832, -0.0623265877366066, -0.7089739441871643, -0.5473247170448303, -0.3194575309753418, -0.7200776934623718, -0.6491116881370544, 0.3881305158138275, -0.25581875443458557, -1.1604523658752441, -0.26433905959129333, -1.120619297027588, 0.0706297904253006, 0.41164112091064453, -0.15114255249500275, -0.10990467667579651, -0.8801770806312561, -1.398931860923767, -0.5160146951675415, -1.0555416345596313, -1.3137764930725098, 0.43758636713027954, 0.11335715651512146, -0.1454322636127472, -0.49767860770225525, -0.2560673952102661, -0.4312286376953125, 1.2192816734313965, -0.5932757258415222, 0.5649539828300476, -0.05760491266846657, -0.5397813320159912, -0.4864996671676636, -0.10027621686458588, 0.6447275876998901, -0.46490368247032166, 0.3762553334236145, -0.776241660118103, 0.2008386105298996, -0.27779194712638855, -0.07004041224718094, 0.10712164640426636, 0.33786875009536743, 0.7928503751754761, 0.3362028896808624, -0.36399078369140625, 0.16940729320049286, 1.1702033281326294, -0.4253535568714142, 0.14264105260372162, 0.07461107522249222, 1.2519729137420654, 0.09398280084133148, -0.17413432896137238, 0.5199402570724487, 0.2767198085784912, 0.7843702435493469, 0.2816962003707886, -0.08161799609661102, -0.19308455288410187, -0.11146952211856842, 0.5671109557151794, 1.5014042854309082, 0.09011352062225342, 0.7905735969543457, -1.285654902458191, 0.7527117729187012, -1.0237396955490112, -0.9734601378440857, 0.4649445414543152, 0.7958788871765137, 0.04146413505077362, -0.31357553601264954, -0.22497554123401642, -0.41595491766929626, 0.8102630972862244, 0.13352595269680023, -0.5385873913764954, -0.972342312335968, 0.23018775880336761, 0.4753376841545105, 0.33554837107658386, 0.5360405445098877, -0.4570322334766388, 0.6163666248321533, 14.893750190734863, 0.35796794295310974, -0.6060053110122681, 0.4821183383464813, 0.4083253741264343, 0.5329442620277405, 0.056642983108758926, 0.09307500720024109, -1.2455402612686157, -0.15924440324306488, 1.3843653202056885, -0.08491697162389755, 0.5332379937171936, 0.7198789119720459, -0.13426107168197632, 0.4523104131221771, -0.8566279411315918, 0.9030166268348694, 0.7253999710083008, -1.286621332168579, 0.11530411243438721, 0.37694138288497925, -0.04316876828670502, 0.5300049781799316, 0.6931116580963135, 0.8497822880744934, 0.14567001163959503, -0.1330108493566513, 0.5430723428726196, 0.21476203203201294, 0.7779421210289001, -0.0643477514386177, 0.42129984498023987, 0.0817117989063263, -1.3585888147354126, -0.04830769822001457, -0.6756929159164429, -1.099254846572876, 0.3410428464412689, 0.16627025604248047, -1.0947762727737427, -0.4904561936855316, -0.11811265349388123, 0.9401243925094604, 0.005717606749385595, 0.4450184404850006, -0.08855178952217102, 0.5484949946403503, 0.26608899235725403, 0.0568007230758667, 0.23828865587711334, 0.7184010744094849, 0.07904993742704391, 0.45598864555358887, -0.12990859150886536, -0.0998869463801384, 0.1383388638496399, 0.49141421914100647, -0.17079995572566986, -0.19056934118270874, -0.1361849009990692, -0.4464259743690491, -0.25654399394989014, 1.2228565216064453, 0.3741217255592346, -0.06636562943458557, -0.2159145623445511, 0.21740856766700745, 0.19189292192459106, -0.03164089843630791, -0.5562164187431335, -0.38135334849357605, 0.2752932012081146, -0.7010166645050049, 0.23431091010570526, 0.27140164375305176, -0.3682493567466736, -0.8006380200386047, -1.2110552787780762, -0.40285807847976685, 0.2925185263156891, -0.7644895315170288, -0.6043295860290527, 1.247275948524475, -0.24042829871177673, -0.2076670527458191, 0.3469882309436798, -0.9296410083770752, -0.11018097400665283, 0.3833613991737366, -1.101121187210083, -0.5734695196151733, -0.1116844192147255, -0.3174096345901489, -0.29611825942993164, 0.0731537863612175, 1.09065580368042, 0.33753564953804016, -0.5472031235694885, -0.01541194599121809, -0.606434166431427, 0.16082440316677094, -0.25100255012512207, -0.7386630773544312, 0.9564966559410095, 0.3529438078403473, -0.3230818212032318, 0.2786707878112793, 0.25538620352745056, 0.18911701440811157, -0.819422721862793, 0.11062505841255188, 0.42814362049102783, -0.8196359276771545, 0.05473003163933754, -0.6531236171722412, -1.026207685470581, 0.5350968837738037, 0.6860965490341187, -0.18258413672447205, 0.19208313524723053, 0.03476280719041824, -0.8195154070854187, -0.3254307210445404, -0.33975327014923096, -0.009754002094268799, -0.12635712325572968, -0.9967259764671326, -0.4785752594470978, -0.12795166671276093, 0.3765679597854614, -0.8565508723258972, -0.8362060189247131, -0.26276978850364685, 0.11490310728549957, 0.003648818004876375, 0.9994532465934753, -0.44432395696640015, 0.510313868522644, 0.503048837184906, 0.15830041468143463, -0.6098241806030273, -0.4616159498691559, -0.7740467190742493, -0.062457334250211716, -0.1523061841726303, 0.1839996576309204, 0.0019967874977737665, 0.3187870383262634, 0.7610677480697632, -0.17674565315246582, -0.2174696922302246, -0.5176461935043335, -0.02099008671939373, -0.5221377015113831, -0.6306251883506775, -0.11894147098064423, -0.048334378749132156, 0.13072218000888824, 0.10096023976802826, 0.053434330970048904, 0.4935026168823242, 0.2729220390319824, -0.472968190908432, 0.16740040481090546, -0.06232614815235138, 0.11584783345460892, -0.6414555907249451, -0.7886187434196472, -1.3421905040740967, -0.05313130095601082, -0.9943848848342896, 0.13579919934272766, -0.4739488661289215, -0.47113844752311707, 0.22520357370376587, -0.3875184953212738, 0.4691062569618225, 0.33000490069389343, -0.10273611545562744, -0.3151160776615143, -0.3382352292537689, -0.5925833582878113, 0.6647157073020935, 0.8534848093986511, -0.6422408819198608, 0.25390633940696716, -0.3889254927635193, 0.26175063848495483, 0.16412387788295746, 0.316662460565567, -0.48024219274520874, -0.41551586985588074, -1.0019700527191162, 0.10329396277666092, 0.18856996297836304, -0.18879100680351257, -1.096453309059143, 1.0889548063278198, 0.4619637429714203, -0.39678314328193665, -0.025859402492642403, 0.15539665520191193, -0.4865590035915375, -0.4648038446903229, 0.4417799711227417, -0.6751790046691895, 0.5228822827339172, 0.4436613917350769, -0.9065340161323547, -0.3847496211528778, 0.8634735345840454, 0.2911053001880646, -0.9111573696136475, -0.9705889821052551, 0.6090779304504395, -0.652427077293396, -0.11372173577547073, -0.22213545441627502, -0.2123422473669052, -1.0541976690292358, -0.1153125911951065, -0.01201487798243761, 0.011500653810799122, -0.5192966461181641, 0.9985949397087097, 0.6058318018913269, -0.8715983629226685, 0.1877942681312561, 0.21670839190483093, -0.01860460638999939, -0.4599992036819458, 0.5630166530609131, 0.9754359722137451, -0.22441716492176056, 0.858143150806427, -0.25170207023620605, 0.35589465498924255, -0.7477342486381531, 0.5332550406455994, 0.7999086976051331, -0.22040612995624542, -0.2683423161506653, 0.9098786115646362, -0.18165139853954315, -0.5486998558044434, 0.19607344269752502, -1.4261703491210938, -0.6233204007148743, -0.026535293087363243, 0.8737679123878479, 0.12212733179330826, -0.13705649971961975, -0.2157323956489563, -0.6443236470222473, 0.12347044795751572, -0.2401699274778366, -0.3355344831943512, 0.21727536618709564, 0.16160333156585693, -0.791294515132904, 0.7217206954956055, 0.6325883865356445, -0.8828391432762146, -0.39390864968299866, -0.8585516214370728, -0.10064950585365295, -0.11390025913715363, 0.5516379475593567, 0.035593342036008835, -0.8213001489639282, 1.2656223773956299, 0.43269360065460205, 0.48917916417121887, 0.021623339504003525, -0.3436608612537384, 0.0734032616019249, 0.3848976194858551, 0.38322004675865173, -0.4064466953277588, -0.09369584172964096, 1.505342960357666, 1.2644026279449463, -0.428665429353714, 0.042151257395744324, -0.2632257342338562, -0.94109708070755, 1.238983154296875, 0.34588128328323364, -0.34734007716178894, 0.6634817719459534, -0.09361166507005692, -0.16797208786010742, 0.10906827449798584, -1.052535057067871, -0.1512845754623413, 0.9475821256637573, 0.9613573551177979, 0.7890430688858032, 0.3238585591316223, 0.32810941338539124, 0.48538586497306824, 0.16653694212436676, 0.22946734726428986, 0.8278725147247314, 0.34576550126075745, -0.41914883255958557, 0.22503916919231415, -0.11118483543395996, 0.43123936653137207, -0.7890214323997498, -0.7824074625968933, 0.7377611398696899, 0.3753425180912018, 0.11128036677837372, 0.07827940583229065, 0.874790370464325, -0.3415781259536743, 0.624422550201416, 0.1772518754005432, 0.4079797863960266, -0.5674712657928467, -0.2812747657299042, -0.07179296761751175, -0.7406616806983948, -0.37231796979904175, -0.01624763011932373, -0.7601481080055237, -0.38123250007629395, -0.22482718527317047, 0.35406869649887085, -0.001280410448089242, 0.4988808333873749, 0.6891106963157654, 0.7404198050498962, 0.8782735466957092, -0.3371339738368988, -1.2153737545013428, -0.302788108587265, -0.9969412088394165, 0.19963796436786652, -0.5065984725952148, -0.3331989347934723, -0.6075035333633423, -0.29235726594924927, 0.02704811654984951]}, "authors": [{"authorId": "2298054563", "name": "Gabrael Levine"}], "references": [{"paperId": "d53fe76bd2795a19ddf52d012917782f6f6f2c1e", "title": "Griffin: Mixing Gated Linear Recurrences with Local Attention for Efficient Language Models"}, {"paperId": "cde66097f4123a62bf3e28d48c764648e8c69f72", "title": "Simple linear attention language models balance the recall-throughput tradeoff"}, {"paperId": "f4a0c4154203808f362e4678f3741b3d317fdc82", "title": "The Hedgehog & the Porcupine: Expressive Linear Attentions with Softmax Mimicry"}, {"paperId": "7bbc7595196a0606a07506c4fb1473e5e87f6082", "title": "Mamba: Linear-Time Sequence Modeling with Selective State Spaces"}, {"paperId": "998ac3e945857cf2676ee7efdbaf443a0c6f820a", "title": "Hyena Hierarchy: Towards Larger Convolutional Language Models"}, {"paperId": "6d7d141c75af752ffc0d8a6184cca3f9323d6c74", "title": "Simplified State Space Layers for Sequence Modeling"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51", "title": "Efficiently Modeling Long Sequences with Structured State Spaces"}]}