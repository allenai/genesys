{"paperId": "b4a4e6fe63426b9fb4393c939792da8e7c4a1a59", "abstract": "Runtime and scalability of large neural networks can be significantly affected by the placement of operations in their dataflow graphs on suitable devices. With increasingly complex neural network architectures and heterogeneous device characteristics, finding a reasonable placement is extremely challenging even for domain experts. Most existing automated device placement approaches are impractical due to the significant amount of compute required and their inability to generalize to new, previously held-out graphs. To address both limitations, we propose an efficient end-to-end method based on a scalable sequential attention mechanism over a graph neural network that is transferable to new graphs. On a diverse set of representative deep learning models, including Inception-v3, AmoebaNet, Transformer-XL, and WaveNet, our method on average achieves 16% improvement over human experts and 9.2% improvement over the prior art with 15 times faster convergence. To further reduce the computation cost, we pre-train the policy network on a set of dataflow graphs and use a superposition network to fine-tune it on each individual graph, achieving state-of-the-art performance on large hold-out graphs with over 50k nodes, such as an 8-layer GNMT.", "venue": "arXiv.org", "year": 2019, "citationCount": 36, "influentialCitationCount": 13, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work proposes an efficient end-to-end method based on a scalable sequential attention mechanism over a graph neural network that is transferable to new graphs that achieves state-of-the-art performance on large hold-out graphs with over 50k nodes, such as an 8-layer GNMT."}, "embedding": {"model": "specter_v2", "vector": [0.20771151781082153, 0.5091456174850464, -0.8520423173904419, 0.12462051957845688, 0.6511906385421753, -0.2744239568710327, 0.20491689443588257, 0.17170190811157227, -0.4114797115325928, -0.08484157919883728, 0.10854580253362656, -0.24658603966236115, 0.3385956585407257, -0.18302930891513824, -0.6324276328086853, 0.688186764717102, -0.9759460091590881, 0.012229779735207558, 0.4385428726673126, 0.1500975489616394, 0.19898071885108948, -0.1479465216398239, -1.1641637086868286, -0.01667875237762928, -0.015352984890341759, 0.9155533313751221, -0.08981461077928543, 0.8267093896865845, -0.19336915016174316, 0.5816536545753479, 0.11786948889493942, -0.2698054909706116, 0.32327577471733093, 0.3424588441848755, -0.5790436863899231, -0.04639696702361107, 0.39632484316825867, -0.7005953192710876, -0.29178622364997864, 1.0782666206359863, -0.06563855707645416, 0.22666557133197784, -0.1789664775133133, -1.1844345331192017, -0.025332996621727943, 0.8373595476150513, 0.4850327968597412, 0.7628929018974304, -0.6986194252967834, -0.44738152623176575, 1.3486820459365845, -0.646583080291748, 0.37281426787376404, 1.1426582336425781, 0.32996612787246704, 0.48472192883491516, -0.26745709776878357, -0.6847845315933228, 0.8126409649848938, -0.06911827623844147, -0.13318774104118347, -0.15056174993515015, 0.3168202340602875, -0.3260500431060791, 1.6507116556167603, -0.6691432595252991, 0.15994873642921448, 0.7049175500869751, -0.1080663874745369, 0.9647238254547119, -0.3385724723339081, -0.5919411778450012, 0.39117205142974854, -0.33755478262901306, 0.2196347862482071, 0.9941856265068054, 0.4612211287021637, -0.005786614026874304, -0.643374502658844, -0.07017043232917786, 0.9971967339515686, 0.6319999098777771, 0.7413157820701599, -0.34279364347457886, 0.22396601736545563, 0.11378520727157593, 0.810554563999176, 0.5907142758369446, -0.5621560215950012, 1.2950738668441772, 0.9354138374328613, 0.13695770502090454, -0.3597632944583893, 0.28217267990112305, 0.21173323690891266, 0.3266605734825134, -0.4037090241909027, -0.1581578254699707, -0.08158386498689651, 0.9120025038719177, -0.25287261605262756, 0.061382587999105453, -0.41872844099998474, -0.324662983417511, 1.0995861291885376, -0.3264889419078827, 0.006025008391588926, -0.6630461812019348, 0.4383111298084259, -0.3374596834182739, 0.09653770923614502, -0.7716951370239258, -0.08071348816156387, -0.33374106884002686, -1.0289241075515747, -0.6742406487464905, -0.3087102472782135, -0.13503219187259674, -0.7986486554145813, 0.6390670537948608, -0.8987173438072205, 0.7202847003936768, -0.3114091157913208, 0.1526525914669037, 0.4547477066516876, 0.1868751496076584, 0.03972882404923439, 0.599947452545166, 0.5068909525871277, -1.2334998846054077, -0.33017247915267944, -0.9941346645355225, 0.4475477635860443, 0.20419515669345856, 0.14941492676734924, -0.22610406577587128, -1.3586314916610718, -1.0789122581481934, -1.0120288133621216, 0.4164774417877197, -0.7557618021965027, -0.26663821935653687, 1.0385656356811523, 0.5679015517234802, -1.3729254007339478, 1.339209794998169, -0.587689995765686, -0.49202772974967957, 0.7596634030342102, 0.7364640831947327, 0.5188013315200806, -0.06261853128671646, -0.7940967679023743, 0.07847356051206589, 0.16455291211605072, -0.49928390979766846, -0.3331833779811859, -0.480218768119812, -0.6941725611686707, 0.4390757083892822, 0.2212127149105072, -0.9027996063232422, 1.0743120908737183, 0.07490406930446625, -1.0238391160964966, 0.7807246446609497, 0.31400617957115173, -0.18360508978366852, 0.3733842670917511, 0.15258099138736725, -0.6503360271453857, -0.28512516617774963, -0.36563438177108765, 0.19834251701831818, 0.15598222613334656, -0.3523024618625641, -0.1971285343170166, 0.21279750764369965, 0.15284737944602966, -0.42276421189308167, -0.5714585781097412, 1.0713883638381958, -0.485711008310318, 0.16929718852043152, -0.040715400129556656, 1.053238868713379, -0.4251477122306824, 0.00873625185340643, -0.841233491897583, -0.6422432065010071, 0.5799506902694702, 0.38766759634017944, 0.9381256103515625, -0.6144161820411682, -0.9102312922477722, 0.358221173286438, 0.32246145606040955, 0.1583947390317917, -0.49509865045547485, 0.3297492563724518, -0.34544074535369873, 0.6082233786582947, 0.7040050029754639, -0.967081606388092, 0.051987484097480774, -0.24535654485225677, -0.3438998758792877, -0.371942400932312, 0.02653283067047596, 0.9520425200462341, -1.0535014867782593, 0.07708120346069336, 0.267733633518219, 0.05062449350953102, -1.228575587272644, 0.804414689540863, -0.38908976316452026, -0.08835046738386154, -0.4364205300807953, -0.16943417489528656, 0.19428010284900665, -1.0461742877960205, 0.8940749764442444, -0.17058655619621277, 0.4199669063091278, 0.4061110019683838, -0.27512896060943604, 1.4456380605697632, -0.4817714989185333, 0.14719396829605103, 0.22769542038440704, -0.5542560815811157, 0.5221434235572815, 0.1444350928068161, 0.459669291973114, -0.2972337305545807, 0.5386666655540466, 0.3138135075569153, -0.6677500009536743, 0.2832922339439392, 0.7023035883903503, 1.3408137559890747, -0.376257985830307, 0.02456757426261902, 0.3530661463737488, 0.5069499611854553, 0.49767202138900757, 0.07213007658720016, 1.2482596635818481, 0.059123530983924866, 0.10521566867828369, -0.2178162783384323, 0.04210345819592476, -1.1831629276275635, 0.17716749012470245, 0.69490647315979, 0.17698104679584503, 0.36268332600593567, 1.010155439376831, -0.7350088357925415, -0.2601989507675171, -0.3453044295310974, 0.8951227068901062, 1.1606295108795166, 0.36106497049331665, -0.1242518201470375, -0.6143529415130615, -0.8306040167808533, 0.0928320586681366, -0.3181460499763489, -0.1977032572031021, 0.03571547567844391, -0.4962041676044464, -0.7692452669143677, 0.6549798846244812, 0.559721052646637, 1.081979513168335, -1.0583864450454712, -0.34274619817733765, -0.24705487489700317, 0.7640590667724609, -1.0889029502868652, -0.33808407187461853, 0.2688260078430176, -0.4266487658023834, -0.12002384662628174, 0.37933290004730225, -0.2797023057937622, 0.8059690594673157, -0.8687995076179504, 0.9626478552818298, -0.08211567252874374, -0.0886438861489296, -0.059326063841581345, 0.6169564723968506, -0.25408029556274414, -0.278726726770401, 0.3687122166156769, -0.10182654112577438, -0.25706082582473755, 0.21410508453845978, -0.2167249321937561, -0.3100639879703522, 0.12345381081104279, -0.39136022329330444, -0.16565364599227905, 0.11002317070960999, -0.33365193009376526, 0.23106016218662262, 0.046095557510852814, 0.2080705314874649, -1.3544647693634033, 1.102044701576233, -0.20131158828735352, -0.7774429321289062, -0.02549511380493641, -0.6270491480827332, -0.2961195111274719, 0.9730696082115173, -0.6611214876174927, 0.28036239743232727, -1.352009654045105, 0.5121373534202576, -1.047922134399414, -0.24063542485237122, -0.11848827451467514, 0.20660054683685303, 0.06898804008960724, 0.2164900302886963, -0.24068108201026917, 0.2836895287036896, -0.04579440504312515, 0.36156100034713745, -1.1541829109191895, 0.517666220664978, -0.1917945146560669, 0.05103303864598274, 0.10250172764062881, 0.4623524248600006, -0.3301524817943573, -0.08934173732995987, -0.05158005282282829, -0.006721592042595148, -0.41444122791290283, 0.17716549336910248, -0.08953466266393661, -1.4012495279312134, -0.19851353764533997, -1.15410315990448, -0.6012229919433594, 0.10106604546308517, -0.7198919057846069, 0.16727234423160553, -1.3983598947525024, -1.041450023651123, -0.30491364002227783, -0.562626302242279, -1.2951111793518066, 0.10635431855916977, 0.3126096725463867, -0.46696731448173523, -1.0480406284332275, -0.7144399881362915, -0.9368212223052979, 1.105955958366394, 0.17180681228637695, 0.7607787847518921, 0.039956577122211456, -0.6742648482322693, -0.1550673097372055, -0.2510700821876526, 0.34470275044441223, 0.015786217525601387, 0.42543044686317444, -0.7992734313011169, 0.2509544789791107, -0.9861185550689697, -0.13353149592876434, -0.01521800085902214, 0.6788457632064819, 1.5367459058761597, 0.2592011094093323, -0.5000663995742798, 0.5540015697479248, 1.5778706073760986, -0.6747298240661621, 0.15784849226474762, 0.27007919549942017, 1.0282244682312012, -0.08628813922405243, -0.8500398993492126, 0.5476038455963135, -0.04085230082273483, 0.13713951408863068, 0.5969366431236267, -0.4250103831291199, -0.3011794686317444, -0.9957154393196106, 0.012444647960364819, 0.970576286315918, 0.5871645212173462, -0.43205633759498596, -0.835547924041748, 0.8694684505462646, -1.5676255226135254, -0.34333595633506775, 0.8850811719894409, 0.7953968048095703, -0.43852874636650085, 0.4574786424636841, -0.031665295362472534, -0.0913827195763588, 1.1849753856658936, 0.6383504867553711, -0.4999314546585083, -1.007559061050415, 0.48074689507484436, 0.5073183178901672, 0.7945866584777832, 0.5714952349662781, 0.040466926991939545, 0.4268815219402313, 14.531379699707031, 0.32202479243278503, -0.16711749136447906, 0.17620034515857697, 0.7458384037017822, 0.3622440993785858, -0.3407295346260071, 0.008057015016674995, -1.1637370586395264, 0.4162482023239136, 1.0130866765975952, 0.028893597424030304, 0.48682263493537903, 0.1415083110332489, -0.12404049932956696, 0.4829561114311218, -0.9204716086387634, 0.6250633001327515, -0.021460380405187607, -1.6248642206192017, 0.07246790826320648, 0.355502188205719, 0.3625752627849579, 0.41491565108299255, 0.9334633946418762, 0.37174898386001587, 0.9489302635192871, -0.2814071476459503, 0.15908245742321014, 0.04085709527134895, 1.4233026504516602, 0.17656821012496948, 0.30439791083335876, 0.0601053386926651, -0.8334517478942871, -0.00033930878271348774, -0.48023998737335205, -1.2324702739715576, 0.26756954193115234, 0.21052286028862, -0.7063995003700256, -0.3339719772338867, -0.12660424411296844, 1.2017223834991455, 0.5351822972297668, 0.5366345047950745, -0.5113303065299988, 0.06842374801635742, -0.1596878618001938, -0.35573771595954895, -0.16927726566791534, 0.6804196238517761, -0.04387129470705986, -0.3467061519622803, -0.3399811387062073, -0.7515307068824768, 0.4540446102619171, 0.6434215307235718, -1.1871103048324585, -0.38346216082572937, -0.49203982949256897, -0.14545539021492004, 0.3736007511615753, 0.7785429358482361, -0.06725671887397766, 0.2280307412147522, -0.572717010974884, 0.36997997760772705, 0.56055748462677, 0.33332064747810364, -0.3620423972606659, -0.08259030431509018, 0.6689355969429016, -0.25151047110557556, -0.35661008954048157, 0.856295108795166, -0.45179301500320435, -0.319935142993927, -0.5358075499534607, 0.30981674790382385, 0.6507612466812134, -0.6964625716209412, -0.743977427482605, 0.7648974657058716, -0.6364407539367676, -0.5083391666412354, 0.3102627694606781, -1.1264758110046387, -0.8170173168182373, 0.5024309158325195, -1.4620158672332764, -0.4746243953704834, 0.033563509583473206, -0.20556296408176422, -0.9400765299797058, 0.08876171708106995, 1.1156554222106934, 0.5370792150497437, -0.7434343695640564, 0.13225805759429932, -0.3079717457294464, 0.19423235952854156, -0.19176459312438965, -0.9282931685447693, 1.5106873512268066, 0.6780973076820374, -0.5245334506034851, -0.01747780479490757, -0.19652220606803894, -0.08836649358272552, -0.33965975046157837, -0.5775040984153748, 0.2696661949157715, -0.7636183500289917, 0.08522116392850876, -0.8971510529518127, -0.4371422231197357, 1.0118447542190552, 0.38596484065055847, 0.4592752158641815, -0.15375064313411713, 0.1841915249824524, -0.30009913444519043, -0.3507634699344635, -1.0523358583450317, 0.25339314341545105, 0.9507007002830505, -0.45524999499320984, 0.40274932980537415, -0.0722249373793602, 0.267287939786911, -1.0004053115844727, -0.5284243226051331, -0.19812531769275665, -0.15139873325824738, -0.25724318623542786, 1.0283186435699463, -0.682704508304596, 1.1368167400360107, 0.9869419932365417, 0.35840946435928345, -0.7413977384567261, -0.23152603209018707, -1.496504306793213, -0.06586317718029022, -0.049946945160627365, 0.5064324140548706, -0.7874134182929993, 1.154649019241333, 0.6226116418838501, 0.3866560757160187, -0.41250866651535034, 0.01110886875540018, -0.22169293463230133, -0.23859983682632446, -0.18850597739219666, 0.8819374442100525, 0.2495133876800537, -0.006550532300025225, 0.13598746061325073, 0.4399539530277252, 0.6651292443275452, 0.018731094896793365, -0.772623598575592, 0.3186623156070709, -0.33795803785324097, -0.2989684045314789, -0.9931476712226868, -0.8691322207450867, -1.3815160989761353, 0.167303204536438, -1.2866532802581787, -0.5084009766578674, -1.0442278385162354, -0.7794239521026611, -0.10715726017951965, -0.8092892169952393, 0.09112649410963058, 0.5452876687049866, -0.7277956008911133, -0.46538352966308594, -0.8529127836227417, -0.7993911504745483, 0.34674015641212463, 1.0603697299957275, -0.21887512505054474, 0.06482874602079391, -0.027926309034228325, -0.2266189008951187, 0.2955041527748108, 0.6545513272285461, -0.1016630157828331, -0.8657873272895813, -1.413116455078125, 0.20399746298789978, -0.0014975693775340915, -0.0893573984503746, -0.8821734189987183, 1.1230623722076416, 0.3309379816055298, -0.11848636716604233, 0.2694307863712311, 0.0689328983426094, -1.1635303497314453, -0.7393836379051208, 0.4525357484817505, -0.5318356156349182, 0.5837803483009338, 0.46702659130096436, -0.4979524314403534, 0.22563761472702026, 1.0266602039337158, -0.17624546587467194, -0.5079323649406433, -0.9711665511131287, 0.7153106331825256, -0.07144170999526978, -0.024320246651768684, -0.12901951372623444, -0.09989644587039948, -1.701660394668579, -0.17292791604995728, -0.09877271205186844, 0.5628546476364136, -0.2589273154735565, 0.9717264175415039, 0.2873087227344513, -1.0182392597198486, 0.28656309843063354, 0.41528621315956116, -0.5153575539588928, 0.27450916171073914, 0.32718825340270996, 0.19901378452777863, -0.9414380192756653, -0.152288019657135, -0.5940688252449036, 0.3949917256832123, -0.37026306986808777, 0.25993531942367554, 0.6842635869979858, -0.6776273846626282, -0.3263816237449646, 1.0334410667419434, -0.4613700211048126, -0.8045905232429504, 0.3682076632976532, -1.3650541305541992, -0.36703985929489136, -1.029227375984192, 0.19657820463180542, 0.3108230531215668, 0.11532893031835556, 0.7744379043579102, -0.6601541638374329, -0.13090722262859344, -0.08746988326311111, 0.060020528733730316, 0.2859315872192383, 0.17757053673267365, -0.45996204018592834, 0.029565468430519104, 0.6532517671585083, -0.7011495232582092, -0.7306435108184814, -0.8658751249313354, -0.2767246663570404, -0.24107395112514496, 0.2844241261482239, -0.09140279144048691, -1.2472832202911377, 0.6149210929870605, -0.02551528625190258, 0.6857046484947205, 0.3298700451850891, -0.2611585557460785, 0.18544243276119232, 0.29210004210472107, 0.24864806234836578, -0.36576876044273376, -0.18145692348480225, 0.7892899513244629, 0.5882917642593384, -0.3584080636501312, 0.2682874798774719, -0.7609490156173706, -0.12353494763374329, 0.5832946300506592, 0.7745139002799988, -0.6311208605766296, 1.0409533977508545, 0.3944036066532135, -0.18983745574951172, -0.11122041195631027, -0.8698515892028809, 0.05125364661216736, 0.22658400237560272, 0.8727502226829529, 0.20876100659370422, 0.2928338050842285, 0.5470314621925354, 0.5701766610145569, 0.36982476711273193, 0.17992189526557922, 0.5703434944152832, 0.5235423445701599, 0.36030709743499756, -0.18697276711463928, 0.3680841028690338, 0.74921053647995, -0.5027483105659485, -0.24295178055763245, -0.009668025188148022, 0.6839650869369507, 0.10731223970651627, 0.4702150523662567, 1.2110481262207031, -0.2468237578868866, 0.9289320111274719, -0.5103296637535095, 0.5330293774604797, -0.5436250567436218, -0.30716001987457275, -0.31468072533607483, -0.6087490916252136, -0.47591516375541687, 0.2731171250343323, -0.14394521713256836, -0.6184080243110657, -0.8546980023384094, 0.7139719724655151, -0.3238799571990967, 0.3002678155899048, 0.48374634981155396, 0.9160266518592834, 1.4508342742919922, -0.05110035091638565, -0.6650193333625793, 0.01887056604027748, -0.48593997955322266, -0.1756955087184906, 0.014305464923381805, -0.2669343650341034, -0.06487066298723221, -0.030398452654480934, -0.7432278990745544]}, "authors": [{"authorId": "2389316", "name": "Yanqi Zhou"}, {"authorId": "1473253195", "name": "Sudip Roy"}, {"authorId": "1938271", "name": "AmirAli Abdolrashidi"}, {"authorId": "144701861", "name": "Daniel Wong"}, {"authorId": "49735130", "name": "Peter C. Ma"}, {"authorId": "2881150", "name": "Qiumin Xu"}, {"authorId": "2119105813", "name": "Ming Zhong"}, {"authorId": "2391802", "name": "Hanxiao Liu"}, {"authorId": "46684455", "name": "Anna Goldie"}, {"authorId": "1861312", "name": "Azalia Mirhoseini"}, {"authorId": "2926266", "name": "J. Laudon"}], "references": [{"paperId": "2319e4f2d73c78820d498a347d74ed5ef3a185d3", "title": "Placeto: Learning Generalizable Device Placement Algorithms for Distributed Machine Learning"}, {"paperId": "3c00fbd601e1bc148cf9eee490db6236d5fcf4aa", "title": "REGAL: Transfer Learning For Fast Optimization of Computation Graphs"}, {"paperId": "48f8882739d9f22f56016d133b5688e082db0d08", "title": "Superposition of many models into one"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "d79a26226393f687ddbc375e32055b40b8ad8d38", "title": "GPipe: Efficient Training of Giant Neural Networks using Pipeline Parallelism"}, {"paperId": "62ed9bf1d83c8db1f9cbf92ea2f57ea90ef683d9", "title": "How Powerful are Graph Neural Networks?"}, {"paperId": "f971658ab845d7573c4bbb760d5e7e5332025254", "title": "Beyond Data and Model Parallelism for Deep Neural Networks"}, {"paperId": "dd97a44fdc5923d1d3fd9d7c3dc300fb6f4f04ed", "title": "Spotlight: Optimizing Device Placement for Training Deep Neural Networks"}, {"paperId": "d9f836a2062864e4808e12224e2286a353498202", "title": "Graph Convolutional Policy Network for Goal-Directed Molecular Graph Generation"}, {"paperId": "0f885fd46064d271d4404cf9bb3d758e1a6f8d55", "title": "Exploring the Limits of Weakly Supervised Pretraining"}, {"paperId": "22ba3276c8797fddeb5d9db083ed1010da182549", "title": "A Hierarchical Model for Device Placement"}, {"paperId": "50bdda28de3dcf82a0e10f9ec13eea248b19edb5", "title": "Regularized Evolution for Image Classifier Architecture Search"}, {"paperId": "a1c922be467d1c0c64b963e65dae41778b81b2a0", "title": "Deep Learning Scaling is Predictable, Empirically"}, {"paperId": "dce6f9d4017b1785979e7520fd0834ef8cf02f4b", "title": "Proximal Policy Optimization Algorithms"}, {"paperId": "bfbd10ebffc9494423770a5bd30ebd0f9cbce66d", "title": "Device Placement Optimization with Reinforcement Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "6b7d6e6416343b2a122f8416e69059ce919026ef", "title": "Inductive Representation Learning on Large Graphs"}, {"paperId": "510e26733aaff585d65701b9f1be7ca9d5afc586", "title": "Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer"}, {"paperId": "c6850869aa5e78a107c378d2e8bfa39633158c0c", "title": "Google's Neural Machine Translation System: Bridging the Gap between Human and Machine Translation"}, {"paperId": "df0402517a7338ae28bc54acaac400de6b456a46", "title": "WaveNet: A Generative Model for Raw Audio"}, {"paperId": "2f2d8f8072e5cc9b296fad551f65f183bdbff7aa", "title": "Exploring the Limits of Language Modeling"}, {"paperId": "23ffaa0fe06eae05817f527a47ac3291077f9e58", "title": "Rethinking the Inception Architecture for Computer Vision"}, {"paperId": "cea967b59209c6be22829699f05b8b1ac4dc092d", "title": "Sequence to Sequence Learning with Neural Networks"}, {"paperId": "df86d2a8c217776786bac9019d8b20029e4c0dd5", "title": "A Fast and High Quality Multilevel Scheme for Partitioning Irregular Graphs"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "Improving deep generative modeling with applications"}, {"paperId": null, "title": "A scalable placement network with an ef\ufb01cient recurrent attention mechanism, which eliminates the need for an explicit grouping stage before placement"}]}