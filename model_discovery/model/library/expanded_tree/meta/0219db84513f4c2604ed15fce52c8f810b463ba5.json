{"paperId": "0219db84513f4c2604ed15fce52c8f810b463ba5", "abstract": "Embedding models that generate representation vectors from natural language text are widely used, reflect substantial investments, and carry significant commercial value. Companies such as OpenAI and Cohere have developed competing embedding models accessed through APIs that require users to pay for usage. In this architecture, the models are\"hidden\"behind APIs, but this does not mean that they are\"well guarded\". We present, to our knowledge, the first effort to\"steal\"these models for retrieval by training local models on text-embedding pairs obtained from the commercial APIs. Our experiments show using standard benchmarks that it is possible to efficiently replicate the retrieval effectiveness of the commercial embedding models using an attack that costs only around $200 to train (presumably) smaller models with fewer dimensions. Our findings raise important considerations for deploying commercial embedding models and suggest measures to mitigate the risk of model theft.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work presents the first effort to steal commercial embedding models for retrieval by training local models on text-embedding pairs obtained from the commercial APIs using an attack that costs only around $200 to train (presumably) smaller models with fewer dimensions."}, "embedding": {"model": "specter_v2", "vector": [-0.3139265477657318, 0.03320499137043953, -0.757526695728302, 0.2529447376728058, -0.581838846206665, -0.49880993366241455, 0.7623879909515381, -0.26638180017471313, -0.5705004334449768, -0.5325586199760437, 0.6020050644874573, -0.03432415798306465, 0.39128392934799194, 0.2919723689556122, -0.13087351620197296, 0.23363034427165985, -0.5599491596221924, 0.23591315746307373, -0.04322996363043785, -0.7039481401443481, 0.00791958812624216, -0.6556398868560791, -1.0660285949707031, 0.3477025032043457, 0.3139573335647583, 0.4114544987678528, -0.727761447429657, 0.9435837268829346, -0.34524938464164734, -0.12463407963514328, 0.46047016978263855, -0.562142014503479, 0.2714236378669739, 0.5439896583557129, -0.12366220355033875, -0.39841538667678833, 0.38548776507377625, -0.7116416692733765, -0.5686895251274109, 0.7445719242095947, -0.3179159164428711, -0.12638257443904877, 0.5975804328918457, -0.7578392028808594, -0.8073201179504395, 0.5673061609268188, 0.8348946571350098, 0.3953573703765869, 0.2531470060348511, -0.36399930715560913, 1.3419389724731445, -1.4405323266983032, 0.5549533367156982, 0.972002387046814, 0.2716350853443146, 0.3845895230770111, -0.48231542110443115, -0.7319973111152649, 0.13100075721740723, -0.06701366603374481, -1.2321844100952148, -0.2855951189994812, -0.02001267671585083, -0.037725403904914856, 1.569219708442688, -0.16845211386680603, -0.02154906652867794, 0.44086208939552307, 0.10636278241872787, 1.5359447002410889, -0.0028964499942958355, -0.7431020736694336, -0.3907546401023865, 0.5670727491378784, 0.696846604347229, 0.747553288936615, 0.10297778993844986, 0.34885719418525696, -0.8224745988845825, -0.4146448075771332, -0.2827095687389374, 0.16719187796115875, -0.17848466336727142, -0.5438810586929321, -0.10087104141712189, 1.0266526937484741, 0.4752303957939148, 0.5423007607460022, -0.07732892036437988, 0.9012208580970764, 0.6186878681182861, 0.382420152425766, 0.09103381633758545, 0.42784643173217773, 0.175764799118042, 0.42616650462150574, -0.9707773923873901, 0.23783254623413086, 0.43974658846855164, 0.6493958830833435, -0.25056192278862, -0.1044396460056305, -0.43765950202941895, -0.2215597778558731, 1.3315160274505615, 0.06169532611966133, 0.9583019614219666, -0.35495486855506897, 0.24951624870300293, -0.68695068359375, 0.26901569962501526, -0.9233649373054504, 0.45119136571884155, 0.06438267230987549, -0.2056388258934021, -1.300244688987732, -0.6533524394035339, -0.11865448951721191, -0.6410345435142517, 0.2326267659664154, -0.4112723469734192, 0.09892867505550385, 0.31553271412849426, 0.4222891628742218, 0.8383848071098328, 0.9107413291931152, 0.13752199709415436, 0.5950196385383606, 0.8699499368667603, -0.7381383180618286, -0.6260175108909607, -1.1865856647491455, 1.5300530195236206, -0.5377859473228455, 0.4046652317047119, -0.4189763069152832, -0.8024927377700806, -0.7491453289985657, -1.199018955230713, 0.19030962884426117, -1.2640273571014404, 0.3680018186569214, 0.7177295088768005, 0.8133185505867004, -0.753143846988678, 0.7041432857513428, -0.3002415895462036, -0.1642666757106781, 0.2622028589248657, 0.39263856410980225, -0.1626085788011551, -0.8829744458198547, -1.3696582317352295, 0.39657169580459595, 0.16754885017871857, -0.6289954781532288, 0.2591758668422699, -0.2237890213727951, -1.497088074684143, -0.08739084005355835, 0.10530241578817368, -0.2585162818431854, 0.7572867274284363, 0.3018665611743927, -0.8530809879302979, 0.295579195022583, -0.24487239122390747, 0.35233068466186523, -0.02772435173392296, -0.6721503734588623, -0.7768594026565552, -0.5127619504928589, -0.29665419459342957, 0.25090405344963074, 0.813863217830658, -0.1766461282968521, 0.8457942008972168, 0.40254971385002136, -0.4427315890789032, -0.020596738904714584, -1.1878397464752197, 1.06870436668396, -0.35863110423088074, -0.1947363317012787, 0.21429692208766937, 0.5250701904296875, 0.19779238104820251, -0.09567464888095856, -0.7933955788612366, -0.8577038049697876, 1.071483850479126, -0.033633939921855927, 1.2537128925323486, -1.2650783061981201, -0.584386944770813, 0.120474673807621, -0.22317911684513092, -0.016965702176094055, -0.9714528918266296, 1.2308392524719238, -0.6524686217308044, 1.1801955699920654, 0.40729233622550964, -1.2968790531158447, 0.4756557047367096, -0.5332323312759399, -0.9627736806869507, -0.14552533626556396, -0.04206686466932297, 1.199196219444275, -0.5270134806632996, 0.31064146757125854, -0.1945263147354126, 0.7342104315757751, -0.735774040222168, 0.9315599203109741, -0.242091566324234, -0.4953097701072693, -0.16941240429878235, -0.14198482036590576, -0.07037138938903809, -0.37346386909484863, 0.2770267724990845, -0.4459379315376282, 0.0689096599817276, 0.4388291537761688, -0.32763659954071045, 1.04443359375, -0.1792387217283249, 0.26902756094932556, -0.4488643407821655, -0.16098210215568542, -0.04781300947070122, 0.514817476272583, -0.2563343942165375, 0.015533714555203915, -0.11091390997171402, 0.6912943124771118, -0.5143231153488159, 0.5546157360076904, 0.9190315008163452, 1.007546305656433, -0.479209840297699, 0.5768031477928162, 0.162586972117424, -0.38519206643104553, 0.2836071252822876, 0.30612313747406006, 0.9170725345611572, 0.5040658712387085, 0.02055072784423828, 0.5896613001823425, 0.47677263617515564, -0.527097225189209, -0.6026490330696106, 0.3255273401737213, 0.8484475612640381, 0.7778821587562561, 0.18318399786949158, -0.7885276079177856, -0.036845188587903976, 0.09605231881141663, 0.8574762940406799, 1.1897832155227661, -0.05384397506713867, -0.9395871758460999, -0.3247579336166382, -0.7862070798873901, -0.09989797323942184, 0.05781388282775879, -0.37402260303497314, -0.6570639610290527, -0.3534420132637024, -1.1594775915145874, 0.6105770468711853, 0.03977254778146744, 0.6002739071846008, -0.31378453969955444, -0.1685195416212082, -0.4464854598045349, 0.35483473539352417, -0.4789527356624603, -0.7598654627799988, 0.09108170866966248, -0.31710484623908997, 0.010289627127349377, -0.21251030266284943, 0.21465498208999634, 0.3493461012840271, -0.35719233751296997, 0.6307291984558105, 0.051008038222789764, -0.234771728515625, 0.37554794549942017, 0.3270138204097748, -0.37717220187187195, -0.4344184100627899, 0.5156049132347107, 0.19900260865688324, -0.43023499846458435, 0.6744644045829773, 0.835889995098114, -0.21860569715499878, 0.1438031792640686, -0.8289881348609924, -0.09829624742269516, 0.11511518806219101, 0.4018293023109436, 0.16177955269813538, -0.2171495407819748, -0.2357722669839859, -1.0050671100616455, 1.1210991144180298, -0.11481481045484543, -0.200800359249115, 0.27423447370529175, -0.9280827641487122, -0.15261058509349823, 0.666659951210022, -0.7766106724739075, 0.2968631982803345, -1.0423712730407715, 0.4716738760471344, -0.18713197112083435, 0.12913066148757935, 0.8184249401092529, 0.4681099057197571, 0.1170758455991745, 0.1715206354856491, 0.48115330934524536, 0.5527885556221008, -0.32601848244667053, 0.737812876701355, -0.782871663570404, -0.12060510367155075, 0.48799240589141846, 0.9029757976531982, -0.14981989562511444, -0.4320155680179596, -0.36001333594322205, -0.16296622157096863, -0.32694461941719055, 0.05642126128077507, -0.1349109709262848, -0.006895430386066437, -0.3637033998966217, -0.3681330978870392, -0.5219714045524597, -1.1818777322769165, 0.34790492057800293, 0.058553848415613174, -0.30977338552474976, 0.19089928269386292, -0.827116072177887, -1.3118900060653687, -0.4603886306285858, -0.6907950043678284, -1.2113816738128662, 0.5080506801605225, -0.1449691206216812, -0.7665660381317139, -0.46711137890815735, 0.376228392124176, -0.23455612361431122, 1.1086829900741577, -0.6011084318161011, 0.6430968046188354, -0.36200806498527527, -0.044632039964199066, -1.3293699026107788, 0.08084244281053543, 0.6287110447883606, -0.4346419870853424, 0.6764854788780212, -0.5203794836997986, 0.014202836900949478, -0.3662336766719818, -0.3623850643634796, 0.07013355195522308, 0.05263102799654007, 0.44197767972946167, -0.21490782499313354, -0.6802833676338196, 0.32909339666366577, 1.7652393579483032, -0.8142815232276917, 0.20315071940422058, 0.3775387704372406, 0.9006240367889404, 0.5278562307357788, -0.4025229513645172, 0.22960899770259857, -0.0869223028421402, 0.6580247282981873, -0.1096242293715477, -0.0443776398897171, -0.055184267461299896, -0.8102869391441345, 0.9986304640769958, 1.6197988986968994, 0.8432404398918152, -0.1167987510561943, -1.2418155670166016, 0.1292182058095932, -1.0937061309814453, -0.6018410325050354, 0.6155346632003784, 0.9369871616363525, 0.28873127698898315, -0.31249773502349854, -0.3944198489189148, -0.14793308079242706, 0.3105081021785736, 0.45754289627075195, -0.2887236773967743, -0.838862955570221, 0.3529095947742462, 0.830608069896698, 0.5777203440666199, 0.3329405188560486, -0.3820178508758545, 0.4906918704509735, 14.724967956542969, 0.7579994201660156, -0.13470163941383362, 0.4842894375324249, 0.5112133026123047, 0.240523099899292, -0.392280250787735, -0.13240574300289154, -1.3094698190689087, 0.11493732035160065, 1.504028558731079, 0.04507843777537346, 0.12185047566890717, 0.2874193787574768, -0.5448862910270691, 0.6380128264427185, -0.5126487612724304, 0.39293038845062256, 0.9849765300750732, -1.2513412237167358, 0.27119916677474976, 0.7711396217346191, -0.05356307700276375, 0.5563468933105469, 1.4970232248306274, 0.7770110964775085, 0.5974922776222229, -0.7116216421127319, 0.08677532523870468, 0.232962965965271, 0.8508434891700745, -0.20631830394268036, 0.8347665071487427, 0.3848866820335388, -0.4687446653842926, -0.1351815015077591, -0.5407341718673706, -0.8116297721862793, 0.12245514243841171, -0.08537138253450394, -0.5906316637992859, -0.32919245958328247, -0.4898005723953247, 0.8841819167137146, -0.35903114080429077, 0.43296298384666443, -0.0858645960688591, 0.42826563119888306, -0.4283568561077118, -0.17996211349964142, 0.26287055015563965, 0.3347732126712799, 0.26670536398887634, -0.22951996326446533, 0.3511909544467926, -0.604324221611023, 0.04546327888965607, 0.3046112060546875, -0.5262460112571716, 0.24605363607406616, -1.0027815103530884, -0.7470634579658508, -0.22751756012439728, 0.6712979078292847, 0.7785295248031616, 0.2839863896369934, -0.573969304561615, 0.582598090171814, 0.389557808637619, 0.3448297679424286, -0.15785962343215942, -0.15190760791301727, 0.26526135206222534, 0.04543280228972435, -0.24106940627098083, 0.35431942343711853, 0.14893503487110138, -0.7947521805763245, -0.5223672389984131, -0.4024381637573242, 0.35980185866355896, -0.6032118797302246, -1.0474672317504883, 1.0503093004226685, -0.3155692517757416, -0.7631011009216309, -0.3719784617424011, -0.7831504344940186, 0.03196563199162483, 0.6517525911331177, -1.513747215270996, -0.6017797589302063, 0.6373187899589539, -0.7257882952690125, -0.7355472445487976, -0.29709339141845703, 1.7007532119750977, 0.08927469700574875, -0.43591049313545227, -0.06716295331716537, 0.5925516486167908, 0.43002116680145264, 0.10610494762659073, -0.6280802488327026, 0.7632640600204468, -0.03062283620238304, 0.23463894426822662, 0.6516129970550537, -0.04385954141616821, -0.04318832606077194, -0.9330610036849976, 0.03364735096693039, 0.7496789693832397, -1.334482192993164, -0.1640261709690094, -0.6212161779403687, -0.6069819331169128, -0.02680186554789543, 0.5459585189819336, -0.24174270033836365, 1.0823559761047363, 0.18420307338237762, -0.9410545229911804, -0.10832376033067703, -0.7530950903892517, 0.6178622245788574, -0.03709392994642258, -1.054404377937317, -0.15140752494335175, 0.45134127140045166, 0.0812406986951828, -0.45572972297668457, -0.49215689301490784, -0.11045215278863907, 0.19609224796295166, 0.2580226957798004, 1.2025425434112549, -0.4791015088558197, 1.1134183406829834, 0.8785821795463562, -0.13878865540027618, -0.5772594213485718, 0.304185688495636, -0.7729813456535339, -0.5054713487625122, -0.2031257003545761, 0.736169159412384, -0.527046263217926, 0.6900614500045776, 1.5997166633605957, 0.7807403206825256, -0.24092693626880646, -0.3121394217014313, -0.6263301968574524, 0.09511710703372955, -0.09172617644071579, 0.18437635898590088, -0.19204112887382507, 0.11277183145284653, -0.03211385756731033, 0.3690091073513031, 0.33504733443260193, -0.03074825555086136, -0.8802556991577148, 0.6563339233398438, -0.2720871865749359, 0.05663913115859032, -0.44761136174201965, -0.5272064208984375, -1.0771726369857788, 0.28808319568634033, -1.234140157699585, -0.3182840943336487, -0.8076870441436768, -0.5270558595657349, 0.23207463324069977, -0.07864518463611603, 0.01890985108911991, 0.572594940662384, 0.12014716118574142, -0.3110091984272003, -0.15248185396194458, -0.3583816885948181, 0.51849764585495, 0.46664223074913025, -0.6805524230003357, 0.009159823879599571, -0.3669477105140686, -0.3381354808807373, 0.03838370367884636, 0.346606969833374, -0.5061548948287964, -0.8485257029533386, -1.1912928819656372, 0.5361642241477966, -0.4698926508426666, -0.20179004967212677, -0.28774088621139526, 0.6210418343544006, 0.5552055835723877, 0.025770006701350212, 0.2918243408203125, 0.42061468958854675, -1.217098593711853, -0.3313394784927368, 0.4856502115726471, -0.8673203587532043, 0.8629008531570435, 0.01987754926085472, -0.49778568744659424, -0.2668564021587372, 0.3745630383491516, -0.45205628871917725, -0.5674511790275574, -0.5382652282714844, 0.31418806314468384, -0.5305842757225037, -0.35573455691337585, -0.07233060896396637, -0.40217307209968567, -1.2946314811706543, -0.636225163936615, -0.10237284004688263, 0.01668851263821125, -0.21119119226932526, 0.8384883403778076, 0.6282768845558167, -1.3737486600875854, 0.06719456613063812, 0.523974597454071, 0.16126088798046112, -0.7194728255271912, 0.21159294247627258, 0.02567114122211933, -0.6492958664894104, 0.3366134762763977, 0.5198535919189453, 0.4034917652606964, -1.0322191715240479, -0.05357362702488899, 0.41013267636299133, -0.7866893410682678, -0.2651239037513733, 0.8592785596847534, -0.6399027705192566, -0.8531432747840881, -0.14663487672805786, -0.7360782027244568, -0.4616233706474304, -0.4749624729156494, 0.5172247886657715, -0.1587311178445816, 0.06043750047683716, -0.33364206552505493, -0.4520001709461212, -0.039105337113142014, -0.4961145520210266, -0.7825046181678772, 0.45250996947288513, 0.06474187225103378, -0.40766462683677673, 0.32461270689964294, 1.4819408655166626, -0.5597095489501953, -0.09313786029815674, -0.6973152160644531, -0.21082711219787598, -0.47902369499206543, 0.45807966589927673, -0.2802685797214508, -0.30064234137535095, 0.5083527565002441, 0.6486081480979919, 0.45638054609298706, -0.2198406606912613, -0.529341995716095, 0.6881687641143799, 0.7393814325332642, -0.24810166656970978, -0.4205797016620636, -0.23987090587615967, 1.2018465995788574, 1.2189295291900635, -0.8077087998390198, 0.5987409353256226, -0.31360718607902527, -0.3696739077568054, 0.8484423756599426, 0.09705179929733276, -0.17883096635341644, 1.323670744895935, -0.09444494545459747, 0.3045732080936432, 0.0407344289124012, -1.0630942583084106, -0.04197155311703682, 1.366642713546753, 0.8448801636695862, 0.8819625377655029, 0.06086017191410065, -0.11543017625808716, 0.33289647102355957, 0.07405922561883926, 0.1391710788011551, 0.5233429074287415, 0.8920027017593384, 0.14258792996406555, -0.6788635849952698, -0.01658632792532444, 0.8296266794204712, -0.8016942143440247, -0.8005004525184631, -0.13072583079338074, 0.8705052137374878, -0.06163501739501953, 0.20847631990909576, 0.595601499080658, -0.6382970213890076, 0.5637302994728088, 0.7724717259407043, -0.21468019485473633, -0.8913096189498901, -0.5899414420127869, -0.3254077434539795, -0.38512492179870605, 0.26256898045539856, -0.009394627995789051, -0.6352517008781433, 0.04888344183564186, -0.42827942967414856, 0.27224239706993103, 0.04108525812625885, 0.2174384593963623, 0.7178356647491455, 0.6406664252281189, -0.15270060300827026, -0.372736394405365, -0.35110801458358765, -0.5406622290611267, -0.5348222255706787, -0.055938903242349625, -0.3668658137321472, -0.4026642441749573, -0.008085723035037518, -0.43820175528526306, -0.6933475732803345]}, "authors": [{"authorId": "2124417361", "name": "M. Tamber"}, {"authorId": "2235064158", "name": "Jasper Xian"}, {"authorId": "2306070594", "name": "Jimmy Lin"}], "references": [{"paperId": "03bdd9cbb3b768ff3e96c97b28e106748b6e4fd0", "title": "Nomic Embed: Training a Reproducible Long Context Text Embedder"}, {"paperId": "a531e9a328ad1488567fa68c15d5bf30bfb90c78", "title": "Fine-Tuning LLaMA for Multi-Stage Text Retrieval"}, {"paperId": "7da6c9273a14eb8681824d0c3ee84e05366c5627", "title": "Can't Steal? Cont-Steal! Contrastive Stealing Attacks Against Image Encoders"}, {"paperId": "4f4a409f701f7552d45c46a5b0fea69dca6f8e84", "title": "Unsupervised Dense Information Retrieval with Contrastive Learning"}, {"paperId": "9f2cf7b35224aad3a8d261e4456fe2d65a5f5d3e", "title": "Large Dual Encoders Are Generalizable Retrievers"}, {"paperId": "c107835a05ca6fda6e73b64e2ed9884de4fcec0f", "title": "A proposed conceptual framework for a representational approach to information retrieval"}, {"paperId": "807600ef43073cd9c59d4208ee710e90cf14efa8", "title": "BEIR: A Heterogenous Benchmark for Zero-shot Evaluation of Information Retrieval Models"}, {"paperId": "494e730f73035376736b36cecf2023ea6deb3cbe", "title": "Overview of the TREC 2020 Deep Learning Track"}, {"paperId": "c9b8593db099869fe7254aa1fa53f3c9073b0176", "title": "Approximate Nearest Neighbor Negative Contrastive Learning for Dense Text Retrieval"}, {"paperId": "8f34ee2ec88e8b19b2736de55eb170539d26e527", "title": "Making Monolingual Sentence Embeddings Multilingual Using Knowledge Distillation"}, {"paperId": "b26f2037f769d5ffc5f7bdcec2de8da28ec14bee", "title": "Dense Passage Retrieval for Open-Domain Question Answering"}, {"paperId": "1163d1ffeb57695dafe7084a63dafd5d34004db5", "title": "Overview of the TREC 2019 deep learning track"}, {"paperId": "ac713aebdcc06f15f8ea61e1140bb360341fdf27", "title": "Thieves on Sesame Street! Model Extraction of BERT-based APIs"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "a54b56af24bb4873ed0163b77df63b92bd018ddc", "title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter"}, {"paperId": "93d63ec754f29fa22572615320afe0521f7ec66d", "title": "Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks"}, {"paperId": "a08293b2c9c5bcddb023cc7eb3354d4d86bfae89", "title": "Distilling Task-Specific Knowledge from BERT into Simple Neural Networks"}, {"paperId": "7113bd87c3e6f727efae24ee52f20c81358da761", "title": "SentEval: An Evaluation Toolkit for Universal Sentence Representations"}, {"paperId": "ba28252bea09d49202d45f04b69f9b357dff0a6f", "title": "Turning Your Weakness Into a Strength: Watermarking Deep Neural Networks by Backdooring"}, {"paperId": "dd95f96e3322dcaee9b1e3f7871ecc3ebcd51bfe", "title": "MS MARCO: A Human Generated MAchine Reading COmprehension Dataset"}, {"paperId": "8a95423d0059f7c5b1422f0ef1aa60b9e26aab7e", "title": "Stealing Machine Learning Models via Prediction APIs"}, {"paperId": "4d548fd21aad60e3052455e22b7a57cc1f06e3c3", "title": "CloudLeak: Large-Scale Deep Learning Models Stealing Through Adversarial Examples"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "68b13366ee7d0e398c2b8736cb8d42052ffbe190", "title": "Empirical Methods in Natural Language Processing"}, {"paperId": null, "title": "2022. Matryoshka Representation Learning"}, {"paperId": null, "title": "2023. MTEB: Massive text embedding benchmark"}, {"paperId": null, "title": "2023. Sentence Embedding Encoders are Easy to Steal but Hard to Defend"}, {"paperId": null, "title": "2023. SimTDE: Simple transformer distillation for sentence embed-dings"}, {"paperId": null, "title": "2022. StolenEncoder: Stealing Pre-trained Encoders in Self-supervised Learning"}]}