{"paperId": "d84b292c2e90d0b0edfedc33141d305d8e9de5df", "abstract": "Models based on the attention mechanism, i.e. transformers, have shown extraordinary performance in Natural Language Processing (NLP) tasks. However, their memory footprint, inference latency, and power consumption are still prohibitive for efficient inference at edge devices, even at data centers. To tackle this issue, we present an algorithm-architecture co-design with dynamic and mixed-precision quantization, DTQAtten. We present empirically that the tolerance to the noise varies from token to token in attention-based NLP models. This finding leads us to quantize different tokens with mixed levels of bits. Thus, we design a compression framework that (i) dynamically quantizes tokens while they are forwarded in the models and (ii) jointly determines the ratio of each precision. Moreover, due to the dynamic mixed-precision tokens caused by our framework, previous matrix-multiplication accelerators (e.g. systolic array) cannot effectively exploit the benefit of the compressed attention computation. We thus design our accelerator with the variable-speed systolic array (VSSA) and propose an effective optimization strategy to alleviate the pipeline-stall problem in VSSA without hardware overhead. We conduct experiments with existing attention-based NLP models, including BERT and GPT-2 on various language tasks. Our results show that DTQAtten outperforms the previous neural network accelerator Eyeriss by 13.12\u00d7 in terms of speedup and 3.8\u00d7 in terms of energy-saving. Compared with the state-of-the-art attention accelerator SpAtten, our DTQAtten achieves at least 2.65\u00d7 speedup and 3.38\u00d7 energy efficiency improvement.", "venue": "Design, Automation and Test in Europe", "year": 2022, "citationCount": 9, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work designs an algorithm-architecture co-design with dynamic and mixed-precision quantization with an effective optimization strategy to alleviate the pipeline-stall problem in VSSA without hardware overhead and conducts experiments with existing attention-based NLP models."}, "embedding": {"model": "specter_v2", "vector": [0.349944144487381, 0.4735838770866394, -0.5446469187736511, 0.18796990811824799, -0.5130522847175598, -0.03068722039461136, 0.29207471013069153, 0.5487054586410522, -0.7704000473022461, -0.4294782280921936, 0.6384538412094116, -0.1731090247631073, 0.5171430110931396, -0.2721627652645111, -0.03975411877036095, 0.13390381634235382, -0.9492648839950562, 0.30452200770378113, -0.14615079760551453, -0.11885008960962296, 0.13305604457855225, -0.4219810962677002, -0.9449110627174377, 0.2329651564359665, 0.38941219449043274, 0.8367214202880859, 0.05533355474472046, 0.9129037261009216, -0.7984708547592163, 0.23152011632919312, 0.38028469681739807, -0.3598606586456299, 0.2253478765487671, 0.38426506519317627, -0.12392781674861908, -0.6966122984886169, 0.40214142203330994, -0.39209407567977905, -0.46772411465644836, 1.2208025455474854, -0.29081442952156067, 0.1400546431541443, 0.38475501537323, -0.7822982668876648, -0.5583932399749756, 0.9420725703239441, 0.24442754685878754, 1.0008814334869385, -0.4959146976470947, -0.22752515971660614, 1.381252646446228, -1.100659728050232, -0.07660000026226044, 1.4643774032592773, 0.45551547408103943, 0.13282866775989532, -0.07137094438076019, -0.34983065724372864, 0.3218613862991333, 0.3228004276752472, -1.114323616027832, -0.6949946284294128, -0.0892912968993187, -0.07666736841201782, 2.1750500202178955, -0.20719607174396515, 0.0867505669593811, 0.06935473531484604, 0.23499147593975067, 1.547144889831543, -0.5640376210212708, -1.0917716026306152, 0.09281707555055618, -0.6288519501686096, 0.4574969708919525, 0.8768428564071655, -0.05349109321832657, 0.0288263987749815, -1.1909445524215698, -0.2831658124923706, 0.35202455520629883, -0.03556647151708603, 0.45290160179138184, 0.2037891149520874, -0.4045497477054596, 0.6319659352302551, 0.32824259996414185, 0.6361703872680664, -0.5479267835617065, 0.891277551651001, 1.0783692598342896, -0.0028933994472026825, -0.2276698648929596, 0.2241477370262146, -0.1084381714463234, 0.004814742598682642, -1.3050248622894287, 0.21591360867023468, -0.2862141728401184, 0.8508188128471375, -0.364638090133667, 0.7281279563903809, -1.1472512483596802, -0.09621108323335648, 1.1286084651947021, 0.5044838190078735, 0.2548508942127228, -0.42217692732810974, 0.5213510394096375, -0.6265964508056641, 0.14943963289260864, -0.6002602577209473, -0.19712458550930023, -0.20610560476779938, -1.353770136833191, -1.076107382774353, -0.2377750277519226, 0.12404980510473251, -1.0698726177215576, 0.43663689494132996, -0.5382322669029236, -0.023101748898625374, 0.32435688376426697, 0.20696355402469635, 0.5275890827178955, 0.6871663928031921, 0.41323021054267883, 0.006833522114902735, 1.7891368865966797, -0.8993773460388184, -1.0234485864639282, -1.1442185640335083, 0.4850928485393524, -0.23127403855323792, 0.13354483246803284, -0.23874318599700928, -1.616923213005066, -0.8640286326408386, -0.657513439655304, -0.4888648986816406, -0.2141878753900528, 0.07805135846138, 0.8913378119468689, 0.3184616267681122, -1.1942306756973267, 0.4835517704486847, -0.606640100479126, 0.23185396194458008, 0.7011755704879761, 0.28169429302215576, 0.9743121862411499, 0.1691734939813614, -1.286135196685791, -0.03175658732652664, 0.05672046169638634, -0.4692576229572296, 0.06967272609472275, -0.6470676064491272, -1.0572422742843628, 0.6686819195747375, 0.23024781048297882, -0.6095897555351257, 1.4629602432250977, 0.32398125529289246, -0.9477630853652954, 0.32216712832450867, -0.8305941224098206, -0.18077906966209412, -0.3952754735946655, 0.029618803411722183, -0.4746760427951813, -0.2641999125480652, -0.1834920048713684, 0.7181148529052734, 0.5367147922515869, 0.3772544264793396, -0.3724781274795532, -0.047980841249227524, -0.39143499732017517, -0.2574676275253296, -0.5189499258995056, 1.165536642074585, -0.6130687594413757, -0.3379155397415161, 0.4683592915534973, 0.8306256532669067, -0.2988951504230499, 0.0648871511220932, -0.5612249374389648, -1.0142431259155273, 0.5151016712188721, 0.23645812273025513, 1.128129482269287, -1.2085062265396118, -1.1163872480392456, -0.17450828850269318, 0.029777703806757927, 0.08299620449542999, -0.423980176448822, 0.4218701422214508, -0.13298553228378296, 0.3280807435512543, 0.10270297527313232, -0.7921206951141357, 0.27280277013778687, -0.3356752097606659, -0.9233942627906799, -0.4997239410877228, 0.18520455062389374, 1.332119345664978, -0.8854069113731384, -0.3223981559276581, -0.2774406671524048, 0.47397592663764954, -1.0730781555175781, 0.9385859966278076, -0.5807762742042542, 0.04107314348220825, -0.2457200139760971, -0.02737095020711422, 0.2743105888366699, -0.2446601390838623, 0.18626300990581512, -0.759074330329895, -0.3674716353416443, 0.6368672847747803, -0.19105707108974457, 1.411994218826294, -0.26586973667144775, 0.5834931135177612, 0.09478393197059631, -0.45734816789627075, 0.3534387946128845, 0.44175106287002563, -0.4839651882648468, -0.6369033455848694, 0.5044874548912048, 0.3589593172073364, -0.159688338637352, 0.03673712909221649, 1.3955192565917969, 1.2371357679367065, -0.5733391046524048, 0.17958123981952667, 0.24736742675304413, -0.26921218633651733, 0.6539545655250549, 0.3240453898906708, 0.7802774906158447, -0.19304493069648743, 0.4694656729698181, -0.10089090466499329, 0.47532081604003906, -0.6114830374717712, -0.07863350212574005, 0.7453026175498962, 0.39793339371681213, 0.44335025548934937, 0.6419023275375366, -0.8534775972366333, -0.4940486550331116, 0.28629767894744873, 0.5025068521499634, 1.4974614381790161, -0.5713452696800232, -0.04242701455950737, -0.658044159412384, -0.11249575763940811, -0.31859540939331055, -0.152448832988739, 0.2364775687456131, 0.12593750655651093, -0.6140021681785583, -0.9966306090354919, 1.3399993181228638, 0.6152216792106628, 0.9511869549751282, -0.7915626764297485, -0.4929238259792328, -0.40995731949806213, 0.18090468645095825, -0.936492919921875, -0.6488725543022156, 0.7546519041061401, -0.47721990942955017, 0.3728809058666229, 0.4664286673069, -0.22292791306972504, 0.1391371488571167, -0.9982182383537292, 0.8305737376213074, -0.5958132147789001, -0.2638465464115143, -0.553321361541748, 0.6131047606468201, -0.7957360148429871, -0.6946684718132019, 0.3328556418418884, -0.12888969480991364, -0.4615609347820282, 0.9240910410881042, 0.48351022601127625, -0.03254982456564903, -0.845061719417572, -0.36727720499038696, -0.2789614796638489, 0.2415245622396469, -0.0456690639257431, 0.8217828273773193, -0.1428937166929245, -0.2038414180278778, -0.9195019602775574, 0.9777861833572388, 0.5578749775886536, -0.6352509260177612, -0.012737481854856014, -0.34799525141716003, 0.10315321385860443, 0.8373579382896423, -0.4326392114162445, -0.1539457142353058, -0.7586874961853027, -0.14194992184638977, -0.5596640706062317, -0.2590029239654541, 0.3361975848674774, 0.36916854977607727, 0.10180185735225677, 0.20623624324798584, 0.6846266984939575, 0.31791120767593384, 0.2995781898498535, 0.5536000728607178, -0.36848852038383484, 0.668945848941803, 0.12423574924468994, -0.03453778102993965, -0.05517635494470596, 0.10168413817882538, -0.7869144082069397, -0.1744411587715149, -0.10727117210626602, 0.0038437291514128447, 0.14322108030319214, 0.138104647397995, -0.499960720539093, -0.9982500076293945, -0.200896218419075, -1.49893319606781, 0.08471281826496124, -0.22100353240966797, -0.20774638652801514, 0.014703772030770779, -0.9744608402252197, -1.6511927843093872, -0.7169561982154846, -1.2852482795715332, -1.133727788925171, 0.7378677129745483, 0.025731205940246582, -0.4276392161846161, -0.4366344213485718, -0.3751964569091797, -0.6868155002593994, 1.1600512266159058, -0.9446601867675781, 1.0081861019134521, -0.09566901624202728, -0.35253021121025085, 0.06617727875709534, -0.20446760952472687, -0.03240761160850525, -0.5209684371948242, 0.3903835117816925, -0.8613530397415161, 0.6136648654937744, -0.18768715858459473, -0.22693800926208496, 0.3730180859565735, 0.635263979434967, 1.0532525777816772, 0.02983202040195465, -0.5514693856239319, 0.38150009512901306, 1.302964210510254, -0.46477577090263367, 0.30703243613243103, -0.17154507339000702, 0.7513546347618103, -0.4465995728969574, -0.13307711482048035, 0.7110060453414917, 0.0012592603452503681, 0.4520116150379181, 0.2493184357881546, 0.03992486372590065, -0.08481451869010925, 0.13887929916381836, 0.005501164123415947, 1.768369436264038, 0.627055823802948, -0.32788145542144775, -1.0307024717330933, 0.7130853533744812, -1.010532021522522, -0.6086887121200562, 0.26067543029785156, 0.48827695846557617, 0.3836967349052429, -0.008841538801789284, -0.5736225247383118, 0.3061496615409851, 0.3986811637878418, 0.654374361038208, -0.2258298397064209, -1.5261155366897583, 0.44641122221946716, 0.5402206182479858, 0.4419955909252167, 0.6196587085723877, -0.4092167019844055, 0.4495580196380615, 14.482712745666504, 1.1256332397460938, -0.10462847352027893, 0.31995755434036255, 0.42093750834465027, 0.5848349928855896, -0.1502780020236969, -0.44140228629112244, -1.4251092672348022, -0.07505728304386139, 1.3936671018600464, 0.04763048142194748, 0.13399888575077057, 0.05169489234685898, 0.10999522358179092, 0.20614910125732422, -0.40822353959083557, 0.5454927086830139, 0.3140960931777954, -1.4518160820007324, 0.3919181227684021, 0.03709446266293526, -0.10190580040216446, 0.3617222309112549, 0.7713475227355957, 0.6858088970184326, 0.27247828245162964, -0.10322799533605576, 0.33065009117126465, 0.15188544988632202, 1.0078271627426147, 0.021973436698317528, 0.3868696093559265, 0.4790768325328827, -1.2188801765441895, -0.1063411757349968, -0.6042088270187378, -1.3980950117111206, 0.21757623553276062, 0.48731115460395813, -0.6418800950050354, -0.47541239857673645, -0.40417617559432983, 0.23824523389339447, 0.49958276748657227, 0.5047571063041687, -0.24568048119544983, 0.5740610957145691, -0.19093580543994904, -0.3459421396255493, 0.1260288506746292, 0.705825686454773, 0.029237398877739906, 0.2683009207248688, -0.1283319592475891, -0.16630016267299652, 0.09798743575811386, 0.6671764254570007, -0.4758744239807129, -0.5284731388092041, -0.0002718127507250756, -0.3521032929420471, 0.2585504651069641, 0.74500972032547, 0.06206575408577919, 0.25275203585624695, -0.45110562443733215, 0.167683407664299, 0.5431317090988159, -0.0535796582698822, -0.3331810235977173, -0.5139428377151489, 0.21619614958763123, -0.7578073143959045, 0.20445676147937775, 0.42656856775283813, -0.5792167782783508, -0.2167883664369583, -0.6646612286567688, -0.3571172058582306, 0.24010634422302246, -0.5105777978897095, -0.4737892746925354, 1.015028715133667, -0.4236559271812439, -0.10533451288938522, 0.3669432997703552, -0.7570992708206177, -0.15028010308742523, 0.6407722234725952, -1.3602616786956787, -0.4940216541290283, 0.5636002421379089, -0.4275399446487427, -0.3435283303260803, 0.3157469630241394, 1.5221803188323975, 0.3164457082748413, -0.40790724754333496, 0.023542020469903946, 0.14028210937976837, 0.37422847747802734, -0.5080945491790771, -0.7403132319450378, 1.4254794120788574, 0.37673574686050415, -0.17983771860599518, 0.008952363394200802, 0.07610073685646057, 0.10561271011829376, -1.0646088123321533, -0.3614072799682617, 1.1070393323898315, -0.5094791650772095, -0.2428092360496521, -0.85714191198349, -0.9266545176506042, 0.27991819381713867, 0.42150217294692993, 0.00116463634185493, 0.1613495647907257, 0.15666134655475616, -0.4212401807308197, -0.015152023173868656, -0.6529098153114319, 0.19454923272132874, 0.18196548521518707, -0.8565304279327393, -0.3225904405117035, -0.22394663095474243, 0.618111252784729, -1.555334210395813, -0.5114552974700928, -0.28189143538475037, 0.17205582559108734, 0.2703801691532135, 1.2707321643829346, -0.051520030945539474, 1.0047920942306519, 0.7253124117851257, 0.13235732913017273, -0.3873743712902069, -0.019562911242246628, -0.5168248414993286, -0.4562740623950958, 0.05086853727698326, 0.5348181128501892, -0.16565124690532684, 0.9568601250648499, 1.0212143659591675, -0.07269296795129776, -0.44641005992889404, -0.7841734290122986, -0.19771277904510498, -0.20313800871372223, -0.6254645586013794, 0.6684985756874084, -0.26915550231933594, 0.30274519324302673, 0.04176165908575058, 0.7584735751152039, 0.661736011505127, -0.19122345745563507, -0.28471308946609497, 0.0350315161049366, 0.14531473815441132, 0.1219228208065033, -0.6421476602554321, -0.6882264018058777, -1.523568034172058, -0.16667279601097107, -0.9398384094238281, 0.18086974322795868, -0.7708213329315186, -0.5150602459907532, -0.07763735204935074, 0.000891802366822958, 0.3896445035934448, 0.14929743111133575, -0.18773995339870453, -0.7628183960914612, -0.6168174147605896, -0.349813312292099, 0.7967163324356079, 0.8019914031028748, -0.8803845047950745, -0.08301803469657898, -0.2840564548969269, 0.16202835738658905, 0.32471317052841187, 0.4439103305339813, -0.4082075357437134, -0.5741440653800964, -1.4538819789886475, 0.3057735562324524, 0.18947823345661163, -0.27981486916542053, -0.936809241771698, 1.272798776626587, 0.33426234126091003, -0.44106706976890564, -0.3293229341506958, 0.45178964734077454, -0.8132383227348328, -0.9309051036834717, 0.6933315992355347, -0.8989272713661194, 0.1399315446615219, 0.7184064388275146, -0.7251656651496887, -0.19886291027069092, 0.4529765248298645, -0.46804043650627136, -0.6512598991394043, -0.7435528635978699, 0.3813129663467407, -0.7116451263427734, 0.4542512595653534, -0.5973942875862122, -0.01856682077050209, -1.4119704961776733, 0.11974794417619705, 0.26773443818092346, 0.2433895766735077, -0.73860764503479, 0.5786687135696411, 0.4346352517604828, -0.7111915349960327, 0.0996755063533783, 0.7433162927627563, -0.4274657666683197, 0.33415648341178894, 0.4308568835258484, 0.6054753661155701, -0.561799168586731, 0.9029643535614014, 0.20350873470306396, -0.06066809594631195, -1.0161124467849731, 0.25166013836860657, 0.23574841022491455, -0.49508601427078247, -0.28879740834236145, 1.0884963274002075, -0.7108362913131714, -0.5858703255653381, 0.196786567568779, -1.8573704957962036, -0.5561262965202332, -0.36880847811698914, 0.7583076357841492, -0.0077117858454585075, 0.33794063329696655, 0.14489465951919556, -0.6660950779914856, -0.12309854477643967, -0.19157592952251434, -0.307076096534729, 0.0028173059690743685, 0.0859735757112503, -0.6430767178535461, 0.04345310851931572, 0.3341931104660034, -0.45330506563186646, -0.1951238363981247, -0.7485266327857971, -0.3210510313510895, -0.23892474174499512, 0.6574441194534302, -0.01693851314485073, -0.6532971262931824, 0.9419645071029663, 0.2263302057981491, 0.6462534666061401, 0.2940683960914612, -0.4476141035556793, 0.5457266569137573, 0.6571019291877747, 0.11979153752326965, -0.34586063027381897, -0.888978898525238, 1.4981809854507446, 0.9785714149475098, -0.47653627395629883, 0.3352808952331543, -0.5225335955619812, -0.4546080231666565, 0.9094549417495728, 0.39323797821998596, 0.13343055546283722, 0.8937921524047852, 0.6769470572471619, -0.09621717780828476, -0.06949319690465927, -0.9109113812446594, -0.35373905301094055, 0.42651036381721497, 0.852683961391449, 0.7502548694610596, 0.1702975630760193, 0.11714667081832886, 0.9519689083099365, 0.25686150789260864, 0.35498493909835815, 0.4429847300052643, 0.5629091262817383, -0.31700393557548523, -0.18531180918216705, -0.47342246770858765, 1.0381683111190796, -0.7691954970359802, -1.1020251512527466, 0.6622386574745178, 0.5109079480171204, 0.21893244981765747, 0.5574758052825928, 1.3186441659927368, 0.0708019956946373, 0.5213366746902466, 0.06833630800247192, 0.4796260893344879, -0.5079329013824463, -0.5426473617553711, -0.2425864338874817, -0.835945725440979, 0.10936427116394043, -0.007590807043015957, -0.3465384840965271, -0.6994924545288086, -0.46998709440231323, 0.3036747872829437, 0.28261393308639526, 0.2879980504512787, 0.6795971989631653, 0.8930492401123047, 1.0222944021224976, -0.7499952912330627, -0.5080011487007141, -0.36796602606773376, -0.7312420606613159, -0.07471270114183426, -0.9640470147132874, 0.03094208426773548, 0.34676575660705566, 0.08454357832670212, -0.26273271441459656]}, "authors": [{"authorId": "2122900858", "name": "Tao Yang"}, {"authorId": "2115199173", "name": "Dongyue Li"}, {"authorId": "123930868", "name": "Zhuoran Song"}, {"authorId": "2109819730", "name": "Yilong Zhao"}, {"authorId": "1491233985", "name": "Fangxin Liu"}, {"authorId": "2108184060", "name": "Zongwu Wang"}, {"authorId": "2116778755", "name": "Zhezhi He"}, {"authorId": "2148655643", "name": "Li Jiang"}], "references": [{"paperId": "7b8f3f65a98340d6e5ab94bd9a4ccb8f75704fd8", "title": "I-BERT: Integer-only BERT Quantization"}, {"paperId": "73e0f38ab49b19b86321016b773e15f1d02e3a72", "title": "SpAtten: Efficient Sparse Attention Architecture with Cascade Token and Head Pruning"}, {"paperId": "82d94353c60a8e0ff7ed4eb9f0dca65ac2ccbfcb", "title": "Search What You Want: Barrier Panelty NAS for Mixed Precision Quantization"}, {"paperId": "503503ec4395ab0e36d4f0a190772f7785649319", "title": "Towards Fully 8-bit Integer Inference for the Transformer Model"}, {"paperId": "9bb5665fe48e7122beda73a53316de9f7f243b19", "title": "APQ: Joint Search for Network Architecture, Pruning and Quantization Policy"}, {"paperId": "dff076e78b3f333772be076c65a96e3b7a70ba92", "title": "DRQ: Dynamic Region-based Quantization for Deep Neural Network Acceleration"}, {"paperId": "7b9b756ab509cb9f52dbac95e3e901d571f0784f", "title": "A Survey of the Usages of Deep Learning for Natural Language Processing"}, {"paperId": "d3c6c635b9cfd8890c7244d3db4be53d45944963", "title": "A^3: Accelerating Attention Mechanisms in Neural Networks with Approximation"}, {"paperId": "0e0a24ca2869e56ffe47a87d360b78b6994c8f58", "title": "Gemmini: Enabling Systematic Deep-Learning Architecture Evaluation via Full-Stack Integration"}, {"paperId": "ce106590145e89ea4b621c99665862967ccf5dac", "title": "Q8BERT: Quantized 8Bit BERT"}, {"paperId": "4fb8fd55b476909a26a8dc594e0ae98d4923ad4d", "title": "Q-BERT: Hessian Based Ultra Low Precision Quantization of BERT"}, {"paperId": "7edacd94dc1509803d9bbcc1d92fea780d71cb3e", "title": "MnnFast: A Fast and Scalable System Architecture for Memory-Augmented Neural Networks"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "2dfeb5a90abc49ab2a80a492a01a4e2c8e92ec22", "title": "In-datacenter performance analysis of a tensor processing unit"}, {"paperId": "ffdaa12ef011de9dbf43be46d45a3abcc8288965", "title": "Eyeriss: An Energy-Efficient Reconfigurable Accelerator for Deep Convolutional Neural Networks"}, {"paperId": "5d833331b0e22ff359db05c62a8bca18c4f04b68", "title": "One billion word benchmark for measuring progress in statistical language modeling"}, {"paperId": "2e2089ae76fe914706e6fa90081a79c8fe01611e", "title": "Practical Bayesian Optimization of Machine Learning Algorithms"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "3364bc50921a9566d61ef8cb73baa82341725e4b", "title": "CACTI 6.0: A Tool to Model Large Caches"}]}