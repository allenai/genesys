{"paperId": "32a6f4b74b911891a1d6547710b571485111c45f", "abstract": "The synergy of long-range dependencies from transformers and local representations of image content from convolutional neural networks (CNNs) has led to advanced architectures and increased performance for various medical image analysis tasks due to their complementary benefits. However, compared with CNNs, transformers require considerably more training data, due to a larger number of parameters and an absence of inductive bias. The need for increasingly large datasets continues to be problematic, particularly in the context of medical imaging, where both annotation efforts and data protection result in limited data availability. In this work, inspired by the human decision-making process of correlating new \"evidence\" with previously memorized \"experience\", we propose a Memorizing Vision Transformer (MoViT) to alleviate the need for large-scale datasets to successfully train and deploy transformer-based architectures. MoViT leverages an external memory structure to cache history attention snapshots during the training stage. To prevent overfitting, we incorporate an innovative memory update scheme, attention temporal moving average, to update the stored external memories with the historical moving average. For inference speedup, we design a prototypical attention learning method to distill the external memory into smaller representative subsets. We evaluate our method on a public histology image dataset and an in-house MRI dataset, demonstrating that MoViT applied to varied medical image analysis tasks, can outperform vanilla transformer models across varied data regimes, especially in cases where only a small amount of annotated data is available. More importantly, MoViT can reach a competitive performance of ViT with only 3.0% of the training data. In conclusion, MoViT provides a simple plug-in for transformer architectures which may contribute to reducing the training data needed to achieve acceptable models for a broad range of medical image analysis tasks.", "venue": "MLMI@MICCAI", "year": 2023, "citationCount": 3, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://arxiv.org/pdf/2303.15553", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "A Memorizing Vision Transformer (MoViT) is proposed to alleviate the need for large-scale datasets to successfully train and deploy transformer-based architectures, and provides a simple plug-in for transformer architectures which may contribute to reducing the training data needed to achieve acceptable models for a broad range of medical image analysis tasks."}, "embedding": {"model": "specter_v2", "vector": [0.45060673356056213, 0.7585198879241943, -0.4141528308391571, -0.05051254481077194, -0.5709308981895447, 0.4213090240955353, 0.5329557657241821, 0.07331705838441849, -0.30202940106391907, -0.4184437692165375, 0.3960270583629608, 0.012578047811985016, 0.05944154039025307, 0.2693975865840912, -0.046826109290122986, -0.26002514362335205, -1.2396906614303589, -0.13345156610012054, 0.5698913931846619, 0.4171699285507202, -0.10078320652246475, -0.43553322553634644, -0.7553918361663818, 0.06312257051467896, -0.07893457263708115, 1.190892219543457, 0.20620986819267273, 0.8762935996055603, 0.2057034820318222, 0.8706433176994324, 0.7266011834144592, -0.41192710399627686, 0.13020247220993042, 0.07247445732355118, -0.7901918888092041, 0.332464337348938, 0.7878192663192749, -0.46763333678245544, -0.8033808469772339, 0.8583948016166687, -0.11590617895126343, 0.24897731840610504, 0.5062605142593384, -0.42131248116493225, -0.4380660653114319, 0.36334580183029175, 0.6155599355697632, 1.3660390377044678, -0.8583875894546509, -0.2120518684387207, 1.056191325187683, -1.3287838697433472, 0.5980483889579773, 1.0860085487365723, 0.6023503541946411, 0.13050170242786407, 0.18485836684703827, -0.13549990952014923, 0.7425660490989685, 0.37756797671318054, -0.41866999864578247, -0.10257885605096817, 0.17556975781917572, -0.5412645936012268, 1.4401113986968994, -0.526957094669342, 0.42398691177368164, 0.3213086724281311, 0.7770520448684692, 1.659074306488037, -0.11629098653793335, -0.7217741012573242, -0.24785485863685608, 0.06708522886037827, 0.42749959230422974, 1.2392290830612183, -0.6026682257652283, -0.22823739051818848, -0.8432461023330688, 0.03460375964641571, 0.486037939786911, 0.14364515244960785, 0.052964579313993454, -0.1357729434967041, 0.024852439761161804, 0.26555630564689636, 0.9135265946388245, 0.7865259051322937, -0.5785078406333923, 0.48850753903388977, 0.39403659105300903, 0.3107506334781647, 0.1299024224281311, 0.1251998394727707, 0.38983845710754395, 1.0840638875961304, -0.8102688789367676, -0.47345197200775146, -0.720392107963562, 0.7888153195381165, -0.2785395681858063, 0.35986924171447754, -0.7868356704711914, 0.08210583031177521, 1.1804600954055786, -0.09300242364406586, 0.6950265169143677, -0.32211747765541077, -0.24525991082191467, -0.6831172108650208, -0.4314793050289154, -0.9826325178146362, -0.20300638675689697, -0.7850521206855774, -0.795072615146637, -1.135230302810669, -0.414532870054245, 0.9078497886657715, -1.1766226291656494, 0.36490046977996826, -0.5086368918418884, -0.09995405375957489, -0.4642164409160614, 0.1884838044643402, 0.4167841672897339, 0.019715499132871628, 0.5363099575042725, 0.08527025580406189, 1.0777355432510376, -0.7968396544456482, -0.44780558347702026, -0.9362915754318237, -0.18208326399326324, 0.19784502685070038, -0.056498151272535324, -0.10682937502861023, -1.4492710828781128, -1.0676980018615723, -0.8117939829826355, -0.020638013258576393, -0.40012872219085693, -0.231168732047081, 0.999873161315918, -0.14045417308807373, -1.2586766481399536, 0.9096997380256653, -0.3108963370323181, -0.08393971621990204, 0.9247700572013855, 0.0017726755468174815, 0.3672252893447876, -0.28938204050064087, -0.669614315032959, 0.363730251789093, -0.08805640041828156, -0.30621784925460815, -0.758885383605957, -0.726804256439209, -1.0638551712036133, 0.030248265713453293, 0.13196882605552673, -0.8091758489608765, 0.989063560962677, -0.527954638004303, -0.27497977018356323, 0.980705738067627, -0.2957613468170166, 0.0072823744267225266, 0.27060502767562866, -0.042788732796907425, -0.31951645016670227, 0.16186925768852234, -0.21668608486652374, 0.45009148120880127, 0.7003758549690247, -0.1688431352376938, 0.09316954016685486, -0.14490927755832672, -0.5192375183105469, -0.7572029232978821, -0.48096585273742676, 0.38002899289131165, -0.6297187209129333, -0.3485069274902344, 0.3278478980064392, 0.6430656313896179, -0.3276923596858978, 0.1423397660255432, -0.09189539402723312, -0.7266262173652649, 0.5169371366500854, -0.35350701212882996, 0.6989398002624512, -0.7296464443206787, -0.7425024509429932, 0.12280817329883575, 0.37855076789855957, -0.31538209319114685, -0.7410205006599426, -0.23158232867717743, -0.59828782081604, 0.13732895255088806, 0.0721440389752388, -0.7302104830741882, -0.6412136554718018, -0.23478718101978302, -0.5681331157684326, 0.10268177092075348, 0.31249380111694336, 1.4399230480194092, -1.170910358428955, -0.3812827467918396, 0.12774820625782013, 0.22085808217525482, -0.6595122218132019, 1.16462242603302, -0.03636763617396355, 0.19165942072868347, -0.3009062111377716, 0.30229640007019043, -0.016664251685142517, -0.7729641795158386, 0.7448493838310242, -1.0746679306030273, 0.045491959899663925, 0.24905069172382355, 0.46564391255378723, 0.9034606218338013, -0.1458745300769806, 0.8710137009620667, -0.25408679246902466, -1.119181513786316, 0.19828346371650696, 0.6122775077819824, 0.1892034113407135, -0.7883473038673401, 0.8691641688346863, -0.1497981697320938, -0.7578079700469971, -0.19339899718761444, 0.3007870316505432, 0.5918073058128357, 0.07571360468864441, -0.07641641050577164, 1.2582522630691528, -0.01912103034555912, -0.13049064576625824, 0.4093216061592102, 0.7796918153762817, -0.16817286610603333, 0.4844319224357605, -0.20445267856121063, 0.05569251626729965, -0.9982800483703613, 0.12929749488830566, 0.6328635215759277, 0.422831654548645, 0.9735694527626038, 0.34538084268569946, -1.026020884513855, -0.5066903233528137, -0.06618843972682953, 0.5200909972190857, 0.7845360636711121, -0.3474421501159668, 0.0850045457482338, -0.6232169270515442, -0.3331016004085541, -0.6500934958457947, -0.4585626721382141, -0.9088864326477051, -0.4280881881713867, -0.3401269018650055, -0.9999667406082153, 0.3923403322696686, 0.699840784072876, 1.1303372383117676, -0.7395021915435791, -0.3856578469276428, -0.2885216474533081, 0.15996786952018738, -0.5527993440628052, -0.3788720369338989, 0.39351847767829895, -0.9219346642494202, -0.2693445384502411, -0.4076167345046997, -0.14771899580955505, 0.6069315671920776, -0.4908183515071869, 1.0930379629135132, 0.04429959878325462, -0.8623786568641663, 1.0864814519882202, 1.0272854566574097, -0.8983519673347473, -0.2635444402694702, -0.11578318476676941, -0.38553890585899353, -0.05207043141126633, -0.07144703716039658, 0.16822421550750732, -0.4870692193508148, -0.010029461234807968, -0.4718051254749298, -0.17768777906894684, 0.45515361428260803, 0.4498681128025055, 1.010027527809143, -0.4807620346546173, 0.1508125215768814, -1.055732250213623, 0.4309071898460388, -0.28735774755477905, -0.2934281527996063, 0.5273255109786987, -0.7055943012237549, -0.3006817102432251, 0.22353540360927582, -0.6118128299713135, -0.14197029173374176, -0.9669451117515564, 0.37299486994743347, -0.6733320951461792, 0.23758795857429504, 0.27226918935775757, 0.5684958100318909, -0.10355863720178604, 0.23522168397903442, 0.1993464231491089, 0.37647613883018494, 0.3854670822620392, -0.021033700555562973, -1.1813480854034424, 0.9181973934173584, 0.35577192902565, 0.063021220266819, 0.2853989601135254, 0.08970575034618378, -0.7544152736663818, -0.9045931100845337, -0.5176148414611816, -0.5676527619361877, -0.96658855676651, 0.35336899757385254, -0.39446425437927246, -0.7458652257919312, 0.06107727438211441, -0.5244321227073669, -0.3591945171356201, 0.034729328006505966, -0.1873173713684082, -0.07107528299093246, -1.0775455236434937, -1.0251243114471436, -0.3976810574531555, -0.8833127021789551, -1.0490916967391968, -0.13964441418647766, 0.1983891874551773, -0.41714197397232056, -0.8913658857345581, -0.45178350806236267, -0.33504533767700195, 1.1550546884536743, -0.2617843449115753, 0.7978975176811218, 0.2414737045764923, -0.7172914147377014, -0.1131713017821312, 0.21543528139591217, 0.5783546566963196, -0.26689642667770386, -0.156953826546669, -1.2306839227676392, 0.14121253788471222, -0.09262194484472275, -0.19240185618400574, 0.3910070061683655, 0.701650083065033, 1.2636808156967163, 0.30496907234191895, -0.4386447072029114, -0.06275688856840134, 1.0954872369766235, -0.5452364087104797, 0.3110881447792053, 0.25756514072418213, 0.5259384512901306, 0.10683862119913101, -0.06661095470190048, 0.4322052597999573, 0.2483881711959839, -0.07565770298242569, 0.4540344178676605, -0.45903098583221436, -0.6411608457565308, -0.4598369002342224, -0.146036297082901, 1.3045519590377808, -0.07445231080055237, 0.3032214641571045, -0.8277555704116821, 1.1003104448318481, -0.9312857985496521, -0.6706953048706055, 0.8917474150657654, 0.6806979775428772, 0.03385574370622635, -0.35003581643104553, -0.6019627451896667, -0.38600870966911316, 0.2383980005979538, 0.2199401557445526, -0.5952207446098328, 0.0019009234383702278, 0.12584292888641357, 0.8056115508079529, 0.5178408026695251, 0.48139750957489014, -0.41080042719841003, -0.0995059460401535, 14.881299018859863, 0.4074819087982178, -0.24005194008350372, 0.8156177401542664, 0.9745665788650513, 0.5800369381904602, -0.4302607476711273, -0.08342977613210678, -0.680463969707489, -0.4229310154914856, 0.7421980500221252, 0.4525133967399597, 0.20598119497299194, 0.25124916434288025, -0.29691505432128906, -0.03989619389176369, -0.33815309405326843, 0.683486819267273, 0.8530997037887573, -1.3381890058517456, 0.5265495777130127, -0.07085534930229187, 0.1952166110277176, 0.5331111550331116, 1.2502729892730713, 0.24850431084632874, 0.04394901916384697, -0.24831099808216095, 0.6440529823303223, 0.6679849624633789, 0.7963874340057373, 0.3200210630893707, 0.5619591474533081, -0.28877636790275574, -1.1939054727554321, -0.3242356479167938, -0.5388031601905823, -0.28321343660354614, 0.06185827776789665, 0.18497715890407562, -0.7318458557128906, -0.21979695558547974, 0.3946801424026489, 0.7040324807167053, -0.6521116495132446, 0.43770986795425415, -0.16309373080730438, 0.635574460029602, 0.6642554998397827, 0.4975571632385254, 0.2384587973356247, 0.9884554743766785, -0.047212742269039154, -0.13527053594589233, -0.10021853446960449, 0.026510436087846756, 0.13330982625484467, 0.12970395386219025, -0.40196311473846436, -0.43029117584228516, -0.41454705595970154, 0.06693793833255768, -0.28236398100852966, 1.1003090143203735, -0.1053319126367569, -0.03564741089940071, -0.2174595594406128, -0.18078725039958954, 0.4028078019618988, -0.09269576519727707, 0.04393920302391052, 0.1418418288230896, -0.1795063018798828, -0.13218384981155396, 0.06844642013311386, 0.5220360159873962, -0.047748465090990067, -0.4456023871898651, -0.7271299362182617, 0.012864617630839348, 0.9274753332138062, -1.0947153568267822, -0.7694535851478577, 1.2736483812332153, -0.2781182527542114, -0.5170149803161621, 0.5191563963890076, -1.0553756952285767, -0.26909592747688293, 0.1882254183292389, -1.5253840684890747, -0.8120920658111572, -0.48979097604751587, 0.13606809079647064, -0.330424964427948, -0.0726458728313446, 0.8059417009353638, 0.14115460216999054, 0.2074149250984192, 0.1016734391450882, -0.6829171776771545, 0.04986404627561569, 0.21747294068336487, -0.6048800349235535, 0.17081871628761292, 0.3229095935821533, -0.17239652574062347, 0.3966585695743561, 0.016650347039103508, 0.1264004111289978, -0.6810821890830994, 0.01894197054207325, 0.15449512004852295, -0.8234336972236633, -0.24431359767913818, -0.16490453481674194, -1.159168004989624, 0.7303402423858643, 0.5988466143608093, 0.28746721148490906, 0.34311750531196594, 0.08511489629745483, -0.2281426042318344, -0.3404255211353302, -0.9807592630386353, -0.22043131291866302, 0.28403952717781067, -0.8963214159011841, -0.3900725245475769, -0.3363798260688782, -0.015225042589008808, -0.9358502626419067, -0.9185737371444702, -0.24252717196941376, 0.40970635414123535, -0.08648831397294998, 1.1383752822875977, -0.3480197787284851, 0.4357176423072815, 0.866019070148468, 0.25844669342041016, -0.8640915155410767, -0.39731544256210327, -0.37027257680892944, 0.38198092579841614, 0.14128167927265167, 0.36779338121414185, -0.49596506357192993, -0.06893333047628403, 1.021602988243103, -0.018927017226815224, -0.3809245526790619, -0.47347351908683777, 0.13949431478977203, -0.09292304515838623, -0.4351411461830139, -0.16863515973091125, 0.03951228782534599, -0.17757074534893036, -0.0737404152750969, 0.3063756823539734, 0.7237603068351746, 0.11377115547657013, -0.5007199048995972, -0.03406849503517151, -0.2964797914028168, 0.056097377091646194, -0.32653504610061646, -0.7975170612335205, -0.8684563636779785, -0.3503614366054535, -1.5404632091522217, -0.11905989795923233, -0.6860045790672302, 0.08704739809036255, 0.14967747032642365, -0.8068462610244751, 0.2073349952697754, 0.15206415951251984, -0.07618176192045212, -0.6630868911743164, -0.6095896363258362, -0.7726892232894897, 0.4798693358898163, 1.3179121017456055, -1.1536273956298828, 0.47463223338127136, -0.3504404127597809, -0.07175783812999725, 0.5605114102363586, 0.24121998250484467, -0.2740435004234314, -0.9425181746482849, -1.1048064231872559, 0.12656691670417786, -0.22326631844043732, 0.3174555003643036, -0.8017637729644775, 1.0590723752975464, 0.6711481213569641, 0.5316893458366394, -0.15909035503864288, 0.3216720223426819, -1.006717324256897, -0.29656216502189636, 0.4654145836830139, -0.6823443174362183, 0.18676653504371643, 0.34824877977371216, -0.6032509207725525, -0.2903640568256378, 0.5826873183250427, 0.4177049398422241, -1.4467558860778809, -0.8988249897956848, 0.8289817571640015, -0.5869525074958801, 0.009123677387833595, -0.4330672323703766, 0.16405197978019714, -1.0312819480895996, -0.34850022196769714, -0.5824481248855591, 0.5341521501541138, -0.8354443907737732, 0.7478587031364441, 0.9233629107475281, -1.0661357641220093, 0.5073454976081848, 0.3305998742580414, -0.1965055614709854, -0.10417452454566956, 1.1084444522857666, 0.8882505893707275, 0.1253548562526703, 0.25600841641426086, -0.31278112530708313, 0.14860615134239197, -1.1007050275802612, 0.29459208250045776, 1.0495613813400269, -0.5703564286231995, -0.31100529432296753, 0.9383552670478821, 0.08170938491821289, -0.6589041352272034, 0.1609194278717041, -1.0866930484771729, -0.7679408192634583, -0.04412458464503288, 0.8114237785339355, 0.008435689844191074, 0.2971988916397095, 0.4530882239341736, -0.531362771987915, 0.29302483797073364, -0.4037872850894928, -0.3620753288269043, 0.8649041056632996, -0.06382695585489273, -0.19968438148498535, 0.6098442077636719, 0.3857915997505188, -1.0700682401657104, -0.7150940895080566, -1.1705174446105957, -0.2848514914512634, -0.22189176082611084, 0.5117208957672119, -0.14731965959072113, -1.2490406036376953, 0.935077428817749, 1.0664516687393188, 0.06892301142215729, 0.4964717626571655, 0.2586727440357208, -0.10532081127166748, 0.5367407202720642, 0.09198920428752899, -0.5987362265586853, 0.07609368860721588, 0.5433109998703003, 1.279701828956604, -0.7286790013313293, 0.5634212493896484, -0.04519212990999222, -0.5941431522369385, 1.0911365747451782, 0.23141679167747498, -0.04196242243051529, 1.0959126949310303, -0.23019228875637054, 0.034885723143815994, -0.584819495677948, -0.9787505269050598, 0.01767917163670063, 1.1718186140060425, 1.2440353631973267, 0.6675466895103455, 0.16396822035312653, 0.7220377326011658, 0.6398370862007141, 0.5797103047370911, 0.49022263288497925, 0.46202102303504944, 0.4115006923675537, -0.128061905503273, 0.2835526764392853, 0.12045704573392868, 0.8446404933929443, -0.8059234023094177, -0.3183153569698334, 0.4428691565990448, 0.6432480216026306, 0.07384933531284332, 0.19255658984184265, 1.229050636291504, 0.3436185121536255, 0.5257635712623596, -0.02162627875804901, 0.8126161098480225, -0.20245924592018127, -0.1520540863275528, -0.18154874444007874, -0.8159007430076599, 0.012398628517985344, -0.6861879825592041, -0.7868540287017822, -0.12313131988048553, 0.1510523408651352, 0.3687470853328705, -0.10480101406574249, -0.030054887756705284, 1.0020415782928467, 0.364439457654953, 1.1079050302505493, -0.2521011233329773, -0.2911936044692993, 0.021489858627319336, -0.83412104845047, 0.22082245349884033, -0.6057513952255249, 0.14717215299606323, -0.7624379396438599, -0.017476538196206093, 0.14512908458709717]}, "authors": [{"authorId": "1690594", "name": "Yiqing Shen"}, {"authorId": "1742263224", "name": "Pengfei Guo"}, {"authorId": "2109160963", "name": "Jinpu Wu"}, {"authorId": "2116067061", "name": "Qi Huang"}, {"authorId": "39383499", "name": "Jinyuan Zhou"}, {"authorId": "47536778", "name": "Shanshan Jiang"}, {"authorId": "3197182", "name": "M. Unberath"}], "references": [{"paperId": "e983cdf156d932819a032837a9e11c8ee38566d6", "title": "ProtoPFormer: Concentrating on Prototypical Parts in Vision Transformers for Interpretable Image Recognition"}, {"paperId": "1c4bb34ce2cb43d0fc456a5e6e810aa0ca687340", "title": "Learning-based analysis of amide proton transfer-weighted MRI to identify true progression in glioma patients"}, {"paperId": "0e802c0739771acf70e60d59c2df51cd7e8c50c0", "title": "Memorizing Transformers"}, {"paperId": "85e2771568fbec41a30d2040dc3e0025838eb35d", "title": "Scopeformer: n-CNN-ViT Hybrid Model for Intracranial Hemorrhage Classification"}, {"paperId": "2d98048c2d2fcd3f6b989d2a54003808906ab4b7", "title": "Efficient Training of Visual Transformers with Small Datasets"}, {"paperId": "5b68522f58b61e7235b852677337ef3725075fd9", "title": "Co-Scale Conv-Attentional Image Transformers"}, {"paperId": "14c52ffa7ea9c1971d5d82ea369c946c98d056a9", "title": "LocalViT: Bringing Locality to Vision Transformers"}, {"paperId": "e775e649d815a02373eac840cf5e33a04ff85c95", "title": "CvT: Introducing Convolutions to Vision Transformers"}, {"paperId": "2984ab83ade26639c3a82d29628d0d9e4abbebb0", "title": "Incorporating Convolution Designs into Visual Transformers"}, {"paperId": "f5b4d3131fd07681e4c039d409a450e18e30f36c", "title": "Multi-view analysis of unregistered medical images using cross-view transformers"}, {"paperId": "ad7ddcc14984caae308c397f1a589aae75d4ab71", "title": "Training data-efficient image transformers & distillation through attention"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "d19430920a536394162440c9db5d741355591484", "title": "Cross-Batch Memory for Embedding Learning"}, {"paperId": "7be8c119dbe065c52125ee7716601751f3116844", "title": "Generalization through Memorization: Nearest Neighbor Language Models"}, {"paperId": "8760bc7631c0cb04e7138254e9fd6451b7def8ca", "title": "Revisiting Unreasonable Effectiveness of Data in Deep Learning Era"}, {"paperId": "1342c1e1684620c019972e2679d5131f1e8a4a13", "title": "Weight-averaged consistency targets improve semi-supervised deep learning results"}, {"paperId": "d2e4587744a89bad95fea69e08842cad6c8ff0dd", "title": "Temporal Ensembling for Semi-Supervised Learning"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "e74f9b7f8eec6ba4704c206b93bc8079af3da4bd", "title": "ImageNet Large Scale Visual Recognition Challenge"}, {"paperId": null, "title": "100,000 histological images of human colorectal cancer and healthy tissue"}, {"paperId": "4f8549f0859330fd6e46f7579efc19652e5e09ae", "title": "Examples are not enough, learn to criticize! Criticism for Interpretability"}]}