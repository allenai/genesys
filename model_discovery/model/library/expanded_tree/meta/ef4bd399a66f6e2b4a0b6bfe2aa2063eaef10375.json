{"paperId": "ef4bd399a66f6e2b4a0b6bfe2aa2063eaef10375", "abstract": "NeurAlly-Decomposed Oracle (NADO) is a powerful approach for controllable generation with large language models. It is designed to avoid catastrophic forgetting while achieving guaranteed convergence to an entropy-maximized closed-form optimal solution with reasonable modeling capacity. Despite the success, several challenges arise when apply NADO to a wide range of scenarios. Vanilla NADO suffers from gradient vanishing for low-probability control signals and is highly reliant on a regularization to satisfy the stochastic version of Bellman equation. In addition, the vanilla implementation of NADO introduces a few additional transformer layers, suffering from a limited capacity especially compared to other finetune-based model adaptation methods like LoRA. In this paper, we propose a improved version of the NADO algorithm, namely DiNADO (norm-Disentangled NeurAlly-Decomposed Oracles), which improves the performance of the NADO algorithm through disentangling the step-wise global norm over the approximated oracle $R$-value for all potential next-tokens, allowing DiNADO to be combined with finetuning methods like LoRA. We discuss in depth how DiNADO achieves better capacity, stability and flexibility with both empirical and theoretical results. Experiments on formality control in machine translation and the lexically constrained generation task CommonGen demonstrates the significance of the improvements.", "venue": "", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Improved version of the NADO algorithm, namely DiNADO (norm-Disentangled NeurAlly-Decomposed Oracles), which improves the performance of the NADO algorithm through disentangling the step-wise global norm over the approximated oracle $R$-value for all potential next-tokens, allowing DiNADO to be combined with finetuning methods like LoRA."}, "embedding": {"model": "specter_v2", "vector": [0.11322608590126038, 0.7506231069564819, -0.6363418698310852, 0.28479069471359253, -0.2751915156841278, -0.40713879466056824, 0.5585682988166809, -0.23646101355552673, -0.4787604510784149, 0.17038019001483917, 0.284812331199646, 0.03420541062951088, 0.19915363192558289, 0.01113178487867117, -0.4141204059123993, 0.05506077781319618, -0.6557624936103821, 0.5670852065086365, -0.35092392563819885, -0.2538301646709442, -0.4780158996582031, -0.7827223539352417, -0.637403666973114, -0.22061310708522797, 0.3881484568119049, 0.37230661511421204, 0.13945592939853668, 1.1268888711929321, -0.17336231470108032, 0.2136431783437729, 0.5098772644996643, -0.3211685121059418, 0.41607731580734253, -0.36694031953811646, 0.059350792318582535, -0.041452545672655106, -0.26776719093322754, -0.6154856085777283, -0.435747355222702, 1.0841854810714722, -0.2207794040441513, -0.03273860737681389, 0.595996081829071, -0.47581762075424194, -0.7945308685302734, 0.8704803586006165, 0.873523473739624, 0.7977176308631897, -0.19427607953548431, -0.11991313099861145, 1.2985873222351074, -1.2559008598327637, 0.4796615242958069, 1.526259422302246, 0.11661732941865921, 0.89173823595047, -0.6242672801017761, -0.5225957036018372, 0.7462745308876038, -0.1258396953344345, -1.0170544385910034, -0.2833598554134369, -0.21529972553253174, -0.018119441345334053, 1.526077389717102, -0.5179792046546936, 0.11604225635528564, 0.6411178708076477, 0.12013927102088928, 1.3893344402313232, -0.1367519199848175, -1.0186080932617188, -0.09750980883836746, 0.38819292187690735, -0.3075372576713562, 1.053999423980713, 0.01085830107331276, 0.5566415190696716, -0.7733200788497925, 0.17952576279640198, 0.4402155578136444, -0.40198051929473877, -0.08076687902212143, -0.41818252205848694, -0.3650166988372803, 0.7199029326438904, 0.01176285557448864, 0.6260352730751038, -0.13053180277347565, 0.809680700302124, 0.4765646457672119, 0.35909953713417053, 0.13202877342700958, 0.6271060109138489, -0.26712965965270996, 0.18096952140331268, -0.7846862077713013, 0.37405863404273987, 0.13655361533164978, 0.5957889556884766, -0.1508360058069229, 0.6947007775306702, -0.8437764644622803, 0.12210922688245773, 1.3512024879455566, 0.09154701977968216, 0.7560064196586609, -0.6645174026489258, 0.20252133905887604, -0.7246944308280945, 0.19566881656646729, -0.6556524038314819, 0.055508747696876526, -0.19333486258983612, -0.9165318012237549, -1.1714822053909302, -0.6179798245429993, 0.0300294142216444, -0.9233142733573914, 1.128152847290039, -0.3118191659450531, 0.023349735885858536, -0.06945060193538666, 0.6414335370063782, -0.27663934230804443, 0.575548529624939, -0.256136953830719, -0.04055395349860191, 0.5279026627540588, -0.6246111392974854, -0.9605398178100586, -1.1138534545898438, 0.2122836858034134, 0.1470494121313095, 0.12123817205429077, -0.05878672003746033, -1.2905197143554688, -0.6994070410728455, -1.1900533437728882, 0.262350469827652, -0.38776323199272156, 0.2260238230228424, 1.110832691192627, 0.5367114543914795, -0.63519287109375, 0.5982094407081604, -0.5193973779678345, 0.1225949376821518, 0.495942622423172, 0.3976759612560272, 0.22596484422683716, -0.2471676766872406, -1.266234278678894, 0.4385887086391449, 0.6464304327964783, -0.32804208993911743, -0.57879638671875, -0.5380764603614807, -1.0462249517440796, 0.009540748782455921, 0.46170854568481445, -0.8096687197685242, 1.220813512802124, 0.19415025413036346, -1.5785095691680908, 0.08471590280532837, -0.2883259654045105, 0.006809131242334843, 0.4683103561401367, -0.1323540210723877, -0.4005303680896759, -0.3532215356826782, 0.009118237532675266, 0.2552432417869568, 0.5129576921463013, -0.3391161561012268, 0.12951284646987915, 0.23706620931625366, -0.48602667450904846, -0.2958891689777374, 0.05544177070260048, 0.32751646637916565, -0.28960120677948, -0.26051902770996094, 0.1843198537826538, 0.7266635894775391, -0.009538205340504646, -0.37080568075180054, -0.6670430898666382, -0.9852437973022461, 0.3053031265735626, 0.007504205219447613, 1.0142931938171387, -0.6798253059387207, -0.17290616035461426, -0.19240914285182953, 0.12719711661338806, -0.18925240635871887, -0.6683420538902283, 0.35199233889579773, -0.3675355911254883, 0.8765203356742859, -0.08045077323913574, -1.0681427717208862, 0.4776231646537781, -0.05350405350327492, -0.3970988094806671, -0.19723141193389893, 0.6531820297241211, 1.1726653575897217, -1.055214285850525, 0.17053134739398956, 0.05534045025706291, 0.13817115128040314, -1.2369098663330078, 1.1285096406936646, -0.4187789559364319, 0.27716416120529175, -0.28408241271972656, -0.13286258280277252, -0.03035007044672966, 0.10909377038478851, 0.3788871467113495, 0.16087107360363007, 0.1529097706079483, 0.43217891454696655, -0.7841992378234863, 1.3239045143127441, -0.44658663868904114, 0.7460702061653137, -0.2977695167064667, -0.4551314413547516, 0.1911529302597046, 0.4080056846141815, -0.2965088188648224, -0.2764732539653778, 0.4182501435279846, 0.5027827620506287, -0.4496006667613983, 0.3351089358329773, 0.5160782337188721, 0.08877906948328018, -0.6190230250358582, 0.134302020072937, 1.1080923080444336, -0.6504838466644287, 0.9512816071510315, 0.23979748785495758, 0.5294555425643921, 0.44694432616233826, 0.7816566824913025, 0.23360000550746918, 0.2480953335762024, -0.929025411605835, 0.24508309364318848, 0.5609577298164368, 0.6025095582008362, 1.0948597192764282, 0.48303890228271484, -0.5386902093887329, -0.42478272318840027, -0.38649290800094604, 0.6406448483467102, 0.9200406670570374, -0.4081329107284546, -0.2636466920375824, -0.7849560976028442, 0.02468332275748253, -0.44350093603134155, 0.33432191610336304, -0.3319433927536011, -0.37558504939079285, -0.29513129591941833, -1.0312222242355347, 0.9764352440834045, 0.10609634965658188, 0.8453844785690308, -0.3091179132461548, 0.25993677973747253, 0.003357531735673547, 0.23963375389575958, -0.6811658143997192, -0.9030379056930542, 0.3259945809841156, -0.034179721027612686, -0.03144199028611183, 0.233159601688385, 0.08692757785320282, -0.0898314043879509, -1.2684917449951172, 0.7199468612670898, -0.8019428849220276, -0.2606109082698822, -0.01528269611299038, 0.8768348097801208, -0.816500723361969, -0.8727772235870361, 0.28960326313972473, 0.487850546836853, 0.15309397876262665, 0.16481435298919678, 0.3717694580554962, 0.32055675983428955, -0.21373677253723145, -0.40861546993255615, 0.00026159072876907885, -0.13586905598640442, 0.5387920141220093, 0.6631873250007629, -0.3174361288547516, -0.1402117758989334, -0.8618857860565186, 1.064858317375183, 0.2624995708465576, -0.7609867453575134, -0.04869643226265907, -0.8680776357650757, 0.13064232468605042, 0.44703808426856995, -0.7277601361274719, -0.2648889124393463, -1.157965064048767, 0.5085199475288391, -0.43625378608703613, -0.25469642877578735, 0.13384981453418732, 0.15234650671482086, 0.6682366728782654, 0.23128359019756317, 0.47811296582221985, -0.007180719170719385, 0.02849465049803257, 0.6574122905731201, -1.0051707029342651, 0.4400486350059509, -0.15483877062797546, 0.480393648147583, -0.3525182008743286, -0.4125376343727112, -0.28731459379196167, -0.30489063262939453, -0.09004731476306915, -0.22208823263645172, -0.2976434528827667, 0.5178271532058716, -0.6899160742759705, -0.9523385763168335, -0.21011531352996826, -1.2615283727645874, -0.10713036358356476, -0.27292561531066895, -0.07061191648244858, -0.24465394020080566, -1.4091955423355103, -1.1410340070724487, -0.710612416267395, -0.14056579768657684, -1.0259701013565063, 0.18079884350299835, 0.05070730298757553, -0.3736065626144409, -0.5692799687385559, 0.5369763374328613, -0.4789671003818512, 0.7655745148658752, -0.44213593006134033, 0.9513561129570007, -0.006121176760643721, -0.4635795056819916, -0.2452976405620575, 0.45140624046325684, 1.0306414365768433, -0.27991893887519836, 0.14529119431972504, -0.7297830581665039, 0.25984224677085876, -0.4729541540145874, -0.4278765320777893, -0.0164059866219759, 0.23281444609165192, 0.10744989663362503, -0.27981075644493103, -0.24913901090621948, 0.5486944317817688, 1.554105520248413, -0.4997241497039795, -0.10958629846572876, 0.2566886246204376, 0.9770122766494751, 0.057687148451805115, -0.7073028683662415, 0.5008488893508911, 0.37584999203681946, 0.3080747425556183, 0.10056423395872116, 0.2654825747013092, -0.024216623976826668, -1.115910291671753, 0.4700041711330414, 1.9147535562515259, 0.12218175828456879, -0.28397104144096375, -0.800822913646698, 0.6613119840621948, -1.1566168069839478, -0.7272365093231201, 0.8423384428024292, 0.5379796028137207, 0.26116836071014404, -0.24261708557605743, -0.90928715467453, -0.05809539556503296, 0.3954198956489563, 0.41477805376052856, -0.4518004357814789, -0.9309841394424438, -0.15146289765834808, 0.34680983424186707, 0.11410943418741226, 0.8122175931930542, -0.0003036555426660925, 0.5337558388710022, 14.972610473632812, 0.7618390917778015, 0.29622384905815125, 0.9776792526245117, 0.5713294148445129, -0.02523176185786724, -0.44570234417915344, -0.013981995172798634, -1.0231258869171143, -0.34154659509658813, 0.8939961194992065, 0.20993678271770477, 0.898954451084137, 0.10920224338769913, 0.08984027057886124, 0.3715575635433197, -0.6998172402381897, 0.6019460558891296, 0.475105345249176, -1.4238003492355347, 0.6237058043479919, 0.28348132967948914, 0.8775734901428223, 0.6031894087791443, 0.7140470147132874, 0.8685247302055359, 0.5301225781440735, -0.36110854148864746, 0.8933751583099365, 0.3230569064617157, 0.9628527760505676, -0.25840967893600464, 0.26215916872024536, 0.5472278594970703, -0.6521651148796082, -0.14391721785068512, -0.46187344193458557, -1.291384220123291, 0.1465643346309662, 0.16402548551559448, -0.49741655588150024, -0.5113290548324585, -0.3565687835216522, 0.5924270153045654, 0.6358339190483093, -0.27681732177734375, -0.4414479434490204, 0.5507419109344482, -0.15428097546100616, 0.14217668771743774, 0.2776423990726471, 0.19847531616687775, 0.4453611671924591, -0.3758484721183777, 0.046927787363529205, -0.24483908712863922, 0.03533579409122467, 1.1774396896362305, -0.9140879511833191, -0.4544543921947479, -0.17631006240844727, -0.35925909876823425, -0.11508623510599136, 0.4465709328651428, 0.5891616940498352, 0.46466970443725586, -0.15885986387729645, 0.483606219291687, 0.6371518969535828, 0.31718453764915466, -0.15211574733257294, -0.18550099432468414, 0.5370225310325623, -0.4672960937023163, 0.1715736985206604, 0.3210529088973999, -0.031591009348630905, -0.9686169028282166, -0.5296055674552917, -0.45349329710006714, -0.1564786434173584, -0.7296650409698486, -0.6870173215866089, 0.86854487657547, -0.21283407509326935, -0.10118776559829712, -0.13666893541812897, -0.8101151585578918, -0.12008649110794067, 0.36248984932899475, -1.1327953338623047, -0.3437454402446747, 0.9111652374267578, -0.40727007389068604, -0.2533459961414337, -0.2421327531337738, 1.3968349695205688, 0.0038701524026691914, -0.6731429100036621, 0.10114247351884842, 0.2784806191921234, 0.1551780104637146, -0.4863351583480835, -1.0716828107833862, 0.8071313500404358, 0.5845671892166138, 0.12191525101661682, 0.20848846435546875, 0.08744309842586517, 0.3478783071041107, -0.5890678763389587, 0.3130996823310852, 0.826939582824707, -1.1131045818328857, -0.290183424949646, -1.125542163848877, -0.12828439474105835, 0.33843886852264404, 0.49512261152267456, -0.07302858680486679, 0.2258611023426056, -0.1750127226114273, -0.39878788590431213, -0.04781446233391762, -0.6474674344062805, 0.07886185497045517, 0.2551727890968323, -0.7151731848716736, -0.4645930230617523, -0.31402772665023804, 0.2914506494998932, -1.017508864402771, -0.1644018143415451, -0.594103217124939, -0.019879275932908058, -0.21563485264778137, 0.80120450258255, -0.4980294108390808, 0.45603570342063904, 0.4909925162792206, -0.03119007870554924, -1.1490498781204224, -0.15849237143993378, -1.1989469528198242, -0.009343067184090614, 0.3868178427219391, 0.8494845032691956, -0.4218483567237854, -0.18466444313526154, 0.6215377449989319, 0.3631371855735779, -0.2695298492908478, -0.9285069704055786, -0.2552608549594879, 0.15916894376277924, -0.9701599478721619, 0.4614563286304474, -0.2726200819015503, -0.22214742004871368, 0.4204612374305725, 0.186763733625412, 0.8719876408576965, -0.40899303555488586, -1.168432593345642, 0.07766065746545792, 0.3916638493537903, -0.18735787272453308, -0.4095332622528076, -0.6868748068809509, -1.4308427572250366, -0.00574199203401804, -1.3262768983840942, 0.05022890120744705, -0.8660404682159424, -0.4833766222000122, 0.4347623884677887, -0.3036842346191406, -0.13075964152812958, 0.5841596126556396, -0.08619201928377151, -0.04762222617864609, -0.6457943320274353, -0.365744024515152, 1.1524475812911987, 1.0190815925598145, -1.1895790100097656, 0.045372914522886276, -0.18804368376731873, -0.03311151638627052, 0.36800095438957214, 0.31271058320999146, -0.7918938994407654, -0.676952064037323, -1.3500860929489136, 0.4460577964782715, -0.223399356007576, -0.002949741203337908, -0.7115316390991211, 0.5601926445960999, 0.47988298535346985, -0.10434874147176743, 0.3233582377433777, 0.17360621690750122, -0.5014509558677673, -0.5307847261428833, 0.36687758564949036, -0.6886049509048462, 0.10683471709489822, -0.03864436224102974, -0.24418053030967712, -0.6007734537124634, 0.6784006953239441, -0.2427496612071991, -1.1088474988937378, -0.16314198076725006, 0.4988531768321991, -1.0050194263458252, 0.4875276982784271, -0.553061842918396, -0.16283564269542694, -0.30274781584739685, -0.354640930891037, -0.23649311065673828, 0.297788143157959, -0.7009648084640503, 0.9528787136077881, 0.48978936672210693, -1.226919174194336, -0.012682802975177765, 0.584515392780304, -0.06679995357990265, 0.2985745072364807, 0.04342649132013321, 0.057325225323438644, -0.3714960217475891, 0.7228049039840698, 0.5497907996177673, 0.39525657892227173, -0.08753905445337296, -0.07675183564424515, 0.9239276647567749, -0.9439401030540466, 0.04650595784187317, 1.1376582384109497, -0.3989406228065491, -1.5174061059951782, -0.1540248543024063, -1.3555601835250854, 0.10919129103422165, -0.6238684058189392, 0.518242597579956, 0.12649886310100555, -0.3675222098827362, 0.22369524836540222, -0.5020571947097778, 0.21315014362335205, -0.025146430358290672, -0.703807532787323, 0.5520745515823364, -0.4069981873035431, -0.5217233896255493, 0.830722987651825, 0.6613253355026245, -0.6812446713447571, -0.8353975415229797, -0.3671407401561737, -0.41492921113967896, -0.02899113856256008, 0.35515859723091125, -0.36315518617630005, -0.4839910864830017, 0.6725693345069885, 0.5451794266700745, 0.24466970562934875, -0.07540261000394821, -0.33367615938186646, -0.07876071333885193, 0.5572522282600403, 0.22868742048740387, -0.6964271068572998, -0.4991903603076935, 1.152372121810913, 0.9373652338981628, -0.6785997748374939, 0.004005868919193745, 0.19303032755851746, -0.612854540348053, 0.9030375480651855, 0.22976762056350708, -0.1843816637992859, 0.7365212440490723, -0.146445631980896, 0.12061759829521179, 0.42079177498817444, -1.1716907024383545, -0.25235414505004883, 0.7844918966293335, 1.1879377365112305, 0.2892611622810364, 0.411731094121933, 0.24293102324008942, 1.068155288696289, 0.04523312672972679, 0.17528659105300903, 0.6353343725204468, 0.1747055947780609, 0.21704939007759094, -0.23603907227516174, -0.07071859389543533, 0.5618579387664795, -0.66483473777771, -0.7312413454055786, 0.3424621522426605, 0.7478545904159546, 0.6122965812683105, 0.6951329112052917, 0.6662272810935974, 0.17289035022258759, 0.5437301993370056, 0.19802658259868622, 0.6488562226295471, -0.7286382913589478, 0.10186387598514557, 0.0019758364651352167, -0.6456697583198547, -0.15469661355018616, -0.05955914035439491, -0.23875878751277924, -0.2534111738204956, -0.27156123518943787, -0.09486265480518341, -0.048393893986940384, 0.3059799075126648, 1.3258224725723267, 0.27520984411239624, 0.688941478729248, -0.11767344921827316, -0.6596619486808777, -0.40810781717300415, -0.9042317867279053, -0.07721357047557831, -0.7487204670906067, 0.13913293182849884, -0.27124685049057007, -0.3884637951850891, -0.3293801546096802]}, "authors": [{"authorId": "2167235968", "name": "Sidi Lu"}, {"authorId": "1902008743", "name": "Wenbo Zhao"}, {"authorId": "46387857", "name": "Chenyang Tao"}, {"authorId": "32174480", "name": "Arpit Gupta"}, {"authorId": "48914934", "name": "Shan Wu"}, {"authorId": "2878984", "name": "Tagyoung Chung"}, {"authorId": "3157053", "name": "Nanyun Peng"}], "references": [{"paperId": "c4fb74b5f69e5c0f3822b82e1bd082d5d95fc8d0", "title": "Tractable Control for Autoregressive Language Generation"}, {"paperId": "163b4d6a79a5b19af88b8585456363340d9efd04", "title": "GPT-4 Technical Report"}, {"paperId": "12daedd80a4f860960c5b50314d09d6827f4fd4a", "title": "Controllable Text Generation with Neurally-Decomposed Oracle"}, {"paperId": "a8ca46b171467ceb2d7652fbfb67fe701ad86092", "title": "LoRA: Low-Rank Adaptation of Large Language Models"}, {"paperId": "02f033482b8045c687316ef81ba7aaae9f0a2e1c", "title": "DExperts: Decoding-Time Controlled Text Generation with Experts and Anti-Experts"}, {"paperId": "ffdbd7f0b03b85747b001b4734d5ee31b5229aa4", "title": "The Power of Scale for Parameter-Efficient Prompt Tuning"}, {"paperId": "b6c4a96e09b9f11e7c70e7f1fbe3f3971b92762d", "title": "FUDGE: Controlled Text Generation With Future Discriminators"}, {"paperId": "a2b12e3b0440d2d00550adf7620a23b01af84193", "title": "Plug-and-Blend: A Framework for Plug-and-Play Controllable Story Generation with Sketches"}, {"paperId": "2c5bf29079cd958a2bef150077a02a1deb300652", "title": "NeuroLogic Decoding: (Un)supervised Neural Text Generation with Predicate Logic Constraints"}, {"paperId": "07bcda1dff9bb696ea9cbc69303eee8bd3d85bd6", "title": "GeDi: Generative Discriminator Guided Sequence Generation"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "0119a57cf88ef16e6dc291252fae340bb6b3953c", "title": "CommonGen: A Constrained Text Generation Challenge for Generative Commonsense Reasoning"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "e04a80263d252a3d8a382ba37a249b9345620570", "title": "Plug and Play Language Models: A Simple Approach to Controlled Text Generation"}, {"paperId": "75acc731bdd2b626edc74672a30da3bc51010ae8", "title": "CTRL: A Conditional Transformer Language Model for Controllable Generation"}, {"paperId": "d0acc36ce3bc3ff2bff7547252da27b28c75a51c", "title": "Fluent Translations from Disfluent Speech in End-to-End Speech Translation"}, {"paperId": "086fa2fe3ee2a5b805aeaf9fbfe59ee8157dad5c", "title": "Guided Open Vocabulary Image Captioning with Constrained Beam Search"}, {"paperId": "8aa98fbfb6f1e979dead13ce24075503fe47658e", "title": "A Survey for In-context Learning"}, {"paperId": "53d8b356551a2361020a948f64454a6d599af69f", "title": "Prefix-Tuning: Optimizing Continuous Prompts for Generation"}, {"paperId": null, "title": "Autoprompt: Elicit-ing knowledge from language models with automatically generated prompts"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "506d59d35f51796c8c3809da68e71a21238e8c67", "title": "Improved speech-to-text translation with the Fisher and Callhome Spanish-English speech translation corpus"}, {"paperId": null, "title": "2021a. Neurologic a* esque decoding: Constrained text generation with looka-head heuristics"}, {"paperId": null, "title": "2022. A survey of controllable text generation using transformer-based pre-trained language models"}, {"paperId": null, "title": "2022. Scaling instruction-finetuned language models"}]}