{"paperId": "8f80da970d0645ae69e4c44702a3fdd670a65dd9", "abstract": "Sparse attention as a efficient method can significantly decrease the computation cost, but current sparse attention tend to rely on window self attention which block the global information flow. For this problem, we present Shifted Cross Chunk Attention (SCCA), using different KV shifting strategy to extend respective field in each attention layer. Except, we combine Dilated Attention(DA) and Dilated Neighborhood Attention(DNA) to present Shifted Dilated Attention(SDA). Both SCCA and SDA can accumulate attention results in multi head attention to obtain approximate respective field in full attention. In this paper, we conduct language modeling experiments using different pattern of SCCA and combination of SCCA and SDA. The proposed shifted cross chunk attention (SCCA) can effectively extend large language models (LLMs) to longer context combined with Positional interpolation(PI) and LoRA than current sparse attention. Notably, SCCA adopts LLaMA2 7B from 4k context to 8k in single V100. This attention pattern can provide a Plug-and-play fine-tuning method to extend model context while retaining their original architectures, and is compatible with most existing techniques.", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "The proposed shifted cross chunk attention (SCCA) can effectively extend large language models (LLMs) to longer context combined with Positional interpolation and LoRA than current sparse attention."}, "embedding": {"model": "specter_v2", "vector": [-0.0982208326458931, 0.40912869572639465, -0.2667417526245117, 0.0029288821388036013, -0.1742844432592392, 0.1964702159166336, 0.5441853404045105, -0.14277857542037964, -0.4082878828048706, 0.049681294709444046, 1.0505754947662354, 0.32801008224487305, 0.4404284954071045, 0.26225149631500244, -0.04249296709895134, 0.11433037370443344, -0.7754442691802979, -0.07496672123670578, 0.06772550940513611, -0.4883692264556885, -0.02832970768213272, -0.8093277812004089, -0.9322271943092346, 0.29315805435180664, 0.41100698709487915, 0.45735791325569153, 0.8849084377288818, 0.5265795588493347, -0.6359190940856934, 0.21685194969177246, 0.25390708446502686, 0.03578424081206322, 0.20645689964294434, -0.19825880229473114, -0.3369144797325134, -0.3673669993877411, 0.35768210887908936, -0.29132580757141113, -0.10063545405864716, 0.6746294498443604, -0.13120581209659576, 0.5199658274650574, -0.15327386558055878, -0.6784465909004211, -0.5055605173110962, 1.1984469890594482, 0.3806072771549225, 0.6550470590591431, -0.05367195978760719, -0.9282056093215942, 1.40203857421875, -1.618335247039795, 0.4394172132015228, 1.3756530284881592, 0.4670518934726715, 0.43857821822166443, -0.05607116222381592, -0.5880784392356873, 1.053516149520874, 0.3378481864929199, -0.7365322113037109, -0.25473716855049133, 0.4005788266658783, 0.17895567417144775, 2.4049856662750244, -0.28528276085853577, 0.39168238639831543, 0.20815609395503998, -0.39993295073509216, 1.1561108827590942, -0.4435831606388092, -1.2166762351989746, -0.225433349609375, 0.08879657834768295, 0.5691497921943665, 0.5175021290779114, -0.4213470220565796, 0.4624449908733368, -0.9048157930374146, -0.2656899094581604, 0.2853390872478485, 0.07329495996236801, 0.17698688805103302, -0.14728881418704987, -0.324928879737854, 0.656558096408844, 0.39084309339523315, 1.007752776145935, -0.1604228913784027, 0.7915261387825012, 0.6055966019630432, -0.13967499136924744, 0.060616638511419296, 0.5099083185195923, -0.5658918023109436, 0.5669301152229309, -0.7440751194953918, 0.49701279401779175, -0.5325440168380737, 0.9366171956062317, 0.03720210865139961, 0.45193636417388916, -0.3784100413322449, 0.3369528353214264, 1.6278060674667358, 0.2878384590148926, 0.5147693157196045, -1.0200114250183105, 0.18135882914066315, -0.46005529165267944, -0.01444542407989502, -0.8826233148574829, -0.2781480848789215, -0.3313200771808624, -0.3260778784751892, -1.3436423540115356, -0.5549371838569641, 0.038933124393224716, -0.4734022319316864, 0.9967255592346191, -0.1551576554775238, 0.33104631304740906, -0.007846885360777378, 0.3131444752216339, 0.5977046489715576, 0.7043746709823608, 0.6154732704162598, -0.010998079553246498, 0.9493606686592102, -1.2121796607971191, -0.39892956614494324, -1.0709505081176758, 0.924750804901123, -0.3484102487564087, 0.3348425328731537, -0.6660698056221008, -1.1966580152511597, -1.0938842296600342, -0.8481225371360779, -0.11388173699378967, -0.7639970779418945, -0.08146623522043228, 0.8336837291717529, 0.08600358664989471, -1.0456557273864746, 0.43313485383987427, -0.5193008780479431, -0.6058170199394226, 0.20808419585227966, -0.21292713284492493, 0.30524489283561707, -0.2781256139278412, -1.7009629011154175, 0.34306758642196655, 0.2854098081588745, -0.5735951662063599, 0.2629043757915497, -0.781118631362915, -1.5108189582824707, 0.05624585598707199, 0.47109708189964294, -0.5206030011177063, 1.1048232316970825, -0.17289109528064728, -1.0966423749923706, 0.31376320123672485, -0.4839504361152649, -0.14937381446361542, -0.3125375807285309, -0.3424372971057892, -0.7557974457740784, -0.5593339204788208, 0.04480181261897087, 0.9080975651741028, 0.5335158705711365, -0.2440374791622162, -0.3799164891242981, -0.17534615099430084, -0.22742965817451477, 0.27828872203826904, -0.2045012265443802, 1.2096360921859741, -0.0873320922255516, -0.43327566981315613, 0.34833234548568726, 0.6657721996307373, -0.24586953222751617, -0.5214707851409912, -0.016194520518183708, -0.9599140882492065, 1.230654001235962, -0.04169280827045441, 1.4549769163131714, -0.7453491687774658, -1.0277715921401978, -0.3378910720348358, -0.24432215094566345, 0.06745295226573944, -0.8639101982116699, 0.5510150194168091, -0.4027599096298218, 0.12959609925746918, -0.16527308523654938, -0.8661989569664001, 0.001180259045213461, -0.3977660834789276, -0.8492674827575684, -0.7553873062133789, -0.3063177764415741, 1.2112985849380493, -0.9551380276679993, -0.29865285754203796, 0.009749523364007473, 0.2591997981071472, -1.1913810968399048, 0.7801002264022827, -0.6125438809394836, 0.0733838826417923, -0.2571074962615967, -0.19658930599689484, 0.04349200427532196, -0.09283249825239182, 0.1824335902929306, -0.2979215383529663, -0.3766832649707794, 0.41589364409446716, -0.5800631046295166, 1.5810233354568481, -0.5969555377960205, 0.5140683650970459, -0.14204010367393494, -0.2558083236217499, 0.15221257507801056, 0.24627453088760376, -0.04220380261540413, -0.40470877289772034, -0.09437721222639084, 0.3380291759967804, -0.8594735264778137, -0.030205311253666878, 1.1261181831359863, 1.1464420557022095, -0.661493718624115, 0.2683728337287903, 0.1056649386882782, -0.2129088193178177, 0.33667171001434326, 0.4631456136703491, 0.4368346631526947, 0.5592684149742126, 0.7648758292198181, -0.4052872657775879, 0.5236417055130005, -0.5106452107429504, 0.16224192082881927, 0.4468674063682556, 0.372192919254303, 0.69704669713974, 0.006466585211455822, -0.8371285796165466, -0.5071004033088684, 0.5924068689346313, 0.6699036955833435, 1.931810736656189, -0.18914714455604553, -0.35532885789871216, -0.8258333206176758, -0.3659008741378784, -0.26706477999687195, 0.14560580253601074, -0.2879478335380554, 0.2538934051990509, -0.8771665096282959, -0.523387610912323, 0.5036166906356812, 0.5635390877723694, 1.1167001724243164, -0.9382052421569824, -0.41826242208480835, -0.11325177550315857, 0.5064187049865723, -0.7841500043869019, -0.7780681252479553, 0.07478781789541245, -0.2112533003091812, -0.07367239892482758, -0.03522985801100731, -0.48510876297950745, -0.10578779131174088, -0.443253755569458, 0.8142688274383545, -0.5502939820289612, -0.016835404559969902, 0.17716073989868164, 0.13635371625423431, -0.5187103748321533, -0.4711158573627472, 0.4164823591709137, -0.025107473134994507, -0.541321873664856, 0.6655323505401611, 0.7486645579338074, -0.1733309030532837, -0.1526239961385727, -0.402003675699234, 0.18783679604530334, -0.3372681736946106, 0.032333023846149445, 0.6385993957519531, -0.5006582140922546, 0.5081265568733215, -1.2663143873214722, 0.8987884521484375, 0.4528668522834778, -0.7022563815116882, 0.18922381103038788, -0.7142385840415955, -0.5043887495994568, 0.266266793012619, -0.18415607511997223, -0.7339169979095459, -0.666863739490509, 0.5340645909309387, 0.04238293319940567, -0.44484445452690125, 0.44458723068237305, 0.04870941862463951, 0.3078933358192444, 0.2596193253993988, 0.24027620255947113, 0.2166828066110611, -0.09421296417713165, 0.8543944358825684, -0.5110980272293091, 0.32485178112983704, 0.42586749792099, -0.4188016951084137, -0.27123937010765076, -0.22758391499519348, -0.975979745388031, -0.2218930572271347, -0.463344544172287, -0.2501078248023987, 0.4678010940551758, 0.46182310581207275, -0.5811395049095154, -0.24095748364925385, 0.19534634053707123, -1.1373697519302368, -0.3040602505207062, -0.03773105889558792, -0.19671018421649933, -0.11217393726110458, -0.9883845448493958, -0.8414861559867859, -0.25935226678848267, -0.6242175698280334, -0.8590826392173767, 0.43240028619766235, -0.026621516793966293, -0.5995988845825195, -0.8259797692298889, 0.26561909914016724, -0.5242534279823303, 1.4705545902252197, -0.7242372632026672, 0.8305513858795166, -0.10920193046331406, -0.11719014495611191, -0.4159247577190399, 0.10057824105024338, 0.5486538410186768, -0.07997945696115494, 0.03704552724957466, -0.5409271121025085, 0.4364562928676605, -0.05758609250187874, 0.0578533299267292, 0.28384697437286377, 0.8616916537284851, 0.5058467984199524, 0.15651899576187134, -0.7275288701057434, 0.060393016785383224, 1.3230397701263428, -0.31345298886299133, 0.2479476034641266, 0.017396148294210434, 1.0633608102798462, 0.10697370022535324, -0.10667098313570023, 0.5317967534065247, 0.5046617984771729, 0.5263204574584961, 0.12044636160135269, -0.030733756721019745, -0.4657541513442993, -0.4417229890823364, 0.38068100810050964, 1.7605828046798706, 0.3523988127708435, 0.3548603355884552, -1.1426763534545898, 0.7492857575416565, -1.2109935283660889, -0.8925352692604065, 0.7005990743637085, 0.37715232372283936, 0.2863250970840454, -0.9807263016700745, -0.5453432202339172, -0.4925355017185211, 0.7231844067573547, 0.887810468673706, -0.3675839602947235, -0.6169340014457703, -0.14817552268505096, 0.027832360938191414, -0.25127875804901123, 1.2630162239074707, -0.348122239112854, 1.1547037363052368, 14.687891006469727, 0.677452564239502, 0.20509476959705353, 0.5141639709472656, 0.8341050744056702, 0.3715171813964844, -0.37796449661254883, 0.06069433316588402, -1.4557079076766968, -0.08237235993146896, 0.6252453327178955, 0.09485889226198196, 0.8117625713348389, 0.292381227016449, 0.17078115046024323, 0.03223874419927597, -0.47568798065185547, 0.5257904529571533, 0.8529025316238403, -1.2694389820098877, 0.06246696040034294, -0.10740812867879868, 0.8143216371536255, 0.49901801347732544, 0.4201371669769287, 0.8524974584579468, 0.14605185389518738, -0.04045974463224411, -0.1492476761341095, 0.28190532326698303, 0.6852225661277771, 0.21119998395442963, 0.3084065616130829, 0.2748173177242279, -0.9716890454292297, -0.31311437487602234, -0.5699822306632996, -1.5110245943069458, 0.2736016511917114, -0.2062147855758667, 0.0008507876191288233, -1.0348995923995972, -0.3320159614086151, 0.7828090786933899, -0.008837118744850159, 0.11276006698608398, -0.19723914563655853, 0.09860482811927795, 0.10525040328502655, -0.29956912994384766, 0.18837416172027588, 0.6008265614509583, 0.37698692083358765, -0.2678992748260498, 0.15726886689662933, 0.17154352366924286, 0.0670749768614769, 0.32147732377052307, -0.20736929774284363, 0.004309332929551601, -0.41758668422698975, 0.016190290451049805, 0.2588580548763275, 0.4070904552936554, 0.8826663494110107, 0.025704894214868546, -0.673007607460022, 0.04468555003404617, 0.6169239282608032, 0.5893953442573547, -0.38893160223960876, -0.19774794578552246, 0.4462352693080902, -0.3475870192050934, 0.13243725895881653, 0.6537882685661316, -0.4895172119140625, -0.21999140083789825, -0.8224506974220276, -0.0694694072008133, 0.3990752100944519, -1.1021432876586914, -0.4538158178329468, 1.0617727041244507, 0.06346861273050308, -0.18404720723628998, -0.058688823133707047, -0.5787787437438965, -0.18297788500785828, 0.351489394903183, -1.118005633354187, -0.7556896805763245, 0.170191690325737, -0.37978291511535645, -0.2657524049282074, -0.10997657477855682, 1.500873327255249, -0.0499514676630497, -0.42898812890052795, -0.2303265929222107, 0.16675153374671936, -0.2959420084953308, -0.0684543251991272, -0.5290255546569824, 0.773261308670044, 0.4214451313018799, -0.2128869593143463, 0.24649116396903992, -0.2972167432308197, -0.05369919165968895, -0.3466329574584961, -0.13288582861423492, 1.0137059688568115, -0.8647392392158508, -0.3623296916484833, -0.5899165868759155, -0.8380463123321533, 0.5307275652885437, 0.9007272124290466, -0.0045737288892269135, 0.15637005865573883, 0.20358595252037048, -0.32174286246299744, -0.4211633503437042, -0.796248733997345, 0.02773023024201393, 0.5211390256881714, -0.5508080720901489, -0.4697166085243225, -0.15826785564422607, 1.1410191059112549, -0.8198177218437195, -0.2550475299358368, -0.11515075713396072, 0.07241974025964737, 0.013314859010279179, 0.8851062059402466, -0.507514238357544, 0.6201484203338623, 0.8842512369155884, -0.5452927947044373, -0.9096106886863708, -0.12718798220157623, -0.7245059013366699, -0.28671523928642273, 0.3216034471988678, 1.0141466856002808, -0.53438800573349, 0.46008068323135376, 1.2659896612167358, 0.09066535532474518, -0.5962828397750854, -0.3624156713485718, -0.0063911667093634605, -0.05314663052558899, -0.9353539943695068, 1.0827713012695312, -0.14361032843589783, 0.5992373824119568, 0.32544800639152527, 0.5211228132247925, 0.35568785667419434, -0.5219905376434326, -0.6573966145515442, 0.18629656732082367, 0.37510398030281067, 0.06998186558485031, -0.6899521946907043, -0.6615566611289978, -1.3421664237976074, 0.10535302013158798, -0.7665367722511292, -0.12180895358324051, -0.945610761642456, -0.3505913317203522, -0.09710696339607239, -0.5153201222419739, 0.05131783336400986, 0.2805381417274475, -0.2942039370536804, -0.3505689203739166, -0.5866664052009583, -0.528995156288147, 0.8672196269035339, 0.8804386258125305, -0.4642738699913025, -0.3859460651874542, -0.3229665756225586, -0.2225702404975891, 0.43556126952171326, 0.5200893878936768, -0.22762982547283173, -0.6226533055305481, -1.7442131042480469, 0.5419698357582092, -0.28801265358924866, -0.2497529834508896, -0.5812681913375854, 0.6623244285583496, 0.44947582483291626, -0.24262642860412598, -0.2271425724029541, 0.3297055661678314, -1.096673846244812, -0.6881325840950012, 0.21980459988117218, -0.7396374344825745, 0.2164304554462433, 0.12709268927574158, -0.572538435459137, -0.45238354802131653, 0.8132109642028809, -0.23561866581439972, -1.0662107467651367, -1.352601170539856, 0.34745997190475464, -0.2202119529247284, 0.19463995099067688, -0.07048167288303375, -0.14853981137275696, -1.3893089294433594, -0.28864774107933044, -0.20212231576442719, 0.2584596276283264, -0.26283472776412964, 0.8060973882675171, 0.573639452457428, -1.5219937562942505, 0.17596536874771118, 0.5511969327926636, -0.12345573306083679, 0.03779284283518791, 0.7460285425186157, 0.3308030068874359, -0.5370607376098633, 0.9971563816070557, 0.428166925907135, 0.33671897649765015, -0.6921829581260681, 0.21493053436279297, 0.48452088236808777, -0.279675155878067, -0.037522703409194946, 1.1709022521972656, -0.4066886305809021, -0.9421316981315613, 0.13910968601703644, -1.3967771530151367, -0.47714167833328247, -0.3567245304584503, 0.9135066866874695, 0.4880472719669342, -0.31601399183273315, -0.27905967831611633, -0.784826397895813, 0.42177173495292664, -0.08709841966629028, -0.5336617231369019, 0.6322222352027893, -0.532170295715332, -0.6101711392402649, 0.30466365814208984, 1.0558345317840576, -0.6228311657905579, -0.8282407522201538, -0.6937380433082581, -0.37171471118927, -0.24448885023593903, 0.3501928150653839, -0.4592394232749939, -0.3916625678539276, 0.5142638087272644, 0.5914393067359924, 0.5217166543006897, 0.18181125819683075, 0.22248518466949463, 0.6478384733200073, 0.4507530629634857, 0.06751708686351776, -0.9240840077400208, -0.7371369004249573, 1.402602195739746, 1.580492377281189, -1.076897144317627, 0.22530905902385712, -0.06800069659948349, -0.8488893508911133, 0.3606775104999542, 0.4780154526233673, -0.03414391353726387, 1.1454628705978394, -0.4316903054714203, 0.4696928858757019, 0.16236038506031036, -1.0275129079818726, -0.23487594723701477, 0.5248855352401733, 1.1834397315979004, 0.6877094507217407, 0.36773616075515747, 0.029119115322828293, 0.8435171842575073, 0.20933261513710022, -0.08276180177927017, 0.15349936485290527, 0.2990092635154724, -0.44216808676719666, 0.03248157352209091, -0.07382628321647644, 0.42383426427841187, -0.15549452602863312, -0.9031646847724915, 0.24230128526687622, 0.7481359839439392, 0.14814063906669617, 0.47993627190589905, 0.847950279712677, 0.4128463864326477, 0.18380123376846313, 0.40016600489616394, 0.2688451111316681, -0.5579209327697754, 0.10973896086215973, 0.06653986871242523, -0.6444284915924072, -0.2986113727092743, -0.2905978262424469, -0.8071532249450684, -0.4700888991355896, 0.254484623670578, 0.2649346590042114, -0.18017461895942688, 0.6595421433448792, 0.9503586292266846, 1.1215202808380127, 0.38854658603668213, -0.3780011534690857, -0.2793305218219757, -0.09681672602891922, -1.2893481254577637, -0.09452846646308899, -0.44214949011802673, -0.2556039094924927, 0.09430376440286636, 0.16008909046649933, -0.348959356546402]}, "authors": [{"authorId": "2273989223", "name": "Yuxiang Guo"}], "references": [{"paperId": "73290ecbec2f38d1d647ddef1ada69cee41725b3", "title": "PoSE: Efficient Context Window Extension of LLMs via Positional Skip-wise Training"}, {"paperId": "b31a5884a8ebe96b6300839b28608b97f8f8ef76", "title": "LongBench: A Bilingual, Multitask Benchmark for Long Context Understanding"}, {"paperId": "c12db2c60e8989f646a29ad4f4d24475e860ad91", "title": "LongNet: Scaling Transformers to 1, 000, 000, 000 Tokens"}, {"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "6281c40c66febca1d8003bcc6fdfd2189b30c38f", "title": "SCROLLS: Standardized CompaRison Over Long Language Sequences"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "4e3935ef7da6bcbb202ec7f8b285c313cadcd044", "title": "A Dataset of Information-Seeking Questions and Answers Anchored in Research Papers"}, {"paperId": "9dc624d7258d1a56117ca720aea953ce46b66b21", "title": "Efficient Attentions for Long Document Summarization"}, {"paperId": "725264948d7b6946259af5b8d966e996b9570f99", "title": "DeepSpeed: System Optimizations Enable Training Deep Learning Models with Over 100 Billion Parameters"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "2cf3bd0cc1382f35384e259d99e4f9744eeaed28", "title": "Blockwise Self-Attention for Long Document Understanding"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "853d4d94651c6d9f8ed4d114e1eb21f15f786daa", "title": "A Discourse-Aware Attention Model for Abstractive Summarization of Long Documents"}, {"paperId": "d91043f0d48b9b2c8ff7ee321abb8fd7efafff7a", "title": "The NarrativeQA Reading Comprehension Challenge"}, {"paperId": "df0402517a7338ae28bc54acaac400de6b456a46", "title": "WaveNet: A Generative Model for Raw Audio"}, {"paperId": "c8b25fab5608c3e033d34b4483ec47e68ba109b7", "title": "Swin Transformer: Hierarchical Vision Transformer using Shifted Windows"}, {"paperId": "d77d03fb7ae5572ad0d9e728ff05c73263852278", "title": "& Computer"}, {"paperId": null, "title": "2023. Dilated neighborhood attention transformer"}, {"paperId": null, "title": "2022. Proof-pile"}, {"paperId": null, "title": "2023. Ef-fidit: An assistant for improving writing efficiency"}, {"paperId": null, "title": "2023. Ntk-aware scaled rope allows llama models to have extended (8k+) context size without any fine-tuning and minimal perplexity degradation"}, {"paperId": null, "title": "2022. QuALITY: Question answering with long input texts,"}, {"paperId": null, "title": "2023. A length-extrapolatable transformer"}, {"paperId": null, "title": "2022. LoRA: Low-rank adaptation of large language models"}]}