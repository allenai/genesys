{"paperId": "34a4e6818d680875ff0bef9a76de0376118446d1", "abstract": "We propose Sparse Sinkhorn Attention, a new efficient and sparse method for learning to attend. Our method is based on differentiable sorting of internal representations. Concretely, we introduce a meta sorting network that learns to generate latent permutations over sequences. Given sorted sequences, we are then able to compute quasi-global attention with only local windows, improving the memory efficiency of the attention module. To this end, we propose new algorithmic innovations such as Causal Sinkhorn Balancing and SortCut, a dynamic sequence truncation method for tailoring Sinkhorn Attention for encoding and/or decoding purposes. Via extensive experiments on algorithmic seq2seq sorting, language modeling, pixel-wise image generation, document classification and natural language inference, we demonstrate that our memory efficient Sinkhorn Attention method is competitive with vanilla attention and consistently outperforms recently proposed efficient Transformer models such as Sparse Transformers.", "venue": "International Conference on Machine Learning", "year": 2020, "citationCount": 285, "influentialCitationCount": 36, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work introduces a meta sorting network that learns to generate latent permutations over sequences and is able to compute quasi-global attention with only local windows, improving the memory efficiency of the attention module."}, "embedding": {"model": "specter_v2", "vector": [0.8281925916671753, 0.755098283290863, -0.640625, -0.02859140746295452, -0.5578944683074951, -0.3448762595653534, 0.6527150869369507, 0.1361352950334549, -0.033986400812864304, -0.2794267535209656, 0.7659875750541687, 0.6438441872596741, 0.02112720161676407, -0.046969953924417496, -0.5032188892364502, 0.14542734622955322, -0.7146785259246826, 0.4664086103439331, 0.22573454678058624, -0.27960771322250366, 0.6490311622619629, -0.8535425066947937, -1.3742655515670776, 0.4580666720867157, 0.5676371455192566, 0.5561153888702393, 0.44391506910324097, 0.7030256390571594, -0.5923907160758972, 0.2991364598274231, 0.352043479681015, -0.4734070599079132, 0.35128098726272583, -0.1953546106815338, -0.512160062789917, -0.4513908326625824, 0.6449840664863586, -0.08590719103813171, -0.5026552677154541, 0.9070996642112732, -0.34008678793907166, 0.27616333961486816, 0.41560474038124084, -0.5991224050521851, -0.20247207581996918, 1.0786410570144653, 0.508272647857666, 0.459148108959198, 0.07834240049123764, -0.6234316229820251, 1.7541433572769165, -0.8668919205665588, 0.5777603387832642, 1.3448102474212646, 0.34934353828430176, 0.3494934141635895, -0.20846065878868103, -0.46426114439964294, 0.8140279054641724, 0.514094352722168, -0.5122382640838623, -0.23837678134441376, -0.000525634444784373, 0.026400819420814514, 1.4347869157791138, 0.07473047822713852, 0.4651496708393097, 0.34850263595581055, -0.1005050539970398, 1.7597681283950806, -0.34712305665016174, -0.598099410533905, -0.18793897330760956, -0.24482589960098267, 0.46467629075050354, 0.8798515200614929, -0.13683156669139862, 0.4760822355747223, -1.3321911096572876, 0.09745936840772629, 0.2846136689186096, 0.10151731222867966, 0.23212489485740662, -0.3615390360355377, -0.08123592287302017, 0.4262923300266266, 0.6465725898742676, 0.5902058482170105, -0.4163403809070587, 1.1450399160385132, 0.5507833361625671, -0.20654068887233734, -0.45075565576553345, 0.7819429636001587, -0.04469604045152664, 0.2861211895942688, -0.9873756170272827, 0.3019956946372986, -0.2379792332649231, 1.1292710304260254, -0.25330913066864014, 0.10911769419908524, -1.0197291374206543, -0.1768105924129486, 1.0494287014007568, -0.1473560333251953, 0.563774049282074, -1.02813720703125, 0.09534294903278351, -0.21281684935092926, -0.02171202376484871, -1.0059994459152222, 0.19898197054862976, -0.17915111780166626, -0.7154053449630737, -1.287501573562622, -0.6090014576911926, 0.6468808054924011, -0.8623582720756531, 0.858697772026062, -0.6196087002754211, 0.5928608179092407, -0.5649381875991821, 0.30083975195884705, 0.547109067440033, 0.7267724871635437, 0.0995577946305275, -0.006571078207343817, 0.7459997534751892, -0.904961884021759, -0.44849973917007446, -1.1606460809707642, 0.3911193609237671, 0.1856665313243866, 0.02488591894507408, 0.09260820597410202, -1.618011713027954, -0.975537121295929, -0.6838366389274597, 0.08346358686685562, -0.6055260896682739, -0.034971121698617935, 1.2573970556259155, 0.2862350344657898, -0.8252261281013489, 0.8145630359649658, -0.6549797058105469, 0.02099127322435379, 1.037379503250122, 0.3496400713920593, 0.29112499952316284, -0.24055153131484985, -0.9933974742889404, -0.04982331395149231, 0.20165866613388062, -0.5781853795051575, -0.5435124039649963, -1.1161847114562988, -1.1183629035949707, 0.1769838035106659, 0.38606375455856323, -0.5839532017707825, 0.9509145617485046, -0.4103426933288574, -0.979145348072052, 0.8988786339759827, -0.710883617401123, -0.16836537420749664, 0.29409700632095337, -0.3445196747779846, -0.06511449068784714, -0.2268010526895523, 0.13111360371112823, 0.3705998957157135, 0.5810824036598206, -0.447347491979599, 0.11590050160884857, -0.07100676000118256, -0.6157045364379883, -0.47826293110847473, -0.24274703860282898, 0.6283787488937378, -0.514642059803009, -0.47620460391044617, 0.25572800636291504, 0.9595714807510376, -0.09832470864057541, -0.5118185877799988, -0.5144261717796326, -1.0354361534118652, 0.49025315046310425, 0.29139724373817444, 0.9520758390426636, -0.6533453464508057, -0.25707489252090454, -0.10621507465839386, -0.05546581745147705, 0.34410855174064636, -0.9444999098777771, 0.8505265116691589, -0.6620144844055176, 0.43921607732772827, -0.5393313765525818, -0.5789874196052551, -0.03544760122895241, -0.44587767124176025, -0.7637310028076172, -0.17832882702350616, 0.21424981951713562, 1.3156629800796509, -1.1356327533721924, 0.14095500111579895, 0.07288655638694763, -0.08511069416999817, -1.4812066555023193, 1.2642320394515991, -0.48601022362709045, -0.07771928608417511, -0.38713109493255615, -0.2576274573802948, 0.27312275767326355, -0.28424885869026184, 0.5330246686935425, -0.4545235335826874, -0.021142417564988136, 0.5454572439193726, -0.5357567667961121, 1.3642388582229614, -0.03237059339880943, 0.3795069754123688, -0.27860453724861145, -1.3847540616989136, 0.19254225492477417, -0.13788467645645142, -0.32803258299827576, -0.6050522327423096, 0.05137009173631668, 0.14297033846378326, -0.9351747035980225, -0.10836494714021683, 0.7625340223312378, 0.6049069762229919, -0.2877179682254791, -0.2289402186870575, 0.6884714365005493, -0.3761136531829834, 0.5613694787025452, 0.853976845741272, 0.9090102314949036, 0.5711519718170166, 0.6864686608314514, -0.17874775826931, 0.09066387265920639, -0.715368926525116, 0.09007566422224045, 0.6446478962898254, 0.9442625641822815, 0.9882156252861023, 0.7862216234207153, -0.661615252494812, -0.32283636927604675, -0.019210612401366234, 0.7084079384803772, 1.1396523714065552, 0.3770756423473358, -0.5402523875236511, -0.6775679588317871, -0.3620345890522003, -0.28123214840888977, -0.1294824331998825, -0.5974808931350708, -0.42721647024154663, -0.6843954920768738, -0.7466889023780823, 0.553845226764679, 0.5916902422904968, 0.986496090888977, -0.9938773512840271, -0.46237218379974365, -0.44323110580444336, 0.2314024269580841, -0.42076629400253296, -0.6458799242973328, 0.5403360724449158, -0.23673076927661896, -0.24927136301994324, 0.27457910776138306, -0.45131415128707886, 0.23097941279411316, -0.7233820557594299, 1.1115800142288208, -0.1333349496126175, -0.6997889280319214, -0.017569497227668762, 0.5231631994247437, -0.5229234099388123, -0.030467217788100243, 0.37844783067703247, -0.11057483404874802, -0.08158577233552933, 0.057341959327459335, 0.4430766999721527, -0.11086094379425049, -0.12703081965446472, -0.601124107837677, 0.035671915858983994, 0.010132580995559692, 0.42243432998657227, 0.7578322887420654, -0.15822000801563263, -0.036883484572172165, -1.5953325033187866, -0.008273453451693058, 0.06992265582084656, -0.7566284537315369, 0.035022616386413574, -0.28648829460144043, -0.2614036202430725, 0.5715970396995544, -0.3986945152282715, -0.39896124601364136, -0.7868728637695312, 0.3237795829772949, -0.10550343990325928, -0.19199775159358978, 0.3686845004558563, -0.07389342784881592, 0.398691326379776, 0.08215367048978806, 0.14729920029640198, -0.07052506506443024, 0.2016693353652954, 0.5149408578872681, -1.2392545938491821, 0.7428544759750366, 0.18906264007091522, 0.3276623785495758, 0.13119962811470032, 0.13972143828868866, -0.8291678428649902, -0.6211451888084412, -0.43623143434524536, -0.08069390058517456, 0.09753593057394028, 0.34137046337127686, -0.25436893105506897, -1.342344880104065, 0.17498227953910828, -1.0459274053573608, -0.6814925670623779, -0.06636185199022293, -0.7665539979934692, -0.5023689270019531, -1.0904045104980469, -0.7868798971176147, -0.6545800566673279, -0.18665920197963715, -0.7202316522598267, 0.7110949754714966, 0.17093254625797272, -0.7921931743621826, -0.5664159655570984, 0.06126752495765686, -0.4533863663673401, 0.6829450130462646, -0.16355596482753754, 0.7815927863121033, -0.08148318529129028, -1.0007320642471313, -0.27143561840057373, 0.23335130512714386, 0.04480791091918945, -0.5458218455314636, 0.07362545281648636, -0.5139320492744446, 0.3037838637828827, -0.6608168482780457, -0.2478548139333725, 0.5773484110832214, 0.6763488054275513, 1.3222441673278809, -0.2977727949619293, -0.881385862827301, 0.6969819068908691, 1.7669782638549805, -0.3993154764175415, 0.4826769232749939, 0.2298382967710495, 0.9633227586746216, 0.48763272166252136, 0.023693762719631195, 0.6164170503616333, 0.05270042642951012, 0.2587146461009979, 0.7797853350639343, 0.06450973451137543, -0.15980544686317444, -0.9941333532333374, 0.32740068435668945, 1.1735103130340576, 0.6938813924789429, -0.29779452085494995, -0.9524398446083069, 1.3269459009170532, -1.0779742002487183, -1.292362928390503, 0.5508319735527039, 0.8698025345802307, 0.0701407939195633, -0.535062313079834, -0.2500663697719574, -0.20453482866287231, 0.7242721915245056, 0.4704154431819916, -0.4762531816959381, -0.44648870825767517, -0.08306572586297989, 1.0211092233657837, 0.4175366759300232, 0.7405235171318054, -0.07535399496555328, 0.6812328100204468, 14.876233100891113, 0.8339189887046814, 0.22478391230106354, 0.16523262858390808, 0.4002384841442108, -0.06290403753519058, -0.8547301888465881, 0.22845953702926636, -1.0464708805084229, 0.22809459269046783, 0.6739184856414795, 0.32913070917129517, 0.6989802122116089, -0.28542688488960266, -0.37644636631011963, 0.21939975023269653, -0.6284112334251404, 0.5049406886100769, 0.5129782557487488, -1.4968109130859375, 0.6450924277305603, -0.011642176657915115, 0.42447659373283386, -0.017526960000395775, 1.0700486898422241, 0.3459493815898895, 0.5110565423965454, -0.8322288990020752, 0.6733002066612244, 0.5821391344070435, 1.205297589302063, 0.03213120251893997, 0.2619561553001404, 0.2371182143688202, -0.9091099500656128, -0.2915440797805786, -0.29028481245040894, -1.029564380645752, 0.32090237736701965, -0.26798394322395325, 0.06705479323863983, -0.4175112247467041, -0.08451934158802032, 1.1697429418563843, 0.4732060134410858, 0.40088993310928345, -0.21070119738578796, 0.3132798373699188, 0.18605825304985046, -0.029083816334605217, 0.17200875282287598, 0.5321080088615417, 0.14670416712760925, -0.03715960308909416, 0.17463845014572144, 0.4073164165019989, -0.12182734161615372, 0.3816494047641754, -0.5297340750694275, -0.5240488052368164, -0.3893471658229828, -0.4542977511882782, 0.3045521080493927, 0.6446161270141602, 0.6058390736579895, 0.2084592878818512, 0.010562855750322342, 0.26576200127601624, 0.39331862330436707, -0.12263168394565582, -0.226815328001976, -0.589745283126831, 0.20908817648887634, -0.07553952187299728, 0.1722610890865326, 0.9450023770332336, -0.6626251935958862, -0.10050617903470993, -0.9265617728233337, -0.43120768666267395, 0.6643514633178711, -0.8727254271507263, -0.5253000259399414, 0.4046388566493988, -0.3412225842475891, -0.30459895730018616, 0.4768669307231903, -0.8081507086753845, -0.4421270787715912, -0.08037199825048447, -1.0930436849594116, -0.5041853785514832, -0.1194663941860199, -0.5304890871047974, -0.24887333810329437, -0.12458222359418869, 0.8499779105186462, -0.2740265130996704, -0.01537389401346445, 0.22236555814743042, -0.22695674002170563, -0.2893253564834595, -0.32556188106536865, -1.0953309535980225, 0.754883348941803, 0.2621100842952728, -0.3089504539966583, 0.5943563580513, 0.2694675028324127, 0.02924937754869461, -0.9266735315322876, -0.022967182099819183, 0.7023879885673523, -1.1386446952819824, -0.4304965138435364, -0.5342553853988647, -0.7114039659500122, 0.663388192653656, 0.5528218150138855, -0.2801091969013214, 0.25146883726119995, -0.11395136266946793, -0.5257470607757568, -0.23971831798553467, -0.7242286205291748, 0.05752674117684364, 0.9228042960166931, -0.5094902515411377, -0.507036030292511, -0.463644802570343, 0.2569844722747803, -0.8324908018112183, -0.10761535167694092, -0.233088880777359, 0.3821711242198944, -0.37031280994415283, 1.3016444444656372, -0.7045716047286987, 1.2901865243911743, 0.7764326333999634, -0.0010334195103496313, -0.8393000960350037, -0.35870903730392456, -1.446657657623291, 0.09644259512424469, 0.47805851697921753, 0.2818346619606018, -0.23239807784557343, 0.6727133989334106, 0.3012184202671051, 0.24064284563064575, -0.16807053983211517, -0.10753821581602097, -0.04245363548398018, 0.03829023614525795, -0.1682923287153244, 0.6347213387489319, 0.1713050901889801, -0.03615659475326538, -0.0015872516669332981, 0.48083993792533875, 0.5412346124649048, 0.05013430863618851, -0.5270169973373413, 0.246950164437294, -0.16514502465724945, -0.052268389612436295, -0.8638606071472168, -0.66902756690979, -1.464892864227295, 0.010251143015921116, -1.399320363998413, 0.11492080241441727, -1.1062688827514648, -0.15887972712516785, 0.33725497126579285, -0.3193807601928711, -0.05055468529462814, 0.09232265502214432, -0.15037645399570465, -0.5759284496307373, -1.1871683597564697, -0.6773436665534973, 0.6890534162521362, 0.6372517347335815, -0.8699371218681335, 0.2564242482185364, -0.45496702194213867, -0.6205475330352783, 0.3402590751647949, 0.3786095976829529, -0.48922404646873474, -0.32433831691741943, -1.3725383281707764, 0.6680194139480591, 0.17603889107704163, 0.15423859655857086, -0.3617658317089081, 0.7753167748451233, 0.40520623326301575, -0.1655612736940384, -0.23990045487880707, 0.29762089252471924, -0.7020156979560852, -0.5312042236328125, 0.3561645448207855, -1.142082929611206, 0.050004661083221436, 0.008513255044817924, -0.2613895833492279, -0.19339381158351898, 0.6423828601837158, 0.09796705096960068, -1.1927162408828735, -0.549582302570343, 0.5941934585571289, -0.5261041522026062, 0.5725860595703125, -0.11453413963317871, -0.41355636715888977, -1.3030773401260376, -0.36972999572753906, 0.2813906967639923, 0.5964385271072388, -0.31103211641311646, 0.5033820271492004, 0.4254089891910553, -1.1337145566940308, 0.27264514565467834, 0.5370861887931824, -0.05023513361811638, 0.3060442805290222, 0.6694543361663818, 0.22739456593990326, -0.3124627470970154, 0.4213106334209442, 0.19514797627925873, 0.5164397358894348, -0.6860672235488892, 0.3462594747543335, 0.3507934808731079, -0.22374215722084045, 0.01588781364262104, 1.2590302228927612, 0.13933955132961273, -0.7244520783424377, 0.0886521115899086, -0.6340718865394592, -0.5666800737380981, 0.15024514496326447, 0.5877147316932678, 0.5787873268127441, -0.27168935537338257, 0.03459829092025757, -0.7699080109596252, 0.6162949800491333, 0.11188393831253052, -0.173381969332695, 1.1708743572235107, 0.29536327719688416, -0.696304202079773, 0.30477505922317505, 0.8880286812782288, -0.4812690317630768, -0.5204819440841675, -0.5880089402198792, -0.23748163878917694, -0.586955726146698, 0.06257142126560211, -0.15125387907028198, -0.616492509841919, 0.8789427280426025, 0.01668551191687584, 0.7321063280105591, 0.3555960953235626, 0.0360412560403347, 0.15867184102535248, 0.234002485871315, -0.21461540460586548, -0.48135796189308167, 0.10395777225494385, 0.9970720410346985, 1.1895211935043335, -0.2675364017486572, -0.009693453088402748, -0.3274793028831482, -0.665808379650116, 0.4094538688659668, 0.1174006462097168, -0.6139090061187744, 0.37838318943977356, -0.1378815919160843, -0.45769065618515015, -0.10055377334356308, -1.0536205768585205, -0.2974121868610382, 0.7779529094696045, 1.5013961791992188, 0.6367493867874146, 0.03202200308442116, 0.036133039742708206, 0.912846028804779, 0.09333037585020065, -0.16713744401931763, 0.4730394184589386, 0.1530204713344574, 0.01920899748802185, -0.17832618951797485, 0.30290690064430237, 0.7726656794548035, -0.9556973576545715, -0.7449818849563599, -0.0968840941786766, 0.16957560181617737, 0.08244726806879044, 0.42519834637641907, 0.8794594407081604, 0.44953668117523193, 0.3822152614593506, -0.23663368821144104, 0.4862811863422394, -0.734412431716919, -0.1962662935256958, -0.5332798957824707, -0.766732931137085, -0.5324346423149109, -0.2516918182373047, -0.865034282207489, -0.27020373940467834, -0.021853046491742134, 0.1520957201719284, -0.029700057581067085, -0.0412430465221405, 1.0406537055969238, 0.43104416131973267, 0.8303139209747314, -0.2360365241765976, -0.7162081003189087, -0.12727239727973938, -0.3363839387893677, -0.0006275582709349692, -0.38875812292099, 0.20215179026126862, -0.20724256336688995, -0.0454120934009552, -0.08404393494129181]}, "authors": [{"authorId": "144447820", "name": "Yi Tay"}, {"authorId": "11774695", "name": "Dara Bahri"}, {"authorId": "1988888746", "name": "Liu Yang"}, {"authorId": "1680617", "name": "Donald Metzler"}, {"authorId": "50270386", "name": "Da-Cheng Juan"}], "references": [{"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "2cf3bd0cc1382f35384e259d99e4f9744eeaed28", "title": "Blockwise Self-Attention for Long Document Understanding"}, {"paperId": "e1f037f47d96d10af5c1ab390a246238dd8e1057", "title": "Simple and Effective Curriculum Pointer-Generator Networks for Reading Comprehension over Long Narratives"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "2a31319e73d4486716168b65cdf7559baeda18ce", "title": "Star-Transformer"}, {"paperId": "16c844fd4d97f3c6eb38b0d6527c87d184efedc3", "title": "The Evolved Transformer"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "2270b8628fd8ca67ae39d277f45bc3c38ac63d5f", "title": "Mesh-TensorFlow: Deep Learning for Supercomputers"}, {"paperId": "d170bd486e4c0fe82601e322b0e9e0dde63ab299", "title": "Adaptive Input Representations for Neural Language Modeling"}, {"paperId": "0ef460c47377c3b9482d8177cbcafad1730a91a5", "title": "Bi-Directional Block Self-Attention for Fast and Memory-Efficient Sequence Modeling"}, {"paperId": "642c1b4a9da95ea4239708afc5929a5007a1870d", "title": "Tensor2Tensor for Neural Machine Translation"}, {"paperId": "23deae1e548bc055c8920fc8529e59bba0816685", "title": "Learning Latent Permutations with Gumbel-Sinkhorn Networks"}, {"paperId": "1db9bd18681b96473f3c82b21edc9240b44dc329", "title": "Image Transformer"}, {"paperId": "5d727286a59d7e2681b6fac5fa269e782849f007", "title": "Reinforced Self-Attention Network: a Hybrid of Hard and Soft Attention for Sequence Modeling"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "5ded2b8c64491b4a67f6d39ce473d4b9347a672e", "title": "A Broad-Coverage Challenge Corpus for Sentence Understanding through Inference"}, {"paperId": "510e26733aaff585d65701b9f1be7ca9d5afc586", "title": "Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer"}, {"paperId": "29e944711a354c396fad71936f536e83025b6ce0", "title": "Categorical Reparameterization with Gumbel-Softmax"}, {"paperId": "c1e3a26fb88c6720f4e84b7118e6f2df7dc8efa3", "title": "From Softmax to Sparsemax: A Sparse Model of Attention and Multi-Label Classification"}, {"paperId": "f04df4e20a18358ea2f689b4c129781628ef7fc1", "title": "A large annotated corpus for learning natural language inference"}, {"paperId": "93499a7c7f699b6630a86fad964536f9423bb6d0", "title": "Effective Approaches to Attention-based Neural Machine Translation"}, {"paperId": "4d8f2d14af5991d4f0d050d22216825cac3157bd", "title": "Show, Attend and Tell: Neural Image Caption Generation with Visual Attention"}, {"paperId": "cea967b59209c6be22829699f05b8b1ac4dc092d", "title": "Sequence to Sequence Learning with Neural Networks"}, {"paperId": "5d833331b0e22ff359db05c62a8bca18c4f04b68", "title": "One billion word benchmark for measuring progress in statistical language modeling"}, {"paperId": "687bac2d3320083eb4530bf18bb8f8f721477600", "title": "Recursive Deep Models for Semantic Compositionality Over a Sentiment Treebank"}, {"paperId": "1c61f9ef06fe74505775a833ff849185757199e7", "title": "Learning Word Vectors for Sentiment Analysis"}, {"paperId": "37fa065905442974682e4aca19c8108075d4de44", "title": "Ranking via Sinkhorn Propagation"}, {"paperId": "441f33fab0614fa0696be54a046cbc692b7e70a2", "title": "A Relationship Between Arbitrary Positive Matrices and Doubly Stochastic Matrices"}, {"paperId": null, "title": "Sparse Sinkhorn Attention"}]}