{"paperId": "37ba9c33025fb31f25436010e12c65a0bafc0e1f", "abstract": "Dynamic evaluation of language models (LMs) adapts model parameters at test time using gradient information from previous tokens and substantially improves LM performance. However, it requires over 3x more compute than standard inference. We present Fast Weight Layers (FWLs), a neural component that provides the benefits of dynamic evaluation much more efficiently by expressing gradient updates as linear attention. A key improvement over dynamic evaluation is that FWLs can also be applied at training time, so the model learns to make good use of gradient updates. FWLs can easily be added on top of existing transformer models, require relatively little extra compute or memory to run, and significantly improve language modeling perplexity.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2022, "citationCount": 7, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://arxiv.org/pdf/2212.02475", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "Fast Weight Layers are presented, a neural component that provides the benefits of dynamic evaluation much more efficiently by expressing gradient updates as linear attention and can also be applied at training time, so the model learns to make good use of gradient updates."}, "embedding": {"model": "specter_v2", "vector": [-0.10433878004550934, 0.5335285663604736, -0.45819973945617676, -0.1927054077386856, -0.24673186242580414, 0.021295564249157906, 0.9911439418792725, -0.436583548784256, -0.8310147523880005, -0.3930881917476654, 0.5880544185638428, -0.031198738142848015, 0.36094263195991516, 0.022076264023780823, -0.22383329272270203, 0.31331491470336914, -0.9284114837646484, 0.48443901538848877, 0.052698321640491486, -0.19378620386123657, -0.36109116673469543, -0.8207807540893555, -0.8053414821624756, 0.1650160253047943, -0.05631750077009201, 0.1016145870089531, 0.5388038754463196, 1.1152335405349731, -0.763007402420044, 0.11154161393642426, 0.5065909624099731, -0.44956159591674805, 0.12566684186458588, -0.0688905194401741, -0.1640082448720932, -0.3250333368778229, 0.004264707211405039, -0.5671621561050415, -0.25693097710609436, 0.8892423510551453, -0.13228677213191986, 0.16254451870918274, 0.14227044582366943, -0.6371372938156128, -0.1357114315032959, 1.2795263528823853, 0.5469579100608826, 0.8784114122390747, -0.26995524764060974, -0.613815426826477, 1.4255948066711426, -1.5731011629104614, 0.5341189503669739, 1.930190086364746, 0.3743721842765808, 0.6662969589233398, -0.09198462963104248, -0.6755163073539734, 1.3897041082382202, 0.20017102360725403, -0.8656240105628967, -0.3435198962688446, -0.04469207674264908, 0.31314995884895325, 2.056281089782715, -0.5736602544784546, 0.2626557946205139, 0.5426118969917297, -0.5239661931991577, 1.6031630039215088, -0.49722686409950256, -0.835913896560669, -0.7994560599327087, 0.30294063687324524, 0.050033845007419586, 0.9926673769950867, -0.43498653173446655, 0.32262393832206726, -0.878890335559845, -0.006959138438105583, 0.058695171028375626, -0.23123842477798462, -0.09618254005908966, -0.06517501920461655, -0.526186466217041, 0.5501788258552551, 0.12926389276981354, 0.6664471626281738, -0.059649258852005005, 0.8658133745193481, 0.5126695036888123, 0.40967702865600586, 0.19286303222179413, 0.07117749750614166, -0.2085580825805664, -0.005566662177443504, -0.8404859304428101, 0.2659602165222168, -0.09442412108182907, 0.4896397590637207, -0.24782630801200867, 0.4438747763633728, -0.7653127312660217, 0.5084227323532104, 1.712287187576294, 0.33893153071403503, 0.6116190552711487, -0.6756176948547363, 0.43942680954933167, -0.8956897854804993, -0.11218006163835526, -0.3773796856403351, -0.22978168725967407, -0.373274564743042, -0.4436289072036743, -1.2167704105377197, -0.5233385562896729, 0.34116697311401367, -0.6583201885223389, 1.2733166217803955, -0.02697763219475746, 0.12653443217277527, -0.22252579033374786, 0.24630020558834076, 0.26532113552093506, 1.0632073879241943, 0.45360082387924194, 0.17792779207229614, 0.5985892415046692, -0.8991343379020691, -0.7621796131134033, -0.8039670586585999, 0.715072751045227, -0.12922395765781403, 0.48959216475486755, 0.07085012644529343, -1.453753113746643, -1.0732240676879883, -0.8823655843734741, 0.09201490879058838, -0.5015813708305359, 0.036563776433467865, 0.9508417248725891, 0.4122619032859802, -0.9836397767066956, 0.991388201713562, -0.5458379983901978, 0.028121894225478172, 0.1178722083568573, 0.2936915159225464, 0.44276705384254456, -0.3681061565876007, -1.4070433378219604, 0.39423301815986633, 0.3548339009284973, -0.5329843759536743, 0.03535877540707588, -0.8534374237060547, -1.023857593536377, -0.24156412482261658, 0.1084877997636795, -0.6074751615524292, 1.5836788415908813, -0.251545786857605, -1.8343058824539185, 0.6632484197616577, -0.5525349378585815, 0.1976059079170227, 0.3105972409248352, -0.31141963601112366, -1.0416333675384521, -0.36904072761535645, -0.6131211519241333, 0.7584099173545837, 0.5053011178970337, 0.0867537409067154, -0.6444581151008606, 0.2537735402584076, -0.3567890226840973, -0.11248282343149185, -0.6092198491096497, 1.0019714832305908, -0.5821729898452759, -0.04883183166384697, 0.05152258276939392, 0.8284233212471008, 0.22532644867897034, -0.20148731768131256, -0.2707153558731079, -1.242591381072998, 0.826885998249054, -0.07397590577602386, 1.1915720701217651, -0.7971528172492981, -0.49139752984046936, -0.01985977403819561, -0.008360670879483223, 0.2627400755882263, -1.1478548049926758, 0.3419950008392334, -0.36469385027885437, 0.3597237467765808, 0.18531183898448944, -1.3502885103225708, 0.26099157333374023, -0.3798011541366577, -0.26496952772140503, -0.29745590686798096, 0.3364810347557068, 1.124683141708374, -1.0911325216293335, -0.07103946059942245, 0.017740152776241302, 0.48155301809310913, -0.772283673286438, 1.093468189239502, -0.13820543885231018, -0.16922825574874878, -0.025148887187242508, -0.39221659302711487, 0.028425762429833412, 0.006444354075938463, 0.4374788999557495, -0.39272913336753845, -0.3970458507537842, 0.8220276236534119, -0.6594762206077576, 1.1906676292419434, -0.6147515773773193, 0.5324616432189941, -0.01186889223754406, -0.45682060718536377, -0.1540871560573578, 0.35869699716567993, -0.2896866500377655, -0.47752466797828674, 0.20437179505825043, 0.3803270161151886, -0.3835449516773224, 0.43892085552215576, 0.6102443337440491, 0.6687659025192261, 0.05217207595705986, 0.19615140557289124, 0.748525083065033, -0.03613051772117615, 0.82258141040802, 0.31045377254486084, 0.4515816271305084, 0.605670154094696, 0.20769953727722168, 0.004835717845708132, 0.32924380898475647, -0.8848612904548645, 0.08447064459323883, 0.2732619345188141, 0.6561920642852783, 0.5525186657905579, 0.25957566499710083, -0.5850909352302551, -0.511475145816803, -0.3379378616809845, 0.6793062686920166, 1.386254072189331, -0.5381607413291931, -0.1910068243741989, -0.5263556838035583, -0.04849409684538841, -0.24309042096138, 0.416537880897522, -0.12519603967666626, -0.3311740458011627, -0.9909855127334595, -1.12969172000885, 0.7809725403785706, 0.17431986331939697, 0.8337569236755371, -0.2248179167509079, 0.05115990713238716, -0.04758349433541298, 0.3240472376346588, -0.5673086047172546, -0.6490339040756226, 0.08596067130565643, -0.8054544925689697, -0.032296322286129, -0.0840696468949318, 0.19674356281757355, 0.05975739285349846, -0.6502122282981873, 0.910571813583374, -0.4146948456764221, -0.19007526338100433, -0.0055639068596065044, 0.7685338854789734, -0.6880331635475159, -0.949504554271698, 0.3753319978713989, 0.503997266292572, 0.019986743107438087, 0.06686412543058395, 0.6825403571128845, -0.04020007327198982, 0.09480945020914078, -0.27004966139793396, 0.5618964433670044, -0.21651361882686615, 0.17755325138568878, 0.44715937972068787, -0.5030124187469482, -0.12912380695343018, -1.5828605890274048, 0.684377133846283, 0.30000391602516174, -0.6719415783882141, 0.43105214834213257, -0.8854770064353943, -0.1763862669467926, 0.286116361618042, -0.8237139582633972, -0.5929919481277466, -1.1612589359283447, -0.021837446838617325, -0.13890700042247772, 0.30005526542663574, 0.14505629241466522, 0.20976030826568604, 0.4914489984512329, -0.06967772543430328, -0.062207624316215515, 0.21187500655651093, -0.24130196869373322, 0.6368745565414429, -0.8776257038116455, 0.5652849078178406, 0.15771466493606567, 0.4527689218521118, -0.16222438216209412, -0.4162929058074951, -0.460004597902298, -0.36513546109199524, -0.48640933632850647, -0.06130892410874367, -0.4238044321537018, -0.07330228388309479, -0.5271050930023193, -0.9689107537269592, 0.05345788970589638, -0.9525189995765686, -0.42879077792167664, 0.181410014629364, -0.057900771498680115, 0.2577582895755768, -1.0406655073165894, -1.2979899644851685, -0.6454259157180786, -0.6489110589027405, -0.7069569230079651, 0.12192454189062119, -0.03499944508075714, -0.4259833097457886, -0.8150511384010315, 0.04389436915516853, -0.7261432409286499, 1.253592610359192, -0.9953154921531677, 1.0093460083007812, 0.5303952097892761, -0.13602934777736664, -0.3933187425136566, 0.5030463933944702, 0.6213314533233643, -0.7071623206138611, 0.6895014047622681, -0.804443895816803, 0.18093876540660858, -0.7972121834754944, -0.024271180853247643, 0.36750319600105286, 0.5235128998756409, 0.6112232804298401, 0.2386077642440796, -0.6086523532867432, 0.473166823387146, 1.1230568885803223, -0.7942124605178833, -0.09306181222200394, 0.22117647528648376, 1.0020148754119873, 0.12070285528898239, -0.5779827237129211, 0.30319246649742126, 0.512599527835846, 0.5416767001152039, -0.045567214488983154, -0.39264118671417236, -0.3775445818901062, -0.7064870595932007, 0.9889883399009705, 1.8434916734695435, 0.185036763548851, -0.24383075535297394, -0.7670540809631348, 0.48268380761146545, -1.1101659536361694, -0.7660113573074341, 0.47426214814186096, 0.9013663530349731, 0.4246252179145813, -0.15937793254852295, -0.23128171265125275, -0.15929539501667023, 0.7093527317047119, 0.2617602050304413, -0.3654617965221405, -0.9438440203666687, -0.21401330828666687, 0.39162030816078186, 0.24862000346183777, 0.889057993888855, 0.022844457998871803, 0.9609200358390808, 14.508498191833496, 0.6183463335037231, -0.08924747258424759, 0.961546778678894, 0.478045254945755, -0.26890966296195984, -0.7191317081451416, -0.1658986359834671, -1.5419107675552368, -0.36397483944892883, 1.3968762159347534, 0.03696838393807411, 0.7448800802230835, -0.1218196451663971, 0.3590572476387024, 0.30929967761039734, -0.4263557195663452, 0.6848269104957581, 0.531290590763092, -1.0935245752334595, 0.32109203934669495, 0.07985485345125198, 0.18304933607578278, 1.0855897665023804, 0.7219875454902649, 1.0081655979156494, 0.5974422097206116, 0.004841517191380262, 0.7159817218780518, 0.5559754967689514, 0.8452468514442444, -0.10508137196302414, 0.18135283887386322, 0.28589195013046265, -0.670426607131958, -0.34911826252937317, -0.492607980966568, -1.0193806886672974, 0.630586564540863, 0.37286508083343506, -0.4362342655658722, -0.8143706917762756, -0.22514201700687408, 0.6331489682197571, 0.2901887893676758, 0.3479205369949341, -0.38276898860931396, 1.0950407981872559, -0.5626869797706604, 0.01808188483119011, 0.262541264295578, 0.5735746622085571, 0.23870106041431427, 0.24093611538410187, 0.11076352000236511, -0.358591228723526, -0.06892867386341095, 0.6270591020584106, -0.6144742369651794, -0.22257263958454132, 0.08838704973459244, -0.375594824552536, -0.06892049312591553, 0.8273462653160095, 0.7459099292755127, -0.05228114128112793, -0.3964669406414032, 0.4276089072227478, 0.7397997975349426, 0.16950170695781708, -0.12098201364278793, 0.055173277854919434, 0.7330226898193359, -0.36559340357780457, -0.23490533232688904, 0.3018074929714203, 0.5549875497817993, -0.5353123545646667, -0.9485530853271484, 0.12544886767864227, 0.4927537143230438, -0.7795857191085815, -0.5128081440925598, 0.6714152693748474, 0.024088693782687187, -0.02647549845278263, -0.1115853488445282, -1.0200096368789673, -0.3176673650741577, 0.4802683889865875, -1.9845448732376099, -0.3781120181083679, 0.6578933596611023, -0.3148629367351532, -0.3548666834831238, 0.0916498452425003, 1.3060219287872314, 0.25658175349235535, -0.5265565514564514, 0.34795674681663513, 0.19665440917015076, -0.034981898963451385, -0.3111889660358429, -0.6638597846031189, 1.0334703922271729, 0.2222091108560562, 0.1967465579509735, 0.263437420129776, -0.25860971212387085, 0.20925848186016083, -0.8422408699989319, 0.27243572473526, 1.1686830520629883, -0.6833391785621643, -0.37800154089927673, -0.8243216276168823, -0.6698182821273804, -0.04853154718875885, 0.3908168375492096, -0.24874995648860931, 0.2519494593143463, 0.5539098978042603, -0.6791325807571411, -0.2632756233215332, -0.5178517699241638, 0.2162136435508728, 0.5885823965072632, -0.5536211133003235, -0.03845922276377678, -0.12093683332204819, 0.373913437128067, -0.9684150815010071, -0.11857324093580246, -0.2749982476234436, 0.05823703110218048, 0.39656633138656616, 1.0927165746688843, -0.5114678740501404, 0.31798017024993896, 0.6341773867607117, 0.21875998377799988, -0.8258336186408997, -0.301803857088089, -0.9095883369445801, -0.14075711369514465, 0.2803994119167328, 0.9245302081108093, -0.0410316176712513, -0.2586705982685089, 0.6227353811264038, 0.17016330361366272, -0.343909353017807, -0.6260544061660767, -0.42871466279029846, -0.06514090299606323, -1.0437575578689575, 0.3947690725326538, -0.19682902097702026, -0.15259552001953125, -0.02020755223929882, 0.5169987082481384, 0.4923557639122009, -0.3867464065551758, -1.134260892868042, 0.14854814112186432, 0.04921220242977142, -0.12284684926271439, -0.9313420057296753, -0.5428913235664368, -1.1815252304077148, 0.1728636473417282, -1.3229602575302124, -0.3375442922115326, -1.219722867012024, -0.47660720348358154, 0.1455845981836319, -0.6000289916992188, 0.18326549232006073, 0.13117185235023499, -0.28281447291374207, -0.4342508912086487, -0.6199892163276672, -0.7063034176826477, 0.7106920480728149, 0.7711164951324463, -0.810633659362793, 0.12695755064487457, 0.006004711147397757, 0.47156140208244324, 0.276074081659317, 0.3928299844264984, -0.4070267379283905, -0.6144336462020874, -1.9114328622817993, 0.8586882948875427, -0.4375621974468231, -0.21028299629688263, -0.6093376278877258, 0.4747835695743561, 0.4686163365840912, 0.0138291260227561, 0.1733798384666443, 0.24772334098815918, -0.32292693853378296, -0.5804553031921387, 0.349909245967865, -0.6614871621131897, 0.5873759388923645, 0.2823197841644287, -0.6754651069641113, -0.21198545396327972, 0.6952177286148071, -0.03501461446285248, -1.2398033142089844, -0.853657066822052, 0.5194917917251587, -0.7350707650184631, 0.09138012677431107, -0.8197284936904907, -0.26445284485816956, -0.5148633122444153, -0.29775547981262207, 0.37813788652420044, 0.4753228724002838, -0.6253119111061096, 1.2014760971069336, 0.30596357583999634, -1.0961464643478394, -0.09611880779266357, 0.42799562215805054, 0.04931509122252464, -0.35629478096961975, 0.30295029282569885, 0.2473074495792389, -0.15115231275558472, 0.4247012436389923, 0.48595917224884033, 0.31871551275253296, -0.8568984866142273, -0.32294365763664246, 0.9618327617645264, -0.4011678993701935, -0.4333193600177765, 1.524531364440918, -0.5989041924476624, -1.1642576456069946, 0.22846698760986328, -1.22428560256958, -0.2725955843925476, -0.5049001574516296, 0.8820314407348633, 0.14937348663806915, -0.08832785487174988, 0.10308269411325455, -0.3548489511013031, 0.18883776664733887, -0.05919712781906128, -0.9664701223373413, 0.677544116973877, -0.30044400691986084, -0.434934139251709, 0.9675465822219849, 0.8827576041221619, -0.8296013474464417, -0.6844600439071655, -0.8980470299720764, -0.3035561144351959, 0.03460954502224922, 0.6987850069999695, -0.4503958225250244, -0.6869328618049622, 1.0470325946807861, 0.8393911123275757, -0.25094109773635864, -0.09579054266214371, -0.32115036249160767, 0.2734127640724182, 0.6426658630371094, 0.013793625868856907, -1.2625311613082886, -0.9147787094116211, 1.4025790691375732, 0.8111668229103088, -0.7413829565048218, -0.022975269705057144, 0.18234139680862427, -0.36586835980415344, 1.0074259042739868, -0.05831969529390335, 0.3048335313796997, 0.9605817198753357, -0.038184281438589096, 0.31419479846954346, 0.5197910070419312, -1.117488980293274, -0.3713100254535675, 0.7705630660057068, 0.7503882050514221, 1.0138126611709595, 0.4091070592403412, 0.1456822156906128, 0.7416366934776306, 0.21201425790786743, 0.0871618315577507, -0.0027107212226837873, 0.20711182057857513, -0.08629968762397766, -0.6698178648948669, 0.15064990520477295, 0.4375808537006378, -0.5935895442962646, -0.7413487434387207, 0.2659389078617096, 0.5491245985031128, 0.31864744424819946, 0.4533592164516449, 0.785699725151062, 0.2599714696407318, 0.6410587430000305, 0.5767909288406372, 0.6769989728927612, -0.37011104822158813, -0.2560083866119385, -0.07673387974500656, -0.36661550402641296, -0.20740537345409393, 0.008650361560285091, -0.6107856035232544, -0.6409002542495728, -0.43649911880493164, 0.11730736494064331, -0.18617895245552063, 0.7186164855957031, 1.141555905342102, 0.3166103661060333, 0.582237184047699, -0.3298121690750122, -0.3973727226257324, -0.26680687069892883, -1.0683400630950928, 0.13848911225795746, -0.41237175464630127, -0.39277297258377075, -0.26648572087287903, 0.020117387175559998, -0.5188515782356262]}, "authors": [{"authorId": "144358401", "name": "Kevin Clark"}, {"authorId": "2091768", "name": "Kelvin Guu"}, {"authorId": "1744179", "name": "Ming-Wei Chang"}, {"authorId": "2616463", "name": "Panupong Pasupat"}, {"authorId": "1695689", "name": "Geoffrey E. Hinton"}, {"authorId": "144739074", "name": "Mohammad Norouzi"}], "references": [{"paperId": "dc0102a51a9d33e104a4a3808a18cf17f057228c", "title": "Transformer Quality in Linear Time"}, {"paperId": "b7e94220176d9d329ee064fd4359229bf92ef360", "title": "Reconsidering the Past: Optimizing Hidden States in Language Models"}, {"paperId": "9286ac6e9b1aacd7d93496eb4615ae7678876d2a", "title": "Fast Model Editing at Scale"}, {"paperId": "86589b6286ef3c55b8b4fccfb41a3b30b7afdf61", "title": "Going Beyond Linear Transformers with Recurrent Fast Weight Programmers"}, {"paperId": "1a703f08da01cf737cce3fb9064259b3f4b44e9c", "title": "Linear Transformers Are Secretly Fast Weight Programmers"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "657329c633709dd1ac34a30d57341b186b1a47c2", "title": "Efficient Content-Based Sparse Attention with Routing Transformers"}, {"paperId": "7be8c119dbe065c52125ee7716601751f3116844", "title": "Generalization through Memorization: Nearest Neighbor Language Models"}, {"paperId": "abf5478c24664a1380b7e213a3ab1c4af54775d0", "title": "Rapid Learning or Feature Reuse? Towards Understanding the Effectiveness of MAML"}, {"paperId": "a513bb6e1967f5a31ad4f38954e66d4169b613e5", "title": "Metalearned Neural Memory"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "cf4aa38ae31b43fd07abe13b4ffdb265babb7be1", "title": "The Curious Case of Neural Text Degeneration"}, {"paperId": "cd63025532a62fa245a02ec05e32ac4d23089631", "title": "Dynamic Evaluation of Transformer Language Models"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "fa9decd1395cc2f39e9921f870ebc8a8ec2bd08d", "title": "Dynamic Evaluation of Neural Sequence Models"}, {"paperId": "c889d6f98e6d79b89c3a6adf8a921f88fa6ba518", "title": "Model-Agnostic Meta-Learning for Fast Adaptation of Deep Networks"}, {"paperId": "470d11b8ca4586c930adbbfc3f60bff08f2a0161", "title": "Meta Networks"}, {"paperId": "c91ae35dbcb6d479580ecd235eabf98374acdb55", "title": "Using Fast Weights to Attend to the Recent Past"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "9ec499af9b85f30bdbdd6cdfbb07d484808c526a", "title": "Efficient softmax approximation for GPUs"}, {"paperId": "97fb4e3d45bb098e27e0071448b6152217bd35a5", "title": "Layer Normalization"}, {"paperId": "bc22e87a26d020215afe91c751e5bdaddd8e4922", "title": "Learning to Control Fast-Weight Memories: An Alternative to Dynamic Recurrent Networks"}, {"paperId": "9819b600a828a57e1cde047bbe710d3446b30da5", "title": "Recurrent neural network based language model"}, {"paperId": "7257eacd80458e70c74494eb1b6759b52ff21399", "title": "Using fast weights to deblur old memories"}]}