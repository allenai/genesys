{"paperId": "746255191880bec30f0b8d0a824d28b1cec7f3f9", "abstract": "Pruning large language models (LLMs) from the BERT family has emerged as a standard compression benchmark, and several pruning methods have been proposed for this task. The recent ``Sparsity May Cry'' (SMC) benchmark put into question the validity of all existing methods, exhibiting a more complex setup where many known pruning methods appear to fail. We revisit the question of accurate BERT-pruning during fine-tuning on downstream datasets, and propose a set of general guidelines for successful pruning, even on the challenging SMC benchmark. First, we perform a cost-vs-benefits analysis of pruning model components, such as the embeddings and the classification head; second, we provide a simple-yet-general way of scaling training, sparsification and learning rate schedules relative to the desired target sparsity; finally, we investigate the importance of proper parametrization for Knowledge Distillation in the context of LLMs. Our simple insights lead to state-of-the-art results, both on classic BERT-pruning benchmarks, as well as on the SMC benchmark, showing that even classic gradual magnitude pruning (GMP) can yield competitive results, with the right approach.", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work revisits the question of accurate BERT-pruning during fine-tuning on downstream datasets, and proposes a set of general guidelines for successful pruning, even on the challenging SMC benchmark."}, "embedding": {"model": "specter_v2", "vector": [0.3198477625846863, 0.8475616574287415, -0.7528689503669739, 0.2850607931613922, -0.5245350003242493, 0.1032600998878479, 0.5086381435394287, -0.18618141114711761, -0.49121323227882385, -0.20841291546821594, 0.571596086025238, -0.3486429452896118, 0.051189642399549484, 0.2441037893295288, -0.001560050412081182, 0.12667414546012878, -0.6136358976364136, 0.35876601934432983, -0.18145814538002014, -0.30075687170028687, -0.29023900628089905, -0.7739288806915283, -0.950834333896637, -0.10053081065416336, 0.517272412776947, 0.8929418325424194, -0.04339897632598877, 0.7447273135185242, -0.4959401488304138, 0.4044254422187805, 0.5583871006965637, -0.5327212810516357, 0.3862312138080597, 0.0444444939494133, -0.12630081176757812, -0.08928675949573517, 0.2966495156288147, -0.3485540747642517, -0.6749093532562256, 0.560888946056366, -0.31244194507598877, 0.36224523186683655, 0.40354403853416443, -0.4906480610370636, -0.36612147092819214, 0.8250980973243713, 0.43162521719932556, 0.5784602165222168, -0.5056915879249573, -0.5522274374961853, 1.2841615676879883, -1.471333622932434, 0.37492498755455017, 1.4414644241333008, 0.6833279132843018, 0.33866584300994873, -0.3306226134300232, -0.6756547093391418, 0.6420542001724243, 0.15164721012115479, -1.1805208921432495, -0.6066924333572388, -0.16176776587963104, 0.2913493812084198, 1.9162322282791138, -0.10559497028589249, -0.22471724450588226, 0.37286368012428284, -0.6699128746986389, 1.4288772344589233, -0.08458151668310165, -0.7977433800697327, -0.2095281183719635, 0.25938788056373596, 0.20554205775260925, 0.6930825710296631, -0.2218838930130005, 0.40757715702056885, -0.7926028966903687, -0.4132104516029358, -0.28039833903312683, -0.2780173420906067, -0.2259763777256012, -0.061237361282110214, 0.43434473872184753, 0.847638726234436, 0.09219104051589966, 0.8105906844139099, 0.20902594923973083, 0.9384927749633789, 0.6266645193099976, 0.5301251411437988, 0.4520278573036194, 0.4136165678501129, -0.2950369417667389, 0.3152793049812317, -1.231701374053955, 0.18748924136161804, 0.424953430891037, 0.8846655488014221, -0.4128786623477936, 0.3514993488788605, -0.7477105855941772, 0.4286314845085144, 1.2199692726135254, -0.14727018773555756, 0.5954413414001465, -0.9530524611473083, 0.4195316433906555, -0.973244309425354, -0.2890962064266205, -0.5496939420700073, 0.14739197492599487, -0.5014925003051758, -0.9124586582183838, -1.5214757919311523, -0.7817097902297974, 0.13286498188972473, -0.7422392964363098, 0.7957020998001099, -0.5198784470558167, 0.4890348017215729, -0.0012365644797682762, 0.3912653923034668, 0.7989478707313538, 0.758406937122345, 0.4236607253551483, -0.25351935625076294, 0.8070796132087708, -0.9295023679733276, -0.4751124978065491, -1.0448490381240845, 1.1772023439407349, -0.2457459717988968, 0.1350179761648178, -0.10211603343486786, -1.2986712455749512, -0.8294214010238647, -0.8715303540229797, -0.2817367613315582, -0.473634272813797, 0.4960668683052063, 0.8535430431365967, 0.7110690474510193, -0.785871684551239, 0.6571784019470215, -0.1792731136083603, 0.03227362409234047, 0.7393321990966797, 0.11398711055517197, 0.11896716803312302, -0.706154465675354, -1.1527825593948364, 0.5748765468597412, 0.4289962649345398, -0.9215518236160278, -0.10516031831502914, -0.7671189904212952, -1.1478893756866455, 0.3289179801940918, 0.49391862750053406, -0.6044142246246338, 1.0004819631576538, 0.1431073695421219, -1.331763744354248, 0.6503638029098511, -0.3138442039489746, -0.21356458961963654, 0.3940059244632721, -0.24056391417980194, -0.5152430534362793, -0.43424344062805176, -0.5585678219795227, 0.6798518300056458, 0.566845715045929, -0.37602683901786804, 0.0765065848827362, 0.7183719277381897, -0.41536521911621094, 0.11438404768705368, -0.1701250970363617, 0.759057343006134, -0.41996943950653076, -0.44238516688346863, 0.4134501516819, 0.5951995253562927, -0.15918566286563873, -0.0902475044131279, -0.41583767533302307, -0.924468457698822, 0.9156689643859863, -0.158849835395813, 1.2902110815048218, -1.1211392879486084, -0.5377158522605896, 0.008951024152338505, -0.09684553742408752, 0.11377587914466858, -1.0008504390716553, 0.33730241656303406, -0.11492699384689331, 0.8195134401321411, -0.44761744141578674, -1.7362536191940308, 0.27292343974113464, 0.05031602084636688, -0.9236794710159302, -0.24772821366786957, 0.199728325009346, 0.9185917377471924, -0.46495747566223145, 0.018165232613682747, -0.12833479046821594, 0.4761698246002197, -1.4915803670883179, 0.8520737886428833, -0.6688879132270813, -0.24112363159656525, 0.3500756621360779, 0.002762532327324152, 0.08087819069623947, -0.11289464682340622, 0.38510632514953613, -0.05357629060745239, 0.22181886434555054, 0.6550402045249939, -0.45540735125541687, 1.2036272287368774, -0.5132113695144653, 0.33836469054222107, 0.0772419273853302, -0.6571641564369202, 0.13083064556121826, 0.4015607535839081, -0.30375221371650696, -0.14741827547550201, 0.2785649299621582, 0.9839176535606384, -0.5326042771339417, 0.4489133656024933, 0.7957455515861511, 0.42039310932159424, -0.23279164731502533, -0.04745716229081154, 0.7344565391540527, -0.5362040400505066, 0.660624623298645, 0.5206413865089417, 0.7564259767532349, 0.03096630424261093, 0.3706495463848114, 0.3390312194824219, 0.3785778880119324, -0.8877838850021362, -0.11845427006483078, 0.7090417742729187, 0.9765187501907349, 0.8779901266098022, 0.2904897928237915, -0.39864715933799744, -0.5323516130447388, 0.21407288312911987, 0.5378086566925049, 1.5522974729537964, -0.3600713312625885, -0.5265482068061829, -0.2682523727416992, -0.27733495831489563, -0.021149074658751488, 0.35605695843696594, -0.14995038509368896, -0.37119439244270325, -0.6483275294303894, -1.1158782243728638, 0.7252486944198608, -0.16119284927845, 0.8033981323242188, -0.2545854449272156, 0.0635109469294548, -0.582582950592041, 0.3079981207847595, -0.8828837275505066, -0.19477984309196472, 0.5421539545059204, -0.5638165473937988, -0.1152103990316391, 0.039458490908145905, 0.1010802760720253, -0.06572648137807846, -0.5031687617301941, 0.7893266081809998, 0.0424828827381134, -0.32394498586654663, 0.14904096722602844, 0.2001231163740158, -0.39803457260131836, -0.973804235458374, 0.470818430185318, 0.04289153218269348, -0.6537211537361145, 0.1858270913362503, 0.22418026626110077, 0.2526600956916809, -0.36323532462120056, -0.48005741834640503, -0.03492585942149162, 0.10207150876522064, 0.09838178008794785, 0.7833053469657898, -0.035111021250486374, -0.03585851565003395, -1.1516550779342651, 0.9624255299568176, -0.3440667986869812, -0.2179574966430664, 0.2627321779727936, -0.723140299320221, -0.5374374985694885, 0.4828568696975708, -0.703700602054596, -0.013628775253891945, -0.9985992908477783, 0.03944651782512665, -0.6849321126937866, -0.12800611555576324, 0.3259810209274292, 0.5973988175392151, 0.12180852144956589, 0.1789865493774414, 0.6285973191261292, 0.28237384557724, -0.5743820667266846, 0.9423412084579468, -0.9773662686347961, 0.38250672817230225, 0.2897424101829529, 0.23179396986961365, -0.2138732224702835, -0.10360141843557358, -0.7405239343643188, -0.5129277110099792, -0.39626726508140564, -0.04569367691874504, 0.19680681824684143, -0.1995834857225418, -0.6865473985671997, -0.1870070993900299, -0.544568657875061, -0.9800126552581787, -0.045623261481523514, -0.3665059208869934, -0.4259297251701355, -0.3998107612133026, -0.8592946529388428, -1.3471050262451172, -0.6824251413345337, -0.68119877576828, -0.9495060443878174, 0.5907971262931824, -0.31008461117744446, -0.5130231976509094, -0.42505350708961487, -0.05496566370129585, -0.17487689852714539, 1.162519097328186, -1.0145063400268555, 1.0037463903427124, -0.5246632099151611, -0.1621013730764389, -0.14294058084487915, 0.01990598626434803, 0.7523209452629089, -0.7664783596992493, 0.29133835434913635, -0.9461836218833923, 0.07473833113908768, -0.11551561206579208, -0.4582870304584503, 0.7278481125831604, 0.2315560132265091, 0.9010104537010193, -0.557364284992218, -0.5867857336997986, 0.6695218086242676, 1.2906866073608398, -0.8361772298812866, 0.22778302431106567, -0.03204214945435524, 0.7097694873809814, -0.11593944579362869, -0.5770271420478821, 0.6874732971191406, 0.05459582805633545, 0.26752740144729614, 0.08067882061004639, 0.24898844957351685, -0.5024425983428955, -0.6763817667961121, 0.5475188493728638, 2.207292079925537, 0.5265803933143616, -0.06418226659297943, -0.7439792156219482, 0.27250659465789795, -1.010061502456665, -0.6720544099807739, 0.6803361177444458, 0.6663691401481628, 0.7119214534759521, -0.37267741560935974, -0.35333386063575745, 0.23992368578910828, -0.13406488299369812, 0.5281850099563599, -0.15342023968696594, -0.7765905261039734, -0.23440943658351898, 0.8014617562294006, 0.221857488155365, 0.5574425458908081, -0.4629709720611572, 0.5665330290794373, 14.714526176452637, 1.4601287841796875, 0.25514569878578186, 1.0340479612350464, 1.0061421394348145, -0.21289943158626556, -0.46156713366508484, -0.22719664871692657, -1.2723978757858276, 0.19944922626018524, 1.0744091272354126, 0.26317861676216125, 0.7269097566604614, 0.4780327081680298, -0.27922865748405457, 0.1137615516781807, -0.17952615022659302, 0.6367819309234619, 0.5476804375648499, -1.555644154548645, 0.4445180594921112, 0.12111953645944595, 0.662031888961792, 0.5202852487564087, 0.787787914276123, 1.3097339868545532, 0.2253512442111969, -0.7471386194229126, 0.4735914468765259, 0.061835531145334244, 1.0862805843353271, 0.03268185630440712, 0.3854774534702301, 0.7273534536361694, -0.6948423385620117, -0.5760154128074646, -0.5869872570037842, -1.1409786939620972, 0.4097963869571686, 0.3491642475128174, -0.4300280511379242, -0.692886471748352, -0.6999636888504028, 0.5007179379463196, -0.07309997081756592, 0.3296484649181366, 0.0356164388358593, 0.9174076914787292, -0.7571598887443542, 0.2964034676551819, 0.36211973428726196, 0.5116069912910461, 0.3926823139190674, 0.2769796848297119, 0.4079735279083252, 0.005606239195913076, 0.06356852501630783, 0.49382340908050537, -0.7854848504066467, 0.03535831719636917, -0.4199661612510681, -0.41023924946784973, 0.0918903648853302, 0.35867956280708313, 0.6832048892974854, -0.007031405344605446, -0.333906352519989, 0.08088134974241257, 0.8079615831375122, 0.1975173056125641, -0.18438288569450378, 0.23403045535087585, 0.2614067494869232, -0.3916643261909485, 0.09163868427276611, 0.6042952537536621, -0.40556710958480835, -0.5935860872268677, -0.6006364822387695, -0.656674861907959, 0.3814805746078491, -0.5192893743515015, -0.5814750790596008, 0.37373319268226624, -0.24166704714298248, -0.10578317940235138, 0.4165968596935272, -0.369304895401001, 0.10117626190185547, 0.22409988939762115, -1.519535779953003, -0.5664995908737183, 0.657569169998169, -0.6948040127754211, -0.23573893308639526, -0.19927623867988586, 1.1907870769500732, 0.3877291679382324, -0.26199430227279663, 0.40956780314445496, 0.4109966456890106, -0.3117101788520813, -0.6545256972312927, -0.3724299669265747, 0.6298195719718933, 0.09668519347906113, 0.12995028495788574, 0.20940187573432922, -0.15872520208358765, 0.30146554112434387, -0.5761421918869019, -0.19552665948867798, 0.9947481155395508, -0.5947023034095764, -0.374360591173172, -0.43032312393188477, -0.8142896890640259, 0.2528277039527893, 0.10184028744697571, -0.1311313807964325, 0.5413371920585632, 0.05365033075213432, -0.8546535968780518, 0.166551873087883, -0.8050281405448914, 0.04735434800386429, 0.8086071610450745, -0.9590957164764404, -0.29861149191856384, 0.3523789644241333, 0.5709831714630127, -0.9281390905380249, -0.35584303736686707, 0.26389381289482117, -0.08039753139019012, 0.08789733052253723, 1.0052076578140259, -0.39316076040267944, 1.0382741689682007, 0.9591729044914246, -0.5555151700973511, -0.6348657011985779, 0.13807018101215363, -0.936110258102417, -0.6575731039047241, -0.06331652402877808, 0.6338639855384827, -0.23058021068572998, 0.44059497117996216, 0.7374227046966553, 0.24829283356666565, -0.7611140608787537, -1.2038213014602661, -0.4328612685203552, 0.086885467171669, -0.5161844491958618, 0.00014961339184083045, -0.141337588429451, 0.1273754984140396, 0.0033523289021104574, 0.2642348110675812, 0.1261208951473236, -0.4868524670600891, -1.0513252019882202, 0.3082042634487152, 0.19567793607711792, -0.33163854479789734, -0.8926130533218384, -0.3290610909461975, -1.5658375024795532, 0.1381017565727234, -1.4369837045669556, -0.25562119483947754, -0.5120920538902283, -0.3161607086658478, -0.23893475532531738, -0.010022149421274662, -0.09801112115383148, 0.6245723366737366, -0.13745594024658203, -0.021553892642259598, -0.4855327010154724, -0.617250382900238, 1.0708787441253662, 0.6442818641662598, -0.7842264771461487, 0.2531677186489105, -0.11748006939888, 0.08226855844259262, 0.3760650157928467, 0.5584055781364441, -0.6016636490821838, -0.824878454208374, -1.2820936441421509, 0.3425576090812683, -0.2705928683280945, -0.25001978874206543, -0.7820082306861877, 0.5871357321739197, 0.4838183522224426, -0.47093647718429565, 0.44411978125572205, 0.6069730520248413, -1.1250983476638794, -0.2966374158859253, 0.45562711358070374, -0.8535645604133606, -0.10229365527629852, 0.11116430163383484, -0.4662235677242279, -0.41697561740875244, 0.19639889895915985, 0.244795024394989, -0.9892391562461853, -0.3989535868167877, 0.2624078094959259, -0.22831931710243225, 0.27062517404556274, -0.453460156917572, 0.008420444093644619, -1.2234963178634644, -0.3876020014286041, -0.2351611852645874, 0.08650586754083633, -0.42603960633277893, 0.8207743167877197, 0.3364681303501129, -1.178971529006958, 0.09073448926210403, 0.29832109808921814, -0.11677822470664978, 0.12041082233190536, 0.36389556527137756, 0.44244474172592163, -0.4296134114265442, 0.6650859713554382, 0.8612141013145447, 0.5560925602912903, -0.9090831875801086, -0.12876388430595398, 0.7399588823318481, -0.7279582023620605, -0.2106909304857254, 1.5066423416137695, -0.6271456480026245, -0.9708318114280701, 0.4456678628921509, -1.223486304283142, -0.15472498536109924, -0.4038601517677307, 0.46723130345344543, 0.5202630162239075, 0.070112444460392, -0.06444293260574341, -0.32070526480674744, -0.00939648225903511, 0.2665817141532898, -0.45299214124679565, 0.5134406089782715, -0.1465369015932083, -0.40618234872817993, 0.3070901930332184, 1.470674991607666, -0.5744292736053467, -0.3267926573753357, -0.8343875408172607, -0.18615101277828217, -0.31881454586982727, 0.2709679901599884, -0.3018726706504822, -0.6246300935745239, 0.7181575298309326, 0.167880117893219, 0.19384361803531647, -0.0532250851392746, -0.17243722081184387, 0.318615585565567, 0.8109787106513977, 0.06746464222669601, -0.7578045129776001, -0.6701711416244507, 1.6162139177322388, 1.3219681978225708, -1.1153244972229004, 0.8049635291099548, -0.23187680542469025, -0.5698807835578918, 0.4463006556034088, 0.01428189780563116, -0.12215053290128708, 1.204730749130249, -0.14526230096817017, -0.3798004984855652, 0.0921325832605362, -1.2113516330718994, -0.15160216391086578, 1.012150526046753, 0.7851781845092773, 0.7477759718894958, 0.2060675323009491, -0.12563185393810272, 0.9747019410133362, -0.15607474744319916, 0.021316982805728912, 0.14627546072006226, 0.3034929037094116, -0.3514089286327362, 0.14822576940059662, 0.18114124238491058, 0.9663392901420593, -0.7130395174026489, -0.9560576677322388, 0.1939072459936142, 0.6595141291618347, 0.6271536350250244, 0.38033121824264526, 0.5383356213569641, 0.025241734459996223, 0.1684975028038025, 0.5839207768440247, 0.4060956537723541, -0.6902946829795837, -0.17150679230690002, -0.24738997220993042, -0.2521856427192688, 0.26435136795043945, 0.016111938282847404, -0.3015095591545105, 0.05639202520251274, -0.3827406167984009, 0.1401316076517105, -0.17151635885238647, 0.2089458405971527, 1.0941442251205444, 0.787894606590271, 0.13100652396678925, -0.47541293501853943, -0.4361419677734375, -0.5710289478302002, -0.8045558333396912, -0.16481807827949524, -0.46280592679977417, -0.5792356133460999, -0.0851188451051712, -0.5011603832244873, -0.4646437466144562]}, "authors": [{"authorId": "40992614", "name": "Eldar Kurtic"}, {"authorId": "2258547286", "name": "Torsten Hoefler"}, {"authorId": "3311387", "name": "Dan Alistarh"}], "references": [{"paperId": "fdacdbc6a00eeb42efe7f81848b0bc09be5ca997", "title": "Sparsity May Cry: Let Us Fail (Current) Sparse Neural Networks Together!"}, {"paperId": "76d40153acfbb35a7eb8272a4215854cafa10e78", "title": "PLATON: Pruning Large Transformer Models with Upper Confidence Bound of Weight Importance"}, {"paperId": "6da9a81b75e7ad02867860753d1aa276673a3a77", "title": "The Optimal BERT Surgeon: Scalable and Accurate Second-Order Pruning for Large Language Models"}, {"paperId": "9202a718ce05395b6e17d5301e3a2e8b1021f31b", "title": "Prune Once for All: Sparse Pre-Trained Language Models"}, {"paperId": "01b1293ddea9bcd6df1185b0b934503de01d6561", "title": "Block Pruning For Faster Transformers"}, {"paperId": "cddf40e579a596d0110b260313adf43470617c4c", "title": "Datasets: A Community Library for Natural Language Processing"}, {"paperId": "40235eded15f44c8c4a7f48468adcc7df4e171fb", "title": "Rethinking Network Pruning \u2013 under the Pre-train and Fine-tune Paradigm"}, {"paperId": "9d6acac70b2d1fdb861a08b00766ef263109cd7f", "title": "Sparsity in Deep Learning: Pruning and growth for efficient inference and training in neural networks"}, {"paperId": "389036b1366b64579725457993c1f63a4f3370ba", "title": "The Lottery Ticket Hypothesis for Pre-trained BERT Networks"}, {"paperId": "deadba68c1c190be3974b6a66091e4182fae0f27", "title": "Inducing and Exploiting Activation Sparsity for Fast Inference on Deep Neural Networks"}, {"paperId": "66f0f35fc78bdf2af9de46093d49a428970cde2e", "title": "Movement Pruning: Adaptive Sparsity by Fine-Tuning"}, {"paperId": "3c8a456509e6c0805354bd40a35e3f2dbf8069b1", "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "3b4d671a8c7018c0b42673ba581e5ff3ae762d6c", "title": "To prune, or not to prune: exploring the efficacy of pruning for model compression"}, {"paperId": "5ded2b8c64491b4a67f6d39ce473d4b9347a672e", "title": "A Broad-Coverage Challenge Corpus for Sentence Understanding through Inference"}, {"paperId": "05dd7254b632376973f3a1b4d39485da17814df5", "title": "SQuAD: 100,000+ Questions for Machine Comprehension of Text"}, {"paperId": "642d0f49b7826adcf986616f4af77e736229990f", "title": "Deep Compression: Compressing Deep Neural Network with Pruning, Trained Quantization and Huffman Coding"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": "95382aab883166330fd4e8193132579e97444dbc", "title": "A simple and effective method for removal of hidden units and weights"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "92e121c6e114fe3cfb89370df03847c66a9b4e28", "title": "An Adversarial Winograd Schema Challenge at Scale"}, {"paperId": "c21a4d70d83e0f6eb2a9e1c41d034842dd561e47", "title": "CommonsenseQA: A Question Answering Challenge Targeting Commonsense Knowledge"}, {"paperId": null, "title": "First quora dataset release: Question pairs"}]}