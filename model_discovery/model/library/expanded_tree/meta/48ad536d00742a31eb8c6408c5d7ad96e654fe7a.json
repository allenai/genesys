{"paperId": "48ad536d00742a31eb8c6408c5d7ad96e654fe7a", "abstract": "Length extrapolation is a desirable property that permits training a transformer language model on short sequences and retaining similar perplexities when the model is tested on substantially longer sequences. A relative positional embedding mechanism applied on the transformer self-attention matrix, ALiBi, demonstrates the length extrapolation property with the widest usage to date. In this paper, we show that ALiBi surprisingly does not utilize tokens further than the training sequence length, which can be explained by its implicit windowed attention effect that aligns the receptive \ufb01eld during training and testing stages. Inspired by ALiBi and the receptive \ufb01led alignment hypothesis, we propose another transformer positional embedding design named Sandwich that uses longer than training sequence length information, and it is a greatly simpli\ufb01ed formulation of the earliest proposed Sinusoidal positional embedding. Finally, we show that both ALiBi and Sandwich enable ef\ufb01cient inference thanks to their implicit windowed attention effect.", "venue": "arXiv.org", "year": 2022, "citationCount": 5, "influentialCitationCount": 1, "openAccessPdf": {"url": "http://arxiv.org/pdf/2212.10356", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "It is shown that ALiBi surprisingly does not utilize tokens further than the training sequence length, which can be explained by its implicit windowed attention effect that aligns the receptive during training and testing stages, and another transformer positional embedding design named Sandwich is proposed that uses longer thanTraining sequence length information."}, "embedding": {"model": "specter_v2", "vector": [0.18044385313987732, 0.5679091811180115, -0.6942547559738159, -0.2892376184463501, -0.16310004889965057, -0.3153505325317383, 0.4197175204753876, -0.5544930696487427, -0.32111266255378723, -0.1582423895597458, 0.851686954498291, -0.03931253403425217, 0.22613565623760223, 0.13395726680755615, -0.2026585340499878, -0.22950097918510437, -0.6674251556396484, 0.0314837321639061, 0.25346583127975464, -0.47020700573921204, -0.12559174001216888, -0.6231186389923096, -0.7628644704818726, 0.07837700098752975, 0.17742444574832916, 0.6294749975204468, 0.32808637619018555, 0.43766769766807556, -0.4469377100467682, 0.37176457047462463, 0.36156168580055237, -0.6659635305404663, 0.299642950296402, -0.002872056793421507, -0.2615683078765869, -0.1980477273464203, 0.7233270406723022, -0.6329403519630432, -0.8251821398735046, 0.7689093351364136, -0.4169829785823822, 0.13429111242294312, 0.03587641566991806, -0.8229900598526001, -0.5415256023406982, 1.3123785257339478, 1.1484310626983643, 0.8199328780174255, -0.36187082529067993, -0.6384896636009216, 1.6081597805023193, -1.1183550357818604, 0.2826387584209442, 1.2938140630722046, 0.46867063641548157, 0.383453369140625, -0.171616792678833, -0.5225400924682617, 0.7098518013954163, 0.3389063775539398, -0.6399798393249512, -0.44477733969688416, 0.4946952760219574, 0.07446716725826263, 1.4956673383712769, -0.3486213684082031, 0.3483368456363678, 0.49953752756118774, -0.027871161699295044, 1.2730368375778198, 0.03844231367111206, -0.8086139559745789, -0.48647618293762207, 0.33468109369277954, 0.4147142469882965, 0.5881785750389099, -0.6113275289535522, 0.5129438638687134, -1.0607028007507324, 0.21510717272758484, 0.5592500567436218, -0.19660687446594238, 0.30992409586906433, -0.016348060220479965, -0.4359210431575775, 0.47501853108406067, 0.3294712007045746, 0.9223302602767944, -0.018467621877789497, 0.758061945438385, 0.5392778515815735, 0.4581063985824585, 0.003067039418965578, 0.040202122181653976, 0.2494385689496994, 0.5646388530731201, -0.9501760601997375, 0.07150476425886154, -0.6128572821617126, 0.8028666973114014, 0.25121361017227173, 0.7349534630775452, -0.6955184936523438, 0.09934929013252258, 1.489894151687622, 0.14111018180847168, 0.6221869587898254, -0.9170687794685364, 0.26163560152053833, -0.7131506204605103, -0.09044662117958069, -0.6721123456954956, 0.1435214877128601, -0.3725699782371521, -0.5027559399604797, -1.1975443363189697, -0.24663138389587402, 0.5296682715415955, -0.5051721930503845, 0.9392146468162537, -0.2981588840484619, -0.007072860840708017, 0.09330517798662186, 0.0564105361700058, 0.40616050362586975, 0.5041773319244385, 0.14021778106689453, 0.12689457833766937, 1.0492202043533325, -0.8842422962188721, -0.912880003452301, -1.1084245443344116, 0.42124783992767334, -0.015760254114866257, 0.34258460998535156, -0.2798420786857605, -1.130082607269287, -1.182690978050232, -1.2162199020385742, 0.08367878198623657, -0.4239179491996765, 0.14820381999015808, 0.8176696300506592, 0.3780064582824707, -1.1920371055603027, 1.1596852540969849, -0.3716619610786438, -0.1586185097694397, 0.3784136474132538, 0.2845524847507477, 0.006189459003508091, -0.1401243656873703, -1.6308938264846802, 0.38075584173202515, 0.16774685680866241, -0.4004720449447632, -0.009024007245898247, -0.7902092337608337, -1.3651057481765747, -0.045510176569223404, 0.2039700299501419, -0.3515608012676239, 0.8729487657546997, -0.05577920377254486, -1.2391403913497925, 0.5481395125389099, -0.59537672996521, -0.2288103848695755, 0.027303386479616165, 0.04390246421098709, -0.6558992266654968, -0.6212472319602966, -0.22892655432224274, 0.4694889485836029, 0.56866854429245, 0.14562061429023743, -0.13898658752441406, -0.23526696860790253, -0.2376404106616974, -0.012485744431614876, -0.68410325050354, 0.9059569239616394, -0.08105961233377457, -0.4334867596626282, 0.38387125730514526, 0.6511920690536499, 0.1640123873949051, -0.47810566425323486, -0.38627389073371887, -1.176373839378357, 0.5166437029838562, 0.07826311886310577, 1.3414276838302612, -0.9442226886749268, -0.7565919756889343, -0.15593691170215607, -0.12697763741016388, -0.2697693407535553, -0.7916401028633118, 0.9126777648925781, -0.49772757291793823, 0.34543412923812866, 0.17311176657676697, -0.6670304536819458, 0.16376306116580963, -0.33484402298927307, -0.9643148183822632, -0.13893140852451324, -0.11738977581262589, 1.0908253192901611, -0.8076847195625305, -0.08751996606588364, 0.07291726768016815, 0.291146457195282, -0.5281569361686707, 1.2102130651474, -0.06915776431560516, -0.044976040720939636, 0.2470903992652893, -0.2564898729324341, -0.004985198378562927, -0.19798016548156738, 0.2301793098449707, -0.4129628837108612, -0.19446206092834473, 0.8897640109062195, -0.2734934985637665, 1.4210901260375977, -0.17843745648860931, 0.8898537755012512, -0.40704673528671265, -0.5365477800369263, 0.28360506892204285, 0.3988065719604492, -0.14188329875469208, -0.6152064204216003, -0.05176624655723572, 0.04617602005600929, -0.435377836227417, 0.2932778596878052, 0.528319776058197, 0.8008614182472229, -0.2750554382801056, 0.07682160288095474, 0.5646640062332153, -0.0753650888800621, 0.4978416860103607, 0.06076563149690628, 0.41177698969841003, 0.3448390066623688, 0.32104283571243286, -0.1919046938419342, 0.48761284351348877, -0.8118814826011658, 0.045140232890844345, 0.18990758061408997, 0.7185944318771362, 0.5228532552719116, 0.19663524627685547, -0.6539185047149658, -0.6478357315063477, -0.11093154549598694, 0.4280793368816376, 1.481899619102478, -0.4024796485900879, -0.4731957018375397, -0.704359233379364, -0.0721929594874382, -0.3809843063354492, 0.12920834124088287, -0.4526549279689789, -0.1207379549741745, -0.7488216757774353, -0.4687998294830322, 0.7452696561813354, 0.5797543525695801, 0.7236712574958801, -0.6749566197395325, -0.30876144766807556, -0.08112222701311111, 0.16699740290641785, -0.7194072008132935, -0.7793489694595337, 0.1481560617685318, -0.4663865864276886, 0.3088327646255493, 0.038246892392635345, -0.26300033926963806, 0.020644275471568108, -0.7872605919837952, 0.6165974736213684, -0.6901028156280518, 0.013444162905216217, -0.2321205735206604, 0.6770402789115906, -0.49288973212242126, -0.5917360782623291, 0.30851078033447266, 0.29713478684425354, -0.16203173995018005, 0.4669882655143738, 0.2268577367067337, -0.40463024377822876, 0.13399827480316162, -0.40514075756073, -0.021295800805091858, 0.08552376925945282, 0.28021785616874695, 0.3837164640426636, -0.308432400226593, -0.03150496259331703, -0.8224732279777527, 0.8484607338905334, 0.7414894700050354, -0.7291693091392517, 0.15050458908081055, -0.9016427993774414, -0.1043223962187767, 0.4250033497810364, -0.6304696202278137, 0.012415903620421886, -1.0051041841506958, 0.17281249165534973, -0.4831445515155792, -0.20043307542800903, 0.06710957735776901, 0.10766386240720749, 0.20870395004749298, -0.025130348280072212, 0.7182495594024658, 0.46269604563713074, 0.09899932891130447, 0.5788728594779968, -0.7290237545967102, 0.5530337691307068, 0.660982608795166, 0.1132102981209755, -0.12137885391712189, -0.2048458456993103, -0.9229730367660522, -0.2163058966398239, -0.23589639365673065, -0.4538934826850891, -0.13059966266155243, 0.24836613237857819, -0.49801915884017944, -0.9601854085922241, 0.0012610281119123101, -0.8475593328475952, -0.32142210006713867, -0.10425391048192978, -0.2019980400800705, -0.227605402469635, -0.954018771648407, -1.1485676765441895, -0.45909756422042847, -0.4050426781177521, -0.9793041944503784, 0.040863025933504105, -0.1802840679883957, -0.5536831617355347, -0.71224445104599, 0.0622163824737072, -0.5100008845329285, 1.0722947120666504, -0.9634130001068115, 0.7350823879241943, -0.2004384845495224, -0.390942245721817, -0.1685006022453308, 0.48165163397789, 0.9645614624023438, -0.007449903059750795, 0.12621194124221802, -0.6466798186302185, 0.34155893325805664, -0.1878829300403595, -0.06322184950113297, -0.013295428827404976, 0.44589537382125854, 0.5253421664237976, -0.4322400689125061, -0.41220176219940186, 0.3257022202014923, 1.4255815744400024, -0.303101509809494, 0.47645026445388794, 0.3670434057712555, 1.0769222974777222, 0.4907516837120056, -0.14311546087265015, 0.23130926489830017, 0.30978232622146606, 0.6392248868942261, -0.05471160262823105, -0.06817393749952316, -0.21012629568576813, -0.769909143447876, 0.5817141532897949, 1.607505440711975, 0.37813591957092285, 0.3153180480003357, -0.9429295659065247, 0.8120205402374268, -0.8158935904502869, -1.260728359222412, 1.1914833784103394, 0.9882758259773254, 0.3385774791240692, -0.3953540325164795, -0.1973080337047577, 0.34987983107566833, 0.35521289706230164, 0.5529469847679138, -0.12499681115150452, -0.6352751851081848, 0.04622156172990799, 0.3507700562477112, 0.3414576053619385, 0.8329917788505554, -0.20069095492362976, 0.990405261516571, 15.276434898376465, 0.8222219347953796, -0.24613232910633087, 0.2517825663089752, 0.45931002497673035, 0.6079128980636597, -0.6153194904327393, 0.09054508060216904, -1.538780689239502, 0.11911018192768097, 1.1501452922821045, -0.19984731078147888, 0.5753104090690613, -0.0068992082960903645, -0.03842107206583023, 0.4845365881919861, -0.6841853260993958, 0.49415668845176697, 0.610155463218689, -1.1881159543991089, 0.2906844913959503, 0.21294835209846497, -0.1491936892271042, 0.16219189763069153, 0.9151667356491089, 0.3014650344848633, 0.3061734437942505, -0.4060923457145691, 0.5673914551734924, -0.004915471654385328, 1.1365128755569458, -0.1375395655632019, 0.09836193919181824, 0.24110710620880127, -0.8021649718284607, -0.276410311460495, -0.6048896312713623, -0.9775553941726685, 0.17367596924304962, 0.15369470417499542, -0.6886852979660034, -0.6159636378288269, -0.19403478503227234, 0.7322970628738403, 0.29437482357025146, 0.12298230081796646, -0.3240754306316376, 0.6997782588005066, 0.20313291251659393, -0.13625164330005646, 0.3172462284564972, 0.1812150776386261, 0.1290455013513565, -0.2563626766204834, 0.28278908133506775, -0.2350492775440216, -0.11143091320991516, 0.33795684576034546, -0.14682196080684662, -0.16831837594509125, -0.46681836247444153, -0.3420398235321045, 0.15400123596191406, 0.6765977740287781, 0.6630051732063293, 0.054520901292562485, -0.2252505123615265, 0.27794864773750305, 0.48386135697364807, 0.2130315899848938, -0.3972220718860626, -0.39767327904701233, 0.590831458568573, -0.11879108101129532, 0.015768611803650856, 0.6349571347236633, -0.2288130670785904, -0.20781883597373962, -0.7611536979675293, -0.10612452775239944, 0.03471914678812027, -0.8008502125740051, -0.5066021084785461, 1.387961745262146, -0.13969680666923523, -0.720329761505127, 0.13255956768989563, -0.8972383737564087, -0.12998683750629425, 0.24279214441776276, -1.1232893466949463, -0.6716592907905579, 0.23220548033714294, -0.1967962086200714, -0.23837944865226746, 0.07445324957370758, 1.0447748899459839, -0.08643437176942825, -0.26922276616096497, 0.2307865470647812, -0.10876815021038055, 0.17206154763698578, 0.02202915959060192, -0.898796796798706, 0.6965399384498596, 0.24854110181331635, 0.1881839632987976, 0.4811147153377533, 0.08884824067354202, 0.43616437911987305, -0.42316868901252747, 0.17430946230888367, 1.0799959897994995, -0.8821068406105042, -0.06507066637277603, -1.0601463317871094, -0.7563195824623108, 0.5884581208229065, 0.8343298435211182, -0.28177690505981445, 0.3135851323604584, 0.06263192743062973, -0.6535241603851318, -0.8651622533798218, -0.3516964018344879, 0.13323958218097687, 0.6187728643417358, -0.902630627155304, -0.5892268419265747, -0.22941015660762787, 0.39074215292930603, -0.7597519755363464, -0.5930132865905762, -0.1570938229560852, 0.3671588897705078, -0.24154651165008545, 1.127416968345642, -0.4123344123363495, 0.6752937436103821, 0.979433536529541, -0.144172802567482, -0.781351625919342, -0.32655656337738037, -1.0045229196548462, 0.3867626488208771, 0.5992145538330078, 0.5932260155677795, -0.569042980670929, 0.4958728551864624, 0.4252319931983948, 0.1863621026277542, -0.28773167729377747, -0.6528006792068481, -0.4781399667263031, 0.04240061342716217, -0.6179407238960266, 0.4927002191543579, -0.1832740604877472, 0.3314158320426941, 0.3971934914588928, 0.2502930164337158, 0.25154876708984375, -0.06638229638338089, -0.729881763458252, -0.1499176025390625, -0.04211343824863434, 0.2666366398334503, -0.6310211420059204, -0.6061305403709412, -1.3781317472457886, 0.23336343467235565, -1.1683331727981567, 0.0022576511837542057, -1.096670150756836, -0.5598346590995789, 0.09031841158866882, -0.3438417911529541, 0.03214399144053459, 0.6038805246353149, -0.2696113586425781, -0.5431684255599976, -0.4125417470932007, -0.07734102010726929, 0.5974652171134949, 0.6654161810874939, -0.9216479659080505, 0.3400336503982544, 0.14635393023490906, -0.08133980631828308, 0.0004970721784047782, 0.4788360297679901, -0.29833734035491943, -1.0638477802276611, -1.2531462907791138, 0.48959845304489136, -0.0032323584891855717, -0.3053160607814789, -0.6081980466842651, 0.7297742366790771, 0.5906149744987488, -0.06866972893476486, -0.15764430165290833, 0.37244608998298645, -0.7788796424865723, -0.3119654357433319, 0.1956620216369629, -0.8607081174850464, 0.4672141373157501, -0.037232350558042526, -0.670266330242157, -0.397331565618515, 0.8433060646057129, -0.07727663218975067, -1.0269159078598022, -0.8011549115180969, 0.6036114692687988, -0.6520238518714905, -0.007419147994369268, -0.3258104622364044, -0.6397345662117004, -0.9359720349311829, -0.10880742967128754, 0.05362900719046593, 0.14736716449260712, -0.32269155979156494, 0.9750235676765442, 0.5751010775566101, -1.487434983253479, 0.13971391320228577, 0.694347620010376, 0.029660122469067574, -0.49498364329338074, 0.5922964811325073, 0.40570396184921265, -0.048571739345788956, 0.8361468315124512, -0.03072364628314972, 0.22287002205848694, -1.161598801612854, 0.20169980823993683, 0.3387301564216614, -0.37201401591300964, -0.16069263219833374, 1.113100290298462, -0.30965593457221985, -0.7083148956298828, 0.3318798542022705, -1.2402417659759521, -0.7259934544563293, -0.170525461435318, 0.7236112952232361, 0.41264158487319946, -0.10504666715860367, -0.17754554748535156, -0.6630496978759766, 0.42996248602867126, -0.11339014768600464, -0.743177592754364, 0.16414809226989746, -0.3373894989490509, -0.6221195459365845, 0.7999300360679626, 0.7215420007705688, -0.5010415315628052, -0.6552279591560364, -0.6787040829658508, -0.4389815628528595, -0.32906806468963623, 0.1632816642522812, 0.02490718476474285, -0.27902233600616455, 0.9310479760169983, 0.4148311913013458, 0.2838209271430969, 0.026367129758000374, -0.10483796894550323, 0.11455041170120239, 0.2854555547237396, -0.056820061057806015, -0.4521694481372833, -0.43191197514533997, 1.183021068572998, 1.208545446395874, -0.5579729080200195, 0.030248908326029778, -0.28847137093544006, -0.6204298138618469, 0.7713994383811951, 0.2148461937904358, -0.11113952100276947, 0.8029959797859192, 0.035397160798311234, 0.42890650033950806, 0.3223920464515686, -1.0228410959243774, -0.1347828507423401, 0.8552719354629517, 1.0841411352157593, 0.7231324911117554, -0.00991992186754942, 0.11081100255250931, 0.6497415900230408, -0.2829298973083496, -0.053101733326911926, 0.24102316796779633, 0.08378951996564865, -0.17855095863342285, -0.16359424591064453, 0.19991451501846313, 0.10315018147230148, -0.6535966396331787, -0.7490153908729553, 0.27653244137763977, 0.6215697526931763, -0.08553504943847656, 0.5653699636459351, 1.131253719329834, -0.2071205973625183, 0.4403509199619293, 0.26555514335632324, 0.6744585633277893, -0.1791665256023407, -0.1433379352092743, -0.13119232654571533, -0.6795533895492554, -0.21260608732700348, -0.15459668636322021, -0.42492207884788513, -0.13060548901557922, -0.09905798733234406, 0.32418397068977356, 0.1335640698671341, 0.3399224281311035, 0.8986659646034241, 0.3305540382862091, 0.3484976291656494, -0.025195805355906487, -0.3176523447036743, -0.48190250992774963, -0.997563362121582, 0.015497226268053055, -0.5446746945381165, -0.07743700593709946, 0.0622154176235199, -0.16769099235534668, -0.3186158239841461]}, "authors": [{"authorId": "27531332", "name": "Ta-Chung Chi"}, {"authorId": "32037089", "name": "Ting-Han Fan"}, {"authorId": "1783635", "name": "Alexander I. Rudnicky"}], "references": [{"paperId": "964bd39b546f0f6625ff3b9ef1083f797807ef2e", "title": "BLOOM: A 176B-Parameter Open-Access Multilingual Language Model"}, {"paperId": "d6c5aab433d9871cabc01ffb1e5e1ea89141155b", "title": "KERPLE: Kernelized Relative Positional Embedding for Length Extrapolation"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "39b492db00faead70bc3f4fb4b0364d94398ffdb", "title": "Do Vision Transformers See Like Convolutional Neural Networks?"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "63857190aaf5aab1d94b54bb257b7b03b8cb5a50", "title": "GMAT: Global Memory Augmentation for Transformers"}, {"paperId": "d27669c82faf78ea08cceaa0a171b540cccc304d", "title": "ETC: Encoding Long and Structured Inputs in Transformers"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "150f1260a3b73866865626a0e99b486242d32fc9", "title": "Computing Receptive Fields of Convolutional Neural Networks"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "2dad7e558a1e2982d0d42042021f4cde4af04abf", "title": "Dilated Recurrent Neural Networks"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "4a73a1840945e87583d89ca0216a2c449d50a4a3", "title": "Deformable Convolutional Networks"}, {"paperId": "01a4f33da8ad94ced3cf58548b28dbbb44148571", "title": "Understanding the Effective Receptive Field in Deep Convolutional Neural Networks"}, {"paperId": "df0402517a7338ae28bc54acaac400de6b456a46", "title": "WaveNet: A Generative Model for Raw Audio"}, {"paperId": "7f5fc84819c0cf94b771fe15141f65b123f7b8ec", "title": "Multi-Scale Context Aggregation by Dilated Convolutions"}, {"paperId": "f264e8b33c0d49a692a6ce2c4bcb28588aeb7d97", "title": "Recurrent Neural Network Regularization"}, {"paperId": "d1275b2a2ab53013310e759e5c6878b96df643d4", "title": "Context dependent recurrent neural network language model"}, {"paperId": "9819b600a828a57e1cde047bbe710d3446b30da5", "title": "Recurrent neural network based language model"}]}