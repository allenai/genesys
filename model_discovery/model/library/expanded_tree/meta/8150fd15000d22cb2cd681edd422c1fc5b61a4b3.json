{"paperId": "8150fd15000d22cb2cd681edd422c1fc5b61a4b3", "abstract": "Transformers have become pivotal in Natural Language Processing, demonstrating remarkable success in applications like Machine Translation and Summarization. Given their widespread adoption, several works have attempted to analyze the expressivity of Transformers. Expressivity of a neural network is the class of functions it can approximate. A neural network is fully expressive if it can act as a universal function approximator. We attempt to analyze the same for Transformers. Contrary to existing claims, our findings reveal that Transformers struggle to reliably approximate smooth functions, relying on piecewise constant approximations with sizable intervals. The central question emerges as:\"Are Transformers truly Universal Function Approximators?\"To address this, we conduct a thorough investigation, providing theoretical insights and supporting evidence through experiments. Theoretically, we prove that Transformer Encoders cannot approximate smooth functions. Experimentally, we complement our theory and show that the full Transformer architecture cannot approximate smooth functions. By shedding light on these challenges, we advocate a refined understanding of Transformers' capabilities.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A thorough investigation of Transformers' expressivity, providing theoretical insights and supporting evidence through experiments, proves that Transformer Encoders cannot approximate smooth functions and advocates a refined understanding of Transformers' capabilities."}, "embedding": {"model": "specter_v2", "vector": [0.5933931469917297, 0.9278821349143982, -0.7315632104873657, -0.1894562840461731, -0.4155423939228058, -0.15879188477993011, 0.6382037401199341, -0.03150394186377525, -0.17025259137153625, -0.28286588191986084, 0.3501860201358795, -0.06605131179094315, 0.47658562660217285, -0.25890305638313293, -0.23540723323822021, 0.25495851039886475, -0.8340254426002502, 0.06014631316065788, 0.0775127112865448, -0.6272933483123779, -0.29950466752052307, -0.3762650191783905, -1.1109974384307861, 0.369774729013443, 0.42874839901924133, 1.0008198022842407, -0.35930490493774414, 0.7276568412780762, -0.5979005098342896, 1.04317045211792, 0.29150211811065674, -0.3079867362976074, 0.060336776077747345, 0.21398743987083435, -0.1717730313539505, -0.480315625667572, 0.32704687118530273, -0.6073909997940063, -0.6549206376075745, 1.2198824882507324, -0.7913471460342407, 0.0676691085100174, 0.34127822518348694, -1.0068527460098267, -0.4219883680343628, 1.1321454048156738, 1.0921363830566406, 0.7830008864402771, -0.43207675218582153, -0.7288933992385864, 1.6114544868469238, -0.9056754112243652, -0.07564961165189743, 1.353657603263855, 0.8382115364074707, 0.4540649950504303, -0.30921921133995056, -0.5583047866821289, 0.8082475662231445, -0.09503303468227386, -0.6682372093200684, -0.6872521638870239, -0.10762066394090652, 0.2716652452945709, 1.5352537631988525, -0.14423389732837677, 0.0015846550231799483, 0.2596418857574463, 0.009807009249925613, 1.3358678817749023, 0.1259629875421524, -0.5315789580345154, -0.23864327371120453, 0.21070745587348938, 0.2325950711965561, 1.0853711366653442, -0.6274124979972839, 0.15872028470039368, -1.0238761901855469, -0.08050093054771423, 0.5032292008399963, 0.023534873500466347, -0.39470797777175903, -0.09438050538301468, -0.04935099184513092, 0.8047785758972168, 0.481473833322525, 0.7363936901092529, -0.3915700912475586, 0.7553714513778687, 0.7972821593284607, 0.8755178451538086, 0.059110596776008606, 0.4445067346096039, -0.03192136064171791, 0.18365798890590668, -0.7781189680099487, -0.06223611533641815, 0.07855409383773804, 0.8613845705986023, -0.35247039794921875, 0.5917294025421143, -0.6453491449356079, 0.2852409780025482, 0.9162193536758423, 0.002536311512812972, 0.39494699239730835, -0.9637186527252197, 0.15239983797073364, -0.3602015972137451, 0.18888799846172333, -0.6957668662071228, 0.06086636334657669, -0.3026754558086395, -0.67401522397995, -1.0909488201141357, -0.29739266633987427, 0.2404700666666031, -0.7595378756523132, 0.7278901934623718, -0.8888360857963562, -0.44463133811950684, -0.25223350524902344, 0.2903140187263489, 0.31710636615753174, 0.8519840240478516, 0.10609513521194458, -0.34183254837989807, 0.8401037454605103, -0.43885788321495056, -1.1127705574035645, -0.7859905958175659, 0.49579325318336487, 0.009033430367708206, 0.4299541711807251, 0.054111212491989136, -1.3756674528121948, -0.7590212225914001, -1.0911062955856323, -0.019817005842924118, -0.6360389590263367, 0.15717445313930511, 0.895970344543457, 0.4589994251728058, -1.265798807144165, 0.952625036239624, -0.4227665662765503, 0.1526416540145874, 0.8357551693916321, 0.6370112299919128, 0.16342324018478394, -0.1466665416955948, -1.1969172954559326, 0.5726163387298584, 0.01375703513622284, -0.7160540223121643, -0.13842104375362396, -0.7762842178344727, -1.4221668243408203, 0.3478070795536041, 0.13650724291801453, -0.36809203028678894, 1.3970683813095093, -0.27339431643486023, -1.4357162714004517, 0.24158544838428497, -0.5730205178260803, -0.2682667374610901, 0.10944389551877975, -0.305251806974411, -0.5396221280097961, 0.13629528880119324, -0.08344154804944992, 0.18067634105682373, 0.44271716475486755, -0.29287856817245483, -0.4254535436630249, 0.5369309186935425, -0.23204359412193298, -0.4524485766887665, -0.5082082748413086, 1.1881322860717773, 0.17719031870365143, -0.05075014382600784, 0.1872214525938034, 0.9717065095901489, 0.12009703367948532, 0.1041761264204979, -0.4971931278705597, -1.1194287538528442, 0.5231504440307617, -0.18304544687271118, 1.4375277757644653, -0.7879094481468201, -0.7703067064285278, -0.04121386259794235, 0.08561720699071884, -0.006403612904250622, -0.4001847207546234, 0.4843350350856781, -0.4293782711029053, 0.5862812995910645, -0.3182474970817566, -0.827660858631134, 0.3261769413948059, -0.00694324029609561, -0.8522574305534363, 0.07290899008512497, 0.310628205537796, 1.0656864643096924, -0.7128003835678101, -0.03371667489409447, 0.24996472895145416, 0.42687687277793884, -0.7581409215927124, 1.3430675268173218, -0.2358453869819641, -0.4100627899169922, 0.0351269356906414, -0.01934369094669819, -0.26311537623405457, -0.3945115804672241, 0.16895665228366852, -0.5974989533424377, -0.17459282279014587, 0.5856735706329346, -0.057621974498033524, 0.7877654433250427, -0.13376009464263916, 0.8525324463844299, -0.14688248932361603, -1.2620439529418945, 0.28456151485443115, 0.6475862860679626, -0.08654003590345383, -0.4140424132347107, 0.528312087059021, 0.40678897500038147, -0.8759740591049194, 0.5499743819236755, 0.6757248640060425, 0.4688081443309784, -0.35956040024757385, -0.08438020199537277, 0.6234243512153625, -0.42678049206733704, 0.41823863983154297, 0.13291236758232117, 0.8356308341026306, 0.17473898828029633, 0.4926430284976959, -0.007664622273296118, 0.2687873840332031, -0.6200643181800842, -0.039856404066085815, 0.48184728622436523, 0.6787264347076416, 0.8590942025184631, 0.682857096195221, -0.610046923160553, -0.43841060996055603, -0.34669673442840576, 0.51414555311203, 1.4078859090805054, -0.27477967739105225, -0.5754667520523071, -0.6448739767074585, -0.18768064677715302, -0.6165832281112671, 0.2717514932155609, -0.374613881111145, -0.37590503692626953, -0.7242587804794312, -0.7705981731414795, 1.1852165460586548, 0.4893198311328888, 0.7603417634963989, -0.013134710490703583, -0.38853156566619873, -0.17830915749073029, 0.050083596259355545, -0.8717700242996216, -0.5510302782058716, 0.6811358332633972, -0.9762735366821289, -0.10098057240247726, 0.1621377021074295, -0.1541362851858139, 0.23352918028831482, -1.050991415977478, 0.8835605382919312, -0.6360345482826233, 0.39490658044815063, 0.07195873558521271, 1.0591530799865723, -0.5880381464958191, -1.0443426370620728, -0.07152538746595383, -0.005572427995502949, -0.23308245837688446, 0.26500868797302246, 0.18086685240268707, 0.25311413407325745, 0.15628059208393097, -0.34645208716392517, -0.04346129298210144, 0.08483247458934784, 0.2718801200389862, 0.6988102197647095, -0.023176612332463264, 0.05258694663643837, -1.141606092453003, 1.137420654296875, 0.20890308916568756, -0.1924942135810852, 0.48574087023735046, -0.659988522529602, -0.08561113476753235, 1.0281580686569214, -0.7992715835571289, -0.022572483867406845, -1.0596778392791748, 0.3644283711910248, -0.3906726837158203, 0.09902237355709076, 0.05159548670053482, 0.08073481917381287, 0.04717925935983658, 0.17453402280807495, 0.41780558228492737, 0.47102609276771545, 0.038214027881622314, 0.47488540410995483, -0.5465818047523499, 0.7536243796348572, 0.36453819274902344, 0.09861361235380173, -0.1009620651602745, -0.18449626863002777, -0.4832058846950531, -0.20397451519966125, 0.047651179134845734, 0.43217039108276367, -0.05899003520607948, -0.3516119122505188, -0.5582178235054016, -0.9377014636993408, -0.3755204975605011, -0.9235048890113831, -0.07114874571561813, -0.3639605641365051, -0.6342449188232422, -0.3456047773361206, -1.1714015007019043, -1.5200778245925903, -0.5724013447761536, -0.5527456998825073, -0.8765144944190979, 0.29053962230682373, 0.07031699270009995, -0.5656242370605469, -0.3851793706417084, -0.6369038820266724, -0.6833300590515137, 1.1903605461120605, -0.31881654262542725, 1.1606385707855225, -0.21661727130413055, -0.13443605601787567, -0.3383159041404724, 0.22656093537807465, 0.8190910220146179, -0.049986764788627625, 0.2847667336463928, -0.8817328214645386, 0.47782102227211, -0.14181064069271088, 0.0772373154759407, -0.15600349009037018, 0.38657107949256897, 0.7634618282318115, -0.6122884750366211, -0.2842620611190796, 0.3565406799316406, 1.2155524492263794, -0.41029107570648193, -0.05311793461441994, 0.16491015255451202, 0.8066521883010864, 0.15103404223918915, -0.4755493402481079, 0.19152259826660156, 0.38794854283332825, 0.31694915890693665, 0.21908365190029144, 0.06490642577409744, 0.08429671823978424, -0.7890259027481079, 0.8024136424064636, 1.501672625541687, 0.2541756331920624, -0.07976597547531128, -0.6257143616676331, 0.6384075284004211, -1.1499589681625366, -0.6506043672561646, 0.8668339848518372, 0.7940104603767395, 0.4395419955253601, 0.009609583765268326, -0.41200804710388184, 0.2994888424873352, 0.5829199552536011, 0.2272159606218338, -0.17433184385299683, -1.021393895149231, -0.14993681013584137, 0.7478768229484558, 0.6118992567062378, 0.6074106097221375, -0.34026598930358887, 0.34136685729026794, 15.011984825134277, 0.7892448306083679, -0.41117480397224426, 0.39579835534095764, 0.4589935839176178, 0.375929057598114, -0.6343879699707031, -0.1084774062037468, -0.703965961933136, -0.06964266300201416, 1.2397969961166382, 0.01727095991373062, 0.6638907194137573, -0.1047879084944725, -0.03619243577122688, 0.5428373217582703, -0.5482454895973206, 0.48010098934173584, 0.15118108689785004, -1.4166362285614014, 0.5072060227394104, -0.02606959454715252, 0.05729559436440468, 0.11989647895097733, 0.5229296088218689, 0.6291244029998779, 0.47938862442970276, -0.8335347175598145, 0.6430224180221558, 0.18389956653118134, 1.0918418169021606, -0.256764680147171, 0.322374165058136, 0.5123866200447083, -0.866063117980957, -0.2912529706954956, -0.35721930861473083, -1.0642608404159546, 0.34099316596984863, 0.0728832483291626, -0.48548659682273865, -0.5066800117492676, -0.27739349007606506, 0.7729443907737732, 0.383515864610672, 0.12081005424261093, -0.36290931701660156, 1.0746299028396606, -0.5403869152069092, 0.10523397475481033, 0.15066811442375183, 0.5705336928367615, 0.303158164024353, -0.029581572860479355, 0.31513431668281555, -0.2152596265077591, 0.03773702681064606, 0.4728247821331024, -0.5821232795715332, -0.1544170379638672, -0.3249257206916809, -0.6340826153755188, 0.08645506948232651, 0.3646577000617981, 0.4709326922893524, 0.14523886144161224, -0.18423955142498016, 0.034568414092063904, 0.42081397771835327, 0.23269960284233093, -0.004961375612765551, -0.3000392019748688, 0.31208497285842896, 0.02414689213037491, -0.01904560625553131, 0.8133218288421631, -0.4617471992969513, -0.4223368465900421, -0.7330818772315979, -0.658837616443634, 0.434612512588501, -0.6833592057228088, -0.4940618872642517, 0.8474394679069519, -0.238428995013237, -0.24282266199588776, 0.33802279829978943, -0.6514317989349365, -0.301541805267334, 0.1036161258816719, -1.3654553890228271, -0.6711587309837341, 0.41142594814300537, -0.20943324267864227, -0.36832892894744873, -0.009291346184909344, 1.4694392681121826, 0.01400612760335207, -0.1354326456785202, 0.21942321956157684, -0.33514824509620667, 0.08902473002672195, -0.595249354839325, -1.1926437616348267, 0.6494265794754028, 0.3058040142059326, -0.06555266678333282, 0.7239174246788025, 0.3326166272163391, 0.6497496962547302, -0.6091812252998352, 0.17627206444740295, 1.127953052520752, -0.6196538805961609, -0.3046339154243469, -0.5518307685852051, -0.956568717956543, 0.527393639087677, 0.2589968144893646, -0.17225897312164307, 0.050297901034355164, -0.055038873106241226, -0.542598307132721, -0.3001530170440674, -0.8723801374435425, 0.08339208364486694, 0.4707120358943939, -1.0095411539077759, -0.4237496554851532, -0.4883841276168823, 0.2666948139667511, -0.8683872222900391, -0.7678259611129761, 0.1487259417772293, 0.19089938700199127, -0.30338799953460693, 0.9130248427391052, -0.4053831100463867, 0.7038138508796692, 0.5275998115539551, -0.19051940739154816, -0.8951441049575806, 0.09737256169319153, -1.2490097284317017, -0.23816247284412384, 0.06372637301683426, 0.39660346508026123, -0.7377886176109314, 0.10048234462738037, 0.5411456823348999, -0.10045363754034042, -0.533867359161377, -0.7628087997436523, 0.04775674641132355, -0.06751026213169098, -0.35004469752311707, 0.3955308794975281, -0.19355995953083038, 0.05275977402925491, 0.12314585596323013, 0.349721759557724, 0.49077552556991577, -0.53289395570755, -0.7945032715797424, -0.151771679520607, -0.2630692720413208, 0.29499340057373047, -0.9646143913269043, -0.5403531193733215, -1.5984365940093994, 0.12883730232715607, -0.9445229768753052, 0.1688299924135208, -1.2218971252441406, -1.0293233394622803, 0.294668585062027, -0.27489519119262695, 0.22652088105678558, 0.536955714225769, -0.47454291582107544, -0.5627026557922363, -0.48975497484207153, -0.14290334284305573, 0.7331975698471069, 0.7417856454849243, -0.9771940112113953, 0.3226923942565918, 0.33143508434295654, -0.255028635263443, 0.28844234347343445, 0.4956076145172119, -0.41426756978034973, -0.9249430298805237, -0.968620240688324, 0.3324582874774933, -0.040476299822330475, -0.21436642110347748, -0.4306633174419403, 0.7924520969390869, 0.5187470316886902, -0.3217375874519348, 0.441491037607193, 0.559869647026062, -0.9909368753433228, -0.4206269383430481, 0.13942258059978485, -0.9391248226165771, 0.25721803307533264, 0.15083126723766327, -0.7206946015357971, -0.7011264562606812, 0.7413976192474365, 0.1493305116891861, -0.7731159329414368, -0.32076671719551086, 0.40306705236434937, -0.6979306936264038, 0.09799814224243164, -0.5708630084991455, -0.3808201551437378, -1.1881563663482666, -0.4136449098587036, 0.1629026234149933, 0.1590779572725296, -0.21049180626869202, 0.6912497282028198, 0.4398307502269745, -0.9005867838859558, 0.38380056619644165, 0.4402146637439728, -0.1310783177614212, -0.017433490604162216, -0.12776194512844086, 0.1840449571609497, -0.30902424454689026, 0.3478774130344391, 0.17324404418468475, 0.3678508698940277, -0.8075621128082275, -0.38060352206230164, 0.9428852796554565, -0.4086407423019409, -0.5380949974060059, 0.9750955700874329, -0.5195015072822571, -0.827987790107727, 0.35530349612236023, -1.803186297416687, -0.598373532295227, -0.38642629981040955, 0.3615143597126007, 0.12401068210601807, -0.3985815942287445, -0.1023232638835907, -0.40733540058135986, 0.14329694211483002, 0.40513336658477783, -0.25907886028289795, 0.45134663581848145, 0.07637527585029602, -0.5094953775405884, 0.8865872025489807, 0.7107164263725281, -0.6223335862159729, -0.4546718895435333, -0.6255990862846375, -0.1892508864402771, 0.024208059534430504, 0.3266812264919281, -0.06549591571092606, -0.564235508441925, 1.0247799158096313, 0.33739832043647766, 0.5826054811477661, 0.3681141138076782, -0.44667571783065796, 0.1264798492193222, 0.36607828736305237, -0.02360129915177822, -0.5446149706840515, -0.9625208973884583, 1.0453218221664429, 1.052233099937439, -0.42901742458343506, 0.19043709337711334, -0.5655010938644409, -0.4790426194667816, 0.9770254492759705, -0.18309985101222992, -0.09541647881269455, 0.7545123100280762, 0.07014540582895279, -0.04161851108074188, 0.1278841495513916, -1.0592925548553467, -0.03560410812497139, 0.6814299821853638, 1.0314584970474243, 0.657741367816925, 0.3684522807598114, 0.4145238399505615, 1.085095763206482, -0.37246978282928467, 0.554443359375, 0.42319244146347046, 0.5809623003005981, -0.34768927097320557, 0.13678942620754242, 0.3270335793495178, 0.7439684867858887, -1.0622501373291016, -0.545112133026123, 0.3758920133113861, 0.568338930606842, 0.10185500979423523, 0.7941324710845947, 0.705867350101471, -0.06276855617761612, 0.9405457377433777, 0.22319982945919037, 0.6537799835205078, -0.41252174973487854, -0.4970308840274811, -0.5324485301971436, -0.2836996912956238, 0.06771805137395859, -0.3315645456314087, -0.23989050090312958, -0.3785134553909302, -0.33906835317611694, 0.20170889794826508, 0.37176111340522766, 0.2472614049911499, 0.9490811228752136, 0.18044185638427734, 0.6383442282676697, -0.10511013865470886, 0.13072513043880463, -0.658581554889679, -0.7978925108909607, 0.20371441543102264, -0.756359875202179, 0.35652318596839905, -0.051224224269390106, -0.24373853206634521, -0.27141013741493225]}, "authors": [{"authorId": "2268673650", "name": "Swaroop Nath"}, {"authorId": "2512658", "name": "H. Khadilkar"}, {"authorId": "2259166620", "name": "Pushpak Bhattacharyya"}], "references": [{"paperId": "114b733f6fff0c2b4f2b149d2265bc1c7496a3c9", "title": "Tighter Bounds on the Expressivity of Transformer Encoders"}, {"paperId": "955191363c3676f71766af3d14d1e6bbc0f040d6", "title": "The Parallelism Tradeoff: Limitations of Log-Precision Transformers"}, {"paperId": "746a9b434d05b47beb1bd6a96f4d5c89d9d8bd0a", "title": "Your Transformer May Not be as Powerful as You Expect"}, {"paperId": "216b05e812896e790d5b5a084614e2523daa198e", "title": "Formal Language Recognition by Hard Attention Transformers: Perspectives from Circuit Complexity"}, {"paperId": "349eb17c5b61924db8ccc5816c863c6674c8b565", "title": "Saturated Transformers are Constant-Depth Threshold Circuits"}, {"paperId": "10c86505de83647c7b4157595ab10f64e97c94ef", "title": "On the Ability and Limitations of Transformers to Recognize Formal Languages"}, {"paperId": "7e5709d81558d3ef4265de29ea75931afeb1f2dd", "title": "Efficient Transformers: A Survey"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "40ca4fcfffa7ca9aa9b7ff06ecf3cd0436712d78", "title": "$O(n)$ Connections are Expressive Enough: Universal Approximability of Sparse Transformers"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "b45d656ac8cc2e940609580cf291ee76ffcac20a", "title": "On Layer Normalization in the Transformer Architecture"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "509b4661ed74a24c2ffdbf131f9e1c6a1783752d", "title": "Are Transformers universal approximators of sequence-to-sequence functions?"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "ac4dafdef1d2b685b7f28a11837414573d39ff4e", "title": "Universal Transformers"}, {"paperId": "b36a5bb1707bb9c70025294b3a310138aae8327a", "title": "Automatic differentiation in PyTorch"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "93499a7c7f699b6630a86fad964536f9423bb6d0", "title": "Effective Approaches to Attention-based Neural Machine Translation"}, {"paperId": "1eb09fecd75eb27825dce4f964b97f4f5cc399d7", "title": "On the Properties of Neural Machine Translation: Encoder\u2013Decoder Approaches"}, {"paperId": "2e9d221c206e9503ceb452302d68d10e293f2a10", "title": "Long Short-Term Memory"}, {"paperId": "c4cb90a67f45e7cbacb5286e934b309e89843922", "title": "Attention is Turing-Complete"}, {"paperId": null, "title": "RANSFORMERS ARE E XPRESSIVE , B UT A RE T HEY E XPRESSIVE E NOUGH FOR R"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}]}