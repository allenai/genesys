{"paperId": "3d4923d3ccf09334023e2bad293cd84f91105ffe", "abstract": "Transformer language models such as GPT-2 are difficult to quantize because of outliers in activations leading to a large quantization error. To adapt to the error, one must use quantization-aware training, which entails a fine-tuning process based on the dataset and the training pipeline identical to those for the original model. Pretrained language models, however, often do not grant access to their datasets and training pipelines, forcing us to rely on arbitrary ones for fine-tuning. In that case, it is observed that quantization-aware training overfits the model to the fine-tuning data. For quantization without overfitting, we introduce a quantization adapter (Quadapter), a small set of parameters that are learned to make activations quantization-friendly by scaling them channel-wise. It keeps the model parameters unchanged. By applying our method to the challenging task of quantizing GPT-2, we demonstrate that it effectively prevents the overfitting and improves the quantization performance.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2022, "citationCount": 8, "influentialCitationCount": 1, "openAccessPdf": {"url": "https://arxiv.org/pdf/2211.16912", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "A quantization adapter (Quadapter) is introduced, a small set of parameters that are learned to make activations quantization-friendly by scaling them channel-wise that effectively prevents the overfitting and improves the quantization performance."}, "embedding": {"model": "specter_v2", "vector": [0.2124546468257904, 0.7833436131477356, -0.2458837926387787, 0.09636938571929932, -0.5417159199714661, -0.06452954560518265, 0.7655742764472961, -0.21080391108989716, -0.2947840392589569, -0.5713838934898376, 0.4282812476158142, -0.25084519386291504, 0.6946958303451538, -0.14279673993587494, 0.06741262227296829, 0.06469503045082092, -0.855411946773529, 0.5238855481147766, 0.014354491606354713, -0.4997462332248688, -0.31372302770614624, -0.8021149635314941, -0.9348312616348267, 0.41022080183029175, 0.260375440120697, 1.2870049476623535, 0.017274700105190277, 0.6239075660705566, -0.692599892616272, -0.11591155081987381, 0.5603335499763489, -0.42121607065200806, 0.5860851407051086, 0.18908457458019257, 0.0804629847407341, 0.019426947459578514, 0.5160651803016663, -0.05256999656558037, -0.17667092382907867, 1.0366473197937012, -0.1791725754737854, 0.1655111014842987, 0.4879835247993469, -0.8068429231643677, -0.512200117111206, 0.7619507312774658, 0.6823574900627136, 0.8431507349014282, -0.7242653369903564, -0.48309841752052307, 1.1106590032577515, -1.4590648412704468, -0.3069974184036255, 1.5692414045333862, 0.4782535433769226, 0.572719931602478, -0.3838939964771271, -0.8210193514823914, 0.5442877411842346, -0.2776918113231659, -0.9925357699394226, -0.2091594785451889, -0.2650655210018158, -0.15745513141155243, 1.6688505411148071, -0.34894225001335144, 0.053361084312200546, 0.8043074011802673, 0.08095657825469971, 0.9918282628059387, 0.19073793292045593, -0.7105779647827148, -0.3857855200767517, -0.017094310373067856, -0.14382004737854004, 0.7904561758041382, -0.7139395475387573, 0.5419809818267822, -1.0397377014160156, -0.22799177467823029, 0.7210900783538818, -0.3826628029346466, 0.1978350430727005, 0.2435031533241272, -0.01696689799427986, 0.8146986961364746, 0.4166002571582794, 0.9894516468048096, -0.34869468212127686, 0.8842665553092957, 0.7412393689155579, 0.4386698007583618, 0.0254664346575737, 0.380432665348053, -0.038767050951719284, 0.20885886251926422, -0.891494631767273, 0.11143558472394943, -0.36969736218452454, 0.7653701305389404, 0.01719086244702339, 0.45652687549591064, -1.0718557834625244, 0.16905154287815094, 1.3371007442474365, 0.27798768877983093, 0.7213440537452698, -0.6151890158653259, 0.4584868848323822, -0.8542523384094238, 0.013428796082735062, -0.8096974492073059, 0.0645679384469986, -0.19871225953102112, -0.7068482041358948, -1.5262372493743896, -0.4429737627506256, 0.29221466183662415, -1.0590850114822388, 0.6969017386436462, -0.5570132732391357, -0.32602617144584656, -0.24131812155246735, 0.2465265393257141, 0.28858256340026855, 0.5980525016784668, 0.43325075507164, 0.10075809061527252, 1.2812782526016235, -0.7838875651359558, -0.915661633014679, -0.9000135660171509, 0.6274682283401489, -0.06718233227729797, 0.5830085873603821, -0.03331508859992027, -1.3217508792877197, -1.076111078262329, -0.6246934533119202, 0.10525862872600555, -0.6367186903953552, 0.23395535349845886, 0.9099203944206238, 1.0196280479431152, -1.3729413747787476, 0.7935603260993958, -0.3045068383216858, -0.1188800260424614, 0.5877326726913452, 0.3153783679008484, 0.13024872541427612, 0.04921252280473709, -1.5644309520721436, 0.105317622423172, 0.5820807218551636, -0.5783044695854187, -0.03228728473186493, -0.8674202561378479, -0.8795573115348816, -0.007787841372191906, 0.12914757430553436, -0.4145207405090332, 1.3003848791122437, -0.14718517661094666, -1.4884291887283325, 0.7657309770584106, -0.3894712030887604, -0.07062890380620956, 0.09149106591939926, -0.05811556056141853, -0.68899005651474, -0.3927367627620697, -0.14131398499011993, 0.8839367628097534, 0.6927823424339294, 0.2493155151605606, -0.2114209532737732, 0.07739009708166122, -0.5851777791976929, 0.2155289351940155, -0.8064699769020081, 0.8894750475883484, -0.6006802916526794, -0.48528096079826355, 0.3567783236503601, 0.8445760607719421, 0.04716400057077408, -0.05675441771745682, -0.4624369144439697, -1.1583893299102783, 0.5359382629394531, -0.03735677897930145, 1.00363290309906, -1.1959702968597412, -0.8943656086921692, 0.233157217502594, -0.18139605224132538, -0.423534095287323, -0.6975865364074707, 1.0151008367538452, -0.34204041957855225, 0.7346979379653931, 0.10867917537689209, -1.389211654663086, 0.46947965025901794, -0.11603767424821854, -0.7672175168991089, -0.5504841804504395, 0.21606332063674927, 1.202645182609558, -0.8731486797332764, -0.025969110429286957, -0.28508371114730835, 0.4739568829536438, -1.0081642866134644, 1.1222269535064697, -0.21975678205490112, 0.2810124456882477, -0.1290162205696106, -0.23202326893806458, 0.05539121851325035, -0.06671521812677383, 0.1482478827238083, -0.5794507265090942, -0.21126937866210938, 0.6987808346748352, -0.06615938246250153, 1.5378227233886719, -0.15464718639850616, 0.1787397712469101, -0.43182551860809326, -0.7841094136238098, 0.6551356911659241, 0.755472719669342, -0.1575048416852951, -0.9529240727424622, 0.5086195468902588, 0.8242841362953186, -0.8038612604141235, 0.5274770259857178, 0.972072422504425, 0.3496958911418915, -0.47300395369529724, -0.2616003155708313, 0.55655837059021, -0.56329345703125, 0.3207840323448181, 0.23256206512451172, 0.5619006156921387, -0.024665236473083496, 0.1274726688861847, -0.3903215527534485, 0.10853896290063858, -1.1133368015289307, -0.14842893183231354, 0.4852864444255829, 0.43873947858810425, 0.976094663143158, 0.4152255058288574, -0.6163305044174194, -0.025960268452763557, -0.5051999688148499, 0.7466257214546204, 1.4538547992706299, -0.6153972744941711, -0.40781736373901367, -0.4671247899532318, -0.14790287613868713, -0.4005618393421173, -0.15133324265480042, -0.6750354766845703, -0.40669897198677063, -0.16206517815589905, -0.9459010362625122, 1.003898024559021, -0.05405191704630852, 1.018974781036377, -0.3302779197692871, -0.2423478066921234, -0.36969056725502014, 0.24752573668956757, -0.8241822123527527, -0.8891534805297852, 0.6761631369590759, -0.7308447360992432, 0.27126196026802063, 0.19270792603492737, 0.0037676698993891478, -0.20416949689388275, -1.1503695249557495, 0.9277220964431763, -0.5762875080108643, 0.13452766835689545, -0.14224503934383392, 0.47662752866744995, -0.5033730268478394, -0.7716330289840698, 0.24629975855350494, 0.24115358293056488, 0.10630311816930771, 0.26258036494255066, 0.32864975929260254, -0.03758205100893974, -0.22489310801029205, -0.4553036689758301, 0.04698960855603218, -0.02966175228357315, 0.023892147466540337, 0.8624809980392456, -0.26466429233551025, -0.2221890389919281, -0.9308012127876282, 1.2373210191726685, 0.2693418562412262, -0.3878507912158966, 0.016696831211447716, -0.3812521994113922, -0.30698931217193604, 0.5208241939544678, -0.5533976554870605, -0.0021688861306756735, -1.068549394607544, -0.01278932485729456, -0.5318718552589417, -0.047155845910310745, 0.2498628795146942, 0.21699590981006622, 0.05459044128656387, 0.32493025064468384, 0.37856388092041016, -0.08613667637109756, -0.09129603207111359, 0.6956961154937744, -0.9477418065071106, 0.55489581823349, 0.22006990015506744, 0.1963985562324524, -0.2963888943195343, -0.24616575241088867, -0.6179674863815308, -0.36904940009117126, -0.12404695153236389, 0.011682683601975441, 0.04079950973391533, 0.19494035840034485, -0.4970707595348358, -0.6495362520217896, -0.2963685393333435, -0.8327264189720154, -0.27579641342163086, -0.19550186395645142, -0.4843365252017975, -0.34987494349479675, -1.0987639427185059, -1.2431895732879639, -0.5272971987724304, -0.8609316349029541, -1.125593900680542, 0.629189133644104, -0.08213410526514053, -0.1946055293083191, -0.8332189917564392, -0.1617627739906311, -0.6923831701278687, 1.1257038116455078, -0.7633919715881348, 0.7612409591674805, -0.0320461168885231, 0.11437623202800751, 0.02941954880952835, 0.14954988658428192, 0.7154964208602905, -0.16931265592575073, 0.18796084821224213, -1.1873568296432495, 0.31615614891052246, -0.19249120354652405, -0.19794152677059174, 0.1621917337179184, 0.10865161567926407, 1.0751041173934937, -0.07628020644187927, -0.46655431389808655, 0.5540667772293091, 1.2324217557907104, -0.6562734842300415, 0.08233026415109634, -0.04493481293320656, 0.8014529943466187, -0.027928827330470085, -0.5312626361846924, 0.34941208362579346, 0.38214048743247986, 0.6094068884849548, 0.247762531042099, 0.018468745052814484, -0.1364530324935913, -0.8828416466712952, 0.502518355846405, 1.8078769445419312, 0.672800600528717, -0.02954615093767643, -1.012485146522522, 0.6104986667633057, -0.826102077960968, -0.4193492829799652, 0.7201055884361267, 0.8212918639183044, 0.44392114877700806, -0.36010193824768066, -0.43825334310531616, -0.05958933010697365, 0.1476108431816101, 0.16405907273292542, 0.2521178722381592, -1.2515112161636353, -0.012105862610042095, 0.7642391920089722, 0.1691785305738449, 0.46373337507247925, -0.39486920833587646, 0.6064990758895874, 14.540815353393555, 1.0483425855636597, -0.32148200273513794, 0.5900476574897766, 0.5397281050682068, 0.592906653881073, -0.5622139573097229, -0.2446470856666565, -0.8149159550666809, 0.09477467089891434, 1.2560641765594482, 0.27472707629203796, 0.5978680849075317, -0.45922666788101196, 0.004318189807236195, 0.5197767019271851, -0.4929087162017822, 0.9460101127624512, 0.3138245642185211, -1.0242774486541748, 0.6792613863945007, 0.36141595244407654, 0.2852887213230133, 0.5473238825798035, 1.030868649482727, 0.9439098238945007, 0.10905419290065765, -0.43640223145484924, 0.7335135340690613, 0.08074045181274414, 0.798851728439331, 0.12161818146705627, -0.022749250754714012, 0.4463821053504944, -0.9081608057022095, -0.18545660376548767, -0.46935614943504333, -1.168055534362793, 0.4030362665653229, 0.36862537264823914, -0.6127645373344421, -0.1768052577972412, 0.07179008424282074, 0.48285362124443054, -0.00138351961504668, 0.31171903014183044, -0.18147045373916626, 0.731090247631073, -0.39591047167778015, 0.3404938876628876, 0.7205601930618286, 0.3858236074447632, 0.0015856742393225431, -0.0797685831785202, 0.5524910092353821, -0.35498252511024475, 0.27161121368408203, 0.7438755035400391, -0.7084780335426331, 0.1668793261051178, -0.19693127274513245, -0.46272388100624084, 0.07949507236480713, 0.8790742754936218, 0.36820662021636963, 0.14015905559062958, -0.22022850811481476, 0.5281572341918945, 0.6679332852363586, 0.20022159814834595, -0.2440338134765625, 0.29292094707489014, 0.2872972786426544, -0.3874285817146301, 0.03956249728798866, 0.6334144473075867, 0.11420326679944992, -0.4455634653568268, -0.7944968938827515, -0.31331145763397217, 0.2454889863729477, -0.8056402206420898, -0.8969646692276001, 1.0162094831466675, -0.28974050283432007, -0.023442257195711136, 0.4310925006866455, -0.7723556756973267, -0.22241351008415222, 0.7362330555915833, -1.4076106548309326, -0.7243905663490295, 0.4949238896369934, -0.27508169412612915, -0.6030863523483276, -0.004805335775017738, 1.7373377084732056, 0.3614954352378845, -0.3510797619819641, 0.3195559084415436, -0.33472466468811035, -0.3157534897327423, -0.28423792123794556, -0.966884434223175, 1.1593728065490723, 0.02128523774445057, -0.04782233014702797, 0.13168783485889435, 0.061371900141239166, 0.4580439031124115, -0.5370635390281677, -0.2765311598777771, 0.8495014905929565, -0.7795810103416443, 0.10490342229604721, -0.9718051552772522, -0.8986585736274719, 0.14661207795143127, 0.6433085203170776, -0.1547309011220932, 0.41895774006843567, 0.13018839061260223, -0.8644180297851562, 0.06406905502080917, -0.5639299154281616, 0.27200520038604736, 0.23043809831142426, -1.0962343215942383, -0.17902255058288574, -0.14065709710121155, 0.2606091797351837, -1.0753934383392334, -0.7806113958358765, -0.26478663086891174, 0.05573325604200363, -0.3368919789791107, 0.9013822078704834, -0.15674220025539398, 0.2502259612083435, 1.1072418689727783, -0.5048568844795227, -1.049207329750061, 0.14508117735385895, -1.0472466945648193, 0.25456079840660095, -0.17735765874385834, 0.6955731511116028, -0.6709615588188171, 0.35460662841796875, 0.6555832028388977, -0.07594311237335205, -0.42950522899627686, -0.7127492427825928, -0.4087280035018921, 0.33838850259780884, -0.7393547296524048, 0.3280496895313263, -0.22886811196804047, 0.052963737398386, 0.17360152304172516, 0.7128404974937439, 0.46986958384513855, -0.3687370717525482, -0.9608765244483948, -0.037592656910419464, -0.046639181673526764, -0.12434287369251251, -0.6735589504241943, -0.5262497067451477, -1.5334241390228271, -0.26535335183143616, -1.204938530921936, -0.11369086802005768, -0.7780668139457703, -0.5975449681282043, -0.17324887216091156, -0.49419599771499634, 0.40738487243652344, 0.31517481803894043, 0.08775158226490021, -0.23681923747062683, -0.5055057406425476, -0.05874301865696907, 1.0539089441299438, 0.8572720885276794, -0.705091655254364, 0.15975579619407654, -0.26414695382118225, 0.08051873743534088, 0.008950318209826946, 0.6529347896575928, -0.24725651741027832, -0.9050650000572205, -1.5849207639694214, 0.40155765414237976, -0.44782984256744385, -0.0823029950261116, -0.8053113222122192, 0.4375932216644287, 0.7593386769294739, -0.5857921242713928, 0.1650010496377945, 0.737784743309021, -0.7462539672851562, -0.5831773281097412, 0.18471060693264008, -0.4718771278858185, 0.5430403351783752, 0.6595796346664429, -0.7235316634178162, -0.5582988858222961, 1.0796782970428467, -0.2753324508666992, -0.8133900165557861, -0.5157748460769653, 0.7955862283706665, -0.4937354028224945, 0.20041589438915253, -0.7587903141975403, -0.24769654870033264, -0.8494890928268433, -0.15468990802764893, -0.021599553525447845, 0.2799587845802307, -0.3798394799232483, 1.0320345163345337, 0.3151257634162903, -1.378400206565857, 0.35774827003479004, 0.8020303845405579, 0.21367675065994263, -0.5103409886360168, 0.14757026731967926, 0.5570405721664429, -0.0064114537090063095, 0.7219160199165344, 0.0586555190384388, 0.27498289942741394, -0.5878470540046692, -0.1628066599369049, 0.9229058623313904, -0.43373820185661316, -0.16642461717128754, 1.2863224744796753, -0.15827570855617523, -1.3124737739562988, 0.1251395344734192, -1.6961504220962524, -0.41097474098205566, -0.425398051738739, 0.5135806202888489, -0.36551639437675476, 0.32217586040496826, -0.050916969776153564, -0.256670206785202, 0.08468637615442276, 0.21807032823562622, -0.674963653087616, -0.14800891280174255, 0.05912858620285988, -0.2715544104576111, 0.7890976667404175, 0.876461923122406, -0.9851927757263184, -0.6541045904159546, -0.4917486011981964, -0.41523268818855286, -0.05102882161736488, 0.45451048016548157, -0.12882927060127258, -0.886203944683075, 1.4143816232681274, 0.7661393880844116, 0.6072288155555725, 0.31411921977996826, -0.44810718297958374, -0.004065506160259247, 0.4998699426651001, 0.2328670173883438, -0.6064748167991638, -0.3213966190814972, 1.5172195434570312, 1.1501109600067139, -0.6615070104598999, -0.34065547585487366, -0.47358524799346924, -0.6227888464927673, 0.6478893756866455, 0.06075156480073929, -0.021775104105472565, 1.052963137626648, -0.341296523809433, 0.2438935488462448, -0.14746828377246857, -1.114576816558838, -0.1928616166114807, 0.7269660234451294, 1.1625676155090332, 0.8439276218414307, 0.5610007643699646, 0.20454250276088715, 0.6934878826141357, -0.19216375052928925, -0.04578603059053421, 0.16576075553894043, 0.1750446856021881, -0.05453388765454292, -0.32871001958847046, -0.003051883541047573, 0.7352007627487183, -0.5013929009437561, -1.0056021213531494, 0.3025163412094116, 0.43856269121170044, 0.42168518900871277, 0.5969806909561157, 1.0886037349700928, -0.10007745027542114, 0.9427288174629211, 0.34981632232666016, 0.9485245943069458, -0.6729997992515564, -0.4303496479988098, -0.14149627089500427, -0.8237665891647339, -0.2776935398578644, -0.04553241282701492, -0.2543067932128906, -0.27058905363082886, -0.006122625432908535, 0.29790687561035156, 0.17208917438983917, 0.25193676352500916, 0.8699048757553101, 0.3767147958278656, 0.5217668414115906, -0.24453997611999512, -0.4740879237651825, -0.46428436040878296, -0.9643891453742981, -0.18529674410820007, -0.5173141956329346, -0.45746761560440063, -0.3270042836666107, 0.27257204055786133, -0.4276789724826813]}, "authors": [{"authorId": "144568677", "name": "Minseop Park"}, {"authorId": "2629994", "name": "J. You"}, {"authorId": "41229153", "name": "Markus Nagel"}, {"authorId": "26375572", "name": "Simyung Chang"}], "references": [{"paperId": "e4f82c0a13cae6739239ae0c25a554b6daff35af", "title": "Compression of Generative Pre-trained Language Models via Quantization"}, {"paperId": "29b77089a0a40f46372ce2dca9c3bb2dd5d46b1d", "title": "Fine-Tuning can Distort Pretrained Features and Underperform Out-of-Distribution"}, {"paperId": "7d4b9489c041756b78878b42fb4d664318192cb2", "title": "Neural Network Quantization with AI Model Efficiency Toolkit (AIMET)"}, {"paperId": "007088458d6d508e8a1ffc4dce24750461453d61", "title": "Unsupervised Domain Adaptation with Adapter"}, {"paperId": "73bcf4577284fa116ee73487b7cbb85c8266eaa0", "title": "Understanding and Overcoming the Challenges of Efficient Transformer Quantization"}, {"paperId": "7b8f3f65a98340d6e5ab94bd9a4ccb8f75704fd8", "title": "I-BERT: Integer-only BERT Quantization"}, {"paperId": "755f16fdbbfb0b128adb3cda9c8c2799aea34290", "title": "Extremely Low Bit Transformer Quantization for On-Device Neural Machine Translation"}, {"paperId": "0c0dfe47afcec2e229015f3c8f213d4c88e86b28", "title": "Up or Down? Adaptive Rounding for Post-Training Quantization"}, {"paperId": "8cc855854384755336aa05c5376ea455137bfbce", "title": "LSQ+: Improving low-bit quantization through learnable offsets and better initialization"}, {"paperId": "132ae47905b1a648c095da54b8533e87cf642897", "title": "Fully Quantized Transformer for Machine Translation"}, {"paperId": "ce106590145e89ea4b621c99665862967ccf5dac", "title": "Q8BERT: Quantized 8Bit BERT"}, {"paperId": "a54b56af24bb4873ed0163b77df63b92bd018ddc", "title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter"}, {"paperId": "4fb8fd55b476909a26a8dc594e0ae98d4923ad4d", "title": "Q-BERT: Hessian Based Ultra Low Precision Quantization of BERT"}, {"paperId": "d77123b54dcc8014949584ab624e97298617bcad", "title": "Data-Free Quantization Through Weight Equalization and Bias Correction"}, {"paperId": "dc160709bbe528b506a37ead334f60d258413357", "title": "Learned Step Size Quantization"}, {"paperId": "29ddc1f43f28af7c846515e32cc167bc66886d0c", "title": "Parameter-Efficient Transfer Learning for NLP"}, {"paperId": "2735dd87f42f60dd8f50def5ae51bbbf95318235", "title": "Improving Neural Network Quantization without Retraining using Outlier Channel Splitting"}, {"paperId": "3d8b62c060f8444907e7c975c6ae590373b51ed4", "title": "Quantizing deep convolutional networks for efficient inference: A whitepaper"}, {"paperId": "7cfa5c97164129ce3630511f639040d28db1d4b7", "title": "FiLM: Visual Reasoning with a General Conditioning Layer"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "8f3b80ddc0dd62e6c3369fabb1715990c29e9b9a", "title": "Learning without Forgetting"}, {"paperId": "5ed791f810da580c78df6a052c6b9f2e258f6b0a", "title": "The LAMBADA dataset: Word prediction requiring a broad discourse context"}, {"paperId": "35b91b365ceb016fb3e022577cec96fb9b445dc5", "title": "The Goldilocks Principle: Reading Children's Books with Explicit Memory Representations"}, {"paperId": "0b44fcbeea9415d400c5f5789d6b892b6f98daff", "title": "Building a Large Annotated Corpus of English: The Penn Treebank"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "All of the PPL metrics reported in this work share this configuration"}]}