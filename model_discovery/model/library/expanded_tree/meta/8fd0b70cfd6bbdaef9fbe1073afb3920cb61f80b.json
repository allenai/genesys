{"paperId": "8fd0b70cfd6bbdaef9fbe1073afb3920cb61f80b", "abstract": "Pre-trained language models (e.g., BERT) have achieved significant success in various natural language processing (NLP) tasks. However, high storage and computational costs obstruct pre-trained language models to be effectively deployed on resource-constrained devices. In this paper, we propose a novel BERT distillation method based on many-to-many layer mapping, which allows each intermediate student layer to learn from any intermediate teacher layers. In this way, our model can learn from different teacher layers adaptively for various NLP tasks. %motivated by the intuition that different NLP tasks require different levels of linguistic knowledge contained in the intermediate layers of BERT. In addition, we leverage Earth Mover's Distance (EMD) to compute the minimum cumulative cost that must be paid to transform knowledge from teacher network to student network. EMD enables the effective matching for many-to-many layer mapping. %EMD can be applied to network layers with different sizes and effectively measures semantic distance between the teacher network and student network. Furthermore, we propose a cost attention mechanism to learn the layer weights used in EMD automatically, which is supposed to further improve the model's performance and accelerate convergence time. Extensive experiments on GLUE benchmark demonstrate that our model achieves competitive performance compared to strong competitors in terms of both accuracy and model compression.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2020, "citationCount": 49, "influentialCitationCount": 7, "openAccessPdf": {"url": "https://www.aclweb.org/anthology/2020.emnlp-main.242.pdf", "status": "HYBRID"}, "tldr": {"model": "tldr@v2.0.0", "text": "A novel BERT distillation method based on many-to-many layer mapping, which allows each intermediate student layer to learn from any intermediate teacher layers adaptively for various NLP tasks, is proposed."}, "embedding": {"model": "specter_v2", "vector": [-0.13521794974803925, 0.6292887926101685, -0.5102063417434692, -0.13361117243766785, -0.26730236411094666, -0.10491592437028885, 0.41817131638526917, 0.16519051790237427, -0.8461862802505493, -0.05447150021791458, 0.644304633140564, -0.3499293923377991, -0.07362212985754013, -0.04100805148482323, -0.2109043002128601, 0.2758776843547821, -0.7450626492500305, 0.7975267767906189, -0.11651742458343506, -0.22729137539863586, -0.3763607144355774, -0.6499801278114319, -0.8485148549079895, 0.38661137223243713, 0.8156938552856445, 0.21353144943714142, 0.5065202116966248, 0.9207552075386047, -1.0580902099609375, 0.2105875015258789, 0.46289902925491333, -0.7400032877922058, 0.3706270456314087, 0.3645024299621582, -0.19594790041446686, -0.5487430691719055, 0.01206266786903143, -0.6086400747299194, -0.49316906929016113, 0.881999671459198, 0.01889044977724552, 0.48775914311408997, 0.6993623375892639, -0.3097170889377594, -0.3616659939289093, 1.2671247720718384, 0.695771336555481, 0.8079468607902527, -0.31728890538215637, -0.9357697367668152, 1.192260503768921, -1.4210033416748047, 0.04481113702058792, 1.4994295835494995, 0.179940328001976, 0.4749244451522827, -0.013348047621548176, -0.6030678153038025, 0.4653324782848358, 0.18616341054439545, -0.895487368106842, -0.07028654962778091, -0.11427221447229385, -0.09674263000488281, 1.5785226821899414, -0.39246666431427, 0.08423075824975967, 0.03444547951221466, -0.6535006761550903, 1.64078950881958, -0.10246909409761429, -1.03335440158844, -0.37826594710350037, 0.2856371998786926, -0.15800026059150696, 1.1365972757339478, -0.30711832642555237, 0.36049115657806396, -0.7814294099807739, 0.14617381989955902, 0.17655391991138458, -0.2768135666847229, 0.07014185190200806, 0.1170637384057045, 0.015403950586915016, 0.7375650405883789, 0.5585225224494934, 0.5701874494552612, -0.036768849939107895, 0.2865520715713501, 0.4158482849597931, 0.5584309697151184, 0.04726516082882881, 0.33571112155914307, -0.15044711530208588, 0.34003838896751404, -1.0970500707626343, 0.06534119695425034, 0.17039039731025696, 0.6643193364143372, -0.22065119445323944, 0.12689882516860962, -0.5242450833320618, 0.3194037079811096, 1.392648696899414, -0.27606290578842163, 0.6602242588996887, -0.6911693811416626, 0.6120060682296753, -0.7252009510993958, -0.05603817477822304, -0.6191191077232361, 0.17835822701454163, -0.007731826510280371, -0.9234532713890076, -1.3047747611999512, -0.7225719690322876, -0.2135777324438095, -0.6057077646255493, 0.5232570767402649, -0.25064072012901306, 0.8125331997871399, 0.37366360425949097, 0.4520600140094757, 0.5742248892784119, 0.9466398358345032, -0.09410716593265533, 0.2876625657081604, 0.91259765625, -1.0872089862823486, -0.6210068464279175, -1.032974123954773, 0.8902726173400879, -0.13216081261634827, -0.07690033316612244, -0.5189424157142639, -1.4195797443389893, -0.8508644104003906, -0.8642839789390564, 0.07150688022375107, -0.8755243420600891, 0.17688313126564026, 1.0585976839065552, 0.24116788804531097, -0.9833318591117859, 0.9520046710968018, -0.08338969945907593, -0.027694866061210632, 0.15150350332260132, 0.2835935652256012, 0.13068613409996033, -0.47952595353126526, -1.442368507385254, 0.4936181604862213, 0.9667255878448486, -0.28497010469436646, 0.08099666237831116, -0.46763238310813904, -1.185219645500183, 0.12535284459590912, 0.26512882113456726, -0.6417608261108398, 1.2668278217315674, 0.26209089159965515, -1.3872358798980713, 0.5739298462867737, -0.3450506329536438, -0.024064624682068825, 0.22454200685024261, -0.34883877635002136, -0.7723039388656616, -0.4308147132396698, -0.2492690533399582, 0.6957412958145142, 0.15873481333255768, -0.12962192296981812, -0.11375640332698822, 0.7349365949630737, -0.11164826899766922, 0.17949630320072174, -0.38404878973960876, 1.0213375091552734, -0.5988089442253113, -0.36899128556251526, 0.4355744421482086, 1.1533973217010498, -0.13838064670562744, 0.2581993043422699, -0.2504498362541199, -0.8176347613334656, 0.6777133941650391, -0.12173007428646088, 0.8901479840278625, -1.0321203470230103, -0.5779436826705933, -0.26826637983322144, 0.000529432320035994, 0.43285173177719116, -1.0431132316589355, 0.4814191460609436, -0.22710643708705902, 0.5097653269767761, -0.14526621997356415, -1.1544278860092163, 0.1009979099035263, 0.11107809096574783, -0.7471043467521667, -0.6439411640167236, 0.07032807916402817, 1.0589704513549805, -0.8990917801856995, -0.21943961083889008, 0.0968395322561264, 0.21614746749401093, -1.1454815864562988, 1.2789932489395142, -0.5247287154197693, -0.2490023672580719, -0.04562171921133995, -0.12420277297496796, 0.0980105921626091, 0.13478796184062958, 0.08674030750989914, 0.005220809020102024, -0.233084037899971, 0.8985549807548523, -0.7824142575263977, 1.503495216369629, -0.31715860962867737, 0.6380423307418823, 0.41527777910232544, -0.973576009273529, 0.23531119525432587, 0.687364935874939, -0.44241824746131897, -0.011674185283482075, 0.36427122354507446, 0.8094558715820312, -0.24806639552116394, 0.23983436822891235, 0.8563393950462341, 0.7673211693763733, -0.24918246269226074, 0.19929398596286774, 0.48611271381378174, -0.4574793875217438, 0.6284929513931274, 0.4014541506767273, 0.33366212248802185, -0.05007527396082878, 0.28885483741760254, 0.06182941794395447, 0.315265029668808, -0.9944416284561157, 0.04306880757212639, 0.4304674565792084, 0.5375874042510986, 0.5043288469314575, 0.20852568745613098, -0.4896238148212433, -0.05523941293358803, -0.21191243827342987, 0.6767485737800598, 1.0898935794830322, 0.0855439305305481, -0.3747119903564453, -0.4700595736503601, -0.27559778094291687, 0.03395892307162285, 0.09351541846990585, 0.0710865929722786, -0.10875048488378525, -0.6151386499404907, -0.8331906795501709, 0.9730156064033508, 0.08580911159515381, 1.0850063562393188, -0.3475181758403778, 0.33858731389045715, -0.27065548300743103, 0.1635001003742218, -0.7911648750305176, -0.2832871675491333, 0.3795648515224457, -0.44298475980758667, 0.06294947862625122, -0.04094870388507843, -0.35824325680732727, 0.17142809927463531, -0.6227036714553833, 0.689816415309906, -0.376857727766037, -0.38189831376075745, -0.38471972942352295, 0.6281939148902893, -0.705748438835144, -0.7070397734642029, 0.025681668892502785, 0.4645940065383911, -0.4849202036857605, 0.37783846259117126, 0.47841814160346985, 0.1647573858499527, -0.2474503070116043, -0.48089760541915894, 0.3522275388240814, 0.13931548595428467, -0.09490005671977997, 0.4742640554904938, 0.16721342504024506, -0.25939735770225525, -0.850738525390625, 0.9082641005516052, 0.1987389475107193, -0.5208778381347656, -0.03378120809793472, -0.554294228553772, -0.3277081549167633, 0.5010116100311279, -0.6045251488685608, -0.023568395525217056, -1.2524443864822388, 0.06325293332338333, -0.4045152962207794, -0.04624469578266144, 0.6242367029190063, 0.34882795810699463, 0.36456915736198425, -0.1149895191192627, 0.11812425404787064, 0.16644421219825745, -0.48692309856414795, 0.9491909146308899, -0.4901224672794342, 0.6614503264427185, -0.00950243603438139, 0.4433591365814209, -0.3835119903087616, -0.5620589256286621, -0.35369715094566345, -0.5421987771987915, -0.5074381232261658, -0.2456132471561432, 0.027133945375680923, 0.4483974874019623, -0.7822315096855164, -0.44095665216445923, -0.43875744938850403, -1.2744767665863037, -0.19902890920639038, -0.07917069643735886, 0.1576322317123413, 0.1270214319229126, -1.1086523532867432, -1.5895750522613525, -0.4999787509441376, -0.355907678604126, -0.9383544325828552, 0.35322046279907227, -0.025036443024873734, -0.05028071999549866, -0.5779914259910583, -0.2264157235622406, -0.5176242589950562, 0.9713062644004822, -0.8892493844032288, 1.3037188053131104, -0.10664954781532288, -0.23069389164447784, -0.1578730344772339, -0.19085055589675903, 0.47109177708625793, -0.41077864170074463, 0.15357175469398499, -0.4482596814632416, 0.39120519161224365, -0.5051411390304565, -0.15758904814720154, 0.2785570025444031, 0.1743139624595642, 0.8783599734306335, -0.16291935741901398, -0.5266477465629578, 0.5649224519729614, 1.4393627643585205, -0.8800275921821594, 0.13419198989868164, 0.040079470723867416, 0.696571946144104, 0.21791033446788788, -0.6185997128486633, 0.11708362400531769, 0.2000812590122223, 0.2502087652683258, 0.17332786321640015, -0.25374066829681396, -0.018391381949186325, -0.6585450172424316, 0.40878862142562866, 2.4074318408966064, 0.6890093088150024, -0.1715463250875473, -0.8929807543754578, 0.4808078408241272, -1.193665623664856, -0.5676468014717102, 0.773619532585144, 0.36299604177474976, 0.4490583837032318, -0.2619607448577881, -0.7599713802337646, -0.32546716928482056, 0.49001580476760864, 0.539201021194458, 0.057509418576955795, -1.0508605241775513, 0.04545268788933754, 0.547488808631897, 0.052773118019104004, 0.8952813148498535, -0.3558138310909271, 0.8274762034416199, 14.657256126403809, 0.8848004937171936, 0.10581929981708527, 0.4850826859474182, 0.3231729567050934, 0.22149749100208282, -0.4629697799682617, -0.1893252730369568, -1.4303284883499146, 0.1030862033367157, 1.004211187362671, -0.05540788918733597, 0.5573927760124207, 0.035027846693992615, -0.10916363447904587, 0.2938813269138336, -0.4277966022491455, 0.6646581292152405, 0.44980552792549133, -1.5201852321624756, 0.5853654146194458, 0.2206260859966278, 0.348922997713089, 0.5825791954994202, 0.4386851489543915, 0.9385446310043335, 0.6307389140129089, -0.6514996886253357, 0.3360436260700226, 0.25180211663246155, 0.86927330493927, 0.07514124363660812, 0.7048541307449341, 1.0429688692092896, -1.0755903720855713, -0.18267419934272766, -0.7653692364692688, -1.1706277132034302, 0.3803539276123047, 0.39557206630706787, -0.27441850304603577, -0.3933470547199249, -0.36091819405555725, 0.485366553068161, 0.5944637060165405, 0.6009818911552429, -0.16862262785434723, 0.42235511541366577, -0.39361321926116943, -0.009926551952958107, 0.4571234881877899, 0.16786319017410278, 0.3405851423740387, 0.02153838612139225, 0.48791205883026123, -0.16254690289497375, 0.4820556640625, 0.5675356984138489, -0.8855206370353699, -0.05165798217058182, -0.49649104475975037, -0.3759792447090149, 0.1597248613834381, 0.5085930824279785, 0.650907576084137, 0.061348773539066315, -0.3901957869529724, 0.7008353471755981, 0.9674611687660217, 0.18534812331199646, -0.1259320229291916, -0.3955545127391815, 0.6280262470245361, -0.34074562788009644, -0.06473105400800705, 0.3454045057296753, -0.05385579913854599, -0.34402480721473694, -0.7071433067321777, -0.03849257901310921, 0.32451802492141724, -0.8425260186195374, -0.7343471646308899, 0.9104445576667786, -0.3364393413066864, -0.5025927424430847, 0.14490322768688202, -1.0470417737960815, -0.27927953004837036, 0.5882412791252136, -1.9260289669036865, -0.1072826087474823, 0.5590723752975464, -0.5137013792991638, -0.36196333169937134, -0.18209107220172882, 1.5149672031402588, 0.6054443120956421, -0.3040398061275482, -0.08562973141670227, 0.3084286153316498, 0.47701603174209595, -0.3363891839981079, -0.899832546710968, 0.5773344039916992, 0.3251435458660126, 0.07381978631019592, 0.21876788139343262, -0.531995952129364, 0.19296300411224365, -0.3707750737667084, -0.3988233506679535, 1.0512769222259521, -0.4031231105327606, -0.3549760580062866, -0.8027786016464233, -0.7131043076515198, 0.08046533912420273, 0.6597862839698792, -0.41186341643333435, 0.4872521162033081, -0.05409543961286545, -0.565892219543457, 0.12974236905574799, -0.7862156629562378, 0.4971393048763275, 0.38933804631233215, -1.0400495529174805, -0.49211207032203674, 0.08759003132581711, 0.6759490370750427, -1.01852548122406, -0.36275872588157654, 0.05903574451804161, -0.09124387800693512, 0.1461680680513382, 1.1484553813934326, -0.3563723862171173, 0.868511438369751, 0.7391876578330994, -0.21974769234657288, -0.7850636839866638, 0.1463240534067154, -1.0424754619598389, -0.19707603752613068, -0.2233179360628128, 0.9844150543212891, -0.15173150599002838, 0.34081295132637024, 0.8396531939506531, 0.04546292871236801, -0.6298680901527405, -0.5894699096679688, -0.3750733733177185, 0.09303969144821167, -0.6147031188011169, 0.5920956134796143, 0.15892662107944489, 0.08836501836776733, -0.058405667543411255, 0.7363616228103638, 0.6836640238761902, -0.5601221323013306, -0.8292477130889893, 0.1504981517791748, -0.3228429853916168, -0.3529027998447418, -0.64627605676651, -0.3099474012851715, -1.7334312200546265, 0.3683256208896637, -1.6751586198806763, 0.025324612855911255, -1.2802361249923706, -0.6347654461860657, -0.18089330196380615, -0.14433452486991882, -0.3138217628002167, 0.4301069974899292, -0.34109315276145935, -0.2920532524585724, -0.5340964794158936, -0.17044340074062347, 0.9682691693305969, 0.8569114804267883, -0.5840283036231995, -0.051232896745204926, -0.204188734292984, 0.0907672643661499, 0.5312266945838928, 0.3758018910884857, -0.31927573680877686, -0.5505843162536621, -1.7852966785430908, 0.22576041519641876, -0.008755999617278576, -0.32285743951797485, -0.582569420337677, 0.9796385765075684, 0.5326383113861084, -0.5516260862350464, -0.04883617162704468, 0.7686295509338379, -0.9390316009521484, -0.8897138833999634, 0.34764283895492554, -0.7404744625091553, 0.24378907680511475, 0.18150724470615387, -0.5263614654541016, -0.5362840294837952, 0.31424564123153687, -0.22651003301143646, -1.004789113998413, -0.6926462650299072, 0.5555049777030945, -0.515407383441925, -0.03514142334461212, -0.38000625371932983, -0.008542525582015514, -0.9749699831008911, -0.22366546094417572, 0.061053674668073654, 0.3871603310108185, -1.0743186473846436, 0.7425242066383362, 0.48994046449661255, -1.2268661260604858, -0.044813886284828186, 0.7158084511756897, -0.3297811448574066, 0.21505992114543915, -0.056050438433885574, 0.1965678185224533, -0.6024571657180786, 0.33716991543769836, 0.8332452774047852, 0.6478014588356018, -0.7678542137145996, -0.3794490396976471, 0.7905243635177612, -0.4541179835796356, -0.5643000602722168, 1.358130693435669, -0.9693079590797424, -1.4949926137924194, 0.5504024028778076, -1.2721387147903442, -0.2979441285133362, -0.5592877864837646, 0.6154452562332153, 0.03787381201982498, -0.12715904414653778, 0.2422400712966919, -0.12215518206357956, -0.08769264072179794, 0.011554730124771595, -0.7422335743904114, 0.4199441373348236, -0.0036190554965287447, -0.6171150207519531, 0.387633353471756, 0.9468034505844116, -0.7628079056739807, -0.17499680817127228, -0.7747641205787659, -0.18199846148490906, -0.330821692943573, 0.3486045300960541, -0.34029918909072876, -0.3387914001941681, 0.903529167175293, -0.05198941379785538, 0.18739184737205505, -0.06413033604621887, -0.24307210743427277, 0.8215941190719604, 0.937592625617981, -0.07797403633594513, -0.6656727194786072, -0.7710568308830261, 1.5812265872955322, 0.8483741879463196, -0.7774131298065186, 0.022629741579294205, -0.4688246548175812, -0.27577897906303406, 0.6127638816833496, 0.29106613993644714, 0.022202352061867714, 1.2556819915771484, 0.28522107005119324, 0.14546571671962738, 0.15332412719726562, -0.8028618693351746, -0.5956389307975769, 0.8752881288528442, 1.0149571895599365, 0.6423945426940918, 0.44935426115989685, 0.08025103062391281, 0.8919943571090698, -0.33769506216049194, -0.07276111841201782, 0.23646259307861328, 0.2700742483139038, -0.47081688046455383, -0.3085107207298279, 0.1971755027770996, 0.8355837464332581, -0.4308536648750305, -0.945206880569458, 0.01079394482076168, 0.6903133392333984, 0.1825181543827057, 0.5696481466293335, 0.9526270627975464, 0.07867558300495148, 0.3841014802455902, 0.28717920184135437, 0.08417067676782608, -0.6339122653007507, -0.039460211992263794, -0.37570980191230774, -0.5710188150405884, 0.07357469946146011, -0.061140887439250946, -0.057501114904880524, -0.6503414511680603, -0.6272988319396973, 0.3910538852214813, 0.29110074043273926, 0.5737088918685913, 1.1083388328552246, 0.46843481063842773, 0.49429577589035034, -0.4929906725883484, -0.21040771901607513, -0.3017024099826813, -0.5900284051895142, -0.3305480480194092, -0.7652713656425476, -0.4020357131958008, 0.10080444812774658, -0.24323827028274536, -0.7238022089004517]}, "authors": [{"authorId": "2130169642", "name": "Jianquan Li"}, {"authorId": "2109002553", "name": "Xiaokang Liu"}, {"authorId": "2146229494", "name": "Honghong Zhao"}, {"authorId": "1753529", "name": "Ruifeng Xu"}, {"authorId": "2110950699", "name": "Min Yang"}, {"authorId": "73110244", "name": "Yaohong Jin"}], "references": [{"paperId": "2573af4e13d9a5dddb257d22cd38a600528d9a8b", "title": "MobileBERT: a Compact Task-Agnostic BERT for Resource-Limited Devices"}, {"paperId": "c6c734e16f66fbfcefac7625cc64599e83292c1e", "title": "MiniLM: Deep Self-Attention Distillation for Task-Agnostic Compression of Pre-Trained Transformers"}, {"paperId": "2e27f119e6fcc5477248eb0f4a6abe8d7cf4f6e7", "title": "BERT-of-Theseus: Compressing BERT by Progressive Module Replacing"}, {"paperId": "83b8108014e3db4f46354a28ae68193f143c4e7e", "title": "Structured Pruning of Large Language Models"}, {"paperId": "c1957e25155d713e7599b9d7e1e318c03cd2631a", "title": "Distilling Transformers into Simple Neural Networks with Unlabeled Transfer Data"}, {"paperId": "0cbf97173391b0430140117027edcaf1a37968c7", "title": "TinyBERT: Distilling BERT for Natural Language Understanding"}, {"paperId": "4fb8fd55b476909a26a8dc594e0ae98d4923ad4d", "title": "Q-BERT: Hessian Based Ultra Low Precision Quantization of BERT"}, {"paperId": "80cf2a6af4200ecfca1c18fc89de16148f1cd4bf", "title": "Patient Knowledge Distillation for BERT Model Compression"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "95a251513853c6032bdecebd4b74e15795662986", "title": "What Does BERT Look at? An Analysis of BERT\u2019s Attention"}, {"paperId": "5f994dc8cae24ca9d1ed629e517fcc652660ddde", "title": "ERNIE: Enhanced Language Representation with Informative Entities"}, {"paperId": "a08293b2c9c5bcddb023cc7eb3354d4d86bfae89", "title": "Distilling Task-Specific Knowledge from BERT into Simple Neural Networks"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "3febb2bed8865945e7fddc99efd791887bb7e14f", "title": "Deep Contextualized Word Representations"}, {"paperId": "1e077413b25c4d34945cc2707e17e46ed4fe784a", "title": "Universal Language Model Fine-tuning for Text Classification"}, {"paperId": "6494cd26511c076186673c9a636d21d1dfed8d5a", "title": "Student-teacher network learning with enhanced features"}, {"paperId": "892e53fe5cd39f037cb2a961499f42f3002595dd", "title": "Bag of Tricks for Efficient Text Classification"}, {"paperId": "f37e1b62a767a307c046404ca96bc140b3e68cb5", "title": "GloVe: Global Vectors for Word Representation"}, {"paperId": "87f40e6f3022adbc1f1905e3e506abad05a9964f", "title": "Distributed Representations of Words and Phrases and their Compositionality"}, {"paperId": "326cfa1ffff97bd923bb6ff58d9cb6a3f60edbe5", "title": "The Earth Mover's Distance as a Metric for Image Retrieval"}, {"paperId": "4c2f48e5be59c178cec404fe8f951e8e28bb1e39", "title": "The Distribution of a Product from Several Sources to Numerous Localities"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": "dd3db834acb2522339ce70d937b39901f49dea69", "title": "The Monge\u2013Kantorovich Mass Transference Problem and Its Stochastic Applications"}]}