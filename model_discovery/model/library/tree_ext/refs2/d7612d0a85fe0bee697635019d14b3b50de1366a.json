{
    "paperId": "d7612d0a85fe0bee697635019d14b3b50de1366a",
    "externalIds": {
        "DBLP": "conf/mlnlp/Qu23",
        "DOI": "10.1145/3639479.3639514",
        "CorpusId": 268172252
    },
    "title": "GPT Rotational Position Embedding for Length Extrapolation",
    "abstract": "Since the introduction of the GPT model as the mainstream model for dialog generation, a hot issue is how to enable the model to extend the prediction length and generate longer dialog texts while the training context length remains constant. Rotary incorporates absolute position information in the form of relative position encoding, an approach that has been shown to be advantageous for extrapolating on transformer models. However, in the actual extrapolation process, when the prediction length is too long, its perplexity climbs sharply. In order to solve the above problems, this paper proposes a method of scaling frequency basis. In contrast to the previous manual test for selecting the optimal parameter \u0251, this method allows the model to dynamically train the parameters based on the input sequence length to obtain the optimal \u0251. Using this method, we demonstrate that the GPT model can effectively extrapolate to contexts that are longer than its original pre-training length. In addition, in order to verify the effectiveness of this method in practical applications, this paper applies it to the field of medical dialog generation, which is a more complex scenario, and the experimental results demonstrate that the extrapolation length is several times the length of the training context, which greatly enhances the extrapolation performance compared to the original absolute position coding.",
    "venue": "MLNLP",
    "year": 2023,
    "referenceCount": 15,
    "citationCount": 1,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A method of scaling frequency basis is proposed that allows the model to dynamically train the parameters based on the input sequence length to obtain the optimal \u0251 and demonstrates that the GPT model can effectively extrapolate to contexts that are longer than its original pre-training length."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -5.387455940246582,
            -1.8475085496902466,
            -2.158632278442383,
            2.714059829711914,
            -0.11788469552993774,
            2.6101715564727783,
            1.7946332693099976,
            -0.9046378135681152,
            0.987883985042572,
            0.8909397721290588,
            -0.5109920501708984,
            2.9544715881347656,
            1.7473200559616089,
            3.5495173931121826,
            -2.7804718017578125,
            1.3488924503326416,
            1.477156639099121,
            -1.6173127889633179,
            1.8438899517059326,
            1.4730451107025146,
            -2.504812240600586,
            1.5644054412841797,
            -3.4812891483306885,
            -2.07922625541687,
            1.532185435295105,
            0.0520537793636322,
            3.1979305744171143,
            2.6519834995269775,
            -3.5500965118408203,
            -1.227565050125122,
            1.7956492900848389,
            -3.8309240341186523,
            2.9930639266967773,
            -4.706778526306152,
            0.5844316482543945,
            -5.053637504577637,
            -0.35437265038490295,
            8.057448387145996,
            -6.6607770919799805,
            -2.912827253341675,
            -1.9905520677566528,
            1.8842575550079346,
            -2.6012096405029297,
            2.942359447479248,
            -1.8414753675460815,
            1.737494945526123,
            6.534276008605957,
            -0.5843157768249512,
            -0.10057120025157928,
            2.2984139919281006,
            3.4650187492370605,
            0.19671082496643066,
            1.3163576126098633,
            3.3548576831817627,
            2.289559841156006,
            0.17622369527816772,
            -0.7707304954528809,
            -0.7374362349510193,
            -0.714070200920105,
            -1.7990355491638184,
            2.1933770179748535,
            7.768303871154785,
            2.1970748901367188,
            0.777329683303833,
            2.778049945831299,
            -1.9369196891784668,
            -1.839489221572876,
            7.107789039611816,
            5.146099090576172,
            2.547999382019043,
            -4.3011932373046875,
            -7.148219585418701,
            -1.8646705150604248,
            0.21224653720855713,
            -1.8762304782867432,
            -3.823838710784912,
            -1.6959601640701294,
            -2.6068968772888184,
            1.4886929988861084,
            -2.914762258529663,
            0.2610686421394348,
            1.8938225507736206,
            0.4769848585128784,
            0.4305715560913086,
            5.606931686401367,
            0.928514838218689,
            -3.8894810676574707,
            1.9175379276275635,
            1.3959510326385498,
            -1.9684908390045166,
            -3.3574469089508057,
            -1.2925487756729126,
            0.2751907706260681,
            4.832904815673828,
            -4.5071892738342285,
            -0.7018687129020691,
            -0.5287814140319824,
            -0.8870024681091309,
            -0.6757781505584717,
            3.058002471923828,
            2.2376017570495605,
            -0.8902372121810913,
            3.1583189964294434,
            -2.150858163833618,
            2.0868966579437256,
            -4.477349281311035,
            -1.136155366897583,
            1.127678394317627,
            2.6935882568359375,
            -4.676916122436523,
            -4.052713394165039,
            0.6553071737289429,
            -1.7730175256729126,
            0.4810471534729004,
            -3.0757954120635986,
            -4.072751045227051,
            -0.6386574506759644,
            0.7829794883728027,
            0.8862552642822266,
            0.4963182508945465,
            -0.42444294691085815,
            -1.7870118618011475,
            -0.9665605425834656,
            -0.624153196811676,
            1.0131254196166992,
            5.308628082275391,
            -1.1978759765625,
            4.03647518157959,
            0.13059450685977936,
            -3.882233142852783,
            0.22144189476966858,
            -3.908416748046875,
            4.253229141235352,
            -2.4733009338378906,
            2.170219898223877,
            3.9254415035247803,
            -0.5589833855628967,
            -1.1606253385543823,
            -1.4357044696807861,
            -0.8886337280273438,
            1.6856509447097778,
            10.593923568725586,
            -2.4769914150238037,
            0.18311884999275208,
            4.535039901733398,
            1.874232530593872,
            1.2261621952056885,
            0.5899922847747803,
            0.9720277190208435,
            7.069308280944824,
            2.6844887733459473,
            -2.6790666580200195,
            2.524207592010498,
            0.7368432283401489,
            3.5596625804901123,
            5.147302627563477,
            -1.8160418272018433,
            3.02824330329895,
            -0.6118484735488892,
            -0.4405704736709595,
            -2.9889402389526367,
            0.2754684090614319,
            -8.90346622467041,
            -2.243471145629883,
            1.9789841175079346,
            -6.58212947845459,
            -2.058570146560669,
            -0.0080946683883667,
            -0.3861212134361267,
            2.786667823791504,
            -0.19771990180015564,
            0.4727921485900879,
            1.46382737159729,
            4.259646415710449,
            7.714651107788086,
            4.715295791625977,
            3.453766345977783,
            -3.255190849304199,
            3.974250316619873,
            2.4100353717803955,
            -1.0329228639602661,
            -1.5432281494140625,
            -6.729853630065918,
            -0.5959307551383972,
            -5.09593391418457,
            -4.248625755310059,
            -4.541733741760254,
            -2.4199299812316895,
            -0.4332280457019806,
            -2.0731191635131836,
            1.1501007080078125,
            -0.23437541723251343,
            4.062958240509033,
            5.7211713790893555,
            3.830491542816162,
            -0.046749770641326904,
            -1.8979299068450928,
            2.0141711235046387,
            -1.2124043703079224,
            1.6252808570861816,
            4.862485885620117,
            0.45020878314971924,
            0.15688341856002808,
            -1.9580647945404053,
            0.637336254119873,
            2.3903236389160156,
            -3.3998191356658936,
            2.4730987548828125,
            2.5809640884399414,
            3.2035460472106934,
            0.45657914876937866,
            -1.8911237716674805,
            0.18634290993213654,
            1.7151062488555908,
            -5.0171003341674805,
            -0.8198252320289612,
            -7.119490146636963,
            2.9305672645568848,
            4.056236267089844,
            0.9904343485832214,
            -1.9564242362976074,
            4.486604690551758,
            1.380843162536621,
            -3.551921844482422,
            2.021878480911255,
            -3.5835471153259277,
            5.464409828186035,
            2.806255578994751,
            1.7694282531738281,
            -0.517527163028717,
            -3.3549070358276367,
            -2.9956414699554443,
            0.42701274156570435,
            -1.384491205215454,
            -6.281746864318848,
            0.25985434651374817,
            -4.100740432739258,
            -0.6971759796142578,
            -0.9369312524795532,
            -1.9727420806884766,
            10.397327423095703,
            1.0977060794830322,
            -0.6109868288040161,
            2.6275906562805176,
            2.7757129669189453,
            -3.6612322330474854,
            0.7806705832481384,
            -3.3336658477783203,
            -4.196690559387207,
            0.8527654409408569,
            -2.4794111251831055,
            0.3841695189476013,
            2.38084077835083,
            -0.993060827255249,
            0.31303954124450684,
            2.932852268218994,
            -1.3738315105438232,
            -0.813569962978363,
            4.290177345275879,
            -1.626645803451538,
            -1.919451117515564,
            6.894472599029541,
            -1.6279864311218262,
            2.6200737953186035,
            -3.636249542236328,
            -2.2495150566101074,
            -2.4546284675598145,
            -1.8863985538482666,
            -1.6738555431365967,
            2.9272642135620117,
            -0.9278081059455872,
            2.33532977104187,
            -3.903663158416748,
            -4.158424377441406,
            -3.2782506942749023,
            -5.097328186035156,
            -0.7032821178436279,
            -1.3641613721847534,
            4.381163597106934,
            3.746487617492676,
            0.31370654702186584,
            -2.3487963676452637,
            0.5307705402374268,
            -0.42085444927215576,
            -1.6234909296035767,
            -1.0234650373458862,
            -3.3115243911743164,
            2.3413538932800293,
            -1.8080241680145264,
            -4.5579023361206055,
            -5.273366928100586,
            4.465516567230225,
            -4.356584072113037,
            0.04138186573982239,
            -2.7235169410705566,
            0.919189989566803,
            4.816936492919922,
            -1.4741523265838623,
            -1.7829426527023315,
            -4.7712507247924805,
            -0.35085329413414,
            0.6004351377487183,
            1.9397343397140503,
            2.5324697494506836,
            0.859008252620697,
            3.8812520503997803,
            -1.9933406114578247,
            -0.12421101331710815,
            -2.5655503273010254,
            -5.303094863891602,
            -0.15695053339004517,
            1.501469373703003,
            3.5445032119750977,
            -4.3439178466796875,
            2.4796957969665527,
            1.11143958568573,
            2.000349521636963,
            -1.0263903141021729,
            -7.840014457702637,
            1.853261947631836,
            -0.7341644763946533,
            0.09259700775146484,
            -3.962156295776367,
            -3.3972959518432617,
            0.8431199789047241,
            -0.6441854238510132,
            -0.3492853343486786,
            1.1156843900680542,
            -1.781105399131775,
            3.9305429458618164,
            3.983642578125,
            2.641963481903076,
            1.4312772750854492,
            2.356985569000244,
            -2.2864699363708496,
            -6.066193580627441,
            -1.2632406949996948,
            -2.717393159866333,
            1.9878315925598145,
            2.388221502304077,
            1.4679218530654907,
            4.598283767700195,
            -3.412015676498413,
            1.1533540487289429,
            -1.5275543928146362,
            -0.5132988691329956,
            3.6027908325195312,
            -0.3637244701385498,
            -0.8934300541877747,
            -1.4032092094421387,
            2.9714608192443848,
            -1.8419766426086426,
            2.848616123199463,
            0.25455164909362793,
            -1.0319595336914062,
            2.105459451675415,
            1.2466495037078857,
            0.09248298406600952,
            3.538280487060547,
            -1.044013261795044,
            -2.077359676361084,
            -2.001769781112671,
            2.7654600143432617,
            -1.574944257736206,
            -0.6055765151977539,
            -1.811197280883789,
            11.242280960083008,
            -4.543209075927734,
            1.5165653228759766,
            -5.729710102081299,
            2.9948642253875732,
            -3.562295436859131,
            -6.470290184020996,
            4.533037185668945,
            -0.2237534373998642,
            -2.762277126312256,
            1.346444845199585,
            -2.9829788208007812,
            3.230698585510254,
            -0.9186419248580933,
            -0.18989688158035278,
            2.588599681854248,
            3.2382726669311523,
            4.6788740158081055,
            -2.9405651092529297,
            -0.8653050661087036,
            -0.7957814931869507,
            4.385236740112305,
            4.250201225280762,
            -2.349830150604248,
            0.07220867276191711,
            -0.48937031626701355,
            1.0837202072143555,
            -0.04710543155670166,
            -5.197808742523193,
            -3.3746650218963623,
            -3.8930420875549316,
            -5.550501823425293,
            4.1608171463012695,
            -1.7020896673202515,
            -0.1545501947402954,
            -1.6867886781692505,
            2.326836109161377,
            -0.15326541662216187,
            -4.117903709411621,
            -1.2198295593261719,
            6.267647743225098,
            -0.49861693382263184,
            0.9495883584022522,
            -0.23608359694480896,
            -3.153703451156616,
            -2.1326746940612793,
            -1.1808192729949951,
            -6.47611141204834,
            -1.6127572059631348,
            -1.3418842554092407,
            5.217599868774414,
            1.9635593891143799,
            6.156583786010742,
            3.654974937438965,
            -0.7492386102676392,
            2.234039783477783,
            5.442245960235596,
            3.899425745010376,
            -1.0504446029663086,
            1.066758632659912,
            3.5236120223999023,
            0.7478572726249695,
            -3.1844711303710938,
            1.335655689239502,
            -3.6324028968811035,
            7.311554908752441,
            -1.945317029953003,
            -0.13121283054351807,
            -1.9572430849075317,
            4.05062198638916,
            0.9620748162269592,
            -0.17101812362670898,
            3.925452709197998,
            -4.7941412925720215,
            -1.0342762470245361,
            5.530193328857422,
            -3.25252366065979,
            4.378978252410889,
            2.9559288024902344,
            2.666600227355957,
            1.9715522527694702,
            -1.713594675064087,
            -5.191076278686523,
            -3.5970964431762695,
            2.7840466499328613,
            -5.473721981048584,
            -7.096314430236816,
            1.7665226459503174,
            -1.2119560241699219,
            3.6531126499176025,
            -2.652067184448242,
            -1.2928099632263184,
            -2.680896759033203,
            1.4857816696166992,
            0.8035850524902344,
            0.3859769105911255,
            -1.0205167531967163,
            3.5459916591644287,
            -3.2178640365600586,
            3.4517104625701904,
            0.060627639293670654,
            -1.884568691253662,
            0.223627507686615,
            0.4854249954223633,
            -0.8236009478569031,
            1.578162431716919,
            -1.075096607208252,
            -6.100729942321777,
            0.4344005882740021,
            -0.4736335277557373,
            4.707940101623535,
            -2.7618138790130615,
            -1.9604713916778564,
            -8.782505989074707,
            -4.392200946807861,
            0.04326993227005005,
            4.331478118896484,
            -0.4346642792224884,
            -3.9807679653167725,
            1.9018161296844482,
            5.499457359313965,
            2.2044460773468018,
            3.54539155960083,
            -0.6580066084861755,
            0.7598369121551514,
            0.8350191116333008,
            2.221468448638916,
            -0.6465631127357483,
            -2.6459455490112305,
            -0.5969017148017883,
            -6.539456367492676,
            -0.2483934760093689,
            4.7957963943481445,
            1.6384117603302002,
            1.8993901014328003,
            -3.217769145965576,
            -0.7169487476348877,
            2.400134563446045,
            -2.4292654991149902,
            3.824803352355957,
            5.679670333862305,
            1.258255958557129,
            -3.192905902862549,
            0.013361319899559021,
            -0.5333895683288574,
            2.8407280445098877,
            -1.64767587184906,
            2.806541681289673,
            -2.070206642150879,
            -3.6577484607696533,
            3.6548540592193604,
            -0.4308290481567383,
            2.952685832977295,
            -1.6858206987380981,
            2.1526803970336914,
            0.05652719736099243,
            2.730380058288574,
            2.0513482093811035,
            3.7383179664611816,
            0.7826656103134155,
            0.14791274070739746,
            0.5762175917625427,
            2.5034499168395996,
            3.760587692260742,
            7.287402629852295,
            3.241644859313965,
            3.7705278396606445,
            -2.4563212394714355,
            -1.308340072631836,
            -5.993719100952148,
            2.0727460384368896,
            2.7846245765686035,
            -2.562748908996582,
            2.622077226638794,
            1.2408725023269653,
            0.13086682558059692,
            2.798189878463745,
            0.7454622387886047,
            -0.11957940459251404,
            4.519317626953125,
            1.977197289466858,
            -0.9199724197387695,
            -1.5251343250274658,
            -0.27899426221847534,
            3.0014612674713135,
            -0.725661039352417,
            1.1778979301452637,
            -3.999713182449341,
            -3.2245821952819824,
            -2.214834451675415,
            -1.9603580236434937,
            -2.218010902404785,
            -0.47312474250793457,
            6.818410873413086,
            3.8197202682495117,
            -1.6504344940185547,
            -0.5898720026016235,
            1.9070419073104858,
            -6.997316837310791,
            -2.7896738052368164,
            -3.6300485134124756,
            4.000903129577637,
            -0.3578139543533325,
            -1.9720356464385986,
            -0.7126694917678833,
            -1.8452955484390259,
            1.2041325569152832,
            -1.161474585533142,
            -0.05271419882774353,
            0.3496262729167938,
            3.5535197257995605,
            4.409320831298828,
            -0.8292127847671509,
            -1.406327724456787,
            -1.2489396333694458,
            -3.2235922813415527,
            -5.147971153259277,
            -4.1891279220581055,
            2.5863711833953857,
            -3.021998405456543,
            -3.874882698059082,
            0.40085968375205994,
            -6.207236289978027,
            -0.06308594346046448,
            1.6619987487792969,
            -1.5039277076721191,
            -0.8533487319946289,
            -2.074498176574707,
            0.2420991063117981,
            -0.9966340661048889,
            2.8779678344726562,
            3.5397205352783203,
            2.1291208267211914,
            2.395488977432251,
            4.322442531585693,
            4.417634010314941,
            2.4891388416290283,
            4.219109058380127,
            1.3594740629196167,
            -1.2919201850891113,
            3.6251425743103027,
            1.4689586162567139,
            -4.7373046875,
            1.1175627708435059,
            0.1338515281677246,
            3.172321319580078,
            16.78775405883789,
            -0.8717307448387146,
            -1.4862146377563477,
            -0.1476796567440033,
            -0.5060055255889893,
            -4.066738128662109,
            -2.7807083129882812,
            1.7436854839324951,
            2.683966636657715,
            4.675380706787109,
            1.4841740131378174,
            -6.082594871520996,
            2.3628993034362793,
            0.7989222407341003,
            -3.9152417182922363,
            -2.8551185131073,
            -6.106222629547119,
            6.882225513458252,
            -2.940016269683838,
            -3.999424934387207,
            -1.5787932872772217,
            3.6487109661102295,
            -1.0940418243408203,
            -1.805497169494629,
            -2.5193982124328613,
            3.348386764526367,
            1.6041181087493896,
            0.23107817769050598,
            -2.3906869888305664,
            -1.5967265367507935,
            2.0371553897857666,
            3.1771302223205566,
            1.3438255786895752,
            2.098936080932617,
            -2.58146333694458,
            3.03145432472229,
            3.4160234928131104,
            -1.7926969528198242,
            0.9145147800445557,
            0.9627752304077148,
            -4.266402721405029,
            2.072230339050293,
            -1.3082733154296875,
            2.125021457672119,
            -0.7741119861602783,
            5.100005149841309,
            3.636669397354126,
            -0.001283496618270874,
            1.9746414422988892,
            3.896610736846924,
            1.0773415565490723,
            -2.4250149726867676,
            -2.0315802097320557,
            0.0354580283164978,
            2.2090072631835938,
            1.2236402034759521,
            1.6122710704803467,
            -4.123813152313232,
            2.9639790058135986,
            0.38833677768707275,
            2.312009811401367,
            -0.9944593906402588,
            1.482824444770813,
            -2.8730673789978027,
            -3.8729734420776367,
            1.8900997638702393,
            -2.3386335372924805,
            2.9878783226013184,
            1.0992624759674072,
            -0.38237160444259644,
            3.397831439971924,
            1.2975859642028809,
            5.119136810302734,
            -2.9644227027893066,
            -3.522459030151367,
            -5.198043346405029,
            0.8576328754425049,
            -1.0605924129486084,
            -0.19831106066703796,
            5.785499095916748,
            -3.89689302444458,
            1.8011181354522705,
            0.40271255373954773,
            0.3642674684524536,
            -1.1472063064575195,
            -3.7176108360290527,
            3.1158900260925293,
            1.8889596462249756,
            -1.5211752653121948,
            1.4116544723510742,
            -2.964937448501587,
            0.21096773445606232,
            4.556474208831787,
            3.9209647178649902,
            1.9024109840393066,
            -6.181013107299805,
            -0.6396017074584961,
            -1.7124332189559937,
            -4.47687292098999,
            -1.4011902809143066,
            4.461856842041016,
            -0.1291259527206421,
            4.027889728546143,
            -1.5484199523925781,
            3.2621092796325684,
            0.9709471464157104,
            -2.5015647411346436,
            -5.1156005859375,
            -2.590193033218384,
            -2.9231958389282227,
            1.3557612895965576,
            -4.790919303894043,
            -4.703490257263184,
            -2.3945164680480957,
            2.377042055130005,
            -3.3260974884033203,
            -1.852805733680725,
            0.8965401649475098,
            1.229709267616272,
            2.8672451972961426,
            0.24191370606422424,
            -2.5289955139160156,
            -3.3179471492767334,
            -7.492257595062256,
            -4.218566417694092,
            3.426226854324341,
            2.20107364654541,
            -3.566638469696045,
            0.803606390953064,
            -0.21525642275810242,
            2.2717349529266357,
            -2.5711252689361572,
            -0.5765186548233032,
            2.0487282276153564,
            0.014408409595489502,
            -2.156100273132324,
            2.3764235973358154,
            3.0815415382385254,
            -2.4487252235412598,
            2.9962258338928223,
            3.627790689468384,
            -3.25063419342041,
            -0.9947179555892944,
            9.177482604980469,
            3.5640504360198975,
            -0.2840675711631775,
            -0.6159440279006958,
            -0.3218926191329956,
            1.6617579460144043,
            0.9247980117797852,
            0.2232215255498886,
            -0.6925554275512695,
            5.427195072174072,
            0.7271137237548828,
            0.02877599000930786,
            -3.0462818145751953
        ]
    },
    "authors": [
        {
            "authorId": "2289266488",
            "name": "Zhijie Qu"
        }
    ],
    "references": [
        {
            "paperId": "fdc53c2c10742464087c0525f77e32604827a21d",
            "title": "Efficient Streaming Language Models with Attention Sinks"
        },
        {
            "paperId": "5e0cb1c4b91a7486e1c2b15a44a0be56bd74bdc0",
            "title": "Effective Long-Context Scaling of Foundation Models"
        },
        {
            "paperId": "0b0debb710366cdff461938c80763eace1651af6",
            "title": "Code Llama: Open Foundation Models for Code"
        },
        {
            "paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c",
            "title": "Extending Context Window of Large Language Models via Positional Interpolation"
        },
        {
            "paperId": "980e55d9226cac302d0fae7732da4e67b8bc952c",
            "title": "Parallel Context Windows for Large Language Models"
        },
        {
            "paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd",
            "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"
        },
        {
            "paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4",
            "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"
        },
        {
            "paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776",
            "title": "Attention is All you Need"
        },
        {
            "paperId": null,
            "title": "LocalLLaMA"
        },
        {
            "paperId": null,
            "title": "2023.Giraffe:Adventuresinexpandingcontextlengthsin llms"
        },
        {
            "paperId": null,
            "title": "2023. LM-Infinite: Simple on-the-fly length generalization for large language models"
        },
        {
            "paperId": null,
            "title": "2022. A length-extrapolatable trans-former"
        },
        {
            "paperId": null,
            "title": "MLNLP 2023, December 27\u201329, 2023,"
        },
        {
            "paperId": null,
            "title": "2023. Nbce: Naive bayes-based context extension"
        },
        {
            "paperId": null,
            "title": "GPT Rotational Position Embedding for Length Extrapolation"
        }
    ]
}