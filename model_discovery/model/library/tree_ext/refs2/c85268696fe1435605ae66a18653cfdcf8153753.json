{
    "paperId": "c85268696fe1435605ae66a18653cfdcf8153753",
    "externalIds": {
        "DBLP": "conf/nips/FuAGJETSPRR23",
        "ArXiv": "2310.12109",
        "DOI": "10.48550/arXiv.2310.12109",
        "CorpusId": 264288993
    },
    "title": "Monarch Mixer: A Simple Sub-Quadratic GEMM-Based Architecture",
    "abstract": "Machine learning models are increasingly being scaled in both sequence length and model dimension to reach longer contexts and better performance. However, existing architectures such as Transformers scale quadratically along both these axes. We ask: are there performant architectures that can scale sub-quadratically along sequence length and model dimension? We introduce Monarch Mixer (M2), a new architecture that uses the same sub-quadratic primitive along both sequence length and model dimension: Monarch matrices, a simple class of expressive structured matrices that captures many linear transforms, achieves high hardware efficiency on GPUs, and scales sub-quadratically. As a proof of concept, we explore the performance of M2 in three domains: non-causal BERT-style language modeling, ViT-style image classification, and causal GPT-style language modeling. For non-causal BERT-style modeling, M2 matches BERT-base and BERT-large in downstream GLUE quality with up to 27% fewer parameters, and achieves up to 9.1$\\times$ higher throughput at sequence length 4K. On ImageNet, M2 outperforms ViT-b by 1% in accuracy, with only half the parameters. Causal GPT-style models introduce a technical challenge: enforcing causality via masking introduces a quadratic bottleneck. To alleviate this bottleneck, we develop a novel theoretical view of Monarch matrices based on multivariate polynomial evaluation and interpolation, which lets us parameterize M2 to be causal while remaining sub-quadratic. Using this parameterization, M2 matches GPT-style Transformers at 360M parameters in pretraining perplexity on The PILE--showing for the first time that it may be possible to match Transformer quality without attention or MLPs.",
    "venue": "Neural Information Processing Systems",
    "year": 2023,
    "referenceCount": 0,
    "citationCount": 24,
    "influentialCitationCount": 2,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A novel theoretical view of Monarch matrices is developed based on multivariate polynomial evaluation and interpolation, which lets us parameterize M2 to be causal while remaining sub-quadratic, showing for the first time that it may be possible to match Transformer quality without attention or MLPs."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -3.600322723388672,
            0.5573302507400513,
            -0.35419169068336487,
            3.726086378097534,
            -2.4673097133636475,
            0.2180512249469757,
            1.0091508626937866,
            0.2113441824913025,
            -0.5546818375587463,
            0.6567586660385132,
            2.6136560440063477,
            0.8367196321487427,
            0.40671268105506897,
            1.6002322435379028,
            -3.344632625579834,
            0.35255539417266846,
            2.4296460151672363,
            1.4543976783752441,
            4.452026844024658,
            2.047100067138672,
            -2.8918333053588867,
            4.265683650970459,
            -3.9887192249298096,
            1.7268717288970947,
            -1.6530134677886963,
            0.1890849471092224,
            -2.4549403190612793,
            3.5758914947509766,
            -0.7292683124542236,
            -0.45928481221199036,
            2.7355077266693115,
            -5.09829044342041,
            6.845636367797852,
            -4.828892707824707,
            3.207063674926758,
            -4.951915264129639,
            -3.5239760875701904,
            6.549163341522217,
            -2.5824999809265137,
            -2.5518152713775635,
            -3.2392077445983887,
            -1.3045464754104614,
            0.43429964780807495,
            -1.2411761283874512,
            -0.5403475761413574,
            5.096912384033203,
            2.789921522140503,
            0.14464333653450012,
            -1.9674150943756104,
            4.158395767211914,
            2.6655831336975098,
            0.3571891784667969,
            1.4996070861816406,
            0.9858717918395996,
            -3.8698537349700928,
            -4.576089382171631,
            0.1518658697605133,
            -1.856898546218872,
            0.7125250101089478,
            -4.466734886169434,
            3.41719388961792,
            6.608325958251953,
            0.839810848236084,
            3.8518104553222656,
            3.092292070388794,
            -2.645630121231079,
            -0.3138320744037628,
            3.6739025115966797,
            -0.8216695785522461,
            0.3349599242210388,
            0.5961312055587769,
            -3.0565786361694336,
            0.7377039790153503,
            -1.318565845489502,
            -2.3411951065063477,
            3.116318702697754,
            -3.3465750217437744,
            -5.646598815917969,
            -1.9053512811660767,
            -2.0713417530059814,
            0.7947796583175659,
            2.1019747257232666,
            2.263361930847168,
            1.1129684448242188,
            4.396674156188965,
            -1.9954633712768555,
            -1.0619075298309326,
            0.40813103318214417,
            2.2996397018432617,
            -4.209212779998779,
            -0.4821423590183258,
            2.6061315536499023,
            -1.1149675846099854,
            2.287527561187744,
            -2.193067789077759,
            -0.5466426610946655,
            0.6180460453033447,
            1.4339243173599243,
            -2.5464258193969727,
            2.3290908336639404,
            -0.3521219491958618,
            -0.5284863710403442,
            1.9378409385681152,
            -1.5116602182388306,
            4.283162593841553,
            -3.113142490386963,
            -1.913872241973877,
            1.6289095878601074,
            0.11788838356733322,
            -2.4484803676605225,
            -2.227447271347046,
            4.920828819274902,
            0.3937965929508209,
            0.30486732721328735,
            -4.603085517883301,
            -3.9427685737609863,
            -2.6305480003356934,
            -3.4150023460388184,
            -0.9681372046470642,
            2.9822638034820557,
            -0.0430581271648407,
            1.4193017482757568,
            -2.6453018188476562,
            0.5167280435562134,
            1.164252758026123,
            2.3616652488708496,
            -2.4365453720092773,
            0.11282700300216675,
            -1.9034531116485596,
            -2.913853645324707,
            1.8706544637680054,
            -2.708136558532715,
            2.733811140060425,
            -3.7980830669403076,
            2.7738194465637207,
            2.098855495452881,
            -3.6942028999328613,
            3.185235023498535,
            -4.010477066040039,
            0.6629968881607056,
            1.1546884775161743,
            4.06211519241333,
            0.6104836463928223,
            -0.8111319541931152,
            1.830001711845398,
            3.0056405067443848,
            2.625992774963379,
            5.511557102203369,
            -1.3519620895385742,
            4.822872638702393,
            4.896591663360596,
            -5.5592217445373535,
            2.2632174491882324,
            0.22217217087745667,
            1.209429383277893,
            1.3545634746551514,
            -7.199649333953857,
            -1.9211328029632568,
            0.5040065050125122,
            0.8429162502288818,
            -0.3621208071708679,
            0.9523357152938843,
            -9.01528549194336,
            -0.35177290439605713,
            3.0296318531036377,
            -0.7512377500534058,
            -3.287309169769287,
            -1.357783555984497,
            -1.3764699697494507,
            3.335533618927002,
            -1.6317543983459473,
            2.854358673095703,
            4.350099563598633,
            1.3512979745864868,
            4.311022758483887,
            3.683253049850464,
            -0.7164017558097839,
            -0.8485460877418518,
            2.615588903427124,
            5.4067583084106445,
            -2.010153293609619,
            2.097663640975952,
            -5.819253444671631,
            -0.10213473439216614,
            -4.553813457489014,
            -1.0931971073150635,
            -5.357183456420898,
            -1.4247342348098755,
            -4.505949020385742,
            1.529273271560669,
            -0.40537089109420776,
            -1.6992686986923218,
            4.650686740875244,
            4.225314140319824,
            2.66092848777771,
            0.4666547179222107,
            4.195383548736572,
            0.6107549667358398,
            -4.571699142456055,
            1.7059988975524902,
            4.298261642456055,
            -0.3889539837837219,
            -0.4750746786594391,
            -2.865650177001953,
            4.0454206466674805,
            -0.7999756336212158,
            -0.14027848839759827,
            1.4640446901321411,
            3.8200745582580566,
            1.9543548822402954,
            -0.5928592085838318,
            0.1247730627655983,
            -3.5207176208496094,
            1.7019705772399902,
            -3.5055465698242188,
            -4.335660934448242,
            -5.722629547119141,
            3.1995582580566406,
            5.435787200927734,
            2.531492233276367,
            3.0091755390167236,
            0.9882957935333252,
            1.0031774044036865,
            -4.989046573638916,
            1.9029030799865723,
            -2.245232582092285,
            3.9673142433166504,
            0.7584512829780579,
            0.7276980876922607,
            4.7925028800964355,
            1.4991462230682373,
            -5.4738006591796875,
            -0.6899779438972473,
            -0.019068267196416855,
            -5.368496894836426,
            0.3018798828125,
            -3.8143250942230225,
            -2.437009572982788,
            0.26127785444259644,
            -3.0575411319732666,
            6.083796501159668,
            -3.217590808868408,
            -2.334779739379883,
            4.2148566246032715,
            0.7728022336959839,
            -4.026688098907471,
            -1.8099305629730225,
            0.6934959888458252,
            1.0342193841934204,
            -0.8613086938858032,
            2.5193824768066406,
            -2.2332849502563477,
            3.462618827819824,
            1.4315615892410278,
            2.346831798553467,
            0.6862869262695312,
            1.0471618175506592,
            -2.6950738430023193,
            4.321732044219971,
            0.4509704113006592,
            -3.899482250213623,
            5.190707683563232,
            3.976318597793579,
            3.7340283393859863,
            -2.2002038955688477,
            -2.679823398590088,
            -1.9240238666534424,
            0.5529226064682007,
            -1.791326880455017,
            3.1571574211120605,
            3.189638614654541,
            3.387157440185547,
            -2.0528104305267334,
            -6.329811096191406,
            -2.6430156230926514,
            -4.234304428100586,
            -1.1785439252853394,
            -0.779089093208313,
            -0.2079409658908844,
            5.035158634185791,
            2.5566787719726562,
            -2.286431312561035,
            -4.0569376945495605,
            -2.525827646255493,
            -4.605258941650391,
            -3.2304506301879883,
            -2.7955758571624756,
            0.4943695068359375,
            -1.6525962352752686,
            0.7585740685462952,
            -3.376117467880249,
            0.6629533767700195,
            -3.004631996154785,
            -2.8682267665863037,
            -2.925784111022949,
            3.062074899673462,
            4.814671039581299,
            -2.5102219581604004,
            -1.9625056982040405,
            0.44871121644973755,
            0.3829832077026367,
            0.1689227819442749,
            2.204098701477051,
            1.402592420578003,
            -0.1503523588180542,
            7.163135528564453,
            -1.1091903448104858,
            -2.412684440612793,
            0.6369633078575134,
            -3.5912632942199707,
            -2.2448384761810303,
            3.3290534019470215,
            1.3166457414627075,
            -6.594424724578857,
            -1.5768741369247437,
            0.6860285997390747,
            3.237661838531494,
            0.9424241781234741,
            -0.6313751935958862,
            3.295353889465332,
            -1.4610860347747803,
            -0.7350723147392273,
            -6.052661895751953,
            -1.3867179155349731,
            -0.06660676002502441,
            1.231485366821289,
            2.9382848739624023,
            6.112092018127441,
            1.6244416236877441,
            1.817704439163208,
            2.8110196590423584,
            4.398107051849365,
            6.502911567687988,
            -0.40632474422454834,
            -0.7529811859130859,
            -4.317234516143799,
            -0.6607328057289124,
            -0.2977313995361328,
            1.4245190620422363,
            2.144680976867676,
            2.6042826175689697,
            7.268156051635742,
            -0.26068001985549927,
            0.6929036974906921,
            -1.4724386930465698,
            -0.5388261079788208,
            1.7254830598831177,
            -1.948142409324646,
            1.7401546239852905,
            -1.7702856063842773,
            2.9675848484039307,
            -2.3081486225128174,
            1.3860926628112793,
            -4.220809459686279,
            -2.126016616821289,
            4.546389579772949,
            4.017903804779053,
            -0.6436084508895874,
            2.1025919914245605,
            2.4614946842193604,
            0.512858510017395,
            0.7910703420639038,
            2.5683634281158447,
            1.6498355865478516,
            0.5181505680084229,
            -0.4789053797721863,
            10.74613094329834,
            -2.2418558597564697,
            -0.28691381216049194,
            -1.4025838375091553,
            -0.8076074123382568,
            -1.7075599431991577,
            -4.371949195861816,
            -1.8392916917800903,
            -2.645069122314453,
            -2.641064405441284,
            4.066974639892578,
            -2.600691556930542,
            0.3539574146270752,
            -1.9966291189193726,
            -1.6880255937576294,
            3.677051544189453,
            2.5574162006378174,
            3.504756212234497,
            -0.9378566741943359,
            0.20537513494491577,
            -2.1788792610168457,
            3.644381284713745,
            1.777559757232666,
            3.2779102325439453,
            -2.027838706970215,
            0.1765834093093872,
            -0.10316704958677292,
            0.05719327926635742,
            -3.8609018325805664,
            -2.412463665008545,
            -3.6057939529418945,
            -3.852883815765381,
            0.9419825077056885,
            0.5554507970809937,
            4.334323406219482,
            2.1591830253601074,
            6.598884582519531,
            2.7025721073150635,
            -3.449939250946045,
            -0.41761720180511475,
            4.69163703918457,
            -1.4464601278305054,
            -1.5217013359069824,
            2.4411468505859375,
            -2.8654372692108154,
            -2.276662588119507,
            -2.92244815826416,
            -4.555627346038818,
            1.0996062755584717,
            -0.7350653409957886,
            3.889765501022339,
            0.8346405029296875,
            7.275733947753906,
            2.6554408073425293,
            -1.0635335445404053,
            0.8196852207183838,
            3.2294921875,
            6.03775691986084,
            1.7825157642364502,
            1.924791693687439,
            0.6170874834060669,
            3.8976473808288574,
            -3.06449556350708,
            5.5173773765563965,
            -1.0435073375701904,
            4.506002902984619,
            -2.8073372840881348,
            0.5129812955856323,
            0.41610240936279297,
            1.1288723945617676,
            1.722161889076233,
            2.2426371574401855,
            1.3776869773864746,
            -0.18898192048072815,
            -2.1050076484680176,
            4.550265312194824,
            -4.17542839050293,
            3.9455809593200684,
            2.945338249206543,
            3.746196746826172,
            -0.6625722646713257,
            1.0057148933410645,
            -2.592527389526367,
            -5.0877509117126465,
            3.550046920776367,
            -9.205349922180176,
            -5.729617118835449,
            1.4042407274246216,
            0.515640139579773,
            -1.5722160339355469,
            -3.393772602081299,
            -2.438295841217041,
            1.3072279691696167,
            -1.578472375869751,
            -3.168306350708008,
            5.068679332733154,
            1.3450901508331299,
            2.2552313804626465,
            0.8910458087921143,
            -1.43099844455719,
            -0.9876061081886292,
            -0.04689139127731323,
            0.07227098941802979,
            0.2627519369125366,
            5.276355743408203,
            -0.8572401404380798,
            -0.2358914613723755,
            1.1949782371520996,
            -3.378570079803467,
            -0.21355006098747253,
            -0.3671266436576843,
            1.6101635694503784,
            1.8571598529815674,
            -6.158350944519043,
            -3.0391247272491455,
            -2.7608723640441895,
            2.96859073638916,
            -3.936588764190674,
            0.6818554997444153,
            6.122419357299805,
            3.8001301288604736,
            0.7178580164909363,
            2.2157328128814697,
            0.9494746923446655,
            0.33287468552589417,
            -0.7943472266197205,
            6.804249286651611,
            0.7982526421546936,
            0.20780444145202637,
            -0.9244222640991211,
            -7.906748294830322,
            -2.4586341381073,
            -1.1649420261383057,
            -3.3149805068969727,
            0.3453778624534607,
            -5.171581268310547,
            -2.897904396057129,
            -0.9451974034309387,
            -5.059091567993164,
            2.887096881866455,
            3.94427227973938,
            2.245668411254883,
            -3.4382219314575195,
            0.3375319540500641,
            3.0769290924072266,
            -0.5630494356155396,
            -4.713772773742676,
            2.298068046569824,
            -0.7594624757766724,
            2.3723554611206055,
            3.992955446243286,
            -3.2723031044006348,
            0.5415559411048889,
            -1.3417954444885254,
            -1.7834086418151855,
            -0.17248302698135376,
            2.9877991676330566,
            -0.19843296706676483,
            2.960416078567505,
            1.7012369632720947,
            -2.6866068840026855,
            2.565246105194092,
            2.892277956008911,
            4.288052558898926,
            2.9855313301086426,
            5.105848789215088,
            -0.15303322672843933,
            -5.733123779296875,
            -0.5977686643600464,
            -4.548965930938721,
            0.7852010726928711,
            1.272200584411621,
            -4.248846054077148,
            -1.9048385620117188,
            -0.04491978511214256,
            -0.6339396238327026,
            -1.3388344049453735,
            4.050005912780762,
            -1.7543786764144897,
            2.591397523880005,
            -2.7312607765197754,
            -1.3511993885040283,
            -1.8750221729278564,
            1.5028796195983887,
            1.2489612102508545,
            -0.3182586133480072,
            -0.9222003817558289,
            0.1006731390953064,
            -4.644824028015137,
            2.0255236625671387,
            -1.8898805379867554,
            -0.7610571384429932,
            -1.9413365125656128,
            2.6852505207061768,
            2.0421676635742188,
            -0.9926549196243286,
            -0.5936625003814697,
            0.21030914783477783,
            -4.373244762420654,
            -4.87192440032959,
            -0.5179922580718994,
            2.598097324371338,
            0.947973370552063,
            -0.42241114377975464,
            -1.799363374710083,
            -0.6351960301399231,
            1.8486173152923584,
            2.8172972202301025,
            1.6057255268096924,
            -2.472785711288452,
            3.809321403503418,
            2.137004852294922,
            -2.903292179107666,
            -1.6911334991455078,
            -6.143389701843262,
            -4.240972995758057,
            -3.8160085678100586,
            -3.7634522914886475,
            -1.6692923307418823,
            -2.321944236755371,
            -2.5759880542755127,
            2.800236225128174,
            -4.777200698852539,
            -0.44839322566986084,
            3.3818600177764893,
            -0.2505343556404114,
            -2.967827796936035,
            -2.1384143829345703,
            -0.7671970129013062,
            -4.386061668395996,
            4.428607940673828,
            -1.2374851703643799,
            0.586824893951416,
            -1.5839715003967285,
            -0.5148270130157471,
            4.455323696136475,
            3.4766366481781006,
            0.9411007761955261,
            -2.5754153728485107,
            -1.4659069776535034,
            1.9409840106964111,
            3.1837105751037598,
            -3.282357931137085,
            1.4987001419067383,
            1.2518889904022217,
            1.7060751914978027,
            15.268540382385254,
            -0.05179092288017273,
            -3.077610731124878,
            -1.2351880073547363,
            -3.8269248008728027,
            -3.589883327484131,
            -2.2374348640441895,
            3.7541115283966064,
            -0.355882853269577,
            1.677858829498291,
            -1.7367079257965088,
            -2.3433239459991455,
            2.6258063316345215,
            0.9355550408363342,
            -1.74932062625885,
            0.4349594712257385,
            -2.6205291748046875,
            2.8603272438049316,
            -4.084267616271973,
            0.4287381172180176,
            1.1170976161956787,
            1.8959589004516602,
            -0.541499674320221,
            0.22234465181827545,
            -0.9933258295059204,
            5.389598846435547,
            2.504293203353882,
            2.8147594928741455,
            -1.756081461906433,
            2.0698485374450684,
            -0.16794422268867493,
            3.2804605960845947,
            -1.138028860092163,
            -0.5823146104812622,
            -0.7647213935852051,
            3.3502988815307617,
            1.3307260274887085,
            1.3540067672729492,
            4.564572334289551,
            1.0972914695739746,
            -1.2436264753341675,
            0.406939297914505,
            0.602030873298645,
            0.6004696488380432,
            -0.5260352492332458,
            5.35840368270874,
            1.9500491619110107,
            -3.271270275115967,
            -2.855311393737793,
            1.7381937503814697,
            1.1210016012191772,
            -3.8754405975341797,
            -1.7260894775390625,
            1.2695564031600952,
            5.74105167388916,
            3.389240026473999,
            1.1074973344802856,
            -1.3938286304473877,
            1.8316383361816406,
            0.35452625155448914,
            -0.521202564239502,
            -1.999887466430664,
            -4.4773850440979,
            -5.109111785888672,
            -3.2155609130859375,
            -1.0516576766967773,
            -0.05027645826339722,
            -0.17153537273406982,
            3.4717001914978027,
            2.2130074501037598,
            4.05156135559082,
            1.4697480201721191,
            0.5771822929382324,
            -3.378082752227783,
            -0.8309193849563599,
            -3.6539559364318848,
            1.0303173065185547,
            1.3811428546905518,
            0.1015232503414154,
            7.224362373352051,
            -2.240428924560547,
            1.7861882448196411,
            -2.9234299659729004,
            -0.905788779258728,
            3.245461940765381,
            -0.873678982257843,
            6.129642486572266,
            2.219944477081299,
            -0.1490345001220703,
            1.4379065036773682,
            1.6073939800262451,
            0.9137045741081238,
            1.648307204246521,
            4.279032230377197,
            3.487595796585083,
            -3.367788076400757,
            -2.7540719509124756,
            -1.6597952842712402,
            -4.755562782287598,
            -1.4298754930496216,
            6.910335063934326,
            3.09153151512146,
            -0.5056760907173157,
            -1.5961483716964722,
            0.6752210855484009,
            1.1664220094680786,
            -4.022953987121582,
            -7.908872604370117,
            -1.2394946813583374,
            -1.8137028217315674,
            2.1450376510620117,
            -4.363468170166016,
            -3.640787363052368,
            0.9912440776824951,
            -0.01171332597732544,
            -1.7994298934936523,
            0.8222599625587463,
            -0.8181865215301514,
            -0.9478101134300232,
            3.543147087097168,
            4.44612455368042,
            -0.5320637226104736,
            -2.7765042781829834,
            -2.9721994400024414,
            0.42453816533088684,
            6.487627983093262,
            -0.3127669095993042,
            -4.186770915985107,
            1.0974515676498413,
            -0.26229965686798096,
            -0.9669938683509827,
            -2.496710777282715,
            -3.2345056533813477,
            1.0898003578186035,
            -0.19419525563716888,
            -5.177133560180664,
            -0.20992587506771088,
            -0.30556046962738037,
            -1.4749186038970947,
            0.823501467704773,
            5.68563175201416,
            -3.215949535369873,
            -0.6352723836898804,
            8.627851486206055,
            1.9195245504379272,
            0.35416609048843384,
            -1.7462149858474731,
            -3.0693817138671875,
            -0.5576375722885132,
            1.1034988164901733,
            -0.6628168821334839,
            -2.898770809173584,
            2.7859551906585693,
            0.7464249134063721,
            1.2518243789672852,
            -0.09473992884159088
        ]
    },
    "authors": [
        {
            "authorId": "2259931128",
            "name": "Daniel Y. Fu"
        },
        {
            "authorId": "2259924225",
            "name": "Simran Arora"
        },
        {
            "authorId": "2161243147",
            "name": "Jessica Grogan"
        },
        {
            "authorId": "2135397895",
            "name": "Isys Johnson"
        },
        {
            "authorId": "69498617",
            "name": "Sabri Eyuboglu"
        },
        {
            "authorId": "2289404927",
            "name": "Armin W. Thomas"
        },
        {
            "authorId": "2259914006",
            "name": "Benjamin Spector"
        },
        {
            "authorId": "40585370",
            "name": "Michael Poli"
        },
        {
            "authorId": "1755572",
            "name": "A. Rudra"
        },
        {
            "authorId": "2259934664",
            "name": "Christopher R'e"
        }
    ],
    "references": []
}