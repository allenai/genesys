{
    "paperId": "cde66097f4123a62bf3e28d48c764648e8c69f72",
    "externalIds": {
        "DBLP": "journals/corr/abs-2402-18668",
        "ArXiv": "2402.18668",
        "DOI": "10.48550/arXiv.2402.18668",
        "CorpusId": 268063190
    },
    "title": "Simple linear attention language models balance the recall-throughput tradeoff",
    "abstract": "Recent work has shown that attention-based language models excel at recall, the ability to ground generations in tokens previously seen in context. However, the efficiency of attention-based models is bottle-necked during inference by the KV-cache's aggressive memory consumption. In this work, we explore whether we can improve language model efficiency (e.g. by reducing memory consumption) without compromising on recall. By applying experiments and theory to a broad set of architectures, we identify a key tradeoff between a model's state size and recall ability. We show that efficient alternatives to attention (e.g. H3, Mamba, RWKV) maintain a fixed-size recurrent state, but struggle at recall. We propose BASED a simple architecture combining linear and sliding window attention. By varying BASED window size and linear attention feature dimension, we can dial the state size and traverse the pareto frontier of the recall-memory tradeoff curve, recovering the full quality of attention on one end and the small state size of attention-alternatives on the other. We train language models up to 1.3b parameters and show that BASED matches the strongest sub-quadratic models (e.g. Mamba) in perplexity and outperforms them on real-world recall-intensive tasks by 6.22 accuracy points. Implementations of linear attention are often less efficient than optimized standard attention implementations. To make BASED competitive, we develop IO-aware algorithms that enable 24x higher throughput on language generation than FlashAttention-2, when generating 1024 tokens using 1.3b parameter models. Code for this work is provided at: https://github.com/HazyResearch/based.",
    "venue": "arXiv.org",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 17,
    "influentialCitationCount": 5,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "To make BASED competitive, IO-aware algorithms are developed that enable 24x higher throughput on language generation than FlashAttention-2, when generating 1024 tokens using 1.3b parameters and show that BASED matches the strongest sub-quadratic models and outperforms them on real-world recall-intensive tasks by 6.22 accuracy points."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -7.819585800170898,
            0.00034937262535095215,
            -1.0710299015045166,
            3.8678040504455566,
            1.1941877603530884,
            1.421859622001648,
            -2.392672538757324,
            0.7021501064300537,
            -2.778489589691162,
            4.36807918548584,
            0.765943706035614,
            5.753252029418945,
            -1.6635668277740479,
            -3.750311851501465,
            -2.6086184978485107,
            1.3297232389450073,
            -1.6606650352478027,
            -2.3913989067077637,
            6.874169826507568,
            1.113034725189209,
            -0.31239455938339233,
            1.4206955432891846,
            -2.0815272331237793,
            -3.093306064605713,
            -2.092288017272949,
            -1.1544058322906494,
            6.471917152404785,
            2.0013680458068848,
            -3.549757480621338,
            -0.06534504890441895,
            -2.280787467956543,
            -2.4676856994628906,
            3.4282259941101074,
            -1.319506287574768,
            4.671030044555664,
            -2.9461255073547363,
            -2.2136099338531494,
            6.559473991394043,
            -4.666662216186523,
            -3.2792866230010986,
            -2.700953960418701,
            1.9519035816192627,
            -0.47111576795578003,
            -2.3534650802612305,
            2.2321255207061768,
            -0.3873457908630371,
            2.7798547744750977,
            1.4815459251403809,
            -1.3913800716400146,
            4.29047966003418,
            2.8387348651885986,
            -1.3102161884307861,
            -1.4816067218780518,
            2.509431838989258,
            1.398716926574707,
            0.6009386777877808,
            0.2082444429397583,
            -2.007990837097168,
            3.5313992500305176,
            -1.016843318939209,
            5.106551170349121,
            6.852839946746826,
            -2.089920997619629,
            1.5268224477767944,
            0.7298583984375,
            -1.578029990196228,
            -0.09997200965881348,
            3.0009803771972656,
            5.323341369628906,
            2.3950271606445312,
            1.6570203304290771,
            -7.157272815704346,
            -1.2690236568450928,
            0.5326831936836243,
            -2.9530515670776367,
            2.1500020027160645,
            0.3202788829803467,
            -4.237696647644043,
            -0.843701958656311,
            -3.3505351543426514,
            -1.6349765062332153,
            1.3900302648544312,
            -0.7095258831977844,
            6.089798450469971,
            5.572186470031738,
            -3.473461627960205,
            -0.4562891721725464,
            1.4379937648773193,
            4.347386360168457,
            -0.8067140579223633,
            -0.5178614854812622,
            1.7812467813491821,
            -0.4318373203277588,
            -0.305301308631897,
            -3.79331374168396,
            1.4252203702926636,
            3.5112156867980957,
            -1.6840331554412842,
            -1.631347894668579,
            1.5460699796676636,
            3.304208755493164,
            0.20472681522369385,
            3.282273769378662,
            -0.9521186351776123,
            3.716038227081299,
            -3.8161370754241943,
            -3.6784849166870117,
            3.8865318298339844,
            2.3344626426696777,
            -0.5151195526123047,
            -1.9332927465438843,
            2.7269234657287598,
            -0.9683436155319214,
            -1.5549545288085938,
            -1.5172888040542603,
            -4.037082672119141,
            -2.8541247844696045,
            0.5860531330108643,
            -0.620771050453186,
            5.0707197189331055,
            -4.505445957183838,
            -0.12269651889801025,
            0.3871295154094696,
            -1.0302128791809082,
            1.095150351524353,
            0.21645498275756836,
            -2.966691493988037,
            -1.277038812637329,
            -1.1735280752182007,
            -3.8866753578186035,
            2.9325320720672607,
            1.4614505767822266,
            4.503105163574219,
            -3.0717172622680664,
            1.9534252882003784,
            2.943382740020752,
            -3.445485830307007,
            3.0204100608825684,
            -0.43666818737983704,
            -0.5931322574615479,
            -2.654386520385742,
            2.64544677734375,
            -1.5498073101043701,
            -2.0523886680603027,
            3.2812728881835938,
            1.7429451942443848,
            1.5754011869430542,
            2.4934372901916504,
            0.2637293338775635,
            6.1797332763671875,
            2.6004104614257812,
            -5.634800910949707,
            2.082105875015259,
            1.9453388452529907,
            -0.9451018571853638,
            3.8272805213928223,
            -5.8610076904296875,
            2.3396573066711426,
            -2.300579071044922,
            0.199046790599823,
            -0.8995838165283203,
            -2.0172948837280273,
            -9.808537483215332,
            -2.084821939468384,
            3.2052462100982666,
            -5.702033042907715,
            -1.0996992588043213,
            -0.46524494886398315,
            -0.9079123139381409,
            4.302237033843994,
            -4.15574312210083,
            3.432434558868408,
            0.09179744124412537,
            4.626068115234375,
            1.0497705936431885,
            2.9027793407440186,
            -0.10244554281234741,
            -4.571045398712158,
            -3.6782569885253906,
            -1.9361240863800049,
            -0.14115336537361145,
            1.9671562910079956,
            -6.147374629974365,
            -0.5642365217208862,
            -5.339617729187012,
            -2.825161933898926,
            -1.342384934425354,
            -1.3592629432678223,
            0.12508505582809448,
            -0.16476371884346008,
            -3.236933946609497,
            -1.9824367761611938,
            7.193666458129883,
            4.93316125869751,
            2.0542829036712646,
            -0.31951993703842163,
            3.347482681274414,
            1.520970106124878,
            -1.9684830904006958,
            -1.8425912857055664,
            1.9004796743392944,
            2.9556703567504883,
            0.6853992938995361,
            -1.9715049266815186,
            4.283324718475342,
            1.3166143894195557,
            -2.641420364379883,
            4.539216995239258,
            -0.28309935331344604,
            1.219150424003601,
            3.2503089904785156,
            -1.2898176908493042,
            -4.260623931884766,
            1.087317943572998,
            -3.511636972427368,
            -2.9390695095062256,
            -8.419220924377441,
            0.37320780754089355,
            4.467416763305664,
            -0.5637279748916626,
            -0.2931257486343384,
            0.29282402992248535,
            3.61846661567688,
            -5.964156150817871,
            0.7132925987243652,
            0.7350901365280151,
            3.7110908031463623,
            -3.6331958770751953,
            -0.09030630439519882,
            -0.36696144938468933,
            -3.935333728790283,
            -2.3508737087249756,
            0.3880148231983185,
            -4.186696529388428,
            -6.449387550354004,
            -2.490190029144287,
            -4.652658939361572,
            0.029148966073989868,
            -0.07731735706329346,
            -1.9001916646957397,
            5.251926422119141,
            1.1031882762908936,
            -0.05317696928977966,
            6.252017498016357,
            3.165794610977173,
            -2.6209511756896973,
            -3.5478861331939697,
            0.7437537312507629,
            0.46696901321411133,
            -1.4752663373947144,
            0.35278239846229553,
            -3.0626983642578125,
            2.7087464332580566,
            1.0775779485702515,
            1.646554946899414,
            3.06675386428833,
            -1.1886082887649536,
            -2.609776496887207,
            1.5589251518249512,
            1.1026623249053955,
            0.9853038191795349,
            4.775165557861328,
            5.295147895812988,
            4.1685309410095215,
            0.6603158116340637,
            -1.2999672889709473,
            -3.0002939701080322,
            -0.5630688071250916,
            -1.7319281101226807,
            5.148839950561523,
            3.273010492324829,
            0.9627397060394287,
            -2.19500732421875,
            -4.1870198249816895,
            -0.30972227454185486,
            -3.74600887298584,
            -2.7986063957214355,
            -0.4130764603614807,
            1.7687225341796875,
            2.888401985168457,
            1.0486583709716797,
            -0.7738174200057983,
            -2.722177505493164,
            1.110551118850708,
            -2.0141098499298096,
            -2.6054458618164062,
            -3.404690742492676,
            -0.5287966132164001,
            0.20336228609085083,
            -1.355578899383545,
            -3.087674140930176,
            4.116410255432129,
            -2.4640769958496094,
            -1.943634033203125,
            -1.1884573698043823,
            3.3488855361938477,
            5.643739223480225,
            -0.39855411648750305,
            -0.08325374126434326,
            -1.2181109189987183,
            -1.5580400228500366,
            0.4690781831741333,
            2.3370628356933594,
            3.1306440830230713,
            0.059960246086120605,
            3.235462188720703,
            -3.2717056274414062,
            -3.467888116836548,
            -0.706738293170929,
            -5.886692047119141,
            0.995810866355896,
            1.3661936521530151,
            3.8871471881866455,
            -3.034072160720825,
            -0.5090658664703369,
            -0.0601024329662323,
            2.60105037689209,
            -0.25592926144599915,
            -3.4836106300354004,
            1.2330095767974854,
            -3.1388144493103027,
            -2.7312521934509277,
            -4.242900371551514,
            -0.8587722778320312,
            -0.6766022443771362,
            -1.93754243850708,
            0.9167755842208862,
            0.8453179597854614,
            -3.2552828788757324,
            3.4590415954589844,
            3.1536619663238525,
            4.43832540512085,
            4.082561492919922,
            3.636915683746338,
            -3.4581797122955322,
            -5.038027286529541,
            -0.6962889432907104,
            -1.294528603553772,
            1.0626190900802612,
            1.4554200172424316,
            -2.5227770805358887,
            6.042062759399414,
            0.15487445890903473,
            0.4259532690048218,
            -1.9274418354034424,
            -1.0135443210601807,
            -1.9674030542373657,
            -2.21738862991333,
            -0.9967913627624512,
            0.14860641956329346,
            1.8591701984405518,
            0.017803609371185303,
            1.6268504858016968,
            -5.223409652709961,
            1.7122118473052979,
            3.3326025009155273,
            2.2503256797790527,
            0.44879913330078125,
            1.11813223361969,
            3.606870651245117,
            -0.5726444721221924,
            1.7959842681884766,
            3.5605757236480713,
            -1.1043260097503662,
            -0.8825917840003967,
            -0.6815986633300781,
            10.748880386352539,
            -1.5483266115188599,
            1.7098981142044067,
            -3.834834098815918,
            -4.173872947692871,
            -3.04893159866333,
            -3.327723979949951,
            2.8536901473999023,
            -0.7587919235229492,
            -1.0558254718780518,
            -0.186054527759552,
            -4.239311695098877,
            1.5272095203399658,
            -0.9371432662010193,
            -4.224641799926758,
            1.21956205368042,
            -1.0763180255889893,
            5.592041492462158,
            -2.7173492908477783,
            5.845971584320068,
            -0.486366331577301,
            0.7221449613571167,
            0.05975604057312012,
            -2.03262996673584,
            -0.4208182096481323,
            -0.39336133003234863,
            1.3652931451797485,
            0.9032241106033325,
            -5.599414348602295,
            -3.029921054840088,
            -3.525546073913574,
            -3.1078813076019287,
            -1.8246963024139404,
            5.059721946716309,
            -0.11960864067077637,
            -0.3946143388748169,
            5.202109336853027,
            3.311807870864868,
            -2.7615818977355957,
            -0.8814294338226318,
            4.170590877532959,
            -0.697314441204071,
            -2.503906726837158,
            4.484808444976807,
            -1.7321281433105469,
            -0.5569524765014648,
            -0.2513023912906647,
            -1.6085591316223145,
            1.4107218980789185,
            -0.44772493839263916,
            2.600111246109009,
            1.0749309062957764,
            3.953685998916626,
            3.248781204223633,
            -0.8326065540313721,
            5.342503070831299,
            5.396092414855957,
            3.004063606262207,
            -0.9944189190864563,
            0.9088761806488037,
            4.219941139221191,
            2.0407919883728027,
            0.258696049451828,
            2.386467456817627,
            -1.3134448528289795,
            2.7581863403320312,
            -7.1890997886657715,
            -0.2749905586242676,
            -0.12597423791885376,
            2.051405429840088,
            -1.269315242767334,
            -0.7818927764892578,
            -1.729236364364624,
            -0.6671137809753418,
            -0.752938449382782,
            4.541365146636963,
            -6.452198028564453,
            2.4383366107940674,
            -1.9075002670288086,
            2.5336036682128906,
            3.1086764335632324,
            2.789134979248047,
            -2.3308346271514893,
            -2.1473522186279297,
            2.189218521118164,
            -3.3613228797912598,
            -1.9907329082489014,
            -1.0837522745132446,
            -0.5576571226119995,
            -0.07203270494937897,
            -0.6640044450759888,
            -1.8852280378341675,
            0.723701000213623,
            1.494625210762024,
            -2.2730929851531982,
            3.0129318237304688,
            -1.7837374210357666,
            1.5502917766571045,
            1.505342960357666,
            -1.445070505142212,
            -3.432825803756714,
            -0.8417518138885498,
            0.185951828956604,
            0.9711796641349792,
            3.16365647315979,
            1.7209935188293457,
            -2.022157669067383,
            2.0229969024658203,
            -1.5365610122680664,
            -0.5270975232124329,
            2.1539433002471924,
            3.468163013458252,
            0.9615319967269897,
            -5.175482749938965,
            -3.0654683113098145,
            -2.0428032875061035,
            4.147424697875977,
            0.7668138146400452,
            -0.9067830443382263,
            4.046852111816406,
            2.1247377395629883,
            2.2507739067077637,
            2.956080913543701,
            0.9575065970420837,
            2.283421039581299,
            -2.968548536300659,
            4.151726722717285,
            -0.031220614910125732,
            1.198798656463623,
            1.6323792934417725,
            -2.537410020828247,
            -0.5893707871437073,
            1.1342473030090332,
            -0.5304018259048462,
            0.5177919268608093,
            0.7198896408081055,
            -1.5186984539031982,
            -2.3511013984680176,
            -2.510366916656494,
            3.8743507862091064,
            3.9442567825317383,
            2.6109707355499268,
            3.809178590774536,
            0.9723535776138306,
            0.542942225933075,
            1.20191490650177,
            -5.104342460632324,
            3.8028695583343506,
            -0.3942033648490906,
            -1.7250244617462158,
            5.60430908203125,
            1.3312522172927856,
            0.1465182900428772,
            0.5701027512550354,
            -2.040736436843872,
            2.395460605621338,
            -1.870182991027832,
            3.269810199737549,
            2.2948179244995117,
            1.2125166654586792,
            2.541814088821411,
            1.9330116510391235,
            2.546140670776367,
            5.916515350341797,
            6.270960807800293,
            4.218014240264893,
            3.1377501487731934,
            -2.227368116378784,
            0.6532115936279297,
            -3.0988640785217285,
            1.0566576719284058,
            3.107684373855591,
            -4.886178970336914,
            -2.0344786643981934,
            -3.1506428718566895,
            0.2895151972770691,
            0.922812819480896,
            1.9077928066253662,
            -0.23240357637405396,
            6.262077331542969,
            -2.8137660026550293,
            -0.24691209197044373,
            -2.101774215698242,
            0.7707690596580505,
            1.415216088294983,
            0.9157168865203857,
            2.443300247192383,
            0.12434419989585876,
            -1.533432960510254,
            -1.3519444465637207,
            -1.9964877367019653,
            -1.5268213748931885,
            -4.326411724090576,
            1.6487243175506592,
            4.914956092834473,
            0.5247242450714111,
            -1.3427706956863403,
            2.6788220405578613,
            -4.520458221435547,
            0.6673768758773804,
            -3.9015095233917236,
            3.7137527465820312,
            3.713322401046753,
            0.7647485733032227,
            0.5655865669250488,
            -0.5019634962081909,
            0.6564107537269592,
            -2.3521289825439453,
            2.986423969268799,
            2.2928013801574707,
            3.5535013675689697,
            4.227351188659668,
            1.4387602806091309,
            -2.62954044342041,
            -3.0329630374908447,
            -1.8988325595855713,
            -1.1603301763534546,
            -5.958414077758789,
            0.03171181678771973,
            -3.348586082458496,
            -3.139258623123169,
            3.8150768280029297,
            -2.038320302963257,
            -2.9260358810424805,
            5.311914920806885,
            -3.025078773498535,
            0.44974613189697266,
            -2.450179100036621,
            2.1397790908813477,
            -3.3186841011047363,
            6.393081188201904,
            -0.9276096224784851,
            -1.523871898651123,
            0.10911543667316437,
            0.4424639046192169,
            3.98511004447937,
            3.6731626987457275,
            2.6781349182128906,
            -2.9279236793518066,
            -0.5718346834182739,
            4.753251075744629,
            2.2368433475494385,
            -1.9198253154754639,
            1.6795328855514526,
            1.9608954191207886,
            1.9208195209503174,
            16.834903717041016,
            -0.7272220253944397,
            -0.747700035572052,
            -1.316495418548584,
            -3.323794364929199,
            -4.435402870178223,
            -3.8563075065612793,
            4.857322692871094,
            -0.2962617874145508,
            2.4365081787109375,
            -3.4146485328674316,
            -3.7296829223632812,
            0.19117607176303864,
            0.2643870711326599,
            -1.8013660907745361,
            -2.0945780277252197,
            -5.089408874511719,
            1.2313132286071777,
            -4.52396821975708,
            -2.5701897144317627,
            2.795694351196289,
            0.9083635807037354,
            -1.4302313327789307,
            -0.7640912532806396,
            2.049570083618164,
            3.2021849155426025,
            -1.8823542594909668,
            2.1568286418914795,
            -3.595381498336792,
            0.8267198801040649,
            1.4557719230651855,
            2.695035934448242,
            -2.3784914016723633,
            3.5828113555908203,
            -2.050215244293213,
            3.9179134368896484,
            0.7556905746459961,
            -0.5819926261901855,
            2.162832498550415,
            3.168771505355835,
            -0.3213581144809723,
            -1.9013797044754028,
            -3.030550003051758,
            -2.581789255142212,
            -3.685659408569336,
            2.9806244373321533,
            3.0693142414093018,
            -2.499127149581909,
            -2.396817445755005,
            3.396712303161621,
            -0.5709606409072876,
            -2.9598164558410645,
            -3.5360636711120605,
            2.5329222679138184,
            0.6070297956466675,
            5.086379051208496,
            -0.9350677132606506,
            -1.2141015529632568,
            0.4294588267803192,
            0.8374892473220825,
            4.343480587005615,
            4.633999824523926,
            -1.5234131813049316,
            -3.9446356296539307,
            -2.3457629680633545,
            -0.7795207500457764,
            -3.2498693466186523,
            3.9759273529052734,
            0.6090598106384277,
            -0.637441873550415,
            6.2097883224487305,
            2.821485757827759,
            -2.4108614921569824,
            -4.065283298492432,
            0.4309086203575134,
            -3.841655731201172,
            1.9190534353256226,
            -1.124006748199463,
            1.0907299518585205,
            9.024710655212402,
            -2.987166404724121,
            2.4825267791748047,
            -0.6096078157424927,
            0.28822463750839233,
            3.224721908569336,
            -4.08974027633667,
            6.1464080810546875,
            1.169607162475586,
            -4.830573081970215,
            1.36919367313385,
            -2.120924234390259,
            1.5902189016342163,
            4.821266174316406,
            3.0282607078552246,
            4.588142395019531,
            -4.2146897315979,
            -1.2527143955230713,
            -3.6727700233459473,
            -1.8341078758239746,
            -1.716465950012207,
            2.5783073902130127,
            2.4446706771850586,
            -2.3161566257476807,
            -1.2384203672409058,
            -0.9000132083892822,
            -1.4218882322311401,
            -1.4337537288665771,
            -8.14061164855957,
            -0.28791868686676025,
            -5.575886249542236,
            2.098668336868286,
            -2.521432638168335,
            -3.8529436588287354,
            -1.7601587772369385,
            -0.5163154602050781,
            -2.768629789352417,
            1.928890585899353,
            0.8271585702896118,
            1.2013311386108398,
            3.7954893112182617,
            3.462498664855957,
            1.4803284406661987,
            -2.8923325538635254,
            -2.0133562088012695,
            -4.794240474700928,
            0.7339844703674316,
            1.8988564014434814,
            -0.9937338829040527,
            -3.5880141258239746,
            2.4363508224487305,
            2.6084203720092773,
            -5.483543872833252,
            -1.1726425886154175,
            -2.0509896278381348,
            -1.5898082256317139,
            -4.536187171936035,
            -1.3039100170135498,
            2.615474224090576,
            0.4389876127243042,
            1.676137924194336,
            2.948110818862915,
            -2.755810022354126,
            -2.177572250366211,
            11.122218132019043,
            -0.6119830012321472,
            0.8186272382736206,
            -2.9656591415405273,
            -1.3488706350326538,
            -2.604565143585205,
            0.9651226997375488,
            -0.37802958488464355,
            -4.471230506896973,
            2.123619794845581,
            0.15188907086849213,
            -0.3201354742050171,
            -2.858128547668457
        ]
    },
    "authors": [
        {
            "authorId": "2259924225",
            "name": "Simran Arora"
        },
        {
            "authorId": "69498617",
            "name": "Sabri Eyuboglu"
        },
        {
            "authorId": "2124860797",
            "name": "Michael Zhang"
        },
        {
            "authorId": "2173528923",
            "name": "Aman Timalsina"
        },
        {
            "authorId": "2288254732",
            "name": "Silas Alberti"
        },
        {
            "authorId": "2288262047",
            "name": "Dylan Zinsley"
        },
        {
            "authorId": "2273115742",
            "name": "James Zou"
        },
        {
            "authorId": "2272400719",
            "name": "Atri Rudra"
        },
        {
            "authorId": "2259934664",
            "name": "Christopher R'e"
        }
    ],
    "references": []
}