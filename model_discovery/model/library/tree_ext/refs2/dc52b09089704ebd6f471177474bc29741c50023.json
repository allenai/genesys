{
    "paperId": "dc52b09089704ebd6f471177474bc29741c50023",
    "externalIds": {
        "MAG": "2988394319",
        "DBLP": "journals/corr/abs-1911-02150",
        "ArXiv": "1911.02150",
        "CorpusId": 207880429
    },
    "title": "Fast Transformer Decoding: One Write-Head is All You Need",
    "abstract": "Multi-head attention layers, as used in the Transformer neural sequence model, are a powerful alternative to RNNs for moving information across and between sequences. While training these layers is generally fast and simple, due to parallelizability across the length of the sequence, incremental inference (where such paralleization is impossible) is often slow, due to the memory-bandwidth cost of repeatedly loading the large \"keys\" and \"values\" tensors. We propose a variant called multi-query attention, where the keys and values are shared across all of the different attention \"heads\", greatly reducing the size of these tensors and hence the memory bandwidth requirements of incremental decoding. We verify experimentally that the resulting models can indeed be much faster to decode, and incur only minor quality degradation from the baseline.",
    "venue": "arXiv.org",
    "year": 2019,
    "referenceCount": 6,
    "citationCount": 269,
    "influentialCitationCount": 21,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work proposes a variant called multi-query attention, where the keys and values are shared across all of the different attention \"heads\", greatly reducing the size of these tensors and hence the memory bandwidth requirements of incremental decoding."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.4820709228515625,
            -0.5625512599945068,
            -0.8849234580993652,
            4.791551113128662,
            2.4746415615081787,
            -1.06302809715271,
            4.4735026359558105,
            -3.174621343612671,
            3.103489637374878,
            -0.8744655847549438,
            -1.0468461513519287,
            4.516843795776367,
            1.0790135860443115,
            3.455888271331787,
            -3.378990650177002,
            -1.823598027229309,
            -1.102586269378662,
            1.608182430267334,
            6.279369831085205,
            2.347775459289551,
            1.021499514579773,
            -1.1198745965957642,
            -3.2709782123565674,
            3.689648389816284,
            -0.7750458717346191,
            -0.0796489268541336,
            3.495004653930664,
            1.5138885974884033,
            -1.2277946472167969,
            -1.1347236633300781,
            -0.5894694328308105,
            -5.214713096618652,
            5.290523052215576,
            -5.828890800476074,
            1.216157078742981,
            -1.0769193172454834,
            -1.5910305976867676,
            5.064167022705078,
            -4.051843166351318,
            -1.9657015800476074,
            2.5240137577056885,
            1.8864535093307495,
            -2.147279977798462,
            0.7884024381637573,
            -2.2283496856689453,
            2.2330856323242188,
            2.610034465789795,
            -0.06211650371551514,
            -1.40486478805542,
            2.2083773612976074,
            3.534130811691284,
            0.8181777000427246,
            -1.678694725036621,
            -1.721529483795166,
            1.841817855834961,
            -1.638124704360962,
            4.46635103225708,
            -0.8724472522735596,
            0.9156912565231323,
            -1.3680341243743896,
            4.450014114379883,
            4.1933913230896,
            0.4915838837623596,
            0.4208222031593323,
            5.204742908477783,
            0.5226826667785645,
            -3.107043743133545,
            5.944028377532959,
            1.6946144104003906,
            1.5834230184555054,
            -2.8156251907348633,
            -6.445450305938721,
            0.6338945627212524,
            -0.4860900938510895,
            -2.4467687606811523,
            -1.4131306409835815,
            -1.0418291091918945,
            -3.5858044624328613,
            0.3304741084575653,
            -2.6692304611206055,
            -1.8981226682662964,
            2.5441231727600098,
            -1.833976149559021,
            3.1003670692443848,
            1.143350601196289,
            -1.536238670349121,
            -2.750701427459717,
            -0.5612131357192993,
            0.18676543235778809,
            -0.24405518174171448,
            0.9238622784614563,
            0.4724787473678589,
            -0.9530661106109619,
            1.6156522035598755,
            -4.517033100128174,
            -1.6303727626800537,
            -0.1342441439628601,
            0.4503018856048584,
            -4.0513200759887695,
            2.071150302886963,
            1.2046301364898682,
            -3.260192394256592,
            0.43404415249824524,
            0.14110898971557617,
            3.260284662246704,
            -3.8359484672546387,
            -1.8762917518615723,
            3.798851251602173,
            -1.4292449951171875,
            -3.4624478816986084,
            -2.9769234657287598,
            3.408372640609741,
            0.8074538707733154,
            -0.06927032768726349,
            -2.945727586746216,
            -6.324990749359131,
            -0.4502628445625305,
            -0.6964417695999146,
            -3.3227341175079346,
            2.3377740383148193,
            -1.3190419673919678,
            0.687349796295166,
            -2.73584246635437,
            0.5182313323020935,
            0.9199745059013367,
            3.4226231575012207,
            -4.595615863800049,
            1.179324984550476,
            1.0571612119674683,
            -4.204679489135742,
            2.245314121246338,
            -5.457343101501465,
            3.163217544555664,
            -0.218269482254982,
            2.114821672439575,
            1.7666904926300049,
            -3.822563648223877,
            2.6660261154174805,
            -1.8619905710220337,
            0.06992536783218384,
            2.489290714263916,
            -0.00629270076751709,
            -2.048797130584717,
            0.728318989276886,
            1.5279676914215088,
            2.688210964202881,
            0.46814173460006714,
            2.552368402481079,
            1.6641360521316528,
            5.030571460723877,
            2.6272263526916504,
            -7.263845920562744,
            0.49207034707069397,
            2.646751880645752,
            0.34158414602279663,
            2.1325175762176514,
            -6.784354209899902,
            -1.156808614730835,
            -1.2649383544921875,
            -1.1641377210617065,
            1.8428738117218018,
            0.07156543433666229,
            -8.939571380615234,
            -0.16592958569526672,
            3.1935434341430664,
            -4.8566389083862305,
            -3.7230215072631836,
            1.2863258123397827,
            -0.1377457082271576,
            3.765949249267578,
            2.50156831741333,
            -3.2720470428466797,
            0.4700748324394226,
            5.305501937866211,
            7.840413570404053,
            5.177061080932617,
            2.3081130981445312,
            -3.4664695262908936,
            -4.526757717132568,
            0.3470107913017273,
            0.5142983794212341,
            1.7823095321655273,
            -7.204568386077881,
            3.6117568016052246,
            -5.931153297424316,
            -2.702684164047241,
            0.31161877512931824,
            -2.554239511489868,
            -3.904529094696045,
            0.6764932870864868,
            3.6199443340301514,
            -0.5031996965408325,
            4.292638301849365,
            7.267439842224121,
            0.9158070087432861,
            -2.290607452392578,
            1.875130295753479,
            1.7985122203826904,
            -3.9247217178344727,
            -1.7005001306533813,
            2.706216335296631,
            -0.6442763805389404,
            -2.2679221630096436,
            -2.9879207611083984,
            2.5865650177001953,
            2.147052764892578,
            -2.3309266567230225,
            1.0557060241699219,
            4.7717671394348145,
            -0.08585722744464874,
            4.294507026672363,
            0.14292627573013306,
            -1.3885366916656494,
            2.794616460800171,
            -3.057356595993042,
            -3.309267997741699,
            -5.9566144943237305,
            3.418250799179077,
            5.13209342956543,
            1.744691252708435,
            0.43056365847587585,
            1.5493342876434326,
            0.8856233358383179,
            -4.433698654174805,
            -0.32968670129776,
            -0.9086759090423584,
            3.462952136993408,
            -0.9220309853553772,
            0.7335096597671509,
            2.8754987716674805,
            -1.8829529285430908,
            -5.624076843261719,
            0.7543400526046753,
            -2.2077279090881348,
            -7.204118728637695,
            -1.8152470588684082,
            -0.3115358352661133,
            0.7886053323745728,
            0.4164639711380005,
            -3.3328030109405518,
            6.917569160461426,
            0.38520827889442444,
            2.278062105178833,
            5.242302894592285,
            2.2471837997436523,
            -2.1797518730163574,
            -0.5770917534828186,
            0.035306185483932495,
            3.293360948562622,
            -1.1346665620803833,
            -0.37346816062927246,
            -1.2654865980148315,
            2.7439937591552734,
            -4.153354167938232,
            4.710422992706299,
            0.4856252074241638,
            2.5757856369018555,
            -2.7410521507263184,
            2.0335958003997803,
            1.8243980407714844,
            -2.379660129547119,
            2.8449950218200684,
            3.7270514965057373,
            7.117681980133057,
            -2.568584680557251,
            -1.6899704933166504,
            -2.4110262393951416,
            -1.515659213066101,
            -0.848609983921051,
            2.6436314582824707,
            -3.3863210678100586,
            4.201136589050293,
            -1.3354315757751465,
            -3.981071949005127,
            -1.2722384929656982,
            -4.191408157348633,
            -6.296613693237305,
            0.6471775770187378,
            1.143612027168274,
            5.425403118133545,
            1.6111929416656494,
            -3.674539566040039,
            -1.9228399991989136,
            0.09854762256145477,
            -2.417764663696289,
            -2.7188243865966797,
            -1.803651213645935,
            0.44428831338882446,
            0.06376653909683228,
            -0.10090500116348267,
            -5.695005416870117,
            1.389661431312561,
            -3.8727493286132812,
            -1.02405846118927,
            -1.092362403869629,
            3.1006999015808105,
            5.4451117515563965,
            -2.2063822746276855,
            0.5290182828903198,
            1.1375060081481934,
            -1.6974892616271973,
            2.0553030967712402,
            3.917738914489746,
            0.5885737538337708,
            0.07051846385002136,
            3.749220371246338,
            1.5758283138275146,
            -5.904129981994629,
            -0.5945103764533997,
            -7.644279479980469,
            -4.171938896179199,
            -1.8287756443023682,
            3.920710325241089,
            -4.238979339599609,
            2.7467856407165527,
            -0.18302294611930847,
            3.546112537384033,
            -0.39923739433288574,
            -1.1091811656951904,
            4.040884017944336,
            -2.3691763877868652,
            1.5824329853057861,
            -4.143148899078369,
            -0.8006364107131958,
            -0.8287136554718018,
            -1.7740718126296997,
            1.403923511505127,
            3.969456434249878,
            -5.369744300842285,
            4.3834991455078125,
            0.9623852968215942,
            4.3008012771606445,
            2.4932854175567627,
            1.9025843143463135,
            -1.194258689880371,
            -4.803256511688232,
            -2.492729663848877,
            -2.8258323669433594,
            -2.3495218753814697,
            -0.0516352653503418,
            2.3033692836761475,
            5.914466857910156,
            0.25078290700912476,
            1.9217153787612915,
            1.496315836906433,
            -1.0061743259429932,
            1.170536756515503,
            -0.14592714607715607,
            -0.37031203508377075,
            -3.6409194469451904,
            -0.7784512042999268,
            -0.9456551671028137,
            4.302425384521484,
            0.2862005829811096,
            -0.695872962474823,
            4.129207134246826,
            3.053863525390625,
            -1.1335476636886597,
            0.506220281124115,
            1.0369601249694824,
            2.1376819610595703,
            -0.3743728697299957,
            -1.8582167625427246,
            -0.4308863878250122,
            0.12794923782348633,
            -2.7523698806762695,
            11.220742225646973,
            -3.556650161743164,
            2.196089267730713,
            -4.314952373504639,
            -4.4286065101623535,
            -3.9080090522766113,
            -2.8025543689727783,
            3.6466078758239746,
            -0.5700783729553223,
            -1.8344011306762695,
            0.9592185020446777,
            -2.03135347366333,
            0.7185315489768982,
            1.5695576667785645,
            0.9752987623214722,
            2.8565940856933594,
            1.3996690511703491,
            2.8509860038757324,
            -1.9272775650024414,
            -0.18141189217567444,
            -3.194012403488159,
            3.209009885787964,
            3.8229966163635254,
            0.8381505012512207,
            -0.948906421661377,
            1.8877501487731934,
            3.8483633995056152,
            1.0158462524414062,
            -3.787949562072754,
            -5.360344886779785,
            -1.9702296257019043,
            -3.656106472015381,
            2.873598575592041,
            1.3701705932617188,
            3.6177713871002197,
            -2.2719035148620605,
            1.1886169910430908,
            3.6652772426605225,
            -2.665477752685547,
            -1.475257396697998,
            4.783808708190918,
            1.5691795349121094,
            1.3000317811965942,
            -2.659858226776123,
            -3.4196953773498535,
            -2.638948917388916,
            -1.269749641418457,
            -3.490046739578247,
            0.6504829525947571,
            0.5887014269828796,
            2.6453495025634766,
            2.7646119594573975,
            2.1398544311523438,
            1.3183143138885498,
            0.46364277601242065,
            3.5557515621185303,
            4.452554702758789,
            2.3941686153411865,
            -3.203667640686035,
            1.534270167350769,
            1.9624098539352417,
            0.28403010964393616,
            -6.146628379821777,
            1.0150489807128906,
            -4.525899410247803,
            2.653280735015869,
            -2.0282366275787354,
            2.124354839324951,
            -2.853829860687256,
            2.9974656105041504,
            -0.6088917255401611,
            2.3230128288269043,
            -0.7740060091018677,
            -0.6689401268959045,
            3.867725372314453,
            3.190990924835205,
            -0.9028058648109436,
            2.6632330417633057,
            -0.4725673198699951,
            1.5930635929107666,
            -0.13906684517860413,
            -0.9629291296005249,
            -2.1087961196899414,
            -4.154428005218506,
            -1.1273071765899658,
            -4.41782808303833,
            -2.460984945297241,
            -2.6610465049743652,
            -0.07996591925621033,
            2.337294578552246,
            -4.040553569793701,
            -0.7417697906494141,
            2.045464038848877,
            0.19643132388591766,
            -1.387099266052246,
            5.795711517333984,
            -0.6941352486610413,
            2.833969831466675,
            1.7763211727142334,
            2.6113228797912598,
            -1.0443639755249023,
            -2.1849758625030518,
            0.7037854790687561,
            -0.5982922315597534,
            2.447173833847046,
            0.629076361656189,
            -1.9366143941879272,
            -2.928402900695801,
            1.6239516735076904,
            -1.525199294090271,
            3.889786720275879,
            0.6045880317687988,
            -3.1187844276428223,
            -8.871301651000977,
            -4.900908470153809,
            -0.29635050892829895,
            4.446136474609375,
            0.5641972422599792,
            -2.499833583831787,
            4.698449611663818,
            5.000434875488281,
            1.3036080598831177,
            1.6585488319396973,
            5.217624664306641,
            0.14112231135368347,
            -0.7413667440414429,
            2.2634236812591553,
            -0.961129903793335,
            1.8472269773483276,
            -0.6612687110900879,
            -3.3326172828674316,
            2.5303854942321777,
            2.0383174419403076,
            -0.38384121656417847,
            -1.0751200914382935,
            -5.3705339431762695,
            -2.411508560180664,
            -4.708349227905273,
            -4.028657913208008,
            4.074477672576904,
            2.4301023483276367,
            4.705930709838867,
            -2.6867616176605225,
            -0.5539071559906006,
            -0.22765329480171204,
            1.719616413116455,
            -6.745510101318359,
            3.2310545444488525,
            1.1682981252670288,
            1.5787551403045654,
            4.744987964630127,
            -0.5456141829490662,
            1.9760624170303345,
            2.9564168453216553,
            -4.507002353668213,
            -0.11050829291343689,
            -2.6380069255828857,
            4.52159309387207,
            1.484305500984192,
            -0.14292757213115692,
            -1.3064179420471191,
            0.33098918199539185,
            -1.1417782306671143,
            5.894093990325928,
            4.688814163208008,
            6.540722370147705,
            2.9077513217926025,
            -3.2014501094818115,
            -2.5123941898345947,
            -3.1621198654174805,
            0.9263842105865479,
            3.287961483001709,
            -1.7592458724975586,
            -2.5748767852783203,
            1.3986258506774902,
            1.462423324584961,
            -0.18356725573539734,
            0.33306097984313965,
            -2.323331117630005,
            3.7718071937561035,
            -3.054340124130249,
            -0.57962566614151,
            -3.323612689971924,
            0.9806368350982666,
            1.1296299695968628,
            -1.7206923961639404,
            -0.5467514395713806,
            -1.434705376625061,
            -2.23097562789917,
            0.9185275435447693,
            -2.3172693252563477,
            -3.9541540145874023,
            -2.2475814819335938,
            3.039153575897217,
            2.8710014820098877,
            -2.9017298221588135,
            0.7756925821304321,
            2.1515469551086426,
            -3.34678316116333,
            -0.6989232897758484,
            -2.032101631164551,
            4.055348873138428,
            -0.3270282745361328,
            -3.702643394470215,
            1.1347713470458984,
            -1.9666401147842407,
            0.49822306632995605,
            1.3542494773864746,
            1.4242644309997559,
            6.141180992126465,
            1.1383222341537476,
            4.964803695678711,
            -1.7343430519104004,
            -1.1054606437683105,
            -1.1926794052124023,
            -0.6336864233016968,
            -6.031869888305664,
            -7.163763999938965,
            2.009207010269165,
            -4.468776226043701,
            -5.073739051818848,
            -0.9118584394454956,
            -3.909980535507202,
            -3.2702229022979736,
            3.213672399520874,
            -1.0399346351623535,
            -4.283714294433594,
            -5.150091648101807,
            -0.899194598197937,
            -2.327423095703125,
            3.7203359603881836,
            -0.3253859281539917,
            0.28842827677726746,
            0.5162948966026306,
            2.767669200897217,
            1.6756070852279663,
            3.8122024536132812,
            2.554603099822998,
            -1.1418218612670898,
            -1.5423322916030884,
            3.7250068187713623,
            1.316716194152832,
            0.494625449180603,
            1.6013916730880737,
            -0.8657898902893066,
            4.269174575805664,
            9.262984275817871,
            0.29959848523139954,
            -0.32883232831954956,
            -3.3428170680999756,
            -1.3629189729690552,
            -3.2392587661743164,
            -0.4830174744129181,
            1.5137410163879395,
            1.5488522052764893,
            2.8567330837249756,
            0.4326013922691345,
            0.7855073809623718,
            0.8452762365341187,
            0.07905629277229309,
            -3.1625566482543945,
            -1.397434115409851,
            -2.6186676025390625,
            4.544861793518066,
            -2.8244595527648926,
            0.3160986006259918,
            -0.48077118396759033,
            3.5412678718566895,
            0.04977068305015564,
            0.07174600660800934,
            -1.7091903686523438,
            7.747392654418945,
            3.0598304271698,
            3.2907867431640625,
            -4.139948844909668,
            2.730329751968384,
            4.382024765014648,
            3.160797119140625,
            1.7012536525726318,
            -0.8347002267837524,
            -3.1892504692077637,
            6.401806354522705,
            4.007755756378174,
            -2.338557243347168,
            -0.301596999168396,
            0.2311348021030426,
            -0.597740113735199,
            3.5815858840942383,
            -1.8654568195343018,
            2.189518690109253,
            -2.8789420127868652,
            -0.27951475977897644,
            1.006047248840332,
            -0.9230674505233765,
            -2.7050940990448,
            4.2516984939575195,
            0.4861888587474823,
            0.7232271432876587,
            -2.514944076538086,
            4.41533088684082,
            2.0910794734954834,
            5.7005839347839355,
            -0.3160557746887207,
            -0.21315637230873108,
            1.7338236570358276,
            -0.10695090889930725,
            2.3525609970092773,
            -2.2662203311920166,
            -1.2348899841308594,
            -3.4184365272521973,
            -0.4880101978778839,
            2.7401366233825684,
            -7.346582412719727,
            4.632005214691162,
            1.7051947116851807,
            -0.9447131156921387,
            2.418402671813965,
            -0.266598105430603,
            0.9743559956550598,
            -5.890924453735352,
            0.19589731097221375,
            -0.8492751717567444,
            3.6898088455200195,
            3.6369082927703857,
            0.3231445848941803,
            9.676460266113281,
            -6.963486194610596,
            -0.03725573420524597,
            -2.2852272987365723,
            -0.6226111650466919,
            4.91400671005249,
            -0.562941312789917,
            5.638594627380371,
            2.8723044395446777,
            -2.0629281997680664,
            4.322778701782227,
            -1.6358718872070312,
            1.0091416835784912,
            1.088469386100769,
            1.832619071006775,
            6.617480278015137,
            -2.997591972351074,
            -4.278281211853027,
            -5.455261707305908,
            -1.439018726348877,
            0.35337042808532715,
            6.2822675704956055,
            3.376739978790283,
            1.022270917892456,
            -4.6751298904418945,
            -2.2998270988464355,
            -1.261696457862854,
            -1.9143612384796143,
            -3.8534867763519287,
            -4.852163791656494,
            -1.6872212886810303,
            3.9311931133270264,
            -5.471108913421631,
            -1.3740051984786987,
            0.23761391639709473,
            -1.398580551147461,
            -3.507439374923706,
            0.533789873123169,
            5.384894371032715,
            5.541424751281738,
            3.751488208770752,
            0.44750577211380005,
            -2.4875097274780273,
            -3.746551513671875,
            -3.543450355529785,
            -3.6766626834869385,
            -0.18011543154716492,
            1.691986322402954,
            -1.024712324142456,
            -1.9821497201919556,
            -0.3436555862426758,
            2.009066581726074,
            -0.3338835835456848,
            -2.3868541717529297,
            0.1548907458782196,
            -1.8291137218475342,
            -6.447376251220703,
            -1.1161754131317139,
            3.7591562271118164,
            -4.205307960510254,
            3.1328537464141846,
            5.398800849914551,
            -3.019364356994629,
            0.17690491676330566,
            8.567582130432129,
            -1.607213020324707,
            1.2564475536346436,
            -2.5165834426879883,
            -3.330874443054199,
            -1.879839539527893,
            0.016372740268707275,
            1.4496135711669922,
            -1.0210988521575928,
            4.527737617492676,
            -1.042108178138733,
            1.5503500699996948,
            -3.702026605606079
        ]
    },
    "authors": [
        {
            "authorId": "1846258",
            "name": "Noam M. Shazeer"
        }
    ],
    "references": [
        {
            "paperId": "6e45251b16cd423f3c025f004959c6d2b26efab0",
            "title": "Accelerating Neural Transformer via an Average Attention Network"
        },
        {
            "paperId": "a6e4beb28b345fce7470da122b4e45e2cd0dcd12",
            "title": "A Time-Restricted Self-Attention Layer for ASR"
        },
        {
            "paperId": "8691706ad0cf5e83969658b2e6bfffdc379440c9",
            "title": "Generating Wikipedia by Summarizing Long Sequences"
        },
        {
            "paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776",
            "title": "Attention is All you Need"
        },
        {
            "paperId": "fa72afa9b2cbc8f0d7b05d52548906610ffbb9c5",
            "title": "Neural Machine Translation by Jointly Learning to Align and Translate"
        },
        {
            "paperId": "5d833331b0e22ff359db05c62a8bca18c4f04b68",
            "title": "One billion word benchmark for measuring progress in statistical language modeling"
        }
    ]
}