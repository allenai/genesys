{
    "paperId": "d3d1acfe37fe8d98e06dcf63b6e6dbe90cca061d",
    "externalIds": {
        "DBLP": "journals/corr/abs-2406-06484",
        "ArXiv": "2406.06484",
        "DOI": "10.48550/arXiv.2406.06484",
        "CorpusId": 270371554
    },
    "title": "Parallelizing Linear Transformers with the Delta Rule over Sequence Length",
    "abstract": "Transformers with linear attention (i.e., linear transformers) and state-space models have recently been suggested as a viable linear-time alternative to transformers with softmax attention. However, these models still underperform transformers especially on tasks that require in-context retrieval. While more expressive variants of linear transformers which replace the additive outer-product update in linear transformers with the delta rule have been found to be more effective at associative recall, existing algorithms for training such models do not parallelize over sequence length and are thus inefficient to train on modern hardware. This work describes a hardware-efficient algorithm for training linear transformers with the delta rule, which exploits a memory-efficient representation for computing products of Householder matrices. This algorithm allows us to scale up DeltaNet to standard language modeling settings. We train a 1.3B model for 100B tokens and find that it outperforms recent linear-time baselines such as Mamba and GLA in terms of perplexity and zero-shot performance on downstream tasks (including on tasks that focus on recall). We also experiment with two hybrid models which combine DeltaNet layers with (1) sliding-window attention layers every other layer or (2) two global attention layers, and find that these hybrid models outperform strong transformer baselines.",
    "venue": "arXiv.org",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 2,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work describes a hardware-efficient algorithm for training linear transformers with the delta rule, which exploits a memory-efficient representation for computing products of Householder matrices and allows us to scale up DeltaNet to standard language modeling settings."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -3.9570531845092773,
            1.2458149194717407,
            2.299351692199707,
            3.4551219940185547,
            0.5102351903915405,
            1.2205851078033447,
            1.2648522853851318,
            0.45371007919311523,
            0.9068463444709778,
            -0.1472330093383789,
            2.066615581512451,
            4.182303428649902,
            0.2558223009109497,
            0.7851886749267578,
            -4.67179012298584,
            -0.6913038492202759,
            0.8103451132774353,
            2.6752877235412598,
            3.1503219604492188,
            1.1618033647537231,
            -0.6914750337600708,
            2.4819774627685547,
            -4.764379978179932,
            0.45719143748283386,
            -0.5899361371994019,
            0.4224036931991577,
            0.7636294960975647,
            0.12839657068252563,
            -5.082028388977051,
            -0.5178147554397583,
            0.032412588596343994,
            -4.53916072845459,
            3.471003532409668,
            -3.394296407699585,
            2.7499606609344482,
            -4.683119297027588,
            -4.748707294464111,
            5.875569820404053,
            -4.518436431884766,
            -2.340421199798584,
            -3.878453254699707,
            -2.316011428833008,
            -2.3365678787231445,
            -0.6065812706947327,
            0.32454729080200195,
            2.63155460357666,
            5.7492899894714355,
            2.977703094482422,
            -4.515713214874268,
            1.0063121318817139,
            5.487544536590576,
            -2.2358880043029785,
            -3.350717544555664,
            2.5102949142456055,
            0.5061365365982056,
            -3.8079886436462402,
            -0.47471296787261963,
            -1.0745106935501099,
            1.3654730319976807,
            -0.7289012670516968,
            2.9341084957122803,
            5.37314510345459,
            0.3655819296836853,
            2.5295910835266113,
            6.288503646850586,
            -3.5503859519958496,
            -2.290829658508301,
            0.8128299117088318,
            2.5503811836242676,
            1.4241623878479004,
            0.17628398537635803,
            -5.314593315124512,
            -1.9827696084976196,
            -1.4527604579925537,
            -2.3088386058807373,
            -1.0968079566955566,
            -0.8889784812927246,
            -3.705376625061035,
            2.422456979751587,
            -2.7817912101745605,
            -1.4378498792648315,
            0.6784954071044922,
            1.1329948902130127,
            -1.1391644477844238,
            7.1662421226501465,
            -3.8672332763671875,
            -4.218725681304932,
            1.523453950881958,
            1.74241042137146,
            -4.344986915588379,
            0.9591313004493713,
            2.0100858211517334,
            0.11664003133773804,
            0.9031069278717041,
            -0.4511916935443878,
            -3.122666835784912,
            1.1332048177719116,
            -0.1848517656326294,
            -1.3274849653244019,
            1.3390679359436035,
            2.5962724685668945,
            0.5662455558776855,
            0.5262589454650879,
            0.7703367471694946,
            2.3125998973846436,
            -0.10344095528125763,
            -4.318674087524414,
            1.957733154296875,
            1.2825559377670288,
            -1.7054431438446045,
            -1.866889238357544,
            2.3906540870666504,
            -0.787491500377655,
            2.7961833477020264,
            -2.7402360439300537,
            -7.42418909072876,
            -0.9440572261810303,
            0.28527334332466125,
            -0.17939463257789612,
            2.9571633338928223,
            -2.488701343536377,
            -1.6318942308425903,
            -3.7579731941223145,
            -0.031102418899536133,
            -3.09780216217041,
            3.754920244216919,
            -1.08189058303833,
            2.38753080368042,
            1.3314168453216553,
            -2.5540266036987305,
            0.11576312780380249,
            -2.1579418182373047,
            3.7572803497314453,
            -3.9071407318115234,
            3.839287519454956,
            3.2558131217956543,
            -2.6772196292877197,
            0.5124713182449341,
            -2.284614324569702,
            0.517781674861908,
            0.9945204257965088,
            2.2097041606903076,
            1.5588393211364746,
            0.13225685060024261,
            3.0007076263427734,
            5.467563152313232,
            0.8845998048782349,
            1.2840827703475952,
            -1.1717877388000488,
            5.711719512939453,
            3.8095312118530273,
            -4.353902816772461,
            0.6986083388328552,
            0.17588698863983154,
            -0.2565666437149048,
            3.3424575328826904,
            -4.6964874267578125,
            0.27446869015693665,
            -2.334260940551758,
            0.22922489047050476,
            0.6113951802253723,
            4.227758884429932,
            -9.50313663482666,
            0.008483737707138062,
            4.944696426391602,
            -2.141418933868408,
            -2.322753429412842,
            -1.1937110424041748,
            -0.946549117565155,
            2.439983367919922,
            -0.08543315529823303,
            1.780312418937683,
            1.2161293029785156,
            -1.8268141746520996,
            4.013119220733643,
            3.313127040863037,
            2.536139488220215,
            -3.6403119564056396,
            -0.9975310564041138,
            0.10279875993728638,
            -0.9960022568702698,
            2.453665256500244,
            -6.839062690734863,
            2.9424901008605957,
            -5.795393466949463,
            -4.073277473449707,
            -5.528962135314941,
            -4.478041172027588,
            -4.791730880737305,
            -1.6220359802246094,
            0.40062275528907776,
            -0.9161510467529297,
            5.219922065734863,
            4.866894245147705,
            1.6117908954620361,
            2.672788619995117,
            4.091423034667969,
            4.193016052246094,
            -6.666603088378906,
            -1.1356797218322754,
            6.306733131408691,
            -1.2562243938446045,
            -4.119741916656494,
            0.8990092277526855,
            2.9670650959014893,
            1.2939298152923584,
            -2.8170557022094727,
            4.685105323791504,
            -0.07706040143966675,
            0.48041197657585144,
            0.3789156675338745,
            -2.7800540924072266,
            -2.2542896270751953,
            0.0605887770652771,
            -0.5150517225265503,
            -4.54238748550415,
            -5.791414260864258,
            1.6539772748947144,
            7.070113182067871,
            0.7463396787643433,
            3.219064712524414,
            0.9221886992454529,
            0.07482771575450897,
            -7.243256568908691,
            -0.0585663765668869,
            -2.7563443183898926,
            3.00372314453125,
            -1.315171480178833,
            0.5908716320991516,
            2.342569589614868,
            -2.087175130844116,
            -6.202598571777344,
            -3.014507293701172,
            -0.4606919288635254,
            -2.501727342605591,
            -3.911818504333496,
            -6.118047714233398,
            -1.6019313335418701,
            0.0052800774574279785,
            -6.875597953796387,
            5.879040718078613,
            1.8802121877670288,
            0.056980833411216736,
            3.371030330657959,
            1.4135286808013916,
            0.11442238092422485,
            -0.47358208894729614,
            1.4946784973144531,
            -2.2316362857818604,
            -3.913234233856201,
            0.5433844327926636,
            -0.677548348903656,
            3.676262617111206,
            3.3864264488220215,
            1.7835674285888672,
            2.4060332775115967,
            2.3958182334899902,
            -3.3950886726379395,
            2.563220977783203,
            1.7485988140106201,
            -5.243346214294434,
            5.950348854064941,
            1.1848573684692383,
            3.5126638412475586,
            -0.5935336351394653,
            -2.5161051750183105,
            -2.169217824935913,
            -2.181028366088867,
            -0.6043022274971008,
            2.4002256393432617,
            2.5353856086730957,
            2.959944486618042,
            -0.6081092953681946,
            -2.218069076538086,
            2.5592966079711914,
            -3.7303619384765625,
            -2.758223533630371,
            0.9333668351173401,
            1.1829643249511719,
            5.555682182312012,
            2.273658037185669,
            -2.2268331050872803,
            -5.140761375427246,
            -0.4891185164451599,
            -1.0544183254241943,
            -2.0256078243255615,
            -0.8236413598060608,
            0.4607183337211609,
            -1.637973427772522,
            -0.7318402528762817,
            -4.831070899963379,
            2.41373610496521,
            -2.5123720169067383,
            -3.665994882583618,
            -2.855882167816162,
            4.4472503662109375,
            4.5650153160095215,
            -1.1352837085723877,
            1.7925784587860107,
            -1.2951207160949707,
            -3.2023324966430664,
            2.474590539932251,
            4.722276210784912,
            1.4095128774642944,
            1.9653716087341309,
            4.086189270019531,
            2.1255040168762207,
            -2.1019210815429688,
            -2.051837921142578,
            -5.855809688568115,
            -2.947679042816162,
            3.181880235671997,
            3.387805700302124,
            -3.1073708534240723,
            0.890455961227417,
            -2.262676477432251,
            2.3395652770996094,
            3.9091358184814453,
            -2.9955849647521973,
            1.869005560874939,
            -2.9337496757507324,
            1.7915880680084229,
            -5.836719512939453,
            -4.110774993896484,
            2.2313480377197266,
            -2.16015625,
            0.9267308712005615,
            2.004744291305542,
            -0.6201810836791992,
            3.9948840141296387,
            4.94184684753418,
            3.4827239513397217,
            3.84028959274292,
            -0.9784570932388306,
            -0.22499947249889374,
            -3.398739814758301,
            -0.9865700602531433,
            2.0862462520599365,
            -0.8479413390159607,
            3.043560743331909,
            1.8113763332366943,
            8.853343963623047,
            2.5096776485443115,
            0.2901409864425659,
            -1.6528141498565674,
            -0.35427093505859375,
            0.16664037108421326,
            -1.1523278951644897,
            -2.0835583209991455,
            1.9112454652786255,
            0.20575544238090515,
            0.1554155945777893,
            3.612171173095703,
            -2.4221031665802,
            -1.5516316890716553,
            4.67600154876709,
            3.049121379852295,
            1.7349164485931396,
            -1.1086398363113403,
            -0.3088057041168213,
            0.6148077845573425,
            -3.2043843269348145,
            4.339803695678711,
            -1.0817365646362305,
            0.8237754702568054,
            -3.22100830078125,
            11.773868560791016,
            -0.6557824015617371,
            0.16872888803482056,
            -3.0635178089141846,
            -3.68202543258667,
            1.5059727430343628,
            -4.9667510986328125,
            1.2005796432495117,
            -0.8895184993743896,
            -1.5145442485809326,
            2.930727005004883,
            -1.8371679782867432,
            -1.0287444591522217,
            -0.5802128314971924,
            -2.294790267944336,
            3.1251392364501953,
            2.2179408073425293,
            3.0633280277252197,
            -0.6261687278747559,
            4.193345546722412,
            -1.1379178762435913,
            1.930246353149414,
            1.345109462738037,
            -1.2051479816436768,
            -0.9124776124954224,
            1.0891177654266357,
            1.9076231718063354,
            0.9867587089538574,
            -5.344460487365723,
            -1.6590473651885986,
            -3.397148370742798,
            -7.556653022766113,
            -1.4649004936218262,
            1.4708231687545776,
            -2.796365261077881,
            0.19718441367149353,
            6.349415302276611,
            5.632755279541016,
            -4.582221984863281,
            -2.025881767272949,
            4.179573059082031,
            -2.972166061401367,
            0.8066112995147705,
            -1.3527252674102783,
            -4.855720520019531,
            -3.461066484451294,
            -0.03690989315509796,
            -1.9275649785995483,
            0.19571667909622192,
            -1.099919080734253,
            3.0252034664154053,
            -2.4856624603271484,
            5.249479293823242,
            0.22550076246261597,
            -1.5097624063491821,
            -0.4452023208141327,
            6.587167739868164,
            1.9225314855575562,
            -0.897554337978363,
            0.3520171344280243,
            0.9131473302841187,
            2.1838202476501465,
            -4.962883949279785,
            2.528348207473755,
            -1.812459111213684,
            6.41673469543457,
            -4.759164810180664,
            0.546766996383667,
            1.3796321153640747,
            1.3994159698486328,
            0.43767881393432617,
            6.596752643585205,
            1.7993651628494263,
            0.47399330139160156,
            1.1959528923034668,
            5.473264694213867,
            -1.9950342178344727,
            3.131134271621704,
            0.36117613315582275,
            3.3552591800689697,
            3.8535828590393066,
            -0.720151960849762,
            -0.3638486862182617,
            -4.586410045623779,
            4.078670024871826,
            -6.331439018249512,
            -3.4614739418029785,
            1.0481764078140259,
            0.8270314335823059,
            -0.08464890718460083,
            -3.226801872253418,
            -3.3044331073760986,
            2.5289225578308105,
            2.2656774520874023,
            -2.6611344814300537,
            1.960796594619751,
            -2.3954434394836426,
            2.1164028644561768,
            1.212161898612976,
            3.3492507934570312,
            -0.988501250743866,
            -5.0545501708984375,
            -1.9610745906829834,
            1.6458532810211182,
            4.19238805770874,
            1.6248736381530762,
            -3.7673826217651367,
            -2.9602813720703125,
            -0.2528325021266937,
            1.352280616760254,
            2.7735886573791504,
            2.09708833694458,
            2.2310996055603027,
            -6.3612895011901855,
            -4.955687046051025,
            0.5452091097831726,
            1.2330939769744873,
            -2.2673845291137695,
            -0.4574229419231415,
            4.827083587646484,
            4.159394264221191,
            1.1893806457519531,
            0.10671176016330719,
            -0.46628719568252563,
            -0.32250869274139404,
            -1.7192144393920898,
            6.701809883117676,
            0.9545246958732605,
            2.108287811279297,
            1.1229170560836792,
            -4.456225872039795,
            -2.223745822906494,
            1.8573330640792847,
            -0.9529447555541992,
            1.1395134925842285,
            -6.838464736938477,
            0.455075740814209,
            -1.099634051322937,
            -3.782705307006836,
            3.1703739166259766,
            5.548104286193848,
            2.6414382457733154,
            -2.826559543609619,
            -0.7035733461380005,
            1.4218823909759521,
            2.042849540710449,
            -3.1241455078125,
            4.082610130310059,
            0.03446352481842041,
            5.436214447021484,
            5.289507865905762,
            1.5177243947982788,
            5.012143135070801,
            -3.099280595779419,
            -1.7284772396087646,
            0.9490687251091003,
            0.6473971605300903,
            0.7621127367019653,
            2.119771957397461,
            1.0897600650787354,
            -3.8088395595550537,
            3.2662153244018555,
            2.7222518920898438,
            4.808729648590088,
            6.722003936767578,
            5.718947410583496,
            1.2661409378051758,
            -0.8593369126319885,
            -0.11617147922515869,
            -3.919454574584961,
            2.8377346992492676,
            6.041401386260986,
            -4.556083679199219,
            -1.0019240379333496,
            1.7769654989242554,
            2.8255724906921387,
            -1.6278249025344849,
            -1.4417442083358765,
            -1.8862375020980835,
            1.2686522006988525,
            -0.6370620727539062,
            -0.4422656297683716,
            -0.8299046754837036,
            -0.3017845153808594,
            3.537130117416382,
            1.318519115447998,
            0.9079326391220093,
            -3.148087501525879,
            -2.806027412414551,
            -1.862849235534668,
            -1.8588378429412842,
            -2.8254456520080566,
            -4.162081241607666,
            6.722303867340088,
            3.5399227142333984,
            0.33870729804039,
            -0.34068745374679565,
            0.565580427646637,
            -6.6580963134765625,
            -2.6935877799987793,
            0.34421032667160034,
            4.764371395111084,
            -0.3481347858905792,
            -3.3700332641601562,
            -2.3615429401397705,
            -0.9536523818969727,
            0.9692210555076599,
            1.4596103429794312,
            0.22598759829998016,
            1.6482720375061035,
            5.56563138961792,
            6.561316013336182,
            -2.993741989135742,
            3.6621360778808594,
            0.24417567253112793,
            -0.715287446975708,
            -4.6493306159973145,
            -4.375515937805176,
            2.666505813598633,
            -6.364541053771973,
            -6.69750452041626,
            0.11262410879135132,
            -4.695347785949707,
            -3.045091152191162,
            0.6312825679779053,
            -4.408720016479492,
            -0.1821945309638977,
            -5.160687446594238,
            1.1438689231872559,
            -2.475299835205078,
            2.2754979133605957,
            0.17579524219036102,
            -0.7877703905105591,
            1.8321521282196045,
            3.1511049270629883,
            2.5550942420959473,
            0.21878096461296082,
            2.4694204330444336,
            -3.0630269050598145,
            -2.759827136993408,
            1.9126954078674316,
            1.92160964012146,
            0.6549664735794067,
            2.5410361289978027,
            0.08104006946086884,
            0.8973385095596313,
            16.350563049316406,
            2.2422521114349365,
            -0.5705736875534058,
            -4.251888275146484,
            -1.6042526960372925,
            -3.329401969909668,
            -5.992404937744141,
            4.023192405700684,
            3.3815343379974365,
            1.6690000295639038,
            -2.0652551651000977,
            -1.3237364292144775,
            0.11634176969528198,
            0.39948952198028564,
            -1.2927484512329102,
            1.8939391374588013,
            -1.7913438081741333,
            5.697344779968262,
            -2.1871910095214844,
            -0.44733861088752747,
            0.5234525203704834,
            2.972971200942993,
            2.991206645965576,
            -1.0848701000213623,
            -0.7805218696594238,
            4.761590957641602,
            -0.32845306396484375,
            2.7381484508514404,
            -2.5608763694763184,
            2.807248830795288,
            0.7460489273071289,
            4.868989944458008,
            -2.190706253051758,
            1.5491430759429932,
            -2.992896556854248,
            4.894585609436035,
            2.6849677562713623,
            -2.695230484008789,
            4.417011737823486,
            0.2266966998577118,
            -3.029560089111328,
            0.48907631635665894,
            -2.5678045749664307,
            -1.9481661319732666,
            -1.7128043174743652,
            1.9972411394119263,
            1.5519165992736816,
            -1.3857097625732422,
            -2.8906874656677246,
            1.9698656797409058,
            2.2072741985321045,
            -3.698357343673706,
            -0.40974873304367065,
            1.3081705570220947,
            2.8294222354888916,
            5.526848316192627,
            3.8315510749816895,
            -0.20284616947174072,
            1.7031031847000122,
            0.475147008895874,
            1.8674052953720093,
            0.39273107051849365,
            0.9270431399345398,
            -3.5809762477874756,
            -2.2592103481292725,
            -0.21816523373126984,
            -3.2981622219085693,
            0.7464195489883423,
            2.8777048587799072,
            0.393023282289505,
            0.4858662784099579,
            2.196202278137207,
            -0.22029292583465576,
            -3.7822656631469727,
            -1.6724741458892822,
            -5.761626243591309,
            3.249668598175049,
            -1.909114122390747,
            -3.1456856727600098,
            7.338430404663086,
            -3.178835868835449,
            -0.491650253534317,
            -3.6096057891845703,
            -2.6602039337158203,
            3.9167823791503906,
            -2.5641989707946777,
            5.4249114990234375,
            3.9025511741638184,
            -2.2426161766052246,
            5.210224151611328,
            -2.975973606109619,
            0.592552125453949,
            1.7265390157699585,
            5.090291976928711,
            5.125478744506836,
            -1.8362512588500977,
            -1.5156199932098389,
            -0.562258780002594,
            -3.7591562271118164,
            -0.10908933728933334,
            4.448092937469482,
            3.806133985519409,
            -3.3653054237365723,
            -0.7682566046714783,
            -1.0762866735458374,
            1.546950340270996,
            -2.310096263885498,
            -4.344548225402832,
            -2.0425338745117188,
            -2.713115930557251,
            1.6213438510894775,
            -6.11507511138916,
            -2.151172637939453,
            1.8547084331512451,
            0.079037144780159,
            -0.9073030948638916,
            -0.3158900737762451,
            4.001855373382568,
            2.149200677871704,
            5.0956268310546875,
            2.6134939193725586,
            0.191792830824852,
            -2.180220127105713,
            -4.435968399047852,
            -1.0799689292907715,
            2.149479389190674,
            1.7509970664978027,
            -4.2703680992126465,
            1.6619750261306763,
            0.2221885621547699,
            2.8931777477264404,
            -5.028298854827881,
            -3.18709397315979,
            -3.153799057006836,
            -0.49003201723098755,
            -4.156250953674316,
            2.386936664581299,
            -1.816369652748108,
            -3.617669105529785,
            1.7699062824249268,
            4.405296802520752,
            -2.2571396827697754,
            -4.175056457519531,
            8.496063232421875,
            0.9470120668411255,
            -2.142604112625122,
            -0.15150713920593262,
            -1.9273875951766968,
            0.6894683241844177,
            0.2835046052932739,
            0.6850972175598145,
            -2.3732264041900635,
            1.8580217361450195,
            0.783021092414856,
            0.24399691820144653,
            -2.021507740020752
        ]
    },
    "authors": [
        {
            "authorId": "50591392",
            "name": "Songlin Yang"
        },
        {
            "authorId": "2257409822",
            "name": "Bailin Wang"
        },
        {
            "authorId": "49890808",
            "name": "Yu Zhang"
        },
        {
            "authorId": "2273540596",
            "name": "Yikang Shen"
        },
        {
            "authorId": "2261394948",
            "name": "Yoon Kim"
        }
    ],
    "references": []
}