{"paperId": "105f2ea0f902f33a9d9a1fa079f4dcdeb16d655c", "title": "Accelerating the inference of string generation-based chemical reaction models for industrial applications", "abstract": "Template-free SMILES-to-SMILES translation models for reaction prediction and single-step retrosynthesis are of interest for industrial applications in computer-aided synthesis planning systems due to their state-of-the-art accuracy. However, they suffer from slow inference speed. We present a method to accelerate inference in autoregressive SMILES generators through speculative decoding by copying query string subsequences into target strings in the right places. We apply our method to the molecular transformer implemented in Pytorch Lightning and achieve over 3X faster inference in reaction prediction and single-step retrosynthesis, with no loss in accuracy.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work presents a method to accelerate inference in autoregressive SMILES generators through speculative decoding by copying query string subsequences into target strings in the right places by copying query string subsequences into target strings in the right places."}, "embedding": {"model": "specter_v2", "vector": [1.1315810680389404, 0.7869748473167419, -0.8680267930030823, 0.7290958166122437, -0.2193259596824646, -0.4830666184425354, 0.7974497675895691, -0.08257046341896057, 0.25052425265312195, 0.1654653549194336, 0.48979347944259644, -0.7121266722679138, 0.5117818713188171, -0.23461586236953735, -0.34444814920425415, -0.7862208485603333, -0.4686110317707062, 0.3442448079586029, 0.4573253393173218, 0.13783809542655945, 0.39077720046043396, -0.3012534976005554, -1.0161244869232178, 0.40583741664886475, 0.24201972782611847, 0.9759564995765686, -0.19499659538269043, 0.8107980489730835, -0.5764828324317932, 0.3746907711029053, 0.48399418592453003, -0.3144206702709198, 0.404802531003952, -0.8646532297134399, -0.29818060994148254, -0.28801071643829346, -0.42741721868515015, 0.22106091678142548, -0.32486727833747864, 0.5951398611068726, 0.06489378213882446, 0.18894462287425995, 0.7041792273521423, -0.6188998818397522, -0.2443077564239502, 0.9666246175765991, 0.6512556672096252, 0.06625743210315704, -0.012414682656526566, -0.11531154811382294, 1.203830361366272, -1.080716848373413, 0.7011305689811707, 1.0325489044189453, 0.3979729115962982, 0.2430025190114975, 0.06552090495824814, -1.0516018867492676, 0.23285134136676788, -0.02722783386707306, -0.6564335823059082, -0.36747369170188904, -0.007961082272231579, -0.1995553821325302, 2.0199031829833984, -0.06488350033760071, 0.06270881742238998, 0.7290450930595398, 0.4127219021320343, 0.9187259674072266, 0.05075114220380783, -0.5554307103157043, 0.46211010217666626, -0.006416140589863062, -0.40282225608825684, 0.4115108847618103, -0.1001456081867218, 0.4675339460372925, -0.9658894538879395, -0.25926274061203003, 0.23939156532287598, -0.0956849455833435, 0.1736217439174652, -0.013217977248132229, -0.35587078332901, 0.5282790064811707, 0.28163033723831177, 0.5942490100860596, -0.20672756433486938, 0.2563101649284363, 0.6201127767562866, -0.14724917709827423, -0.2395436018705368, 0.5604182481765747, 0.12068066745996475, 0.5992189049720764, -0.6341516971588135, 0.2133951485157013, -0.2970244288444519, 0.8727241158485413, -0.4930519461631775, 0.6849640011787415, -0.742453396320343, -0.2838444113731384, 1.139625906944275, -0.0526023730635643, 0.6485750079154968, -0.7351992726325989, 0.2141716033220291, -0.31682440638542175, 0.21592675149440765, -0.2902345359325409, 0.07339044660329819, -0.20275339484214783, -0.754633903503418, -1.3056209087371826, -0.6191354990005493, 0.29400211572647095, -1.0346174240112305, 0.44702965021133423, 0.05575113743543625, 0.49655380845069885, 0.23296424746513367, -0.039929892867803574, 0.5336287617683411, 0.8601424098014832, 0.7092975378036499, -0.77873694896698, 0.6354657411575317, -0.681776762008667, -0.15656226873397827, -0.47992610931396484, 0.3348621428012848, -0.0655580386519432, -0.6483216881752014, 0.1353454887866974, -1.4397677183151245, -1.0396924018859863, -0.7452597618103027, 0.12896697223186493, -0.8063384294509888, -0.2081516832113266, 0.8920665383338928, 0.18963930010795593, -0.40288421511650085, 1.0478588342666626, -0.08647365868091583, 0.010567105375230312, -0.061245035380125046, 0.15840588510036469, 0.48572173714637756, -0.02562231756746769, -1.067238450050354, 0.20132514834403992, 0.5138240456581116, -0.7655813097953796, -0.48115065693855286, -0.9139621257781982, -0.7258225679397583, -0.12380935251712799, 0.5570719838142395, -0.9149647951126099, 1.4399850368499756, 0.34537720680236816, -1.7586040496826172, 0.402586430311203, -0.16689802706241608, -0.06899234652519226, 0.44503238797187805, 0.7093868255615234, -0.2703772485256195, -0.3956335186958313, -0.16379445791244507, 0.34453490376472473, 0.607322633266449, -0.28216657042503357, 0.14457672834396362, 0.024612003937363625, -0.7561364769935608, -0.43827834725379944, 0.0936928540468216, 0.9468572735786438, -0.14924582839012146, -0.4532985985279083, 0.3755647838115692, 0.3447873294353485, -0.7825693488121033, -0.2321150004863739, -0.8215633630752563, -0.9165751338005066, 0.5243241190910339, 0.10017896443605423, 0.9466789960861206, -0.19463972747325897, -0.49960681796073914, 0.07254566252231598, -0.5270086526870728, -0.04257570952177048, -0.4187071919441223, 1.0043940544128418, -1.1678385734558105, 0.52729731798172, -0.45978036522865295, -0.40972650051116943, -0.3322561979293823, -0.5666152238845825, -1.115709900856018, -0.39025822281837463, 0.053419068455696106, 0.9683836698532104, -1.0112563371658325, 0.39837613701820374, 0.2029692679643631, 0.09491896629333496, -0.8533383011817932, 0.8601948022842407, -0.5652940273284912, 0.5675332546234131, -0.06584342569112778, -0.1281498670578003, -0.34282341599464417, -0.0630088821053505, 0.6928521990776062, -0.34269216656684875, -0.8760350346565247, 0.6169981956481934, -0.27119573950767517, 1.4258520603179932, 0.05317603051662445, -0.453889936208725, -0.6149895787239075, -0.4314749240875244, 0.5815162658691406, 0.6285466551780701, 0.25833410024642944, -0.69708651304245, 0.27439481019973755, 0.442524790763855, -0.3262234330177307, 0.22102825343608856, 0.48778364062309265, 0.47634321451187134, -0.36694589257240295, 0.0008820047951303422, 0.24673546850681305, -0.7483747601509094, 0.8198480010032654, 0.09521816670894623, 0.4485853612422943, 0.546218752861023, 0.8634750247001648, 0.07981026917695999, 0.41400349140167236, -0.5514392852783203, 0.12484418600797653, 0.43414631485939026, 1.0866800546646118, 0.732328474521637, 0.3202507197856903, -0.8386649489402771, -0.6270127892494202, 0.4074588418006897, 0.8458125591278076, 0.7432907223701477, -0.2604896128177643, -0.5778918266296387, -0.585435152053833, -0.058625102043151855, -0.24075578153133392, 0.4997086524963379, -0.007288976106792688, -0.6843755841255188, -0.20417632162570953, -1.4583195447921753, 0.8527607917785645, 0.38746562600135803, 0.8403026461601257, -0.38190123438835144, 0.0829223096370697, 0.031161457300186157, 0.5048366189002991, -0.6493076682090759, -0.3008154332637787, 0.33286598324775696, -0.3088330626487732, -0.11947321891784668, -0.08727888762950897, 0.2440752238035202, -0.09307451546192169, -0.5107927322387695, 0.4076242744922638, -0.4912053346633911, -0.8814414143562317, -0.6364155411720276, 0.9036593437194824, -0.8573411703109741, -1.2598663568496704, -0.30539557337760925, 0.024766167625784874, -0.4687148332595825, 0.0007899247575551271, 0.12462463229894638, -0.22410093247890472, 0.11463945358991623, -0.23715467751026154, 0.22294044494628906, -0.37649545073509216, 0.10765423625707626, 0.7941012382507324, -0.22000925242900848, -0.36722543835639954, -0.4703475832939148, 0.4025718569755554, 0.23262792825698853, -0.9252537488937378, 0.17405444383621216, -0.8148605227470398, -0.23661111295223236, 0.8723665475845337, -0.27832695841789246, -0.34461989998817444, -0.5745282173156738, -0.019252104684710503, 0.1265716403722763, -0.018039995804429054, 0.06190495938062668, 0.32395511865615845, 0.255596786737442, 0.1930660605430603, 1.1092755794525146, 0.26506397128105164, 0.1967027187347412, 0.598595142364502, -0.5779995918273926, 0.5394942760467529, 0.16289696097373962, -0.1711520552635193, -0.30416905879974365, 0.6143017411231995, -0.8800460696220398, 0.14918696880340576, -0.18692757189273834, 0.1368299275636673, -0.2436961680650711, 0.46903425455093384, -0.6870192885398865, -1.2480942010879517, -0.11334431916475296, -1.199306845664978, -0.24511724710464478, 0.3408968150615692, -0.4782605767250061, -0.38333436846733093, -0.44974690675735474, -0.926008939743042, -0.8593007326126099, -0.7917368412017822, -1.45591402053833, 0.8647051453590393, -0.17191098630428314, -0.6652201414108276, -0.10104397684335709, 0.23793341219425201, -0.29016318917274475, 0.2855452597141266, -0.029144736006855965, 0.788448691368103, 0.08087019622325897, -0.40445002913475037, 0.056218020617961884, 0.6515565514564514, -0.054547831416130066, -0.034685954451560974, 0.9705464839935303, -0.603305995464325, 0.5711997151374817, -0.7417842745780945, -0.05761320888996124, 0.40802785754203796, 0.23595650494098663, 1.3297843933105469, -0.10810350626707077, -0.9740093946456909, -0.06984522938728333, 1.068369746208191, 0.2465740293264389, 0.5131810903549194, 0.013710124418139458, 0.6950356364250183, -0.021959370002150536, 0.14132392406463623, 0.8082510828971863, -0.2849499583244324, 0.8519191741943359, 0.17473913729190826, -0.3989812731742859, 0.10475582629442215, -0.8629512190818787, 0.8012296557426453, 0.6641268730163574, -0.09738706052303314, -0.1892516016960144, -0.9436485767364502, -0.016428859904408455, -1.0249600410461426, -1.1101316213607788, 0.279381662607193, 0.8234300017356873, 0.4876212477684021, -0.2573949992656708, 0.1621333807706833, 0.5818415880203247, 0.44797831773757935, -0.1474287211894989, -0.5699738264083862, -0.9688623547554016, 0.06340216845273972, 0.7834674119949341, 0.4932364523410797, 0.5473540425300598, 0.04418468475341797, 0.5967674255371094, 15.143078804016113, 0.6503739953041077, -0.3977546989917755, 0.2288324385881424, 0.7921748161315918, 0.6663028597831726, -0.25908783078193665, 0.0937756597995758, -1.4607727527618408, 0.30021199584007263, 1.3259152173995972, -0.0937669649720192, 0.16318605840206146, 0.591875433921814, 0.6653821468353271, 0.3433338403701782, -0.1580749750137329, 0.322604238986969, 0.3019520938396454, -1.929355502128601, 0.8727984428405762, 0.40089619159698486, 0.2975650131702423, 0.22341960668563843, 0.6981050968170166, 0.3415234684944153, 0.48273932933807373, -0.2887856662273407, 0.4585345387458801, -0.15294000506401062, 0.8457924127578735, -0.18745741248130798, 0.16477392613887787, 0.18619100749492645, -0.958971381187439, -0.3509460389614105, -0.629187822341919, -0.9538211226463318, 0.09894667565822601, 0.42527931928634644, -1.6605983972549438, -0.13118641078472137, -0.4778182804584503, 0.9543027281761169, 0.81070876121521, 0.3334735035896301, -0.25632646679878235, 0.34108737111091614, 0.282034307718277, 0.03847596049308777, -0.01860891282558441, -0.32785671949386597, -0.296060174703598, -0.018804211169481277, 0.8381370306015015, 0.14283744990825653, 0.21086002886295319, 0.32129546999931335, -0.41888293623924255, -0.38447368144989014, -0.7839904427528381, -0.5495719909667969, -0.18997707962989807, 0.6124081015586853, 0.11520078033208847, -0.10204228013753891, 0.20830166339874268, 0.04017946124076843, -0.4461544454097748, -0.10911251604557037, -0.4533354341983795, 0.10221290588378906, 0.6006717681884766, -0.3135004937648773, -0.08574268221855164, 0.3976164758205414, -0.36803096532821655, -0.14233554899692535, -1.102302074432373, -0.8484600186347961, 0.32047730684280396, -0.8003607988357544, -0.13657525181770325, 0.5825568437576294, -0.47390782833099365, -0.39615628123283386, 0.2652864456176758, -1.3009847402572632, -0.6794152855873108, 0.05113113671541214, -1.2002328634262085, -0.36373594403266907, 0.35845062136650085, -0.5936825275421143, -0.06123226881027222, 0.18649961054325104, 1.2365880012512207, -0.3758195638656616, -0.9341517090797424, -0.4036600887775421, 0.31003135442733765, -0.550714373588562, -0.2150518298149109, -0.6298627257347107, 1.170366883277893, 0.18208381533622742, -0.5308486819267273, 0.3220124840736389, 0.4092012047767639, -0.23642046749591827, -0.8580615520477295, -0.29665613174438477, 0.4553905725479126, -0.9498035907745361, -0.11958163231611252, -0.7517129182815552, -0.5243814587593079, -0.14041613042354584, 0.28714266419410706, -0.7610448598861694, 0.6746141910552979, -0.7169568538665771, -0.30747437477111816, -0.050455816090106964, -0.6678521037101746, 0.5002884268760681, 0.987900972366333, -0.5811254978179932, 0.1786092072725296, 0.520365834236145, 0.5339401960372925, -0.8177409172058105, -0.9597771167755127, 0.13760897517204285, 0.24012596905231476, 0.08956246823072433, 1.4202109575271606, -0.8466269373893738, 1.0516784191131592, 0.30140653252601624, 0.13074803352355957, -0.6451411843299866, -0.332048237323761, -1.416167974472046, 0.34344786405563354, -0.15967166423797607, 0.9057425856590271, -0.5532376766204834, 0.05140650272369385, 0.8684084415435791, -0.08043073117733002, -0.032422829419374466, -0.6347405910491943, -0.4026365280151367, 0.08351508527994156, -0.030917655676603317, 0.6987046599388123, -0.2789319157600403, 0.6501943469047546, -0.06284605711698532, 0.09005571156740189, 0.6987699270248413, -0.4747159779071808, -0.38305413722991943, 0.32253003120422363, 0.45362764596939087, -0.25177696347236633, -0.5359088778495789, -0.33951637148857117, -0.877016544342041, -0.3629020154476166, -1.137136697769165, 0.056751638650894165, -0.6350184082984924, -0.34226924180984497, 0.5004351139068604, -0.3239592909812927, 0.05576741322875023, 0.5453827977180481, -0.30424895882606506, -0.9935566186904907, -0.7992046475410461, -0.27090397477149963, 0.7290968894958496, 0.8413845300674438, -1.2109925746917725, 0.1449873000383377, -0.2894982397556305, -0.1132776141166687, -0.24728374183177948, 0.5579946041107178, -0.3701082170009613, -0.6461194753646851, -0.22776585817337036, 0.28742358088493347, 0.016943499445915222, -0.37306150794029236, -0.6365660429000854, 0.10147065669298172, 0.04950070008635521, -0.03509175032377243, 0.05971671640872955, 0.2620536684989929, -0.37404924631118774, 0.7249007225036621, 1.0147138833999634, -0.8239696621894836, 0.11416542530059814, -0.05768030136823654, -0.5560442209243774, 0.1517816185951233, 0.7858061194419861, -0.19723621010780334, -1.5182077884674072, -0.10820028930902481, 0.6485698819160461, -0.942125678062439, -0.6994041204452515, 0.007712040562182665, -0.21084684133529663, -0.9993776082992554, 0.18180741369724274, 0.24122972786426544, -0.10356670618057251, -0.09165392816066742, 1.1036542654037476, 0.357610821723938, -0.7814715504646301, 0.6353154182434082, 0.13983598351478577, 0.038154236972332, -0.3268895149230957, -0.03476071357727051, 0.4349091351032257, -0.11762357503175735, 0.9561768174171448, 0.47368600964546204, 0.41006189584732056, -0.8872402906417847, 0.7199962735176086, 0.284709632396698, -0.2961796522140503, 0.13286741077899933, 0.47839492559432983, -0.1627877950668335, -0.6213830709457397, -0.2714584171772003, -1.6405967473983765, -0.2893202006816864, -0.5757096409797668, 0.8505409359931946, 0.3946850299835205, 0.29937034845352173, 0.13715995848178864, -0.25746050477027893, 0.41086718440055847, 0.01044392678886652, 0.1242755874991417, 0.5240812301635742, 0.5037504434585571, -0.1599622219800949, 0.021335246041417122, 0.3142491579055786, -0.8090325593948364, -0.24248933792114258, -0.03332757204771042, -0.47120800614356995, 0.09463431686162949, 0.10642415285110474, -0.17426787316799164, -0.14367283880710602, 0.39226412773132324, 0.30775606632232666, 0.02610049583017826, -0.14316050708293915, -0.3499259650707245, 0.002153851091861725, 0.47429215908050537, 0.07829244434833527, -0.8510122299194336, -0.34438657760620117, 0.461813747882843, 1.3905833959579468, -0.4254719614982605, 0.5579736232757568, -0.8447173237800598, -0.8884916305541992, 1.1335601806640625, -0.06317300349473953, 0.5927715301513672, 0.30982691049575806, -0.25182220339775085, -0.34936287999153137, 0.3678053021430969, -0.9860371351242065, -0.1316637098789215, 0.015534467995166779, 0.8988038301467896, 0.7384795546531677, 0.059366580098867416, -0.10656826198101044, 0.6928725242614746, 0.34577786922454834, 0.4760894477367401, 0.558962345123291, 0.817419171333313, -0.18249085545539856, -0.4833422899246216, -0.09315633028745651, -0.025252236053347588, -0.2468491494655609, -0.7822010517120361, -0.4362364709377289, 0.07895443588495255, 0.24444204568862915, 0.6680330634117126, 0.3857879042625427, 0.14275822043418884, 0.632080078125, 0.3349805474281311, 0.24654416739940643, -0.38773229718208313, -0.06923256814479828, -0.10941210389137268, -0.17490093410015106, -0.23092468082904816, -0.16203846037387848, -0.41134971380233765, -0.6350632905960083, 0.11701206117868423, 0.07809947431087494, 0.42215201258659363, 0.5140458941459656, 0.9110709428787231, 0.8118085265159607, 0.23523089289665222, 0.1701194792985916, -0.7159684300422668, -0.2034355103969574, -0.17746345698833466, 0.5271106362342834, -0.8757510781288147, -0.7026501893997192, -0.39955657720565796, -0.017203431576490402, -0.44991931319236755]}, "authors": [{"authorId": "2311443408", "name": "Mikhail Andronov"}, {"authorId": "2311438626", "name": "Natalia Andronova"}, {"authorId": "2311436590", "name": "Michael Wand"}, {"authorId": "2311440772", "name": "Jurgen Schmidhuber"}, {"authorId": "34917892", "name": "Djork-Arn\u00e9 Clevert"}], "references": [{"paperId": "57e7af0b69325fafb371ef5d502e39ef9c90ef7e", "title": "Medusa: Simple LLM Inference Acceleration Framework with Multiple Decoding Heads"}, {"paperId": "291c103940944d670b5f4b485be6a6b3cbbe5128", "title": "Models Matter: The Impact of Single-Step Retrosynthesis on Synthesis Planning"}, {"paperId": "c61d54644e9aedcfc756e5d6fe4cc8b78c87755d", "title": "A Survey of Large Language Models"}, {"paperId": "d8e9f8c8a37cb4cd26b92ad0d942d641cd512644", "title": "Fast Inference from Transformers via Speculative Decoding"}, {"paperId": "218c5c69f3cf0c158e9b6af239a2cc62a688c6de", "title": "Speculative Decoding: Exploiting Speculative Execution for Accelerating Seq2seq Generation"}, {"paperId": "75e957c1eb3231b5adea44063ec142c6978bd6a2", "title": "Root-aligned SMILES: a tight representation for chemical reaction prediction"}, {"paperId": "3f9f7f690e003176316d0ee56fbcbfed4b6b0948", "title": "Chemformer: a pre-trained transformer for computational chemistry"}, {"paperId": "600a10fa7af9e8e37fa3fff0b39233344c9755d9", "title": "Molecule Edit Graph Attention Network: Modeling Chemical Reactions as Sequences of Graph Edits"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "5406e153957dd7a165264da6e6e5d81251997404", "title": "State-of-the-art augmented NLP transformer models for direct and single-step retrosynthesis"}, {"paperId": "de20b6488e148a19ae6c63defbfca8a6373e4110", "title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction"}, {"paperId": "6e3e17ac9a5a25ca718bd2da025a7117c4f03634", "title": "A Generative Model For Electron Paths"}, {"paperId": "ef8ab2a0be51a0cd04c2c0f01adfae956a2a84af", "title": "Planning chemical syntheses with deep neural networks and symbolic AI"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "316189e419212794e74bf83442f65de96b5320ba", "title": "Extraction of chemical structures and reactions from the literature"}, {"paperId": "68bbc5a34bb6e8feecc8f5d4736028e7cdee4f11", "title": "Computer-assisted synthesis and reaction planning in combinatorial chemistry"}, {"paperId": "fad44646fe2590bab52e0b6a781f0e6294be704b", "title": "Designing an Expert System for Organic Synthesis: The Need for Strategic Planning"}, {"paperId": "af0a80d6ee5f5ed96baeae494c68fa99a260cec9", "title": "LHASA\u2014Logic and Heuristics Applied to Synthetic Analysis"}, {"paperId": null, "title": "Accelerating the inference of string generation-based chemical reaction bust and flexible open-source software for retrosynthetic planning"}, {"paperId": null, "title": "Learning to control fast-weight memories: An alternative to recurrent nets"}, {"paperId": null, "title": "If the best candidate sequences have different lengths, organizes them in a tensor by padding them with a special PAD token from the left"}, {"paperId": null, "title": "Aizynthfinder: a fast, ro-5"}]}