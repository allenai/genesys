{"paperId": "858019916e929fc3854b74e4080b3342fc58d9ff", "title": "Detecting out-of-distribution text using topological features of transformer-based language models", "abstract": "To safeguard machine learning systems that operate on textual data against out-of-distribution (OOD) inputs that could cause unpredictable behaviour, we explore the use of topological features of self-attention maps from transformer-based language models to detect when input text is out of distribution. Self-attention forms the core of transformer-based language models, dynamically assigning vectors to words based on context, thus in theory our methodology is applicable to any transformer-based language model with multihead self-attention. We evaluate our approach on BERT and compare it to a traditional OOD approach using CLS embeddings. Our results show that our approach outperforms CLS embeddings in distinguishing in-distribution samples from far-out-of-domain samples, but struggles with near or same-domain datasets.", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work explores the use of topological features of self-attention maps from transformer-based language models to detect when input text is out of distribution, and shows that this approach outperforms CLS embeddings in distinguishing in-distribution samples from far-out-of-domain samples, but struggles with near or same-domain datasets."}, "embedding": {"model": "specter_v2", "vector": [-0.4608784019947052, 0.48312729597091675, -0.5929673910140991, 0.06583777070045471, -0.3650777041912079, -0.5118615031242371, 0.6873334646224976, 0.37844446301460266, -0.2764638066291809, -0.2906854748725891, 0.6914164423942566, -0.2938424050807953, 0.008106115274131298, -0.034848786890506744, -0.16889020800590515, 0.2030629962682724, -0.638431191444397, 0.6343488693237305, 0.3450777232646942, -0.5688610076904297, -0.27958112955093384, -0.9015668630599976, -0.43025216460227966, 0.35192057490348816, 0.6861095428466797, 0.3157251477241516, -0.34262868762016296, 0.5676302909851074, -0.9609735012054443, 0.5315142273902893, 0.03508106246590614, -0.4351382851600647, -0.13964836299419403, 0.0940018892288208, -0.24450653791427612, 0.08665616065263748, 0.4142616391181946, -0.18570339679718018, -0.6868206262588501, 0.8170890212059021, -0.20414488017559052, 0.02371317520737648, 0.79169762134552, -0.7856578826904297, -0.7084288001060486, 1.1447489261627197, 0.6623460650444031, 1.0420206785202026, 0.05017424374818802, -0.8765920400619507, 1.3152620792388916, -1.2712990045547485, 0.28248775005340576, 1.2376424074172974, 0.4161462187767029, 0.09285847842693329, -0.4847501814365387, -0.7882782816886902, 0.27237457036972046, 0.4912985861301422, -1.054494857788086, -0.20801368355751038, 0.11422902345657349, -0.5419194102287292, 1.6632179021835327, -0.6713243126869202, -0.1888316422700882, 0.39332547783851624, -0.12657564878463745, 1.6954563856124878, -0.22475583851337433, -0.8593341708183289, -0.05857193097472191, 0.477400541305542, 0.13305369019508362, 0.6397854685783386, -0.5379616022109985, -0.08022534102201462, -1.033089518547058, -0.3953883647918701, -0.08786329627037048, -0.3386523723602295, -0.04139268398284912, -0.7330448627471924, 0.0036360479425638914, 0.6771026849746704, -0.052638500928878784, 0.9894058704376221, 0.024338319897651672, 0.38782989978790283, 0.7015684247016907, 0.42665112018585205, 0.3415280282497406, 0.05944094806909561, -0.17504020035266876, 0.01434345543384552, -0.9802131056785583, 0.22314509749412537, -0.07063230872154236, 0.8013831973075867, -0.2692570686340332, 0.3546870946884155, -0.47701895236968994, 0.49472567439079285, 1.0689817667007446, 0.11831261962652206, 1.0616412162780762, -0.19920270144939423, 0.25435179471969604, -0.33961981534957886, 0.07297845184803009, -0.6274380087852478, 0.04132727161049843, -0.38628631830215454, -0.37660571932792664, -1.2727813720703125, -0.12410566210746765, 0.05798928067088127, -0.4521579146385193, 0.5391748547554016, -0.29960960149765015, -0.3856428265571594, 0.01588030345737934, 0.14831869304180145, 0.21780408918857574, 0.4042605757713318, 0.09196124970912933, 0.43923673033714294, 0.7273828983306885, -0.1685527116060257, -0.5464591979980469, -0.8042494654655457, 1.0509886741638184, -0.14691534638404846, 0.2878093719482422, -0.3400098979473114, -0.9210513830184937, -0.493734747171402, -0.6553952097892761, 0.6539597511291504, -0.7175017595291138, 0.31393927335739136, 0.4234636425971985, 0.47850340604782104, -0.9804944396018982, 0.9489496946334839, -0.09325656294822693, -0.39382779598236084, 0.6139628291130066, -0.03385680168867111, 0.09234227985143661, -0.38973745703697205, -1.590599775314331, 0.15865522623062134, 0.1625932902097702, -1.1611522436141968, -0.15685704350471497, -0.6643825769424438, -1.5568102598190308, -0.4104365110397339, 0.3853713572025299, 0.07913193106651306, 1.327075481414795, -0.10496804118156433, -0.8525606393814087, 0.8319004774093628, -0.3481508493423462, 0.1501399427652359, 0.3287102282047272, 0.10056889802217484, -0.61463463306427, -0.7771704196929932, 0.3296891152858734, -0.09338976442813873, 0.759645938873291, 0.05557838827371597, -0.05808277055621147, -0.06233447790145874, -0.4893646538257599, -0.11994750052690506, -0.698840856552124, 0.5848692655563354, -0.1995086371898651, -0.4418007433414459, 0.21155712008476257, 1.0466252565383911, 0.6608917117118835, -0.4363613724708557, -0.7424449324607849, -1.5077871084213257, 0.7797623872756958, 0.08902900665998459, 1.080389142036438, -0.9688829779624939, -0.8973190188407898, -0.24769790470600128, 0.004512280225753784, -0.20978011190891266, -0.6699801683425903, 1.1278797388076782, -0.7488727569580078, 0.7134001851081848, 0.1913823038339615, -0.845809280872345, 0.28818556666374207, -0.34282004833221436, -0.881022036075592, 0.0032303084153681993, -0.023112114518880844, 0.7932409048080444, -1.1424106359481812, 0.18195892870426178, 0.09064332395792007, -0.0626654103398323, -0.6002098917961121, 1.0855555534362793, -0.38949546217918396, -0.34107959270477295, 0.12320579588413239, -0.09844774752855301, 0.2296094447374344, 0.13982683420181274, 0.16735586524009705, -0.27181342244148254, -0.19508597254753113, 0.6797360777854919, -0.14158602058887482, 0.7366440296173096, -0.26995301246643066, 0.43046823143959045, -0.4384121894836426, -0.7429566383361816, 0.017888598144054413, 0.39385274052619934, 0.09714233130216599, -0.44607385993003845, 0.21097317337989807, 0.11944270879030228, -0.4196770489215851, 0.11993784457445145, 0.8326820135116577, 0.8089869022369385, -0.3234370946884155, 0.5418526530265808, 0.6328465938568115, -0.06242756173014641, 0.7052526473999023, 0.4081093370914459, 0.9825918078422546, 0.3734089434146881, 0.3260143995285034, -0.31658267974853516, 0.24760383367538452, -0.4225490391254425, -0.1996391862630844, 0.19061578810214996, 0.44990774989128113, 0.4581766724586487, 0.7261912822723389, -0.340986967086792, -0.44975143671035767, -0.2622644305229187, 0.497681200504303, 1.5853945016860962, -0.2713409662246704, -0.8792847394943237, -0.5766234397888184, -0.6229814291000366, 0.1478556990623474, 0.43151307106018066, -0.40790149569511414, -0.3027094006538391, -0.24868400394916534, -0.8141767382621765, 0.9616757035255432, 0.37444043159484863, 0.5050875544548035, -0.31358036398887634, -0.06608840078115463, -0.036850228905677795, 0.22898875176906586, -0.4222022593021393, -0.7629965543746948, 0.6410987377166748, -0.20769640803337097, 0.04124445840716362, -0.013964444398880005, -0.25221094489097595, 0.15945467352867126, -0.712457001209259, 0.8156659603118896, -0.7271424531936646, -0.5259891748428345, 0.1853068619966507, 0.31545281410217285, -0.7727039456367493, -0.902204692363739, 0.38389673829078674, 0.3180381953716278, -0.2513279318809509, 0.8863591551780701, 0.733870804309845, 0.37419313192367554, 0.1978219896554947, -0.6906707882881165, -0.39640384912490845, -0.34198567271232605, 0.3234878182411194, -0.20700575411319733, 0.655585527420044, -0.14503389596939087, -1.084784984588623, 1.1787222623825073, -0.22511853277683258, -0.3968851566314697, -0.10448292642831802, -0.6136899590492249, -0.1272299885749817, 0.7816203832626343, -0.841289222240448, 0.14980535209178925, -1.286294937133789, 0.43816646933555603, -0.2882961332798004, -0.09529847651720047, 0.4964947998523712, 0.14272579550743103, 0.7590745091438293, 0.3613183796405792, 0.7699054479598999, 0.5396061539649963, 0.06145024672150612, 0.582894504070282, -0.4354078471660614, 0.16837935149669647, 0.06994332373142242, 0.5011745095252991, -0.21934933960437775, -0.6733295917510986, -1.147768497467041, -0.1670997440814972, -0.42573490738868713, -0.1170312836766243, -0.0877830758690834, -0.15455102920532227, -0.5375102162361145, -0.6622440218925476, 0.02437463216483593, -0.6887921094894409, -0.42458897829055786, 0.04168734699487686, -0.5980005264282227, 0.03846335411071777, -0.8514605164527893, -1.21853506565094, -0.8165201544761658, 0.17762957513332367, -0.6188845634460449, 0.0858512595295906, -0.24742074310779572, -0.895457923412323, -1.0081759691238403, -0.07464040815830231, -0.7184382677078247, 1.1461224555969238, -1.0277955532073975, 1.0341415405273438, -0.23201346397399902, 0.011496339924633503, -0.2652529776096344, 0.2575587332248688, 0.299822598695755, 0.310774028301239, 0.14876465499401093, -0.4270154535770416, 0.048223767429590225, -0.33320799469947815, -0.33455848693847656, -0.21383902430534363, 0.26783084869384766, 0.7723760604858398, -0.11344894766807556, -0.6347126960754395, -0.10231032222509384, 1.4232608079910278, -0.5011020302772522, -0.07661619037389755, 0.22049057483673096, 0.5626115202903748, 0.6515273451805115, 0.05807940289378166, 0.625920295715332, 0.6091848611831665, 0.3708876073360443, 0.17839764058589935, -0.36371514201164246, 0.37663522362709045, -0.8276941776275635, 0.5252922177314758, 1.2216535806655884, 1.001475214958191, -0.299030065536499, -1.2109472751617432, 1.148895502090454, -1.1201547384262085, -0.7736044526100159, 0.6546317934989929, 0.498796284198761, 0.45500871539115906, -0.33804717659950256, -0.14328891038894653, 0.12873363494873047, 0.21822041273117065, 0.1974218785762787, -0.17926913499832153, -0.4539651572704315, 0.18805289268493652, 0.3401165306568146, 0.7414401173591614, 0.5129516124725342, -0.6147189140319824, 0.6609899997711182, 14.930065155029297, 0.9486323595046997, -0.20497854053974152, 0.5063369870185852, 0.14580169320106506, 0.8635181784629822, -0.7406176328659058, -0.15503568947315216, -0.9609034061431885, 0.23694391548633575, 0.8511142134666443, -0.28621846437454224, 0.445650577545166, 0.1498604416847229, -0.16903692483901978, 0.006131277885288, -0.40810686349868774, 0.4609493017196655, 1.0781140327453613, -0.8837137818336487, 0.20350824296474457, 0.362932413816452, -0.09871792048215866, 0.5270295143127441, 0.8747290968894958, 0.5192375779151917, 1.0620231628417969, -0.3189842402935028, 0.9180253148078918, -0.25954869389533997, 1.1621135473251343, -0.2205784022808075, 0.5440275073051453, 1.009277105331421, -0.6857218742370605, -0.15086297690868378, -0.7958652973175049, -0.7869763970375061, -0.17689430713653564, 0.4045525789260864, -1.1414380073547363, -0.35239988565444946, -0.18005429208278656, 0.6634264588356018, 0.10376216471195221, -0.09661594778299332, 0.012019254267215729, 0.6607667803764343, 0.24348878860473633, -0.19950197637081146, -0.09609712660312653, 0.692396342754364, 0.47235313057899475, -0.013666483573615551, 0.17832255363464355, -0.5418702960014343, 0.11592361330986023, 0.4780898690223694, -0.26222020387649536, 0.25188133120536804, -0.7421841621398926, -0.6109384894371033, -0.1389331966638565, 0.4603588879108429, 0.7569063305854797, 0.09457030892372131, -0.1902344673871994, 0.6229426860809326, 0.7464227676391602, 0.12680163979530334, -0.20452772080898285, -0.20721915364265442, 0.6171777844429016, 0.30885282158851624, 0.07440487295389175, 0.5769250392913818, 0.2089894562959671, -0.612999439239502, -0.8483777642250061, -0.11953742802143097, 0.5826789140701294, -0.6816034913063049, -1.1795868873596191, 1.1572563648223877, -0.33810269832611084, -0.9135128855705261, 0.03545011952519417, -0.9107827544212341, -0.01827683299779892, 0.45279622077941895, -1.0664143562316895, -0.24711409211158752, 0.32783785462379456, -0.5038470029830933, -0.31394535303115845, -0.304160475730896, 1.2359591722488403, 0.10895932465791702, -0.20283883810043335, 0.16114328801631927, 0.5917377471923828, 0.14356468617916107, 0.4503718316555023, -1.4195362329483032, 0.9170889854431152, -0.026631945744156837, -0.16818131506443024, 0.37849855422973633, 0.21817505359649658, 0.11161668598651886, -0.37151899933815, -0.4012635350227356, 0.9412867426872253, -1.4311530590057373, 0.10349540412425995, -1.0961337089538574, -0.8418062925338745, 0.17233963310718536, 0.6691719889640808, -0.4665776193141937, 0.5993282198905945, 0.15027791261672974, -0.6381997466087341, -0.028096545487642288, -0.7066425681114197, 0.17683573067188263, 0.2592480778694153, -0.9107694625854492, -0.6215633153915405, -0.13572876155376434, -0.344267338514328, -0.9210973381996155, -0.27345770597457886, -0.3779396712779999, -0.2877045273780823, 0.04070620238780975, 0.7039163708686829, -0.38211455941200256, 0.88084876537323, 0.48135295510292053, -0.19660837948322296, -1.3498215675354004, -0.21795828640460968, -0.5440244674682617, 0.2616178095340729, 0.6646839380264282, 0.625015377998352, -0.502498984336853, 0.6499272584915161, 0.7852697968482971, 0.4602776765823364, -0.300235778093338, -0.3150396943092346, -0.578241765499115, 0.3880869746208191, -0.6900600790977478, 0.4629139304161072, 0.3335268199443817, 0.6410600543022156, 0.1212395578622818, 0.6753087639808655, 0.1247619241476059, 0.006658290512859821, -1.1124311685562134, 0.48722463846206665, -0.08432876318693161, 0.17897838354110718, -0.47276437282562256, -0.5232052206993103, -1.1207525730133057, 0.3447518050670624, -1.545293927192688, 0.0025838653091341257, -1.0192574262619019, -0.6666808724403381, -0.0748477578163147, -0.007622487377375364, -0.10514603555202484, 0.9339566230773926, -0.5926792025566101, -0.8492311835289001, -0.6474397778511047, -0.36674532294273376, 0.7759719491004944, 0.17467527091503143, -1.0866405963897705, 0.28715214133262634, -0.30828699469566345, -0.2518811821937561, 0.25190743803977966, 0.568375825881958, -0.7128568887710571, -0.8752462267875671, -1.2011040449142456, 0.014744452200829983, -0.4444738030433655, -0.4180702269077301, -0.22595800459384918, 0.5288583040237427, 0.13626499474048615, 0.036629438400268555, -0.38720524311065674, -0.1027592122554779, -0.8027598857879639, -0.657170832157135, 0.1905839443206787, -0.7134723663330078, 0.34990379214286804, -0.0282968208193779, -0.6061432361602783, -0.4170032739639282, 0.6875180602073669, -0.042920053005218506, -1.1567798852920532, -0.5023239850997925, 0.33632710576057434, -1.1032342910766602, 0.6688200235366821, 0.018494190648198128, -0.36229434609413147, -0.9602476954460144, -0.5112625360488892, 0.39190673828125, 0.46610742807388306, -0.018062066286802292, 1.3205904960632324, 0.20131100714206696, -1.202782392501831, 0.2241991013288498, 0.6964731812477112, 0.5466289520263672, -0.4155712127685547, 0.625434398651123, 0.14015088975429535, -0.32230979204177856, 0.47051385045051575, 0.3803945481777191, 0.03894004598259926, -0.9535340070724487, -0.016473831608891487, 0.5306909680366516, -0.3255894184112549, -0.16498757898807526, 1.041206955909729, -0.14267516136169434, -1.3303240537643433, 0.1400970220565796, -1.0992547273635864, -0.6451297402381897, -0.22448161244392395, 0.7212037444114685, 0.0627230554819107, 0.014216067269444466, -0.22415664792060852, -0.7263402938842773, -0.09497305750846863, -0.2906881868839264, -0.5900635123252869, 0.32588645815849304, -0.09651228040456772, -0.3831002712249756, 0.8105576038360596, 0.8700089454650879, -0.1124386191368103, -0.24141079187393188, -0.692731499671936, -0.1390157788991928, -0.43926480412483215, 0.20761443674564362, -0.2781641185283661, 0.06917337328195572, 0.607345461845398, 0.07483568787574768, 0.6576434373855591, -0.5458285808563232, 0.15856194496154785, 0.2837868630886078, 0.16544033586978912, 0.04483968764543533, -1.0729342699050903, -0.15300717949867249, 1.5900921821594238, 0.9052785038948059, -0.6438567638397217, -0.15126687288284302, -0.1944909393787384, -0.7353951930999756, 0.9397909641265869, 0.5192294716835022, 0.2141381949186325, 1.077560305595398, 0.18520955741405487, 0.6572996973991394, 0.10551517456769943, -1.1234312057495117, -0.2705826461315155, 0.5690754055976868, 1.2560904026031494, 0.8081674575805664, 0.2933323085308075, 0.4821203649044037, 0.6507853865623474, -0.05749167874455452, -0.003761222818866372, 0.9323130249977112, 0.4130963385105133, -0.2403487116098404, -0.4684206247329712, -0.021225733682513237, 0.8269556760787964, -0.5297691226005554, -0.31688058376312256, -0.25145116448402405, 0.6328265070915222, 0.12017611414194107, 0.464927077293396, 0.8384810090065002, -0.5110436677932739, 0.5981179475784302, 0.4750884175300598, 0.17798814177513123, -0.6089445352554321, 0.124173603951931, -0.49205824732780457, -0.5940870046615601, 0.2599186301231384, 0.3338525593280792, -0.6173744797706604, -0.3264845907688141, -0.35645100474357605, 0.17993572354316711, 0.03649499639868736, 0.1562643200159073, 0.980964720249176, 0.3790794014930725, 0.4639975428581238, -0.39266061782836914, 0.2915794849395752, -0.7377468347549438, -0.8030530214309692, -0.4126424789428711, -0.3672735393047333, 0.13859668374061584, -0.18223793804645538, -0.27905505895614624, -0.6538347005844116]}, "authors": [{"authorId": "2267725677", "name": "Andres Pollano"}, {"authorId": "2267728923", "name": "Anupam Chaudhuri"}, {"authorId": "2267725822", "name": "Anj Simmons"}], "references": [{"paperId": "df2bf162406f607abc2445ee9e8857f875c0c9ff", "title": "MLGuard: Defend Your Machine Learning Model!"}, {"paperId": "7d5dfe1a97d7c3b071518d518dd73a8168a4556f", "title": "Is Fine-tuning Needed? Pre-trained Language Models Are Near Perfect for Out-of-Domain Detection"}, {"paperId": "f406aceba4f29cc7cfbe7edb2f52f01374486589", "title": "The Internal State of an LLM Knows When its Lying"}, {"paperId": "a57756eece3017d480dbb08d231b26c6fbdfd272", "title": "Beyond Mahalanobis-Based Scores for Textual OOD Detection"}, {"paperId": "aed386a091fbb5128a67c4364c835b1daaefe0a4", "title": "News Category Dataset"}, {"paperId": "a7264b4ee55fcd54dfa1d8a735697cd75f7a193c", "title": "The Topological BERT: Transforming Attention into Topology for Natural Language Processing"}, {"paperId": "8b1233107bff00355d4d1656795ec62d4f85e523", "title": "Out-of-distribution Detection with Deep Nearest Neighbors"}, {"paperId": "7b2180d7fa0d65e8756401cb077bf3dea3f9b575", "title": "Generalized Out-of-Distribution Detection: A Survey"}, {"paperId": "8331f4363d65235a8344e6a0c9b21fa3ab4c1d5e", "title": "Types of Out-of-Distribution Texts and How to Detect Them"}, {"paperId": "2af03a9bff2e6f14deca8f0b7bb243a56efd182a", "title": "Artificial Text Detection via Examining the Topology of Attention Maps"}, {"paperId": "9de3e6f471552fade7e17daa9f15df4eb92410af", "title": "Revisiting Mahalanobis Distance for Transformer-Based Out-of-Domain Detection"}, {"paperId": "0f1b9a40d81b92b4359e492c158272d61c2beefb", "title": "Algebraic topology"}, {"paperId": "ecaf8d7f87b5e3461bbd2a17a36b3e55fb69afa2", "title": "Ripser: efficient computation of Vietoris\u2013Rips persistence barcodes"}, {"paperId": "d03ca175e2b2745126e792fdc31dfadae4c63afa", "title": "A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks"}, {"paperId": "668db48c6a79826456341680ee1175dfc4cced71", "title": "Get To The Point: Summarization with Pointer-Generator Networks"}, {"paperId": "1c61f9ef06fe74505775a833ff849185757199e7", "title": "Learning Word Vectors for Sentiment Analysis"}, {"paperId": "36507626221eb678eb5b121455a9e9338ab03975", "title": "Measuring shapes by size functions"}, {"paperId": "733223004b838ed6885f447cf7b8133a88399dda", "title": "Topological Data Analysis Helps to Improve Accuracy of Deep Learning Models for Fake News Detection Trained on Very Small Training Sets"}, {"paperId": null, "title": "\ud835\udc58 folden"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Towards computing homology from finite approximations"}, {"paperId": null, "title": "Amplitude : We compute amplitude using two different distance measures: \u2018bottleneck\u2019 and \u2018Wasserstein\u2019"}, {"paperId": null, "title": "Conference of the North American Chapter"}]}