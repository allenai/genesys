{"paperId": "3b6e1f4bfb081456f218c2921f9b567b5007de3d", "title": "PharaCon: A new framework for identifying bacteriophages via conditional representation learning", "abstract": "Motivation Identifying bacteriophages (phages) within metagenomic sequences is essential for understanding microbial community dynamics. Transformer-based foundation models have been successfully employed to address various biological challenges. However, these models are typically pre-trained with self-supervised tasks that do not consider label variance in the pre-training data. This presents a challenge for phage identification as pre-training on mixed bacterial and phage data may lead to information bias due to the imbalance between bacterial and phage samples. Results To overcome this limitation, this study proposed a novel conditional BERT framework that incorporates labels during pre-training. We developed an approach using a conditional BERT model for pre-training labeled data, incorporating label constraints with modified language modeling tasks. This approach allows the model to acquire label-conditional sequence representations. Additionally, we proposed a solution that utilizes conditional BERT in the fine-tuning phase as a classifier. We applied this conditional BERT framework to identify phages using a novel fine-tuning strategy, introducing PharaCon. We evaluated PharaCon against several existing methods on both simulated sequence datasets and real metagenomic contig datasets. The results demonstrate PharaCon's potential as an effective and efficient method for phage identification, highlighting the effectiveness of conditional B ERT as a solution for learning label-specific representations during pre-training on mixed sequence data. Availability The codes of PharaCon are now available in: https://github.com/Celestial-Bai/PharaCon. Contact yaozhong@ims.u-tokyo.ac.jp and imoto@hgc.jp", "venue": "bioRxiv", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://www.biorxiv.org/content/biorxiv/early/2024/06/17/2024.06.16.599237.full.pdf", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "An approach using a conditional BERT model for pre-training labeled data, incorporating label constraints with modified language modeling tasks, highlighting the effectiveness of conditional B ERT as a solution for learning label-specific representations during pre-training on mixed sequence data."}, "embedding": {"model": "specter_v2", "vector": [0.8088091015815735, -0.01654096134006977, -0.15752580761909485, -0.07736311852931976, -0.6987675428390503, -0.46397116780281067, 0.49707549810409546, -0.18495585024356842, -0.06914375722408295, -0.1331797093153, 0.3516806364059448, -0.36117908358573914, 0.04369628056883812, 0.2545381784439087, -0.06902752071619034, -0.8243313431739807, -0.7641202807426453, 0.6608534455299377, -0.25032174587249756, 0.2027396708726883, 0.06439066678285599, -0.8018285036087036, -0.7152729034423828, 0.3142201602458954, 0.26804277300834656, 0.6180717349052429, 0.514822781085968, 1.2661185264587402, -0.592780351638794, 0.23552633821964264, 0.6016934514045715, -0.37455669045448303, 0.234473317861557, -0.14077414572238922, -0.2649116814136505, 0.01732243411242962, -0.22020813822746277, -0.17505952715873718, -0.5896023511886597, 0.7855386137962341, -0.3476017117500305, -0.11571092903614044, 0.9211997985839844, -0.8653827905654907, -0.20216044783592224, 0.6247140765190125, 0.6240468621253967, 0.43620309233665466, -0.23661290109157562, -0.2142283171415329, 1.6999704837799072, -0.6615825891494751, 0.503904402256012, 1.4079883098602295, 0.8610756993293762, 0.03195170313119888, -0.7049176692962646, -0.744499921798706, 0.07743149250745773, -0.184488445520401, -0.632146954536438, 0.3142487704753876, -0.392672598361969, -1.089139461517334, 1.508375644683838, -0.22142349183559418, -0.06033734604716301, 0.685332715511322, 0.028840133920311928, 1.439401388168335, 0.3024575114250183, -0.6219255924224854, -0.28747814893722534, 0.08225086331367493, 0.22816751897335052, 0.6765198111534119, -0.556785523891449, 0.7639073729515076, -0.6898443102836609, -0.43581491708755493, -0.09156859666109085, 0.26411038637161255, 0.1629904955625534, -0.0028808657079935074, -0.5963725447654724, 0.7401130199432373, 0.40634632110595703, 0.1957152932882309, -0.6607033014297485, 0.44122514128685, 0.7251757383346558, 0.01958797499537468, -0.4194587767124176, 0.4164169430732727, -0.12470570206642151, 0.2130887359380722, -0.0864550918340683, -0.36717846989631653, 0.05726573243737221, 0.6001706123352051, -0.13062867522239685, 0.07017937302589417, -0.9319846630096436, -0.10265552997589111, 1.3580361604690552, -0.33319583535194397, 0.18408054113388062, -0.27998852729797363, -0.2520807385444641, -0.21186710894107819, 0.09823323786258698, -0.6445663571357727, 0.10993696004152298, 0.1863548904657364, -0.6527535319328308, -1.4944089651107788, -0.5258406400680542, 0.15634211897850037, -1.2651785612106323, 0.6894321441650391, -0.39331454038619995, 0.15930113196372986, 0.24931487441062927, 0.06793227791786194, 0.48284804821014404, 0.8185749650001526, 0.4362070858478546, 0.017708444967865944, 0.7838631868362427, -0.33734095096588135, -0.6945118308067322, -0.435459166765213, 0.32338109612464905, -0.19335870444774628, -0.5084705352783203, -0.3394499123096466, -0.15707676112651825, -0.5123342275619507, -0.45992305874824524, 0.6605955362319946, -0.5504400730133057, 0.3527001738548279, 1.3590129613876343, 0.41790783405303955, -0.5174856781959534, 0.370985746383667, -0.3186056911945343, -0.5748277306556702, 0.20956744253635406, 0.07258995622396469, 0.27440786361694336, -0.45117348432540894, -1.0711002349853516, 0.5536816120147705, 0.9017122387886047, -0.6603347063064575, -1.443872094154358, -0.3091316521167755, -0.4397064447402954, -0.09486088156700134, 0.02890573814511299, -0.21314850449562073, 1.200016975402832, 0.0137290945276618, -0.6925353407859802, 0.8544454574584961, -0.18924325704574585, 0.2600013017654419, 0.18249472975730896, 0.11362604051828384, -0.31161779165267944, -0.6065565943717957, 0.2664174735546112, 0.26627328991889954, 0.15694774687290192, -0.4975268840789795, -0.18722082674503326, 0.2107439935207367, -0.03239503502845764, -0.4261557161808014, -0.5302196145057678, 0.7427205443382263, -0.2004588544368744, -0.5862565040588379, 0.1116148978471756, 0.565724790096283, -0.24733784794807434, 0.2718650996685028, -0.8569512963294983, -0.6182869076728821, 0.5884574055671692, -0.4316426217556, 0.395425021648407, -0.9434005618095398, -0.1430528312921524, -0.48486244678497314, 0.22176678478717804, 0.06394430249929428, -0.6558225750923157, 1.0567176342010498, -0.49561190605163574, 0.20949530601501465, -0.5756720900535583, -0.4393637776374817, -0.23955336213111877, -0.022493479773402214, -0.447223961353302, -0.10558557510375977, 0.23647966980934143, 0.677915632724762, -1.0954092741012573, 0.36293795704841614, 0.40442201495170593, 0.4923422634601593, -0.6070696711540222, 1.5059012174606323, -0.6567126512527466, 0.23338201642036438, 0.17085234820842743, 0.182155579328537, 0.6288430690765381, -0.574844241142273, 0.7668617367744446, -0.4157988727092743, -0.28140437602996826, 0.7040463089942932, -0.2497802972793579, 1.0097644329071045, 0.27711746096611023, 0.4857028126716614, 0.2606949806213379, -0.9502122402191162, 0.6880877017974854, 0.4916977286338806, 0.18030104041099548, 0.3738461136817932, 0.5661386847496033, 0.06606525927782059, -0.6410291790962219, 0.0038876028265804052, 0.35022225975990295, -0.048401013016700745, 0.45914727449417114, 0.0027795296628028154, 0.7290714383125305, 0.18511103093624115, 0.3925778567790985, 0.4698508679866791, 0.7965143322944641, 0.18850009143352509, 0.26541149616241455, -0.34441322088241577, 0.13270191848278046, -0.43366968631744385, 0.18990378081798553, 0.0010849616955965757, 0.5678766965866089, 0.3144446313381195, 0.6740279197692871, -0.5829297304153442, -0.08691240847110748, 0.06381374597549438, 0.39999473094940186, 1.4081047773361206, 0.05741799995303154, -0.7250508666038513, 0.03488863259553909, -0.34017589688301086, -0.03173229098320007, -0.12661778926849365, -0.5478203296661377, -0.2909233570098877, 0.025801416486501694, -1.4781368970870972, 1.068622350692749, 0.20639526844024658, 0.4988498091697693, -0.09574814140796661, 0.006079894956201315, -0.5403782725334167, -0.14158277213573456, -0.3714997470378876, -0.3435859978199005, 1.5849803686141968, 0.03603541478514671, -0.6484847068786621, -0.15656952559947968, -0.6173141002655029, 0.03061084821820259, -0.5924134254455566, 0.5272121429443359, -0.5005280375480652, -0.6877821683883667, -0.018855024129152298, 0.27628660202026367, -1.0898454189300537, -1.0736793279647827, -0.32229822874069214, 0.11065199226140976, -0.07408914715051651, 0.7985079884529114, 0.7953057885169983, 0.41811323165893555, 0.28339406847953796, -0.6142517924308777, 0.36074724793434143, -0.10408972948789597, 1.1354964971542358, 0.4869184195995331, 0.16464877128601074, -0.3334107995033264, -0.5406246781349182, 0.15496675670146942, 0.16618183255195618, -0.6616153717041016, 0.5191614627838135, -0.32844260334968567, -0.3389613628387451, 0.24678976833820343, -0.3515004813671112, -0.5499070286750793, -0.5416812300682068, 0.0803835541009903, 0.008064531721174717, 0.11163388192653656, 0.4185045659542084, 0.6629474759101868, 0.17163968086242676, 0.5599525570869446, 0.7355788350105286, 0.619448721408844, -0.07196531444787979, 0.11700116842985153, -0.029380422085523605, 0.14196862280368805, 0.16425487399101257, 0.10557813942432404, -0.07086648792028427, -0.01867193914949894, -0.837094247341156, -0.5750563740730286, -0.8495506048202515, -0.24742400646209717, -0.4387319087982178, 0.6086581349372864, -0.7180198431015015, -1.0694184303283691, 0.23166786134243011, -0.9909148812294006, -0.00543198361992836, 0.30997729301452637, 0.21918396651744843, 0.12665203213691711, -0.8539221882820129, -1.3474493026733398, -0.8125305771827698, -0.1803535372018814, -1.3138314485549927, 0.1960553079843521, -0.45270490646362305, 0.38453859090805054, -0.42323702573776245, 0.2848377823829651, -0.4824604392051697, 0.576809823513031, -0.02708466351032257, 1.0599647760391235, 0.10197322815656662, -0.22187374532222748, -0.04191843047738075, -0.23308780789375305, 0.6036674380302429, 0.21721187233924866, 0.7963916659355164, -0.7224844098091125, 0.030155479907989502, -0.5844579339027405, -0.6671923398971558, 0.6259300708770752, 0.27807870507240295, 0.7145835757255554, 0.5896785259246826, -0.7034263610839844, 0.5920838117599487, 1.414149522781372, -0.28264182806015015, -0.19679610431194305, 0.045834749937057495, 0.8368195295333862, 0.5860722661018372, -0.022707747295498848, 0.8547303676605225, 0.029061708599328995, 0.5755147337913513, 0.7472108602523804, 0.022808155044913292, 0.167571023106575, -0.60017991065979, 0.28554418683052063, 1.2148700952529907, 0.32077640295028687, -0.24487678706645966, -1.3227137327194214, 0.7304664254188538, -0.9057092666625977, -0.6236510276794434, 0.24665172398090363, 0.5908458828926086, 0.13853015005588531, -0.9709404706954956, -0.17223158478736877, 0.02161754108965397, 1.104903221130371, -0.30876895785331726, -0.44584619998931885, -0.04144805297255516, -0.045583680272102356, -0.1776249259710312, 0.2416982799768448, 0.2243065983057022, -0.6394729018211365, -0.06353122740983963, 15.133527755737305, 0.3801935315132141, -0.24236038327217102, 0.035481106489896774, 0.2601889371871948, 1.123958706855774, -0.3422844111919403, 0.22559817135334015, -1.3151456117630005, -0.0005314342561177909, 1.1624521017074585, 0.3952476978302002, 0.54790198802948, 0.2619647681713104, -1.0633859634399414, 0.49589747190475464, -0.446778267621994, 0.7526312470436096, 0.4657268524169922, -1.342742681503296, 0.2863205671310425, 0.32893434166908264, 0.11289463937282562, 0.7318636178970337, 0.38943883776664734, 0.7032073736190796, 0.990431010723114, -0.5477887392044067, -0.027515891939401627, -0.04815328121185303, 1.0244998931884766, 0.2085542529821396, 0.7617630362510681, 0.2843003273010254, -1.2161147594451904, -0.2329334318637848, -0.5726436376571655, -0.7692614793777466, 0.3002012372016907, 0.19346541166305542, -1.4587125778198242, 0.04374431073665619, -0.06396288424730301, 1.237685203552246, 0.7241767048835754, 0.6063291430473328, 0.05747613310813904, 0.41925352811813354, 0.1313689649105072, 0.1162121444940567, 0.002561169909313321, 0.55803382396698, 0.3599632978439331, 0.32288065552711487, -0.03332238271832466, -0.3577074110507965, 0.5893064737319946, -0.280380517244339, -0.2501681447029114, -0.5788057446479797, -0.4483840763568878, -1.059815764427185, -0.24545106291770935, 0.7770419120788574, 0.22263231873512268, 0.04822663962841034, -0.15804310142993927, 0.1410762071609497, 0.5056248903274536, -0.1337028592824936, -0.3751988708972931, -0.33514299988746643, 0.459572434425354, -0.5696109533309937, 0.08381690084934235, 0.8978885412216187, -0.10052404552698135, -0.3201335072517395, -1.247915506362915, -0.19180366396903992, 0.707986056804657, -0.37760820984840393, -1.5628502368927002, 1.1186459064483643, -0.491504430770874, -0.6537377238273621, 0.5246458649635315, -1.6882543563842773, 0.17424803972244263, 0.4582986533641815, -1.0270174741744995, -0.3773132562637329, -0.3388451337814331, -0.4452899396419525, -0.838366687297821, -0.22075322270393372, 1.7229714393615723, 0.03679398447275162, -0.40169814229011536, -0.45733168721199036, 0.6270740628242493, -0.05053688958287239, 0.09129172563552856, -1.2005140781402588, 0.3460942208766937, -0.19579875469207764, -0.5014365911483765, 0.5952673554420471, 0.0898432582616806, -0.10583453625440598, -0.7374957799911499, -0.0934942290186882, 0.1950397789478302, -0.8454488515853882, -0.23963025212287903, -0.6759654879570007, -0.6440848708152771, 0.3149687945842743, 0.37911391258239746, -0.7654908895492554, 1.186482310295105, 0.24152915179729462, -0.7252028584480286, -0.07492152601480484, -0.7728880643844604, -0.2589851915836334, 0.5050159692764282, -0.9520924091339111, -0.5203444361686707, 0.5498035550117493, 0.3964279294013977, -0.24106386303901672, -0.7758603096008301, 0.08541402220726013, 0.4556529223918915, 0.088599793612957, 1.2265175580978394, -0.7311024069786072, 0.7653133273124695, 0.41118720173835754, -0.7972041368484497, -0.7716513276100159, -0.360986590385437, -0.7979446649551392, 0.1996762454509735, -0.2416164129972458, 0.11609961837530136, -0.22214999794960022, 0.20640845596790314, 0.15303973853588104, -0.078506700694561, -0.17524947226047516, -0.40750056505203247, -0.395009845495224, -0.3387758731842041, 0.04925869405269623, 0.19566595554351807, 0.3025791645050049, -0.23187382519245148, 0.08126175403594971, 0.00733456714078784, 0.3911241590976715, -0.11635288596153259, -0.4863367974758148, 0.5074205994606018, -0.48025864362716675, -0.6488123536109924, 0.0252612866461277, -0.41006162762641907, -1.5058341026306152, -0.3019512891769409, -1.4713765382766724, 0.6547187566757202, -0.7191279530525208, 0.10816973447799683, 0.10033692419528961, -0.7725808620452881, -0.16495317220687866, 0.07152857631444931, -0.5211631655693054, -0.7058229446411133, -0.6774542331695557, -0.1909993439912796, 0.8774001002311707, 0.7681333422660828, -0.9186961054801941, 0.32095345854759216, -0.24525506794452667, -0.06334853172302246, 0.1959345042705536, 0.24138851463794708, -0.6466637849807739, -0.12393064051866531, -0.9363377690315247, 0.06676715612411499, -0.16898898780345917, -0.1300848424434662, -0.21795913577079773, 0.2288873940706253, 0.11826509237289429, -0.2863449156284332, -0.39132216572761536, 0.8470398187637329, -0.9479140639305115, 0.37429285049438477, 0.9922963976860046, -0.7135251760482788, 0.05484187230467796, -0.26801174879074097, -0.05806751176714897, -0.023243514820933342, 0.5666906833648682, 0.164219468832016, -1.170500636100769, -0.18324421346187592, 0.3738783597946167, -1.0067873001098633, -0.33118003606796265, 0.24378494918346405, -0.03567450866103172, -1.0778218507766724, 0.22545252740383148, 0.2645666003227234, 0.40565240383148193, -0.4444538652896881, 0.44159364700317383, 0.4896567463874817, -0.9219031929969788, 0.07675356417894363, 0.1089479923248291, 0.6062414050102234, -0.3767648935317993, 0.2684510350227356, 0.3329800069332123, -0.4616050720214844, 0.815779983997345, -0.2965906262397766, -0.3225523829460144, -0.9857808947563171, 0.32574930787086487, 0.19402483105659485, -0.33922281861305237, 0.1917954534292221, 1.5816121101379395, 0.2962033450603485, -1.5437883138656616, 0.49453091621398926, -0.3975350558757782, -0.5118087530136108, -0.10888752341270447, 0.512884795665741, 0.503035843372345, -0.3412315547466278, -0.4796679615974426, -0.619095504283905, -0.12097315490245819, -0.2969685196876526, -0.007017691619694233, 1.0895389318466187, 0.25053367018699646, -0.5650805830955505, 0.6998922824859619, 0.6389944553375244, -1.0744985342025757, -0.6472341418266296, -0.5383173227310181, -0.4470106363296509, -0.6955505609512329, -0.1484224647283554, -0.5793200731277466, 0.031828925013542175, 0.5674533843994141, 0.5747134685516357, 0.3608953058719635, 0.2246592938899994, -0.38660314679145813, -0.11278732866048813, 0.7052905559539795, -0.16917753219604492, -0.3038996756076813, 0.05621180310845375, 1.1808154582977295, 1.0102293491363525, -0.9444271922111511, 0.16795575618743896, -0.3598634600639343, -0.9449224472045898, 0.9303598403930664, 0.38728848099708557, 0.4655917286872864, 0.8099143505096436, -0.5235069990158081, 0.011141100898385048, -0.06892374157905579, -0.8716410994529724, -0.45547690987586975, 0.4319336414337158, 1.5132176876068115, 0.7393684387207031, 0.5811649560928345, 0.2107250690460205, 0.2792803943157196, 0.4517141878604889, -0.031239967793226242, 0.19752222299575806, 0.6435337066650391, -0.04173632338643074, -0.45247364044189453, 0.07991167902946472, 0.9893096685409546, -0.5843610763549805, -0.5137335658073425, -0.09474106878042221, -0.1156524270772934, 0.21283315122127533, 0.5363507866859436, 0.314515620470047, -0.6340809464454651, -0.17875435948371887, 0.11494223028421402, -0.3560509979724884, -0.5258342027664185, -0.1781088262796402, -0.32703423500061035, -0.0046258363872766495, 0.6466552019119263, -0.6727308630943298, -0.4076329171657562, -0.06114799156785011, -0.02308332920074463, -0.3264293074607849, 0.20109619200229645, 0.5743330121040344, 0.562754213809967, 0.34677717089653015, 0.5354257822036743, 0.017366591840982437, 0.034096721559762955, -0.6042274832725525, -1.0958431959152222, -0.10772859305143356, -0.609184741973877, -0.11417286843061447, -0.41862696409225464, -0.3689623475074768, -0.2235994040966034]}, "authors": [{"authorId": "2143020648", "name": "Zeheng Bai"}, {"authorId": "2118390419", "name": "Yao-zhong Zhang"}, {"authorId": "2307962951", "name": "Yuxuan Pang"}, {"authorId": "1794239", "name": "S. Imoto"}], "references": [{"paperId": "9f79520c8fdea54dfb1416f91854a240a95ef690", "title": "BEND: Benchmarking DNA Language Models on biologically meaningful tasks"}, {"paperId": "b966d4fd8147239350688f5ed5fb40a4fb1525ce", "title": "Identifying Phage Sequences From Metagenomic Data Using Deep Neural Network With Word Embedding and Attention Mechanism"}, {"paperId": "b06e1a2c84fb3bff03b10283bc863f007f5483b6", "title": "The Nucleotide Transformer: Building and Evaluating Robust Foundation Models for Human Genomics"}, {"paperId": "0f4780f3f42dbe9755d54495ae17244cc88a7483", "title": "DNABERT-2: Efficient Foundation Model and Benchmark For Multi-Species Genome"}, {"paperId": "07c72a83bbc51c30316751d2997c1080360102de", "title": "Identification of bacteriophage genome sequences with representation learning"}, {"paperId": "ef9247114c73d0016bb5049d072d225bce369acf", "title": "A catalog of tens of thousands of viruses from human metagenomes reveals hidden associations with chronic diseases"}, {"paperId": "9f7626c7af925b7b69f1ba86ceb916d21bc03dbe", "title": "Pfam: The protein families database in 2021"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "c43d9cade31600400a0f62beb5bbcc1b548e009e", "title": "DNABERT: pre-trained Bidirectional Encoder Representations from Transformers model for DNA-language in genome"}, {"paperId": "01e48a18067d3931c34a4bc5187fbaa735bc8828", "title": "Cenote-Taker 2 Democratizes Virus Discovery and Sequence Annotation"}, {"paperId": "b74d1ae561e65505a2cf0534ad628f96e312f13d", "title": "The Gut Virome Database Reveals Age-Dependent Patterns of Virome Diversity in the Human Gut"}, {"paperId": "81742fc948e0a89a2a2fed54c32590289722b5a1", "title": "VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences"}, {"paperId": "e3681cef0f89bbe6712da675ed92970d518cddf4", "title": "Identifying viruses from metagenomic data using deep learning"}, {"paperId": "188024469a2443f262b3cbb5c5d4a96851949d68", "title": "Conditional BERT Contextual Augmentation"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "06a155f1b5eb8e18f7675936508009e023b0820d", "title": "dna2vec: Consistent vector representations of variable-length k-mers"}, {"paperId": "a3ef0853c9d59d31f3da79583164120d93178a6f", "title": "BLAST: at the core of a powerful and diverse set of sequence analysis tools"}, {"paperId": null, "title": "Aunified catalog of 204,938 reference genomes from the human gut microbiome"}, {"paperId": null, "title": "VirSorter2:amulti-classifier,expert-guidedapproachtodetectdiversednaandrnaviruses"}, {"paperId": null, "title": "Seeker: Alignment-freeidentificationofbacteriophagegenomesbydeeplearning"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Profilehiddenmarkovmodels"}]}