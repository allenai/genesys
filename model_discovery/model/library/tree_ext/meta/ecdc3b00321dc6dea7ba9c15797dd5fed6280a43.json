{"paperId": "ecdc3b00321dc6dea7ba9c15797dd5fed6280a43", "title": "Extended Mind Transformers", "abstract": "Pre-trained language models demonstrate general intelligence and common sense, but long inputs quickly become a bottleneck for memorizing information at inference time. We resurface a simple method, Memorizing Transformers (Wu et al., 2022), that gives the model access to a bank of pre-computed memories. We show that it is possible to fix many of the shortcomings of the original method, such as the need for fine-tuning, by critically assessing how positional encodings should be updated for the keys and values retrieved. This intuitive method uses the model's own key/query system to select and attend to the most relevant memories at each generation step, rather than using external embeddings. We demonstrate the importance of external information being retrieved in a majority of decoder layers, contrary to previous work. We open source a new counterfactual long-range retrieval benchmark, and show that Extended Mind Transformers outperform today's state of the art by 6% on average.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work resurface a simple method, Memorizing Transformers, that gives the model access to a bank of pre-computed memories, and shows that it is possible to fix many of the shortcomings of the original method by critically assessing how positional encodings should be updated for the keys and values retrieved."}, "embedding": {"model": "specter_v2", "vector": [0.041914504021406174, 0.6906082034111023, -0.1980106234550476, 0.0015873787924647331, 0.014945468865334988, -0.19942684471607208, 1.2920477390289307, -0.07426751405000687, -0.6043053865432739, -0.19515615701675415, 0.5350674986839294, -0.003681331407278776, 0.08249925822019577, -0.23130643367767334, -0.15086477994918823, 0.11898984014987946, -0.8965628743171692, 0.5364563465118408, -0.14659178256988525, -0.3415885865688324, 0.2885175943374634, -0.6456689238548279, -1.1384754180908203, -0.088582344353199, 0.03043138049542904, 0.47997143864631653, 0.3135777413845062, 0.8605862855911255, -0.15269511938095093, 0.537264883518219, 0.5968096852302551, -0.35554587841033936, -0.03335459157824516, 0.12953002750873566, -0.49763524532318115, -0.5456841588020325, 0.23090769350528717, -0.4952971935272217, -0.5932722091674805, 0.5324304103851318, -0.12727582454681396, 0.37317535281181335, 0.3731474280357361, -0.4224141538143158, -0.49323832988739014, 0.8515224456787109, 1.1158939599990845, 0.5764074325561523, 0.03361460193991661, -0.277763694524765, 1.4115809202194214, -1.3259471654891968, 0.35692206025123596, 1.2191802263259888, 0.2219856232404709, 0.3891369700431824, -0.06755222380161285, -0.4649145007133484, 1.0418585538864136, -0.01204748172312975, -1.0165561437606812, -0.388648122549057, -0.2669528126716614, 0.22139163315296173, 1.9163011312484741, -0.5441628694534302, 0.7310850024223328, 0.5188783407211304, 0.2194630354642868, 1.4041500091552734, 0.20707038044929504, -0.8172782063484192, -0.574710488319397, 0.4020012319087982, 0.6387494802474976, 1.0225015878677368, -0.2532165050506592, 0.2539854943752289, -1.0870271921157837, 0.14830070734024048, 0.4840782582759857, -0.03864122927188873, -0.2191501259803772, -0.17570161819458008, -0.7166110277175903, 0.26472488045692444, 0.2500405013561249, 0.7808175683021545, -0.3148530423641205, 0.66169673204422, 0.0015719442162662745, 0.5068891048431396, 0.0021127418149262667, 0.4996785819530487, -0.22508849203586578, 0.47415685653686523, -1.0155878067016602, 0.34014981985092163, -0.028437841683626175, 0.8864960074424744, 0.044221434742212296, 0.0016658989479765296, -0.43088698387145996, -0.07275698333978653, 1.653794765472412, 0.4040977656841278, 0.8348085880279541, -0.4430963099002838, -0.0020049475133419037, -0.6991150975227356, 0.05733374506235123, -0.7658388614654541, -0.12201901525259018, -0.5025510787963867, -0.5321622490882874, -1.6626120805740356, -0.6542086005210876, 0.6295667886734009, -0.6845047473907471, 1.0516868829727173, -0.6132751107215881, 0.0669141560792923, -0.006517778150737286, 0.3164176046848297, 0.670344352722168, 0.5860378742218018, 0.2702089548110962, 0.4045884609222412, 0.7306445837020874, -0.6702209711074829, -0.5429114699363708, -1.3533109426498413, 0.5345246195793152, 0.02744550071656704, 0.4655640423297882, 0.03991344943642616, -1.3078550100326538, -1.1626518964767456, -0.9845160245895386, -0.04379459470510483, -1.015592098236084, 0.03468218818306923, 1.14713716506958, 0.30156129598617554, -1.3470995426177979, 0.7780875563621521, -0.2669178247451782, -0.25037848949432373, 0.06259815394878387, 0.4078768789768219, 0.1775030791759491, -0.47433409094810486, -1.572957158088684, 0.6868149042129517, 0.361127108335495, -0.3980763256549835, -0.49621352553367615, -0.37352415919303894, -1.2762653827667236, -0.0897321030497551, -0.02807147428393364, -1.2315387725830078, 1.1459105014801025, 0.17252345383167267, -1.1767511367797852, 0.937168538570404, -0.3775242567062378, 0.2444695383310318, -0.06648950278759003, -0.4889441430568695, -0.4427078068256378, -0.3522084653377533, -0.31503474712371826, 0.6911730170249939, 0.502509355545044, -0.14635290205478668, 0.0926501676440239, 0.03043881431221962, -0.40901273488998413, -0.09048626571893692, -0.36456409096717834, 0.4224216639995575, -0.5796730518341064, -0.10805374383926392, 0.4104263484477997, 0.6883968114852905, 0.17769595980644226, -0.5430997610092163, -0.18146221339702606, -0.8767783641815186, -0.03180591017007828, -0.10478270053863525, 1.2462395429611206, -0.6684800386428833, -0.5167609453201294, 0.03867994248867035, 0.001907376921735704, -0.3668101131916046, -0.758098840713501, 0.5636880993843079, -0.4189460873603821, 0.432647705078125, 0.1817607879638672, -1.1768332719802856, 0.2960158586502075, -0.33694031834602356, -0.9257481694221497, -0.1430688351392746, -0.021671468392014503, 1.308121919631958, -1.0808662176132202, 0.04097699001431465, 0.02617700770497322, 0.22392606735229492, -0.6493135690689087, 1.1733055114746094, -0.37045347690582275, -0.016335517168045044, -0.061659492552280426, -0.37302717566490173, 0.15555325150489807, -0.5407453179359436, 0.35736072063446045, -0.24929353594779968, 0.15153269469738007, 0.784264087677002, -0.3208484947681427, 1.4813566207885742, -0.44494330883026123, 0.6301186084747314, -0.45369887351989746, -0.3975430130958557, 0.11896251887083054, 0.15921984612941742, -0.7203084230422974, -0.58587646484375, 0.14308704435825348, 0.2061663120985031, -0.731603741645813, 0.21000723540782928, 0.9128867387771606, 0.49634307622909546, -0.5283364057540894, 0.3020643889904022, 0.7254872918128967, -0.5586020946502686, 0.07885938137769699, 0.6504387855529785, 0.35560983419418335, 0.48549941182136536, 0.5054207444190979, 0.015329016372561455, 0.1658480316400528, -1.1570545434951782, -0.47009536623954773, 0.6632722616195679, 1.0644196271896362, 0.8947173357009888, 0.07092372328042984, -0.7124660015106201, -0.06244606152176857, -0.22413073480129242, 0.7304629683494568, 1.191872000694275, -0.04668845236301422, -0.38961756229400635, -0.3712922930717468, 0.1412368267774582, -0.5847772359848022, 0.44706016778945923, -0.5132871270179749, -0.6151874661445618, -0.43163028359413147, -0.8305619955062866, 0.5467223525047302, 0.1906840205192566, 1.221746563911438, -0.5565863251686096, -0.44781970977783203, -0.42327794432640076, 0.27214017510414124, -0.5541682243347168, -0.3235929608345032, 0.2155025601387024, -0.5922212600708008, -0.08163902163505554, -0.06436370313167572, -0.1918369084596634, 0.16270951926708221, -0.5597988963127136, 1.3080854415893555, -0.1801164746284485, -0.02980063669383526, 0.5040172338485718, 0.8382036685943604, -0.17196305096149445, -0.30775871872901917, 0.1122182160615921, 0.2731734812259674, -0.16784867644309998, 0.12007216364145279, 0.4272727370262146, -0.3921874463558197, -0.278068870306015, -0.5306377410888672, 0.4553568661212921, 0.20113936066627502, 0.06861797720193863, 0.4779229462146759, -0.31953251361846924, -0.09691210091114044, -1.1154234409332275, 0.7625933885574341, 0.03605038672685623, -0.3195820748806, 0.43461138010025024, -0.9619527459144592, -0.19768807291984558, 0.2779609262943268, -0.466348797082901, -0.2514617145061493, -1.2460601329803467, 0.31348928809165955, -0.08498400449752808, -0.10367133468389511, 0.37408632040023804, 0.08616457879543304, 0.43580830097198486, -0.2618985176086426, 0.93314528465271, 0.012097824364900589, 0.0037250607274472713, 0.6013808250427246, -0.8618320226669312, 0.3782881200313568, 0.31856876611709595, 0.06838718801736832, -0.31324735283851624, -0.26847073435783386, -0.5558070540428162, -0.544191837310791, -0.060316093266010284, -0.08863003551959991, -0.27242401242256165, 0.02786358818411827, -0.8089907765388489, -0.823785126209259, 0.39318546652793884, -0.9381714463233948, -0.5624005198478699, 0.15427328646183014, -0.3760091960430145, -0.16784828901290894, -1.0125218629837036, -1.0688050985336304, -0.4509275257587433, -0.5891717672348022, -0.6674371957778931, 0.24953247606754303, 0.1282305270433426, -0.752852737903595, -1.0200666189193726, 0.1586102843284607, -0.4794519245624542, 1.1691744327545166, -0.7815952301025391, 0.784632682800293, 0.06399261206388474, -0.5112753510475159, -0.34692615270614624, 0.46316108107566833, 0.3235189616680145, -0.4904724359512329, 0.11665426939725876, -0.9768221974372864, 0.20697449147701263, -0.34327179193496704, -0.19099357724189758, 0.5801138877868652, 0.06028401106595993, 0.4676603078842163, -0.1370387226343155, -0.6026053428649902, 0.21817068755626678, 1.2048639059066772, -0.8640773892402649, 0.2530323266983032, 0.5004047155380249, 0.6843897700309753, 0.1275705099105835, -0.19375941157341003, 0.5870816707611084, 0.8082663416862488, 0.21346816420555115, -0.03957424685359001, 0.1639028936624527, -0.1207018792629242, -0.9996547102928162, 0.6073972582817078, 1.5596972703933716, 0.3360583782196045, -0.06060224771499634, -0.8863227963447571, 0.6679178476333618, -0.8899535536766052, -0.5200839042663574, 1.003158450126648, 1.1025421619415283, 0.6513040661811829, -0.29334989190101624, -0.6337764859199524, -0.3123074173927307, 0.08241651207208633, 0.33308738470077515, -0.3156648576259613, -0.5215834379196167, -0.14512059092521667, 0.8140379190444946, -0.08531032502651215, 0.7005355358123779, -0.038357850164175034, 0.7109986543655396, 14.884730339050293, 0.5114907622337341, 0.06619120389223099, 0.5245672464370728, 0.694843053817749, 0.12757886946201324, -0.6327571272850037, 0.08652961254119873, -1.1123806238174438, -0.17640340328216553, 1.2529089450836182, 0.2326493114233017, 0.5982319712638855, -0.2580016553401947, -0.38017603754997253, -0.19831784069538116, -0.7883853316307068, 0.6627975702285767, 0.7410765290260315, -1.0172219276428223, 0.7447180151939392, 0.055417101830244064, 0.019503531977534294, 0.3462430238723755, 1.2718833684921265, 0.7651983499526978, 0.3753757178783417, -0.42630645632743835, 0.8453392386436462, 0.9393243789672852, 0.7318741083145142, 0.02006830833852291, 0.2745678722858429, 0.5674601793289185, -0.6731269955635071, -0.15380357205867767, -0.4049715995788574, -1.2377487421035767, 0.07143202424049377, -0.006342317909002304, -0.2704852521419525, -0.6854357719421387, -0.3031059205532074, 0.7684089541435242, -0.3770442008972168, 0.18893729150295258, -0.38740161061286926, 0.37260958552360535, -0.21878397464752197, 0.007767509203404188, 0.07610807567834854, 0.6629813313484192, -0.03358801454305649, -0.2163945436477661, 0.2922542691230774, -0.059795062988996506, -0.4371465742588043, 0.6960732340812683, -0.3947259783744812, -0.3372839093208313, -0.5995485782623291, -0.33314692974090576, 0.18086205422878265, 0.5874625444412231, 0.44879812002182007, 0.06716480106115341, 0.03760405257344246, 0.36997804045677185, 0.41901373863220215, 0.15174828469753265, 0.13352489471435547, -0.09357122331857681, 0.2975437045097351, -0.3495827317237854, -0.2847261428833008, 0.377727210521698, 0.04407842829823494, -0.6487922072410583, -0.7618082165718079, -0.2654370963573456, 0.38297519087791443, -0.9148309826850891, -0.40171343088150024, 0.7712101936340332, -0.1675294041633606, -0.40292438864707947, -0.14211347699165344, -0.8519786596298218, -0.2564719319343567, 0.2455233782529831, -1.4605309963226318, -0.8390137553215027, 0.23223398625850677, -0.1481502801179886, -0.5446140766143799, -0.12859588861465454, 1.3092172145843506, -0.262180894613266, -0.22512708604335785, 0.007924076169729233, -0.24338068068027496, -0.2093207687139511, -0.13309885561466217, -0.7522019147872925, 0.7106113433837891, -0.040181808173656464, -0.013559204526245594, 1.1777886152267456, 0.09192099422216415, 0.3204581141471863, -1.0601876974105835, 0.271223783493042, 1.0081751346588135, -1.076602578163147, -0.5397734642028809, -0.6673469543457031, -0.41775229573249817, 0.5955417156219482, 0.8675418496131897, -0.4863661527633667, 0.40123340487480164, 0.10869454592466354, -0.6271354556083679, -0.12275087088346481, -0.5856407284736633, 0.16501730680465698, 0.23659463226795197, -0.9103865027427673, -0.5398797988891602, -0.25117021799087524, 0.20657853782176971, -0.7224575281143188, -0.28430110216140747, -0.483073353767395, 0.28025728464126587, -0.12683966755867004, 1.1373547315597534, -0.1908884048461914, 0.31424638628959656, 0.7045944333076477, 0.03079526498913765, -1.1131185293197632, -0.09513325989246368, -0.7319825291633606, -0.029941895976662636, 0.08210950344800949, 0.6747813820838928, -0.7367249131202698, -0.35935178399086, 1.10716712474823, 0.4501555860042572, -0.4877081513404846, -0.23627245426177979, 0.03573349118232727, 0.08816738426685333, -0.6033337116241455, 0.4950229823589325, -0.12472831457853317, 0.2764724791049957, 0.5589781999588013, 0.5382325053215027, 0.53734290599823, -0.14765767753124237, -0.6334189176559448, 0.08247673511505127, -0.07890846580266953, -0.18756023049354553, -0.6629226803779602, -0.5185861587524414, -1.6859186887741089, -0.17759394645690918, -1.1296494007110596, -0.09886784851551056, -1.2355197668075562, -0.19389861822128296, 0.03721040487289429, -0.48871946334838867, -0.010301446542143822, 0.22353464365005493, -0.28143832087516785, -0.3796568810939789, -0.6013402938842773, -0.9256631135940552, 0.6850897669792175, 0.9370054006576538, -0.7055915594100952, 0.34799572825431824, -0.37576380372047424, -0.06520749628543854, 0.1601690798997879, 0.3034118115901947, -0.15485785901546478, -0.9120030999183655, -1.4590669870376587, 1.1398504972457886, -0.3486786484718323, 0.04369756951928139, -0.6536193490028381, 0.8106715679168701, 0.7913205623626709, 0.22926686704158783, -0.0645073726773262, 0.7106428742408752, -0.40477943420410156, -0.19971071183681488, 0.20672133564949036, -0.9462548494338989, 0.42963629961013794, 0.3117070496082306, -0.6935489177703857, -0.06532400101423264, 0.6820905208587646, -0.2945762872695923, -1.3588627576828003, -0.7847159504890442, 0.43931815028190613, -0.8065892457962036, -0.010185898281633854, -0.5155025124549866, -0.2752750515937805, -1.0921908617019653, -0.611703097820282, -0.07611294835805893, 0.4223206043243408, -0.2055889368057251, 0.94304358959198, 0.9711713790893555, -0.9789991974830627, 0.3195847272872925, 0.5398473143577576, 0.07316035032272339, -0.028763240203261375, 0.4051012694835663, 0.352830708026886, -0.0884290337562561, 0.6802854537963867, 0.43341386318206787, 0.671022355556488, -0.5779794454574585, -0.03483620285987854, 0.7397935390472412, -0.4762190580368042, -0.13341490924358368, 1.2015923261642456, -0.15494969487190247, -1.0714386701583862, 0.019762413576245308, -1.2511767148971558, -0.7241314053535461, -0.08482776582241058, 0.6317206621170044, -0.3879357576370239, -0.15209917724132538, 0.16261428594589233, -0.40091457962989807, 0.5265060663223267, -0.047073960304260254, -0.6906415820121765, 0.7287740707397461, -0.38928136229515076, -0.6554112434387207, 0.8641186952590942, 0.7406786680221558, -0.8471402525901794, -0.1420353353023529, -0.8379031419754028, -0.2987905442714691, 0.057444583624601364, 0.5845293402671814, -0.4060117304325104, -0.4602692425251007, 1.0382812023162842, 0.49304115772247314, -0.02329462580382824, 0.20900896191596985, 0.08104322850704193, 0.1839665025472641, 1.0096524953842163, 0.467754602432251, -0.4843577742576599, -0.43753570318222046, 1.3658355474472046, 1.0898334980010986, -0.6163817048072815, 0.32922929525375366, 0.39782610535621643, -0.43774011731147766, 0.8011582493782043, 0.08267151564359665, 0.10527975112199783, 1.0121699571609497, -0.36350393295288086, -0.15004371106624603, -0.0489283986389637, -1.3416645526885986, -0.1419583410024643, 0.6774271726608276, 0.9750813841819763, 0.903282642364502, 0.2522333860397339, 0.3640587627887726, 0.9680778384208679, -0.0978677049279213, 0.20863445103168488, 0.2433154284954071, 0.4522072672843933, -0.21506643295288086, 0.10402949899435043, 0.3107464611530304, 0.46806931495666504, -0.225575789809227, -1.141430139541626, 0.10206223279237747, 0.43817660212516785, 0.046850886195898056, 0.42605069279670715, 0.8151782155036926, 0.05477973446249962, 0.3399445116519928, 0.3085978031158447, 0.8424880504608154, -0.4673478901386261, -0.2351156771183014, -0.5369845032691956, -0.4294191896915436, 0.0483703687787056, -0.19870907068252563, -0.38614732027053833, -0.20378899574279785, -0.2369762659072876, 0.218892902135849, -0.019085513427853584, 0.06647622585296631, 1.0333058834075928, 0.47227704524993896, 0.26186132431030273, -0.408823162317276, -0.5275933146476746, -0.27865901589393616, -0.9518638253211975, 0.11914711445569992, -0.6222591996192932, -0.0468326210975647, -0.41293004155158997, -0.13503924012184143, -0.47077634930610657]}, "authors": [{"authorId": "2304554275", "name": "Phoebe Klett"}, {"authorId": "2304553686", "name": "Thomas Ahle"}], "references": [{"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "0e802c0739771acf70e60d59c2df51cd7e8c50c0", "title": "Memorizing Transformers"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "c1a4278f969acfc6682a924e31b95e1ade9703ee", "title": "Memory-efficient Transformers via Top-k Attention"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "58ed1fbaabe027345f7bb3a6312d41c5aac63e22", "title": "Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks"}, {"paperId": "8905f3dcd215fbc3d56839b6f52a43d77ac59fe8", "title": "Augmenting Transformers with KNN-Based Composite Memory for Dialog"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "f51497f463566581874c941353dd9d80069c5b77", "title": "Compressive Transformers for Long-Range Sequence Modelling"}, {"paperId": "7be8c119dbe065c52125ee7716601751f3116844", "title": "Generalization through Memorization: Nearest Neighbor Language Models"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "1e83c20def5c84efa6d4a0d80aa3159f55cb9c3f", "title": "Attention is not Explanation"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "c1126fbffd6b8547a44c58b192b36b08b18299de", "title": "Neural Turing Machines"}, {"paperId": "1be3feeb17c3520fbac6b5b652aa41feea596b2f", "title": "The Extended Mind"}, {"paperId": null, "title": "Pointer sentinel mixture"}, {"paperId": "3aec7f64e08c73b80cde256a41163515cfb3e3f2", "title": "Neural Memory Networks"}, {"paperId": null, "title": ": Efficient context window extension of large language models"}, {"paperId": null, "title": "Llama-2-7b-32k"}, {"paperId": null, "title": "We implement a simple RAG mechanism"}, {"paperId": null, "title": "Benchmarking large language models"}, {"paperId": null, "title": "Introducing mpt-7b: A new standard for open-source, commercially usable llms"}]}