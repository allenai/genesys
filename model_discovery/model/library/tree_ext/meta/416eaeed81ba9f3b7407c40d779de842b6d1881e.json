{"paperId": "416eaeed81ba9f3b7407c40d779de842b6d1881e", "title": "Cross-Architecture Transfer Learning for Linear-Cost Inference Transformers", "abstract": "Recently, multiple architectures has been proposed to improve the efficiency of the Transformer Language Models through changing the design of the self-attention block to have a linear-cost inference (LCI). A notable approach in this realm is the State-Space Machines (SSMs) architecture, which showed on-par performance on language modeling tasks with the self-attention transformers. However, such an architectural change requires a full pretraining of the weights from scratch, which incurs a huge cost to researchers and practitioners who want to use the new architectures. In the more traditional linear attention works, it has been proposed to approximate full attention with linear attention by swap-and-finetune framework. Motivated by this approach, we propose Cross-Architecture Transfer Learning (XATL), in which the weights of the shared components between LCI and self-attention-based transformers, such as layernorms, MLPs, input/output embeddings, are directly transferred to the new architecture from already pre-trained model parameters. We experimented the efficacy of the method on varying sizes and alternative attention architectures and show that \\methodabbr significantly reduces the training time up to 2.5x times and converges to a better minimum with up to 2.6% stronger model on the LM benchmarks within the same compute budget.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "Cross-Architecture Transfer Learning (XATL) is proposed, in which the weights of the shared components between LCI and self-attention-based transformers, such as layernorms, MLPs, input/output embeddings, are directly transferred to the new architecture from already pre-trained model parameters."}, "embedding": {"model": "specter_v2", "vector": [0.07145388424396515, 0.789446234703064, -0.19807608425617218, -0.16782699525356293, -0.34959253668785095, -0.15906977653503418, 0.6804726719856262, -0.4816942811012268, -0.23729440569877625, -0.060903362929821014, 0.4746962785720825, -0.36469241976737976, 0.7085928320884705, 0.15690158307552338, -0.5465129017829895, 0.22276060283184052, -0.5627811551094055, 0.3507208526134491, -0.13697487115859985, -0.36071449518203735, -0.26773422956466675, -0.7340004444122314, -0.7941492199897766, 0.16694752871990204, 0.32632943987846375, 0.5411418080329895, 0.336670458316803, 0.7464970350265503, -0.785759687423706, 0.04589913412928581, 0.4062322974205017, -0.5749109387397766, 0.15068547427654266, -0.19249196350574493, -0.6129456162452698, -0.09469211101531982, 0.7676851749420166, -0.30081188678741455, -0.1224820613861084, 0.8158995509147644, -0.19109509885311127, 0.014447811059653759, 0.28402167558670044, -0.8671872615814209, -0.24227358400821686, 0.7915691137313843, 0.4454596936702728, 0.7684488892555237, -0.6925443410873413, -0.2429458349943161, 1.3225855827331543, -1.0816519260406494, -0.20454995334148407, 1.515618085861206, 0.2666057348251343, 0.6382803916931152, -0.5021432638168335, -1.0549029111862183, 0.5177509784698486, 0.18389937281608582, -0.5592373013496399, -0.7197837233543396, 0.2797141373157501, 0.0705849826335907, 2.323728322982788, -0.2454780787229538, -0.2661137878894806, 0.40575888752937317, -0.26192519068717957, 1.3403650522232056, 0.02124817483127117, -0.7098550200462341, -0.3812258541584015, 0.35930171608924866, 0.16401952505111694, 1.076663613319397, -0.3005921244621277, 0.1747584342956543, -0.6011573076248169, -0.03425746038556099, 0.2314397394657135, -0.3502616882324219, 0.3265819549560547, -0.2871757447719574, -0.14807157218456268, 0.6243634819984436, 0.5849806070327759, 1.0270687341690063, 0.10354503989219666, 1.0686566829681396, 0.9095357060432434, 0.49407437443733215, 0.2577650845050812, 0.6850482821464539, -0.4214748442173004, 0.5113519430160522, -0.7288076281547546, -0.27292242646217346, -0.16209717094898224, 0.7991262078285217, 0.29765474796295166, 0.7218364477157593, -0.45766305923461914, 0.2416733354330063, 1.2870920896530151, 0.20959210395812988, 0.6405117511749268, -0.6631143093109131, 0.6595256924629211, -0.4773622751235962, -0.4905549883842468, -0.735515296459198, -0.05841384828090668, -0.48941218852996826, -0.9565004110336304, -1.2755327224731445, -0.7910130023956299, 0.03713734447956085, -0.31957557797431946, 0.9227871298789978, -0.3876504898071289, 0.3301348090171814, 0.2551521360874176, 0.1357486993074417, 0.43357324600219727, 0.7421797513961792, 0.38901466131210327, 0.027832195162773132, 0.7673973441123962, -1.030803918838501, -0.5645924806594849, -1.2422666549682617, 0.7210831642150879, -0.2156188040971756, 0.4227606952190399, -0.559112012386322, -1.4633930921554565, -1.0537694692611694, -1.044993281364441, 0.2352030724287033, -0.3777860105037689, 0.47254177927970886, 0.6857072710990906, 0.28887689113616943, -0.9716765880584717, 0.8527582287788391, -0.4586543142795563, -0.2370332032442093, 0.31111836433410645, 0.2659037411212921, 0.09917186200618744, 0.07947980612516403, -1.2700016498565674, 0.7029311060905457, 0.4404527544975281, -0.45285525918006897, -0.06751781702041626, -0.7919192910194397, -1.0804510116577148, 0.04538189247250557, 0.2935934066772461, -0.7839572429656982, 1.2461134195327759, -0.4358110725879669, -1.649417519569397, 0.6846984028816223, -0.2660961449146271, 0.05638952553272247, -0.019145973026752472, -0.03528940677642822, -0.49059730768203735, -0.8235424160957336, -0.16332979500293732, 0.5454503893852234, 0.6848297119140625, -0.25584930181503296, -0.18869030475616455, 0.036192573606967926, -0.20679135620594025, -0.05748855695128441, -0.5629564523696899, 0.6050277352333069, -0.5453862547874451, 0.15621311962604523, 0.1665775626897812, 0.5624057650566101, 0.2843501567840576, -0.4774908423423767, -0.8454948663711548, -1.1566824913024902, 0.8210695385932922, 0.1057932898402214, 0.9871656894683838, -1.0262272357940674, -0.6662570834159851, -0.34039801359176636, -0.34439322352409363, -0.01838717982172966, -0.8717173337936401, 0.44111883640289307, -0.5771356821060181, 0.1623719036579132, -0.19741587340831757, -1.4658491611480713, 0.10112208873033524, -0.25621187686920166, -0.709116518497467, -0.5128470063209534, 0.18827657401561737, 1.1370435953140259, -0.757719099521637, -0.14233504235744476, 0.044754620641469955, 0.36145836114883423, -0.9346643686294556, 1.4525279998779297, -0.201758474111557, 0.12681177258491516, 0.08930966258049011, -0.6770522594451904, -0.130702942609787, -0.31673529744148254, 0.3604791462421417, -0.6898758411407471, -0.007338418625295162, 0.6587602496147156, 0.10851428657770157, 1.6169110536575317, -1.0078538656234741, 0.5360983610153198, -0.14258073270320892, -0.9028871655464172, 0.17898164689540863, 0.2842058837413788, -0.35927215218544006, -0.44797512888908386, 0.37121230363845825, 0.42908355593681335, -0.3501206040382385, 0.3193471431732178, 0.5297074913978577, 0.7559053301811218, -0.3458285927772522, 0.21086643636226654, 0.8662845492362976, -0.28242653608322144, 0.24388572573661804, 0.23069226741790771, 0.7166333198547363, 0.2646734118461609, 0.3422352373600006, -0.2938386797904968, 0.7293882369995117, -0.8554061651229858, -0.2979995310306549, -0.14203958213329315, 0.7184233069419861, 0.5300015211105347, 0.1964682638645172, -0.7820166945457458, -0.3634782135486603, -0.23147474229335785, 0.8176006078720093, 1.4499320983886719, -0.7093474268913269, 0.08248306065797806, -0.927139163017273, -0.3739498257637024, -0.24871225655078888, 0.4642380177974701, -0.328622967004776, -0.6742063164710999, -0.642656147480011, -0.9983987808227539, 0.7931559085845947, 0.22094064950942993, 1.4276989698410034, -0.3934120237827301, -0.19225597381591797, -0.1560838669538498, 0.392111599445343, -0.8275393843650818, -0.757094144821167, 0.34577882289886475, -0.6882821321487427, -0.04428901523351669, 0.2611224949359894, 0.15562787652015686, 0.13868914544582367, -0.7475835084915161, 0.8252032399177551, -0.5666272640228271, -0.2057923674583435, 0.0003157008904963732, 1.1252654790878296, -0.47230803966522217, -0.9269822239875793, 0.818705141544342, 0.22075776755809784, -0.021213989704847336, 0.15988995134830475, 0.39529138803482056, -0.06747546792030334, -0.12084146589040756, -0.046876244246959686, 0.32689717411994934, 0.033721815794706345, -0.080963633954525, 0.1462298184633255, -0.37988120317459106, -0.10810047388076782, -1.351516604423523, 0.8548647165298462, 0.22051499783992767, -0.4956251382827759, 0.39356711506843567, -0.7006411552429199, -0.037579573690891266, 0.47859013080596924, -0.3606952726840973, -0.24968472123146057, -0.9005372524261475, 0.4419863224029541, -0.5326995253562927, -0.08283430337905884, -0.17964982986450195, 0.0006029511569067836, 0.30799010396003723, 0.019272129982709885, 0.38502195477485657, 0.6827688217163086, -0.12779536843299866, 0.815619945526123, -1.132655143737793, 0.5820592045783997, 0.28363484144210815, 0.5238242149353027, -0.1546655297279358, -0.06768692284822464, -0.4586552679538727, -0.7940185070037842, -0.16551081836223602, 0.005731792654842138, 0.05752577632665634, 0.5369536876678467, -0.3012906312942505, -0.9443435072898865, -0.26300784945487976, -1.1890016794204712, -0.30204150080680847, 0.0920233428478241, -0.4014304578304291, -0.20039835572242737, -1.2001307010650635, -1.1354438066482544, -0.5375282764434814, -0.977576732635498, -1.071061372756958, 0.19586345553398132, -0.12236792594194412, -0.2786003649234772, -0.977539598941803, -0.011769931763410568, -0.45759233832359314, 1.588334321975708, -1.049849510192871, 0.9345064163208008, 0.2523496150970459, -0.31065234541893005, 0.1953372061252594, -0.0921262875199318, 0.7920514345169067, -0.02590225636959076, -0.04971783980727196, -0.9833996295928955, 0.09964686632156372, -0.4184805154800415, -0.19911538064479828, -0.04355054721236229, 0.403109073638916, 0.8190373778343201, -0.23422013223171234, -0.5864746570587158, 0.43475690484046936, 1.5043272972106934, -0.7646028995513916, 0.1541866958141327, 0.24452058970928192, 1.0482332706451416, 0.252257764339447, -0.8244270086288452, 0.05296260118484497, 0.6278968453407288, 0.5623083114624023, 0.27646496891975403, -0.5476137399673462, -0.170166477560997, -0.5871307849884033, 0.560434103012085, 2.1707496643066406, 0.4094369411468506, 0.4765499532222748, -0.844447910785675, 0.6157752871513367, -1.1065112352371216, -0.4545239508152008, 0.8988974690437317, 0.5008651614189148, 0.5550268292427063, -0.614566445350647, -0.6124464869499207, -0.18575112521648407, 0.4414234757423401, 0.2986231744289398, -0.46426403522491455, -1.1002117395401, 0.20572519302368164, 0.3024507164955139, 0.26767218112945557, 0.5653123259544373, -0.23632584512233734, 0.8489404320716858, 14.450721740722656, 0.685976505279541, -0.10945925116539001, 0.9257180094718933, 0.8538488745689392, 0.25988224148750305, -0.017212968319654465, -0.037446167320013046, -1.3035227060317993, -0.06642172485589981, 1.4019520282745361, 0.19367681443691254, 0.8001696467399597, 0.10955764353275299, -0.25874269008636475, 0.5529406666755676, -0.6627342104911804, 0.819153904914856, 0.728752613067627, -1.376631736755371, 0.3573175370693207, 0.052876297384500504, 0.47221481800079346, 0.6933361291885376, 0.7897424101829529, 0.9367431402206421, 0.537749171257019, 0.05367683991789818, 0.05020299553871155, 0.3550891876220703, 1.2320972681045532, 0.09194329380989075, 0.215746209025383, 0.2837379574775696, -0.6204244494438171, -0.0927242860198021, -0.5037587285041809, -1.006778597831726, 0.11021661013364792, -0.07057209312915802, -0.40189993381500244, -0.5613940358161926, -0.07104653865098953, 0.514579713344574, 0.17589561641216278, 0.16789741814136505, -0.2968795895576477, 0.8865459561347961, 0.1567746251821518, 0.09183520078659058, 0.09292778372764587, 0.3666384518146515, 0.010499472729861736, 0.038957707583904266, 0.14381632208824158, -0.39115679264068604, -0.23544880747795105, 0.7459011077880859, -0.5939649939537048, -0.11672789603471756, -0.10754500329494476, -0.031325504183769226, -0.2051684409379959, 0.8653000593185425, 0.9803718328475952, 0.07666453719139099, -0.41654735803604126, 0.4160042703151703, 0.9515218138694763, 0.38745182752609253, -0.2571539282798767, 0.1114145964384079, 0.5614349246025085, -0.29562824964523315, -0.04866449162364006, 0.5966854095458984, -0.26066237688064575, -0.5478399991989136, -0.8897279500961304, -0.263286828994751, 0.18572485446929932, -1.0428924560546875, -0.7716830968856812, 1.1794593334197998, -0.1338941901922226, -0.2568323612213135, 0.14430388808250427, -0.603122889995575, -0.4209364950656891, 0.3966807723045349, -1.4663050174713135, -0.5676581859588623, 0.4681396186351776, -0.559205949306488, -0.3886010944843292, -0.5511393547058105, 1.40859854221344, 0.3883894979953766, -0.736079216003418, 0.2666867673397064, 0.03391652554273605, -0.07898303866386414, -0.10410631448030472, -0.8350773453712463, 1.0009427070617676, -0.07094317674636841, -0.2677310109138489, 0.21685004234313965, 0.07439704239368439, 0.5824425220489502, -0.8031986951828003, -0.36271193623542786, 0.8638831377029419, -0.841367781162262, -0.07506273686885834, -0.7098215818405151, -0.876130223274231, 0.272819459438324, 1.062741994857788, -0.4416810870170593, 0.3127479553222656, 0.17015883326530457, -0.8854835033416748, -0.5420324206352234, -0.5681819915771484, 0.13647785782814026, 0.4798940420150757, -0.9382444024085999, -0.29905080795288086, -0.17858639359474182, 0.5926524996757507, -0.688869833946228, -0.18140177428722382, -0.21809570491313934, -0.3020751476287842, 0.13632161915302277, 0.8219836950302124, -0.42547985911369324, 0.7450487613677979, 0.8595167398452759, -0.03480032458901405, -1.1216392517089844, -0.07142574340105057, -0.7130836844444275, 0.11249275505542755, 0.6035590767860413, 0.9525504112243652, -0.6970646977424622, 0.28377363085746765, 0.8762164115905762, -0.01192730013281107, -0.27815109491348267, -0.832534909248352, -0.29497650265693665, -0.016026724129915237, -0.5515047907829285, 0.6839492917060852, 0.19863614439964294, -0.05045090988278389, 0.6438905596733093, 0.63349449634552, 0.31598973274230957, -0.024145202711224556, -0.7383159399032593, 0.4559980034828186, 0.10588175058364868, -0.11551374942064285, -0.6555876731872559, -0.43687939643859863, -1.0855062007904053, 0.5521620512008667, -1.539806604385376, -0.15466825664043427, -1.0179344415664673, -0.1706385612487793, 0.028446247801184654, -0.3802762031555176, 0.20887717604637146, 0.4980846643447876, -0.1751280426979065, -0.3919476270675659, -0.43069422245025635, -0.5418331027030945, 0.9556796550750732, 0.5517221689224243, -0.8455752730369568, 0.2974160313606262, -0.11778669059276581, -0.05648324638605118, 0.12288806587457657, 0.5849645137786865, -0.2981037199497223, -0.83161860704422, -1.7912973165512085, 0.2784835994243622, -0.3153937757015228, -0.12169307470321655, -0.7303990125656128, 0.6160426139831543, 0.6918482184410095, -0.5476008057594299, 0.23616118729114532, 0.2595663070678711, -1.0817865133285522, -0.5187833309173584, 0.5389297604560852, -0.652265727519989, 0.4458383619785309, 0.6957794427871704, -0.8186160326004028, -0.2217118740081787, 0.816329300403595, -0.06135893613100052, -0.8790491223335266, -0.4921305477619171, 0.2504909634590149, -0.22788552939891815, 0.12886682152748108, -0.42809244990348816, -0.006492839194834232, -1.3479971885681152, -0.24185171723365784, 0.1755666732788086, 0.22632531821727753, -0.662763774394989, 0.8832786679267883, 0.03786934167146683, -1.352746844291687, 0.0015512366080656648, 0.5891539454460144, -0.046895310282707214, -0.31740617752075195, 0.5284472107887268, 0.48839956521987915, -0.17519927024841309, 0.6181870102882385, 0.06770258396863937, 0.10887851566076279, -0.5675280690193176, -0.16370633244514465, 1.040541410446167, -0.47854161262512207, 0.19610382616519928, 1.0904048681259155, -0.03729582205414772, -1.4593020677566528, -0.13753759860992432, -1.143039584159851, -0.2574181854724884, -0.6883806586265564, 0.34957462549209595, 0.17455162107944489, -0.053481850773096085, -0.04490431398153305, -0.25448688864707947, 0.19148381054401398, -0.018700124695897102, -0.5331595540046692, 0.476654589176178, -0.12569814920425415, -0.6042600274085999, 0.7222210168838501, 1.2593036890029907, -1.178041696548462, -0.7230193018913269, -0.9918534755706787, -0.38297587633132935, 0.04879384487867355, 0.5738470554351807, -0.2865888178348541, -1.1300139427185059, 1.0799669027328491, 0.6032925248146057, -0.02668769843876362, 0.16355645656585693, -0.00033930837525986135, 0.10332907736301422, 0.4302082359790802, -0.12251441180706024, -0.6515448689460754, -0.4516659677028656, 1.3678181171417236, 1.479516863822937, -0.9483732581138611, 0.03765030577778816, -0.24401506781578064, -0.5839614868164062, 0.4662671387195587, 0.540099561214447, -0.03348597139120102, 0.9032896161079407, -0.18844154477119446, 0.0718986764550209, 0.26055142283439636, -1.524410367012024, -0.3741338849067688, 0.9187861680984497, 0.7966209053993225, 0.9057839512825012, 0.31888890266418457, 0.3332597613334656, 0.4997189939022064, -0.1994096338748932, -0.26624149084091187, 0.25734812021255493, -0.09244175255298615, 0.0360981747508049, -0.02002131938934326, 0.04544401913881302, 0.5433614253997803, -0.3718719184398651, -0.6628480553627014, 0.23850728571414948, 0.6806498765945435, -0.0408654622733593, 0.473806232213974, 1.241417646408081, 0.04011359438300133, 0.9166350364685059, 0.26437023282051086, 0.48412540555000305, -0.4244519770145416, -0.252292275428772, -0.39373061060905457, -0.6675108075141907, -0.1919821798801422, -0.05436426401138306, -0.5094342827796936, -0.42994046211242676, -0.22725221514701843, 0.08403245359659195, -0.1018211618065834, 0.9610629081726074, 0.9446293115615845, 0.6993396878242493, 0.7227736115455627, -0.16542455554008484, -0.36059582233428955, -0.5151289105415344, -1.148759365081787, 0.23416291177272797, -0.4538337290287018, -0.46713387966156006, -0.03641173616051674, -0.08319863677024841, -0.4537765681743622]}, "authors": [{"authorId": "2294802461", "name": "Sehyun Choi"}], "references": [{"paperId": "f4a0c4154203808f362e4678f3741b3d317fdc82", "title": "The Hedgehog & the Porcupine: Expressive Linear Attentions with Softmax Mimicry"}, {"paperId": "d6ee0b9ecd89be38b7a1d94ecdb08ce510469b5d", "title": "Weight subcloning: direct initialization of transformers using larger pretrained ones"}, {"paperId": "240103933ffe3dac2179cc160a2bd91299357a53", "title": "Retentive Network: A Successor to Transformer for Large Language Models"}, {"paperId": "be55e8ec4213868db08f2c3168ae666001bea4b8", "title": "Pythia: A Suite for Analyzing Large Language Models Across Training and Scaling"}, {"paperId": "5a77b508302771fc083bf24e0bcda8553c9b5421", "title": "Hungry Hungry Hippos: Towards Language Modeling with State Space Models"}, {"paperId": "e3fc46d5f4aae2c7a8a86b6bd21ca8db5d40fcbd", "title": "The Devil in Linear Transformer"}, {"paperId": "d5e999aae76d5270ef272076979c809817458212", "title": "An Attention Free Transformer"}, {"paperId": "054e307c1edf4b28137ffcbce980fe81f0647d20", "title": "Finetuning Pretrained Transformers into RNNs"}, {"paperId": "db1afe3b3cd4cd90e41fbba65d3075dd5aebb61e", "title": "The Pile: An 800GB Dataset of Diverse Text for Language Modeling"}, {"paperId": "4a54d58a4b20e4f3af25cea3c188a12082a95e02", "title": "Transformer Feed-Forward Layers Are Key-Value Memories"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "04f4e55e14150b7c48b0287ba77c7443df76ed45", "title": "PIQA: Reasoning about Physical Commonsense in Natural Language"}, {"paperId": "547334370d2b03d51a39a1509fe7e164cd30e550", "title": "Quick and (not so) Dirty: Unsupervised Selection of Justification Sentences for Multi-hop Question Answering"}, {"paperId": "a54b56af24bb4873ed0163b77df63b92bd018ddc", "title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter"}, {"paperId": "8b0f27bb594b1eaaf493eaf1e2ee723a2b0a19ad", "title": "HellaSwag: Can a Machine Really Finish Your Sentence?"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "5ed791f810da580c78df6a052c6b9f2e258f6b0a", "title": "The LAMBADA dataset: Word prediction requiring a broad discourse context"}, {"paperId": "ba6e3b28090d935205ed0e1d398206906b5b8905", "title": "Linguistics"}, {"paperId": "92e121c6e114fe3cfb89370df03847c66a9b4e28", "title": "An Adversarial Winograd Schema Challenge at Scale"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "William Falcon and The PyTorch Lightning team"}, {"paperId": null, "title": "Lightning AI"}, {"paperId": null, "title": "Falcon-40B: an open large language model with state-of-the-art performance"}, {"paperId": null, "title": ": Towards larger convolutional language"}, {"paperId": null, "title": "Anthropic"}, {"paperId": null, "title": "Simple linear attention language models"}]}