{"paperId": "d7f64f2bdd80ea15f21ef7d867e102ac9ecdc797", "title": "GateLoop: Fully Data-Controlled Linear Recurrence for Sequence Modeling", "abstract": "Linear Recurrence has proven to be a powerful tool for modeling long sequences efficiently. In this work, we show that existing models fail to take full advantage of its potential. Motivated by this finding, we develop GateLoop, a foundational sequence model that generalizes linear recurrent models such as S4, S5, LRU and RetNet, by employing data-controlled state transitions. Utilizing this theoretical advance, GateLoop empirically outperforms existing models for auto-regressive language modeling. Our method comes with a low-cost $O(l)$ recurrent mode and an efficient $O(l \\log_{2} l)$ parallel mode making use of highly optimized associative scan implementations. Furthermore, we derive an $O(l^2)$ surrogate attention mode, revealing remarkable implications for Transformer and recently proposed architectures. Specifically, we prove that our approach can be interpreted as providing data-controlled relative-positional information to Attention. While many existing models solely rely on data-controlled cumulative sums for context aggregation, our findings suggest that incorporating data-controlled complex cumulative products may be a crucial step towards more powerful sequence models.", "venue": "arXiv.org", "year": 2023, "citationCount": 12, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "GateLoop is developed, a foundational sequence model that generalizes linear recurrent models such as S4, S5, LRU and RetNet by employing data-controlled state transitions, and empirically outperforms existing models for auto-regressive language modeling."}, "embedding": {"model": "specter_v2", "vector": [0.3924056887626648, 0.13087569177150726, -0.42721155285835266, -0.35473746061325073, -0.03592692315578461, -0.16594605147838593, 0.8983810544013977, -0.04241682589054108, -0.41365861892700195, -0.15310437977313995, 0.5741254687309265, -0.42786547541618347, 0.6893364191055298, 0.19393780827522278, -0.09904787689447403, 0.2699018716812134, -1.1322509050369263, -0.08861237019300461, 0.1896166205406189, -0.5192399024963379, 0.34512433409690857, -0.43951094150543213, -1.1956239938735962, 0.08992590010166168, 0.020015181973576546, 0.6655684113502502, 0.4410134255886078, 0.9019232392311096, -0.4272267520427704, 0.8458579182624817, 0.6367430090904236, -0.08542361110448837, 0.06562095135450363, -0.3284825384616852, -0.15828648209571838, -0.45998018980026245, 0.15489642322063446, -0.27681905031204224, -0.7252172231674194, 0.4995655119419098, -0.275177925825119, 0.18816222250461578, 0.1951741725206375, -0.3139420747756958, -0.0774584412574768, 1.0150463581085205, 0.5430477261543274, 0.9888759255409241, -0.23488309979438782, -0.9036587476730347, 1.6377328634262085, -1.5105756521224976, 0.26698699593544006, 1.2274969816207886, 0.5243932604789734, 0.5198764204978943, -0.19242164492607117, -0.4427785277366638, 1.1213098764419556, 0.029518721625208855, -0.8206440806388855, -0.446713387966156, 0.020025312900543213, 0.04406943544745445, 1.7213575839996338, -0.07354911416769028, 0.10215171426534653, 0.6343438029289246, 0.29929032921791077, 1.0231318473815918, 0.06669393926858902, -1.0228036642074585, -0.060062192380428314, -0.21621841192245483, 0.6601192355155945, 0.9245710968971252, -0.4582909643650055, 0.6064481735229492, -0.9537104368209839, -0.018845221027731895, 0.7615676522254944, 0.2319011241197586, 0.09643573313951492, -0.09463587403297424, 0.0417499765753746, 0.6484696865081787, 0.4813321530818939, 0.7833985090255737, -0.35272011160850525, 0.9367949366569519, 0.2628604769706726, 0.23265039920806885, -0.005050421692430973, -0.15889787673950195, -0.040753550827503204, 0.3042490780353546, -0.5409464240074158, 0.24776054918766022, -0.16438442468643188, 0.8780510425567627, -0.06218775361776352, 0.36015695333480835, -0.43509379029273987, 0.14558468759059906, 1.36264169216156, -0.2947958707809448, 0.4946616291999817, -0.5594274997711182, 0.006729240994900465, -0.47157737612724304, 0.3199988603591919, -0.5604187250137329, -0.1325257271528244, -0.4495929181575775, -0.4227260947227478, -1.3418382406234741, -0.7704973816871643, 0.42109397053718567, -0.6756545305252075, 0.9229949712753296, -0.5742901563644409, 0.30709555745124817, -0.23666122555732727, 0.07241018861532211, 0.26714757084846497, 0.3136219084262848, 0.4569452106952667, -0.32216009497642517, 0.8753541707992554, -0.6106035709381104, -0.6593492031097412, -1.1929194927215576, 0.8934065699577332, 0.1670997589826584, 0.12576104700565338, -0.7556044459342957, -1.129575490951538, -1.1236565113067627, -0.9393492937088013, 0.05449613183736801, -0.31666362285614014, -0.056634336709976196, 0.980368435382843, 0.16238820552825928, -1.3230434656143188, 0.6471092104911804, -0.4798767864704132, -0.09644732624292374, 0.10866250097751617, 0.0749727115035057, 0.5031027793884277, -0.17380616068840027, -1.3391902446746826, 0.4304550886154175, 0.14014552533626556, -0.20025773346424103, -0.18707901239395142, -0.416083961725235, -1.059948444366455, -0.22217321395874023, 0.4216507077217102, -0.24415478110313416, 1.4177284240722656, 0.17609575390815735, -0.8339097499847412, 0.6492369174957275, -0.6467295289039612, -0.28715378046035767, 0.003439541207626462, -0.2227686643600464, -0.6773455739021301, -0.4621739983558655, -0.2761980891227722, 0.25344911217689514, 0.17291264235973358, -0.33925020694732666, -0.14877933263778687, -0.21840356290340424, -0.5585147142410278, -0.26521167159080505, 0.08814620971679688, 1.0248838663101196, -0.41385403275489807, -0.22399075329303741, 0.420975923538208, 0.668056309223175, -0.3340132534503937, -0.24114400148391724, 0.06061777472496033, -0.9168875217437744, 0.5208935141563416, 0.04199064522981644, 1.7832953929901123, -0.6793311238288879, -1.0508562326431274, -0.19949008524417877, -0.12747931480407715, -0.09728410094976425, -0.732435405254364, 0.6709783673286438, -0.8026340007781982, 0.5767754912376404, -0.08336690068244934, -0.9032078981399536, -0.5507203936576843, -0.19839322566986084, -1.025418996810913, -0.4329879581928253, 0.06695029884576797, 1.3834761381149292, -1.103644609451294, -0.08843918144702911, -0.07297371327877045, 0.08886094391345978, -0.7772705554962158, 1.276197075843811, -0.3953168988227844, -0.10389767587184906, -0.30706730484962463, -0.29744794964790344, -0.3921983242034912, -0.5175380110740662, 0.6087815165519714, -0.34036755561828613, -0.6145289540290833, 0.8187787532806396, 0.10448858886957169, 1.2882606983184814, -0.2865380346775055, 0.5852762460708618, -0.40348485112190247, -0.2832367718219757, 0.7864677906036377, 0.1009795144200325, -0.19300499558448792, -0.5734949707984924, 0.43177974224090576, 0.2801065444946289, -0.7634358406066895, 0.38004910945892334, 0.8766779899597168, 1.0164138078689575, -0.5312010049819946, 0.14378155767917633, 0.13955801725387573, 0.00376489432528615, 0.3442824184894562, 0.5106942057609558, 0.9771782755851746, 0.6258383393287659, 0.698148787021637, -0.17617666721343994, 0.3096275329589844, -0.9639396667480469, 0.04589075595140457, 0.6236851215362549, 0.6156748533248901, 0.660186231136322, 0.16397614777088165, -0.787347137928009, -0.3653809428215027, 0.2742207646369934, 0.5953765511512756, 1.3791149854660034, -0.162034809589386, -0.47448861598968506, -0.7403932213783264, -0.007290378212928772, -0.7501416802406311, 0.22123369574546814, -0.44380608201026917, -0.16517983376979828, -0.7858356237411499, -0.6991740465164185, 0.6932718753814697, 0.7804834842681885, 0.8683438897132874, -0.6732266545295715, -0.37628889083862305, 0.15720103681087494, 0.21416525542736053, -0.7121073007583618, -0.7154750227928162, 0.7391237020492554, -0.6958297491073608, -0.07993124425411224, 0.5268730521202087, -0.27764517068862915, -0.14082126319408417, -0.43424922227859497, 1.0729823112487793, -0.2523193359375, -0.41269856691360474, 0.238985076546669, 0.5919602513313293, -0.47892794013023376, -0.6143099665641785, 0.10697438567876816, 0.0056424508802592754, -0.2760361135005951, 0.5254615545272827, 0.515714168548584, -0.2348828762769699, 0.11209356784820557, -0.15717503428459167, 0.04300511255860329, -0.04648995399475098, 0.1464899629354477, 0.6167184710502625, -0.6783161163330078, 0.2098020613193512, -0.9864697456359863, 0.5944540500640869, 0.17498578131198883, -0.3749057352542877, 0.37492528557777405, -0.7371804118156433, -0.251791387796402, 0.015917101874947548, -0.29867106676101685, -0.20141641795635223, -0.9474574327468872, 0.4904482960700989, -0.4349319338798523, 0.010692600160837173, 0.37248659133911133, 0.5074003338813782, 0.530972957611084, 0.2997682988643646, 0.6467698216438293, 0.44756805896759033, 0.08710005134344101, 0.43433400988578796, -0.653542697429657, 0.7191134095191956, 0.30159875750541687, -0.35053688287734985, -0.32341429591178894, 0.1321168839931488, -0.8279927968978882, -0.37503793835639954, -0.36920425295829773, -0.3257170021533966, -0.3385382294654846, 0.2958686947822571, -0.7500308156013489, -0.9846181273460388, -0.11521352082490921, -1.194272518157959, -0.4178723692893982, 0.2948850691318512, -0.40586891770362854, -0.1946655511856079, -0.9925537109375, -1.306095838546753, -1.0315618515014648, -0.4338820278644562, -0.49243998527526855, 0.025884201750159264, 0.032319650053977966, -0.51152503490448, -0.5960808396339417, 0.0825677290558815, -0.7342590689659119, 0.7444047331809998, -0.42965322732925415, 0.8452003002166748, -0.004849809687584639, -0.5533826351165771, -0.06931877136230469, 0.37655630707740784, 0.30015912652015686, -0.043350908905267715, 0.22162403166294098, -0.6977992057800293, 0.2778501510620117, -0.16254974901676178, 0.06759513169527054, 0.1645597517490387, 0.19166797399520874, 0.7944306135177612, 0.23597826063632965, -0.7327874898910522, -0.15097950398921967, 1.3170757293701172, -0.09646093100309372, 0.21623152494430542, -0.14456771314144135, 0.6960751414299011, 0.10023248195648193, -0.033839061856269836, 0.5857738852500916, 0.4000788927078247, 0.4919184744358063, 0.40191203355789185, 0.3016112148761749, 0.011231395415961742, -0.7916654944419861, 0.5586371421813965, 1.5480217933654785, 0.056194186210632324, -0.139212965965271, -0.8360396027565002, 0.6908770203590393, -1.128928780555725, -0.7884239554405212, 0.4038379490375519, 0.7651064991950989, 0.2982560992240906, -0.4396279454231262, -0.2416646033525467, -0.252657413482666, 0.8415757417678833, 0.43845945596694946, -0.4043656587600708, -0.732890784740448, -0.1487104296684265, 0.43341290950775146, 0.1396292895078659, 0.5985041856765747, -0.04970480129122734, 0.6611377000808716, 15.198113441467285, 0.40833672881126404, -0.26089614629745483, 0.2494814395904541, 0.9241152405738831, 0.2574431300163269, -0.4668136239051819, 0.049986787140369415, -1.5743719339370728, -0.12633812427520752, 1.7611396312713623, 0.2007337212562561, 0.4922011196613312, -0.03960442543029785, 0.20682990550994873, 0.3579151928424835, -0.6589105725288391, 0.5996991991996765, 0.4000379145145416, -1.248183250427246, 0.42285630106925964, 0.17261262238025665, 0.010434459894895554, 0.47472912073135376, 0.788733959197998, 0.5916064977645874, 0.7734012007713318, -0.26054883003234863, 0.4116608202457428, 0.39930814504623413, 0.996599018573761, -0.04057803004980087, -0.1040971428155899, 0.2565394639968872, -1.0904303789138794, -0.34155014157295227, -0.39187562465667725, -1.127281904220581, 0.19580501317977905, -0.09302773326635361, -0.3372703790664673, -0.5334864854812622, -0.3587616980075836, 0.7290845513343811, 0.3313688635826111, -0.08121880888938904, -0.2408110499382019, 0.5364181995391846, 0.171225905418396, -0.13960789144039154, 0.33001604676246643, 0.4560210108757019, -0.17858141660690308, -0.20533187687397003, 0.1664975881576538, 0.32338371872901917, -0.14665499329566956, 0.29346442222595215, -0.32289114594459534, -0.23808178305625916, -0.6691645979881287, -0.2975046932697296, 0.24680529534816742, 0.4610598385334015, 0.6211321949958801, 0.48346275091171265, -0.4931529760360718, 0.09158483892679214, 0.5020002722740173, 0.19957749545574188, -0.2709710896015167, 0.21291445195674896, 0.39215320348739624, -0.20402252674102783, 0.12233641743659973, 0.27628326416015625, -0.2528725564479828, -0.38191932439804077, -1.0776962041854858, -0.1076570600271225, 0.2533664405345917, -1.0802021026611328, -0.5162479877471924, 1.2016854286193848, -0.3668965697288513, -0.21617195010185242, -0.24836839735507965, -0.7882105708122253, -0.28567737340927124, 0.44847241044044495, -1.1072001457214355, -0.4022025465965271, 0.029544206336140633, -0.0657409057021141, -0.3285423815250397, 0.1591801941394806, 1.247761845588684, -0.13639311492443085, -0.3886735439300537, -0.10096152871847153, -0.11238984018564224, -0.09234580397605896, -0.5380783081054688, -0.5723462700843811, 1.0378460884094238, 0.31412145495414734, 0.11984731256961823, 0.6677107214927673, 0.0016010295366868377, -0.016730643808841705, -0.6273127198219299, -0.24565273523330688, 1.0203673839569092, -1.072687029838562, -0.07480405271053314, -0.944752037525177, -0.8637939095497131, 0.7828530669212341, 0.26161128282546997, -0.04626999422907829, 0.2168220579624176, 0.03524896502494812, -0.4790758490562439, -0.09600610285997391, -0.3759699761867523, 0.4162115752696991, 0.9478595852851868, -1.06485915184021, -0.35876885056495667, -0.8292151093482971, 0.5213348865509033, -0.779708743095398, -0.36142510175704956, -0.20118427276611328, -0.10788843035697937, -0.16035760939121246, 0.743111789226532, -0.5177634954452515, 0.7316111326217651, 0.6643494367599487, -0.3629304766654968, -0.47409510612487793, -0.3931003212928772, -0.8973699808120728, -0.30727994441986084, 0.2122102826833725, 0.431060791015625, -0.4951247274875641, 0.20626606047153473, 0.7583733797073364, 0.015668051317334175, -0.6397287249565125, -0.5623068809509277, -0.06359941512346268, -0.24462568759918213, -0.5156923532485962, 0.3762587308883667, -0.2601606845855713, -0.21480737626552582, 0.2907543480396271, 0.29482901096343994, 0.4008791446685791, -0.424294650554657, -0.6479348540306091, -0.1492617428302765, -0.2852160334587097, 0.2467440962791443, -0.3085053563117981, -0.5816245675086975, -1.6728516817092896, -0.10349755734205246, -0.9902052283287048, 0.05796416103839874, -0.5808880925178528, -0.5534549951553345, -0.05966370552778244, -0.6739834547042847, 0.05199236795306206, 0.4282757043838501, -0.45186948776245117, -0.7178329825401306, -0.5652292966842651, -0.40786078572273254, 0.7061020135879517, 0.4818187355995178, -0.14749513566493988, 0.09776127338409424, -0.18713834881782532, -0.05386069789528847, -0.1396615356206894, 0.459295392036438, -0.18937809765338898, -0.7470402717590332, -0.9873566627502441, 0.4322948753833771, 0.21929140388965607, 0.04235352948307991, -0.4507289230823517, 0.6682854890823364, 0.37810343503952026, -0.2587657570838928, -0.434780091047287, 0.3162105083465576, -0.7227172255516052, -0.32737430930137634, 0.49322882294654846, -0.986788809299469, 0.5233448147773743, 0.25426962971687317, -0.24382539093494415, -0.3252159059047699, 0.8907558917999268, -0.27191784977912903, -1.0043458938598633, -0.6852635145187378, 0.6171106100082397, -0.7356163859367371, -0.21345344185829163, -0.13355733454227448, -0.10777095705270767, -1.1856611967086792, -0.27651986479759216, -0.20152996480464935, 0.3255890905857086, -0.39684274792671204, 1.244106411933899, 0.47104841470718384, -1.1823477745056152, 0.23802560567855835, 0.39652302861213684, -0.10098708420991898, -0.14067521691322327, 0.37027794122695923, -0.05210255831480026, -0.07515206187963486, 0.7428563237190247, 0.28744667768478394, 0.2248891144990921, -0.976767897605896, 0.23289497196674347, 0.7699528932571411, -0.356317400932312, 0.011444495059549809, 0.7021028399467468, -0.2505345940589905, -0.6099768877029419, -0.18238362669944763, -1.1882922649383545, -0.5471682548522949, -0.2783578634262085, 0.6415269374847412, 0.24462245404720306, -0.2431599348783493, -0.06492778658866882, -0.48826852440834045, 0.19106288254261017, -0.3683583438396454, -0.4124535918235779, 0.6508753299713135, -0.4257009029388428, -0.447833776473999, 1.1411393880844116, 0.6742255687713623, -0.8717833757400513, -0.8199564218521118, -0.8306399583816528, -0.022733401507139206, 0.09838900715112686, 0.47802734375, -0.27834805846214294, -0.4001114070415497, 0.6986912488937378, 0.607848048210144, 0.37599149346351624, 0.008936479687690735, -0.23404847085475922, -0.29853132367134094, 0.44290992617607117, 0.32395026087760925, -0.1880125254392624, -0.3595174252986908, 1.3939225673675537, 1.5027562379837036, -0.2590431869029999, 0.05286714807152748, -0.2338912934064865, -0.42178261280059814, 0.7298504114151001, 0.3554242253303528, -0.0405387245118618, 1.0541349649429321, 0.004734362009912729, 0.328370064496994, 0.031040150672197342, -1.5374888181686401, 0.01745525747537613, 0.16903774440288544, 0.773647129535675, 0.8971158862113953, 0.16886289417743683, 0.007976791821420193, 0.6467094421386719, 0.2810138165950775, 0.4383544623851776, 0.30750536918640137, 0.8054266571998596, -0.3441382348537445, -0.23276473581790924, 0.4193594753742218, 0.5725991129875183, -0.6907802224159241, -0.815022349357605, 0.306072860956192, 0.5521896481513977, -0.273158997297287, 0.5364720225334167, 1.344014286994934, -0.01025919895619154, 0.3510851562023163, 0.5078681111335754, 0.47988995909690857, -0.5021449327468872, -0.3664388656616211, -0.10953622311353683, -0.6356265544891357, -0.06445156782865524, -0.10549934953451157, -0.5778164863586426, -0.3935607671737671, -0.05565081536769867, 0.2317827045917511, -0.01809370331466198, 0.3292709290981293, 0.8129532933235168, 0.6468673348426819, 0.3848575949668884, 0.1897042989730835, -0.04853001981973648, -0.38237524032592773, -0.8939003348350525, 0.17286112904548645, -0.9905094504356384, -0.14607688784599304, -0.138798788189888, -0.03581981360912323, -0.28842201828956604]}, "authors": [{"authorId": "2265382051", "name": "Tobias Katsch"}], "references": [{"paperId": "240103933ffe3dac2179cc160a2bd91299357a53", "title": "Retentive Network: A Successor to Transformer for Large Language Models"}, {"paperId": "f393aff1593c2d370ec0ae004910d18e40524967", "title": "Resurrecting Recurrent Neural Networks for Long Sequences"}, {"paperId": "6d7d141c75af752ffc0d8a6184cca3f9323d6c74", "title": "Simplified State Space Layers for Sequence Modeling"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "bb601a53a022a39876d5c238829c0f00dbc38370", "title": "Sequences"}, {"paperId": "b262ed10230b4292fb55b453ef93254156c56a32", "title": "Jointly Learning to Align and Translate with Transformer Models"}, {"paperId": "2e9d221c206e9503ceb452302d68d10e293f2a10", "title": "Long Short-Term Memory"}, {"paperId": "ccf84c100fa78c599d0e901a3754ff044aa6bd9e", "title": "Encoding Recurrence into Transformers"}, {"paperId": "ec0bc920662693375a881d8beb8c97bf08281dba", "title": "Prefix sums and their applications"}, {"paperId": null, "title": ": Towards language modeling with state"}, {"paperId": null, "title": "length-extrapolatable"}]}