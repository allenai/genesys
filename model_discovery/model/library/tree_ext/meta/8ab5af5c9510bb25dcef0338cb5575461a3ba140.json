{"paperId": "8ab5af5c9510bb25dcef0338cb5575461a3ba140", "title": "nanoT5: A PyTorch Framework for Pre-training and Fine-tuning T5-style Models with Limited Resources", "abstract": "State-of-the-art language models like T5 have revolutionized the NLP landscape, but their computational demands hinder a large portion of the research community. To address this challenge, we present nanoT5, a specially-optimized PyTorch framework for efficient pre-training and fine-tuning of T5 models. Drawing on insights from optimizer differences and prioritizing efficiency, nanoT5 allows a T5-Base model to be pre-trained on a single GPU in just 16 hours, without any loss in performance. With the introduction of this open-source framework, we hope to widen the accessibility to language modelling research and cater to the community's demand for more user-friendly T5 (Encoder-Decoder) implementations. We make our contributions, including configurations, codebase, pre-training insights, and pre-trained models, available to the public.", "venue": "arXiv.org", "year": 2023, "citationCount": 4, "influentialCitationCount": 1, "openAccessPdf": {"url": "https://arxiv.org/pdf/2309.02373", "status": "CLOSED"}, "tldr": {"model": "tldr@v2.0.0", "text": "N nanoT5, a specially-optimized PyTorch framework for efficient pre-training and fine-tuning of T5 models, is presented, hoping to widen the accessibility to language modelling research and cater to the community's demand for more user-friendly T5 (Encoder-Decoder) implementations."}, "embedding": {"model": "specter_v2", "vector": [0.5065610408782959, 0.8087637424468994, -0.720093846321106, 0.008382079191505909, -0.2656974494457245, -0.14037588238716125, 0.6028420925140381, -0.460573673248291, -0.551758885383606, -0.24618829786777496, 0.6174129247665405, -0.26968690752983093, 0.43637198209762573, 0.32719337940216064, 0.010770860128104687, 0.28679779171943665, -0.4158167243003845, 0.5693989992141724, -0.3268541991710663, -0.03459993749856949, -0.46529415249824524, -0.9139114022254944, -0.5758357644081116, 0.2392553985118866, 0.46551623940467834, 0.2131870985031128, 0.47624579071998596, 1.048990249633789, -0.5412538051605225, 0.1400047093629837, 0.39095354080200195, -0.5487343668937683, -0.040971606969833374, 0.05533872917294502, -0.29204103350639343, -0.09264171868562698, -0.009237860329449177, -0.1714065819978714, -0.4171352982521057, 0.8379865288734436, -0.2338627129793167, 0.18714475631713867, 0.7346764802932739, -0.6071203947067261, -0.5562334656715393, 1.1748968362808228, 0.7440398335456848, 0.5138901472091675, -0.40422090888023376, -0.4574996531009674, 1.3349530696868896, -1.4689996242523193, 0.44330093264579773, 1.6334950923919678, 0.8039228320121765, 0.49352240562438965, -0.34714463353157043, -0.4210006296634674, 0.060296375304460526, -0.051296405494213104, -0.9000712037086487, -0.47370439767837524, -0.588061511516571, 0.09167634695768356, 2.2606091499328613, -0.2927510142326355, -0.055583298206329346, 0.7431219816207886, -0.1562093049287796, 1.5122233629226685, -0.15055112540721893, -0.8116089105606079, -0.5958760976791382, 0.15227164328098297, -0.04151783883571625, 0.6367639899253845, -0.7486532330513, 0.17819303274154663, -0.645621120929718, -0.1433374583721161, 0.18954817950725555, -0.1843959093093872, 0.11386457085609436, 0.13659347593784332, -0.55922532081604, 0.7383614778518677, 0.3660510182380676, 1.0029077529907227, 0.05136723443865776, 0.5891823768615723, 0.6485419273376465, 0.16335730254650116, 0.18443502485752106, 0.228102445602417, -0.581660807132721, 0.3081875443458557, -1.3225995302200317, 0.3142048716545105, 0.31531786918640137, 0.9165736436843872, -0.27326422929763794, -0.03237128257751465, -1.1069035530090332, 0.22653813660144806, 1.1765220165252686, 0.33338111639022827, 0.28612473607063293, -0.720151424407959, 0.45527493953704834, -0.7316368818283081, -0.016059385612607002, -0.42611396312713623, -0.18265625834465027, -0.40476471185684204, -0.6812063455581665, -1.7616784572601318, -0.3470109701156616, -0.04997342452406883, -1.0195733308792114, 0.786423921585083, -0.4347599148750305, 0.2362268716096878, 0.3873916566371918, 0.4036552906036377, 0.7585179805755615, 0.7386594414710999, 0.10952497273683548, 0.016684139147400856, 1.2951315641403198, -1.0453627109527588, -0.8552737236022949, -1.1965205669403076, 0.9230308532714844, -0.5639699101448059, 0.220461905002594, -0.43797019124031067, -1.0255005359649658, -0.6122580766677856, -0.4668353796005249, -0.5986300706863403, -0.4903643727302551, 1.0641553401947021, 0.7612990736961365, 0.47715863585472107, -0.9582549333572388, 0.6181023120880127, 0.18138931691646576, -0.2636152505874634, 0.24846503138542175, -0.01628279499709606, 0.3148689568042755, -0.49998387694358826, -1.4800697565078735, 0.7287048697471619, 0.46907129883766174, -0.5194862484931946, -0.29911571741104126, -0.7105156779289246, -0.9125587344169617, -0.03764152526855469, 0.5261261463165283, -0.7275247573852539, 1.478344202041626, 0.13390591740608215, -1.492004632949829, 0.8182131052017212, -1.0686129331588745, -0.20962309837341309, 0.4250980317592621, -0.3025130331516266, -0.504999041557312, -0.6225508451461792, -0.018590467050671577, 0.5079265832901001, 0.5066575407981873, 0.2511973977088928, 0.1061854287981987, 0.43627414107322693, -0.34218859672546387, 0.1956745982170105, 0.029037807136774063, 1.1679565906524658, -0.886157214641571, -0.4017154276371002, 0.12781254947185516, 0.24989451467990875, -0.19972121715545654, -0.2862134277820587, -0.8465052843093872, -0.8556476831436157, 0.9036772847175598, 0.05510907992720604, 0.8321549296379089, -0.7769309282302856, -0.43730247020721436, -0.03625398501753807, -0.06795979291200638, 0.07039245218038559, -0.3132932484149933, 0.6261604428291321, -0.2050093710422516, 0.4898580312728882, -0.5360259413719177, -1.4856128692626953, 0.32108962535858154, 0.012006793171167374, -0.5923106670379639, -0.4665505588054657, 0.20925989747047424, 1.2834672927856445, -0.8013080954551697, -0.021746603772044182, 0.08040760457515717, 0.5484369397163391, -1.155027985572815, 0.8633934855461121, -0.6558668613433838, 0.2640046179294586, 0.005484194494783878, -0.475729376077652, -0.021692106500267982, -0.3349388539791107, 0.5180655121803284, -0.3296535909175873, -0.3681891858577728, 0.6013044714927673, -0.2524995505809784, 1.3321563005447388, -0.5676494836807251, 0.3428291082382202, 0.1082901805639267, -0.2951347529888153, -0.07812076061964035, 0.5713078379631042, -0.472456693649292, 0.031575918197631836, 0.4926621913909912, 0.8208191394805908, -0.5946319103240967, 0.38574233651161194, 0.840328574180603, 0.5723991990089417, -0.23495064675807953, 0.1908300817012787, 0.5961627960205078, -0.440510094165802, 0.3926546275615692, 0.5939940214157104, 0.6703155040740967, 0.2100885957479477, 0.4589293599128723, -0.1665484607219696, 0.42990368604660034, -0.7728906869888306, -0.299552857875824, 0.547663152217865, 0.7761716246604919, 0.7480669021606445, 0.46723681688308716, -0.4507070779800415, -0.3140273094177246, 0.25245925784111023, 0.5040762424468994, 1.6020004749298096, -0.5354663133621216, -0.34921911358833313, -0.8816685676574707, -0.2655259966850281, -0.14115579426288605, 0.2999105155467987, -0.5126493573188782, 0.13761037588119507, -0.4074629843235016, -1.2048550844192505, 1.0952441692352295, -0.2336658388376236, 0.6237018704414368, -0.6861719489097595, 0.07659781724214554, -0.18362180888652802, 0.09203272312879562, -1.2171721458435059, -0.7724852561950684, 0.5995872616767883, -0.5483789443969727, -0.1823812574148178, 0.008624305948615074, 0.04174952581524849, 0.05830865725874901, -0.8800613284111023, 0.811765730381012, -0.5131453275680542, -0.10909440368413925, -0.16654852032661438, 0.5726348757743835, -0.41607633233070374, -0.8752480149269104, 0.435465008020401, 0.044251345098018646, -0.31450262665748596, 0.339408814907074, 0.5654380321502686, 0.3667944073677063, -0.010921076871454716, -0.5065679550170898, 0.1545574814081192, 0.1977836936712265, 0.007909895852208138, 0.6750608086585999, -0.14252281188964844, -0.39174267649650574, -1.4825584888458252, 0.642977774143219, 0.13635843992233276, -0.21319158375263214, 0.12169510871171951, -0.4870942234992981, -0.3431091904640198, 0.678156852722168, -0.49953919649124146, -0.45212826132774353, -0.8088564872741699, 0.052899789065122604, -0.19019347429275513, 0.0017256682040169835, 0.31601837277412415, 0.17581608891487122, 0.5311872959136963, 0.22778281569480896, 0.592252790927887, 0.1933732032775879, -0.3053905665874481, 1.0121562480926514, -1.0301834344863892, 0.46104249358177185, 0.47277432680130005, 0.3769912123680115, -0.24454043805599213, -0.33570578694343567, -0.9010634422302246, -0.5299396514892578, -0.48080214858055115, -0.1671968251466751, 0.03307280316948891, 0.5014671087265015, -0.43685027956962585, -0.5548673272132874, -0.09057065844535828, -1.291894793510437, 0.0632518008351326, 0.6111300587654114, -0.14629320800304413, 0.09032873064279556, -1.1277586221694946, -1.462813377380371, -0.4775477647781372, -0.8540652394294739, -1.121577262878418, 0.8896729946136475, -0.2473524510860443, -0.3328310549259186, -0.8132055997848511, -0.08236102014780045, -0.003433547681197524, 0.8834986686706543, -0.7953106164932251, 0.8647077679634094, 0.05577198043465614, 0.01592073030769825, -0.004333787132054567, -0.008470327593386173, 0.5341205596923828, -0.621523380279541, 0.5025524497032166, -0.9642731547355652, 0.422366201877594, -0.5770798921585083, -0.09816993027925491, 0.4945562183856964, 0.47876936197280884, 0.542391836643219, -0.2556663751602173, -0.7331791520118713, 0.835620641708374, 1.1921266317367554, -1.1111818552017212, -0.011262348853051662, 0.10992491245269775, 1.0567100048065186, -0.1959896683692932, -0.3501598834991455, 0.4965374767780304, 0.3643273413181305, 0.481069415807724, 0.15426938235759735, 0.06233051046729088, 0.1404079794883728, -0.6295178532600403, 0.6829505562782288, 1.581091284751892, 0.5468741059303284, -0.28615429997444153, -1.2774559259414673, 0.5081045627593994, -1.080809473991394, -0.7355538010597229, 0.09814562648534775, 0.36288586258888245, 0.5682878494262695, -0.3624052107334137, -0.4170798659324646, -0.21929842233657837, 0.4411371350288391, 0.4114612936973572, -0.31495991349220276, -0.8425988554954529, -0.12021469324827194, 0.383666068315506, 0.24104653298854828, 0.6195471882820129, -0.4783133566379547, 0.9824162721633911, 14.525121688842773, 1.1256611347198486, 0.045996036380529404, 0.7830981016159058, 0.5822431445121765, 0.1839624047279358, -0.4035411477088928, -0.03632723540067673, -1.4075593948364258, -0.1291930228471756, 1.0434733629226685, 0.09269791841506958, 0.7097259163856506, 0.3945499360561371, 0.2648184597492218, 0.27958881855010986, -0.34479963779449463, 0.7322711944580078, 0.48450180888175964, -1.3565582036972046, 0.4300302267074585, 0.11595859378576279, 0.47622111439704895, 0.8579798936843872, 0.9063189625740051, 1.04168701171875, 0.45676684379577637, -0.8248134851455688, 0.40415599942207336, 0.21464234590530396, 0.8318620920181274, -0.07535596191883087, 0.6644578576087952, 0.8436513543128967, -0.9459958672523499, -0.11229696869850159, -0.6659578084945679, -1.246321678161621, 0.21376432478427887, 0.6071272492408752, -1.2069263458251953, -0.33691081404685974, -0.21196644008159637, 0.9720930457115173, 0.34759044647216797, 0.01395124290138483, 0.0147969676181674, 0.5694254040718079, -0.28673601150512695, 0.09983927011489868, 0.4912900924682617, 0.235438272356987, 0.5423740744590759, 0.3169265389442444, 0.32093939185142517, -0.06761450320482254, 0.02871825359761715, 0.6396909356117249, -0.7447646260261536, -0.11469931900501251, -0.30608534812927246, -0.1813259720802307, -0.1567295491695404, 0.909437358379364, 0.4932067394256592, 0.23849239945411682, -0.3274131417274475, 0.5108324289321899, 0.7548519372940063, 0.05915568023920059, -0.2699126899242401, 0.2936486601829529, 0.334019273519516, -0.6352779865264893, 0.1331072747707367, 0.6173803210258484, -0.08350319415330887, -0.45791202783584595, -0.7748655676841736, -0.4162217378616333, 0.02092762477695942, -0.5847612619400024, -0.6873228549957275, 0.623009204864502, -0.5143144130706787, -0.10085207223892212, 0.2135365754365921, -0.7949604392051697, -0.07683990895748138, 0.6378589272499084, -1.3316338062286377, -0.9145893454551697, 0.9320439696311951, -0.35021719336509705, -0.6018471717834473, 0.07715453207492828, 1.408520221710205, 0.22352054715156555, -0.2419416904449463, -0.08070962876081467, 0.6468713283538818, 0.10100594162940979, -0.3649195730686188, -0.8006253838539124, 1.2030564546585083, 0.17146486043930054, -0.33893582224845886, 0.4471295177936554, 0.22435036301612854, 0.12683135271072388, -0.7960981726646423, -0.5564597845077515, 1.1668450832366943, -1.1049797534942627, -0.18709835410118103, -0.90143221616745, -0.5065606832504272, 0.3480478525161743, 0.3400966227054596, -0.34550487995147705, 0.31916385889053345, 0.22066111862659454, -0.4002683460712433, 0.21872374415397644, -0.6955334544181824, 0.031523168087005615, 0.7031153440475464, -0.8720828890800476, -0.2953052520751953, 0.26678216457366943, 0.41569915413856506, -1.156831979751587, -0.5450519919395447, -0.21497945487499237, 0.24703943729400635, 0.03118940256536007, 1.04310142993927, 0.030779609456658363, 0.5623990893363953, 0.9118272066116333, -0.17424112558364868, -1.0248689651489258, 0.2939838469028473, -0.9276279211044312, -0.04642271623015404, -0.14566205441951752, 1.0526764392852783, -0.29569926857948303, 0.2703186869621277, 0.5534830689430237, 0.2152281254529953, -0.4013364911079407, -0.6651955842971802, -0.47943663597106934, 0.09364502876996994, -0.6356233954429626, 0.2978372275829315, -0.11802137643098831, -0.15974406898021698, 0.20356929302215576, 0.0282896738499403, 0.6418838500976562, -0.11301585286855698, -1.0007048845291138, 0.592235803604126, 0.10092771798372269, -0.2986123263835907, -0.44491133093833923, -0.20480123162269592, -1.380109429359436, 0.16471000015735626, -1.4792344570159912, -0.037146635353565216, -0.9015501141548157, -0.21599224209785461, 0.006978336255997419, 0.0863233432173729, 0.12017016857862473, 0.23829533159732819, -0.15917044878005981, -0.4453549087047577, -0.48878175020217896, -0.2946441173553467, 0.9013050198554993, 1.2282637357711792, -0.6141599416732788, 0.3178720474243164, 0.13486312329769135, 0.42061087489128113, 0.39098718762397766, 0.39626166224479675, -0.5749965906143188, -0.7921704053878784, -1.5940152406692505, 0.42727938294410706, -0.002193773863837123, -0.021638857200741768, -0.5028762817382812, 0.45095133781433105, 0.5991525650024414, -0.32960227131843567, -0.024249203503131866, 0.37927505373954773, -0.8946012258529663, -0.2937951385974884, 0.35711315274238586, -0.5571097731590271, 0.19279220700263977, 0.03278997913002968, -0.6685984134674072, -0.20983165502548218, 0.7055267095565796, -0.06052215397357941, -1.0687960386276245, -0.35970544815063477, 0.49213796854019165, -0.5052098035812378, 0.3130560517311096, -0.5158519148826599, -0.02909364365041256, -0.9945520758628845, -0.3419479727745056, -0.17272919416427612, 0.23161424696445465, -0.215961754322052, 0.8421306014060974, 0.36038023233413696, -0.7820216417312622, -0.12898406386375427, 0.3779696226119995, -0.10645327717065811, -0.22795318067073822, 0.2833188474178314, 0.5312158465385437, -0.32999852299690247, 0.9279906153678894, 0.5478582382202148, 0.13879868388175964, -1.02601957321167, -0.30510658025741577, 0.842648446559906, -0.7295769453048706, -0.42113402485847473, 1.3199694156646729, -0.4309442937374115, -1.7400035858154297, -0.06697732210159302, -1.3559755086898804, -0.46606361865997314, -0.5380119681358337, 0.4596971869468689, 0.16193173825740814, 0.09908885508775711, -0.4897638261318207, -0.6891729831695557, -0.0019117331830784678, 0.06539806723594666, -0.6014077067375183, 0.5419513583183289, -0.10784052312374115, -0.5811363458633423, 0.483244925737381, 1.0058388710021973, -0.6574508547782898, -0.355837881565094, -0.7653086185455322, -0.20936881005764008, 0.16791994869709015, 0.420880526304245, -0.4926971197128296, -0.4477412700653076, 0.680371105670929, -0.09800592809915543, 0.06561516225337982, -0.01694902777671814, -0.44344472885131836, 0.39375126361846924, 0.7543638348579407, -0.06993001699447632, -0.6942480206489563, -0.9791673421859741, 1.8505070209503174, 0.848130464553833, -1.0169123411178589, 0.08842169493436813, -0.3658323585987091, -0.991283655166626, 0.6709908246994019, -0.19937311112880707, 0.13213637471199036, 0.8381145596504211, -0.3046674430370331, -0.05055857077240944, 0.17459024488925934, -1.0228410959243774, -0.21999971568584442, 1.0769375562667847, 0.7357408404350281, 0.8014742732048035, 0.5232693552970886, 0.32497283816337585, 0.6524154543876648, -0.26103445887565613, 0.05856100097298622, 0.2884087860584259, 0.20897512137889862, -0.1656179279088974, -0.21241164207458496, -0.027697674930095673, 0.891342282295227, -0.893261730670929, -1.1771248579025269, -0.023961786180734634, 0.4984850287437439, 0.5536749362945557, 0.6143290400505066, 0.21373501420021057, 0.29902759194374084, 0.2906244993209839, 0.25681427121162415, 0.4386550188064575, -0.7242245674133301, -0.2745334804058075, -0.284908652305603, -0.3838564157485962, -0.028534332290291786, -0.058710016310214996, -0.40762093663215637, -0.3985658586025238, -0.5895194411277771, 0.4269493520259857, 0.05372154340147972, 0.4591025710105896, 1.593312382698059, 0.39172351360321045, 0.32556912302970886, -0.6053187251091003, -0.42449313402175903, -0.1294512301683426, -1.224994421005249, -0.10571442544460297, -0.7686063051223755, -0.21758824586868286, -0.051102448254823685, -0.2151954621076584, -0.5690022110939026]}, "authors": [{"authorId": "40284207", "name": "Piotr Nawrot"}], "references": [{"paperId": "881883842c2661b41bbfc999d56c763b1ceef0bd", "title": "No Train No Gain: Revisiting Efficient Training Algorithms For Transformer-based Language Models"}, {"paperId": "b069c32fcd77160f944ab3ba71ab6f0cfb782c68", "title": "Focused Transformer: Contrastive Training for Context Scaling"}, {"paperId": "6cb35dd6e1338faa0c3d6a6b0020bbcbcc18653d", "title": "Sophia: A Scalable Stochastic Second-order Optimizer for Language Model Pre-training"}, {"paperId": "a7f59b2162ae0ea2520753b1b9b17277490a9458", "title": "Symbolic Discovery of Optimization Algorithms"}, {"paperId": "4b308ba40e67b0b4b25c6fde17195d5a456a2f41", "title": "Cramming: Training a Language Model on a Single GPU in One Day"}, {"paperId": "5e52d654fd31f04c1bd884cd5480e6af8c95ad50", "title": "Efficient Transformers with Dynamic Token Pooling"}, {"paperId": "964bd39b546f0f6625ff3b9ef1083f797807ef2e", "title": "BLOOM: A 176B-Parameter Open-Access Multilingual Language Model"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "b21670e8061a06ab97e7d6052c9345a326e84ff8", "title": "UL2: Unifying Language Learning Paradigms"}, {"paperId": "06d7cb8c8816360feb33c3367073e0ef66d7d0b0", "title": "Super-NaturalInstructions: Generalization via Declarative Instructions on 1600+ NLP Tasks"}, {"paperId": "094ff971d6a8b8ff870946c9b3ce5aa173617bfb", "title": "PaLM: Scaling Language Modeling with Pathways"}, {"paperId": "9ca329408813d209b1dcb36936f7f9cba82506bd", "title": "Train Short, Test Long: Attention with Linear Biases Enables Input Length Extrapolation"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "bdbf780dfd6b3eb0c9e980887feae5f23af15bc4", "title": "GLU Variants Improve Transformer"}, {"paperId": "3c8a456509e6c0805354bd40a35e3f2dbf8069b1", "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "54a13bcc9613dcaa76fb25fbe96572f376cfcca9", "title": "Adafactor: Adaptive Learning Rates with Sublinear Memory Cost"}, {"paperId": "d07284a6811f1b2745d91bdb06b040b57f226882", "title": "Decoupled Weight Decay Regularization"}, {"paperId": "e7fd6848cb29ca221a7e17d823e06fb566f1f135", "title": "Mixed Precision Training"}, {"paperId": "510e26733aaff585d65701b9f1be7ca9d5afc586", "title": "Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer"}, {"paperId": "ed6262b569c0a62c51d941228c54f34e563af022", "title": "Japanese and Korean voice search"}, {"paperId": null, "title": "Accelerate: Training and inference at scale made simple, efficient and adaptable"}, {"paperId": null, "title": "nanogpt"}, {"paperId": null, "title": "Andrej Karpathy"}, {"paperId": null, "title": "Do trans-former modifications transfer across implementations and applications?"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Neptune team"}, {"paperId": null, "title": "Hydra - a framework for elegantly configuring complex applications"}, {"paperId": null, "title": "Pre-training dutch t5 models"}, {"paperId": null, "title": "Gugger"}, {"paperId": null, "title": "2022. Scaling instruction-finetuned language models"}]}