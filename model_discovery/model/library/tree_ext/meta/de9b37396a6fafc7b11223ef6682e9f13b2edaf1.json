{"paperId": "de9b37396a6fafc7b11223ef6682e9f13b2edaf1", "title": "RelayAttention for Efficient Large Language Model Serving with Long System Prompts", "abstract": "A practical large language model (LLM) service may involve a long system prompt, which specifies the instructions, examples, and knowledge documents of the task and is reused across requests. However, the long system prompt causes throughput/latency bottlenecks as the cost of generating the next token grows w.r.t. the sequence length. This paper aims to improve the efficiency of LLM services that involve long system prompts. Our key observation is that handling these system prompts requires heavily redundant memory accesses in existing causal attention computation algorithms. Specifically, for batched requests, the cached hidden states (\\ie, key-value pairs) of system prompts are transferred from off-chip DRAM to on-chip SRAM multiple times, each corresponding to an individual request. To eliminate such a redundancy, we propose RelayAttention, an attention algorithm that allows reading these hidden states from DRAM exactly once for a batch of input tokens. RelayAttention is a free lunch: it maintains the generation quality while requiring no model retraining, as it is based on a mathematical reformulation of causal attention. We have observed significant performance improvements to a production-level system, vLLM, through integration with RelayAttention. The improvements are even more profound with longer system prompts.", "venue": "arXiv.org", "year": 2024, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper proposes RelayAttention, an attention algorithm that allows reading these hidden states from DRAM exactly once for a batch of input tokens, and has observed significant performance improvements to a production-level system, vLLM, through integration with RelayAttention."}, "embedding": {"model": "specter_v2", "vector": [0.09465713798999786, 0.5098528861999512, -0.1540200114250183, -0.00033203724888153374, -0.8152602314949036, -0.3738752603530884, 0.8380897641181946, 0.22346113622188568, -0.21516883373260498, -0.1362282633781433, 0.5183901786804199, -0.2763769030570984, 0.5267431735992432, 0.3300395607948303, -0.3511184751987457, 0.036064960062503815, -0.9132061004638672, 0.13463979959487915, -0.0445668026804924, 0.043894436210393906, 0.4015668034553528, -0.4248062074184418, -1.081343173980713, 0.4898979961872101, 0.28901103138923645, 0.27218884229660034, 0.4483431279659271, 1.0579032897949219, -0.3720024824142456, 0.3316492438316345, 0.2738869786262512, 0.07405740022659302, -0.04133864492177963, 0.09384036809206009, -0.5547604560852051, -0.2731953263282776, 0.12190565466880798, -0.4264324903488159, -0.5956858396530151, 0.40184691548347473, 0.06673595309257507, 0.22943463921546936, 0.16113515198230743, -0.7239952087402344, -0.20497320592403412, 0.8493620753288269, 0.20809510350227356, 0.8955979347229004, 0.09924664348363876, -0.253007709980011, 1.1668339967727661, -1.8743340969085693, 0.01689966395497322, 1.6852920055389404, -0.016212359070777893, 0.28816086053848267, 0.13990721106529236, -0.4234018325805664, 1.0120971202850342, -0.021257326006889343, -0.7475914359092712, -0.6944272518157959, -0.3429005742073059, 0.11855597794055939, 1.8243308067321777, -0.2992095947265625, -0.5380457639694214, 0.6088120937347412, 0.11488452553749084, 1.5988866090774536, -0.08191152662038803, -1.0644617080688477, -0.032119035720825195, -0.14747968316078186, 0.734551191329956, 0.7643054127693176, -0.23645444214344025, 0.36365896463394165, -1.162018895149231, -0.35082951188087463, 0.652751624584198, -0.17053759098052979, 0.010700050741434097, 0.29907315969467163, -0.41946566104888916, 0.6204460263252258, -0.23450180888175964, 0.6477484703063965, -0.07100027054548264, 0.5348921418190002, 0.26919686794281006, 0.1525089591741562, -0.1500949263572693, 0.2811494469642639, 0.12754686176776886, -0.0537966787815094, -0.37387794256210327, 0.2455877959728241, 0.4517654478549957, 1.220341444015503, -0.5779612064361572, 0.31410738825798035, -0.9159723520278931, 0.1174013614654541, 1.2704246044158936, 0.32900354266166687, 0.4170108139514923, -0.6481282114982605, 0.42139795422554016, -1.020598292350769, 0.49134352803230286, -0.38295838236808777, -0.17928804457187653, 0.12190703302621841, -0.4050291180610657, -1.1910516023635864, -0.30925968289375305, -0.17401514947414398, -0.5068885684013367, 0.3575230538845062, -0.2984575927257538, 0.1544177383184433, 0.1984528750181198, 0.2791944444179535, 0.48776742815971375, 0.7871546149253845, 0.26843729615211487, -0.23327748477458954, 0.9257407784461975, -0.6688483953475952, -0.3531177341938019, -1.1746746301651, 0.617929220199585, -0.4464532434940338, 0.14814423024654388, -0.28111833333969116, -1.419301986694336, -0.8708491921424866, -0.5936295390129089, 0.2858944237232208, -0.3981126844882965, 0.08222430944442749, 1.2397490739822388, -0.06129816174507141, -1.072219729423523, 0.2747356593608856, -0.12757465243339539, -0.22532784938812256, -0.050673872232437134, 0.14767974615097046, 0.4873259961605072, -0.6358094811439514, -1.202205777168274, -0.20650707185268402, -0.08193214237689972, -0.6289581656455994, -0.19807802140712738, -0.6350846886634827, -0.8464065790176392, -0.026061350479722023, 0.48335719108581543, -0.19965095818042755, 1.9285544157028198, 0.2837481200695038, -0.8970800042152405, 0.18323886394500732, -0.5564330816268921, 0.5362054705619812, 0.0012015325482934713, -0.30433622002601624, -0.46903112530708313, -0.25744637846946716, -0.14848633110523224, 0.5997965931892395, 0.5119102001190186, -0.4768611192703247, -0.6097147464752197, 0.2749641239643097, -0.05658022686839104, -0.18194925785064697, 0.06332749128341675, 1.0121577978134155, -0.571805477142334, -0.09796307235956192, 0.1049422025680542, 0.759196400642395, -0.29816344380378723, -0.4566872715950012, -0.34469640254974365, -1.1722056865692139, 0.8695325255393982, 0.02748626470565796, 0.9761710166931152, -0.7479796409606934, -1.293262243270874, -0.3045906722545624, -0.35541006922721863, 0.02287364937365055, -0.8800305724143982, 0.9641911387443542, -0.4528467059135437, 0.2375117391347885, 0.23190326988697052, -0.4398643374443054, 0.004505212884396315, -0.5301418304443359, -1.1143393516540527, -0.43649739027023315, 0.04827340319752693, 1.035522222518921, -1.0332547426223755, -0.12353774905204773, -0.2117868959903717, -0.05459889769554138, -0.6541528701782227, 1.7428253889083862, -0.5461592078208923, 0.2564312517642975, -0.48339390754699707, -0.03965623676776886, -0.055985499173402786, -0.38412436842918396, 0.3593880534172058, -0.4939458966255188, -0.28912222385406494, 0.08844225108623505, -0.19363930821418762, 1.1107734441757202, -0.34238913655281067, 0.17276479303836823, -0.1456744521856308, -0.2802223265171051, 0.05216095596551895, 0.5825531482696533, -0.2666650116443634, -0.8541283011436462, -0.057862356305122375, 0.16102616488933563, -0.581015408039093, -0.13183772563934326, 0.9783583879470825, 1.0696088075637817, -0.668480396270752, 0.6775153875350952, 0.002423697616904974, 0.17587126791477203, 0.40947476029396057, 0.7162674069404602, 0.8234933614730835, 0.20989401638507843, 0.37360307574272156, 0.0017486762953922153, 0.3870810866355896, -0.7098813056945801, -0.3958249092102051, 0.7690805792808533, 1.224473237991333, 0.5446711182594299, 0.4699975550174713, -0.6984800696372986, -0.2937469780445099, 0.34553343057632446, 0.7161025404930115, 1.4659208059310913, 0.058072738349437714, -0.018896199762821198, -0.8450161814689636, -0.4710995554924011, -0.2331957072019577, 0.4860699772834778, 0.24509435892105103, -0.2911728024482727, -0.9354221224784851, -0.8155854940414429, 0.7528436779975891, 0.8296283483505249, 0.5891982913017273, -0.9310005903244019, -0.28574153780937195, -0.04645589739084244, 0.30353817343711853, -0.8255226612091064, -0.9977428913116455, 0.3196140229701996, -0.3909715712070465, -0.38320958614349365, 0.23541457951068878, -0.09934128075838089, 0.5256702899932861, -0.24318888783454895, 0.9111646413803101, -0.2838495671749115, -0.7056081891059875, 0.7069092988967896, 0.4492005407810211, -0.547092854976654, -1.0376986265182495, -0.10489273816347122, 0.29836711287498474, -0.2543097138404846, 0.3095743954181671, 0.8850332498550415, 0.045767758041620255, -0.0674079954624176, -0.38949674367904663, 0.27520644664764404, 0.4420747458934784, 0.031139254570007324, 0.4584546983242035, -0.7335067987442017, 0.1821630895137787, -1.01863694190979, 1.1202317476272583, 0.17351564764976501, -0.5811408162117004, 0.30937716364860535, -0.9314783811569214, -0.08222504705190659, 0.583177924156189, -0.5898702144622803, -0.3780812621116638, -0.9694818258285522, 0.0891345888376236, -0.10119239240884781, -0.6572761535644531, -0.032687924802303314, 0.17905551195144653, 0.18423651158809662, -0.4975164234638214, 0.8164510130882263, 0.33726727962493896, -0.4799242317676544, 0.5338063836097717, -0.4330204129219055, 0.5791307687759399, -0.25895726680755615, 0.00611731456592679, -0.5707323551177979, -0.24250003695487976, -0.7320331931114197, -0.11130017787218094, -0.41344937682151794, -0.4629257917404175, -0.003883952973410487, -0.18075492978096008, -0.26757198572158813, -0.9702450633049011, 0.043600186705589294, -1.7786558866500854, -0.45612600445747375, 0.3597661256790161, -0.31780898571014404, -0.1343114823102951, -0.9631214141845703, -1.4039268493652344, -0.5444296002388, -0.5793884992599487, -0.8532842397689819, 0.7286328077316284, -0.010439937002956867, -0.7075477838516235, -0.5354608297348022, -0.08836976438760757, -0.6662017107009888, 0.7851313352584839, -1.1110169887542725, 1.342314600944519, -0.21303892135620117, -0.7485886812210083, -0.3549606502056122, -0.007491805125027895, -0.18803387880325317, -0.008914760313928127, -0.18850263953208923, -0.9653826355934143, 0.0005391011945903301, -0.36134955286979675, -0.08790440857410431, -0.1778113692998886, -0.004628473427146673, 0.7709554433822632, -0.049607325345277786, -1.0042041540145874, -0.25142520666122437, 1.1993805170059204, -0.2235742211341858, -0.14675617218017578, -0.4598641097545624, 1.191667079925537, 0.29593756794929504, 0.3039998412132263, 0.6557443141937256, 0.13583889603614807, 0.4237056076526642, -0.0732160434126854, -0.3687311112880707, 0.05540375038981438, -0.3643181025981903, 0.6363527178764343, 1.783192753791809, 0.6061050891876221, -0.10429450869560242, -0.8567015528678894, 0.319916695356369, -1.2843668460845947, -0.39224520325660706, 0.43944114446640015, 0.8464730381965637, 0.16121111810207367, -0.739771842956543, -0.6663715839385986, -0.4358512759208679, 0.608299970626831, 0.3682204484939575, -0.42911896109580994, -0.6040944457054138, 0.3709438145160675, 0.022167813032865524, -0.01021084189414978, 0.8800352215766907, -0.0952581986784935, 0.6955302953720093, 14.788540840148926, 0.7609300017356873, 0.06814736872911453, 0.5749017000198364, 0.7180779576301575, 0.44285476207733154, -0.35935989022254944, -0.4819745421409607, -1.6315330266952515, -0.31362396478652954, 1.7468211650848389, -0.3876875340938568, 0.20658624172210693, 0.029135365039110184, 0.4770379066467285, -0.15285681188106537, -0.6807650327682495, 0.7958669066429138, 0.5546318292617798, -1.1675785779953003, 0.6076701879501343, 0.2156643271446228, -0.20846238732337952, 0.16079851984977722, 0.5105589032173157, 0.7761073708534241, 0.710890531539917, -0.39745238423347473, 0.44612088799476624, 0.3535427451133728, 0.865657389163971, -0.32992109656333923, 0.36410966515541077, 0.6497477889060974, -1.0256893634796143, -0.06322318315505981, -0.5040972828865051, -0.7771419882774353, 0.22351442277431488, -0.031550437211990356, -0.6885281801223755, -0.6036146283149719, -0.6710577011108398, 0.2314094752073288, 0.07649007439613342, 0.2777131199836731, 0.15620963275432587, 0.6021794676780701, 0.31642797589302063, 0.04460319131612778, -0.013348021544516087, 0.8656229972839355, -0.015334724448621273, 0.001781522878445685, -0.04948193579912186, 0.3131863474845886, 0.5001963973045349, 0.3013869822025299, -0.31457576155662537, -0.12053939700126648, -0.7173612713813782, -0.1799284964799881, 0.1997445970773697, 0.6983411312103271, 0.3410775661468506, 0.3122807443141937, -0.5967810153961182, 0.30702996253967285, 0.48360759019851685, 0.26619699597358704, -0.18502521514892578, 0.256938099861145, 0.19318652153015137, -0.35211673378944397, -0.02216997556388378, 0.40935471653938293, 0.0358753576874733, -0.1392497569322586, -0.7959070801734924, -0.4951467216014862, 0.24379006028175354, -0.770825982093811, -0.8841493129730225, 1.042453408241272, 0.17005786299705505, -0.3047298192977905, -0.24163220822811127, -0.6764379739761353, -0.47356361150741577, 0.5006344318389893, -0.9719054102897644, -0.31571581959724426, 0.3543580174446106, -0.18612278997898102, 0.20805136859416962, 0.4425981342792511, 1.5577455759048462, -0.11323444545269012, -0.4221428632736206, 0.051737260073423386, -0.06995998322963715, -0.048525597900152206, -0.08309762179851532, -0.6569456458091736, 1.101184606552124, 0.4726465940475464, -0.2893686890602112, 0.3932940661907196, -0.22267110645771027, -0.20160560309886932, -1.4805476665496826, -0.2760171890258789, 0.7473175525665283, -1.0815134048461914, -0.4644657373428345, -0.9604131579399109, -0.9127159714698792, 0.02622920088469982, 0.595975399017334, -0.2994696795940399, 0.1115562692284584, 0.001447271672077477, -0.38869166374206543, -0.2554073929786682, -0.34335610270500183, 0.17816899716854095, 0.49310535192489624, -0.8031591773033142, -0.08130615949630737, 0.052487727254629135, 0.9082136750221252, -1.035080909729004, -0.5270978212356567, -0.6898943781852722, -0.22685866057872772, 0.20496639609336853, 0.7130511999130249, -0.32721859216690063, 0.4700058400630951, 0.9687237739562988, -0.13953903317451477, -0.5583045482635498, -0.03891930729150772, -1.0415334701538086, -0.320659875869751, 0.6015403866767883, 0.6954348087310791, -0.17580318450927734, -0.09535061568021774, 1.3228715658187866, 0.260132372379303, -0.44494736194610596, -0.41438359022140503, -0.10354204475879669, 0.15142078697681427, -0.7279497385025024, 0.3489852547645569, -0.2913549840450287, 0.3810102343559265, 0.2236836850643158, 0.5178902745246887, 1.06446373462677, 0.02765640988945961, -0.31395864486694336, 0.38715845346450806, -0.02757742442190647, 0.00652351463213563, -0.004218111280351877, 0.14270451664924622, -1.6081421375274658, 0.263543039560318, -0.9516942501068115, 0.5490447878837585, -0.6921977400779724, -0.3698119819164276, -0.008864447474479675, -0.012197787873446941, 0.22978083789348602, 0.20393475890159607, -0.8050130009651184, -0.586151659488678, -0.36602911353111267, -0.6783259510993958, 0.5763610005378723, 0.5714760422706604, -0.41272011399269104, 0.12135884165763855, -0.15580865740776062, -0.1492338925600052, 0.05809595808386803, 0.09416389465332031, -0.42809978127479553, -0.5890980958938599, -1.0603928565979004, -0.12345035374164581, 0.5204603672027588, 0.03667520731687546, -0.4118160009384155, 1.033564567565918, 0.14834754168987274, -0.3028160631656647, 0.0015643720980733633, 0.0533573217689991, -0.7540267109870911, -0.9034099578857422, 0.3603519797325134, -0.7781764268875122, 0.5335507392883301, 0.5016465783119202, -0.323272168636322, -0.09630512446165085, 0.7282522916793823, -0.5375330448150635, -1.1399266719818115, -0.8774237632751465, 0.3674362897872925, -0.8864792585372925, 0.12437234073877335, -0.3046334981918335, 0.1852618008852005, -1.2465250492095947, -0.39672255516052246, 0.36909711360931396, 0.3428201675415039, -0.4624637961387634, 1.3762024641036987, 0.7273118495941162, -0.9227875471115112, 0.13439960777759552, 0.5248757600784302, -0.13714392483234406, -0.11939507722854614, 0.41191911697387695, 0.4426165819168091, 0.18430517613887787, 0.9639742374420166, 0.47394782304763794, 0.27270638942718506, -1.1723655462265015, 0.3819935619831085, 0.3596000373363495, -0.454144686460495, -0.3304825723171234, 0.6767264604568481, -0.1573377549648285, -0.5202597379684448, 0.25103265047073364, -1.1482560634613037, -0.435119092464447, -0.5107282400131226, 1.0607906579971313, 0.1507573127746582, 0.09371522814035416, 0.0924060121178627, -0.4304698705673218, 0.06467494368553162, -0.5334988832473755, -0.6447564363479614, 0.1564851552248001, -0.35150668025016785, -0.4432084858417511, 0.5606001615524292, 0.425309419631958, -0.5448185205459595, -0.6793425679206848, -0.4057556092739105, -0.007821566425263882, 0.07579486072063446, 0.35302087664604187, -0.2820885181427002, -0.19242753088474274, 0.8353163599967957, 0.5029924511909485, 0.12816523015499115, -0.31066277623176575, 0.08325453847646713, 0.3683781623840332, 0.6054813861846924, 0.7141475677490234, -0.3001578152179718, -0.555802583694458, 1.2430740594863892, 1.4501336812973022, -0.6721922159194946, -0.11480170488357544, -0.26332953572273254, -0.6319239139556885, 1.1108654737472534, 0.9261853694915771, 0.4463096261024475, 0.6878933310508728, 0.4924306869506836, 0.36729511618614197, -0.007058199495077133, -1.5015416145324707, 0.010062546469271183, 0.47510454058647156, 0.9915781617164612, 0.8145765066146851, 0.21479099988937378, 0.21921896934509277, 0.9835752248764038, 0.5646240711212158, 0.3358265459537506, 0.6753236651420593, 0.8824108242988586, -0.38280102610588074, -0.5359073877334595, -0.4279903769493103, 0.7187175154685974, -0.5152102112770081, -1.0966612100601196, 0.1719503402709961, 0.4851953685283661, -0.3684224784374237, 0.7771635055541992, 1.1232284307479858, 0.21526838839054108, 0.646519124507904, 0.3792598247528076, 0.47590839862823486, -0.8325645923614502, -0.20670975744724274, -0.07100178301334381, -0.2706732451915741, -0.40679728984832764, 0.31672242283821106, -0.4340381622314453, -0.8461161255836487, -0.20164673030376434, 0.5956143140792847, 0.1458088457584381, -0.09490732103586197, 1.0987259149551392, 0.8045975565910339, 0.3878052234649658, -0.28026387095451355, -0.5817129611968994, -0.6498207449913025, -0.8832692503929138, -0.011889178305864334, -0.9100980162620544, -0.38131237030029297, 0.20426298677921295, 0.16602930426597595, -0.0071174814365804195]}, "authors": [{"authorId": "2285161294", "name": "Lei Zhu"}, {"authorId": "2262278343", "name": "Xinjiang Wang"}, {"authorId": "2262401622", "name": "Wayne Zhang"}, {"authorId": "2242911102", "name": "Rynson W. H. Lau"}], "references": [{"paperId": "7260442ef9c0448f07ce3803efd49cebaffcebe9", "title": "DeepSeek LLM: Scaling Open-Source Language Models with Longtermism"}, {"paperId": "7bbc7595196a0606a07506c4fb1473e5e87f6082", "title": "Mamba: Linear-Time Sequence Modeling with Selective State Spaces"}, {"paperId": "bc5c73c101da795cfa44e4ac7751cdedca9b6d93", "title": "Prompt Cache: Modular Attention Reuse for Low-Latency Inference"}, {"paperId": "83b90f4a0ae4cc214eb3cc140ccfef9cd99fac05", "title": "Efficient Memory Management for Large Language Model Serving with PagedAttention"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "823ca4778e1027f2f0b356df051d762dcecaaba0", "title": "FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning"}, {"paperId": "a6a0963fcf21ed47a2616ca3980f8f4f21e6d5ad", "title": "Large language models as tax attorneys: a case study in legal capabilities emergence"}, {"paperId": "a1f8082505c7e90b0a033e1b9da0a97d67aad66c", "title": "Accelerating Large Language Model Decoding with Speculative Sampling"}, {"paperId": "d8e9f8c8a37cb4cd26b92ad0d942d641cd512644", "title": "Fast Inference from Transformers via Speculative Decoding"}, {"paperId": "7da0f2501034522e3d50af7e9b8fa7ec9d7b65b6", "title": "GPTQ: Accurate Post-Training Quantization for Generative Pre-trained Transformers"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "2ec4d25b8ffb1821a664fb6e3722c236fe0c07db", "title": "GitHub"}, {"paperId": "53c3940f35b8b45d55ed49056282e1961954513d", "title": "Self-attention Does Not Need $O(n^2)$ Memory"}, {"paperId": "acbdbf49f9bc3f151b93d9ca9a06009f4f6eb269", "title": "Evaluating Large Language Models Trained on Code"}, {"paperId": "814a4f680b9ba6baba23b93499f4b48af1a27678", "title": "Measuring Massive Multitask Language Understanding"}, {"paperId": "5d4de0fa45aeddc31142e6a24666d06ed7923f1e", "title": "Med-BERT: pretrained contextualized embeddings on large-scale structured electronic health records for disease prediction"}, {"paperId": "349c0f1f71ba9275b9355c8c364be5fe073fc84b", "title": "Language models are an effective representation learning technique for electronic health record data"}, {"paperId": "ec1f582446aa24f3f0920123ee6f05feea0b5e0a", "title": "Online normalizer calculation for softmax"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "cea967b59209c6be22829699f05b8b1ac4dc092d", "title": "Sequence to Sequence Learning with Neural Networks"}, {"paperId": "2b7c9fd2a94deaee3e7e56dc57bab0bd39d3683c", "title": "AWQ: Activation-aware Weight Quantization for LLM Compression and Acceleration"}, {"paperId": "f4d546b9cd5681430de63e7d8739dc2d50045fb4", "title": "CacheGen: Fast Context Loading for Language Model Applications"}, {"paperId": "9d7a75601e0e50dd68d40cfb8ef0e891dad797a6", "title": "Orca: A Distributed Serving System for Transformer-Based Generative Models"}, {"paperId": "00fd969c88ca880654520d2184e30bf73a2f3992", "title": "Microsoft"}, {"paperId": "53d8b356551a2361020a948f64454a6d599af69f", "title": "Prefix-Tuning: Optimizing Continuous Prompts for Generation"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": "6a630ac89d7c0a57eb7bf4cb30dd5946bcf3ccce", "title": "google,\u6211,\u8428\u5a1c"}, {"paperId": null, "title": "2023. Mistral 7b"}, {"paperId": null, "title": "A Implementation of Reformulation of relay"}, {"paperId": null, "title": "\u03b2 b \u2192 e t = log ( \u03c3 b \u2192 e t ) = log ( (cid:88) j = b exp ( q t k Tj )) ( is the log-sum-exp"}, {"paperId": null, "title": "2023. Effi-ciently scaling transformer inference"}, {"paperId": null, "title": "2023. Chatlaw: Open-source legal large language model with integrated external knowledge bases"}, {"paperId": null, "title": "context attention , as if there is no system prompt k.size(1) = 1 in"}, {"paperId": null, "title": "\u03b1 syst = \u03c3 1 \u2192 s t \u03c3 1 \u2192 l t = \u03c3 1 \u2192 s t \u03c3 1 \u2192 s t + \u03c3 s +1 \u2192 l t"}, {"paperId": null, "title": "OpenAI"}, {"paperId": null, "title": "built up on existing efficient attention kernels with minimal adaptations. For the system attention involving the system prompt of non-growing static length"}, {"paperId": null, "title": "2023. H _ 2 o: Heavy-hitter oracle for efficient generative inference of large language models"}]}