{"paperId": "fe57045485eca4cc9a87c8733fd93f42e999056f", "title": "Anchor DETR: Query Design for Transformer-Based Object Detection", "abstract": "In this paper, we propose a novel query design for the transformer-based object detection. In previous transformer-based detectors, the object queries are a set of learned embeddings. However, each learned embedding does not have an explicit physical meaning and we cannot explain where it will focus on. It is difficult to optimize as the prediction slot of each object query does not have a specific mode. In other words, each object query will not focus on a specific region. To solved these problems, in our query design, object queries are based on anchor points, which are widely used in CNN-based detectors. So each object query focuses on the objects near the anchor point. Moreover, our query design can predict multiple objects at one position to solve the difficulty:\"one region, multiple objects\". In addition, we design an attention variant, which can reduce the memory cost while achieving similar or better performance than the standard attention in DETR. Thanks to the query design and the attention variant, the proposed detector that we called Anchor DETR, can achieve better performance and run faster than the DETR with 10$\\times$ fewer training epochs. For example, it achieves 44.2 AP with 19 FPS on the MSCOCO dataset when using the ResNet50-DC5 feature for training 50 epochs. Extensive experiments on the MSCOCO benchmark prove the effectiveness of the proposed methods. Code is available at \\url{https://github.com/megvii-research/AnchorDETR}.", "venue": "", "year": 2021, "citationCount": 42, "influentialCitationCount": 4, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "The proposed detector, called Anchor DETR, can achieve better performance and run faster than the DETR with 10$\\times$ fewer training epochs and can predict multiple objects at one position to solve the difficulty:\"one region, multiple objects\"."}, "embedding": {"model": "specter_v2", "vector": [-0.01927371323108673, 0.3989192247390747, -0.5716221332550049, 0.14067697525024414, -0.5267638564109802, 0.006910182535648346, 0.780666708946228, -0.21871112287044525, -0.5396829843521118, -0.8617314696311951, 0.3594382107257843, 0.6984670162200928, 0.5112419724464417, -0.1631275862455368, -0.009922700934112072, 0.03208963945508003, -0.8326143622398376, 0.25819140672683716, 0.8837511539459229, -0.33763042092323303, 0.14627623558044434, -0.42155227065086365, -1.1665899753570557, 0.3264676332473755, -0.04643108323216438, 1.369049310684204, 0.27372118830680847, 0.9723458886146545, -0.24139368534088135, 0.27896904945373535, 0.1326378732919693, -0.424187570810318, 0.3315607011318207, 0.06252527236938477, -0.05804963782429695, -0.12308350205421448, 0.5280230641365051, -0.6604319214820862, -0.6835376024246216, 0.9309372305870056, -0.11831732839345932, 0.22935806214809418, 0.4124315083026886, -1.087837815284729, -0.48914775252342224, 0.012135416269302368, 0.5083688497543335, 0.8553678393363953, -0.5155307650566101, -0.5650219321250916, 1.5495859384536743, -1.9102236032485962, -0.20048591494560242, 1.3170185089111328, 0.40362808108329773, 0.26757967472076416, 0.017471078783273697, -0.6005116701126099, 0.5921159386634827, 0.34389975666999817, -0.8917279243469238, -0.2947947084903717, -0.029184047132730484, -0.44523704051971436, 1.4866644144058228, -0.7152271270751953, 0.13708177208900452, 0.6772125363349915, 0.03342469036579132, 1.4208968877792358, -0.5552806258201599, -0.8172390460968018, -0.22406204044818878, -0.0879286378622055, 0.0852859616279602, 1.111426591873169, -0.17566417157649994, 0.6195774078369141, -1.1365164518356323, -0.28332191705703735, 0.347039133310318, 0.13997705280780792, 0.36336052417755127, -0.33932337164878845, -0.3062155246734619, 0.5598946213722229, 0.7898523807525635, 0.5808248519897461, 0.045323941856622696, 0.8164303302764893, 0.3888716399669647, -0.08292228728532791, -0.38191652297973633, 0.2771986722946167, 0.17432059347629547, 0.7663798928260803, -0.2642742395401001, 0.20624925196170807, -0.3120034337043762, 1.2340843677520752, -0.506298303604126, -0.10488633066415787, -0.48897990584373474, 0.16095735132694244, 1.4281829595565796, 0.05968340486288071, 0.5757353901863098, -0.5818769931793213, 0.3264048397541046, -0.31477445363998413, 0.16695182025432587, -0.8767019510269165, 0.09022390097379684, -0.5464398860931396, -0.36772194504737854, -0.40657109022140503, -0.5599011778831482, 0.863178014755249, -1.0298550128936768, 0.21144236624240875, -0.3840883672237396, -0.07761441171169281, -0.12785525619983673, 0.414401113986969, 0.6261465549468994, 0.17785166203975677, 0.27902501821517944, 0.9368656873703003, 1.4519519805908203, -1.6564934253692627, -0.5285077691078186, -0.7555484771728516, 0.5992217659950256, -0.34803149104118347, 0.20135827362537384, -0.5199275612831116, -0.6482312083244324, -1.3637442588806152, -1.2499059438705444, -0.07693332433700562, -1.2247694730758667, 0.2526734471321106, 0.41779273748397827, 0.14115260541439056, -0.8458310961723328, 0.37543821334838867, -0.18380621075630188, -0.42142367362976074, 0.4769079089164734, 0.3007083535194397, 0.3131917417049408, -0.016719598323106766, -1.1730165481567383, 0.607062041759491, 0.24294070899486542, -0.41360941529273987, -0.5093165040016174, -0.058416757732629776, -0.8759701251983643, 0.06451204419136047, 0.4372500479221344, -0.6484276652336121, 1.1852093935012817, -0.1684657335281372, -0.746391773223877, 0.7699456810951233, -0.15765157341957092, 0.18814979493618011, 0.20817610621452332, -0.3367956876754761, -0.5097907185554504, -0.3992798328399658, 0.38533303141593933, 0.7532110214233398, 0.8373473882675171, -0.13179422914981842, -0.8276382088661194, 0.1679922491312027, -0.038976773619651794, 0.03180884197354317, -0.5520054697990417, 1.0174235105514526, -0.6799443960189819, -0.44537338614463806, 0.4039352238178253, 0.9473632574081421, 0.20836712419986725, 0.5934059619903564, -0.07713872939348221, -1.16041898727417, 1.3430802822113037, 0.6776185631752014, 0.42814186215400696, -0.9864411950111389, -1.034871220588684, -0.5970359444618225, 0.15963447093963623, -0.23261024057865143, -0.7696352005004883, 0.3560523986816406, -0.3485797941684723, 0.20656609535217285, 0.46052423119544983, -1.111147403717041, -0.10275210440158844, -0.3979984521865845, -0.6211654543876648, -0.022398361936211586, 0.400696337223053, 1.1853916645050049, -1.2371728420257568, -0.23872119188308716, -0.23905602097511292, -0.08440697193145752, -0.8408442735671997, 1.3342881202697754, -0.39552196860313416, -0.2506335377693176, -0.4719354510307312, 0.6491466164588928, -0.06540608406066895, -0.09897628426551819, -0.04291246086359024, -0.691159725189209, 0.04459955170750618, 0.49353787302970886, -0.169915109872818, 0.8986340165138245, 0.2665514647960663, 0.6476890444755554, -0.1763448268175125, -0.6364206075668335, 0.5916078090667725, 0.30884841084480286, 0.029660677537322044, -0.5596051812171936, 0.4267924129962921, 0.373151034116745, -0.7800489068031311, 0.1109207272529602, 1.0779693126678467, 0.9801211357116699, -0.42894214391708374, -0.24318735301494598, 0.5476319193840027, 0.18479709327220917, -0.2177603542804718, 0.19824440777301788, 0.6859453320503235, 0.608557939529419, 0.23147571086883545, 0.13794855773448944, 0.02742583304643631, -0.7797144651412964, -0.03345158323645592, 0.986506462097168, 0.1474160999059677, 1.0843125581741333, 0.37549152970314026, -0.7897819876670837, -0.2594929039478302, -0.10972937196493149, 0.6480873823165894, 1.3561904430389404, 0.4232358932495117, -0.2557896077632904, -0.20124685764312744, -0.9539570212364197, -0.3076520264148712, -0.9419820308685303, -0.5859127044677734, -0.43238797783851624, -0.447003036737442, -0.9744005799293518, 1.237857699394226, 0.5036010146141052, 1.0109730958938599, -0.5411153435707092, -0.45030054450035095, -0.143410786986351, -0.031426575034856796, -1.0571123361587524, -0.4989791810512543, 0.5826776623725891, -0.4202713668346405, -0.3039175271987915, 0.43008968234062195, -0.3674336373806, 0.2978418171405792, -0.607525646686554, 0.9495961666107178, -0.258020281791687, -0.3289563059806824, 0.15255264937877655, -0.045325879007577896, -0.8889226317405701, -0.0215440820902586, 0.634186327457428, -0.0671456903219223, -0.10867078602313995, 0.8888219594955444, 0.5818801522254944, -0.06024334952235222, 0.3829820156097412, -0.40381020307540894, -0.34052953124046326, 0.1364249885082245, 0.15167920291423798, 0.7884511947631836, -0.6845025420188904, 0.2674206495285034, -0.3968307673931122, 0.3941538631916046, -0.03254005312919617, -0.6112537384033203, -0.3098352551460266, -0.5497933030128479, -0.47511178255081177, 0.3132067620754242, -0.5434159636497498, 0.27626726031303406, -0.408231645822525, 0.20028847455978394, -0.7724682092666626, -0.14247913658618927, -0.3033425211906433, 0.1874210238456726, 0.09032975882291794, 0.6754467487335205, 0.41231387853622437, 0.31944817304611206, -0.23886236548423767, 0.0027493902016431093, -0.6526836156845093, 0.6910008788108826, 0.025378713384270668, 0.30096006393432617, 0.2118152230978012, 0.1380547285079956, -0.43569761514663696, -0.9044076204299927, -0.8141805529594421, -0.7498556971549988, -0.4251992106437683, 0.17966683208942413, -0.6951924562454224, -0.44796621799468994, -0.25557446479797363, -1.0449079275131226, 0.20605984330177307, -0.09402184933423996, -0.16183175146579742, -0.4295671582221985, -1.2398600578308105, -0.6525554656982422, -0.4599025547504425, -0.502888023853302, -1.0761891603469849, 0.6200319528579712, 0.04779760539531708, 0.31448665261268616, -0.15518465638160706, -0.3283194303512573, -0.4650149643421173, 0.7399421334266663, 0.10643048584461212, 0.37029603123664856, -0.4608710706233978, -0.9736693501472473, -0.42620038986206055, -0.15638206899166107, 0.3605298399925232, 0.1517479568719864, -0.06561054289340973, -1.0858656167984009, 0.4728320240974426, 0.04396412521600723, 0.024131154641509056, 0.3594619333744049, -0.37312376499176025, 0.726945698261261, 0.35115551948547363, -0.9904074668884277, 0.3492565155029297, 1.635170578956604, -0.46725690364837646, 0.030620897188782692, 0.5764896869659424, 0.755515456199646, 0.28208309412002563, 0.24061240255832672, 0.3983595073223114, 0.20881123840808868, 0.6584524512290955, 1.104132056236267, -0.21324008703231812, -0.33685630559921265, -0.40771859884262085, 0.5296900272369385, 1.0532011985778809, 0.6783478260040283, 0.20631565153598785, -1.1348735094070435, 1.4724799394607544, -1.20866060256958, -0.4069020450115204, 0.4289994239807129, 0.3980102241039276, -0.08147282898426056, -0.22517120838165283, 0.1021348312497139, -0.6440321803092957, 0.5847879648208618, 0.3732373118400574, 0.035720501095056534, 0.04291614145040512, 0.20507560670375824, 0.23300276696681976, 0.12346266210079193, 0.29682281613349915, -0.6100170612335205, 0.22349636256694794, 14.57007122039795, 0.43746843934059143, 0.05961904674768448, 0.5415357351303101, 0.44416213035583496, 0.22689907252788544, 0.35639965534210205, 0.021895576268434525, -1.7946619987487793, 0.21867673099040985, 1.1742936372756958, 0.4110819399356842, -0.31164366006851196, 0.5702587366104126, -0.4227420389652252, 0.4175671637058258, -0.9630388021469116, 0.8472150564193726, 0.8467506766319275, -1.133190631866455, 0.10478390753269196, 0.23910559713840485, -0.16113689541816711, 0.7026395797729492, 0.7981723546981812, 0.899314284324646, 0.13400231301784515, -0.31728509068489075, 0.6875351071357727, 0.22486042976379395, 0.6395290493965149, 0.16391582787036896, 0.5932131409645081, 0.1748126894235611, -1.478967308998108, -0.42726510763168335, -1.0542408227920532, -0.7678219079971313, -0.13565829396247864, -0.09451734274625778, -0.5598839521408081, -0.3474368155002594, 0.051681388169527054, 0.7155611515045166, -0.10540059953927994, 0.872406542301178, -0.06614889204502106, 0.10051187127828598, -0.11210942268371582, -0.0863492339849472, 0.5528643131256104, 0.9503384828567505, 0.47111976146698, -0.03574085980653763, 0.009901324287056923, 0.019361063838005066, 0.41719406843185425, 0.35911720991134644, -0.8182337880134583, -0.3313206732273102, -0.4659864604473114, 0.2203800082206726, -0.2186073511838913, 0.8720189332962036, 0.2208603322505951, 0.2949921190738678, -0.47612643241882324, 0.1471259891986847, 0.6248027086257935, -0.09789881855249405, -0.8870336413383484, -0.6239709258079529, 0.5951094031333923, 0.18585121631622314, 0.655114471912384, 0.556718111038208, -0.09910335391759872, -0.5698636174201965, -0.5361031293869019, 0.2181788831949234, 0.4727481007575989, -0.687475323677063, -0.9447405934333801, 1.1124053001403809, -0.05459856614470482, -0.905705988407135, 0.25520843267440796, -1.2605026960372925, -0.39338219165802, 0.35091766715049744, -1.6617809534072876, -0.8405593633651733, -0.37256529927253723, -0.3695327937602997, -0.25122585892677307, -0.048141974955797195, 1.1712945699691772, 0.4339763820171356, 0.0803346037864685, 0.12303157150745392, -0.25443488359451294, 0.6104660034179688, -0.08019612729549408, -0.697726845741272, 0.8311800360679626, 0.19507035613059998, -0.20291367173194885, -0.10845103114843369, -0.30667760968208313, 0.3878660202026367, -0.20027942955493927, -0.6859273314476013, 0.21137522161006927, -1.3067355155944824, -0.4822680354118347, -0.9817864298820496, -0.6467908620834351, 0.3103228807449341, 0.4778188169002533, 0.3132684826850891, 0.18740014731884003, 0.06818921864032745, -0.7312136888504028, -0.4421684145927429, -0.634122371673584, 0.1264418363571167, 0.46161314845085144, -0.702262818813324, -0.7442435026168823, -0.08506283909082413, 0.47041571140289307, -0.9411049485206604, -0.5775402188301086, -0.10582645982503891, 0.330175518989563, -0.13943348824977875, 1.3256304264068604, -0.39157840609550476, 0.6016245484352112, 0.4045776426792145, -0.4803449511528015, -0.6211117506027222, -0.08041823655366898, -0.3447592556476593, -0.42574283480644226, 0.15555427968502045, 0.4762728810310364, -0.2300621122121811, 0.6485286355018616, 0.421916663646698, 0.3176739513874054, -0.8276177644729614, -0.2611684799194336, -0.477047860622406, -0.08831184357404709, -0.26901674270629883, 0.4867231547832489, -0.14198392629623413, -0.28206461668014526, 0.19775159657001495, 0.8151930570602417, 0.7347700595855713, 0.015338990837335587, -0.6156141757965088, 0.40906205773353577, -0.22493349015712738, -0.22045937180519104, -0.19810087978839874, -1.1130257844924927, -1.82479727268219, -0.34325888752937317, -1.0443980693817139, 0.10562837868928909, -0.5983439683914185, -0.7122176289558411, 0.0785001665353775, -0.8439739346504211, 0.11812267452478409, 0.3246932625770569, -0.018830008804798126, 0.0019228177843615413, -0.24599005281925201, -0.5775578618049622, 0.9213292002677917, 0.6721218824386597, -0.6207280158996582, 0.35098233819007874, 0.006795095279812813, -0.13680119812488556, 0.445472776889801, 0.2152486890554428, -1.0811116695404053, -0.2932606041431427, -1.043438196182251, 0.3247644305229187, -0.48855113983154297, 0.21816307306289673, -1.0321072340011597, 1.1034119129180908, 0.7436392903327942, 0.3699343204498291, -0.6280210614204407, 0.8144301772117615, -1.163331389427185, -0.996479332447052, 0.43492427468299866, -0.27717289328575134, 0.19747650623321533, -0.18110543489456177, -0.42340996861457825, -0.6442331075668335, 0.3620160222053528, 0.45077958703041077, -1.0958253145217896, -0.8613474369049072, 0.5498221516609192, -0.4419636130332947, -0.055488210171461105, -0.0439828485250473, -0.42443016171455383, -1.2175514698028564, -0.1787610650062561, -0.09968260675668716, 0.41721653938293457, -0.6274899840354919, 1.2024157047271729, 0.8649027943611145, -1.782763123512268, 0.34484466910362244, 0.2707579433917999, 0.40242940187454224, 0.08531408756971359, -0.3222910165786743, 0.5178648829460144, 0.007903863675892353, 0.3169440031051636, -0.17528291046619415, -0.07153652608394623, -0.7513863444328308, 0.267833411693573, 1.185232400894165, -0.32586923241615295, -0.04896310716867447, 0.9008887410163879, -0.15502412617206573, -0.9548674821853638, 0.26288965344429016, -1.075451374053955, -0.5113733410835266, 0.28160354495048523, 0.7116928100585938, 0.09651505947113037, 0.13018955290317535, -0.16561894118785858, -0.7056571245193481, 0.0768355131149292, -0.3018103241920471, -0.449297159910202, 0.48418140411376953, 0.06683571636676788, -0.1577988713979721, 0.3759371340274811, 1.0609843730926514, -0.8062790036201477, -0.7772783041000366, -0.7479878664016724, -0.15020352602005005, -0.5309950709342957, -0.19757217168807983, 0.14144127070903778, -0.3795485198497772, 0.4745789170265198, 1.035225510597229, 0.5649787187576294, 0.2928808927536011, 0.31268492341041565, 0.11274813860654831, 0.8877684473991394, -0.18280009925365448, -0.6114476919174194, 0.30239400267601013, 1.3348627090454102, 1.3459818363189697, -0.829023003578186, 0.10235528647899628, -0.279252827167511, -0.03993732109665871, 1.021675944328308, 1.1665949821472168, -0.3714788556098938, 1.050559639930725, -0.2731234133243561, -0.13070912659168243, 0.0010498061310499907, -0.971290111541748, -0.5865659713745117, 0.6490305662155151, 1.5682623386383057, 0.22965355217456818, -0.28183886408805847, 0.7378944754600525, 0.4646093249320984, 0.38420313596725464, -0.40241456031799316, 0.5092914700508118, 0.559788167476654, -0.44609400629997253, -0.1331612467765808, -0.3650442063808441, 0.898806631565094, -1.0350171327590942, -0.29872164130210876, -0.06075245887041092, 1.0444344282150269, 0.45385947823524475, 0.37447020411491394, 0.9094061255455017, -0.1348046213388443, 0.9145635366439819, 0.2786290645599365, -0.042579539120197296, -0.8845203518867493, -0.46888303756713867, -0.46754908561706543, -0.8633410930633545, -0.17544156312942505, -0.43333813548088074, -0.7156012058258057, -0.1008056029677391, 0.34489819407463074, 0.12423383444547653, -0.3494918942451477, 0.047436151653528214, 0.7845844626426697, 0.4990360140800476, 0.8017341494560242, -0.41556844115257263, -0.35586777329444885, -0.4481199383735657, -1.077515721321106, 0.2266663908958435, -0.5895318388938904, 0.3341449499130249, -0.6045937538146973, -0.0006187901017256081, -0.08101096004247665]}, "authors": [{"authorId": "2107945710", "name": "Yingming Wang"}, {"authorId": "1771551", "name": "X. Zhang"}, {"authorId": "2109350833", "name": "Tong Yang"}, {"authorId": "2032184078", "name": "Jian Sun"}], "references": [{"paperId": "1cd6b0f41d62aca38ba5a69db10e79c05e618c21", "title": "Conditional DETR for Fast Training Convergence"}, {"paperId": "af679d69fcc1d0fcf0f039aba937853bcb50a8de", "title": "Luna: Linear Unified Nested Attention"}, {"paperId": "ceb9959528a96718f1e82660dc8b28b3bdde9cde", "title": "You Only Look One-level Feature"}, {"paperId": "69621df0df837d345d764525696899e0570194b6", "title": "Fast Convergence of DETR with Spatially Modulated Co-Attention"}, {"paperId": "5c5a9b8eec9edc5a5bc0a600e68a5442e4d7cd6a", "title": "End-to-End Object Detection with Fully Convolutional Network"}, {"paperId": "6d5f423164cd5ef9324281652987c8a65009e98e", "title": "Sparse R-CNN: End-to-End Object Detection with Learnable Proposals"}, {"paperId": "39ca8f8ff28cc640e3b41a6bd7814ab85c586504", "title": "Deformable DETR: Deformable Transformers for End-to-End Object Detection"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "4c1ebb3cbd6d218cda8a7f2844ffada6eed41efc", "title": "DetectoRS: Detecting Objects with Recursive Feature Pyramid and Switchable Atrous Convolution"}, {"paperId": "962dc29fdc3fbdc5930a10aba114050b82fe5a3e", "title": "End-to-End Object Detection with Transformers"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "448529da2bf004cf79084401ad3cbd6b511e4969", "title": "Bridging the Gap Between Anchor-Based and Anchor-Free Detection via Adaptive Training Sample Selection"}, {"paperId": "6a2e2fd1b5bb11224daef98b3fb6d029f68a73f2", "title": "Objects as Points"}, {"paperId": "e2751a898867ce6687e08a5cc7bdb562e999b841", "title": "FCOS: Fully Convolutional One-Stage Object Detection"}, {"paperId": "5f4a22ee70ca613d9c0630eafc96364fe365fdf8", "title": "Efficient Attention: Attention with Linear Complexities"}, {"paperId": "5132500b23d2da47129b3f4f68dd30947a29e502", "title": "CCNet: Criss-Cross Attention for Semantic Segmentation"}, {"paperId": "04957e40d47ca89d38653e97f728883c0ad26e5d", "title": "Cascade R-CNN: Delving Into High Quality Object Detection"}, {"paperId": "d07284a6811f1b2745d91bdb06b040b57f226882", "title": "Decoupled Weight Decay Regularization"}, {"paperId": "79cfb51a51fc093f66aac8e858afe2e14d4a1f20", "title": "Focal Loss for Dense Object Detection"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "1a0912bb76777469295bb2c059faee907e7f3258", "title": "Mask R-CNN"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "f8e79ac0ea341056ef20f2616628b3e964764cfd", "title": "You Only Look Once: Unified, Real-Time Object Detection"}, {"paperId": "424561d8585ff8ebce7d5d07de8dbf7aae5e7270", "title": "Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks"}, {"paperId": "7ffdbc358b63378f07311e883dddacc9faeeaf4b", "title": "Fast R-CNN"}, {"paperId": "71b7178df5d2b112d07e45038cb5637208659ff7", "title": "Microsoft COCO: Common Objects in Context"}, {"paperId": "c8b25fab5608c3e033d34b4483ec47e68ba109b7", "title": "Swin Transformer: Hierarchical Vision Transformer using Shifted Windows"}]}