{"paperId": "a57d989819da946a4f7567aa41844370ecb25c5b", "title": "ObfuscaTune: Obfuscated Offsite Fine-tuning and Inference of Proprietary LLMs on Private Datasets", "abstract": "This work addresses the timely yet underexplored problem of performing inference and finetuning of a proprietary LLM owned by a model provider entity on the confidential/private data of another data owner entity, in a way that ensures the confidentiality of both the model and the data. Hereby, the finetuning is conducted offsite, i.e., on the computation infrastructure of a third-party cloud provider. We tackle this problem by proposing ObfuscaTune, a novel, efficient and fully utility-preserving approach that combines a simple yet effective obfuscation technique with an efficient usage of confidential computing (only 5% of the model parameters are placed on TEE). We empirically demonstrate the effectiveness of ObfuscaTune by validating it on GPT-2 models with different sizes on four NLP benchmark datasets. Finally, we compare to a na\\\"ive version of our approach to highlight the necessity of using random matrices with low condition numbers in our approach to reduce errors induced by the obfuscation.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": null}, "embedding": {"model": "specter_v2", "vector": [0.4351511597633362, 0.6198544502258301, -0.94468092918396, 0.5174787044525146, -0.8074971437454224, -0.5658155679702759, 0.4675999879837036, 0.21363328397274017, -0.06973093003034592, 0.3687538206577301, -0.07473334670066833, -0.6467752456665039, 0.36364802718162537, 0.06341471523046494, -0.5248676538467407, -0.059728920459747314, -0.7487174868583679, 0.31059300899505615, -0.48047971725463867, 0.46592697501182556, -0.0012076374841853976, -0.22876699268817902, -0.7224216461181641, 0.38854092359542847, 0.7181481719017029, 1.1520293951034546, -0.6756986379623413, 1.0328266620635986, -0.3809111416339874, -0.036693502217531204, 0.14131978154182434, -0.5724382996559143, 0.3948362171649933, 0.6558948755264282, -0.15286439657211304, -0.11067206412553787, 0.41900330781936646, -0.447075754404068, -0.6274786591529846, 1.0710256099700928, -0.4353770613670349, -0.051778923720121384, 0.5787311792373657, -1.2475597858428955, -0.7486546635627747, 0.4225139915943146, 0.2821374535560608, 0.8072706460952759, -0.14867155253887177, -0.35033607482910156, 1.1591147184371948, -0.792117714881897, 0.35223525762557983, 1.1301651000976562, 0.6606336832046509, 0.2510688602924347, -0.6123669147491455, -0.6422598361968994, -0.26256418228149414, 0.1763865351676941, -1.0404161214828491, -0.12448013573884964, -0.8094527721405029, -0.08429675549268723, 1.689409613609314, -0.09885969758033752, -0.632129430770874, 0.2180544137954712, 0.13898880779743195, 1.5078309774398804, 0.6590090990066528, -0.7199049592018127, -0.09267404675483704, 0.44908326864242554, 0.0683608278632164, 0.7574073672294617, 0.10511451959609985, 0.4132140576839447, -0.9759031534194946, -1.3436094522476196, -0.017446177080273628, -0.08833231031894684, -0.3243381977081299, -0.4553430676460266, 0.3714624047279358, 0.716461718082428, 0.0011443867115303874, 0.251462459564209, 0.025518927723169327, 0.8616792559623718, 0.5059260129928589, 0.3671022057533264, -0.08475629985332489, 0.19613894820213318, -0.48999258875846863, -0.019899845123291016, -0.8928755521774292, 0.017512215301394463, 0.49174964427948, 0.5815392732620239, -0.08585953712463379, -0.3517721891403198, -0.8226460218429565, -0.41536498069763184, 0.8506947755813599, 0.1876002997159958, 0.29681360721588135, -0.02750774845480919, 0.73329097032547, -0.6263948678970337, 0.5589936375617981, -0.40876489877700806, 0.3557734787464142, 0.28111907839775085, -0.4162205755710602, -1.029496669769287, -0.46345415711402893, -0.3415171205997467, -1.2328824996948242, 0.15243211388587952, -0.2357725203037262, 0.41884857416152954, 0.2302771657705307, 0.4716036021709442, 0.4743594527244568, 0.5127894878387451, -0.1245647445321083, 0.07907848805189133, 1.1218912601470947, -0.28425005078315735, -0.6686553955078125, -0.5830535292625427, 0.6688533425331116, -0.18680009245872498, 0.06425999850034714, -0.12999196350574493, -0.9666217565536499, -0.1444263905286789, -0.7875024676322937, -0.22153769433498383, -0.44945621490478516, 0.3869365155696869, 1.2196167707443237, 1.2334400415420532, -0.5200065970420837, 0.8557889461517334, -0.34638872742652893, 0.028840985149145126, 0.9620057940483093, 0.6521936655044556, -0.03160508722066879, -0.1696588397026062, -1.3681968450546265, 0.07783558964729309, 0.45225733518600464, -0.954900324344635, -0.2089177817106247, -0.8265876770019531, -0.7283158302307129, 0.35771483182907104, 0.6771835684776306, -0.490837961435318, 0.9790975451469421, 0.4120089113712311, -0.6355618834495544, 0.734258234500885, -0.4640887975692749, -0.28043171763420105, 0.6115670204162598, 0.07418465614318848, -0.6104422211647034, -0.35385066270828247, -0.24004502594470978, -0.013409005478024483, 0.9613112211227417, -0.4176779091358185, -0.07370902597904205, 0.03817143663764, -0.12262558192014694, -0.40581947565078735, -0.27021506428718567, 0.6534005403518677, -0.26435306668281555, -0.43996119499206543, 0.1285979002714157, 0.40321478247642517, -0.30843865871429443, 0.40510302782058716, -0.9540104866027832, -0.5785481929779053, 1.2607260942459106, -0.2071680873632431, 1.2117705345153809, -0.9115701913833618, -0.8540933132171631, 0.5459257364273071, -0.14220188558101654, 0.36288219690322876, -0.12892457842826843, 0.576086699962616, -0.5454259514808655, 1.0899591445922852, -0.6678345799446106, -0.7985917925834656, 0.24100224673748016, -0.0635683685541153, -0.9455252885818481, 0.0031917786691337824, -0.04635456204414368, 1.1922589540481567, 0.10058306902647018, 0.35501718521118164, -0.42059770226478577, 0.2072691023349762, -1.0047978162765503, 1.0891169309616089, -0.7874534726142883, 0.14677439630031586, -0.11091091483831406, 0.09081238508224487, 0.8064649701118469, -0.45599910616874695, 0.25244683027267456, -0.10261265933513641, 0.2151125818490982, 0.5232090950012207, -0.8066545128822327, 1.015960454940796, -0.2548770010471344, 0.13902869820594788, 0.20920595526695251, -0.23853814601898193, -0.28323617577552795, 0.6715190410614014, -0.3754074275493622, 0.3818359971046448, 0.25201308727264404, 0.2017841637134552, -0.7237935662269592, -0.31976839900016785, 0.5497568249702454, 0.767332911491394, -0.0636863112449646, 0.9551143050193787, 0.16808949410915375, -0.41143104434013367, -0.2094469964504242, 0.1418110579252243, 0.7408725023269653, 0.21960189938545227, 0.7572625875473022, 0.4737032353878021, 0.38645461201667786, -0.7622665166854858, -0.1975751370191574, 0.46663540601730347, 0.6888719797134399, 0.6879587173461914, 0.9181911945343018, -0.6519606113433838, -0.03863000124692917, 0.3858855962753296, 0.018469976261258125, 1.0904583930969238, -0.4035397171974182, -0.48219195008277893, -0.6305065751075745, -1.0641788244247437, 0.7570611834526062, 0.05404118821024895, -0.677029550075531, 0.11335272341966629, -0.026313725858926773, -1.3913828134536743, 1.2654786109924316, 0.18939390778541565, 0.8870837092399597, -0.28006595373153687, 0.3796786665916443, -0.8873628973960876, 0.27093005180358887, -0.7022519707679749, -0.5101641416549683, 0.4748184084892273, -0.22315151989459991, -0.23949876427650452, 0.5689263939857483, 0.24314290285110474, 0.5495636463165283, -1.0803247690200806, 0.13864298164844513, -0.09022626280784607, -0.3811700940132141, -0.033222511410713196, 0.5456222295761108, -0.6130995750427246, -0.8731180429458618, 0.20194223523139954, -0.3025992512702942, 0.08591288328170776, 0.6261680722236633, 0.3440145254135132, 0.5354189872741699, -0.11979660391807556, -0.9728053212165833, -0.7669872045516968, 0.022906845435500145, 0.3349483609199524, 0.4114145338535309, 0.24866218864917755, -0.3290660083293915, -1.6956140995025635, 0.7315942645072937, -0.2769277095794678, -0.7206132411956787, 0.2441140115261078, -0.6567968130111694, -0.030158789828419685, 0.5993983149528503, -0.9037755727767944, -0.14799124002456665, -0.9478582739830017, -0.037596363574266434, -0.4897203743457794, -0.2850976288318634, 0.3280138075351715, 0.06442872434854507, -0.655697762966156, 0.2812843322753906, 0.49244460463523865, 0.21696370840072632, -0.20700247585773468, 0.6519600749015808, -0.4400545060634613, 0.179585263133049, -0.2255849540233612, 0.64930260181427, 0.1593443900346756, -0.09898857027292252, -0.20983090996742249, -0.26656949520111084, -0.08015099912881851, -0.06072906032204628, 0.8376885056495667, -0.32051506638526917, -0.08586647361516953, -1.218458652496338, -0.434905469417572, -0.7191110849380493, -0.10139470547437668, 0.16580122709274292, -0.29608938097953796, -0.2541263997554779, -0.6256343126296997, -1.320976972579956, -0.6031578183174133, -0.38606202602386475, -0.8699902296066284, 0.42761701345443726, -0.1716398447751999, -0.34076470136642456, -0.5402144193649292, -0.4846501052379608, 0.06327029317617416, 0.3914569318294525, -0.2864530682563782, 1.250658392906189, -0.046516939997673035, -0.5759445428848267, -0.30280420184135437, -0.3569682240486145, 0.2566881775856018, -0.49153533577919006, 0.08217474818229675, -1.05376398563385, 0.08575030416250229, 0.04091084748506546, -0.38861772418022156, 0.38460785150527954, 0.08494288474321365, 1.374498724937439, -0.5969998240470886, -0.8571960926055908, 1.0797786712646484, 1.5700972080230713, -0.8939752578735352, 0.20784614980220795, 0.02651239186525345, 0.956924319267273, -0.17490935325622559, 0.13282038271427155, 0.9134858846664429, -0.20186923444271088, 0.05462653562426567, 0.1322825402021408, 0.4381128251552582, 0.3084104657173157, -0.4926556646823883, 0.018057772889733315, 0.05832564830780029, 0.37710848450660706, -0.10607980936765671, -0.9297289848327637, 0.5506502985954285, -1.260960578918457, -0.46971413493156433, 0.5293145179748535, 1.0193642377853394, 0.41262009739875793, -0.3141077756881714, -0.5892785787582397, 0.1251944750547409, 0.5451676249504089, 0.2742490768432617, -0.6143380999565125, -0.9969645738601685, 0.24665170907974243, 0.8293775916099548, 1.1672271490097046, 0.24839262664318085, -0.5581409335136414, 0.24542514979839325, 14.71924114227295, 1.0837852954864502, 0.04200422763824463, 0.8176584839820862, 0.2523265480995178, 0.5088658928871155, -0.4699736535549164, -0.14442163705825806, -1.263132095336914, 0.2637314200401306, 0.8865793347358704, -0.018340138718485832, 0.5844495892524719, 0.24999931454658508, -0.43810898065567017, -0.05734261870384216, -0.24339798092842102, 0.6128991842269897, 0.6440025568008423, -1.5713657140731812, -0.07518980652093887, 0.7237589359283447, 0.5385299324989319, 0.2132296860218048, 1.1451727151870728, 0.29896974563598633, 0.5512892007827759, -0.9256875514984131, 0.1583324819803238, -0.0532471239566803, 1.3176608085632324, -0.46084335446357727, 0.5518168807029724, 0.8124223947525024, -0.30407869815826416, -0.4613715708255768, -0.6842638254165649, -0.8254348635673523, -0.16928386688232422, 0.24172981083393097, -1.0730156898498535, -0.125705286860466, -0.03720745071768761, 0.31833720207214355, 0.517693042755127, 0.38677605986595154, -0.5065343379974365, 0.5415886044502258, -0.06261662393808365, 0.3802514672279358, -0.14271529018878937, 0.584790050983429, 0.2730974555015564, -0.43382054567337036, 0.11267627775669098, 0.10884682089090347, -0.03978167101740837, 0.5022292733192444, -0.8581914305686951, -0.3019804358482361, -0.22345805168151855, -0.621476948261261, 0.0021018602419644594, 0.762736976146698, 0.8966811299324036, 0.5983133912086487, -0.36035242676734924, 0.5838300585746765, 0.62126624584198, 0.05166643112897873, -0.21428550779819489, 0.14232948422431946, 0.5239500403404236, -0.15831580758094788, 0.6437212824821472, 0.5798931121826172, -0.5340415835380554, -0.6701661348342896, -0.4442354738712311, -0.6230682730674744, 0.7317371368408203, -0.43715542554855347, -1.0096744298934937, 0.37216031551361084, -0.879422664642334, -0.4322583079338074, 0.5410323739051819, -0.5917817950248718, 0.2071174681186676, 0.8025929927825928, -1.4733554124832153, -0.9548165202140808, 1.0876046419143677, -0.25891825556755066, -1.3845220804214478, 0.21270495653152466, 1.6590505838394165, 0.06066843494772911, -0.22612522542476654, 0.4425818920135498, 0.23409466445446014, -0.036487042903900146, 0.128543421626091, -0.7559462785720825, 1.173715353012085, 0.44694629311561584, -0.12996914982795715, 0.5738447904586792, -0.318867951631546, -0.4554179608821869, -0.7560930848121643, -0.37741580605506897, 0.39379411935806274, -1.3064863681793213, -0.15995033085346222, -0.6372064352035522, -0.9199093580245972, 0.688687801361084, 0.09571287035942078, 0.14459331333637238, 0.6489914655685425, 0.16650402545928955, -0.948487401008606, 0.2448107749223709, -1.7904969453811646, -0.31781694293022156, 0.2570023834705353, -1.0884318351745605, -0.3696485459804535, 0.042296428233385086, 0.01800675131380558, -1.3605302572250366, -0.9328145980834961, 0.020877297967672348, 0.07643570005893707, -0.17821475863456726, 0.7654725313186646, -0.49637946486473083, 0.6110865473747253, 0.6035724878311157, -0.2008749395608902, -0.7391577363014221, 0.46175071597099304, -1.2180116176605225, -0.7090587019920349, 0.014709687791764736, 0.7358263731002808, -0.7793604135513306, 0.8324868679046631, 1.294886827468872, 0.8836531639099121, -0.010355590842664242, -0.6988272070884705, 0.07596996426582336, 0.04354400560259819, -0.41419821977615356, 0.7559939026832581, 0.2539379298686981, -0.2877819240093231, -1.0414628982543945, 0.1726701706647873, 1.6099363565444946, -0.0763576552271843, -0.1796254813671112, 0.6777489185333252, 0.04526682570576668, -0.5764100551605225, 0.16230519115924835, -0.45688754320144653, -1.11453115940094, 0.08288973569869995, -1.1225947141647339, -0.39461642503738403, -0.2535167336463928, -0.5389095544815063, -0.13252002000808716, 0.18248099088668823, 0.21826504170894623, 0.1601691097021103, 0.1678796112537384, -0.5630782842636108, -0.4131762385368347, 0.2764072120189667, 0.2930680513381958, 0.7095993757247925, -0.531020998954773, 0.2717481851577759, 0.5352063179016113, -0.2529691755771637, 0.06482823938131332, 0.33566927909851074, -0.9483753442764282, -0.4186529219150543, -0.7137012481689453, 0.14018425345420837, 0.14930735528469086, -0.025988856330513954, -0.27893468737602234, 0.7092146873474121, 0.23538076877593994, -0.14379870891571045, 0.06474084407091141, 0.3141323924064636, -1.3073543310165405, -0.37962326407432556, 0.33630916476249695, -0.47669944167137146, -0.39943844079971313, 0.24092455208301544, -0.4282042384147644, 0.04872072860598564, 0.30559206008911133, -0.09005722403526306, -0.7522330284118652, -0.330167293548584, 0.7396981716156006, -0.2285345047712326, -0.04950091615319252, -0.03530127927660942, 0.02321532554924488, -1.439435362815857, -0.2368740439414978, -0.4226962924003601, 0.24901771545410156, -0.046733684837818146, 0.38728228211402893, -0.19073697924613953, -0.5028315782546997, 0.43088167905807495, 0.9925602674484253, -0.009405792690813541, -0.1280001699924469, 0.4135180115699768, 0.32787472009658813, -0.4074431359767914, 0.556621789932251, 0.3333720564842224, 0.5401436686515808, -1.219322681427002, 0.2974454164505005, 0.38424304127693176, -0.575420081615448, -0.058635413646698, 1.1003972291946411, -0.45079898834228516, -1.0914618968963623, 0.052524641156196594, -1.2071481943130493, 0.0324392132461071, -0.337858647108078, 0.5599725246429443, 0.0746457427740097, 0.47883015871047974, -0.005211185198277235, -0.47669917345046997, -0.11614211648702621, -0.09075353294610977, -0.247110977768898, 0.34959033131599426, -0.42235907912254333, -0.7309625744819641, -0.1851806640625, 0.773313045501709, -0.05527215451002121, -0.6828352808952332, -0.5795724987983704, -0.3118687570095062, -0.874358594417572, 0.22406046092510223, -0.6062886714935303, -0.3400743305683136, 0.48701348900794983, 0.025060467422008514, 0.5738794803619385, 0.039539191871881485, -0.40081149339675903, 0.7136301398277283, 0.693865954875946, 0.0950637012720108, -0.04892541468143463, -1.073425054550171, 0.48500680923461914, 0.8567824959754944, -0.9895585179328918, 0.6202868223190308, -0.73150235414505, -0.8468318581581116, 0.6894668936729431, 0.08702724426984787, 0.16240638494491577, 1.0383336544036865, 0.2752004563808441, 0.15072491765022278, 0.40326571464538574, -1.0043377876281738, -0.41074439883232117, 0.8923070430755615, 1.1763890981674194, -0.0935121700167656, 0.3771582841873169, 0.11222235858440399, 0.8784142732620239, -0.11664165556430817, 0.35247042775154114, 0.935826301574707, 0.6888930797576904, 0.21247455477714539, -0.6187583208084106, -0.6199214458465576, 1.1254864931106567, -1.6051677465438843, -0.6855344772338867, 0.04868527874350548, 0.6431857943534851, 0.592291533946991, 0.4985579252243042, 0.28811681270599365, 0.02640925906598568, 0.165911003947258, 0.254304438829422, 0.32559239864349365, -0.9202873706817627, -0.3474835455417633, -0.5950794219970703, -0.49213290214538574, 0.046760912984609604, 0.15434302389621735, -0.5046439170837402, -0.5551596879959106, -0.686905562877655, 0.20916013419628143, 0.13958729803562164, 0.42448025941848755, 0.9430145025253296, 0.7968529462814331, -0.06756845861673355, -0.09943138062953949, 0.13950829207897186, -0.5351243019104004, -0.7027630805969238, -0.5462560653686523, -0.9388499855995178, -0.009265564382076263, 0.0016763118328526616, -0.47153782844543457, -0.4928787350654602]}, "authors": [{"authorId": "2309476592", "name": "Ahmed Frikha"}, {"authorId": "2309478969", "name": "Nassim Walha"}, {"authorId": "2309477482", "name": "Ricardo Mendes"}, {"authorId": "36727640", "name": "K. K. Nakka"}, {"authorId": "2309518774", "name": "Xue Jiang"}, {"authorId": "2310115576", "name": "Xuebing Zhou"}], "references": [{"paperId": "b232f468de0b1d4ff1c2dfe5dbb03ec093160c48", "title": "Stealing Part of a Production Language Model"}, {"paperId": "985e4584d8dce5ce1c75860828c92d65cbd58590", "title": "ChipNeMo: Domain-Adapted LLMs for Chip Design"}, {"paperId": "d4c4f46b63e4812f0268d99b6528aa6a0c404377", "title": "Text Embeddings Reveal (Almost) As Much As Text"}, {"paperId": "b89c47a3b16196a73b47f41bfb497a56c32c217c", "title": "ChatEDA: A Large Language Model Powered Autonomous Agent for EDA"}, {"paperId": "f8fd2b44f4597848a6ffadefd7116e62924fd12f", "title": "LLMs Can Understand Encrypted Prompt: Towards Privacy-Computing Friendly Transformers"}, {"paperId": "5c0eb412790a0e47b25714a5857f9a1d0d95c6a6", "title": "Sentence Embedding Leaks More Information than You Expect: Generative Embedding Inversion Attack to Recover the Whole Sentence"}, {"paperId": "163b4d6a79a5b19af88b8585456363340d9efd04", "title": "GPT-4 Technical Report"}, {"paperId": "0e3d1457a66e442fae46c8f96886dc76aef3b085", "title": "Offsite-Tuning: Transfer Learning without Full Model"}, {"paperId": "2701d5b55ddacbdc82bc33901451f593a92127f1", "title": "MPCFormer: fast, performant and private Transformer inference with MPC"}, {"paperId": "94c7f980347449ab3708c74eda2c9c8ba788b95a", "title": "Model Protection: Real-Time Privacy-Preserving Inference Service for Model Privacy at the Edge"}, {"paperId": "7eb733c8ac1b3d1dd8b50e066ddae10769e3b46e", "title": "CrypTen: Secure Multi-Party Computation Meets Machine Learning"}, {"paperId": "e2937b0b2ab8700e40904a5ee639042983a76068", "title": "HEMET: A Homomorphic-Encryption-Friendly Privacy-Preserving Mobile Neural Network Architecture"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "04f4e55e14150b7c48b0287ba77c7443df76ed45", "title": "PIQA: Reasoning about Physical Commonsense in Natural Language"}, {"paperId": "1536e8958697c5364f68b2e2448905dbbeb3a0ca", "title": "Can a Suit of Armor Conduct Electricity? A New Dataset for Open Book Question Answering"}, {"paperId": "932a5de79d8a8ebb75ea0c43493450fd9922e738", "title": "Crowdsourcing Multiple Choice Science Questions"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "b29447ba499507a259ae9d8f685d60cc1597d7d3", "title": "Semantic Parsing on Freebase from Question-Answer Pairs"}, {"paperId": null, "title": "Openai\u2019s ceo says the age of giant ai models is already over, april 2023"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "444d70e3331b5083b40ef32e49390ef683a65e67", "title": "Matrix Computations"}, {"paperId": null, "title": "2023. Samsung bans chatgpt among employees after sensitive code leak, may 2023"}, {"paperId": null, "title": "\u2225 x \u2225 how much the mapping induced by that matrix can stretch vectors and m = min \u2225 Ax \u2225 \u2225 x \u2225 measures"}, {"paperId": null, "title": "2024. A fast, perfor-mant, secure distributed training framework for large language model"}, {"paperId": null, "title": "2023. Experimental evidence on the productivity effects of generative artificial intelligence"}, {"paperId": null, "title": "2023. Bench-marking large language models for automated ver-ilog rtl code generation"}, {"paperId": null, "title": "much a relative error in the input reflects"}, {"paperId": null, "title": "2022. LoRA: Low-rank adaptation of large language models"}, {"paperId": null, "title": "2023. Confidential computing on nvidia h100 gpus for secure and trustworthy ai, august 2023"}, {"paperId": null, "title": "2023. Dp-bart for privatized text rewriting under local differential privacy"}, {"paperId": null, "title": "\u2225 A \u2225 = max \u2225 Ax \u2225 \u2225 x \u2225 = \u03c3 max"}, {"paperId": null, "title": "singular matrices have the highest (worst) possible condition number, which is \u221e , since for a singular matrix A"}]}