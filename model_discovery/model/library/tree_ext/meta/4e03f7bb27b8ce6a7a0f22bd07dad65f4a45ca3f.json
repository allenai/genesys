{"paperId": "4e03f7bb27b8ce6a7a0f22bd07dad65f4a45ca3f", "title": "LKM-UNet: Large Kernel Vision Mamba UNet for Medical Image Segmentation", "abstract": "In clinical practice, medical image segmentation provides useful information on the contours and dimensions of target organs or tissues, facilitating improved diagnosis, analysis, and treatment. In the past few years, convolutional neural networks (CNNs) and Transformers have dominated this area, but they still suffer from either limited receptive fields or costly long-range modeling. Mamba, a State Space Sequence Model (SSM), recently emerged as a promising paradigm for long-range dependency modeling with linear complexity. In this paper, we introduce a Large Kernel Vision Mamba U-shape Network, or LKM-UNet, for medical image segmentation. A distinguishing feature of our LKM-UNet is its utilization of large Mamba kernels, excelling in locally spatial modeling compared to small kernel-based CNNs and Transformers, while maintaining superior efficiency in global modeling compared to self-attention with quadratic complexity. Additionally, we design a novel hierarchical and bidirectional Mamba block to further enhance Mamba's global and neighborhood spatial modeling capability for vision inputs. Comprehensive experiments demonstrate the feasibility and the effectiveness of using large-size Mamba kernels to achieve large receptive fields. Codes are available at https://github.com/wjh892521292/LKM-UNet.", "venue": "", "year": 2024, "citationCount": 7, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper introduces a Large Kernel Vision Mamba U-shape Network, or LKM-UNet, for medical image segmentation, excelling in locally spatial modeling compared to small kernel-based CNNs and Transformers, while maintaining superior efficiency in global modeling compared to self-attention with quadratic complexity."}, "embedding": {"model": "specter_v2", "vector": [0.23639509081840515, 0.7455876469612122, -0.5821174383163452, -0.06364227831363678, -0.3376891314983368, 0.2446073740720749, 0.054839055985212326, -0.23283778131008148, -0.2073391228914261, -0.5469604730606079, 0.15316198766231537, 0.4526781439781189, 0.22882887721061707, 0.1589411497116089, 0.11212006956338882, -0.2396523654460907, -1.0922443866729736, -0.049452584236860275, 0.915436863899231, -0.102556012570858, -0.3717852234840393, -0.09647075831890106, -0.4360537827014923, -0.04097350314259529, 0.14374364912509918, 1.169837474822998, 0.26531729102134705, 0.9500032067298889, 0.019808249548077583, 0.23278388381004333, 0.7333908677101135, 0.2747560441493988, 0.6090627908706665, -0.26588112115859985, -0.44311246275901794, 0.3233746290206909, 0.6524906754493713, -0.29316064715385437, -0.9192019104957581, 0.9626306295394897, -0.28435447812080383, 0.6732734441757202, 0.6829692125320435, -0.3650304079055786, 0.07100626826286316, 0.11205077171325684, 0.4536000192165375, 0.8889275193214417, -0.9173332452774048, -0.5166499614715576, 0.7098378539085388, -0.7096459865570068, 0.16400498151779175, 1.1917498111724854, 0.5513296723365784, 0.48268812894821167, -0.1262677162885666, -0.3853285610675812, 0.19122053682804108, 0.12683424353599548, -0.46853530406951904, -0.2778704762458801, 0.05930279940366745, -0.49776753783226013, 1.2152552604675293, -0.1385389119386673, 0.195419579744339, 0.5057242512702942, 0.5485323071479797, 1.3610070943832397, 0.05350397154688835, -0.5872809290885925, 0.13738273084163666, -0.12352456152439117, 0.7834597229957581, 1.0384721755981445, -0.30194780230522156, 0.4442652761936188, -0.3141646981239319, -0.16760601103305817, 1.027503252029419, -0.08629895746707916, 0.3613066077232361, -0.6180931925773621, -0.29614442586898804, 0.4739035665988922, 0.8512217402458191, 0.46578308939933777, -0.02863003872334957, 0.7099271416664124, 0.2596968710422516, -0.21893854439258575, -0.21290826797485352, 0.04237969592213631, 0.011176890693604946, 0.9543634057044983, -0.6707467436790466, -0.417595237493515, -0.47096961736679077, 0.7372738718986511, -0.6125668883323669, 0.35794150829315186, -0.607774555683136, 0.32703185081481934, 1.223705768585205, -0.2148335576057434, 0.4850023686885834, -0.4859601855278015, -0.4296620786190033, -0.3819907605648041, 0.08304308354854584, -0.8909567594528198, -0.5807464122772217, -0.3076685965061188, -1.1359647512435913, -0.6483474969863892, -0.02599543146789074, 0.4623662829399109, -1.6026569604873657, 0.3980288505554199, -0.18423980474472046, 0.5974217653274536, -0.0031272717751562595, 0.6159394979476929, 0.5977081656455994, 0.4619586765766144, 0.31539857387542725, 0.21447297930717468, 1.1267175674438477, -1.288642406463623, -0.38334524631500244, -0.6308789253234863, -0.02857692539691925, 0.24909333884716034, -0.26682960987091064, -0.43977615237236023, -1.0835685729980469, -1.174381136894226, -0.715111255645752, 0.35684093832969666, -0.558498203754425, 0.22056537866592407, 1.0669268369674683, 0.1799350082874298, -0.7958755493164062, 0.735304594039917, -0.952967643737793, -0.43645867705345154, 0.8116042017936707, 0.12062402069568634, 0.43619269132614136, 0.21869193017482758, -1.1352607011795044, 0.6447151303291321, 0.4647781550884247, -0.19359685480594635, -0.5026334524154663, -0.15366517007350922, -1.0968817472457886, 0.18745654821395874, 0.379580557346344, -0.6882945895195007, 0.8008071780204773, -0.2984772026538849, -0.8311070203781128, 0.41480422019958496, 0.20668533444404602, -0.1466236114501953, 0.25478559732437134, 0.4726853370666504, -0.5439157485961914, 0.044037144631147385, -0.5193147659301758, 0.6882695555686951, 0.7638084292411804, 0.011780431494116783, -0.1245148777961731, -0.06954365223646164, -0.47082555294036865, -0.3429144620895386, -0.5074692368507385, 0.7422075271606445, -0.3754175305366516, -0.6083109378814697, 0.8019121289253235, 0.17460480332374573, -0.7067128419876099, 0.25976458191871643, -0.18367493152618408, -0.5049133896827698, 0.7557020783424377, 0.29322150349617004, 0.7469474673271179, -0.7056556344032288, -0.7874041199684143, 0.11361043155193329, -0.06637749820947647, -0.17823925614356995, -0.5678456425666809, -0.44602012634277344, -0.549875020980835, -0.015436448156833649, -0.29568785429000854, -0.3314693570137024, -0.685092568397522, -0.21474575996398926, -0.23960427939891815, 0.3813144862651825, -0.06993202120065689, 1.6083765029907227, -0.9317798018455505, -0.2759125530719757, 0.18785634636878967, -0.15126152336597443, -0.26667320728302, 0.8737555146217346, -0.14634141325950623, 0.1694907546043396, -0.2782509922981262, 0.30669325590133667, -0.13464698195457458, -0.7067247033119202, 0.3406822681427002, -1.0143368244171143, 0.23032541573047638, -0.12029708921909332, -0.5247893333435059, 1.5124412775039673, 0.24426142871379852, 0.6030955910682678, 0.022758489474654198, -0.8013662695884705, 0.16298897564411163, 0.5142313241958618, 0.39062929153442383, -0.10177882015705109, 0.9229868054389954, 0.0395633690059185, -0.5082821846008301, 0.12754006683826447, -0.07940367609262466, 0.956648051738739, -0.48766934871673584, -0.013749734498560429, 0.5907305479049683, -0.07743480801582336, 0.13331907987594604, 0.2769710123538971, 0.24225574731826782, 0.09926304966211319, 0.6747832894325256, -0.6495219469070435, 0.07279502600431442, -0.5613563060760498, 0.20362739264965057, 0.5745179057121277, -0.2428831160068512, 1.2258636951446533, 0.19226805865764618, -1.0370110273361206, -0.33969828486442566, -0.18834960460662842, 0.15782605111598969, 0.6979392170906067, 0.3306226134300232, 0.42183902859687805, -0.6190523505210876, -0.8039296269416809, -0.4341192841529846, -0.9446892738342285, -0.7478249669075012, -0.33676987886428833, -0.47250479459762573, -1.271638035774231, 0.8146543502807617, 0.6947153210639954, 0.8013529181480408, -0.8624269962310791, -0.5877982974052429, 0.0057702804915606976, 0.4271003007888794, -0.600993812084198, -0.7789480090141296, 0.19361445307731628, -0.8234900236129761, -0.5595791339874268, -0.31509020924568176, -0.31701481342315674, 0.4069063365459442, -0.7356981039047241, 0.4014253318309784, -1.0224274396896362, -1.0687905550003052, 0.3020777404308319, 0.8140795230865479, -0.7742682695388794, -0.5351974368095398, -0.05467298999428749, 0.006216973531991243, -0.20172914862632751, 0.10913398861885071, 0.49575263261795044, -0.2315814346075058, 0.30290666222572327, -0.4711741507053375, -0.1268632411956787, 0.4409791827201843, 0.35169023275375366, 0.8284243941307068, -0.4293335974216461, 0.5575478672981262, -0.6985417008399963, 0.8480926752090454, 0.09718583524227142, -0.5972095727920532, 0.3322780132293701, -0.4777974784374237, -0.36490148305892944, 0.027706574648618698, -0.8586276173591614, -0.06052258983254433, -0.23661793768405914, 0.32760459184646606, -0.9894987940788269, -0.6221985220909119, -0.09156236052513123, 0.827570378780365, -0.42789798974990845, 0.6882116198539734, 0.5007680058479309, 0.8439853191375732, 0.4627508819103241, 0.3512967526912689, -0.8395673036575317, 0.9216629862785339, 0.31767702102661133, -0.00948304869234562, 0.6348629593849182, 0.2512710988521576, -1.0114948749542236, -0.35419192910194397, -0.8797853589057922, -0.8610389232635498, -0.37179937958717346, 0.625094473361969, -0.29582077264785767, -0.6111406683921814, 0.26336467266082764, -0.525265097618103, -0.1276961714029312, -0.20184864103794098, 0.08666181564331055, -0.4489109516143799, -0.789858877658844, -1.2923592329025269, -0.13978733122348785, -0.8255944848060608, -1.0436879396438599, 0.040557365864515305, 0.5290802121162415, -0.39160892367362976, -0.532605767250061, -0.47460052371025085, -0.5859624147415161, 1.0525844097137451, -0.11173808574676514, 0.49996933341026306, -0.2657504379749298, -0.33863773941993713, -0.4960435926914215, 0.027855094522237778, 0.5238214731216431, 0.5073633193969727, 0.011487659066915512, -0.35259541869163513, 0.4131542444229126, -0.18969757854938507, -0.13185004889965057, 0.44821736216545105, 1.2415333986282349, 0.9936935305595398, 0.6326466202735901, -0.5006455779075623, 0.4352080225944519, 0.9298591017723083, -0.3868710398674011, 0.00667450251057744, -0.22435344755649567, 0.7930766344070435, -0.014964405447244644, -0.10331027954816818, 0.2477153241634369, -0.130432590842247, 0.1473473608493805, 0.4402996003627777, -0.6883847713470459, -0.7118252515792847, 0.15674728155136108, -0.2565346360206604, 1.0121864080429077, 0.5849205255508423, 0.6826784014701843, -0.838160514831543, 1.0359410047531128, -1.294459342956543, -0.5730907917022705, 0.6969588398933411, 0.4683544337749481, -0.13621772825717926, -0.04622605815529823, -0.04733940213918686, -0.8052582740783691, 0.6418761610984802, 0.4477406442165375, -0.4592365324497223, -0.22936612367630005, 0.06686682254076004, 0.2915736138820648, 0.317611426115036, 0.39001187682151794, -1.1256178617477417, 0.47151416540145874, 15.017594337463379, 0.8683508634567261, -0.4127477705478668, 0.45357248187065125, 1.0603817701339722, 0.6017201542854309, 0.2626963257789612, -0.10580286383628845, -0.9073289036750793, 0.20430539548397064, 0.9194187521934509, 0.5638420581817627, -0.2022695541381836, 0.4953027367591858, 0.1649659425020218, 0.23822513222694397, -0.17968659102916718, 0.8311365246772766, 0.5781078338623047, -1.673009991645813, 0.018783116713166237, -0.2048323154449463, 0.4848378300666809, 0.6050816774368286, 0.37774890661239624, 0.26808497309684753, 0.0006970262038521469, -0.48348984122276306, 0.19599805772304535, 0.24045029282569885, 0.857304036617279, 0.22655615210533142, 0.05083379149436951, 0.41473764181137085, -1.2571001052856445, -0.2229975014925003, -0.7080679535865784, -0.2684844136238098, 0.38445985317230225, -0.055242691189050674, -0.4324110150337219, -0.4857443869113922, -0.12892363965511322, 0.5581688284873962, 0.02771386131644249, 0.5893557071685791, 0.2615533173084259, 0.3004028797149658, -0.22581079602241516, 0.11953330039978027, 0.3667391836643219, 0.03175634145736694, 0.49310025572776794, -0.043336544185876846, -0.29005295038223267, 0.4233969449996948, 0.5090828537940979, 0.6398302316665649, -0.07579530030488968, -0.5561144948005676, 0.18814630806446075, 0.10124962776899338, -0.5947285890579224, 1.2745071649551392, -0.353075236082077, -0.1892329603433609, -0.2122890204191208, 0.12257475405931473, 0.031185805797576904, 0.16013304889202118, -0.3443765342235565, -0.16018633544445038, 0.4800778925418854, -0.42036646604537964, -0.0029280257876962423, 0.4378390610218048, -0.4482422471046448, -0.7132241725921631, -0.852291464805603, 0.13297170400619507, 0.7432835102081299, -0.5785559415817261, -0.7376763224601746, 1.3439136743545532, -0.21782034635543823, -0.46310263872146606, 0.8148227334022522, -0.7374606132507324, -0.313495010137558, 0.3219718635082245, -1.1385583877563477, -0.8103860020637512, -0.09472572803497314, -0.08489738404750824, 0.06790462881326675, 0.13725164532661438, 0.8550281524658203, -0.21569709479808807, -0.5341609716415405, -0.24060693383216858, -0.21394294500350952, 0.2047720104455948, -0.07294658571481705, -0.44959115982055664, 0.7983072996139526, 0.6150782704353333, -0.17937365174293518, -0.15141955018043518, -0.5713744163513184, -0.04176054522395134, -0.08287648856639862, -0.15629446506500244, -0.43437671661376953, -0.7682417631149292, -0.15431639552116394, -0.4553872048854828, -0.9788089990615845, 0.4567011594772339, 0.052885569632053375, 0.9765626192092896, -0.07481049746274948, -0.6070330142974854, 0.2559867799282074, -0.15340308845043182, -0.8314003348350525, -0.31491348147392273, 0.02778843231499195, -0.5252671837806702, -0.6351960301399231, -0.1358502358198166, 0.05862675979733467, -1.1976923942565918, -0.9754205942153931, 0.2928468883037567, 0.38493627309799194, 0.23823386430740356, 1.3737752437591553, -0.9412286281585693, 0.20109766721725464, 0.6784180402755737, 0.14050734043121338, -0.7272980809211731, -0.42699432373046875, -0.5454718470573425, -0.351112961769104, -0.42553967237472534, 0.04463572055101395, -0.3642846643924713, 0.8854016065597534, 0.861530601978302, -0.18387575447559357, -1.0571880340576172, -0.56125807762146, -0.4023413360118866, -0.09363845735788345, -0.24622033536434174, -0.2659342288970947, 0.03206590190529823, -0.17559055984020233, -0.4336150288581848, 0.5864819884300232, 0.8952717781066895, 0.31746792793273926, 0.1019788607954979, -0.11991747468709946, -0.2303173840045929, -0.05813361331820488, -0.726111650466919, -0.8352611660957336, -1.609885334968567, -0.3096524477005005, -1.3531550168991089, -0.12403818219900131, -0.8372501730918884, -0.3283289670944214, -0.11367086321115494, -0.8148337006568909, 0.009335759095847607, 0.20440998673439026, -0.23491480946540833, -0.8384391665458679, -0.2081054300069809, -0.3099140524864197, 0.44415342807769775, 1.330622673034668, -0.7164499759674072, -0.07690709084272385, 0.49177536368370056, 0.28536391258239746, 0.6618887782096863, 0.3209480941295624, -0.349666029214859, -0.7076518535614014, -0.30296334624290466, -0.6565414667129517, 0.25031453371047974, -0.012089516036212444, -1.126470685005188, 1.0616681575775146, 0.061359953135252, 0.26842132210731506, -0.1754617542028427, 0.49310630559921265, -1.0473887920379639, -0.6084901094436646, 0.7886757850646973, -0.7020331621170044, -0.4733404517173767, 0.175070658326149, -0.36934611201286316, -0.5132667422294617, 0.81658935546875, 0.7709611058235168, -1.3114840984344482, -1.2752095460891724, 1.038629412651062, -0.43558844923973083, -0.08416400849819183, 0.42497432231903076, -0.20693761110305786, -0.8370515704154968, -0.06685978174209595, -1.0103620290756226, 0.34428340196609497, -0.8404147624969482, 1.0446559190750122, 0.9972377419471741, -1.0938799381256104, 0.22702771425247192, 0.6939083933830261, -0.14745169878005981, 0.3044126331806183, 0.8061016201972961, 0.7344709634780884, -0.5460611581802368, 0.6932933926582336, -0.22316059470176697, -0.013406234793365002, -0.7619879245758057, 0.10672830045223236, 1.2758891582489014, -0.07065564393997192, -0.1269061118364334, 1.1091876029968262, -0.0682549774646759, -0.8272483944892883, 0.056180816143751144, -1.2188630104064941, -0.5442277193069458, -0.3243069052696228, 0.36007243394851685, 0.5187376737594604, 0.0553324930369854, -0.2433403879404068, -0.5950295329093933, 0.18490149080753326, -0.11065461486577988, 0.029226550832390785, 0.2108696699142456, -0.07632654160261154, -0.13865727186203003, 0.2281559407711029, 0.6997238397598267, -1.269911289215088, -1.0901830196380615, -0.6487586498260498, -0.42796000838279724, -0.33916136622428894, 0.13021065294742584, -0.09734942764043808, -1.0709636211395264, 0.3224473297595978, 1.1812655925750732, 0.17468859255313873, 0.1547486037015915, 0.2079898566007614, 0.41068506240844727, 0.2487144023180008, 0.0012915757251903415, -0.39752769470214844, -0.3505541980266571, 0.617692232131958, 0.9544829726219177, -1.0694414377212524, 0.06444501131772995, -0.660078227519989, -0.5368420481681824, 1.1043407917022705, 0.81247878074646, -0.46160888671875, 1.2702423334121704, -0.2861675024032593, 0.23362946510314941, -0.16699275374412537, -0.4565127491950989, -0.21324725449085236, 1.4082918167114258, 0.8324884176254272, -0.04887145757675171, 0.3290989398956299, 0.43802160024642944, 0.6298400163650513, 0.8469362258911133, -0.020298518240451813, 0.6855526566505432, 0.47339242696762085, -0.4265558123588562, 0.2103865146636963, -0.047662489116191864, 1.15484619140625, -0.46826428174972534, 0.1106719970703125, 0.4429521858692169, 0.5147824883460999, -0.24782823026180267, 0.13217581808567047, 1.1499710083007812, 0.3796745538711548, 0.5140612721443176, -0.27137652039527893, 0.5027334094047546, -0.5169827342033386, 0.05668913200497627, 0.24981144070625305, -1.1503543853759766, -0.30524951219558716, -0.07884537428617477, -0.552310585975647, -0.5962811708450317, 0.5482646226882935, 0.057721495628356934, -0.3308737277984619, 0.21769675612449646, 0.5709813833236694, 0.6091062426567078, 0.8203818798065186, -0.46223410964012146, -0.3421788513660431, -0.5949594378471375, -0.6814752221107483, -0.10302700847387314, -0.2271699458360672, 0.15403732657432556, -0.29711270332336426, 0.29248031973838806, -0.16486378014087677]}, "authors": [{"authorId": "2199307698", "name": "Jinhong Wang"}, {"authorId": "1391200997", "name": "Jintai Chen"}, {"authorId": "145618262", "name": "D. Chen"}, {"authorId": "2261700254", "name": "Jian Wu"}], "references": [{"paperId": "5358b0e98934f1bbe8f6123a529bbb91dd36d662", "title": "SegMamba: Long-range Sequential Modeling Mamba For 3D Medical Image Segmentation"}, {"paperId": "38c48a1cd296d16dc9c56717495d6e44cc354444", "title": "Vision Mamba: Efficient Visual Representation Learning with Bidirectional State Space Model"}, {"paperId": "c1a04730c83967d0bb904b02263b17893cb50bad", "title": "U-Mamba: Enhancing Long-range Dependency for Biomedical Image Segmentation"}, {"paperId": "7bbc7595196a0606a07506c4fb1473e5e87f6082", "title": "Mamba: Linear-Time Sequence Modeling with Selective State Spaces"}, {"paperId": "1b27c5c5d5e0a26234da8cc4284471d0c543b855", "title": "Unleashing the Strengths of Unlabeled Data in Pan-cancer Abdominal Organ Quantification: the FLARE22 Challenge"}, {"paperId": "27d5abc68c2e5555bca47a3aff3f074b01f35b8c", "title": "AMOS: A Large-Scale Abdominal Multi-Organ Benchmark for Versatile Medical Image Segmentation"}, {"paperId": "dc0102a51a9d33e104a4a3808a18cf17f057228c", "title": "Transformer Quality in Linear Time"}, {"paperId": "f7410f535bda5b5a9888512fb954193245c1d0b2", "title": "Swin UNETR: Swin Transformers for Semantic Segmentation of Brain Tumors in MRI Images"}, {"paperId": "3d261c68c964fc2f9ba759e71fdaa9bf075d1c98", "title": "D-former: a U-shaped Dilated Transformer for 3D medical image segmentation"}, {"paperId": "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51", "title": "Efficiently Modeling Long Sequences with Structured State Spaces"}, {"paperId": "bd9ab344da99022cbbbfd3f5c9c82a0b21c60ad9", "title": "nnFormer: Volumetric Medical Image Segmentation via a 3D Transformer"}, {"paperId": "6709d5583f658f589ae6a2184805933aceb18849", "title": "Twins: Revisiting the Design of Spatial Attention in Vision Transformers"}, {"paperId": "e775e649d815a02373eac840cf5e33a04ff85c95", "title": "CvT: Introducing Convolutions to Vision Transformers"}, {"paperId": "2984ab83ade26639c3a82d29628d0d9e4abbebb0", "title": "Incorporating Convolution Designs into Visual Transformers"}, {"paperId": "7519a1e9e7371df79bd8a21cee871feb0ec597a5", "title": "UNETR: Transformers for 3D Medical Image Segmentation"}, {"paperId": "2b8088253e2378fce001a090fe923b81e8dedf25", "title": "RepVGG: Making VGG-style ConvNets Great Again"}, {"paperId": "f28e387d4229c5f690ce4570a391c0f47e7155c7", "title": "nnU-Net: a self-configuring method for deep learning-based biomedical image segmentation"}, {"paperId": "37a18be8c599b781cc28b6a62d8f11e8a6a75169", "title": "3D MRI brain tumor segmentation using autoencoder regularization"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "01a4f33da8ad94ced3cf58548b28dbbb44148571", "title": "Understanding the Effective Receptive Field in Deep Convolutional Neural Networks"}, {"paperId": "6364fdaa0a0eccd823a779fcdd489173f938e91a", "title": "U-Net: Convolutional Networks for Biomedical Image Segmentation"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "251c39c1b9372f3055cd53d0001fc122bfb2e418", "title": "The Cancer Imaging Archive (TCIA): Maintaining and Operating a Public Information Repository"}, {"paperId": "c8b25fab5608c3e033d34b4483ec47e68ba109b7", "title": "Swin Transformer: Hierarchical Vision Transformer using Shifted Windows"}, {"paperId": null, "title": "Large Kernel Vision"}, {"paperId": null, "title": "The authors have no competing interests to declare that are relevant to the content of this article"}, {"paperId": null, "title": "Hungry hun-gry hippos: Towards language modeling with state space models"}]}