{"paperId": "6d25e201deddad04534e37ccbe0f7566938e10f3", "title": "Investigating Mysteries of CoT-Augmented Distillation", "abstract": "Eliciting\"chain of thought\"(CoT) rationales -- sequences of token that convey a\"reasoning\"process -- has been shown to consistently improve LLM performance on tasks like question answering. More recent efforts have shown that such rationales can also be used for model distillation: Including CoT sequences (elicited from a large\"teacher\"model) in addition to target labels when fine-tuning a small student model yields (often substantial) improvements. In this work we ask: Why and how does this additional training signal help in model distillation? We perform ablations to interrogate this, and report some potentially surprising results. Specifically: (1) Placing CoT sequences after labels (rather than before) realizes consistently better downstream performance -- this means that no student\"reasoning\"is necessary at test time to realize gains. (2) When rationales are appended in this way, they need not be coherent reasoning sequences to yield improvements; performance increases are robust to permutations of CoT tokens, for example. In fact, (3) a small number of key tokens are sufficient to achieve improvements equivalent to those observed when full rationales are used in model distillation.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work asks: Why and how does this additional training signal help in model distillation?"}, "embedding": {"model": "specter_v2", "vector": [-0.18945591151714325, 0.9887607097625732, -0.17746099829673767, 0.1446331888437271, -0.833573579788208, -0.8035513162612915, 0.5065330266952515, 0.3638029396533966, -0.22781619429588318, -0.07171577215194702, 0.33982929587364197, -0.8372247219085693, 0.12228377908468246, 0.6289017200469971, -0.0895899310708046, -0.2347971796989441, -0.49486204981803894, 0.5176498293876648, -0.29348742961883545, -0.4160366952419281, -0.0624992735683918, -0.4022689759731293, -0.7832657098770142, 0.19255685806274414, 0.7148349285125732, -0.14474377036094666, -0.2963341772556305, 1.2455614805221558, -0.2530733346939087, 0.6336281895637512, 0.5426539182662964, -0.05289622023701668, 0.15578947961330414, -0.240626722574234, -0.36090224981307983, -0.3532296121120453, 0.4607054591178894, -0.38217371702194214, -0.11770178377628326, 0.2668692171573639, 0.10779551416635513, 0.22820638120174408, 0.4024117887020111, -0.6855961680412292, -0.5791820883750916, 0.9405990242958069, 0.284500390291214, 0.7416994571685791, -0.11114810407161713, -0.4409831464290619, 1.5421409606933594, -1.3647838830947876, 0.20503288507461548, 1.1395628452301025, 0.3936826288700104, 0.42501920461654663, -0.6516591310501099, -0.5542047023773193, 0.5851032733917236, 0.30380845069885254, -0.8476184606552124, -0.066217802464962, 0.08579745888710022, -0.286217600107193, 1.0049574375152588, -0.16842177510261536, -0.0031805175822228193, 0.12872043251991272, -0.5064114928245544, 1.8765172958374023, 0.38075053691864014, -1.147691011428833, 0.2000587433576584, 0.8465988039970398, 0.42169857025146484, 0.7072237133979797, -0.13171222805976868, 0.15990479290485382, -0.813944399356842, -0.32702353596687317, 0.3165147006511688, -0.4445972740650177, -0.1368934065103531, -0.5700673460960388, 0.05949844419956207, 0.7364461421966553, 0.06418739259243011, 1.0487251281738281, -0.20457270741462708, 0.9530211091041565, 0.013319358229637146, 0.7286851406097412, -0.08981577306985855, 1.0603914260864258, -0.5979396104812622, 0.15888072550296783, -0.8290370106697083, 0.4359743893146515, 0.15429797768592834, 0.4349999725818634, -0.1678006500005722, 0.02995981089770794, -0.907357394695282, -0.12159981578588486, 1.5238487720489502, -0.27098584175109863, 0.5254505276679993, -0.7344153523445129, 0.49916431307792664, -0.4565376341342926, 0.5761958956718445, 0.03072386421263218, -0.08118312805891037, -0.22649826109409332, -0.08145498484373093, -0.997067928314209, -0.350338339805603, -0.22821791470050812, -0.8405941724777222, 0.6575466394424438, -0.07074462622404099, 0.44013503193855286, -0.07947247475385666, 0.601958692073822, 0.3246855139732361, 0.0009559453465044498, 0.31634441018104553, 0.22428062558174133, 0.7116149067878723, -0.4026932418346405, -0.3554874658584595, -1.0119730234146118, 1.2837400436401367, -0.3120889663696289, 0.30197572708129883, -0.07293969392776489, -1.5760151147842407, -1.071418046951294, -0.8743627667427063, 0.07654688507318497, -0.25168269872665405, 0.4147472083568573, 0.9550036191940308, 0.5323333740234375, -1.0294169187545776, 0.3795972466468811, 0.003926621284335852, 0.08557163178920746, 0.20044904947280884, 0.2831266224384308, 0.628054141998291, -0.8463631272315979, -0.776457667350769, 0.2562108635902405, 0.3937437832355499, -0.5732892155647278, -0.3539482653141022, -0.888015627861023, -0.7824846506118774, 0.051294997334480286, 0.5457938313484192, -0.6905152201652527, 1.9308202266693115, 0.5028663277626038, -0.9902613759040833, 0.4624575972557068, -0.14107123017311096, 0.639471173286438, 0.7397339344024658, -0.4796907901763916, -0.31349772214889526, -0.4157325327396393, 0.200155109167099, 0.7834345102310181, 0.4719887375831604, -0.561316728591919, 0.011523973196744919, 0.30053654313087463, -0.07473913580179214, -0.2936387360095978, 0.042721353471279144, 0.1742684543132782, 0.18568721413612366, -0.35067275166511536, 0.6669777035713196, 0.4804544746875763, -0.22608400881290436, -0.49766966700553894, -0.39571425318717957, -1.3010165691375732, 0.6115386486053467, 0.29643940925598145, 0.9607248306274414, -0.7246190905570984, -0.9231255054473877, -0.052727747708559036, 0.23620069026947021, 0.01823100820183754, -0.9154910445213318, 0.7160271406173706, -1.0349905490875244, 0.6739814877510071, -0.11157837510108948, -0.7673320174217224, 0.407752126455307, -0.544055163860321, -0.7105984091758728, -0.5319373607635498, 0.22245900332927704, 1.2234411239624023, -0.8322260975837708, 0.06844379007816315, 0.33917683362960815, -0.0835503563284874, -1.376806616783142, 1.2990968227386475, -0.7362331748008728, 0.6610313057899475, -0.4856601357460022, -0.05550222843885422, 0.26072850823402405, -0.49762341380119324, 0.3770645558834076, -0.18225792050361633, 0.06312096118927002, 0.25342583656311035, -1.0361541509628296, 1.5549976825714111, -0.15818344056606293, 0.566091775894165, -0.08043833822011948, -0.7464252710342407, -0.1640990525484085, 0.8594334125518799, -0.28318819403648376, -0.09947451204061508, 0.13710182905197144, 0.8463296294212341, -0.217543825507164, -0.3189270794391632, 0.38639211654663086, 0.4445192813873291, -0.25351426005363464, 0.5921180844306946, 0.31327372789382935, -0.7891368865966797, 0.3480042517185211, 0.5671869516372681, 0.7630509734153748, 0.5580863952636719, 0.40510135889053345, 0.0874105915427208, 0.5086658596992493, -0.5077380537986755, -0.5438909530639648, 0.7587192058563232, 0.8429136872291565, 0.7413437962532043, 0.10290014743804932, -0.6275720596313477, 0.09462207555770874, -0.12875071167945862, 0.7168533802032471, 1.5111112594604492, -0.24357964098453522, -0.40130722522735596, -0.4754836857318878, -0.8062114119529724, -0.13729724287986755, 0.664243221282959, -0.5666935443878174, -0.2987266480922699, -0.725354790687561, -0.893227756023407, 0.7445601224899292, 0.5951159000396729, 0.9486753940582275, -0.19624698162078857, -0.18582165241241455, 0.054627493023872375, 0.271238774061203, -0.6117933392524719, -0.14704379439353943, 0.31420159339904785, -0.5345948338508606, -0.5438224673271179, 0.07296452671289444, -0.08291973173618317, 0.2882360517978668, -0.44897469878196716, 1.0429894924163818, -0.07393936067819595, -0.5357744097709656, 0.33144983649253845, 0.6241940855979919, -0.33601897954940796, -0.5250138640403748, -0.09784720093011856, -0.11083611845970154, -0.7188724875450134, 0.32795780897140503, 0.43880242109298706, -0.09664174914360046, -0.04939878359436989, -0.4386745095252991, -0.04005444422364235, 0.2774328887462616, 0.07577589154243469, 0.1934857815504074, -0.3783378601074219, 0.18577700853347778, -1.2383826971054077, 1.2725752592086792, 0.012245528399944305, -0.06129196286201477, 0.27059847116470337, -1.1712344884872437, 0.052061352878808975, 0.3787311017513275, -0.6023305654525757, -0.18822374939918518, -1.478294014930725, 0.3439485728740692, -0.017840923741459846, -0.6454898715019226, 0.11140023916959763, 0.5136633515357971, 0.10393685847520828, 0.20976753532886505, 0.14918048679828644, -0.06037386506795883, -0.3926222324371338, 1.3115731477737427, -0.9094712734222412, 0.08920487016439438, -0.19980141520500183, 0.3869425356388092, -0.6943740844726562, -0.029546959325671196, -0.07284043729305267, -0.5368806719779968, -0.059079378843307495, -0.20461301505565643, 0.11496180295944214, 0.12549959123134613, -0.7880045175552368, -0.980445384979248, -0.5055069923400879, -0.8888445496559143, -0.3280927240848541, -0.417217880487442, -0.023428676649928093, -0.07261277735233307, -1.5339093208312988, -1.2525578737258911, -0.36070647835731506, 0.21768347918987274, -1.025172472000122, 0.2699822187423706, 0.1868961751461029, -0.9350453019142151, -0.8442602753639221, 0.2535553574562073, 0.2825962007045746, 0.7490785717964172, -0.8688788414001465, 1.2953625917434692, -0.41920655965805054, -0.5620550513267517, -0.19165539741516113, 0.10987796634435654, 0.09017447382211685, -0.3345840871334076, 0.0747370719909668, -1.3501203060150146, -0.053503770381212234, 0.042871613055467606, -0.5711066126823425, 0.11898769438266754, 0.2183651328086853, 0.515794038772583, 0.09853430092334747, -0.6055499911308289, -0.15880092978477478, 1.2467231750488281, -0.6165809631347656, -0.33550789952278137, 0.3464486300945282, 1.2258728742599487, 0.49015533924102783, 0.03992864862084389, 0.22520673274993896, 0.46548476815223694, -0.13461396098136902, -0.005804648622870445, -0.12083366513252258, -0.3154149353504181, -0.6327027082443237, 0.23531517386436462, 1.2174395322799683, 0.4241061806678772, -0.007885931991040707, -0.9913397431373596, 0.35755500197410583, -1.413477897644043, 0.010918901301920414, 0.15213404595851898, 0.510677695274353, 0.4499000012874603, -0.5043706893920898, -0.7808507680892944, 0.17646679282188416, -0.07567598670721054, 0.02694459818303585, -0.36927032470703125, -0.3742852509021759, 0.6246471405029297, 0.8473927974700928, -0.15399587154388428, 0.6281614303588867, 0.1741349995136261, 0.2216908484697342, 14.87267780303955, 0.6980687379837036, 0.4464985132217407, 0.6542453169822693, 0.5611152052879333, 0.38113847374916077, -0.7519491314888, 0.10783297568559647, -1.021210789680481, -0.44430339336395264, 0.8626366853713989, 0.5433794856071472, 0.14076115190982819, -0.11947266012430191, 0.09446621686220169, -0.07974863797426224, -0.8112123608589172, 0.2733123004436493, 0.3963503837585449, -1.2919673919677734, 0.4099355936050415, 0.34634822607040405, 0.6587876677513123, -0.02110045589506626, 0.9397327899932861, 1.2641690969467163, 0.8096328973770142, -0.4724072217941284, 0.4698559641838074, -0.2682378888130188, 0.5518622994422913, 0.0810709297657013, 0.3662201166152954, 0.5760563611984253, -0.7543613314628601, -0.4663137197494507, 0.26709872484207153, -1.1205265522003174, -0.255663126707077, -0.11424733698368073, -1.1218355894088745, -0.5552675127983093, -0.47865259647369385, 0.21477335691452026, -0.43801000714302063, 0.12201648205518723, -0.7281969785690308, 0.8670011162757874, 0.33786895871162415, 0.15978865325450897, 0.3610104024410248, 0.8530706763267517, 0.14665700495243073, -0.3152765929698944, 0.10955315828323364, -0.05420054867863655, 0.10785297304391861, 0.7843574285507202, -0.4259239733219147, -0.1551373451948166, -0.2351250797510147, -0.2777707874774933, 0.052411239594221115, 0.6786947250366211, 0.2705148160457611, 0.27325183153152466, -0.141645148396492, -0.008141142316162586, 0.5277564525604248, 0.434475839138031, -0.0004582412075251341, -0.012277569621801376, 0.30617526173591614, -0.3376127779483795, -0.0185273215174675, 0.4212033748626709, -0.43584102392196655, -0.5870673060417175, -0.8501311540603638, -0.33824288845062256, 0.33177804946899414, -0.9989551305770874, -0.8307808637619019, 0.21873284876346588, -0.09377366304397583, -0.7153885364532471, -0.3329158425331116, -0.5626728534698486, -0.6030188202857971, 0.4823543429374695, -1.5582224130630493, -0.777030348777771, 0.18964770436286926, -0.4910264015197754, -0.3294641673564911, 0.15640176832675934, 1.2329314947128296, -0.1581578552722931, -0.32366788387298584, -0.011251787655055523, 0.074522465467453, -0.29119741916656494, 0.31389474868774414, -1.4371695518493652, 0.8566728234291077, 0.1701541244983673, 0.15932893753051758, 0.41107165813446045, 0.18958163261413574, 0.3455830514431, -0.49733948707580566, 0.3191067576408386, 0.4301775097846985, -1.503164529800415, -0.5030674338340759, -0.5763092041015625, -0.854595959186554, 0.2765142321586609, 0.49586957693099976, -0.2996778190135956, 0.986836314201355, 0.0777500569820404, -0.47075387835502625, 0.3136674761772156, -1.0883790254592896, 0.4708678126335144, 0.13645096123218536, -0.6034600138664246, -0.7412289977073669, -0.12221512943506241, 0.6114293932914734, -0.9006093740463257, -0.37716540694236755, -0.2170526683330536, -0.32325267791748047, 0.013683791272342205, 0.9004030823707581, -0.5662015080451965, 0.37895506620407104, 0.6304932832717896, -0.1600574254989624, -0.9725722074508667, -0.1122252494096756, -0.9223853349685669, -0.21619942784309387, 0.4978935718536377, 0.7410993576049805, -0.43218204379081726, 0.4907330870628357, 1.6082508563995361, 0.33958372473716736, -0.2815815508365631, -0.10223089158535004, 0.17467960715293884, 0.3151349723339081, -0.5550220012664795, 0.4715459942817688, 0.4911726415157318, -0.039582759141922, 0.27036210894584656, 1.0042990446090698, 0.7472919821739197, -0.09184306859970093, -0.4947381317615509, 0.5101646184921265, -0.4663791358470917, -0.2986617088317871, -0.37796998023986816, 0.04807557910680771, -1.2275302410125732, -0.1278134435415268, -1.1574509143829346, 0.16399367153644562, -1.0859150886535645, -0.9985520243644714, -0.2377627193927765, -0.34838441014289856, -0.10573048144578934, -0.07571560889482498, -0.31312450766563416, -0.4537767767906189, -0.5284910798072815, -0.3267490267753601, 0.48548224568367004, 1.181090235710144, -0.2752724289894104, -0.1364707350730896, -0.04776360094547272, -0.8164918422698975, 0.5473628044128418, 0.2915516197681427, -0.6633391976356506, -1.1077467203140259, -1.1934577226638794, 0.6474241018295288, 0.07447099685668945, -0.053305260837078094, -0.5045007467269897, 0.6950137615203857, 0.30970901250839233, 0.06960894167423248, 0.11998780816793442, 0.2544715106487274, -0.9647029638290405, -0.8510191440582275, 0.2574222981929779, -1.0760815143585205, 0.09800952672958374, 0.3217400014400482, -0.4698198735713959, -0.04267450049519539, 0.10694952309131622, -0.37489575147628784, -1.100996732711792, -0.5748484134674072, -0.25416287779808044, -0.7254540920257568, 0.31085512042045593, -0.11947625130414963, -0.08304376900196075, -0.9455297589302063, 0.0611003153026104, -0.10790222883224487, 0.5703258514404297, -0.5837801694869995, 0.6818743944168091, 0.03675325587391853, -1.0220210552215576, -0.06634313613176346, 0.6035019755363464, -0.14299561083316803, 0.2581802010536194, 0.25239041447639465, 0.43354323506355286, -0.09225370734930038, 0.4875424802303314, 0.5298623442649841, 0.29626110196113586, -0.5319668054580688, -0.35466596484184265, 0.44141748547554016, -0.6772908568382263, 0.018117034807801247, 1.4248409271240234, -0.5363789796829224, -1.0989737510681152, -0.05505640432238579, -1.3478097915649414, -0.45135602355003357, -0.1543586403131485, 0.40395107865333557, 0.28884053230285645, -0.08551312983036041, 0.8981623649597168, -0.36619728803634644, 0.3009977638721466, -0.38716375827789307, -0.9223021268844604, 0.34140804409980774, -0.4377911388874054, -0.2372647523880005, 0.45329082012176514, 0.41753947734832764, -0.31668388843536377, -0.3659016191959381, -0.26834598183631897, 0.1828376054763794, -0.20058861374855042, 0.2150883674621582, -0.7117226123809814, 0.14589199423789978, 0.9482426643371582, 0.5857799649238586, 0.5443124771118164, -0.10505928099155426, -0.110129714012146, -0.24613144993782043, 0.7153384685516357, -0.17425666749477386, -0.09010559320449829, -0.1774284541606903, 0.6830044984817505, 0.6932465434074402, -1.083448052406311, 0.1937025487422943, 0.194713294506073, -0.6488791108131409, 0.9787927865982056, 0.9590921401977539, 0.0313577726483345, 0.7408208250999451, -0.41935357451438904, 0.2821786105632782, -0.26444047689437866, -1.2035996913909912, -0.17530934512615204, 0.6191622614860535, 0.8867166638374329, 1.1310765743255615, 0.20730729401111603, 0.3075920045375824, 0.9835067987442017, 0.020501786842942238, 0.6721861362457275, 1.0293102264404297, 0.855903148651123, -0.24525097012519836, -0.2914940416812897, -0.12023801356554031, 0.43020790815353394, -0.3775814473628998, -0.6192460060119629, 0.03289298713207245, 1.0474321842193604, 0.6364654898643494, 0.7684448957443237, 0.32119011878967285, -0.04105095565319061, 0.5288150906562805, 0.6945709586143494, 0.6520429253578186, -0.9372449517250061, -0.48512130975723267, -0.3713856041431427, -0.6679605841636658, 0.22850818932056427, -0.22193336486816406, -0.22652481496334076, -0.617092490196228, -0.11527199298143387, 0.04648720845580101, 0.45046746730804443, 0.20272761583328247, 1.2645925283432007, 0.44126686453819275, 0.8779428005218506, -0.2847287356853485, -0.18091021478176117, -0.39275869727134705, -0.9316425323486328, 0.1615533083677292, -0.9860268235206604, 0.07588902115821838, 0.010465727187693119, -0.5919070839881897, -0.27098292112350464]}, "authors": [{"authorId": "35918090", "name": "Somin Wadhwa"}, {"authorId": "2294355004", "name": "Silvio Amir"}, {"authorId": "2306260315", "name": "Byron C. Wallace"}], "references": [{"paperId": "d8ba6085c7c32cc367ab7f50d18744de846fcebd", "title": "Preemptive Answer\"Attacks\"on Chain-of-Thought Reasoning"}, {"paperId": "49a02664e552320a43cea541c07ca312e45350b5", "title": "Future Lens: Anticipating Subsequent Tokens from a Single Hidden State"}, {"paperId": "4411e6b32865933cab87696c2738cb7a204e4240", "title": "Implicit Chain of Thought Reasoning via Knowledge Distillation"}, {"paperId": "a83724fd55cd2bcf5583ca181373c34571ac1f73", "title": "DialCoT Meets PPO: Decomposing and Exploring Reasoning Paths in Smaller Language Models"}, {"paperId": "abe90a291e7cf567ce5c9012a692beeae153068d", "title": "Think before you speak: Training Language Models With Pause Tokens"}, {"paperId": "7a6a298efb965ce9a351a3212f6f536e94dbbb03", "title": "Symbolic Chain-of-Thought Distillation: Small Models Can Also \u201cThink\u201d Step-by-Step"}, {"paperId": "97782a67971c4ff1a74bf07e82fe20b2c4bf86c4", "title": "Revisiting Relation Extraction in the era of Large Language Models"}, {"paperId": "aad167be3c902388ea625da4117fcae4325b8b7d", "title": "Distilling Step-by-Step! Outperforming Larger Language Models with Less Training Data and Smaller Model Sizes"}, {"paperId": "56fa65d8dc41708082f9b2ef7752c49cee9ebe01", "title": "SCOTT: Self-Consistent Chain-of-Thought Distillation"}, {"paperId": "762ca2711eb167f19b79e39c175708ca15e1f5d7", "title": "Eliciting Latent Predictions from Transformers with the Tuned Lens"}, {"paperId": "fbd49b25bdab98c171af49962a41139c73dacbde", "title": "Specializing Smaller Language Models towards Multi-Step Reasoning"}, {"paperId": "a9e3e5dd7b30890553b7ae1c41f932e99192bb44", "title": "Large Language Models Are Reasoning Teachers"}, {"paperId": "8fd462f6248d5e3f1b6602697c09489086b5655f", "title": "Distilling Reasoning Capabilities into Smaller Language Models"}, {"paperId": "4081aeb7ff148cc4678efca4e44a72dece4542e3", "title": "Reframing Human-AI Collaboration for Generating Free-Text Explanations"}, {"paperId": "521ccc898395a2818fced22b4cf371b0e5121f94", "title": "Symbolic Knowledge Distillation: from General Language Models to Commonsense Models"}, {"paperId": "5b6c582d51266be9aa7e32bfdc20891e5231eca4", "title": "When Can Models Learn From Explanations? A Formal Framework for Understanding the Roles of Explanation Data"}, {"paperId": "51004bc6461a572e1189a0e3b32b441155d760ce", "title": "QuaRel: A Dataset and Models for Answering Questions about Qualitative Relationships"}, {"paperId": "1536e8958697c5364f68b2e2448905dbbeb3a0ca", "title": "Can a Suit of Armor Conduct Electricity? A New Dataset for Open Book Question Answering"}, {"paperId": "f302e136c41db5de1d624412f68c9174cf7ae8be", "title": "Axiomatic Attribution for Deep Networks"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": "87f40e6f3022adbc1f1905e3e506abad05a9964f", "title": "Distributed Representations of Words and Phrases and their Compositionality"}, {"paperId": "a9cd1794e0422787c34877760722f32fd6dee439", "title": "Proceedings of the 51st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)"}, {"paperId": null, "title": "Trans-formers: State-of-the-art natural language processing"}, {"paperId": null, "title": "gpt: the logit lens"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "c21a4d70d83e0f6eb2a9e1c41d034842dd561e47", "title": "CommonsenseQA: A Question Answering Challenge Targeting Commonsense Knowledge"}, {"paperId": null, "title": "2024. Post-semantic-thinking: A robust strategy to distill reasoning capacity from large language models"}, {"paperId": null, "title": "The coherence of rationales and their gram-matically. Finding: When rationales follow labels, the words they comprise can be scrambled and one still observes comparable gains"}]}