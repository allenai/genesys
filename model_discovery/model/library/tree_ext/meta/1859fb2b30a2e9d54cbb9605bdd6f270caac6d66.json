{"paperId": "1859fb2b30a2e9d54cbb9605bdd6f270caac6d66", "title": "DARTFormer: Finding The Best Type Of Attention", "abstract": "Given the wide and ever growing range of different efficient Transformer attention mechanisms, it is important to identify which attention is most effective when given a task. In this work, we are also interested in combining different attention types to build heterogeneous Transformers. We first propose a DARTS-like Neural Architecture Search (NAS) method to find the best attention for a given task, in this setup, all heads use the same attention (homogeneous models). Our results suggest that NAS is highly effective on this task, and it identifies the best attention mechanisms for IMDb byte level text classification and Listops. We then extend our framework to search for and build Transformers with multiple different attention types, and call them heterogeneous Transformers. We show that whilst these heterogeneous Transformers are better than the average homogeneous models, they cannot outperform the best. We explore the reasons why heterogeneous attention makes sense, and why it ultimately fails.", "venue": "arXiv.org", "year": 2022, "citationCount": 4, "influentialCitationCount": 1, "openAccessPdf": {"url": "http://arxiv.org/pdf/2210.00641", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "This work proposes a DARTS-like Neural Architecture Search method to find the best attention for a given task, and extends this framework to search for and build Transformers with multiple different attention types, and shows that whilst these heterogeneous Transformers are better than the average homogeneous models, they cannot outperform the best."}, "embedding": {"model": "specter_v2", "vector": [0.09865691512823105, 0.4662342071533203, -0.5686148405075073, 0.1330055296421051, -0.2594844698905945, -0.17253378033638, 0.352486789226532, -0.09675007313489914, -0.3131597638130188, -0.32295334339141846, 0.5594666004180908, -0.2847851812839508, 0.27154940366744995, 0.3009667992591858, 0.366908997297287, 0.22271251678466797, -0.2841799557209015, 0.5831946730613708, 0.0042247474193573, -0.5325973629951477, 0.5349711179733276, -0.7712218761444092, -1.218955636024475, 0.36711639165878296, 0.199799045920372, 0.9886982440948486, 0.010490784421563148, 0.8019288778305054, -0.7610993981361389, 0.7380691170692444, 0.12818636000156403, -0.31523069739341736, 0.009298976510763168, 0.24446210265159607, -0.7602477669715881, -0.3360469341278076, 1.0704244375228882, -0.027830181643366814, -0.20584627985954285, 0.639999270439148, 0.05245906487107277, -0.07501634955406189, 0.5193249583244324, -0.7448387742042542, -0.16312576830387115, 0.9508006572723389, 0.6465105414390564, 0.9764174818992615, -0.07614438235759735, -0.46176648139953613, 1.636989712715149, -1.1277605295181274, 0.15138323605060577, 1.6774145364761353, 0.5736463069915771, 0.446258008480072, -0.2777659595012665, -0.5527763962745667, 0.45470285415649414, 0.5091609954833984, -0.5694374442100525, -0.5839115381240845, -0.10488700121641159, -0.08064579963684082, 1.9476808309555054, -0.11945513635873795, -0.597573459148407, 0.11023208498954773, 0.407537043094635, 1.5513317584991455, -0.33997297286987305, -0.7179930210113525, -0.2572581470012665, -0.28214314579963684, 0.6799461841583252, 0.4309506118297577, -0.5112382173538208, -0.40603387355804443, -0.8366695642471313, -0.3347529470920563, -0.023816630244255066, -0.07525599747896194, -0.020157841965556145, -0.2470870167016983, -0.2654036283493042, 0.6189541816711426, 0.44140809774398804, 0.8759788274765015, -0.4796196222305298, 0.6230689883232117, 0.5701555013656616, 0.32370954751968384, -0.09694048762321472, 0.8798407912254333, -0.11949636042118073, 0.4704892933368683, -0.7349004745483398, -0.14399193227291107, 0.29151394963264465, 0.9584253430366516, -0.32980290055274963, 0.3428879678249359, -0.9394314885139465, 0.11092744767665863, 0.8940529227256775, -0.0049114953726530075, 0.4437147080898285, -0.6670289635658264, 0.44249439239501953, -0.30754685401916504, -0.22366079688072205, -0.4093279540538788, 0.07956411689519882, -0.09686063975095749, -0.5986977815628052, -0.951261579990387, -0.4709656238555908, 0.018933000043034554, -0.5634638667106628, 0.17271743714809418, -0.5678561925888062, -0.30851075053215027, -0.08284405618906021, 0.1007247194647789, 0.5820196270942688, 0.2120395004749298, 0.5669414401054382, 0.49355465173721313, 1.1228916645050049, -0.6208621263504028, -0.6221904754638672, -1.2613123655319214, 0.4812059700489044, -0.6830572485923767, 0.1453368216753006, -0.08769005537033081, -1.0455756187438965, -0.8023186326026917, -0.7568879127502441, -0.2802755832672119, -0.4543793499469757, 0.0972432941198349, 0.7915489077568054, 0.24722163379192352, -1.2878961563110352, 0.5425073504447937, 0.31545495986938477, -0.5301980972290039, 0.17222855985164642, 0.1931212991476059, 0.48653584718704224, -0.4463410973548889, -1.1707916259765625, 0.35730206966400146, -0.04634164646267891, -0.6790304183959961, -0.11529818177223206, -0.21070818603038788, -0.777249276638031, 0.11452817171812057, 0.3807671070098877, -0.5732497572898865, 1.4018152952194214, -0.032300353050231934, -0.7839627265930176, 0.30160367488861084, -0.5593248605728149, 0.1792905330657959, -0.3876745104789734, 0.06412354111671448, -0.40614476799964905, -0.5464733839035034, -0.28518977761268616, 0.5651862621307373, 0.9710935950279236, 0.18596835434436798, -0.27771878242492676, 0.16248270869255066, -0.013617814518511295, 0.0709577277302742, -0.7905242443084717, 1.0682090520858765, -0.3983666002750397, 0.07390177994966507, 0.31178122758865356, 0.7250595092773438, 0.38885894417762756, -0.2986080050468445, -0.5148520469665527, -1.3057866096496582, 0.7770867347717285, 0.024181969463825226, 1.403477668762207, -0.7434223890304565, -0.3529570996761322, -0.5753315091133118, -0.018841296434402466, -0.2805747091770172, -0.7128711342811584, 0.6241992712020874, -0.5688261389732361, 0.5957997441291809, 0.20888520777225494, -1.0778515338897705, 0.22685594856739044, -0.514397382736206, -0.48390859365463257, -0.27264174818992615, -0.09159327298402786, 0.6912062168121338, -0.3705301582813263, -0.030329380184412003, -0.3167757987976074, 0.22805535793304443, -0.7391155958175659, 1.3854458332061768, -0.3724460303783417, -0.35649049282073975, -0.21576093137264252, 0.07209552824497223, -0.12067035585641861, -0.19311441481113434, 0.23068922758102417, -0.8892478346824646, -0.38050612807273865, 0.7773351073265076, 0.0005367103731259704, 0.942974328994751, -0.43434619903564453, 0.6126021146774292, 0.18382029235363007, -0.15840473771095276, 0.07662355154752731, 0.6777162551879883, -0.22068198025226593, -0.38424235582351685, 0.3824770450592041, 0.3452644944190979, -0.3700401782989502, 0.25545692443847656, 0.9211282730102539, 1.2546826601028442, -0.5607818961143494, 0.1844346523284912, 0.5237180590629578, -0.319585919380188, 0.1866440325975418, 0.24526825547218323, 1.1338258981704712, -0.07681387662887573, 0.3616073429584503, -0.30959582328796387, 0.47003835439682007, -0.5253816246986389, -0.22437520325183868, 0.3835722506046295, 0.6991844177246094, 0.9017688035964966, 0.6183909177780151, -0.9515517354011536, -0.20838168263435364, 0.41939181089401245, 0.624232292175293, 1.8075594902038574, -0.26191017031669617, -0.1476919800043106, -0.6118380427360535, -0.49260762333869934, -0.399431437253952, 0.4416405260562897, -0.45005327463150024, -0.18484777212142944, -0.5984894037246704, -0.7113611102104187, 0.8005340695381165, 0.11316922307014465, 1.015715479850769, -0.7108135223388672, -0.5377655625343323, -0.4344221353530884, 0.05737962946295738, -0.6119275689125061, -1.0395313501358032, 0.7639025449752808, -0.5355689525604248, -0.3886762857437134, 0.13125649094581604, -0.23054318130016327, -0.09346192330121994, -0.3405052125453949, 1.1859991550445557, -0.24672424793243408, -0.051772069185972214, 0.23199693858623505, 0.5477662682533264, -0.6937393546104431, -0.27842244505882263, 0.7259407043457031, -0.30122971534729004, -0.332265168428421, 0.7167920470237732, 0.9743286371231079, 0.022652603685855865, 0.3321666717529297, -0.40811166167259216, -0.3454298973083496, 0.24676363170146942, 0.06962881237268448, 0.11947836726903915, -0.18567605316638947, -0.4720027446746826, -1.0492892265319824, 1.2088236808776855, -0.12276887148618698, -0.14386995136737823, 0.31291672587394714, -0.6563574075698853, 0.024716688320040703, 0.3509466052055359, -0.3275415003299713, -0.12398933619260788, -1.0450499057769775, 0.2558366656303406, -0.18411922454833984, -0.34964585304260254, 0.20479276776313782, 0.2492387294769287, 0.17915813624858856, 0.3390254080295563, 0.2697853446006775, 0.3539399206638336, -0.32251033186912537, 0.10886895656585693, -0.4791755974292755, 0.39491549134254456, 0.2632143199443817, -0.16316570341587067, -0.6264266967773438, -0.37089550495147705, -0.6194152235984802, -0.37688159942626953, -0.3220694959163666, -0.016327621415257454, 0.05227380990982056, 0.3478667736053467, -0.11401090025901794, -0.8748001456260681, -0.24329251050949097, -1.4854626655578613, 0.08771000802516937, 0.40450212359428406, -0.6192423701286316, 0.25233638286590576, -1.2941826581954956, -1.1463189125061035, -0.3389682173728943, -0.8806650638580322, -1.4232155084609985, 0.49496161937713623, -0.10453946888446808, -0.8126405477523804, -0.28819775581359863, -0.1300869882106781, -0.23634372651576996, 1.4466874599456787, -0.8121631145477295, 1.2540737390518188, -0.3987334668636322, -0.23627087473869324, -0.45463141798973083, 0.25974607467651367, 0.16022276878356934, 0.0055047133937478065, 0.12803326547145844, -0.6589523553848267, 0.2843693792819977, 0.1691005975008011, -0.32510870695114136, 0.21306979656219482, 0.28122735023498535, 0.7381957173347473, -0.12710383534431458, -0.4108814001083374, 0.07210519164800644, 1.1432641744613647, -0.20036007463932037, 0.2752611041069031, 0.649897575378418, 0.8887081146240234, 0.44097083806991577, -0.5064419507980347, 0.393002986907959, 0.6016201972961426, 0.685173511505127, 0.7254592776298523, 0.14943580329418182, -0.2989000082015991, 0.0018591458210721612, 0.4189351797103882, 1.1159027814865112, 0.284523606300354, -0.48000097274780273, -1.279178261756897, 0.3098013997077942, -0.8989716172218323, -0.7095845937728882, 0.4329923391342163, 0.7752374410629272, 0.1901499629020691, -0.5089110732078552, -0.33567070960998535, -0.0663280114531517, 0.8071920871734619, 0.35690343379974365, -0.3880559802055359, -1.0924416780471802, 0.1007259264588356, 0.569100022315979, 0.4870602786540985, 0.4474140405654907, -0.361744225025177, 0.21603378653526306, 14.895160675048828, 0.4481859505176544, -0.23252186179161072, 0.5104449987411499, 0.6100236773490906, 0.28229719400405884, -0.15054596960544586, -0.3898008167743683, -1.54446542263031, -0.016053728759288788, 1.1158497333526611, 0.23213164508342743, 0.4268169105052948, 0.3163314461708069, -0.6760833263397217, 0.3209630250930786, -0.6600731015205383, 0.5741333961486816, 0.8278610706329346, -1.1912134885787964, 0.3291943073272705, 0.33971455693244934, -0.1814296692609787, 0.40800225734710693, 0.9066891074180603, 0.7491628527641296, 0.5586811304092407, -0.35168343782424927, 0.4545421004295349, 0.014262835495173931, 0.5721038579940796, 0.05468105152249336, 0.8382202982902527, 0.14627817273139954, -1.0265191793441772, -0.529644787311554, -0.4893150329589844, -0.9533944725990295, -0.23756681382656097, -0.2430141419172287, -0.7874689102172852, -0.7084894180297852, -0.16161389648914337, 0.37501761317253113, -0.1474931687116623, 0.5960416197776794, -0.36284518241882324, 0.18501318991184235, 0.11643195897340775, -0.24477511644363403, 0.1157861277461052, 1.3149720430374146, 0.24558255076408386, -0.17714977264404297, 0.04410139098763466, -0.44636523723602295, -0.028860803693532944, -0.023689718917012215, -0.6518521308898926, -0.22616124153137207, -0.1710742712020874, -0.16786286234855652, 0.27551791071891785, 0.7951164245605469, 0.6449729800224304, 0.6029550433158875, -0.34450763463974, 0.4174932539463043, 0.4108913540840149, 0.1737789660692215, -0.09463629126548767, -0.2941970229148865, 0.4034092426300049, -0.2517508268356323, 0.15083636343479156, 0.8372170925140381, -0.31333673000335693, -0.4399852156639099, -1.0194079875946045, -0.7015140652656555, 0.9700925350189209, -0.6407276391983032, -0.744484543800354, 1.4452018737792969, -0.19387026131153107, -0.3653721213340759, 0.16315749287605286, -0.8854822516441345, -0.484627366065979, 0.6007177829742432, -1.2919074296951294, -0.4919755160808563, -0.09287135303020477, -0.30203530192375183, -0.0070854779332876205, -0.21317708492279053, 1.301750659942627, 0.07559584826231003, -0.6349033713340759, 0.02329966612160206, -0.39819395542144775, 0.03405025601387024, 0.22816187143325806, -1.1313962936401367, 0.7443941831588745, 0.1180206686258316, -0.3490472435951233, 0.2964150905609131, 0.07431026548147202, 0.17503874003887177, -0.9345040321350098, 0.08791306614875793, 1.0062642097473145, -1.0023155212402344, -0.43288055062294006, -0.5256674885749817, -0.6999438405036926, 0.2067359983921051, 1.216808557510376, -0.5759459733963013, 0.27556470036506653, 0.3305591940879822, -0.7485661506652832, -0.18177908658981323, -0.710426926612854, -0.06852363049983978, 0.2146422117948532, -0.7181525826454163, -0.467582643032074, -0.2194414585828781, 0.22232259809970856, -0.970460832118988, -0.3541865646839142, -0.4813276529312134, 0.004716414958238602, 0.0608387291431427, 0.9853058457374573, -0.38466933369636536, 0.7723707556724548, 0.8250698447227478, -0.25570258498191833, -0.8648022413253784, -0.4052184820175171, -0.6247173547744751, -0.06646870821714401, 0.20840658247470856, 0.7804465889930725, -0.6699084043502808, 0.5331303477287292, 1.3512499332427979, 0.17541246116161346, -0.045275263488292694, -0.5046426057815552, 0.04470472037792206, -0.18000341951847076, -0.29415252804756165, 0.7692390084266663, -0.1919810175895691, 0.035859208554029465, 0.24907347559928894, 0.6299296021461487, 0.2644357979297638, -0.006462465971708298, -0.6412224173545837, 0.23545385897159576, -0.4424733817577362, 0.17029109597206116, -0.7212883234024048, -0.3292780816555023, -1.112691044807434, 0.05420433357357979, -0.6715058088302612, 0.0973052904009819, -1.1049845218658447, -0.5510100722312927, 0.09721880406141281, -0.25880923867225647, 0.488777756690979, 0.4354967772960663, -0.457184761762619, -0.3158523738384247, -0.22208578884601593, -0.7864395976066589, 0.34512677788734436, 0.4846167266368866, -0.9740771055221558, 0.46441221237182617, -0.090619757771492, -0.4684693515300751, 0.14892859756946564, 0.585128128528595, -0.6877422332763672, -0.572446346282959, -1.5460246801376343, 0.19579552114009857, -0.1311379075050354, -0.5031315684318542, -0.8254454135894775, 1.2845396995544434, 0.46671268343925476, -0.17546585202217102, 0.07872527837753296, 0.16696344316005707, -1.1292955875396729, -0.46359869837760925, 0.1870233118534088, -0.9095900058746338, 0.634169340133667, 0.16640853881835938, -1.1026619672775269, -0.4022544324398041, 0.44487082958221436, -0.10969539731740952, -1.0857594013214111, -0.857063889503479, 0.2812988758087158, -0.6223841905593872, 0.18191170692443848, -0.29870808124542236, -0.4091542363166809, -1.4405558109283447, -0.18412460386753082, 0.4004196524620056, 0.32038936018943787, -0.18086262047290802, 0.9227533936500549, 0.1593683660030365, -0.9064860939979553, 0.2473974972963333, 0.2336549013853073, 0.023567499592900276, -0.4073827862739563, 0.1714705228805542, 0.5184144377708435, -0.2920367419719696, 0.8147308826446533, 0.07973510026931763, 0.2461714744567871, -0.9205297231674194, -0.129494309425354, 0.5847637057304382, -0.5183835625648499, 0.3573663532733917, 1.2088946104049683, -0.6389864683151245, -0.6625373959541321, 0.2732408940792084, -1.1576200723648071, -0.816119909286499, 0.0010889862896874547, 0.7949019074440002, 0.22300416231155396, 0.40805065631866455, -0.16314534842967987, -0.8246863484382629, 0.09581149369478226, -0.17683438956737518, -0.24951089918613434, 0.2937699258327484, -0.03779232129454613, -0.7098413705825806, 0.19802595674991608, 0.7588592171669006, -0.833653450012207, -0.18430975079536438, -0.38984379172325134, 0.13964830338954926, 0.013475102372467518, 0.61207515001297, -0.2913699150085449, -0.7917972803115845, 0.857549250125885, 0.3614524006843567, 0.8169393539428711, 0.35378092527389526, -0.2625580132007599, 0.16421067714691162, 0.6271571516990662, 0.19240310788154602, -0.2339722365140915, -0.3777203857898712, 1.5223921537399292, 1.4896314144134521, -0.6544681787490845, 0.12451756745576859, 0.18383273482322693, -0.7475754618644714, 1.276761770248413, 0.7318626642227173, 0.37058648467063904, 0.4720108211040497, 0.20177611708641052, 0.09085839241743088, -0.06375278532505035, -1.2728288173675537, -0.15328432619571686, 0.8708866834640503, 0.9333028197288513, 1.131272315979004, -0.21342913806438446, 0.3411347270011902, 0.4747976064682007, 0.2114281952381134, -0.02441982738673687, 0.5383979082107544, 0.5622765421867371, -0.2503948211669922, -0.4759475588798523, -0.22681523859500885, 0.7041319608688354, -0.8571432828903198, -0.8632937669754028, -0.285215824842453, 0.7697345614433289, 0.10456632822751999, 0.5639691352844238, 0.8151713609695435, -0.21351231634616852, 0.8604577779769897, 0.4468975365161896, 0.0738217905163765, -0.939253032207489, -0.7799986004829407, -0.31836336851119995, -0.3555237948894501, 0.1350037157535553, 0.058921925723552704, -0.7703120112419128, 0.16975344717502594, -0.21846136450767517, 0.3930876553058624, 0.12818990647792816, 0.2969050109386444, 0.48226338624954224, 0.7029761075973511, 0.5932499170303345, -0.4183496832847595, -0.7920523881912231, -0.40694135427474976, -1.1452038288116455, 0.17626915872097015, -0.8606104254722595, -0.28540974855422974, -0.22091399133205414, -0.6497033834457397, -0.44090935587882996]}, "authors": [{"authorId": "72934867", "name": "Jason Brown"}, {"authorId": "2109919449", "name": "Yiren Zhao"}, {"authorId": "47473421", "name": "Ilia Shumailov"}, {"authorId": "2768514", "name": "R. Mullins"}], "references": [{"paperId": "86c8d930b492a4f9cadc6c60aecdaaded49acc86", "title": "Neural Architecture Search on Efficient Transformers and Beyond"}, {"paperId": "c49ac1f916d6d2edeb187e6619c8d23acd95eb21", "title": "cosFormer: Rethinking Softmax in Attention"}, {"paperId": "255c526f78bbfec35d4ed73b6dd8eacd9ef2c0b3", "title": "RankNAS: Efficient Neural Architecture Search by Pairwise Ranking"}, {"paperId": "958cc02ad685721d64e6321aa93e3125884ed253", "title": "Rethinking Architecture Selection in Differentiable NAS"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "3fbf6339273c50b04e886fa9bd4ad18c952a683d", "title": "Rethinking Attention with Performers"}, {"paperId": "7e5709d81558d3ef4265de29ea75931afeb1f2dd", "title": "Efficient Transformers: A Survey"}, {"paperId": "ffb0bbe26f1cbc0ab22ef34784248f2dcd3a5e5c", "title": "Finding Fast Transformers: One-Shot Neural Architecture Search by Component Composition"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "e3794413679237f7a9a2f7e03eb7ea2ccac0ae93", "title": "Synthesizer: Rethinking Self-Attention for Transformer Models"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "34a4e6818d680875ff0bef9a76de0376118446d1", "title": "Sparse Sinkhorn Attention"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "4ebce2425e231031f89a4a68dc52a151cd735d03", "title": "PC-DARTS: Partial Channel Connections for Memory-Efficient Architecture Search"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "512b8ef0002e0bfd0ecb5ab17d533c1762eb9786", "title": "Set Transformer"}, {"paperId": "c1f457e31b611da727f9aef76c283a18157dfa83", "title": "DARTS: Differentiable Architecture Search"}, {"paperId": "8691706ad0cf5e83969658b2e6bfffdc379440c9", "title": "Generating Wikipedia by Summarizing Long Sequences"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Advances in neural information processing systems"}]}