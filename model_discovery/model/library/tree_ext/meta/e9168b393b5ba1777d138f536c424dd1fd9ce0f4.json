{"paperId": "e9168b393b5ba1777d138f536c424dd1fd9ce0f4", "title": "An All-MLP Sequence Modeling Architecture That Excels at Copying", "abstract": "Recent work demonstrated Transformers' ability to efficiently copy strings of exponential sizes, distinguishing them from other architectures. We present the Causal Relation Network (CausalRN), an all-MLP sequence modeling architecture that can match Transformers on the copying task. Extending Relation Networks (RNs), we implemented key innovations to support autoregressive sequence modeling while maintaining computational feasibility. We discovered that exponentially-activated RNs are reducible to linear time complexity, and pre-activation normalization induces an infinitely growing memory pool, similar to a KV cache. In ablation study, we found both exponential activation and pre-activation normalization are indispensable for Transformer-level copying. Our findings provide new insights into what actually constitutes strong in-context retrieval.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "The Causal Relation Network (CausalRN), an all-MLP sequence modeling architecture that can match Transformers on the copying task is presented, and it is found both exponential activation and pre-activation normalization are indispensable for Transformer-level copying."}, "embedding": {"model": "specter_v2", "vector": [0.4744374752044678, 0.3449559211730957, -0.564494252204895, 0.02451593242585659, -0.018705034628510475, -0.524840235710144, 0.5219866633415222, 0.20604267716407776, -0.7643246054649353, -0.076433464884758, 0.7276382446289062, -0.493071973323822, 0.32108476758003235, -0.10718052834272385, -0.1814032644033432, -0.0727645754814148, -1.055092692375183, 0.03175801411271095, 0.3473691940307617, -0.18025125563144684, 0.50425785779953, 0.039234600961208344, -1.3533880710601807, 0.46976014971733093, -0.09990577399730682, 0.5266183018684387, -0.0743068978190422, 0.798012375831604, -0.4949001371860504, 0.7935352325439453, 0.31263020634651184, -0.35804829001426697, 0.1591659039258957, 0.2644755244255066, -0.4734991490840912, -0.8597251772880554, 0.2082493007183075, -0.4131614863872528, -0.6910884380340576, 0.26222479343414307, -0.125740185379982, 0.19787569344043732, 0.3068681061267853, -0.43610209226608276, -0.19779442250728607, 1.1157286167144775, 0.7605866193771362, 0.942136824131012, -0.23596419394016266, -0.5082393884658813, 1.3299874067306519, -1.1367266178131104, 0.386761337518692, 0.9945855140686035, 0.46807533502578735, 0.3558328151702881, 0.01650494523346424, -0.5328069925308228, 0.7927404642105103, 0.06590109318494797, -0.866113543510437, -0.5394542217254639, -0.0687209740281105, 0.20152521133422852, 1.9748800992965698, -0.1273326277732849, 0.3431662321090698, 0.45392999053001404, 0.1007908508181572, 1.1126034259796143, 0.025938913226127625, -0.916561484336853, 0.10633299499750137, -0.05617725849151611, 0.6000184416770935, 0.6446112990379333, -0.4067791998386383, 0.5291770100593567, -0.9247093796730042, -0.49866577982902527, 0.9139329195022583, 0.0293694157153368, -0.15929833054542542, -0.2828047573566437, -0.18673214316368103, 0.3919398784637451, 0.26482412219047546, 1.0785375833511353, -0.32096290588378906, 0.8583719730377197, 0.3372891843318939, 0.5020340085029602, -0.16849711537361145, 0.5417696833610535, 0.20500661432743073, -0.23864416778087616, -0.5889195203781128, -0.1799944043159485, -0.09711901843547821, 0.9489970207214355, -0.5862224698066711, 0.45595118403434753, -0.3972313702106476, 0.328382283449173, 1.0490506887435913, -0.43027782440185547, 0.5671334862709045, -0.9851119518280029, -0.16440175473690033, -0.24235382676124573, 0.4417603313922882, -0.4223002791404724, -0.1649850606918335, -0.45222702622413635, -0.7278249859809875, -1.2705892324447632, -0.600192666053772, 0.5559658408164978, -0.38249969482421875, 0.5340859889984131, -0.45396167039871216, 0.5016753077507019, -0.1254005879163742, 0.18731307983398438, 0.340993195772171, 0.381120502948761, 0.563612163066864, -0.4480855464935303, 0.9673645496368408, -0.4102596938610077, -0.5389489531517029, -0.8472235798835754, 0.8297376036643982, 0.13445062935352325, 0.09909401088953018, -0.45106711983680725, -1.15933096408844, -0.8751252293586731, -0.8946537971496582, 0.31178489327430725, -0.22913560271263123, -0.41898006200790405, 1.165597915649414, 0.32396388053894043, -1.4063341617584229, 1.038341760635376, -0.2898544371128082, -0.2977316975593567, 0.3342849612236023, 0.33988088369369507, 0.2292405515909195, -0.2952311635017395, -1.045562982559204, 0.19936494529247284, 0.25495412945747375, -0.2795621454715729, -0.2686122953891754, -0.7158501148223877, -0.7787337303161621, 0.09235889464616776, 0.5327759385108948, -0.6611213088035583, 1.363808035850525, 0.12520287930965424, -0.9979060292243958, 0.6753036379814148, -0.24048413336277008, 0.016369687393307686, 0.12765760719776154, -0.21422043442726135, -0.6532891988754272, -0.20348843932151794, -0.6884167790412903, 0.31279274821281433, 0.5906983613967896, -0.6914076805114746, -0.21484321355819702, -0.2733558714389801, -0.2837063670158386, -0.049928147345781326, -0.3538070619106293, 0.8797697424888611, -0.49277463555336, -0.2996719479560852, 0.3224320709705353, 0.6179119348526001, -0.2216314822435379, -0.014478632248938084, 0.05915983021259308, -0.8760789036750793, 0.32367923855781555, 0.1847086399793625, 1.7493458986282349, -0.8790943026542664, -0.6358240246772766, -0.07775405049324036, -0.143597811460495, -0.20726899802684784, -0.6402983069419861, 0.7089056372642517, -0.5369701981544495, 0.7189233899116516, -0.3849226236343384, -0.553170382976532, -0.717924177646637, 0.02597946487367153, -1.1298589706420898, -0.4754880964756012, -0.2688746750354767, 0.9986515045166016, -1.0991069078445435, 0.003488843562081456, -0.16152213513851166, 0.1946939378976822, -0.44991809129714966, 1.4161101579666138, -0.3448019325733185, -0.05355701223015785, -0.1787773072719574, -0.3514675498008728, -0.3440631926059723, -0.41853123903274536, 0.7717613577842712, -0.2354133427143097, -0.14822550117969513, 0.2753932774066925, -0.26284825801849365, 1.1080130338668823, -0.31343314051628113, 0.279020756483078, -0.08748803287744522, -0.37314003705978394, 0.2354516088962555, 0.4797426164150238, -0.07631897181272507, -0.33246320486068726, 0.2469790279865265, 0.25092440843582153, -0.47106578946113586, 0.24065513908863068, 0.9322370290756226, 0.8873780965805054, -0.24073122441768646, 0.4411843717098236, 0.08715008944272995, -0.2317080795764923, -0.034547168761491776, 0.5043524503707886, 0.8981284499168396, 0.3274424076080322, 0.6521046161651611, 0.03088918700814247, 0.18133217096328735, -0.8576379418373108, 0.06492230296134949, 0.7132905125617981, 1.0573081970214844, 0.5324974656105042, 0.34640249609947205, -0.7465561628341675, -0.5220287442207336, 0.2761436104774475, 0.41262930631637573, 1.3849380016326904, -0.2033948302268982, -0.3356981575489044, -0.5648767948150635, -0.023031041026115417, -0.40972787141799927, 0.5992259383201599, -0.41673368215560913, -0.34226784110069275, -1.1406030654907227, -0.5843157172203064, 0.9727756381034851, 0.8604100942611694, 0.8080275058746338, -0.8629248142242432, -0.5549097657203674, -0.08870041370391846, 0.3800174593925476, -0.43069446086883545, -0.341203898191452, 0.20769034326076508, -1.26973557472229, -0.014516567811369896, 0.20706531405448914, -0.1710202693939209, 0.11142481863498688, -0.4835842549800873, 1.2208271026611328, 0.3719698190689087, -0.29601234197616577, 0.5592460036277771, 0.8230130076408386, -0.35427844524383545, -0.7851904034614563, 0.12799452245235443, 0.014154903590679169, -0.5415145754814148, 0.2635861933231354, 0.14299042522907257, -0.24286247789859772, 0.17767295241355896, -0.46637171506881714, -0.1946508139371872, 0.23159149289131165, 0.018737945705652237, 0.3449077308177948, -0.46715137362480164, 0.03638028725981712, -1.0916969776153564, 0.9025096297264099, 0.2421255260705948, -0.5431584119796753, 0.395363450050354, -0.96163010597229, -0.25056084990501404, 0.20183975994586945, -0.5219290852546692, -0.12724903225898743, -1.0156359672546387, 0.18458589911460876, -0.24064317345619202, -0.13031114637851715, 0.1801895797252655, 0.41180938482284546, 0.19995439052581787, 0.04250411316752434, 0.8284724354743958, 0.37384751439094543, 0.0016104396199807525, 0.6740300059318542, -0.6841439604759216, 0.7087883949279785, 0.09928049147129059, -0.10414298623800278, -0.105902299284935, -0.1843114048242569, -0.7272131443023682, 0.23033609986305237, -0.13371682167053223, -0.3831663429737091, -0.2337159812450409, -0.12185348570346832, -0.3876585364341736, -1.1635406017303467, 0.11137848347425461, -1.1568394899368286, -0.5504387617111206, 0.10440321266651154, -0.5170467495918274, -0.024327995255589485, -0.8319923281669617, -1.468737244606018, -0.9661579132080078, -0.4015010595321655, -0.5910795331001282, 0.06048130616545677, -0.2515924870967865, -0.5125027894973755, -0.22111770510673523, 0.11808638274669647, -0.8474618792533875, 1.0575268268585205, -1.1311264038085938, 1.0486873388290405, 0.03324742987751961, -0.6936558485031128, 0.01577621139585972, 0.3794077932834625, 0.018288949504494667, -0.26147982478141785, 0.20368847250938416, -0.7298396825790405, 0.31947165727615356, -0.1703689843416214, 0.08586540073156357, 0.17258810997009277, 0.1159122884273529, 1.288455843925476, -0.10113426297903061, -0.8577351570129395, -0.17139488458633423, 1.2035479545593262, -0.029566863551735878, 0.6589983701705933, 0.07567895203828812, 0.7074319124221802, 0.38674840331077576, -0.13092926144599915, 0.5304632186889648, -0.13457073271274567, 0.7445954084396362, 0.1981040984392166, 0.18725568056106567, 0.29640594124794006, -0.23085322976112366, 0.1198955625295639, 1.3507994413375854, -0.15003758668899536, 0.017510564997792244, -0.8524365425109863, 0.5170138478279114, -1.1760083436965942, -0.8639608025550842, 0.7354146242141724, 1.029740333557129, 0.4554509222507477, -0.4794858992099762, -0.2008579969406128, -0.19743159413337708, 0.3275949954986572, 0.22695507109165192, -0.31933340430259705, -0.3985002338886261, 0.13442303240299225, 0.4823227524757385, 0.19030404090881348, 0.6033371090888977, 0.09891300648450851, 0.46685072779655457, 15.268134117126465, 0.4609107971191406, 0.004657999146729708, 0.3945404887199402, 0.6726672649383545, 0.15752065181732178, -0.7309654951095581, -0.0033705171663314104, -1.0091509819030762, -0.047626808285713196, 1.4237922430038452, 0.22798487544059753, 0.5414375066757202, 0.20495079457759857, -0.35720205307006836, 0.32148414850234985, -0.6598331332206726, 0.5251778364181519, 0.16609899699687958, -1.6620651483535767, 0.4416685104370117, 0.38261041045188904, -0.31583163142204285, 0.16920192539691925, 0.7232937812805176, 0.6317298412322998, 0.8608144521713257, -0.5632753968238831, 0.36839041113853455, 0.4742875397205353, 0.9363110661506653, -0.20059488713741302, 0.3393510580062866, 0.16935500502586365, -0.7758166790008545, -0.5103626251220703, -0.5476506948471069, -0.737680971622467, 0.39705145359039307, -0.10921166837215424, -0.6587947607040405, -0.5955979824066162, -0.13024525344371796, 0.5429345965385437, 0.37008199095726013, 0.2009032815694809, -0.29550716280937195, 0.6936660408973694, -0.040494222193956375, 0.09587009251117706, -0.2576697766780853, 0.3382941484451294, -0.13483229279518127, -0.2226245105266571, 0.037469591945409775, 0.6732222437858582, -0.39451152086257935, 0.025272449478507042, -0.6629245281219482, -0.0139780193567276, -0.686011552810669, -0.3045681416988373, 0.673741340637207, 0.44646748900413513, 0.6270131468772888, 0.04438977316021919, -0.0009264575783163309, 0.28558647632598877, 0.5914422273635864, 0.12364911288022995, -0.09079140424728394, 0.15252825617790222, 0.2251807004213333, -0.21400269865989685, -0.012928110547363758, 0.5160126686096191, -0.30144616961479187, -0.21536023914813995, -0.8798570036888123, -0.3851568400859833, 0.6628899574279785, -1.0142178535461426, -0.6626232266426086, 1.1552327871322632, -0.1176917552947998, -0.5454480648040771, 0.18306510150432587, -0.449481725692749, -0.13971476256847382, 0.0304116141051054, -0.923524022102356, -0.4136385917663574, -0.1827317625284195, -0.17962417006492615, -0.5353941321372986, 0.16332970559597015, 1.3673831224441528, -0.17476226389408112, -0.32194390892982483, -0.12269225716590881, -0.04081655293703079, -0.051632918417453766, -0.13089346885681152, -0.5456413626670837, 0.5945383310317993, -0.025266457349061966, 0.032594189047813416, 1.0784498453140259, -0.2593364417552948, 0.058293525129556656, -0.5562839508056641, 0.12507037818431854, 0.41568440198898315, -0.9848799109458923, -0.4210117757320404, -0.7376770377159119, -1.4945193529129028, 0.7397528290748596, 0.6964767575263977, -0.30428367853164673, 0.44491708278656006, 0.07304701954126358, -0.591049075126648, -0.29793035984039307, -0.5679559707641602, 0.5201866626739502, 1.2645684480667114, -0.8675118088722229, -0.49755924940109253, -0.5469961762428284, 0.7485321164131165, -0.6318469643592834, -0.9670663475990295, -0.17709709703922272, 0.19247089326381683, -0.08448142558336258, 0.9592275619506836, -0.6812746524810791, 0.584632158279419, 0.7508659362792969, 0.10044486075639725, -0.47324052453041077, -0.2921041250228882, -0.7738842368125916, -0.21161223948001862, 0.2716584801673889, 0.5232046842575073, -0.7308158874511719, 0.4338876008987427, 1.0412262678146362, 0.07172049582004547, -0.27531614899635315, -0.6897193193435669, -0.062183625996112823, -0.11601056903600693, -0.5219653844833374, 0.513471245765686, 0.19130773842334747, -0.029051002115011215, 0.147504985332489, 0.4776758551597595, 0.4324999749660492, -0.3522486686706543, -0.5405448079109192, 0.08619718998670578, -0.3471953868865967, -0.06317219883203506, -0.6359281539916992, -0.37418290972709656, -1.3943125009536743, -0.14080949127674103, -0.9534592032432556, 0.04419336095452309, -0.8519294261932373, -0.48559561371803284, -0.1965624839067459, -0.2933385670185089, 0.08453775942325592, 0.4689096510410309, -0.8643272519111633, -0.7076842784881592, 0.04116993770003319, -0.2932778596878052, 0.5307943820953369, 0.2309589684009552, -0.4987543523311615, 0.20936432480812073, -0.140611469745636, -0.0505862757563591, -0.10767534375190735, 0.5054717659950256, -0.7114596366882324, -0.9209258556365967, -0.9556214213371277, 0.23739013075828552, 0.16158689558506012, -0.22989647090435028, -0.23888282477855682, 0.7432907223701477, 0.5596210360527039, -0.13610564172267914, -0.2619495391845703, 0.4203212857246399, -0.9864102005958557, 0.07672405242919922, 0.42106762528419495, -1.0370579957962036, 0.465705931186676, 0.4346429705619812, -0.17564162611961365, 0.08245681971311569, 0.521657407283783, -0.1912015676498413, -1.1722211837768555, -0.9523637294769287, 0.0864190012216568, -1.0670660734176636, -0.11320742219686508, -0.035824280232191086, -0.2887149453163147, -1.4588733911514282, -0.2175377905368805, 0.003967624623328447, 0.10188900679349899, -0.08888477832078934, 0.8713681697845459, 0.7134627103805542, -0.7389101982116699, 0.30616411566734314, 0.10849230736494064, -0.07330439239740372, -0.0024472542572766542, 0.5709467530250549, 0.27547094225883484, -0.13436581194400787, 0.48553267121315, 0.18787702918052673, 0.2161397486925125, -1.2762819528579712, 0.329253613948822, 0.48669639229774475, -0.44269779324531555, -0.10181741416454315, 0.9291132092475891, -0.5574666261672974, -0.8489238023757935, 0.12767206132411957, -1.155539870262146, -0.8773098587989807, -0.4292607307434082, 0.6380175352096558, 0.10961782932281494, -0.1141357347369194, 0.3730328679084778, -0.5305253267288208, 0.2749587595462799, -0.34088775515556335, -0.49962422251701355, 0.5799643993377686, 0.10821305960416794, -0.7555191516876221, 0.6313402652740479, 0.43566596508026123, -0.4568333327770233, -0.250175803899765, -0.6995000243186951, 0.11462082713842392, -0.2886408865451813, 0.15039899945259094, -0.1545720249414444, -0.40578457713127136, 0.566830039024353, 0.5427826642990112, 0.03641003370285034, -0.10033503919839859, -0.1251530647277832, -0.23430316150188446, 0.6330181956291199, 0.49366629123687744, -0.2327824831008911, -0.08190678060054779, 0.767795205116272, 1.5225348472595215, -0.18758857250213623, 0.5746590495109558, -0.2650623619556427, -0.5976046323776245, 1.0694663524627686, 0.6335533857345581, 0.18453551828861237, 0.7485104203224182, 0.06629679352045059, 0.2578182518482208, -0.09569428116083145, -1.2264432907104492, 0.3216911852359772, 0.06341955065727234, 1.1130388975143433, 0.8022260069847107, -0.11915372312068939, 0.19082696735858917, 0.5689260959625244, 0.4126412570476532, 0.6119248867034912, 0.6641324162483215, 1.0560139417648315, -0.2353261113166809, -0.1210942342877388, 0.23074795305728912, 0.6532185077667236, -0.39378660917282104, -0.9053134918212891, 0.0352150984108448, 0.7327153086662292, -0.5417566895484924, 0.402252197265625, 1.2343666553497314, -0.058779217302799225, 0.6595311760902405, 0.3082555830478668, 0.4667772948741913, -0.4754393696784973, -0.7867379784584045, -0.30994713306427, -0.2439742386341095, -0.36532068252563477, -0.15384520590305328, -0.4361858367919922, -0.46496617794036865, -0.20255719125270844, 0.365588903427124, 0.18857862055301666, -0.08050443977117538, 0.540355384349823, 1.0352720022201538, 0.3377247452735901, -0.421082079410553, -0.002289355266839266, -0.7748275399208069, -0.876273512840271, 0.07157549262046814, -0.8095879554748535, -0.5359064936637878, -0.1170189306139946, -0.07318174093961716, -0.47804102301597595]}, "authors": [{"authorId": "2308033781", "name": "Chenwei Cui"}, {"authorId": "2308073503", "name": "Zehao Yan"}, {"authorId": "2047973426", "name": "Gedeon Muhawenayo"}, {"authorId": "2308032411", "name": "Hannah Kerner"}], "references": [{"paperId": "ffea74c90f92eca449356b7bf83dc38cb11c6131", "title": "RNNs are not Transformers (Yet): The Key Bottleneck on In-context Retrieval"}, {"paperId": "189fde3f4dfa105bb51472a8945618f395919560", "title": "Repeat After Me: Transformers are Better than State Space Models at Copying"}, {"paperId": "7bbc7595196a0606a07506c4fb1473e5e87f6082", "title": "Mamba: Linear-Time Sequence Modeling with Selective State Spaces"}, {"paperId": "f680d47a51a0e470fcb228bf0110c026535ead1b", "title": "Progress measures for grokking via mechanistic interpretability"}, {"paperId": "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51", "title": "Efficiently Modeling Long Sequences with Structured State Spaces"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "3c8a456509e6c0805354bd40a35e3f2dbf8069b1", "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "007112213ece771be72cbecfd59f048209facabd", "title": "A simple neural network module for relational reasoning"}, {"paperId": "a456265138c088a894301c0433dae938705a9bec", "title": "Deep Sets"}, {"paperId": "97fb4e3d45bb098e27e0071448b6152217bd35a5", "title": "Layer Normalization"}, {"paperId": "2e9d221c206e9503ceb452302d68d10e293f2a10", "title": "Long Short-Term Memory"}, {"paperId": "339b5d3316d13062d936b335aab06e9da48a5c17", "title": "The Deep Bootstrap Framework: Good Online Learners are Good Offline Generalizers"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": "5d90f06bb70a0a3dced62413346235c02b1aa086", "title": "Learning Multiple Layers of Features from Tiny Images"}, {"paperId": null, "title": "The perceptron\u2013a perceiving and recognizing automation"}, {"paperId": null, "title": "5: Code snippets for implementing numerically stable Linear BiRNs and Linear CausalRNs 7"}]}