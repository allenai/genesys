{"paperId": "d73322e79318190f04746f2f53260190757bc5db", "title": "Sequential Modelling for Medical Image Segmentation", "abstract": "An image can be seen as a long sequence of tokens with spatial structure hence an image segmentation task can be treated as a sequence-to-sequence task. Existing attention-based segmentation models have incorporated an up-sampling module at the pixel decoder, such design assumed the backbone to have multiple feature scales. Furthermore, the existing models did not emphasize the ability of sequential modelling for multi-tasking. In this paper, we propose to model image segmentation task as a long sequence prediction task with an improvisation on MegaByte. As MegaByte efficiently reduced the self-attention cost using multi-scale structure known as global and local models, we train two MegaByte models as an encoder and decoder for multi-tasking. Our multi-task model allows different segmentation tasks to be trained simultaneously and inferenced with a task prompt. The encoder takes in the image sequence to encode them as a key while the decoder takes in the conditional input as a query. As decoder conditional input is usually sparser than the image, we use a relatively shallow decoder. We demonstrate our method on segmentation of intracranial haemorrhages from computed tomography (CT) head scans and show comparable performance to existing models. On a brain tissue segmentation task on CT images, our method outperformed the existing methods especially on tiny structure. Clinical relevance CT images are the first line of head scans when stroke or haemorrhage is suspected. Segmentation of intracranial haemorrhages (ICH) can provide clinicians with important measures of brain lesions to decide on treatment procedure or surgical decision. Brain and tissue volumes are indicative of neurodegenerative diseases. The proposed techniques can be used to segment ICH and brain tissues from CT head scans.", "venue": "bioRxiv", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://www.biorxiv.org/content/biorxiv/early/2023/11/03/2023.11.01.565075.full.pdf", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "This paper proposes to model image segmentation task as a long sequence prediction task with an improvisation on MegaByte as MegaByte efficiently reduced the self-attention cost using multi-scale structure known as global and local models."}, "embedding": {"model": "specter_v2", "vector": [0.4978265166282654, 0.9108672738075256, -0.06335759907960892, -0.3040858209133148, -0.962061882019043, 0.5425277352333069, 0.18887141346931458, -0.37810218334198, -0.3934318721294403, -0.2811925411224365, 0.4068259596824646, 0.6532180309295654, 0.4343976676464081, 0.39813709259033203, 0.04480624571442604, 0.09487362205982208, -1.0904970169067383, 0.4207029640674591, 0.805564284324646, 0.22253867983818054, -0.07304873317480087, -0.9149495363235474, -1.0630086660385132, 0.5775176286697388, 0.31851470470428467, 0.6921064853668213, 0.7912458777427673, 0.8628273606300354, -0.18952098488807678, 0.18518683314323425, 0.325797438621521, -0.13543550670146942, 0.4952322244644165, -0.3360530138015747, -0.8694179654121399, 0.20121927559375763, 0.6932746171951294, -0.13096792995929718, -0.3129488229751587, 0.6966622471809387, -0.1220555305480957, 0.42279693484306335, 0.7462822198867798, -0.3986685276031494, 0.2678421437740326, 0.587715208530426, 0.2895183265209198, 1.161015272140503, -0.3670639097690582, -1.1755199432373047, 1.411637783050537, -0.8702012300491333, 0.5901057720184326, 1.698168396949768, 0.44281238317489624, 0.4792197048664093, -0.17853425443172455, -0.3900538682937622, 0.46272706985473633, 0.6251860857009888, -0.5554197430610657, -0.07498425245285034, -0.3474065661430359, -0.5293537974357605, 1.6804258823394775, -0.10393451899290085, 0.27686190605163574, 0.40535250306129456, 0.6892904043197632, 1.9582362174987793, -0.002069148002192378, -0.46998319029808044, -0.27374061942100525, -0.23659302294254303, 0.4603666365146637, 0.8483161330223083, -0.5226927399635315, 0.24830938875675201, -0.8546140789985657, 0.07787207514047623, 0.7306513786315918, 0.013664300553500652, 0.5086657404899597, -0.09247312694787979, -0.17945948243141174, 0.446236252784729, 0.6314630508422852, 0.8671754002571106, -0.36556142568588257, 0.4032169282436371, 0.5497055649757385, -0.00315338047221303, -0.1728476881980896, 0.2870238423347473, 0.09637598693370819, 0.8893457651138306, -1.289642572402954, -0.04077327623963356, -0.15529011189937592, 0.8502228856086731, -0.24764768779277802, -0.048104461282491684, -1.1284310817718506, 0.2713419795036316, 1.185450553894043, -0.48771652579307556, 0.9363661408424377, -0.6428527235984802, 0.11781563609838486, -0.899354875087738, 0.107029028236866, -0.7253260016441345, -0.5898630023002625, -0.1782599538564682, -0.6672038435935974, -0.9345678091049194, -0.09942394495010376, 0.23317015171051025, -1.365085482597351, 0.26301297545433044, -0.06491772830486298, 0.2831503748893738, -0.42840269207954407, 0.6649825572967529, 0.06855783611536026, 0.5476445555686951, 0.6434047222137451, 0.21891306340694427, 1.384293794631958, -1.1606301069259644, -0.3937080502510071, -0.6448966264724731, -0.190349742770195, -0.0834747925400734, -0.16604992747306824, -0.2988724112510681, -1.253875732421875, -1.3384729623794556, -0.5404735207557678, -0.10010358691215515, -0.5053081512451172, -0.22071509063243866, 0.7703829407691956, 0.09331297129392624, -0.844440758228302, 0.9661787152290344, -0.5041860342025757, -0.4219055771827698, 0.8890312314033508, -0.04909907281398773, 0.5749772191047668, 0.42500174045562744, -1.3895593881607056, 0.3876912295818329, 0.12085115909576416, -0.7292299866676331, -0.4716491997241974, -0.24165228009223938, -0.7837868332862854, -0.027594665065407753, 0.3670383095741272, -0.5522006750106812, 1.0548923015594482, -0.6123776435852051, -0.8596121072769165, 0.8368332386016846, -0.6004088521003723, -0.5743721127510071, 0.49692201614379883, -0.10800249874591827, -0.21943117678165436, 0.31238043308258057, 0.20854532718658447, 0.7736097574234009, 0.7624063491821289, -0.3074681758880615, -0.6915052533149719, -0.16177181899547577, -0.6465799808502197, 0.0758533701300621, 0.1398993581533432, 0.8733518123626709, -0.4559403657913208, -0.6614949107170105, 0.6376729607582092, 0.7437173128128052, -0.40873223543167114, -0.2830706238746643, -0.38122326135635376, -0.9102697372436523, 0.6433258056640625, -0.1117924302816391, 0.4974585473537445, -0.6985393762588501, -0.6147381067276001, -0.1370929628610611, -0.0057129207998514175, -0.3066701292991638, -0.860078752040863, 0.06129681318998337, -0.2365628331899643, 0.6881742477416992, -0.36718595027923584, -0.768043041229248, -0.18108810484409332, -0.2666871249675751, -0.35789239406585693, -0.26576974987983704, 0.1765158474445343, 1.3723093271255493, -0.6144278645515442, -0.5962609052658081, -0.03575768321752548, -0.12889477610588074, -0.5913187265396118, 1.0071313381195068, -0.3327311873435974, 0.22467391192913055, -0.42303770780563354, -0.09904424846172333, -0.3190069794654846, -0.09524346888065338, 0.14719988405704498, -0.5809190273284912, 0.02355322241783142, 0.08835908025503159, -0.23191989958286285, 1.1876012086868286, 0.1464189738035202, 0.3092743754386902, -0.13971729576587677, -1.0178221464157104, -0.23637421429157257, 0.735874354839325, 0.2477959245443344, -0.7552686929702759, 0.29002946615219116, -0.0928441509604454, -0.8067718148231506, -0.2991587519645691, 0.6471272110939026, 0.7935605645179749, -0.43349698185920715, 0.19907671213150024, 0.5158185362815857, -0.4710250198841095, 0.4274577796459198, 0.37452998757362366, 0.37123963236808777, 0.35201600193977356, 0.4946869909763336, -0.5138662457466125, -0.0023016673512756824, -0.8146477937698364, 0.3803783655166626, 0.9657982587814331, 0.05594370514154434, 1.2525235414505005, 0.48550936579704285, -1.0034101009368896, -0.7906273603439331, 0.31702014803886414, 0.5639652609825134, 1.4648338556289673, -0.0034328880719840527, 0.23583057522773743, -1.172542929649353, -0.7692589163780212, -0.429291307926178, -0.42025986313819885, -1.0217506885528564, 0.1362403929233551, -0.3862607181072235, -1.2280317544937134, 0.6364351511001587, 0.4308023750782013, 1.0607967376708984, -0.929212212562561, -0.7436074018478394, 0.2596586048603058, 0.10780605673789978, -0.5993070006370544, -0.913652777671814, 0.4665747582912445, -0.3103976249694824, -0.4073009788990021, -0.24881090223789215, -0.47987377643585205, 0.0361558273434639, -0.48453831672668457, 0.7234817743301392, -0.471186101436615, -1.1411606073379517, 0.10235253721475601, 0.4635236859321594, -0.9143707752227783, -0.3954448103904724, 0.2751307189464569, -0.3549667298793793, 0.1296229511499405, 0.20249836146831512, 0.47694477438926697, -0.3644533157348633, 0.3351387679576874, -0.4584641754627228, 0.3053383529186249, 0.38345029950141907, 0.21574759483337402, 1.0471465587615967, -0.20047636330127716, 0.40428274869918823, -1.2941166162490845, 0.602516233921051, 0.11871965229511261, -0.23087358474731445, 0.3890606164932251, -0.06105193868279457, -0.33237138390541077, 0.40788567066192627, -0.5364091396331787, -0.44863927364349365, -0.49734655022621155, 0.38321757316589355, -0.4237520098686218, -0.5388972163200378, 0.13325165212154388, 0.740344226360321, -0.03427491337060928, 0.4739058315753937, 0.34942272305488586, 0.3287791609764099, 0.09188481420278549, 0.239658385515213, -0.727306604385376, 0.5699508786201477, 0.1975741982460022, -0.19646380841732025, 0.4345521032810211, -0.09276711195707321, -1.0281742811203003, -0.5503109693527222, -0.9868890047073364, -0.9591633081436157, -0.3938848376274109, 0.80600905418396, -0.06769508868455887, -0.6235941648483276, 0.13699384033679962, -0.6573492288589478, -0.5267812609672546, 0.11262685060501099, -0.4225480854511261, -0.6101388931274414, -0.6816522479057312, -1.1030908823013306, -0.39029306173324585, -0.6765891909599304, -1.0331223011016846, 0.5703771710395813, 0.11176012456417084, -0.4923381805419922, -0.19978126883506775, -0.5220996737480164, -0.09901296347379684, 0.8661526441574097, -0.16963918507099152, 0.48693522810935974, -0.2978708744049072, -0.27731743454933167, -0.31246641278266907, -0.04609479010105133, 0.31562772393226624, 0.16892187297344208, -0.11789558827877045, -0.3370899558067322, 0.25123876333236694, 0.21667806804180145, -0.3062480688095093, 0.45815610885620117, 0.7848712205886841, 1.2375093698501587, 0.34228023886680603, -0.49058935046195984, 0.05387194827198982, 1.3524302244186401, -0.41673168540000916, 0.16744667291641235, -0.1761409342288971, 0.8184688687324524, 0.3802797794342041, -0.11938238143920898, 0.2642372250556946, 0.43795669078826904, 0.3655359745025635, 0.08146904408931732, -0.30988243222236633, -0.6325774192810059, 0.07220956683158875, -0.37308990955352783, 0.9074057936668396, 0.18090616166591644, 0.5526048541069031, -1.2711122035980225, 1.0402631759643555, -1.3606302738189697, -1.0309268236160278, 0.5977221727371216, 0.4086344242095947, 0.37621477246284485, -0.31623220443725586, 0.05742849409580231, -0.572012722492218, 0.5802218317985535, 0.15503613650798798, -0.39204803109169006, -0.08369961380958557, 0.2648678123950958, 0.5348379015922546, 0.10086371749639511, 0.9480468034744263, -0.90944504737854, 0.7518514394760132, 14.820113182067871, 0.9135338068008423, -0.1346236765384674, 0.6442564129829407, 1.1966683864593506, 0.4318030774593353, 0.1718178391456604, -0.3618042469024658, -1.2235639095306396, 0.25462600588798523, 1.0081942081451416, 0.4430304169654846, 0.3034118711948395, 0.13413025438785553, 0.23310372233390808, -0.045143019407987595, -0.25595831871032715, 0.47248438000679016, 0.6384515762329102, -0.9653422832489014, 0.4312501847743988, -0.13038702309131622, 0.3671480715274811, 0.5554214119911194, 0.4224649965763092, 0.3123290538787842, 0.39206722378730774, -0.31748947501182556, 0.6296432614326477, 0.4493216574192047, 0.5286282896995544, 0.19363391399383545, 0.12462729960680008, 0.15576960146427155, -1.140390157699585, -0.2898116111755371, -0.6558460593223572, -0.326955646276474, 0.44546401500701904, -0.2235807627439499, -0.5688761472702026, -0.2504394054412842, 0.15032102167606354, 0.18932805955410004, 0.021343223750591278, 0.7340936660766602, 0.06499991565942764, 0.5131292939186096, 0.1788637936115265, -0.09177491068840027, 0.57340407371521, 0.61800616979599, 0.4472372233867645, 0.2903720736503601, -0.4183710217475891, 0.5140737891197205, 0.5587275624275208, 0.030098512768745422, -0.0234389565885067, -0.24310046434402466, 0.27229270339012146, 0.6158546209335327, -0.35075101256370544, 0.8874536156654358, -0.15203304588794708, -0.2707650065422058, -0.25137385725975037, 0.512634813785553, 0.3500255048274994, -0.06151093170046806, -0.3847660422325134, -0.3243602216243744, -0.1103440374135971, -0.4569064676761627, 0.29754164814949036, 0.5448024272918701, -0.6061002016067505, -0.2974816560745239, -0.9135228991508484, -0.06850734353065491, 0.7003354430198669, -0.6742663383483887, -0.8519166111946106, 1.3700212240219116, -0.032543811947107315, -0.08854228258132935, 0.41776660084724426, -0.6628902554512024, -0.05556853488087654, 0.39130112528800964, -1.2690935134887695, -0.508878231048584, -0.026436330750584602, -0.21366244554519653, 0.47149890661239624, 0.24150784313678741, 0.828916072845459, -0.2693565785884857, -0.37366557121276855, -0.13736213743686676, -0.47338923811912537, 0.16285404562950134, -0.22509387135505676, -1.1511881351470947, 0.8343871831893921, 0.2675188183784485, -0.10863514989614487, -0.4461275041103363, -0.19623269140720367, -0.08787645399570465, 0.07243909686803818, -0.11149144172668457, 0.5115001201629639, -0.5755276679992676, -0.4901014566421509, -0.5847876071929932, -1.3381340503692627, -0.0741940513253212, 0.7194200158119202, -0.2980448603630066, 0.24942126870155334, -0.4261988699436188, 0.1614433377981186, -0.06810019165277481, -1.0728704929351807, 0.09014683961868286, 0.38267311453819275, -0.5324094295501709, -0.9412902593612671, 0.13215774297714233, 0.232987642288208, -0.9441553950309753, -0.8230134844779968, -0.3421303629875183, 0.38430750370025635, 0.019173506647348404, 0.8693722486495972, -0.6991420984268188, 0.5408161282539368, 0.9838509559631348, -0.003654255997389555, -0.5652340054512024, -0.7192589044570923, -0.8250333666801453, 0.27139800786972046, -0.41988256573677063, 0.5035499930381775, -0.1909123957157135, 0.4335380494594574, 0.9281531572341919, 0.1909029334783554, -0.8735578656196594, -0.7071117758750916, -0.16902756690979004, 0.06389686465263367, 0.046871233731508255, 0.21500030159950256, -0.2827867269515991, 0.15382355451583862, -0.15773113071918488, 0.6741639971733093, 0.6334794163703918, 0.20769000053405762, -0.48241135478019714, 0.0003513605333864689, -0.17398390173912048, 0.13477152585983276, -0.6807078719139099, -0.5346819758415222, -1.316925287246704, -0.284564346075058, -1.1743358373641968, 0.3201802372932434, -1.1324634552001953, -0.43430787324905396, 0.27066129446029663, -0.5118547677993774, 0.29407018423080444, -0.10523150861263275, -0.19159050285816193, -0.44110748171806335, -0.32410722970962524, -0.5732874870300293, 0.34857943654060364, 1.3860901594161987, -0.6543126702308655, 0.0053358376026153564, 0.17223377525806427, -0.021989546716213226, 0.32622843980789185, 0.6568419933319092, -0.32370179891586304, -0.6456630825996399, -0.9627338647842407, -0.3612270653247833, 0.14774715900421143, -0.01736835204064846, -1.0512703657150269, 0.9610611796379089, 0.47619718313217163, 0.04937645420432091, -0.4021396040916443, 0.3344693183898926, -0.8624483346939087, -0.6567710041999817, 0.43663474917411804, -1.042273759841919, -0.43384435772895813, -0.15162311494350433, -0.4308660328388214, -0.46864810585975647, 0.5696254372596741, 0.47734180092811584, -1.6425926685333252, -0.9870702624320984, 0.6728039979934692, -0.7283549308776855, 0.21871145069599152, 0.2410336583852768, -0.2749699056148529, -0.4915672242641449, 0.0008649746305309236, -0.7234016060829163, 0.654057502746582, -0.8695601224899292, 0.8362550735473633, 0.6355994343757629, -0.7501873970031738, -0.018866105005145073, 0.2879944443702698, -0.6433385014533997, 0.276657372713089, 0.8885871171951294, 0.579576313495636, -0.04416225105524063, 0.505527675151825, -0.012492039240896702, 0.24110719561576843, -0.9659691452980042, 0.03430923447012901, 1.2800896167755127, -0.45058000087738037, -0.31387072801589966, 1.1694096326828003, -0.1385747641324997, -0.32709139585494995, 0.39820021390914917, -1.0226799249649048, -0.772911012172699, 0.3163553476333618, 0.7729705572128296, 0.3776196241378784, -0.05588745325803757, -0.3270568549633026, -0.24170012772083282, 0.3034760653972626, -0.6577677726745605, -0.759895920753479, 0.4198114573955536, -0.3013893961906433, -0.14723850786685944, 0.546037495136261, 0.7095409035682678, -1.4899258613586426, -1.092935562133789, -0.5065157413482666, -0.13153105974197388, -0.11135780066251755, 0.005734685342758894, -0.5074174404144287, -0.6787626147270203, 0.566164493560791, 0.7040103077888489, 0.8132740259170532, -0.16623088717460632, 0.0008613927639089525, 0.26644089818000793, 0.2087656408548355, 0.23579952120780945, -0.9834701418876648, -0.4027356207370758, 0.8577470779418945, 1.453696846961975, -0.7385812401771545, -0.06469222903251648, -0.474204421043396, -0.9764341115951538, 1.0159903764724731, 0.42943114042282104, -0.6500832438468933, 1.0668832063674927, -0.4985937476158142, -0.047959089279174805, -0.1761719435453415, -0.8330849409103394, -0.6131107211112976, 1.0880178213119507, 1.1492115259170532, 0.25596702098846436, 0.44876405596733093, 0.0372195839881897, 0.7855445146560669, 0.2146744430065155, 0.01660590060055256, 0.4480011761188507, 0.33449774980545044, -0.5138453245162964, 0.19394320249557495, 0.13943375647068024, 1.1105107069015503, -1.2634199857711792, -0.21025443077087402, 0.3824097812175751, 0.3499273955821991, 0.037954628467559814, 0.43847519159317017, 0.9497851729393005, 0.32401958107948303, 0.4501539170742035, 0.28495997190475464, 0.34405696392059326, -0.7430700659751892, -0.4103870093822479, 0.11903120577335358, -0.787569522857666, -0.3019002079963684, -0.4106930196285248, -1.0259231328964233, -0.43595409393310547, 0.8563536405563354, 0.34123411774635315, -0.1453746110200882, 0.06892189383506775, 1.1704468727111816, 0.6727924346923828, 0.7524899840354919, -0.3871142566204071, -0.8575755953788757, -0.35406503081321716, -0.8552249670028687, 0.06521560251712799, -0.28389647603034973, 0.1619444042444229, -0.1454850286245346, 0.2407442182302475, 0.0651896744966507]}, "authors": [{"authorId": "2073879497", "name": "Chun Hung How"}, {"authorId": "3906447", "name": "Jagath Rajapakse"}], "references": [{"paperId": "412e266cddfd87c79087a88ba1e4d11b89a45a13", "title": "MEGABYTE: Predicting Million-byte Sequences with Multiscale Transformers"}, {"paperId": "25853af1f2c73274ad7c62b502c021aef3e67f6d", "title": "The state-of-the-art 3D anisotropic intracranial hemorrhage segmentation on non-contrast head CT: The INSTANCE challenge"}, {"paperId": "6a993404e07687b7edb7fb9a05092213a9419859", "title": "OneFormer: One Transformer to Rule Universal Image Segmentation"}, {"paperId": "e92a62da0ab6b9769f84dd9ea195debd3254243b", "title": "SegViT: Semantic Segmentation with Plain Vision Transformers"}, {"paperId": "22470b283e0b6cc6df041f3d13935f1d50581733", "title": "TransDeepLab: Convolution-Free Transformer-based DeepLab v3+ for Medical Image Segmentation"}, {"paperId": "06761cb27e14aa55a6c3d98b949898aa26416698", "title": "A Unified Sequence Interface for Vision Tasks"}, {"paperId": "055cd2faeebc7a9df43923d554a61ae924a4af6b", "title": "UViM: A Unified Modeling Approach for Vision with Learned Guiding Codes"}, {"paperId": "a09cbcaac305884f043810afc4fa4053099b5970", "title": "Exploring Plain Vision Transformer Backbones for Object Detection"}, {"paperId": "b079f791e01e0b308b8e3dae7989a917be73a1a4", "title": "Transframer: Arbitrary Frame Prediction with Generative Models"}, {"paperId": "f7410f535bda5b5a9888512fb954193245c1d0b2", "title": "Swin UNETR: Swin Transformers for Semantic Segmentation of Brain Tumors in MRI Images"}, {"paperId": "658a017302d29e4acf4ca789cb5d9f27983717ff", "title": "Masked-attention Mask Transformer for Universal Image Segmentation"}, {"paperId": "4d9ea9f592b344b96157eaf672cd7d29d934bd9e", "title": "Hematoma Expansion Context Guided Intracranial Hemorrhage Segmentation and Uncertainty Estimation"}, {"paperId": "24b8a0b02bcb7934967757fc59d273a71ba67e30", "title": "TransUNet: Transformers Make Strong Encoders for Medical Image Segmentation"}, {"paperId": "d8a83d1c59e9525690bee1ad114213f0b2cc1e39", "title": "CERMEP-IDB-MRXFDG: a database of 37 normal adult human brain [18F]FDG PET, T1 and FLAIR MRI, and CT images available for research"}, {"paperId": "962dc29fdc3fbdc5930a10aba114050b82fe5a3e", "title": "End-to-End Object Detection with Transformers"}, {"paperId": "3286d6a4760866be977a304f4583228bdb4624ea", "title": "Intracranial Hemorrhage Segmentation Using Deep Convolutional Model"}, {"paperId": "e7746e5dd7bb4a155aa7370fc13ccc82f205f079", "title": "OASIS-3: LONGITUDINAL NEUROIMAGING, CLINICAL, AND COGNITIVE DATASET FOR NORMAL AGING AND ALZHEIMER\u2019S DISEASE"}, {"paperId": "f466157848d1a7772fb6d02cdac9a7a5e7ef982e", "title": "Neural Discrete Representation Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "6364fdaa0a0eccd823a779fcdd489173f938e91a", "title": "U-Net: Convolutional Networks for Biomedical Image Segmentation"}]}