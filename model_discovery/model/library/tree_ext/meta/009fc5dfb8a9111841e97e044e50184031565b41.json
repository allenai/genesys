{"paperId": "009fc5dfb8a9111841e97e044e50184031565b41", "title": "Multi-line AI-assisted Code Authoring", "abstract": "CodeCompose is an AI-assisted code authoring tool powered by large language models (LLMs) that provides inline suggestions to 10's of thousands of developers at Meta. In this paper, we present how we scaled the product from displaying single-line suggestions to multi-line suggestions. This evolution required us to overcome several unique challenges in improving the usability of these suggestions for developers. First, we discuss how multi-line suggestions can have a 'jarring' effect, as the LLM's suggestions constantly move around the developer's existing code, which would otherwise result in decreased productivity and satisfaction. Second, multi-line suggestions take significantly longer to generate; hence we present several innovative investments we made to reduce the perceived latency for users. These model-hosting optimizations sped up multi-line suggestion latency by 2.5x. Finally, we conduct experiments on 10's of thousands of engineers to understand how multi-line suggestions impact the user experience and contrast this with single-line suggestions. Our experiments reveal that (i) multi-line suggestions account for 42% of total characters accepted (despite only accounting for 16% for displayed suggestions) (ii) multi-line suggestions almost doubled the percentage of keystrokes saved for users from 9% to 17%. Multi-line CodeCompose has been rolled out to all engineers at Meta, and less than 1% of engineers have opted out of multi-line suggestions.", "venue": "SIGSOFT FSE Companion", "year": 2024, "citationCount": 4, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper presents how the product was scaled from displaying single-line suggestions to multi-line suggestions, and reveals that multi-line suggestions almost doubled the percentage of keystrokes saved for users from 9% to 17%."}, "embedding": {"model": "specter_v2", "vector": [-0.6821925640106201, 0.2625979781150818, -0.40537935495376587, -0.11417938768863678, -0.15952004492282867, -0.6062361001968384, 0.14629249274730682, -0.17032946646213531, -0.20165516436100006, -0.44601473212242126, 0.27962571382522583, -0.41060882806777954, 0.13188636302947998, 0.13267701864242554, -0.20936089754104614, 0.49202394485473633, -0.7505664229393005, -0.017364680767059326, -0.3110908567905426, -0.16129793226718903, 0.2576140761375427, -0.462089866399765, -1.1499658823013306, 0.7581912875175476, 1.054983377456665, -0.3613787591457367, -0.1368722766637802, 1.1170951128005981, -0.4039805829524994, 0.3301362097263336, 0.5222858786582947, -0.3643304705619812, 0.1959269642829895, 0.08210257440805435, 0.22132743895053864, -0.13470619916915894, 0.09754209965467453, -0.2930179834365845, 0.18398520350456238, 0.3846955895423889, -0.2039324939250946, -0.3752102255821228, 0.22301949560642242, -0.9714153409004211, -0.050852298736572266, 1.2116092443466187, 0.10595426708459854, 0.4221632778644562, 0.4382537603378296, 0.001457724953070283, 0.9978207349777222, -1.7251074314117432, 0.07068151980638504, 1.105836272239685, 0.44947779178619385, 0.06461284309625626, -0.204639732837677, -0.411251962184906, 0.2602916955947876, -0.4954850673675537, -1.3261792659759521, -0.5326122045516968, -0.1376095712184906, -0.7330427765846252, 1.7686538696289062, -0.2705172896385193, -0.22293901443481445, -0.23551757633686066, 0.21806316077709198, 1.067625641822815, -0.31421348452568054, -1.132143259048462, 0.13028135895729065, 0.575745701789856, -0.21004432439804077, 1.3734074831008911, -0.12759923934936523, 0.05113044008612633, -1.0122365951538086, -0.7982575297355652, 0.8030803203582764, -0.35796627402305603, 0.030800821259617805, -0.7520334720611572, -0.7002492547035217, 0.6893213391304016, -0.34880125522613525, 0.8196188807487488, -0.15664142370224, 0.8825973272323608, 0.27372100949287415, 0.33383357524871826, 0.03033449873328209, 0.5160936713218689, 0.05891503021121025, -0.2225920706987381, -0.6216475963592529, 0.24187977612018585, 0.4233788549900055, 0.8141997456550598, -0.2321370393037796, 0.2517198622226715, -0.4861893355846405, 0.40628138184547424, 1.2337141036987305, -0.19358114898204803, 0.29456549882888794, -0.531773567199707, 0.23293612897396088, -0.26697447896003723, 0.867425262928009, -0.4772108197212219, -0.0511542409658432, -0.4539615213871002, -0.1336631178855896, -0.30020612478256226, -0.37435418367385864, -0.3292100131511688, -0.12158511579036713, -0.1437760889530182, -0.40630388259887695, -0.18946228921413422, -0.17236395180225372, 0.3790426552295685, 0.09571448713541031, 0.2353469282388687, -0.07862883806228638, 0.06802210956811905, 0.32396629452705383, -1.2666717767715454, -0.6111165881156921, -1.2141814231872559, 1.1935652494430542, -0.38713082671165466, 0.1651725172996521, -0.2446872889995575, -1.7453064918518066, -0.7057661414146423, -0.9235041737556458, 0.8234112858772278, -0.41614001989364624, 1.0684794187545776, 1.0961430072784424, 0.15376567840576172, -1.2886247634887695, 0.5908118486404419, -0.2699575424194336, 0.22864894568920135, -0.0162806399166584, -0.03667619079351425, 0.29293495416641235, -0.3406132757663727, -0.5009169578552246, -0.034722551703453064, -0.05592998117208481, -0.9958791732788086, -0.233276829123497, -0.4957897961139679, -0.7655109167098999, -0.13980332016944885, 0.63777756690979, -0.584977388381958, 1.6078754663467407, 0.16511961817741394, -0.8422876000404358, 0.4042809009552002, 0.07039884477853775, 0.7103686928749084, 0.5540320873260498, -0.4824426472187042, -0.6672722697257996, -0.5110043883323669, 0.12369447201490402, 0.38497236371040344, 0.4576708674430847, -0.7048850059509277, -0.3861863613128662, 0.7950811982154846, 0.36376410722732544, -0.12700872123241425, -0.287161260843277, 1.1327985525131226, -0.7058870792388916, -0.3646160662174225, -0.3545379340648651, 0.6864472031593323, -0.5681778192520142, 0.3659924566745758, -0.07896600663661957, -0.7990933060646057, 0.2675352692604065, 0.12026455253362656, 2.04876971244812, -0.9969966411590576, -0.5382776260375977, -0.19853974878787994, -0.3284487724304199, -0.11402500420808792, -0.48703327775001526, 0.9692384004592896, -0.5013570785522461, 0.8430426120758057, -0.6206068396568298, -0.43896567821502686, 0.045489680022001266, -1.012998104095459, 0.08504108339548111, -0.4267084002494812, -0.07213586568832397, 0.7666258215904236, -0.7152441143989563, 0.10978100448846817, -0.32080525159835815, 0.08262611925601959, -1.0561408996582031, 1.1080782413482666, -0.5415550470352173, -0.05863793194293976, 0.05100560933351517, -0.17243961989879608, 0.21884234249591827, -0.4513472318649292, -0.10143865644931793, 0.09442673623561859, -0.8474287390708923, -0.2666088342666626, -0.6329173445701599, 1.5444167852401733, -0.36916080117225647, 0.04827983304858208, 0.13025136291980743, 0.08854377269744873, -0.0985812395811081, 0.5443407297134399, -0.12245799601078033, 0.3097493350505829, -0.3435753285884857, 0.5750079154968262, -0.26951631903648376, -0.002877721330150962, 0.20518824458122253, 1.294509768486023, -0.3966596722602844, 1.1486808061599731, -0.2871767282485962, -0.38462507724761963, 0.5294685363769531, 0.4982883334159851, 0.7584117650985718, 0.7265843749046326, 0.5787977576255798, -0.21720264852046967, 0.33925044536590576, -0.44263410568237305, -0.4763215482234955, 0.6635208129882812, 1.0365221500396729, 0.5442006587982178, 0.07010871171951294, -1.029219627380371, -0.3191618323326111, 0.21437367796897888, 0.8758705854415894, 1.4500854015350342, -0.27214315533638, -0.849880039691925, -0.6486411094665527, -0.7760969996452332, 0.037207964807748795, 0.6911707520484924, -0.12140994518995285, -0.28490933775901794, -0.5227041840553284, -0.5522246956825256, 0.7457202076911926, 0.35042014718055725, 0.6005603075027466, -0.2705884277820587, -1.2064208984375, 0.007347791455686092, 0.5079697966575623, -0.20803527534008026, -0.9567161798477173, 0.11958381533622742, -0.3018941283226013, 0.09870806336402893, -0.07576467841863632, -0.030384456738829613, 0.5382829308509827, -0.3219691812992096, 0.8601934313774109, 0.5750313997268677, -0.7330752015113831, 0.2539657652378082, 0.2898826599121094, -0.6726135015487671, -1.0535593032836914, -0.3630557060241699, 0.02359536662697792, -0.8466666340827942, 0.11329008638858795, 0.6844376921653748, 0.24793840944766998, 0.37161943316459656, -0.538328230381012, 0.9309428930282593, 0.4068219065666199, -0.2723518908023834, -0.355523943901062, -0.46527183055877686, -0.11441724747419357, -1.0807260274887085, 1.1754144430160522, 0.1785518229007721, -0.4353105127811432, 0.3725177049636841, -0.7046984434127808, -0.2294389009475708, 0.35147225856781006, -0.5033833980560303, -0.19567559659481049, -0.9295336008071899, 0.33407822251319885, 0.6883779168128967, -0.1702461540699005, 0.48118311166763306, 0.7435364127159119, -0.37539663910865784, 0.5745056867599487, 0.508131742477417, 0.5157464742660522, -0.48167508840560913, 0.6092387437820435, -0.5091853737831116, 0.1547962874174118, -0.025765415281057358, 0.6126506328582764, -0.40293052792549133, -0.9464871883392334, 0.06462740898132324, 0.28819453716278076, -0.13432155549526215, -0.32450225949287415, -0.316726416349411, -0.3073815107345581, -0.5890250205993652, -0.6082109808921814, -0.27451637387275696, -1.650217890739441, -0.1286783665418625, 0.5467046499252319, -0.13302010297775269, -0.1636313498020172, -0.8479767441749573, -0.8958237767219543, -0.7775750160217285, -0.33215752243995667, -1.2721329927444458, 0.22237178683280945, -0.2672496438026428, -0.7704929113388062, -0.10022538900375366, 0.2373029738664627, -0.5243464112281799, 1.3107115030288696, -0.9747306704521179, 1.2797402143478394, 0.5358694791793823, -0.298636794090271, -0.34373682737350464, 0.1643344759941101, -0.3511162996292114, -0.09496679157018661, 0.8054974675178528, -0.08915281295776367, 0.09523696452379227, -0.7038189172744751, -0.04579883813858032, -0.3502384424209595, -0.11990073323249817, 0.9048761129379272, -0.14467918872833252, -1.0294268131256104, -0.048423681408166885, 1.257526159286499, -0.39294180274009705, -0.34719887375831604, 0.337612122297287, 0.8765223622322083, 0.4544707238674164, 0.34882301092147827, 1.5189223289489746, -0.040110472589731216, 0.8781512975692749, 0.2166888266801834, -0.43940356373786926, 0.25509822368621826, 0.02794252149760723, 0.654707133769989, 1.259542465209961, 0.20698842406272888, -0.03472932055592537, -1.4293378591537476, 0.5544650554656982, -1.4603310823440552, -0.03926405683159828, 0.3879298269748688, 0.9551647305488586, 0.35125234723091125, -0.6682436466217041, -0.1174294725060463, -0.3654863238334656, 0.47935327887535095, -0.2152765989303589, -0.1004512757062912, -0.7653475999832153, 0.6306495666503906, -0.18202176690101624, -0.2639458179473877, 0.5774752497673035, -0.23725929856300354, 0.1508089154958725, 14.730852127075195, 0.5606130957603455, 0.4282631278038025, 0.25510311126708984, 0.31420549750328064, 0.43977171182632446, -0.935829758644104, 0.0117564732208848, -0.8839114308357239, -0.02222742885351181, 1.091407060623169, -0.5801181793212891, 0.37981143593788147, 0.4410349428653717, 0.23634527623653412, -0.20133598148822784, -0.4320451617240906, 0.45537322759628296, 0.6142076849937439, -1.6046574115753174, 0.6430432200431824, 0.2728572189807892, 0.17900072038173676, -0.04128262400627136, 0.5667424201965332, 0.5660335421562195, 0.7163475155830383, -0.5305669903755188, 0.7291983366012573, 0.047529544681310654, 1.1351642608642578, -0.6581722497940063, 0.3835858404636383, 1.0290290117263794, -0.6732736825942993, -0.19973573088645935, -0.36637333035469055, -1.160586953163147, 0.33409175276756287, 0.17761577665805817, -0.8914114832878113, -0.4938802421092987, -0.10502276569604874, 0.4699724316596985, -0.1581829935312271, 0.8172588348388672, 0.16911521553993225, 0.20236621797084808, 0.0055990321561694145, -0.09624931961297989, -0.3832157254219055, 0.6546794176101685, 0.25188252329826355, 0.2839975357055664, 0.4666454493999481, 0.061160944402217865, 0.09960673749446869, 0.7402962446212769, -0.017087653279304504, 0.368270605802536, -0.7107877135276794, -0.6795757412910461, -0.015805089846253395, 0.6100227236747742, 0.2549760043621063, 0.29792320728302, -0.4876549541950226, 0.435957133769989, 0.7739183306694031, -0.047343023121356964, -0.4374948740005493, -0.1879611313343048, 0.2089194655418396, 0.07277187705039978, -0.26637139916419983, -0.06997296214103699, -0.20699287950992584, -0.42675599455833435, -0.6892719268798828, -0.7291693687438965, 0.1053767278790474, -0.8012781143188477, -0.4091069996356964, 0.9380909204483032, -0.0073662418872118, -1.113255500793457, 0.06305225193500519, -0.6680760383605957, -0.5688911080360413, 0.16863881051540375, -0.480663001537323, -0.5865325331687927, 0.39131850004196167, -0.8075484037399292, -0.1715497225522995, -0.19522400200366974, 1.4396532773971558, 0.14431138336658478, 0.10787029564380646, 0.04996717721223831, 0.2638903558254242, -0.4397924244403839, 0.5004104375839233, -0.7845994234085083, 1.0681856870651245, 0.404360830783844, -0.16236932575702667, 1.1269330978393555, 0.030325856059789658, -0.0357363298535347, -0.6635470390319824, 0.4164353609085083, 0.44184961915016174, -0.9896947741508484, -0.31464463472366333, -0.9302281737327576, -0.6412556767463684, 0.031208990141749382, 0.7966323494911194, -0.30218610167503357, 0.7016127109527588, -0.32873520255088806, -0.42225775122642517, 0.14111727476119995, -0.4807133674621582, 0.4843941032886505, 0.6533601880073547, -0.3917924165725708, 0.32261043787002563, -0.026959003880620003, 0.37018728256225586, -0.8672720789909363, -0.2996296286582947, -0.05083538964390755, 0.10532459616661072, -0.3422791361808777, 0.5671783685684204, -0.021717706695199013, 0.9863759279251099, 0.24876196682453156, 0.5267625451087952, -1.2349847555160522, -0.4438021183013916, -1.0058293342590332, 0.39131078124046326, -0.0014691060641780496, 1.2399731874465942, -0.10162633657455444, -0.0860557109117508, 1.4258899688720703, 0.19947269558906555, -0.44402045011520386, 0.010798838920891285, 0.19934114813804626, 0.052776068449020386, -0.49520355463027954, 0.2428566962480545, 0.19043666124343872, 0.6338196992874146, -0.4059962034225464, 0.22537408769130707, 0.5578656792640686, -0.4550975263118744, -0.5174036026000977, 0.8576513528823853, -0.047662824392318726, -0.48598307371139526, -0.4463583827018738, 0.1873919665813446, -1.0962927341461182, -0.38927340507507324, -0.9716115593910217, 0.4936123788356781, -0.9781023263931274, -0.28439825773239136, -0.031239423900842667, 0.16668882966041565, 0.188156396150589, 0.1653537005186081, -0.7056993842124939, -0.6443988680839539, -0.39415958523750305, -0.8095006942749023, 0.26351964473724365, 0.4847179651260376, -0.46662965416908264, 0.1978910267353058, -0.24175235629081726, -0.009865297004580498, 0.39971351623535156, 0.23189163208007812, -0.4991956353187561, -0.5429108738899231, -1.3055366277694702, 0.9511225819587708, -0.02608177624642849, -0.13953615725040436, -0.870248556137085, 0.8245211243629456, 0.15058544278144836, -0.2635003328323364, 0.13410061597824097, -0.2894625961780548, -0.8481737375259399, -0.06393801420927048, 0.6702761054039001, -0.9450874328613281, 0.6072310209274292, 0.5869583487510681, -0.7825058102607727, 0.11315767467021942, 0.4757539629936218, -0.5455592274665833, -1.3308018445968628, -0.8084895014762878, 0.005484789609909058, -1.28874671459198, -0.4859735369682312, 0.3086775541305542, -0.030331280082464218, -1.1357948780059814, -0.39556291699409485, 0.33151426911354065, 0.030384432524442673, 0.3232625722885132, 1.2851319313049316, 0.5918133854866028, -0.930205762386322, -0.182717427611351, 0.4821378290653229, 0.24887415766716003, -0.5255029201507568, 0.2743828296661377, 0.17062729597091675, -0.9126267433166504, 0.12190545350313187, 0.13755464553833008, 0.27040523290634155, -1.0367745161056519, -0.08002202957868576, 0.16796575486660004, -0.024704301729798317, -0.10628678649663925, 1.2917730808258057, -0.1530357152223587, -0.8189960718154907, -0.29933634400367737, -0.5360644459724426, -0.3331829905509949, -1.2247165441513062, 0.8948887586593628, 0.10842978209257126, -0.2755822539329529, -0.14120449125766754, -0.9493287801742554, 0.3192289173603058, -0.4600115716457367, -0.7394821047782898, 0.25919827818870544, -0.24633802473545074, -0.5997246503829956, 0.7522318363189697, -0.06496735662221909, 0.39149776101112366, -0.5341618657112122, 0.14189688861370087, -0.10543985664844513, -0.489177405834198, -0.12032423168420792, -1.0288299322128296, 0.14411358535289764, 0.7877916097640991, 0.35806775093078613, -0.08031134307384491, -0.6232101917266846, -0.001867105020210147, -0.3377602696418762, 0.21782183647155762, 0.5704329013824463, -0.3605154752731323, -0.1897585391998291, 0.5359447598457336, 1.4457683563232422, -0.7040244340896606, 0.4326570928096771, -0.30512529611587524, -1.0588390827178955, 1.375609040260315, 1.0488245487213135, 0.3703092634677887, 0.4877079129219055, 0.46656784415245056, 0.647680401802063, -0.0010785565245896578, -1.1193889379501343, 0.37441372871398926, 0.4961935877799988, 0.7557333707809448, 1.3314884901046753, 0.30455106496810913, -0.058640800416469574, 0.8748015761375427, 0.6706699728965759, 0.6505184173583984, 1.1395726203918457, 0.9826067090034485, -0.24437139928340912, -0.33530813455581665, -0.1122700646519661, 0.7703620791435242, -0.3890683054924011, -0.5687671303749084, -0.14518235623836517, 0.36943763494491577, 0.28719624876976013, 0.6422974467277527, 0.12713152170181274, 0.016504131257534027, 0.1080317348241806, 0.37596967816352844, 0.10552156716585159, -1.1223658323287964, -0.4780476689338684, -0.019212141633033752, -0.13538773357868195, 0.16665711998939514, 0.23830610513687134, -0.040430959314107895, -0.5607828497886658, 0.07898159325122833, -0.01695477031171322, 0.4690679907798767, 0.17930381000041962, 0.7365379929542542, 1.3487392663955688, 0.3491055369377136, -0.4604194760322571, -0.5985903143882751, -0.34882616996765137, -0.6598718762397766, 0.2613285779953003, -0.9361440539360046, -0.47494375705718994, -0.47233524918556213, -0.18850243091583252, -0.013343838974833488]}, "authors": [{"authorId": "2282956219", "name": "Omer Dunay"}, {"authorId": "2282965242", "name": "Daniel Cheng"}, {"authorId": "2282961277", "name": "Adam Tait"}, {"authorId": "2253640261", "name": "Parth Thakkar"}, {"authorId": "2265391422", "name": "Peter C. Rigby"}, {"authorId": "2282963244", "name": "Andy Chiu"}, {"authorId": "2282965000", "name": "Imad Ahmad"}, {"authorId": "2282959661", "name": "Arun Ganesan"}, {"authorId": "22192720", "name": "C. Maddila"}, {"authorId": "32269195", "name": "V. Murali"}, {"authorId": "2282972297", "name": "Ali Tayyebi"}, {"authorId": "1693689", "name": "Nachiappan Nagappan"}], "references": [{"paperId": "5e8bc5f84f3a550319b0d2b54cc0062b410d2328", "title": "Taking Flight with Copilot"}, {"paperId": "1eb3bf27896f5e9f0616ee793fd94e8452e0c462", "title": "Using nudges to accelerate code reviews at scale"}, {"paperId": "8dd412cd31592ba633b5dac8b2e7b4c679ec1c0a", "title": "Grounded Copilot: How Programmers Interact with Code-Generating Models"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "cdfe9580f63070f311151444f9df32818cc858bf", "title": "An Empirical Evaluation of GitHub Copilot's Code Suggestions"}, {"paperId": "5288b9f3a9f575543f44c39e1d3b78b3ca4c99da", "title": "InCoder: A Generative Model for Code Infilling and Synthesis"}, {"paperId": "2ec4d25b8ffb1821a664fb6e3722c236fe0c07db", "title": "GitHub"}, {"paperId": "57d8532ea99294a40696ae0f0a3fcd71440dc52a", "title": "Improving Code Autocompletion with Transfer Learning"}, {"paperId": "21b11793b960a3e37c0eab7aae6127c28fd38e5c", "title": "Code Prediction by Feeding Trees to Transformers"}, {"paperId": "66911442b67460f0e602a1f56b7342dd593c1993", "title": "Intelligent Code Completion with Bayesian Networks"}, {"paperId": "af5a7be7bfc592e400e2f12a24ad3e6a5a44b58f", "title": "Learning from examples to improve code completion systems"}, {"paperId": "eb537c6403932af7d1c4d819d2f0179df23baaee", "title": "How Program History Can Improve Code Completion"}, {"paperId": null, "title": "Smarter, more efficient coding: GitHub Copilot goes beyond Codex with improved AI model"}, {"paperId": null, "title": "ML Enhanced Code Completion"}, {"paperId": null, "title": "ELI5: Bento - Interactive Notebook that Em-powers Development Collaboration and Best Practices"}, {"paperId": null, "title": "Microsoft Accessed"}, {"paperId": null, "title": "2022. Expectation vs. Experience: Evaluating the Usability of Code Generation Tools Powered by Large Language Models"}, {"paperId": null, "title": "2024. AI-assisted Code Authoring at Scale: Fine-tuning, deploying, and mixed methods evaluations"}, {"paperId": null, "title": "Amazon Accessed 2023"}, {"paperId": null, "title": "2023. Taking Flight with Copilot: Early insights and opportunities of AI-powered pair-programming tools"}]}