{"paperId": "c1602dda2a41973ad944ab0a816c977b9abd64ef", "title": "Training With\"Paraphrasing the Original Text'' Improves Long-Context Performance", "abstract": "As Large Language Models (LLMs) continue to evolve, more are being designed to handle long-context inputs. Despite this advancement, many models face challenges in achieving high precision on long-context tasks, often showing a ``lost in the middle'' issue. This paper identifies the root of these issues as a deficiency in retrieval capabilities, exacerbated by the sparsity of key information in long contexts. To tackle this challenge, we introduce a novel approach called ``Paraphrasing the Original Text'', aimed at augmenting LLMs' proficiency in extracting information from long context. This enhancement is achieved through a specialized supervised fine-tuning stage that incorporates paraphrasing information into training samples, thereby improving the model's retrieval capabilities for long-context scenarios. Testing on datasets like LongBench and NaturalQuestions Multi-document QA dataset, our method demonstrated significant improvements in managing long-context tasks, effectively addressing the ``lost in the middle'' dilemma. Specifically, we observed an average performance increase of 6.4\\% and 5.9\\% across these datasets, respectively. Moreover, our approach is efficient, requiring minimal overhead with fine-tuning needed on just 19k samples. The model and training data have been made available on HuggingFace(https://huggingface.co/yuyijiong/Qwen-14b-chat-yarn-32k).", "venue": "", "year": 2023, "citationCount": 3, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper introduces a novel approach called ``Paraphrasing the Original Text'', aimed at augmenting LLMs' proficiency in extracting information from long context by incorporating paraphrasing information into training samples, thereby improving the model's retrieval capabilities for long-context scenarios."}, "embedding": {"model": "specter_v2", "vector": [-0.02426297776401043, 0.11167094111442566, -0.461365669965744, -0.2091992199420929, -0.8968530893325806, -0.6248195767402649, 0.6044401526451111, 0.06548244506120682, -0.3806615471839905, 0.2956773340702057, 0.7796130776405334, 0.020805325359106064, 0.29190731048583984, 0.4747024178504944, -0.1236392930150032, -0.09464273601770401, -0.678218424320221, 0.3562873899936676, -0.34740588068962097, -0.6639561653137207, 0.13887690007686615, -0.9555798768997192, -0.3116876482963562, 0.7537636756896973, 0.6969358921051025, -0.12334128469228745, 0.3826701045036316, 1.0340574979782104, -0.49540799856185913, 0.234793022274971, 0.20346927642822266, -0.5161897540092468, -0.12099994719028473, -0.3586447536945343, -0.3010275959968567, -0.29361775517463684, 0.2716337740421295, -0.31323927640914917, -0.07775335013866425, 0.20830240845680237, 0.056522294878959656, 0.06898228824138641, 0.3443240523338318, -0.1674157828092575, -0.7826379537582397, 0.8607049584388733, 0.542208731174469, 0.5914443731307983, 0.3119984269142151, -0.7695183157920837, 1.5352987051010132, -1.7636101245880127, 0.4928983449935913, 1.2440261840820312, 0.6111456751823425, 0.7717463970184326, -0.12166740000247955, -0.17038539052009583, 0.29678037762641907, 0.06802848726511002, -0.883082926273346, -0.45898228883743286, -0.028915155678987503, 0.1146085187792778, 1.8193261623382568, -0.24587760865688324, -0.5228576064109802, 0.7333587408065796, 0.16015386581420898, 1.5086427927017212, -0.17019712924957275, -1.219612717628479, -0.44842463731765747, -0.07524966448545456, 0.1679728776216507, 0.3051683306694031, -0.8320192694664001, 0.36549413204193115, -0.6657739281654358, -0.07828763872385025, 0.20935751497745514, -0.022798512130975723, -0.3564394414424896, 0.040309324860572815, -0.2880638539791107, 0.40556836128234863, 0.45062893629074097, 1.0734665393829346, 0.15149790048599243, 0.2939097583293915, 0.29312774538993835, 0.5944438576698303, 0.12005525082349777, 0.5204809904098511, -0.1901124268770218, 0.008985735476016998, -0.9776526093482971, 0.571282684803009, -0.024307971820235252, 0.7967551350593567, -0.1894092708826065, -0.432675302028656, -1.0619175434112549, 0.7712385058403015, 0.8428347110748291, -0.13517384231090546, 0.7611676454544067, -0.7474457025527954, 0.5324835777282715, -0.5500856637954712, 0.6103769540786743, -0.27903178334236145, -0.1596933901309967, -0.5429304242134094, -0.42763304710388184, -1.6819226741790771, -0.14738884568214417, 0.09083401411771774, -0.4993976950645447, 0.9096741676330566, -0.45933908224105835, -0.08170168101787567, 0.4268682897090912, 0.6783096194267273, 0.5990827083587646, 0.8561981320381165, 0.11448746919631958, -0.3280470669269562, 0.5726030468940735, -1.179408311843872, -0.8379323482513428, -1.3078683614730835, 1.0269168615341187, -0.7497596144676208, 0.796781063079834, -0.4135030210018158, -1.2003179788589478, -0.8540128469467163, -0.7816541194915771, -0.4018152952194214, -0.6131556630134583, 0.573539137840271, 0.5349113941192627, 0.19674567878246307, -0.944938600063324, 0.7458834052085876, 0.37704959511756897, -0.4084293246269226, -0.05644245818257332, -0.3409885764122009, 0.24541234970092773, -1.0456950664520264, -1.5004788637161255, 0.23744723200798035, -0.03057408332824707, -0.39455679059028625, -0.035789381712675095, -0.6322404742240906, -1.0600496530532837, -0.2684878408908844, 0.5160633325576782, -0.5333976745605469, 1.4058247804641724, -0.00453743152320385, -0.9452130794525146, 0.33809205889701843, -0.5813530683517456, 0.6367677450180054, 0.32863515615463257, -0.3217116594314575, -0.8859707713127136, -0.4886539876461029, 0.04895496368408203, 0.2972119450569153, 0.12334484606981277, -0.15145106613636017, -0.22886225581169128, 0.07221654802560806, -0.14590103924274445, 0.314676433801651, 0.11768331378698349, 0.7638781070709229, -0.8097078204154968, -0.5845828652381897, 0.338349312543869, 0.5886094570159912, 0.15737280249595642, -0.32544249296188354, -0.16750289499759674, -0.9823671579360962, 0.6981911063194275, -0.06055847555398941, 1.4499070644378662, -0.875325083732605, -0.41800135374069214, -0.544546902179718, -0.7385087609291077, -0.09801746159791946, -0.7600355744361877, 1.1681840419769287, -0.1063508540391922, 0.3416890799999237, -0.5123830437660217, -1.4027987718582153, -0.06089603900909424, 0.12912417948246002, -0.8945945501327515, -0.6379342675209045, 0.27946600317955017, 1.354186773300171, -1.1375166177749634, 0.28784388303756714, -0.469016969203949, 0.2092236578464508, -0.6783890128135681, 0.9604052901268005, -0.5509241819381714, 0.34073108434677124, 0.12654399871826172, 0.21477706730365753, -0.02074156329035759, -0.40160658955574036, 0.2838763892650604, -0.2053154855966568, 0.046696752309799194, 0.19512538611888885, -0.04034774377942085, 1.9394584894180298, -0.5129293203353882, 0.19382654130458832, -0.19456979632377625, -0.3881640136241913, -0.6307986974716187, 0.6121073961257935, -0.315528005361557, -0.5010419487953186, -0.0739564448595047, 0.7086567282676697, -1.0077080726623535, 0.035034991800785065, 1.0883110761642456, 0.42689448595046997, -0.5243005752563477, 0.24337433278560638, 0.3161201775074005, -0.32420945167541504, 0.6350024342536926, 0.48152443766593933, 0.4919635057449341, 0.5856761932373047, 0.40392521023750305, 0.12692679464817047, 0.6559798121452332, -0.41373223066329956, -0.17796745896339417, 0.547630250453949, 0.9200876951217651, 0.9529913663864136, 0.10335353761911392, -0.513414740562439, -0.40715861320495605, -0.05260534957051277, 0.5553449988365173, 1.760319471359253, -0.06595130264759064, -0.37238404154777527, -0.5582538843154907, -0.5305399298667908, -0.2283814400434494, 0.21319982409477234, -0.7257428169250488, -0.20938727259635925, -0.5343521237373352, -0.7698532938957214, 0.9294384717941284, 0.4929943084716797, 0.8992004990577698, -0.13874338567256927, 0.02394365519285202, 0.047458067536354065, -0.2824239730834961, -0.5825061202049255, -1.0935029983520508, 0.16878890991210938, -0.5560241937637329, -0.14764510095119476, -0.5663443207740784, -0.4205437898635864, -0.025884054601192474, -0.5281580686569214, 1.4110817909240723, -0.2553098201751709, -0.272240549325943, 0.06400331109762192, 0.10090577602386475, -0.32478708028793335, -0.9920962452888489, -0.17710281908512115, -0.0530855692923069, -0.7195544242858887, 0.4557146430015564, 0.657292902469635, 0.23874640464782715, 0.3185982406139374, -0.5947855710983276, 0.271383672952652, 0.34955406188964844, 0.7537283301353455, 0.8720709681510925, -0.48976582288742065, 0.6097458600997925, -1.2417662143707275, 1.201851487159729, 0.17416000366210938, 0.011987085454165936, 0.9346839785575867, -0.7764649987220764, -0.4713735282421112, 0.8014577627182007, -0.4788937568664551, -0.41110190749168396, -1.2982134819030762, 0.2399119883775711, 0.018300805240869522, 0.11736337840557098, 0.5604560375213623, 0.1417538970708847, 0.4281623661518097, 0.53184974193573, 0.4216078519821167, 0.12101927399635315, -0.49907487630844116, 0.6651384830474854, -0.26660141348838806, 0.5033044219017029, 0.06303436309099197, -0.2762369215488434, -0.3381056785583496, -0.22843380272388458, -0.375897079706192, -0.5525229573249817, -0.652761697769165, -0.5215070247650146, -0.2574603855609894, -0.10490166395902634, -0.6647837162017822, 0.12068672478199005, -0.21886128187179565, -1.0309725999832153, 0.034537240862846375, -0.027075769379734993, -0.5611120462417603, -0.12190339714288712, -0.7182300686836243, -1.3258414268493652, -0.24723714590072632, -0.549717128276825, -0.7362130284309387, 0.8132906556129456, -0.008730447851121426, -0.3464125394821167, -0.4582560062408447, 0.39270538091659546, -0.16303841769695282, 0.7833504676818848, -0.7919819355010986, 1.0111602544784546, 0.39326292276382446, 0.1936536729335785, -0.37373578548431396, 0.21315327286720276, 0.4681800603866577, 0.04355884715914726, 0.007839396595954895, -0.7880018353462219, -0.06450627744197845, -0.08780220150947571, -0.2728687524795532, 0.07103756070137024, 0.06494920700788498, 0.10182429105043411, 0.22964541614055634, -0.5691657662391663, 0.04948318749666214, 1.4496452808380127, -0.5685651302337646, -0.1918184906244278, -0.2853343188762665, 0.8748182654380798, 0.6733689308166504, 0.38119539618492126, 0.386106014251709, -0.005464193411171436, 0.41637617349624634, -0.30310678482055664, 0.2778383791446686, -0.2026682049036026, -0.6741442680358887, 0.5924851298332214, 1.5058146715164185, 0.4006069004535675, 0.08993223309516907, -1.0695031881332397, 0.80926114320755, -1.381827712059021, -0.4666130244731903, 0.5938295722007751, 0.738979697227478, 0.6561103463172913, -0.6597959995269775, -0.46663305163383484, -0.36196666955947876, 0.20648609101772308, 0.17605118453502655, -0.3522902727127075, -0.4438365697860718, -0.19998730719089508, 0.17778874933719635, -0.44064244627952576, 0.5287589430809021, -0.2819356620311737, 0.5063245892524719, 14.63247013092041, 0.9269518852233887, 0.308801531791687, 0.8675047755241394, 0.46689510345458984, -0.03072333335876465, -0.46882712841033936, -0.10137743502855301, -0.9491877555847168, -0.18933455646038055, 1.1331039667129517, 0.1312439739704132, 0.5652610063552856, -0.08517493307590485, 0.33452922105789185, -0.05087091028690338, -0.8693789839744568, 0.7615997791290283, 0.7770472168922424, -1.3135086297988892, 0.5973157286643982, -0.058410368859767914, 0.6777747869491577, 0.3513943552970886, 0.8751335144042969, 1.234127402305603, -0.22306208312511444, -0.1369100958108902, 0.18073797225952148, 0.15658794343471527, 0.7898913025856018, -0.4024781584739685, 0.5033549666404724, 0.4148542881011963, -0.46266406774520874, -0.7734684348106384, -1.0231738090515137, -0.8695089221000671, 0.22419337928295135, 0.08604325354099274, -0.713982105255127, 0.11821284890174866, -0.2585168778896332, 0.6533244848251343, -0.6060130596160889, 0.34108754992485046, -0.20883339643478394, 0.23094573616981506, 0.2737581431865692, 0.1001434326171875, 0.4503876864910126, 0.20210543274879456, 0.6212735772132874, 0.032843999564647675, 0.13774217665195465, 0.03992895409464836, -0.17754292488098145, 0.4596535563468933, -0.4993527829647064, 0.3592846989631653, -0.5830075144767761, -0.15464425086975098, -0.2889229655265808, 0.2683981657028198, 0.7968066334724426, 0.2978046238422394, -0.3908173143863678, 0.7048508524894714, 0.6272996068000793, 0.33792150020599365, -0.09808510541915894, -0.022402675822377205, 0.06537660956382751, -0.4409938156604767, -0.2765673100948334, 0.5312026143074036, -0.09489124268293381, -0.717820405960083, -0.23559993505477905, -0.11788643896579742, 0.40508946776390076, -1.1402041912078857, -1.023332118988037, 0.8294602632522583, -0.13066697120666504, -0.8762704730033875, -0.42756813764572144, -0.4286022484302521, -0.07882624864578247, 0.6900659799575806, -1.3749600648880005, -1.0927977561950684, 0.44487306475639343, -0.310232549905777, 0.04111037030816078, 0.10951261967420578, 1.5428102016448975, 0.2764642536640167, -0.2836664021015167, 0.28418946266174316, 0.900261402130127, -0.21336354315280914, 0.4895738363265991, -0.8744227290153503, 0.3042756915092468, 0.3402397930622101, -0.19062277674674988, 0.7338046431541443, 0.06484288722276688, -0.05743369460105896, -0.8865115642547607, -0.12306420505046844, 1.048203706741333, -1.1382777690887451, -0.6862220168113708, -0.5374560952186584, -0.9717214703559875, -0.1426955908536911, 0.6869222521781921, -0.36093196272850037, 0.7060450911521912, 0.21796801686286926, -0.2783752977848053, -0.1625361293554306, -1.0736656188964844, 0.45706766843795776, 0.5918946266174316, -1.1406962871551514, -0.7844334244728088, 0.2863716185092926, 0.42219483852386475, -1.0298458337783813, -0.4600006341934204, -0.28820112347602844, -0.0036674479488283396, 0.11420237272977829, 0.8088662624359131, -0.44562190771102905, 0.9210423827171326, 0.6923421025276184, -0.5725345611572266, -0.9201322197914124, 0.21364200115203857, -0.7313399314880371, 0.01848718337714672, 0.30065110325813293, 0.7423757314682007, 0.1052936539053917, -0.07893943786621094, 1.0605477094650269, 0.2789519131183624, -0.9305078983306885, -0.7967636585235596, -0.1678403913974762, 0.486420214176178, -0.1153603047132492, 0.2387837916612625, 0.10430087894201279, 0.22940319776535034, 0.3196123242378235, 0.4852401316165924, 0.6115540862083435, -0.5082840919494629, -0.12628580629825592, 0.38111382722854614, 0.33695489168167114, -0.20236265659332275, -0.2654825747013092, -0.05192336440086365, -1.6195911169052124, -0.12798738479614258, -0.9657599329948425, -0.07037881761789322, -0.6195980310440063, -0.5878642797470093, 0.21342243254184723, -0.09016615897417068, -0.2561057507991791, 0.04553554579615593, -0.1858266144990921, -0.473744660615921, -0.24426151812076569, -0.49098360538482666, 0.7371095418930054, 0.9979638457298279, -0.7808316349983215, -0.08424150943756104, -0.06072986125946045, 0.008072330616414547, -0.3035852611064911, 0.25244757533073425, -0.028547212481498718, -1.0142725706100464, -1.664629578590393, 0.549757719039917, 0.04703430458903313, -0.13857321441173553, -0.406144917011261, 0.4368413984775543, 0.2877221405506134, 0.04351038858294487, -0.12190692871809006, 0.38015544414520264, -0.9416729807853699, -0.4289836287498474, -0.18057967722415924, -0.8625094294548035, 0.5679222345352173, 0.18524616956710815, -0.4151771366596222, -0.5842334032058716, 0.3310254216194153, -0.05989180877804756, -1.2142304182052612, -0.8355764746665955, -0.14399194717407227, -0.28313490748405457, 0.17138519883155823, -0.29131603240966797, -0.015247801318764687, -0.98426753282547, -0.4898354709148407, -0.17673248052597046, 0.6273047924041748, -0.026653002947568893, 1.051291584968567, 0.4132756292819977, -1.228040099143982, -0.03164363279938698, 0.22373990714550018, 0.2361127734184265, 0.1501835137605667, 0.8444312214851379, 0.33082446455955505, -0.16320735216140747, 0.6095256805419922, 0.4782832860946655, -0.11182073503732681, -0.9103559255599976, 0.0284435898065567, 0.8768265247344971, -0.6896052956581116, 0.1502622663974762, 1.1925334930419922, -0.7287967801094055, -1.1527355909347534, -0.13321030139923096, -1.1021136045455933, -0.44918403029441833, -0.32294315099716187, 0.9872909784317017, 0.01778910495340824, 0.3423323333263397, -0.35367095470428467, -0.41290876269340515, 0.2528156638145447, -0.44867298007011414, -0.6911314129829407, 0.497232049703598, -0.8516839742660522, -0.3409042954444885, 0.8601093888282776, 0.9338670969009399, -0.40616950392723083, -0.38361480832099915, -0.52079838514328, -0.45055511593818665, -0.40281951427459717, 0.030267519876360893, -1.0987846851348877, 0.12196387350559235, 0.8349301218986511, 0.5185381174087524, -0.014616472646594048, 0.36668306589126587, -0.2181575894355774, 0.3315370976924896, 0.9169325828552246, 0.14045673608779907, -0.9313277006149292, -0.6165502667427063, 1.380825400352478, 1.483855962753296, -1.1946524381637573, 0.27434641122817993, 0.2722366452217102, -0.8479735851287842, 0.6818916201591492, 0.3123539686203003, 0.4205612540245056, 0.8468435406684875, -0.9142282605171204, 0.6451409459114075, 0.29545140266418457, -0.9944820404052734, 0.3877054750919342, 0.7793374061584473, 0.8347485065460205, 0.9085757732391357, 0.23964707553386688, -0.225009024143219, 1.0548059940338135, 0.19422633945941925, 0.19554738700389862, 0.7332583069801331, 0.811556875705719, 0.2632443904876709, -0.605330765247345, 0.16276444494724274, 0.4274212718009949, -0.7661606073379517, -0.60587477684021, -0.1376490592956543, 0.287553071975708, 0.2525177299976349, 0.8374431133270264, 0.3502630591392517, 0.17569513618946075, 0.5518564581871033, 0.7060421109199524, 0.6295968890190125, -0.760995626449585, -0.5533368587493896, -0.17259137332439423, -0.6650986671447754, -0.013378730975091457, -0.28374430537223816, -0.47818562388420105, -0.06713493913412094, 0.26585033535957336, 0.17087912559509277, 0.3198777139186859, 0.23602187633514404, 1.0968292951583862, 0.7617558836936951, 0.12587854266166687, -0.26877304911613464, -0.1985362470149994, -0.6908674836158752, -1.2195351123809814, -0.030842609703540802, -0.0940246433019638, -0.06519956886768341, 0.0605948381125927, 0.22568336129188538, -0.3972695767879486]}, "authors": [{"authorId": "2275622434", "name": "Yijiong Yu"}], "references": [{"paperId": "c2b833283099f6fbcbe89229c703e4945b1f7ebf", "title": "Never Lost in the Middle: Improving Large Language Models via Attention Strengthening Question Answering"}, {"paperId": "0484f05b6b3c11a9344cb623649ae867f172046f", "title": "LooGLE: Can Long-Context Language Models Understand Long Contexts?"}, {"paperId": "4c0428917aeee6aa7bd434f337d039f35996b736", "title": "LongLLMLingua: Accelerating and Enhancing LLMs in Long Context Scenarios via Prompt Compression"}, {"paperId": "ff01d3dab60dd4b7426c884b009dda83540c0c1e", "title": "Attention Sorting Combats Recency Bias In Long Context Language Models"}, {"paperId": "b6346f9fa093b8e85df712485a2b851b9f680dac", "title": "LongLoRA: Efficient Fine-tuning of Long-Context Large Language Models"}, {"paperId": "819bbdc2dac9e13d9ca3e2508a6e063186ce5e40", "title": "YaRN: Efficient Context Window Extension of Large Language Models"}, {"paperId": "b31a5884a8ebe96b6300839b28608b97f8f8ef76", "title": "LongBench: A Bilingual, Multitask Benchmark for Long Context Understanding"}, {"paperId": "1733eb7792f7a43dd21f51f4d1017a1bffd217b5", "title": "Lost in the Middle: How Language Models Use Long Contexts"}, {"paperId": "f5afaccfe90268485a9961c5771ec5e71e9b806c", "title": "Extending Context Window of Large Language Models via Positional Interpolation"}, {"paperId": "32ac52069e562d4f900afee70bdca63f53461481", "title": "QLoRA: Efficient Finetuning of Quantized LLMs"}, {"paperId": "163b4d6a79a5b19af88b8585456363340d9efd04", "title": "GPT-4 Technical Report"}, {"paperId": "1b6e810ce0afd0dd093f789d2b2742d047e316d5", "title": "Chain of Thought Prompting Elicits Reasoning in Large Language Models"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "7b36c5602930abf08efd2867f92cdb48a1be757a", "title": "Together"}, {"paperId": null, "title": "FlagAlpha"}, {"paperId": "5d7963e1c194b0f09361c60d5be822aca85fc313", "title": "Introduction to Common Crawl Datasets"}, {"paperId": null, "title": "Neural Tangent Kernel: A Survey, August 2022"}, {"paperId": null, "title": ": An Instruction-following LLaMA model, 2023"}, {"paperId": null, "title": "LLMTest needleinahaystack: Doing simple retrieval from LLM models at various context lengths to measure accuracy, 2023"}]}