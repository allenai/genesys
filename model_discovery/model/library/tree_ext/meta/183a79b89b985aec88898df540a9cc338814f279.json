{"paperId": "183a79b89b985aec88898df540a9cc338814f279", "title": "Communication-Efficient Model Parallelism for Distributed In-Situ Transformer Inference", "abstract": "Transformer models have shown significant success in a wide range of tasks. Meanwhile, massive resources required by its inference prevent scenarios with resource-constrained devices from in-situ deployment, leaving a high threshold of integrating its advances. Observing that these scenarios, e.g. smart home of edge computing, are usually comprise a rich set of trusted devices with untapped resources, it is promising to distribute Transformer inference onto multiple devices. However, due to the tightly-coupled feature of Transformer model, existing model parallelism approaches necessitate frequent communication to resolve data dependencies, making them unacceptable for distributed inference, especially under weak interconnect of edge scenarios. In this paper, we propose DeTransformer, a communication-efficient distributed in-situ Transformer inference system for edge scenarios. DeTransformer is based on a novel block parallelism approach, with the key idea of restructuring the original Trans-former layer with a single block to the decoupled layer with multi-ple sub-blocks and exploit model parallelism between sub-blocks. Next, DeTransformer contains an adaptive placement approach to automatically select the optimal placement strategy by striking a trade-off among communication capability, computing power and memory budget. Experimental results show that DeTransformer can reduce distributed inference latency by up to 2.81 x compared to the SOTA approach on 4 devices, while effectively maintaining task accuracy and a consistent model size.", "venue": "Design, Automation and Test in Europe", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "DeTransformer is a communication-efficient distributed in-situ Transformer inference system for edge scenarios based on a novel block parallelism approach, with the key idea of restructuring the original Trans-former layer with a single block to the decoupled layer with multi-ple sub-blocks and exploit model parallelism between sub-blocks."}, "embedding": {"model": "specter_v2", "vector": [-0.009678445756435394, -0.025774944573640823, -1.1313847303390503, 0.4066358804702759, -0.2652107775211334, -0.12804563343524933, 0.35302087664604187, -0.2250448316335678, 0.07756747305393219, -0.09438750147819519, 0.21714287996292114, -0.4856707453727722, 0.20863325893878937, -0.14704112708568573, -0.12033717334270477, -0.0020245807245373726, -0.8099987506866455, 0.1611344963312149, 0.5723620653152466, -0.044184811413288116, -0.045228034257888794, 0.0779142826795578, -1.0054582357406616, 0.362525999546051, 0.475801020860672, 1.4178497791290283, -0.3858758211135864, 0.5997244119644165, 0.3101876676082611, 0.43144744634628296, 0.6179026961326599, 0.2062586098909378, 0.3888871371746063, 0.6911863088607788, 0.12025260925292969, -0.421167254447937, 0.03914736956357956, -0.9404151439666748, -0.3105708360671997, 0.7468222975730896, 0.00033586996141821146, -0.27823853492736816, 0.24605491757392883, -1.2631667852401733, 0.40828990936279297, 0.5899598002433777, 0.1926678568124771, 0.5904006361961365, -0.5966244339942932, -0.9551313519477844, 1.167128324508667, -1.265028476715088, -0.2691430151462555, 0.5151727795600891, 0.36426088213920593, 0.1429676115512848, -0.2531547546386719, -0.825157642364502, -0.23952263593673706, 0.13602210581302643, -0.8088148236274719, -0.9032950401306152, 0.315479040145874, -0.016861647367477417, 1.603633999824524, 0.11084093153476715, -0.04845793545246124, 0.10318156331777573, 0.2418358474969864, 0.9399438500404358, 0.45015254616737366, -0.8505839705467224, 0.38167575001716614, -0.20092658698558807, 0.24594618380069733, 0.5304930210113525, 0.4733198583126068, -0.026713408529758453, -1.5006121397018433, -0.8121422529220581, 0.2679126262664795, 0.4501042366027832, 0.24114806950092316, -0.4108789563179016, 0.048239901661872864, 0.045703284442424774, 0.025583097711205482, 0.7325587272644043, -0.2246803492307663, 0.7321388125419617, 0.7832877039909363, 0.16326826810836792, -0.22034072875976562, -0.33095917105674744, 0.039883363991975784, -0.06391625106334686, -1.0535553693771362, -0.33210766315460205, 0.5485665202140808, 0.6793361306190491, -0.5912022590637207, 0.30486372113227844, -0.2707185745239258, -0.3860865533351898, 1.2537527084350586, 0.14494235813617706, 0.10657163709402084, -0.052321482449769974, 0.2352006882429123, -0.4506206214427948, 0.6941043138504028, -0.23571880161762238, 0.2467077076435089, 0.09286855906248093, -1.2010576725006104, -0.5202146768569946, -1.0717366933822632, -0.06866355240345001, -0.5353496074676514, -0.1822184920310974, -0.17815355956554413, 0.5576995611190796, 0.12944073975086212, 0.04274802282452583, 0.2058965563774109, 0.23743298649787903, -0.23427677154541016, -0.2342500537633896, 0.8659019470214844, -1.2344963550567627, -0.5339083075523376, -0.7413838505744934, 0.07831685990095139, -0.5153136253356934, -0.48438432812690735, -0.32352444529533386, -1.3311412334442139, -0.6186448335647583, -1.2374480962753296, 0.5435137748718262, -0.4476495385169983, -0.3870418071746826, 0.7974217534065247, 0.17031195759773254, -1.301379919052124, 0.3581632971763611, -0.7438546419143677, -0.3241714537143707, 0.2368871420621872, 0.6437179446220398, 0.7646332383155823, 0.5179322361946106, -1.033056378364563, 0.13399727642536163, 0.0981879010796547, -0.9362348318099976, -0.5516374707221985, -0.3985222280025482, -0.5624584555625916, 0.33255141973495483, 0.06359484046697617, -0.7034131288528442, 1.0981448888778687, 0.5660245418548584, -0.9878321290016174, 0.19943241775035858, 0.07182013988494873, 0.01630832813680172, 0.003631619503721595, 0.05835084244608879, -1.0522794723510742, -0.20917247235774994, 0.15480685234069824, -0.22973938286304474, 0.6001939177513123, -0.5525854825973511, -0.38179314136505127, -0.20584921538829803, -0.2712874710559845, 0.09284386783838272, -0.6277409791946411, 1.229828119277954, -0.2570071816444397, 0.15663258731365204, 0.13742703199386597, 0.6764171719551086, -0.3857135772705078, 0.39061084389686584, -0.48082783818244934, -0.39755314588546753, 1.4696071147918701, 0.22383205592632294, 1.4841216802597046, -0.7067688703536987, -1.1707196235656738, 0.48565971851348877, 0.0723053440451622, 0.2101786583662033, 0.3688738942146301, 0.7699952721595764, -0.47419315576553345, -0.05225564166903496, 0.40623658895492554, 0.039271220564842224, -0.0016114901518449187, -0.45575132966041565, -1.3339581489562988, -0.36032167077064514, -0.8668264746665955, 0.858559250831604, -0.4004374146461487, 0.2833324670791626, -0.12807044386863708, 0.04878660663962364, -0.49003472924232483, 1.3331780433654785, -0.136647030711174, -0.1394030600786209, -0.6221047043800354, 0.27722203731536865, 0.2876983880996704, -0.9729553461074829, 0.8340853452682495, -0.7117519378662109, -0.17234700918197632, 0.539797306060791, -0.402028888463974, 0.7938409447669983, -0.4348209798336029, 0.06395701318979263, 0.48400625586509705, -0.44824862480163574, 0.09850906580686569, 0.879029393196106, 0.6972464919090271, -0.676062285900116, 0.6025053262710571, 0.28308868408203125, -0.3244977295398712, 0.386827677488327, 0.8513513803482056, 1.3443740606307983, -0.5206348299980164, 0.8474977612495422, -0.27175429463386536, -0.08953770995140076, 0.0736507698893547, -0.020963139832019806, 0.7762290239334106, 0.14578799903392792, 0.4230552911758423, -0.25164926052093506, 0.28368574380874634, -1.3039696216583252, -0.1500159651041031, 0.44695845246315, 0.3034856617450714, -0.08268077671527863, 0.16313736140727997, -0.5631740689277649, -0.25592127442359924, 0.16831696033477783, 0.35573676228523254, 1.1857572793960571, 0.2854059934616089, -0.9062836170196533, -0.8181691765785217, -0.7143536806106567, -0.3357038199901581, -0.14328238368034363, 0.5459850430488586, 0.07778170704841614, -0.0923367515206337, -0.8934349417686462, 0.8303701281547546, 0.6917194128036499, 1.4173150062561035, -0.24440370500087738, -0.693468451499939, -0.5533369183540344, 0.39857959747314453, -0.8215135335922241, 0.038156237453222275, 0.33584216237068176, -0.3851067125797272, -0.15878236293792725, 0.563744306564331, -0.11806409806013107, 0.34956640005111694, -0.5578516125679016, 0.7821720838546753, -0.2954390048980713, -0.13883070647716522, 0.27668052911758423, 0.6235429048538208, -0.5786837935447693, -0.14671850204467773, -0.12435255199670792, 0.002845406299456954, -0.4199617803096771, 0.6997402310371399, -0.2784501016139984, 0.07325421273708344, 0.049806296825408936, -0.2171345353126526, -0.07935754209756851, 0.002550825010985136, -0.02103353850543499, 0.23247189819812775, 0.05613936111330986, -0.28171253204345703, -0.8225013017654419, 0.9498681426048279, -0.284961462020874, -0.844247579574585, 0.10129211097955704, -0.9157517552375793, -0.5949268341064453, 0.7638481855392456, -0.4235266447067261, 0.05759312957525253, -1.6330382823944092, 0.6573423147201538, -0.40258875489234924, -0.011697301641106606, -0.29509320855140686, -0.05121273547410965, -0.481595516204834, 0.1579389125108719, 0.7355960607528687, 0.01982884295284748, 0.3076460659503937, -0.07856561988592148, 0.04426868259906769, -0.4185143709182739, -0.3529811203479767, 0.11592577397823334, 0.20238319039344788, -0.11432549357414246, -0.23724128305912018, -0.15729138255119324, 0.0037982200738042593, 0.0675230324268341, -0.14651909470558167, -0.5253104567527771, -0.8170327544212341, -1.0733646154403687, -0.07680103927850723, -1.1466388702392578, -0.5299162268638611, 0.5530141592025757, -0.4326767027378082, -0.03884352371096611, -1.1370391845703125, -1.1757320165634155, -0.22694095969200134, -1.4536538124084473, -1.3419015407562256, 0.6118603348731995, -0.09802380204200745, -0.5791273713111877, -0.5436899065971375, -0.6006700992584229, -0.3344075679779053, 1.1981887817382812, -0.5181877017021179, 0.4281863570213318, -0.19819562137126923, -0.6465154886245728, 0.08512279391288757, -0.4837033748626709, -0.01711997017264366, -0.04671140015125275, -0.005594125483185053, -0.4422012269496918, 0.07432451099157333, 0.027365682646632195, 0.12143030762672424, -0.5256048440933228, -0.24130384624004364, 1.6374584436416626, 0.1615504026412964, -1.0593925714492798, 0.3218631446361542, 1.3654084205627441, -0.232124924659729, 0.25862205028533936, -0.0005308157415129244, 1.1283174753189087, -0.5186316967010498, 0.11887268722057343, 0.9225085973739624, -0.01148972474038601, 0.6240545511245728, 0.14195574820041656, -0.535737931728363, 0.19705083966255188, 0.34549230337142944, 0.49225762486457825, 1.6115995645523071, 0.11804953217506409, 0.058739304542541504, -0.8958195447921753, 0.7349689602851868, -1.663489818572998, -0.37426066398620605, 0.8283700942993164, 1.0242822170257568, 0.06254027038812637, 0.09337977319955826, -0.2620076537132263, 0.035772841423749924, 0.8431748747825623, 0.48958051204681396, -0.44040971994400024, -0.6556189060211182, 0.9781980514526367, 0.8947179913520813, 0.6878531575202942, 0.3741185665130615, 0.09331977367401123, 0.11355631798505783, 14.733841896057129, 1.1695153713226318, -0.12413574010133743, 0.8151440024375916, 0.40930792689323425, 0.7800938487052917, -0.118043914437294, 0.22003073990345, -1.3735880851745605, 0.8010087609291077, 1.7007359266281128, -0.27414947748184204, 0.07181096822023392, 0.3847927451133728, -0.330097496509552, 0.10855895280838013, -0.4602636396884918, 0.7601041197776794, 0.7343506217002869, -1.227128505706787, 0.17923960089683533, 0.4604027569293976, 0.32110685110092163, 0.4118787348270416, 0.45146888494491577, -0.009065013378858566, 0.726137101650238, -0.2020222544670105, -0.11137952655553818, -0.27167853713035583, 1.509865164756775, -0.6929630637168884, 0.5135955214500427, 0.5141245126724243, -0.8777597546577454, 0.26993826031684875, -0.19670385122299194, -1.3871245384216309, -0.02713395468890667, 0.7944726347923279, -0.5157585144042969, -0.4283618628978729, 0.061230193823575974, 0.5123392939567566, 1.0884820222854614, 0.21239201724529266, -0.6690877079963684, 0.4404315650463104, -0.028349189087748528, 0.05282377079129219, -0.5866824984550476, 0.4985482692718506, -0.13371823728084564, -0.6659958958625793, 0.05049861967563629, -0.17535553872585297, 0.5995662808418274, -0.09966261684894562, -0.5306220650672913, -0.7533729076385498, -0.7787545323371887, 0.08827412128448486, 0.3492414057254791, 1.287859559059143, 0.3180082440376282, -0.02569289691746235, -0.7795520424842834, 0.3802114725112915, 0.06129945442080498, -0.142551451921463, -0.7439295053482056, -0.2577853500843048, 0.42597031593322754, 0.15424753725528717, -0.3543566167354584, 0.5415096282958984, -0.7057012319564819, -0.8532304763793945, -0.43479692935943604, -0.36005255579948425, 0.27229177951812744, -0.6434849500656128, -0.657936155796051, 1.0409595966339111, -0.19082871079444885, -0.7559413909912109, 0.3220725655555725, -0.6934123039245605, -0.6261036396026611, 0.20464526116847992, -1.2321922779083252, -1.1195905208587646, 0.12709283828735352, 0.06950946897268295, -0.6678279042243958, 0.10312773287296295, 1.2909094095230103, 0.5670223236083984, -0.24248814582824707, -0.11571137607097626, 0.18822050094604492, -0.0786006972193718, 0.11905183643102646, -0.574275016784668, 0.835680365562439, 0.5022605657577515, -0.4186433255672455, 0.22236497700214386, -0.2845374643802643, -0.18138088285923004, -0.8540041446685791, -0.09958328306674957, 0.46277859807014465, -0.7461135983467102, 0.4826629161834717, -1.3257923126220703, -0.35055840015411377, 0.6645429730415344, 0.824112594127655, 0.398082435131073, 0.6330844163894653, -0.03211710974574089, -0.16754351556301117, -0.6395993232727051, -0.9474475383758545, 0.6294956803321838, 0.5655803680419922, -0.9672441482543945, 0.03887564316391945, 0.0773482620716095, -0.048198096454143524, -1.1286718845367432, -1.189757227897644, 0.33972248435020447, 0.013006139546632767, -0.3412556052207947, 0.8606663346290588, 0.5245651006698608, 0.7023639678955078, 0.6771994829177856, -0.239240825176239, -0.45632320642471313, 0.3176076412200928, -1.3649983406066895, -0.6608230471611023, 0.015355223789811134, 0.32678428292274475, -0.49612298607826233, 0.520556628704071, 1.0147806406021118, 0.618179976940155, -0.593267023563385, 0.00636899471282959, 0.3602498173713684, -0.7107758522033691, -0.22181768715381622, 0.4466123580932617, 0.294685423374176, 0.4886523187160492, 0.11062930524349213, 0.4357747435569763, 0.9959613084793091, 0.2675836980342865, -0.20681749284267426, 0.5958347320556641, -0.14872576296329498, -0.18869538605213165, 0.21747976541519165, -0.468378484249115, -1.2937259674072266, -0.018426591530442238, -0.7957779169082642, -0.016128605231642723, -0.6589241027832031, -0.2978932559490204, -0.16912293434143066, -0.4837411940097809, 0.23396193981170654, 0.5170174241065979, 0.02127310074865818, -0.7050080895423889, -0.18969693779945374, -0.9698218107223511, 0.6507900953292847, 0.5098798274993896, -0.2856907844543457, 0.4487561285495758, -0.21333156526088715, -0.06664873659610748, 0.6244977712631226, 0.41266483068466187, -0.19898603856563568, -0.7880443930625916, -0.7780845761299133, -0.05912243574857712, 0.11144236475229263, -0.15593717992305756, -0.9441878795623779, 1.3942806720733643, 0.1491868644952774, -0.043702248483896255, 0.1954297125339508, 0.42003047466278076, -1.7747529745101929, -0.2651461958885193, 0.44856151938438416, 0.12716692686080933, -0.03943634778261185, 0.09721209108829498, -1.0279585123062134, -0.1476878672838211, 1.209924578666687, -0.26779595017433167, -0.3226921558380127, -0.8205525875091553, 0.5479217171669006, -0.4734251797199249, -0.2606077492237091, 0.5497986674308777, -0.009945775382220745, -1.276702880859375, -0.11228195577859879, 0.059760842472314835, 0.1100563034415245, 0.0808487981557846, 0.4701181948184967, 0.11343546211719513, -1.2088462114334106, 0.5232703685760498, 0.8071608543395996, -0.3770484924316406, -0.11813978105783463, 0.10903508961200714, 0.7507966756820679, -0.40844854712486267, 0.13349056243896484, -0.18274818360805511, 0.33113619685173035, -1.0678696632385254, -0.11713746190071106, 0.30094465613365173, -0.7727012038230896, 0.2871847152709961, 0.45747458934783936, -0.545566201210022, -0.5107126832008362, -0.24241948127746582, -0.461301326751709, -0.3919329345226288, -0.7893487811088562, 0.7208262085914612, 0.6785001158714294, 0.20390626788139343, 0.3756142258644104, -0.7047433257102966, 0.17982016503810883, -0.6572765707969666, -0.15271234512329102, 0.42103636264801025, -0.20451150834560394, -1.1241415739059448, 0.2646673619747162, -0.16205494105815887, 0.003419003216549754, -0.32722532749176025, -0.29532361030578613, -0.6588338613510132, -0.16565221548080444, 0.46782007813453674, -0.3513609766960144, -0.5131238698959351, 0.23579531908035278, 0.3617129921913147, 0.843960165977478, 0.3470378816127777, -0.3777672052383423, 0.9246591329574585, 0.16566191613674164, 1.0342681407928467, -0.4966197907924652, -0.6847705245018005, 0.6513093113899231, 0.656277060508728, -0.6651222109794617, 0.6882826685905457, -0.7154217958450317, -0.13139091432094574, 0.8536474108695984, 0.9258904457092285, -0.14278936386108398, 1.3656131029129028, 1.1646121740341187, -0.07604815810918808, 0.03865223750472069, -0.994080662727356, 0.15074634552001953, 0.06025451794266701, 1.2479923963546753, 0.20200707018375397, 0.4967169761657715, -0.030156735330820084, 0.549443781375885, 0.7846491932868958, 0.471841961145401, 0.5466881990432739, 0.9760212898254395, -0.06676293909549713, -0.6738502979278564, -0.5527647137641907, 0.7607002854347229, -0.820742666721344, -0.6876146197319031, 0.013627063482999802, 0.7564048171043396, 0.19680044054985046, 0.45428529381752014, 0.8620482087135315, -0.2533412277698517, 0.05861495062708855, -0.42502549290657043, 0.2641158699989319, -0.7285432815551758, -0.004970144014805555, 0.05562308803200722, -0.3339179456233978, -0.28782376646995544, 0.06993149220943451, 0.2587129771709442, -0.4924149215221405, -0.6511752009391785, 0.2536865174770355, 0.25568199157714844, 0.3696594834327698, 0.6788447499275208, 1.3084715604782104, 0.8256855010986328, 0.011292874813079834, -0.735048770904541, -0.26349201798439026, -0.4618036150932312, -0.2389925718307495, -0.6992014050483704, -0.4382961690425873, 0.11600277572870255, -0.018412526696920395, -0.7114472389221191]}, "authors": [{"authorId": "2306470976", "name": "Yuanxin Wei"}, {"authorId": "2200525415", "name": "Shengyuan Ye"}, {"authorId": "2170744801", "name": "Jiazhi Jiang"}, {"authorId": "2298888845", "name": "Xu Chen"}, {"authorId": "2299353503", "name": "Dan Huang"}, {"authorId": "1384499691", "name": "Jiangsu Du"}, {"authorId": "2267225195", "name": "Yutong Lu"}], "references": [{"paperId": "755f1928f7e8495cb220fe74ab8a5b2617be9989", "title": "Model Parallelism Optimization for Distributed Inference Via Decoupled CNN Structure"}, {"paperId": "16e623059ffccab60f4c35be028a2d4f10933515", "title": "Sequence Parallelism: Long Sequence Training from System Perspective"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "d79a26226393f687ddbc375e32055b40b8ad8d38", "title": "GPipe: Efficient Training of Giant Neural Networks using Pipeline Parallelism"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "05dd7254b632376973f3a1b4d39485da17814df5", "title": "SQuAD: 100,000+ Questions for Machine Comprehension of Text"}, {"paperId": "04ca5de59edbdd49a9c0502c58331524d220bc8c", "title": "Communication Efficient Distributed Machine Learning with the Parameter Server"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "applicable license agreement with IEEE. Restrictions apply"}]}