{"paperId": "6ead954223cdc6f08c7d8b8324b80ec8b0cb2fcd", "title": "Foundation Models Meet Imbalanced Single-Cell Data When Learning Cell Type Annotations", "abstract": "With the emergence of single-cell foundation models, an important question arises: how do these models perform when trained on datasets having an imbalance in cell type distribution due to rare cell types or biased sampling? We benchmark three foundation models, scGPT, scBERT, and Geneformer, using skewed single-cell cell-type distribution for cell-type annotation. While all models had reduced performance when challenged with rare cell types, scGPT and scBERT, performed better than Geneformer. Notably, in contrast to scGPT and scBERT, Geneformer uses ordinal positions of the tokenized genes rather than actual raw gene expression values. To mitigate the effect of a skewed distribution, we find that random oversampling, but not random undersampling, improved the performance for all three foundation models. Finally, scGPT, using FlashAttention, has the fastest computational speed, whereas scBERT is more memory-efficient. We conclude that tokenization and data representation are essential areas of research, and new strategies are needed to mitigate the effects of imbalanced learning in single-cell foundation models. Code and data for reproducibility are available at https://github.com/SabbaghCodes/ImbalancedLearningForSingleCellFoundationModels.", "venue": "bioRxiv", "year": 2023, "citationCount": 4, "influentialCitationCount": 0, "openAccessPdf": {"url": "https://www.biorxiv.org/content/biorxiv/early/2023/10/27/2023.10.24.563625.full.pdf", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "It is concluded that tokenization and data representation are essential areas of research, and new strategies are needed to mitigate the effects of imbalanced learning in single-cell foundation models."}, "embedding": {"model": "specter_v2", "vector": [0.2329268902540207, 0.7289398908615112, -1.0791680812835693, 0.020776836201548576, -0.6011887788772583, 0.3452255427837372, -0.031050188466906548, -0.21698124706745148, -0.2733398675918579, 0.395590215921402, 0.3884665369987488, 0.4040919542312622, 0.3506612777709961, 0.02277887985110283, -0.18241490423679352, -0.480715811252594, -0.9060849547386169, 0.4959930181503296, -0.2280966341495514, 0.48599302768707275, -0.13135460019111633, -0.5981796383857727, -1.2464261054992676, 0.5287050604820251, 0.6023392081260681, 0.7027782201766968, -0.40370550751686096, 1.00318443775177, -0.7126020789146423, 0.33633360266685486, 0.3871360719203949, 0.012111506424844265, 0.3977891504764557, -0.4726842939853668, -0.2357121855020523, -0.2732221782207489, 0.5431373119354248, -0.13125385344028473, -0.545028567314148, 0.494574636220932, 0.06822419166564941, -0.24491772055625916, 0.7123298645019531, -1.084234356880188, 0.3191746175289154, 0.3613484799861908, 0.5472858548164368, 0.6548351645469666, -0.39378058910369873, -0.5607505440711975, 1.3080875873565674, -1.308120608329773, 0.9476237297058105, 1.4631068706512451, 0.6571934819221497, 0.42989715933799744, -0.368007630109787, -0.7583448886871338, 0.24823088943958282, 0.07752519845962524, -0.9333387613296509, -0.30285730957984924, -0.526775598526001, -0.5167872905731201, 1.2946568727493286, -0.30614572763442993, 0.3279723525047302, 0.09497947245836258, 0.05068372189998627, 1.6735605001449585, 0.4141269624233246, -0.4967159926891327, 0.34142252802848816, 0.16178524494171143, 0.19391082227230072, 0.6528604030609131, 0.06715671718120575, 0.22434505820274353, -1.5187724828720093, -0.32908913493156433, 0.3261141777038574, -0.020984861999750137, 0.17863832414150238, 0.1870122253894806, -0.3885956108570099, -0.054852861911058426, 0.1785566359758377, 0.6398602724075317, -0.21825344860553741, 0.6365384459495544, 0.6871122121810913, 0.11528909206390381, -0.1800614595413208, 0.11475072801113129, -0.24203930795192719, 0.3331579566001892, -0.8592243790626526, 0.5082287192344666, 0.060834743082523346, 0.8071492314338684, 0.1797497570514679, 0.37820789217948914, -0.9998427033424377, 0.1560012549161911, 1.0185751914978027, -0.3255683481693268, 0.8128697276115417, -0.7470977902412415, -0.32287341356277466, 0.06572774052619934, 0.49207907915115356, -0.4332656264305115, -0.2471710741519928, -0.5098820924758911, -0.8348869681358337, -1.0588951110839844, 0.31186503171920776, 0.2938461899757385, -0.7372307777404785, 0.3727172315120697, -0.09054452925920486, 0.4297703504562378, 0.13102935254573822, 0.5925115942955017, 0.5170770287513733, -0.09876298904418945, 0.18067637085914612, 0.2922446131706238, 1.0983271598815918, -0.4365345239639282, -0.6904811859130859, -0.2564752995967865, 0.7943220138549805, 0.06158745288848877, -0.08457955718040466, -0.44471320509910583, -1.051174283027649, -0.742904543876648, -0.3384392261505127, 0.1627284437417984, -0.7018850445747375, 0.17433211207389832, 1.3712866306304932, 0.1976342350244522, -0.516176164150238, 0.8046719431877136, -0.12972058355808258, -0.3107132911682129, 0.9671134352684021, 0.014284561388194561, 0.3202102482318878, -0.22710929811000824, -1.0723305940628052, -0.07336638122797012, 0.2193213701248169, -0.8385730385780334, -0.4119150638580322, -1.063772201538086, -0.5114220380783081, -0.07651107758283615, 0.28035977482795715, -0.9613820910453796, 1.0572447776794434, -0.23462718725204468, -0.3475724160671234, 1.2844491004943848, -0.6056960821151733, 0.010642020963132381, 0.6751638650894165, 0.319229394197464, -0.6083930134773254, -0.10079799592494965, -0.03743218258023262, 0.5090498328208923, -0.20380869507789612, -0.6800385117530823, -0.48332515358924866, -0.09170247614383698, -0.7865666747093201, -0.2681216299533844, 0.1091504916548729, 0.24262277781963348, 0.2765021324157715, -0.6101387143135071, 0.3841356039047241, 0.4401267468929291, 0.048810724169015884, 0.4330729842185974, -0.2751912474632263, -0.905503511428833, 0.30080100893974304, 0.21549762785434723, 0.5832177400588989, -0.8004724979400635, -1.0732556581497192, -0.008094320073723793, -0.07149208337068558, -0.2303048074245453, -0.29694682359695435, 0.31199508905410767, -0.12340082973241806, 0.7235932350158691, -0.02678568661212921, -0.6367266774177551, -0.06549528986215591, 0.26566362380981445, -0.4879612922668457, -0.07311323285102844, -0.061730798333883286, 0.8189406394958496, -0.8474666476249695, 0.002890976145863533, -0.6222674250602722, 0.13010290265083313, -1.1233628988265991, 0.5266555547714233, -0.16797949373722076, -0.025944923982024193, 0.2536713182926178, 0.5327140092849731, 0.17850109934806824, -0.028181839734315872, 0.09177357703447342, -0.533484697341919, -0.3623809218406677, 0.40740716457366943, -0.8219014406204224, 0.9009210467338562, -0.10513164848089218, -0.05686067044734955, 0.3977286219596863, -0.7414830923080444, 0.11236385256052017, 0.49732914566993713, 0.25916948914527893, 0.0170181542634964, 0.1351146399974823, 0.6395780444145203, -0.4384528398513794, 0.3297325670719147, 0.5104765295982361, 0.5038267374038696, 0.1275016814470291, -0.20129463076591492, 0.4466577172279358, 0.10876584053039551, 0.5299426913261414, 0.11974049359560013, 0.5504855513572693, 0.2098153680562973, 0.15608441829681396, -0.647998034954071, -0.17015033960342407, -0.8920632600784302, 1.0402581691741943, 0.4180055260658264, 0.3017933666706085, 0.8677481412887573, 0.680094838142395, -0.9015113711357117, -0.28434109687805176, -0.17873601615428925, 0.22873429954051971, 1.0179316997528076, -0.15501156449317932, -0.06421084702014923, -0.3709559738636017, -0.21336738765239716, 0.3082173466682434, -0.04067321866750717, -0.5864660739898682, -0.17892953753471375, -0.10687442868947983, -1.569483757019043, 1.1874914169311523, 0.2807975113391876, 1.0357208251953125, -0.4560261368751526, -0.23223459720611572, -0.4408901333808899, 0.25444990396499634, -0.3623776137828827, -0.17937003076076508, 0.7592672109603882, -0.3016436696052551, -0.16146546602249146, -0.2368018627166748, -0.4405648708343506, 0.3625311553478241, -0.7754652500152588, 0.9577459096908569, 0.006990189664065838, -0.8994519114494324, -0.07609369605779648, 0.7020454406738281, -1.0702592134475708, -0.2500401735305786, 0.2448156177997589, 0.07771238684654236, 0.08601012825965881, 0.3966839909553528, 0.5324781537055969, -0.22813601791858673, 0.4560428261756897, -0.4574407637119293, 0.09102166444063187, 0.22459934651851654, 0.7948979139328003, 0.9913396835327148, 0.017937732860445976, 0.882597029209137, -1.2204668521881104, -0.09973675012588501, -0.11826643347740173, 0.023105749860405922, 0.09084366261959076, -0.6604796051979065, -0.5872599482536316, 0.3698503077030182, -0.22609366476535797, -0.39406782388687134, -0.9979405403137207, 0.3469413220882416, -0.11146389693021774, -0.7178496718406677, 0.07716953009366989, 0.35749638080596924, -0.012654687277972698, 0.2712840437889099, 0.545866847038269, 0.3791518807411194, 0.3092381954193115, -0.27229955792427063, -0.6480122804641724, 0.5548229217529297, 0.07232099026441574, -0.3097916841506958, 0.4926774203777313, 0.3138486444950104, -0.8911718726158142, -0.488331139087677, -0.6027553677558899, -0.2606337070465088, -0.057890333235263824, -0.3326031267642975, -0.9558030366897583, -0.8534669280052185, 0.5421682596206665, -0.3193642795085907, -0.9419958591461182, -0.27331069111824036, 0.06585878878831863, -0.7818741202354431, -1.444887638092041, -1.3025976419448853, -0.7716438174247742, -0.3182682394981384, -0.5234512090682983, 0.7593770623207092, -0.0015249274438247085, -0.682244062423706, -0.37983688712120056, -0.21611812710762024, -0.35608235001564026, 0.4561653733253479, -0.285686194896698, 0.911016047000885, -0.1347045600414276, -0.3923271894454956, -0.2991347908973694, 0.20868566632270813, -0.21365270018577576, -0.1671375334262848, 0.5127400159835815, -0.8379508852958679, 0.37179380655288696, -0.9928140044212341, -0.5551112294197083, 0.48118552565574646, 0.3805945813655853, 1.0077184438705444, -0.0158684179186821, -0.7335147857666016, 0.7051860094070435, 1.1564679145812988, -0.8305296301841736, 0.30186450481414795, -0.12238620221614838, 0.5562617182731628, 0.5217007994651794, 0.12972992658615112, 0.8233986496925354, 0.3460119962692261, 0.34478089213371277, 0.26209312677383423, -0.3933868408203125, -0.35280317068099976, -0.5820314884185791, -0.1473962515592575, 0.6818866729736328, 0.40057045221328735, -0.06010984256863594, -0.9024583101272583, 1.0920653343200684, -1.2016481161117554, -0.9904071092605591, 0.5266306400299072, 0.921222448348999, 0.37184271216392517, -0.4359852373600006, 0.16517609357833862, 0.2671715319156647, 0.3454454839229584, -0.4794321656227112, -0.5878528952598572, 0.09049740433692932, -0.4565090239048004, -0.02602723240852356, 0.6657803654670715, 0.20686174929141998, 0.15100426971912384, 0.1474548876285553, 15.24475383758545, 0.8742960691452026, -0.12295623123645782, -0.025393420830368996, 1.3966530561447144, 0.0858277752995491, -0.8621802926063538, -0.13564394414424896, -1.4757620096206665, 0.32452112436294556, 0.7138465642929077, 0.17109429836273193, 0.4994003474712372, 0.18834330141544342, -0.055894020944833755, -0.0918576791882515, -0.2993858754634857, 0.39600902795791626, 0.09327413886785507, -1.3479396104812622, 0.3887957036495209, 0.23612728714942932, 0.7199715971946716, 0.33589959144592285, 0.6569457054138184, 0.38967078924179077, 0.21149423718452454, -0.6189716458320618, 0.4303332567214966, 0.6138060092926025, 0.9323990941047668, -0.06970912218093872, 0.9207960963249207, 0.3137865662574768, -0.6626152396202087, 0.19719867408275604, -0.6141001582145691, -1.2217013835906982, -0.09527560323476791, 0.7592030763626099, -1.3655692338943481, -0.36771851778030396, 0.007222742307931185, 0.6421617269515991, 0.596990704536438, 0.6523153185844421, 0.4504660665988922, 0.742800772190094, -0.014812562614679337, 0.06101439520716667, -0.6212769746780396, 0.8670759797096252, 0.27197265625, 0.19831906259059906, 0.25650057196617126, -0.35885384678840637, 0.39555394649505615, 0.3061990737915039, -0.5095627307891846, -0.2060541808605194, -0.3014281988143921, -0.13546516001224518, 0.06504834443330765, 1.3267802000045776, 0.005585061851888895, -0.07328446954488754, -0.391541451215744, -0.06421545147895813, 0.37633681297302246, 0.09845826774835587, 0.3034369945526123, -0.1624949872493744, 0.9886404275894165, -0.1340949386358261, -0.32243987917900085, 1.0068711042404175, -0.8101773858070374, -0.43403419852256775, -1.1168298721313477, -0.07073330879211426, 0.761834442615509, -0.4674079716205597, -0.9601228833198547, 0.23811064660549164, -0.4772489368915558, -0.38995248079299927, 0.28335657715797424, -1.1072510480880737, -0.3213650584220886, 0.45002317428588867, -1.2826303243637085, -0.6948770880699158, -0.17947348952293396, -0.5783341526985168, -0.5065603256225586, -0.07176192849874496, 1.2924036979675293, 0.04242381453514099, -0.5562887787818909, 0.3892364501953125, 0.2644881010055542, -0.12900501489639282, 0.36506080627441406, -1.2449254989624023, 0.481406033039093, -0.4573821425437927, -0.330304354429245, 0.32800862193107605, 0.18006044626235962, 0.1334528923034668, -0.34831005334854126, -0.40520983934402466, 0.6872361898422241, -0.579322874546051, -0.6003932356834412, -0.41901329159736633, -1.1350021362304688, 0.18584302067756653, 0.2734312117099762, 0.3627069890499115, 1.061387538909912, 0.11947645246982574, -0.017242154106497765, -0.4458611309528351, -1.1413707733154297, 0.20890292525291443, 0.9198615550994873, -0.6064474582672119, 0.0788918063044548, -0.0714343786239624, -0.4322754442691803, -1.1050091981887817, -1.0505441427230835, -0.19400128722190857, 0.6423419117927551, -0.163278266787529, 0.7975157499313354, -0.6889901161193848, 0.39894333481788635, 0.4410872757434845, -0.008488339371979237, -1.318830132484436, -0.3222552537918091, -0.7836278676986694, 0.2729792594909668, 0.34559527039527893, 0.42373740673065186, -0.6222922205924988, 0.7135852575302124, 0.45850807428359985, -0.35536783933639526, -0.9592044949531555, -0.7511255741119385, -0.2772550880908966, 0.07115189731121063, 0.49956759810447693, 0.5903902649879456, 0.1816309243440628, 0.28752055764198303, -0.5313333868980408, 0.7806549072265625, -0.0021032453514635563, -0.3726380467414856, -0.45501837134361267, 0.6035141944885254, -0.05027429014444351, 0.1923360824584961, -0.6058991551399231, -0.42708826065063477, -0.908247709274292, 0.06315983086824417, -1.407127022743225, 0.2159229815006256, -0.42821991443634033, -0.42012301087379456, -0.3183944523334503, -0.5895638465881348, 0.039261214435100555, 0.027986403554677963, -0.04941042885184288, -1.3397343158721924, -0.6488574147224426, -0.31769824028015137, 0.5828731060028076, 0.8859111070632935, -0.5770317316055298, 0.3031483590602875, -0.2030867487192154, -0.19888827204704285, 0.7261972427368164, 0.6998587250709534, -0.2013799250125885, -0.19876621663570404, -0.5803629159927368, 0.3677559196949005, -0.3017710745334625, 0.16260023415088654, -0.7634279131889343, 0.5929393172264099, 0.1496717780828476, 0.3796311318874359, -0.39584240317344666, -0.06128310039639473, -0.6114926338195801, 0.09544750303030014, 0.577802300453186, -0.8628140091896057, -0.305242121219635, -0.07511641830205917, -0.5643229484558105, -0.29758110642433167, 0.5360937118530273, -0.1425514668226242, -1.4505378007888794, -0.31889116764068604, 0.4374781847000122, -0.7473518252372742, 0.3873960077762604, -0.2074432075023651, -0.40895557403564453, -1.1246687173843384, 0.018824679777026176, 0.06632034480571747, 0.5781103372573853, 0.26618799567222595, 0.32331031560897827, -0.029917465522885323, -1.325413465499878, 0.14941270649433136, 0.3213512897491455, 0.20841287076473236, 0.3500605523586273, 0.6155121922492981, 0.5462751388549805, -0.1930122971534729, 0.6479767560958862, -0.21911004185676575, 0.44867417216300964, -0.574603796005249, -0.17940479516983032, 0.5083488821983337, -0.17239835858345032, 0.4040992856025696, 0.9974493980407715, 0.00424207653850317, -0.8027969598770142, 0.019813481718301773, -1.3550983667373657, -0.18883207440376282, 0.04450276121497154, 0.513830304145813, 1.167862057685852, -0.07095634937286377, -0.09760311990976334, -0.5301527380943298, -0.20342358946800232, -0.1726941168308258, -0.18940187990665436, 0.1326821893453598, 0.10378418862819672, -0.159134641289711, 1.08970046043396, 0.49542760848999023, -0.41070693731307983, -0.6696831583976746, -0.10074075311422348, -0.42999184131622314, -0.41107338666915894, -0.11629603058099747, -0.4028358459472656, -0.5997825264930725, 0.26018932461738586, 0.19439969956874847, 0.20673233270645142, -0.39629730582237244, -0.45656049251556396, -0.004062920808792114, 0.37600743770599365, 0.36528313159942627, -1.049774169921875, -0.5971556901931763, 0.763827919960022, 0.7800465226173401, -0.6464722156524658, 0.24985812604427338, -0.7349029183387756, -0.5333612561225891, 0.4926304519176483, 0.8130571246147156, 0.11764705181121826, 0.47103366255760193, -0.1747850775718689, 0.13099727034568787, 0.270489901304245, -1.2884736061096191, -0.15056848526000977, 0.1505012959241867, 1.2027517557144165, 0.9678585529327393, 0.4290616512298584, -0.13425138592720032, 1.0773284435272217, 0.10941660404205322, 0.5865275859832764, 0.47633931040763855, 0.24030645191669464, -0.1978381872177124, 0.3661462068557739, 0.2948765158653259, 1.31667160987854, -0.756507396697998, -0.04139208421111107, -0.06699781864881516, 0.16592808067798615, 0.5897811651229858, -0.07353243231773376, 1.127602458000183, 0.3662493824958801, 0.17581170797348022, 0.5089197158813477, 0.2866899073123932, -0.28245848417282104, -0.22359952330589294, -0.22343812882900238, -0.2183288335800171, -0.06043237820267677, -0.11743263900279999, -0.937486469745636, -0.7642865777015686, 0.16043131053447723, 0.16141660511493683, 0.08641495555639267, -0.1787315011024475, 0.8031507730484009, 1.0831767320632935, 0.4687463641166687, -0.4070509076118469, -0.19559726119041443, -0.01302933320403099, -0.5162501931190491, -0.37597447633743286, -0.2826853096485138, -0.036690887063741684, -0.5467633605003357, -0.554713785648346, -0.03894371911883354]}, "authors": [{"authorId": "2262452280", "name": "Abdel Rahman Alsabbagh"}, {"authorId": "2262452653", "name": "Alberto Maillo Ruiz de Infante"}, {"authorId": "2257106720", "name": "D. G\u00f3mez-Cabrero"}, {"authorId": "1837448", "name": "N. Kiani"}, {"authorId": "2047497381", "name": "S. Khan"}, {"authorId": "2242970505", "name": "Jesper N. Tegn\u00e9r"}], "references": [{"paperId": "7d1e59ce254bea5228da634dbe7c5c4160df6f98", "title": "Transfer learning enables predictions in network biology"}, {"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "99a45d80c819b2b03efc3c73bc1b157731e03900", "title": "Translating single-cell genomics into cell types"}, {"paperId": "edb5495bc9081f2adfc8de51e0981510802e4090", "title": "scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "f9db4fd0a14737ca805035971927314cc76b17eb", "title": "STATegra: Multi-Omics Data Integration \u2013 A Conceptual Scheme With a Bioinformatics Pipeline"}, {"paperId": "528a4b80d00afbd6a41c56b9bf0794d21592cde1", "title": "Neuronal vulnerability and multilineage diversity in multiple sclerosis"}, {"paperId": "ed5d6be2eb8fc1d42f9a0e3c50abaf5439bbd8dd", "title": "Deep Generative Modeling for Single-cell Transcriptomics"}, {"paperId": "17422a9fcf3f05408f7f2f270b127aa812e9b2b3", "title": "Massively parallel digital transcriptional profiling of single cells"}, {"paperId": "424ae6d937afc84f6c019779ab74e5aacfbf0fc5", "title": "Bioinformatics Mining and Modeling Methods for the Identification of Disease Mechanisms in Neurodegenerative Disorders"}, {"paperId": "88399c4c6574be850918a1bce2dede2c87ef8241", "title": "scGPT: Towards Building a Foundation Model for Single-Cell 1 Multi-omics Using Generative AI"}, {"paperId": "12d4d1b8321f8b1a527d89477056b78d87e01328", "title": "BMC Systems Biology"}, {"paperId": null, "title": "GPT-4 Technical Report, March 2023"}]}