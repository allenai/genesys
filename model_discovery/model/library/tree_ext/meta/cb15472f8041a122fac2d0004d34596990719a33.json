{"paperId": "cb15472f8041a122fac2d0004d34596990719a33", "title": "Unveiling and Controlling Anomalous Attention Distribution in Transformers", "abstract": "With the advent of large models based on the Transformer architecture, researchers have observed an anomalous phenomenon in the Attention mechanism--there is a very high attention on the first element, which is prevalent across Transformer-based models. It is crucial to understand it for the development of techniques focusing on attention distribution, such as Key-Value (KV) Cache compression and infinite extrapolation; however, the latent cause leaves to be unknown. In this paper, we analyze such a phenomenon from the perspective of waiver phenomenon, which involves reducing the internal values of certain elements in the sequence, allowing them to absorb excess attention without affecting their contribution to information. In specific models, due to differences in positional encoding and attention patterns, we have found that the selection of waiver elements by the model can be categorized into two methods: positional-encoding-based and feature-distribution-within-elements-based.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": null, "embedding": {"model": "specter_v2", "vector": [0.051769815385341644, 0.3295939266681671, -0.9048656225204468, 0.35062482953071594, -0.3888230323791504, 0.02600991725921631, -0.11400187760591507, 0.24877053499221802, -0.10644182562828064, -0.00146867532748729, 0.833455502986908, -0.20028048753738403, 0.025095637887716293, -0.24724872410297394, -0.016059553250670433, -0.23530282080173492, -0.8820816278457642, 0.07028466463088989, 0.681117594242096, -0.11802234500646591, 0.3827386200428009, -0.47368642687797546, -1.4012762308120728, 0.4268040359020233, 0.6643549203872681, 1.2510112524032593, -0.12577340006828308, 0.6422622203826904, -0.4758300185203552, 0.9339130520820618, 0.6208238005638123, -0.08218596875667572, 0.2644857168197632, -0.06777837872505188, -0.21623052656650543, -0.25178495049476624, 0.41711166501045227, -0.46229904890060425, -0.5936133861541748, 0.5013112425804138, -0.30316781997680664, -0.16299393773078918, 0.2562706768512726, -1.0364410877227783, 0.03257034718990326, 0.8085726499557495, 0.46594443917274475, 1.140953540802002, -0.45272403955459595, -0.7504998445510864, 1.5295590162277222, -1.2549103498458862, -0.4437647759914398, 0.553581953048706, 0.3673914074897766, -0.12622036039829254, -0.1523963361978531, -0.15957148373126984, 0.22194024920463562, 0.437325656414032, -0.6307334899902344, -0.5552213191986084, 0.29784294962882996, -0.11099767684936523, 1.6347522735595703, 0.11869390308856964, 0.48277443647384644, -0.1564527004957199, 0.2820698320865631, 1.3520938158035278, -0.1753343641757965, -1.07879638671875, 0.20672103762626648, -0.01589941792190075, 0.7274509072303772, 0.5389739274978638, -0.24127312004566193, -0.03099856525659561, -1.1397192478179932, -0.6108113527297974, 0.7098925709724426, 0.09783713519573212, -0.13344888389110565, -0.8077625632286072, 0.2504364550113678, 0.531719982624054, -0.05335433781147003, 0.7697009444236755, -0.5256643295288086, 0.6814197897911072, 0.6671068072319031, 0.347714364528656, -0.19437870383262634, 0.16967672109603882, -0.1332695633172989, -0.2868824899196625, -1.0420751571655273, -0.26856276392936707, 0.05537262558937073, 0.9806894659996033, -0.33154070377349854, 0.5412852168083191, -0.8673287630081177, 0.1227194145321846, 0.9487472176551819, -0.42737239599227905, 0.5153946876525879, -0.5702841877937317, 0.08948717266321182, -0.3189014494419098, 0.49214309453964233, -0.2156360149383545, 0.453924298286438, -0.24900475144386292, -0.787691056728363, -0.7488520741462708, -0.38193804025650024, 0.7086188793182373, -0.5361381769180298, 0.061997052282094955, -0.7471805214881897, 0.01365995779633522, -0.38012123107910156, 0.17223146557807922, 0.005751799326390028, 0.14892764389514923, 0.2736368477344513, -0.3904913663864136, 0.8146766424179077, -0.757468044757843, -0.6382348537445068, -0.4883895218372345, 0.3853096663951874, -0.34318897128105164, 0.3436608910560608, -0.33320215344429016, -1.5750885009765625, -0.9260156154632568, -0.9727596044540405, 0.5497086644172668, 0.0035452700685709715, -0.3368709981441498, 0.7719523906707764, 0.1767704337835312, -1.5844866037368774, 0.5279297828674316, -0.2534792721271515, -0.06374204158782959, 0.5617687106132507, 0.2427537441253662, 0.9825186729431152, 0.08538768440485, -1.1493616104125977, -0.03599838539958, -0.010691388510167599, -1.3743815422058105, -0.22698147594928741, -1.0474321842193604, -0.8776668906211853, 0.624706506729126, 0.4147019684314728, -0.2198730707168579, 1.090519666671753, 0.1371021717786789, -0.39350950717926025, 0.16449905931949615, -0.13468176126480103, -0.013388162478804588, 0.08887282758951187, -0.21572403609752655, -0.2667650282382965, -0.00046485610073432326, -0.368130087852478, 0.06648717820644379, 0.7252523303031921, -0.49086081981658936, -0.232171893119812, 0.13002921640872955, -0.4878455102443695, -0.13121895492076874, -0.8741083741188049, 0.9354081153869629, -0.33151009678840637, -0.16179190576076508, 0.5216249823570251, 1.069715142250061, -0.027973352000117302, 0.20060886442661285, -0.07914506644010544, -0.656116783618927, 0.6964481472969055, -0.0007277585100382566, 1.975307583808899, -0.6842113137245178, -1.1839017868041992, -0.027273545041680336, 0.0075835175812244415, -0.12353881448507309, -0.2097630351781845, 0.6753389239311218, -0.5760644674301147, 0.3807964324951172, -0.004271306563168764, 0.01970701664686203, -0.3927745223045349, -0.3756805956363678, -1.0652341842651367, -0.42713868618011475, -0.5644625425338745, 0.8294146656990051, -0.754666805267334, -0.2003423124551773, 0.019961975514888763, 0.13680030405521393, -0.7845736742019653, 1.1677193641662598, -0.354127436876297, -0.08615543693304062, -0.5023120641708374, 0.038077931851148605, 0.21665535867214203, -0.4317137598991394, 0.2347305864095688, -0.6426708698272705, -0.19790388643741608, 0.30456221103668213, 0.08785256743431091, 0.7892518043518066, 0.18993893265724182, 0.24654054641723633, -0.29433512687683105, -0.5802172422409058, 0.29320457577705383, 0.6617359519004822, 0.6461771130561829, -0.8108687400817871, 0.42709818482398987, 0.10152223706245422, -0.575289785861969, 0.2615739703178406, 1.217456340789795, 1.215806007385254, -0.7429221272468567, 0.4536682367324829, 0.32773545384407043, -0.12475176155567169, 0.33465006947517395, 0.5454539060592651, 0.6326077580451965, 0.02636375091969967, 0.6106148958206177, -0.6629941463470459, 0.37395814061164856, -0.8315449953079224, -0.06745810061693192, 0.5581888556480408, 0.3914439380168915, 0.7597653865814209, 0.5279901027679443, -0.785891592502594, -0.9298882484436035, 0.17272092401981354, 0.6690614819526672, 1.4621204137802124, -0.10961361974477768, -0.6537995934486389, -0.5679876208305359, -0.13748779892921448, -0.3975803256034851, 0.533882737159729, -0.01772456057369709, -0.5324932932853699, -0.29931730031967163, -0.6373136043548584, 0.8438994884490967, 0.7022413015365601, 0.9361737966537476, -0.6284581422805786, -0.9149504899978638, -0.058694988489151, 0.3545750379562378, -0.4189271628856659, -0.5375691056251526, 0.6238635182380676, -0.8603538870811462, -0.13698576390743256, 0.2931424379348755, -0.11166136711835861, -0.05839201807975769, -0.4290655553340912, 1.3661071062088013, 0.2679556906223297, 0.08715960383415222, 0.6505061388015747, 0.39965176582336426, -0.5501163005828857, -0.5649453997612, 0.18601849675178528, -0.17263826727867126, -0.6652711629867554, 0.7021209001541138, 0.3036203682422638, 0.03575938194990158, 0.06404843926429749, -0.5159341096878052, -0.2759498059749603, -0.03233673796057701, 0.010105488821864128, 0.7191510796546936, -0.13191251456737518, -0.207627072930336, -0.39315399527549744, 1.239844799041748, 0.24575671553611755, -0.6468682289123535, 0.3322815001010895, -0.8854013681411743, -0.2725133001804352, 0.5097379684448242, -0.38824930787086487, 0.36846303939819336, -1.5699433088302612, 0.43292441964149475, -0.34739795327186584, -0.03277729079127312, -0.12949874997138977, -0.046723511070013046, -0.2733195126056671, -0.3428804874420166, 1.1750338077545166, 0.12437489628791809, 0.042942244559526443, 0.08580384403467178, -0.5872897505760193, 0.14660847187042236, -0.04422619193792343, -0.6930406093597412, -0.4159456789493561, -0.1743304431438446, -0.6904880404472351, -0.08773884922266006, -0.030549222603440285, -0.41227373480796814, -0.19642020761966705, -0.2717351019382477, -0.5292011499404907, -0.5880757570266724, 0.049761321395635605, -0.5948435068130493, -0.4504436254501343, -0.3276861011981964, -0.47179028391838074, -0.45768067240715027, -1.0011147260665894, -1.248572587966919, -0.44232332706451416, -0.9178543090820312, -1.2117422819137573, -0.1090119257569313, -0.13607542216777802, -0.5476051568984985, -0.4027455747127533, -0.45044374465942383, -0.7103545069694519, 1.3788518905639648, -0.8910048007965088, 1.3251432180404663, -0.4445377290248871, -0.7094298005104065, 0.2239825576543808, 0.4538535177707672, 0.3721683919429779, 0.06428954005241394, -0.15588653087615967, -0.3148212730884552, 0.31474995613098145, 0.5184512734413147, -0.06752239912748337, -0.011043814942240715, 0.362854540348053, 1.3708890676498413, -0.15420712530612946, -0.3424918055534363, -0.15917620062828064, 1.3077828884124756, -0.248724564909935, 0.5186116695404053, 0.34118717908859253, 0.946571409702301, -0.3088856637477875, 0.2901841104030609, 0.984301745891571, -0.20158718526363373, 0.3776209056377411, 0.5902552604675293, -0.02764102630317211, -0.18266379833221436, -0.0881882905960083, 0.25964343547821045, 1.9919863939285278, 0.2716366946697235, -0.14781130850315094, -0.8645684123039246, 0.8083625435829163, -1.129502773284912, -0.6713482141494751, 0.6633028388023376, 1.2638145685195923, 0.4598820209503174, -0.31063324213027954, -0.3407505452632904, 0.4885435998439789, 0.492483526468277, 0.35971471667289734, -0.23616985976696014, -0.7298569083213806, 0.3720702528953552, 0.46448013186454773, 0.40797194838523865, 0.6686949133872986, 0.3102603256702423, 0.42375242710113525, 14.963122367858887, 1.1701903343200684, 0.03591547906398773, 0.4901998043060303, 0.6634020209312439, 0.41478392481803894, -0.7236840724945068, 0.028366437181830406, -0.9174437522888184, 0.6295186877250671, 1.6482301950454712, -0.19937704503536224, 0.10657410323619843, 0.1753607988357544, -0.208115354180336, -0.0991600826382637, -0.10264107584953308, 0.4777224063873291, 0.6122408509254456, -1.2771574258804321, 0.7993065714836121, 0.35942938923835754, -0.18125878274440765, -0.11303360760211945, 0.7336602807044983, 0.29197952151298523, 0.3362112045288086, -0.0691966712474823, 0.7158700823783875, 0.06742855906486511, 0.979280948638916, -0.7590216994285583, 0.40551963448524475, 0.23538409173488617, -1.0118831396102905, -0.10729542374610901, -0.8474283218383789, -1.1736942529678345, 0.1334378719329834, 0.19462400674819946, -0.5560498237609863, -0.7276013493537903, -0.1056629866361618, 0.003508318215608597, 0.09057538956403732, 0.5909614562988281, -0.4070819616317749, 0.8641979098320007, 0.17573665082454681, 0.15899021923542023, -0.03448585048317909, 0.3845628499984741, 0.18062347173690796, -0.6558114290237427, 0.25512054562568665, -0.07828746736049652, 0.24830058217048645, 0.03482917323708534, -0.3258897066116333, -0.28948789834976196, -0.3691386878490448, -0.035910267382860184, 0.2694334387779236, 0.44992324709892273, 0.27755123376846313, 0.038640882819890976, -0.4372268617153168, 0.1127457320690155, 0.18338890373706818, -0.17106863856315613, -0.6381481885910034, -0.05464469641447067, 0.504460871219635, 0.015056452713906765, 0.18757642805576324, 0.8156392574310303, -0.6158032417297363, -0.3206224739551544, -1.0391120910644531, -0.43115007877349854, 0.42058834433555603, -0.9893205761909485, -0.24445892870426178, 1.04393470287323, 0.12520232796669006, -0.6980108618736267, 0.36758992075920105, -0.15178711712360382, -0.276095986366272, 0.0015230586286634207, -0.7997338175773621, -0.6884127855300903, 0.09037607908248901, 0.14798098802566528, -0.2881387174129486, 0.0037632363382726908, 0.9994962215423584, -0.1420559138059616, 0.13622821867465973, 0.2852534353733063, 0.0389850027859211, -0.2296883910894394, -0.1601874679327011, -0.6984172463417053, 0.7130517959594727, 0.43458157777786255, -0.17358048260211945, 0.00040269139572046697, 0.08044333755970001, 0.23832455277442932, -0.7074502110481262, -0.04657133296132088, 0.4773954749107361, -0.7436522841453552, -0.23007884621620178, -0.7233567833900452, -1.4676244258880615, 0.40567854046821594, 1.0514072179794312, -0.08791478723287582, 0.4497356712818146, -0.23824214935302734, -0.018024059012532234, -0.2833205461502075, -0.9628521203994751, 0.04752523452043533, 0.4168935716152191, -0.6829022765159607, -0.263251930475235, -0.6556633114814758, 0.563784122467041, -0.837941586971283, -0.8554966449737549, -0.3012000322341919, -0.10988037288188934, -0.6891411542892456, 1.095548152923584, -0.29680389165878296, 0.46584799885749817, 1.0621646642684937, -0.4445337951183319, -0.6852228045463562, -0.6202089190483093, -0.6061299443244934, -0.4182576537132263, 0.7354900240898132, 0.2973063886165619, -0.49470219016075134, 0.5613318681716919, 1.2292062044143677, 0.06852509081363678, -0.5302049517631531, -0.5039069056510925, 0.19224853813648224, 0.005319515708833933, -0.7034634351730347, 0.7178332209587097, -0.2666202187538147, 0.2039727419614792, -0.14634665846824646, 0.2670997381210327, 0.3713063895702362, -0.092469222843647, -0.6356125473976135, -0.06678097695112228, -0.03955993056297302, 0.3697340488433838, -0.21305933594703674, -0.4748598635196686, -1.0277866125106812, -0.32117021083831787, -0.7282476425170898, -0.016608046367764473, -0.7748053669929504, -0.1921592503786087, -0.010116368532180786, -0.7907990217208862, 0.3223583698272705, 0.5449388027191162, -0.40279966592788696, -0.6008430123329163, -0.09536860883235931, -0.7343845367431641, 0.7583383917808533, 0.7072968482971191, -0.35542353987693787, 0.16092252731323242, -0.1623174250125885, -0.4968251585960388, 0.2679090201854706, 0.821611762046814, -0.6229503154754639, -0.9650192260742188, -1.0336906909942627, -0.0677439495921135, -0.13729502260684967, -0.3847685754299164, -0.8745399713516235, 1.1258172988891602, 0.4116232395172119, 0.12089841812849045, -0.46702975034713745, 0.30320900678634644, -1.3422387838363647, -0.5233665108680725, 0.45777297019958496, -0.6431646347045898, 0.42097124457359314, 0.5154189467430115, -0.8589686155319214, -0.27692094445228577, 0.6198986172676086, -0.008042031899094582, -0.9886431097984314, -1.160025954246521, 0.4253343641757965, -0.8193824291229248, 0.32590872049331665, 0.12981991469860077, -0.39807865023612976, -0.918256402015686, -0.3575551509857178, 0.12223761528730392, 0.005424892995506525, 0.39789000153541565, 0.7581396698951721, 0.6461896896362305, -1.2267709970474243, 0.40832358598709106, 0.9422584772109985, 0.013554738834500313, -0.4311801791191101, 0.18526124954223633, 0.4245833158493042, -0.05567215383052826, 0.4686049818992615, -0.037046533077955246, 0.003585174446925521, -1.0518038272857666, 0.19638711214065552, 0.09318587929010391, -0.5422469973564148, -0.16140101850032806, 0.6069177389144897, -0.742673397064209, -0.07808968424797058, -0.03750152140855789, -1.3874149322509766, -0.7865352630615234, -0.33361610770225525, 0.8739697337150574, 0.3641313910484314, -0.05853274464607239, -0.039738256484270096, -0.5050114989280701, 0.16129639744758606, -0.32406002283096313, -0.07800454646348953, 0.2760200500488281, -0.40372347831726074, -0.6341410279273987, 0.6247032880783081, 0.14508770406246185, -0.38243505358695984, -0.6511713862419128, -0.17387445271015167, -0.1214851438999176, -0.7740982174873352, 0.47921690344810486, 0.005661686882376671, -0.8073310852050781, 0.6932845115661621, 0.7038226127624512, 0.7532275319099426, 0.4703453779220581, -0.09030772000551224, 0.20987199246883392, -0.16630233824253082, 0.7063693404197693, -0.32650449872016907, -0.262850284576416, 1.1867666244506836, 1.0820114612579346, -0.13267767429351807, 0.5556747317314148, -0.07450763881206512, -0.7550947070121765, 0.9884453415870667, 0.700615644454956, 0.15791456401348114, 0.7149927020072937, 0.5396144986152649, 0.01594267040491104, 0.19375278055667877, -1.2442865371704102, 0.11015497148036957, 0.13561230897903442, 1.1740845441818237, 0.6335174441337585, -0.04800751805305481, 0.23517195880413055, 0.8496348261833191, 0.43367108702659607, 0.6823104619979858, 1.0196870565414429, 0.921294093132019, -0.838634192943573, -0.22454781830310822, -0.2639288902282715, 1.098784327507019, -0.8533868193626404, -1.0334079265594482, 0.4340444803237915, 0.9048985838890076, -0.1593707948923111, 0.4288960099220276, 1.0641016960144043, -0.41772156953811646, 0.47032493352890015, 0.15453504025936127, 0.5078038573265076, -0.269674688577652, -0.42904841899871826, -0.0026320400647819042, -0.8281528353691101, -0.1033419668674469, 0.04034024104475975, -0.29079288244247437, -0.2247132658958435, -0.17941927909851074, 0.22023987770080566, 0.6266898512840271, -0.45879533886909485, 0.39597800374031067, 0.9736456274986267, 0.9176879525184631, -0.45158010721206665, -0.3139173686504364, -0.5711973905563354, -0.915726900100708, -0.2603979706764221, -0.6436418294906616, -0.2613767385482788, -0.06270179897546768, -0.26815560460090637, -0.6222285032272339]}, "authors": [{"authorId": "2309246996", "name": "Ruiqing Yan"}, {"authorId": "2309791351", "name": "Xingbo Du"}, {"authorId": "2309735656", "name": "Haoyu Deng"}, {"authorId": "2309258015", "name": "Linghan Zheng"}, {"authorId": "2309790996", "name": "Qiuzhuang Sun"}, {"authorId": "2309301061", "name": "Jifang Hu"}, {"authorId": "2310188408", "name": "Yuhang Shao"}, {"authorId": "2309251352", "name": "Penghao Jiang"}, {"authorId": "2309244968", "name": "Jinrong Jiang"}, {"authorId": "2309270155", "name": "Lian Zhao"}], "references": [{"paperId": "6c323c535365e1c7cbfd9703cbec3b5650a3346b", "title": "Model Tells You What to Discard: Adaptive KV Cache Compression for LLMs"}, {"paperId": "fdc53c2c10742464087c0525f77e32604827a21d", "title": "Efficient Streaming Language Models with Attention Sinks"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "b6d6c33298b852cf63edac233deca70530d69a2a", "title": "PaLM 2 Technical Report"}, {"paperId": "163b4d6a79a5b19af88b8585456363340d9efd04", "title": "GPT-4 Technical Report"}, {"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "6edccbd83a9aae204785d4821f97855677c33866", "title": "Scaling Laws vs Model Architectures: How does Inductive Bias Influence Scaling?"}, {"paperId": "094ff971d6a8b8ff870946c9b3ce5aa173617bfb", "title": "PaLM: Scaling Language Modeling with Pathways"}, {"paperId": "d766bffc357127e0dc86dd69561d5aeb520d6f4c", "title": "Training language models to follow instructions with human feedback"}, {"paperId": "d8d2e574965fe733eb1416e03df2b5c2914fc530", "title": "A Survey of Transformers"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "7a064df1aeada7e69e5173f7d4c8606f4470365b", "title": "ALBERT: A Lite BERT for Self-supervised Learning of Language Representations"}, {"paperId": "f6390beca54411b06f3bde424fb983a451789733", "title": "Adaptively Sparse Transformers"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": null, "title": "How do language models put attention weights over long context?"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "Introducing meta"}, {"paperId": null, "title": "We believe that understanding and leveraging the waiver phenomenon can lead to more robust and efficient models, particularly in resource-constrained environments"}]}