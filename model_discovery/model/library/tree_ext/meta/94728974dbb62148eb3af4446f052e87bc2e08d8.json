{"paperId": "94728974dbb62148eb3af4446f052e87bc2e08d8", "title": "Towards Coarse-to-Fine Evaluation of Inference Efficiency for Large Language Models", "abstract": "In real world, large language models (LLMs) can serve as the assistant to help users accomplish their jobs, and also support the development of advanced applications. For the wide application of LLMs, the inference efficiency is an essential concern, which has been widely studied in existing work, and numerous optimization algorithms and code libraries have been proposed to improve it. Nonetheless, users still find it challenging to compare the effectiveness of all the above methods and understand the underlying mechanisms. In this work, we perform a detailed coarse-to-fine analysis of the inference performance of various code libraries. To evaluate the overall effectiveness, we examine four usage scenarios within two practical applications. We further provide both theoretical and empirical fine-grained analyses of each module in the Transformer architecture. Our experiments yield comprehensive results that are invaluable for researchers to evaluate code libraries and improve inference strategies.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work performs a detailed coarse-to-fine analysis of the inference performance of various code libraries and provides both theoretical and empirical fine-grained analyses of each module in the Transformer architecture."}, "embedding": {"model": "specter_v2", "vector": [-0.12115943431854248, 0.47128188610076904, -0.7117204070091248, 0.002009846968576312, -0.719702422618866, -0.061266496777534485, 0.482799768447876, -0.4597316384315491, -0.32300233840942383, -0.069822758436203, 0.45908838510513306, -0.4237353503704071, 0.2171851098537445, 0.12003818154335022, -0.19210070371627808, 9.598973520041909e-06, -0.8342421650886536, 0.586460530757904, -0.10686805099248886, -0.3362005949020386, -0.5535467267036438, -0.3689022958278656, -1.1704301834106445, -0.14954786002635956, 0.784838855266571, 0.20781868696212769, 0.4301755428314209, 0.6947439908981323, -0.5081637501716614, 0.36596187949180603, 0.8228477239608765, -0.4519534707069397, 0.18205291032791138, 0.23997336626052856, 0.06365891546010971, -0.14142295718193054, -0.028050722554326057, -0.5372259020805359, -0.29839688539505005, 1.0769238471984863, -0.2533165514469147, 0.19510017335414886, 0.198554128408432, -1.2663884162902832, -0.2219596654176712, 0.8355982303619385, 0.29737773537635803, 0.6987856030464172, -0.36293473839759827, -0.3764340579509735, 1.3815536499023438, -1.3132015466690063, 0.12575262784957886, 1.5733426809310913, 0.32201746106147766, 0.05076538771390915, -0.36592042446136475, -1.0049281120300293, 0.27011629939079285, -0.45951220393180847, -1.2378324270248413, -0.8206560611724854, -0.15736867487430573, -0.16271355748176575, 1.9845045804977417, -0.0360986702144146, -0.33606380224227905, 0.23928864300251007, -0.10359423607587814, 1.357014775276184, -0.2834729254245758, -0.86066073179245, -0.14729814231395721, -0.12708847224712372, -0.09251736104488373, 1.0823372602462769, -0.12404770404100418, 0.27223658561706543, -0.8871375918388367, -0.4647173583507538, 0.11211419105529785, -0.11051104962825775, 0.15634199976921082, -0.19766224920749664, 0.05241512507200241, 1.0494859218597412, -0.17151892185211182, 0.6755207777023315, 0.0671202689409256, 0.5465226173400879, 0.5693060159683228, 0.2789846658706665, 0.2730547785758972, 0.044487304985523224, -0.36542627215385437, 0.23064522445201874, -1.0668185949325562, 0.4462513029575348, 0.1823735386133194, 1.141794204711914, -0.40161725878715515, 0.19763591885566711, -0.9827045798301697, 0.4205752909183502, 1.5830042362213135, 0.570593535900116, 0.40476369857788086, -0.5874993205070496, 0.42892423272132874, -0.6336976885795593, 0.03542783483862877, -0.054273124784231186, -0.00926640909165144, -0.2424612045288086, -0.7652415633201599, -1.3246653079986572, -0.25776368379592896, 0.09663581848144531, -0.635253369808197, 0.938080370426178, -0.22540919482707977, -0.20895202457904816, 0.1068815141916275, 0.14064516127109528, 0.4892643690109253, 0.5314049124717712, 0.10503106564283371, -0.25386327505111694, 1.0057927370071411, -1.1330969333648682, -0.5551520586013794, -1.4637943506240845, 0.8627331852912903, -0.5726878643035889, 0.1792309284210205, -0.530690610408783, -1.4378858804702759, -0.6854428052902222, -0.4793792963027954, 0.0019940875936299562, -0.3478367328643799, 0.48659589886665344, 1.2446837425231934, 0.17262235283851624, -1.2227542400360107, 0.05128224566578865, -0.15557637810707092, -0.1103372797369957, -0.03853174299001694, 0.037630800157785416, 0.3954445421695709, -0.25324541330337524, -1.501328468322754, 0.15317800641059875, 0.07464414089918137, -0.6688384413719177, -0.17902246117591858, -0.4648270606994629, -1.5222313404083252, 0.04194090887904167, -0.020250611007213593, -0.48369258642196655, 1.4472229480743408, 0.0945533886551857, -1.2167506217956543, 0.6514932513237, -0.472928524017334, 0.31593868136405945, 0.10675017535686493, 0.14638014137744904, -0.370103120803833, -0.9296042323112488, 0.05673139914870262, 0.3336966633796692, 0.49199551343917847, -0.151607945561409, -0.4446786940097809, 0.27327337861061096, 0.12591877579689026, 0.0206686370074749, -0.004658825229853392, 1.420484185218811, -0.6896236538887024, -0.15630607306957245, 0.267697274684906, 0.4916398823261261, -0.5055773854255676, -0.17468641698360443, -0.356959730386734, -0.843660831451416, 0.5681008696556091, -0.5618229508399963, 1.473551869392395, -0.7540964484214783, -0.6906909942626953, -0.126695916056633, -0.09517954289913177, -0.1367437094449997, -0.6349607706069946, 0.70549476146698, -0.3682863414287567, 0.12876947224140167, -0.21635545790195465, -0.7907813191413879, 0.2753494679927826, -0.2709859013557434, -0.7033411860466003, -0.35129857063293457, -0.22983087599277496, 0.8958106637001038, -0.8896774649620056, -0.03971998766064644, -0.11580189317464828, 0.21722550690174103, -1.0914769172668457, 1.4604564905166626, -0.49567121267318726, -0.05017227306962013, 0.023526575416326523, -0.039712436497211456, 0.3111574351787567, -0.32740044593811035, 0.7570177316665649, -0.2084154635667801, -0.34690043330192566, 0.30339357256889343, -0.12794117629528046, 1.264211893081665, -0.6758036613464355, 0.20345906913280487, 0.2316041737794876, -0.5028316974639893, -0.12354549765586853, 0.4255274832248688, -0.36644473671913147, -0.5154688358306885, 0.04935935512185097, 0.39192453026771545, -0.30434760451316833, 0.30121365189552307, 0.7033660411834717, 0.585281491279602, -0.47146880626678467, 0.43970629572868347, 0.19169554114341736, -0.0786018967628479, 0.7614726424217224, 0.34984347224235535, 0.5546088814735413, 0.2902989089488983, 0.6900750994682312, -0.18470220267772675, 0.683664858341217, -1.131630778312683, -0.2373986840248108, 0.5241367220878601, 0.6369147300720215, 0.22788134217262268, 0.3942813575267792, -0.35448309779167175, -0.14606548845767975, -0.1953979879617691, 0.626224935054779, 1.9061222076416016, -0.38236716389656067, -0.39480316638946533, -0.7994295358657837, -0.2818801999092102, -0.2572062611579895, 0.2939320206642151, 0.2176920473575592, 0.03644367307424545, -0.4221001863479614, -1.124819040298462, 0.8206694722175598, 0.12993386387825012, 0.5974230170249939, -0.29302269220352173, 0.1654168963432312, -0.49511662125587463, -0.08610504120588303, -0.9530879855155945, -0.5319396257400513, 0.17311716079711914, -0.6926488876342773, 0.06720655411481857, 0.33981868624687195, -0.08982878923416138, 0.3655695915222168, -0.6562848687171936, 0.8791964650154114, -0.2100302129983902, -0.16206194460391998, -0.16511857509613037, 0.8061328530311584, -0.40516987442970276, -1.3857841491699219, 0.10778441280126572, 0.013890370726585388, -0.5278317332267761, 0.52019864320755, 0.537710964679718, 0.5650208592414856, -0.0051454296335577965, -0.4342367649078369, 0.3528878688812256, 0.16437825560569763, -0.26259657740592957, 0.5561168789863586, -0.017906231805682182, -0.5630016922950745, -1.050191044807434, 1.2651039361953735, 0.18417654931545258, -0.9987801313400269, 0.4960348606109619, -0.7038177847862244, 0.22152690589427948, 0.6745920777320862, -0.4501916170120239, -0.38250645995140076, -0.9733129739761353, 0.19510506093502045, -0.042975783348083496, 0.05364515632390976, 0.10754621028900146, 0.04241691157221794, 0.25452038645744324, -0.24014320969581604, 0.9140955209732056, 0.49654263257980347, -0.5310081839561462, 0.4862927496433258, -0.39381855726242065, -0.23386092483997345, 0.06417212635278702, 0.4639865756034851, -0.366445392370224, -0.45821213722229004, -0.45344749093055725, -0.44575902819633484, -0.236162006855011, 0.15299108624458313, 0.040092457085847855, -0.08737590163946152, -0.8212809562683105, -0.367542028427124, -0.14146104454994202, -1.1947780847549438, 0.03327338024973869, 0.6677481532096863, -0.3923649489879608, 0.0555223748087883, -1.005642294883728, -1.3376375436782837, -0.5098299980163574, -0.8792390823364258, -1.647340178489685, 0.8489847183227539, -0.37365108728408813, -0.15373535454273224, -0.5823303461074829, -0.10056250542402267, 0.03876534849405289, 1.2403180599212646, -1.1612403392791748, 1.3170793056488037, -0.06700045615434647, -0.2996378242969513, -0.06375554949045181, 0.03350270166993141, -0.027445103973150253, -0.298129677772522, 0.4781632721424103, -0.8315818309783936, -0.05052836239337921, -0.4669381082057953, 0.05630430951714516, -0.19828684628009796, 0.4061092734336853, 1.046327829360962, -0.1615949124097824, -0.8225461840629578, 0.40512919425964355, 1.2732561826705933, -0.8144432902336121, -0.09455879032611847, 0.09413939714431763, 0.9817811846733093, -0.1414208710193634, -0.19725903868675232, 0.6251486539840698, 0.3443176746368408, 0.6817440986633301, 0.01241503469645977, -0.41019153594970703, 0.3993258774280548, -0.3785160779953003, 0.8841814398765564, 2.1838042736053467, 0.2329869270324707, -0.10081501305103302, -0.8404837846755981, 0.2845761775970459, -1.4758504629135132, -0.6086668372154236, 1.011099100112915, 0.9411717653274536, 0.6831179261207581, -0.2619255781173706, -0.41887617111206055, -0.2252340167760849, 0.5131545066833496, 0.7203677296638489, -0.060059528797864914, -0.8788127899169922, 0.3291500210762024, 0.31350943446159363, 0.30001288652420044, 0.8218973875045776, -0.25573307275772095, 0.7230018973350525, 14.419089317321777, 1.5179392099380493, 0.25445371866226196, 0.8106211423873901, 0.4395160973072052, 0.46140119433403015, -0.6209318041801453, 0.022324012592434883, -1.5754191875457764, -0.04172230139374733, 1.2743546962738037, -0.1556669920682907, 1.1137768030166626, 0.2735474109649658, 0.337040513753891, 0.0734826996922493, -0.13302169740200043, 0.5871699452400208, 0.4225926697254181, -1.2195243835449219, 0.7716103792190552, 0.07351239025592804, 0.10475752502679825, 0.7016648054122925, 0.21629302203655243, 0.886653482913971, 0.8131141662597656, -0.5757269263267517, 0.5745041370391846, -0.14604833722114563, 1.1106702089309692, -0.3057270348072052, 0.5256221890449524, 0.6953166127204895, -1.3789005279541016, -0.006279395893216133, -0.48052453994750977, -1.4312626123428345, 0.004241507034748793, 0.38022592663764954, -0.756834864616394, -0.6831740140914917, -0.4220312833786011, 0.7459027171134949, 0.13830554485321045, 0.21759630739688873, -0.45782944560050964, 0.6461217403411865, -0.044157810509204865, 0.16706575453281403, 0.04581185430288315, 0.15169982612133026, 0.08391883969306946, -0.19196240603923798, 0.24296924471855164, -0.5588462352752686, 0.32189512252807617, 0.4814462661743164, -0.5230326652526855, -0.07721389830112457, -0.5066102743148804, -0.4202578365802765, 0.2517894208431244, 0.9175525307655334, 0.4869959354400635, 0.29064512252807617, -0.6077728867530823, -0.19185417890548706, 1.0131992101669312, 0.3295944035053253, -0.5232505202293396, 0.34447064995765686, 0.9446560740470886, -0.3904135525226593, -0.02604256384074688, 0.7250117659568787, 0.2637389302253723, -0.6276453137397766, -0.6274641156196594, -0.8930585384368896, 0.30080050230026245, -0.6768712401390076, -0.6369202136993408, 0.6096309423446655, 0.05775360018014908, -0.23456624150276184, 0.27064985036849976, -0.4679049253463745, -0.21324092149734497, 0.2981821298599243, -1.3878785371780396, -0.9618834853172302, 0.9512494206428528, -0.5299109220504761, -0.20048806071281433, 0.06226970627903938, 1.4653160572052002, 0.3831453323364258, -0.6720229387283325, 0.4450921416282654, 0.7419825196266174, 0.21759693324565887, -0.4726991355419159, -0.32081282138824463, 0.9963590502738953, 0.688029408454895, -0.040499247610569, 0.8753636479377747, 0.11176400631666183, 0.3452485203742981, -1.0522191524505615, -0.2748182415962219, 1.1589759588241577, -0.6809961199760437, -0.010100612416863441, -1.1820478439331055, -0.3500067889690399, 0.40516579151153564, 0.3340374827384949, -0.4107048511505127, 0.5381759405136108, 0.1947651356458664, -0.4595198929309845, -0.2883017957210541, -0.7479577660560608, 0.14108285307884216, 0.8424941301345825, -0.9784061312675476, 0.23453480005264282, 0.22604377567768097, 0.39692360162734985, -1.2189339399337769, -0.6265627145767212, -0.08765525370836258, 0.06589821726083755, 0.19900433719158173, 1.1708160638809204, -0.3603197932243347, 0.8010132312774658, 0.6087460517883301, -0.3687223494052887, -0.6988416910171509, -0.22315751016139984, -1.0042893886566162, -0.014478417113423347, -0.1323099285364151, 1.1978763341903687, -0.6347518563270569, -0.3921641409397125, 1.1019893884658813, 0.8049666285514832, -0.5499221682548523, -0.8126108050346375, -0.19193388521671295, -0.03949924558401108, -0.4836025834083557, 0.7529808878898621, -0.3614657521247864, -0.0076634869910776615, 0.1716318428516388, 0.4226585626602173, 1.005313515663147, 0.04442727193236351, -0.24794206023216248, 0.5983730554580688, 0.12561315298080444, -0.2398742139339447, -0.5560142397880554, -0.17416681349277496, -1.2722247838974, 0.5385184288024902, -1.3395655155181885, 0.20029540359973907, -0.9823924899101257, 0.1592971235513687, -0.03890543058514595, -0.1087997704744339, 0.007425163872539997, 0.3612305521965027, -0.43260034918785095, -0.8101235032081604, -0.5930852890014648, -0.6524471044540405, 0.9141328930854797, 0.7656285166740417, -0.6238945722579956, 0.5790904760360718, -0.02293989062309265, 0.24579527974128723, 0.48714813590049744, 0.18148228526115417, -0.4221075475215912, -0.9325314164161682, -1.3775908946990967, 0.3877907693386078, -0.07783220708370209, -0.5037099123001099, -0.07075446099042892, 0.3827098309993744, -0.0767618790268898, -0.44053077697753906, 0.5577548742294312, 0.018072908744215965, -0.8505530953407288, -0.21138277649879456, 0.5733400583267212, -0.5288772583007812, 0.39445585012435913, 0.4302361011505127, -0.8332075476646423, -0.35354337096214294, 0.5257164239883423, -0.12614531815052032, -1.0774149894714355, -0.6660521626472473, 0.5604323744773865, -0.647611141204834, 0.4945629835128784, -0.24962161481380463, 0.3165473937988281, -0.7667680382728577, -0.4372490644454956, 0.3627875745296478, 0.1742754429578781, -0.11169175058603287, 1.0599193572998047, 0.33065909147262573, -0.9061937928199768, 0.2963418662548065, 0.8376019597053528, 0.052369918674230576, -0.32785412669181824, -0.1770317405462265, 0.34722018241882324, -0.5142079591751099, 0.5652474761009216, 0.7862136363983154, 0.37059733271598816, -1.3490763902664185, -0.11659207195043564, 0.6814252734184265, -0.7497937083244324, -0.005080729257315397, 1.236098289489746, -0.10243502259254456, -1.5156269073486328, -0.04524045065045357, -1.194930911064148, -0.23876909911632538, -1.2248480319976807, 0.5632047653198242, 0.07243500649929047, -0.13006407022476196, -0.2042505145072937, -0.6701767444610596, -0.07631219178438187, -0.029781805351376534, -0.30275958776474, 0.3246776759624481, -0.24495531618595123, -0.9906249046325684, 0.13870769739151, 0.38910341262817383, -0.2616841793060303, -0.28148114681243896, -0.3944298326969147, -0.4908616244792938, -0.41022706031799316, 0.473211407661438, 0.005046339705586433, -0.8081138134002686, 0.3837137222290039, 0.1278257966041565, 0.13984589278697968, 0.2034061849117279, -0.17053638398647308, 0.47820374369621277, 0.412555456161499, 0.5353507995605469, -0.49348175525665283, -1.4161040782928467, 1.1383224725723267, 0.9837619662284851, -1.1658991575241089, 0.3177907466888428, -0.26168254017829895, -0.5857429504394531, 0.46950966119766235, 0.29234254360198975, 0.504355251789093, 1.070878028869629, 0.49181172251701355, 0.12647368013858795, 0.14832091331481934, -1.174223780632019, -0.30106064677238464, 0.7689900994300842, 0.6606156826019287, 1.3060883283615112, 0.7004777789115906, -0.1746426373720169, 0.7820934057235718, 0.10326565057039261, 0.2950907349586487, 0.3078150749206543, 0.3827294707298279, -0.26151686906814575, -0.39150840044021606, -0.00141956377774477, 0.8974281549453735, -0.513367772102356, -1.308482050895691, 0.36141327023506165, 0.6172134876251221, 0.08275530487298965, 0.4557231366634369, 0.4788595736026764, 0.25850528478622437, 0.04985855147242546, 0.2853062152862549, 0.5453291535377502, -0.49061548709869385, 0.186623677611351, -0.23794670403003693, -0.4024597108364105, -0.08027367293834686, -0.16911059617996216, -0.08062002807855606, -0.5519564151763916, -0.5022631287574768, 0.012246320955455303, 0.24935214221477509, 0.28064823150634766, 1.3980555534362793, 0.6244471073150635, 0.1618843525648117, -0.42349404096603394, -0.1024915874004364, -0.46366989612579346, -0.9682406783103943, -0.04775793477892876, -0.652931272983551, -0.4712083637714386, 0.028790012001991272, -0.3213866055011749, -0.5554013252258301]}, "authors": [{"authorId": "2109315001", "name": "Yushuo Chen"}, {"authorId": "1997234792", "name": "Tianyi Tang"}, {"authorId": "2296993475", "name": "Erge Xiang"}, {"authorId": "2297141398", "name": "Linjiang Li"}, {"authorId": "2294811281", "name": "Wayne Xin Zhao"}, {"authorId": "2297075049", "name": "Jing Wang"}, {"authorId": "2297087264", "name": "Yunpeng Chai"}, {"authorId": "2274218622", "name": "Ji-Rong Wen"}], "references": [{"paperId": "460269b063bf4362ac92286bbebf38f445f7510e", "title": "Inferflow: an Efficient and Highly Configurable Inference Engine for Large Language Models"}, {"paperId": "13261129251c9e8891cff02c3aee15c4df6a5630", "title": "Towards Efficient Generative Large Language Model Serving: A Survey from Algorithms to Systems"}, {"paperId": "fdc53c2c10742464087c0525f77e32604827a21d", "title": "Efficient Streaming Language Models with Attention Sinks"}, {"paperId": "83b90f4a0ae4cc214eb3cc140ccfef9cd99fac05", "title": "Efficient Memory Management for Large Language Model Serving with PagedAttention"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "823ca4778e1027f2f0b356df051d762dcecaaba0", "title": "FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning"}, {"paperId": "c61d54644e9aedcfc756e5d6fe4cc8b78c87755d", "title": "A Survey of Large Language Models"}, {"paperId": "57e849d0de13ed5f91d086936296721d4ff75a75", "title": "LLaMA: Open and Efficient Foundation Language Models"}, {"paperId": "0a6906bd6f026d3da3031c641ed03081bd0b574e", "title": "Full Stack Optimization of Transformer Inference: a Survey"}, {"paperId": "379e42895f6d40ab9e9559609f505aba89145a5d", "title": "Efficiently Scaling Transformer Inference"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "bdbf780dfd6b3eb0c9e980887feae5f23af15bc4", "title": "GLU Variants Improve Transformer"}, {"paperId": "10eda4521c032adabaa8e70d6569e17370b29dcd", "title": "Root Mean Square Layer Normalization"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "7e205a432ca68cc29fd669c7df8363f8d803431e", "title": "Teams"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "3deb3f07d069187736b71293215d5534282ec33c", "title": "GPGPU: general purpose computation on graphics hardware"}, {"paperId": null, "title": "Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality"}, {"paperId": null, "title": "Under review as a conference paper at COLM 2024"}, {"paperId": null, "title": "inference in c/c++"}, {"paperId": null, "title": "Stanford alpaca: An instruction-following llama model"}, {"paperId": null, "title": "Modeltc/lightllm: Lightllm is a python-based llm (large language model) inference and serving framework, notable for its lightweight design, easy scalability, and high-speed performance"}, {"paperId": null, "title": "LMDeploy Contributors"}]}