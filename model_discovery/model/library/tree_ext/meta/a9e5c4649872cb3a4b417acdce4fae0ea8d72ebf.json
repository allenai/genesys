{"paperId": "a9e5c4649872cb3a4b417acdce4fae0ea8d72ebf", "title": "Fine-grained Attention in Hierarchical Transformers for Tabular Time-series", "abstract": "Tabular data is ubiquitous in many real-life systems. In particular, time-dependent tabular data, where rows are chronologically related, is typically used for recording historical events, e.g., financial transactions, healthcare records, or stock history. Recently, hierarchical variants of the attention mechanism of transformer architectures have been used to model tabular time-series data. At first, rows (or columns) are encoded separately by computing attention between their fields. Subsequently, encoded rows (or columns) are attended to one another to model the entire tabular time-series. While efficient, this approach constrains the attention granularity and limits its ability to learn patterns at the field-level across separate rows, or columns. We take a first step to address this gap by proposing Fieldy, a fine-grained hierarchical model that contextualizes fields at both the row and column levels. We compare our proposal against state of the art models on regression and classification tasks using public tabular time-series datasets. Our results show that combining row-wise and column-wise attention improves performance without increasing model size. Code and data are available at https://github.com/raphaaal/fieldy.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "The proposed Fieldy, a fine-grained hierarchical model that contextualizes fields at both the row and column levels, is compared against state of the art models on regression and classification tasks using public tabular time-series datasets."}, "embedding": {"model": "specter_v2", "vector": [0.07569895684719086, 0.488724023103714, -0.3600523769855499, -0.33125656843185425, -0.18433614075183868, 0.11287631839513779, 0.9434908628463745, 0.15941354632377625, -0.152431920170784, 0.1281961351633072, 0.7217903733253479, 0.3125721514225006, 0.10217095166444778, -0.1601944863796234, -0.03876466304063797, 0.3399025797843933, -1.0903942584991455, 0.4046696126461029, -0.08854317665100098, -0.3388058543205261, 0.11275564134120941, -0.8582249879837036, -1.088965654373169, 0.3772278428077698, -0.03610682487487793, 1.3594468832015991, -0.22052475810050964, 0.36499086022377014, -0.31334176659584045, 0.934868335723877, 0.12035869807004929, -0.34713971614837646, 0.18627893924713135, 0.022808048874139786, -0.6254183053970337, -0.0036226019728928804, 0.5660874843597412, -0.20994143187999725, -0.669782280921936, 0.2771188020706177, -0.9259848594665527, 0.13013797998428345, 0.5876248478889465, -0.6934687495231628, 0.0436716265976429, 0.8409050107002258, 1.0505661964416504, 0.8625877499580383, -0.23708507418632507, -1.2766940593719482, 1.8085927963256836, -0.6319239735603333, 0.1954449564218521, 1.2392688989639282, 0.8620920181274414, 0.24848304688930511, -0.3168765902519226, -0.4881027042865753, 0.8947514295578003, 0.5773864388465881, -0.4453072249889374, 0.008462218567728996, 0.09516643732786179, -0.7209017276763916, 1.678499698638916, -0.22658926248550415, 0.19428934156894684, 0.4716334342956543, 0.4491878151893616, 1.2315579652786255, -0.16454531252384186, -0.6290469765663147, -0.21249248087406158, -0.07396125793457031, 0.27842289209365845, 0.288922518491745, -0.5646080374717712, 0.23035895824432373, -1.171278715133667, -0.37192413210868835, 0.5241304636001587, 0.6479449272155762, 0.006354477722197771, 0.22044426202774048, -0.39104896783828735, 0.47323310375213623, 0.3565225601196289, 0.8109351396560669, -0.9349059462547302, 0.6112198829650879, 0.6010442972183228, 0.2660875618457794, -0.27867940068244934, 0.6466848850250244, -0.3621269762516022, 0.3217000961303711, -0.9557081460952759, 0.046803563833236694, -0.1952594518661499, 0.7448967695236206, -0.10381200164556503, 0.24308589100837708, -0.9191192388534546, 0.16188432276248932, 0.8171743154525757, -0.3141143023967743, 0.5981988906860352, -0.663596510887146, 0.17679736018180847, -0.057958897203207016, 0.48126134276390076, -1.0823233127593994, -0.2416297197341919, 0.015277504920959473, -0.5983734130859375, -1.4546781778335571, -0.44525834918022156, 0.36555537581443787, -0.7778128385543823, 0.3863210380077362, -0.6522286534309387, -0.14875301718711853, -0.5114917755126953, 0.057427778840065, 0.19275328516960144, 0.6277555227279663, 0.23840180039405823, -0.1579170525074005, 1.2304617166519165, -0.3031669557094574, -0.9086228609085083, -0.9224938750267029, 0.11681234836578369, 0.28189370036125183, -0.10156084597110748, -0.22817584872245789, -1.3317129611968994, -0.9583669304847717, -0.6408291459083557, 0.24665974080562592, -0.7574591040611267, -0.18579348921775818, 1.0563182830810547, -0.2321048527956009, -0.608593761920929, 0.9771437048912048, -0.5887660980224609, -0.4212415814399719, 0.44788211584091187, -0.07869058102369308, 0.4436275362968445, 0.15339861810207367, -1.4865269660949707, 0.1127486377954483, -0.009951234795153141, -0.415057510137558, -0.34937623143196106, -0.46011045575141907, -0.8575615882873535, 0.388043612241745, -8.186866580217611e-06, -0.32321426272392273, 1.3120959997177124, -0.0122852036729455, -0.3901309072971344, 0.6780637502670288, -0.1809491515159607, -0.7045238018035889, 0.11874981224536896, -0.003097494598478079, -0.6805137991905212, -0.15227903425693512, 0.18606480956077576, 0.1434398740530014, 0.3547569513320923, 0.16945470869541168, -0.6469221115112305, -0.004673473071306944, -0.4832005798816681, -0.4953090250492096, -0.703846275806427, 0.6640075445175171, -0.38815683126449585, -0.4803641140460968, 0.1654421091079712, 0.9720470905303955, 0.09715816378593445, -0.5007423162460327, -0.07631129026412964, -1.1424177885055542, 0.36062121391296387, 0.026794228702783585, 1.6343352794647217, -0.6321313977241516, -1.0021189451217651, -0.40821823477745056, -0.05417981371283531, -0.5821834802627563, -0.3045922517776489, 1.01725172996521, -0.41976067423820496, 0.13766182959079742, 0.01600276120007038, -0.8969285488128662, -0.10672721266746521, -0.09046296030282974, -1.096331000328064, -0.288461834192276, -0.04301666095852852, 1.02370023727417, -0.5345346927642822, -0.012913073413074017, -0.07522492110729218, -0.07128571718931198, -0.9155257940292358, 1.3286120891571045, -0.36887452006340027, -0.4095175266265869, -0.20693135261535645, 0.1728784292936325, -0.400878369808197, -0.588534951210022, 0.40784987807273865, -0.4566712975502014, -0.370662122964859, 0.7948959469795227, -0.09426981955766678, 0.745082437992096, -0.009096624329686165, 0.7249002456665039, -0.44919946789741516, -0.9200573563575745, 0.5343398451805115, 0.613139808177948, 0.6498264074325562, -0.7856098413467407, 0.22654306888580322, 0.2263946682214737, -1.4307547807693481, 0.2985330820083618, 0.9516222476959229, 0.9337179064750671, -0.6069863438606262, 0.03538425639271736, 0.5593990087509155, 0.14767423272132874, 0.35520491003990173, 0.3887404501438141, 0.6928473711013794, 0.47557586431503296, 0.45143458247184753, -0.19581207633018494, 0.0944407656788826, -0.4801546633243561, 0.48659875988960266, 0.4355410039424896, 0.7908982038497925, 0.6110491156578064, 0.5725515484809875, -1.0987510681152344, -0.5556732416152954, 0.625478982925415, 0.2539270520210266, 1.289932370185852, -0.31448498368263245, -0.7387704849243164, -0.3063994348049164, -0.010755016468465328, 0.08324787765741348, 0.08424822986125946, -1.2331229448318481, 0.08209279179573059, -0.4605898857116699, -0.7394348978996277, 0.5523585081100464, 0.8305955529212952, 0.6240941286087036, -0.9477764368057251, -0.7308714389801025, 0.22881826758384705, -0.10851994156837463, -0.5167016983032227, -0.7007105350494385, 0.6834948658943176, -0.6968631744384766, -0.1566370129585266, 0.48598405718803406, 0.051769744604825974, -0.13728171586990356, -0.7286379337310791, 1.2561410665512085, -0.6471213698387146, -0.1728706806898117, 0.45249515771865845, 0.6192240715026855, -1.095116138458252, 0.004575718659907579, -0.0970277339220047, -0.10439123213291168, 0.35356107354164124, 0.7955605983734131, 0.410662442445755, -0.41579174995422363, 0.3361424505710602, -0.33823162317276, -0.12615150213241577, -0.288918673992157, 0.4516134262084961, 0.748996913433075, -0.16510897874832153, 0.017698224633932114, -0.9658687114715576, 0.4137498736381531, -0.08935711532831192, -0.9651919007301331, 0.2822568416595459, -0.8429186940193176, -0.4130623936653137, 0.44491955637931824, -0.43680524826049805, 0.05267728120088577, -1.089347004890442, 0.9592786431312561, -0.6606056690216064, -0.02927582338452339, 0.6745665073394775, 0.6521831154823303, 1.0465909242630005, 0.3462913930416107, 0.03823364898562431, -0.23710159957408905, -0.16376477479934692, -0.2998310625553131, -0.6811793446540833, 0.8407067060470581, 0.2654297351837158, -0.3056696057319641, 0.07751317322254181, 0.07424428313970566, -0.5300912857055664, -0.714353621006012, -0.6300981640815735, -0.29032695293426514, -0.2878793478012085, 0.1757381558418274, -0.5195997953414917, -1.0715630054473877, -0.22480620443820953, -0.7829328179359436, -0.3312115967273712, 0.09417607635259628, -0.30256181955337524, -0.30250585079193115, -1.4867146015167236, -1.1095452308654785, -0.9478723406791687, -0.3279155194759369, -0.06638038903474808, 0.3850259780883789, 0.0010993366595357656, -0.4138321280479431, -0.829616367816925, -0.1946515142917633, -0.44020140171051025, 0.725825309753418, 0.27002575993537903, 0.7648027539253235, -0.016930339857935905, -0.34835439920425415, -0.589462161064148, 0.5098324418067932, 0.13381969928741455, 0.20727960765361786, -0.03339814022183418, -0.5901747345924377, 0.370308518409729, 0.2343279868364334, -0.025177111849188805, 0.33146899938583374, 0.4879298806190491, 0.9231361746788025, -0.04193422198295593, -0.6397140622138977, 0.2423553168773651, 1.2103261947631836, -0.05521826818585396, -0.08282769471406937, 0.48075899481773376, 0.6003730297088623, 0.4854978024959564, 0.336981862783432, 1.1900609731674194, 0.559897243976593, 0.5585697293281555, 0.5556750297546387, -0.20557838678359985, 0.32502317428588867, -0.6532513499259949, -0.044613055884838104, 1.2029328346252441, -0.0578172467648983, 0.008971178904175758, -1.3416192531585693, 1.2580204010009766, -1.3862119913101196, -1.1467344760894775, 0.5899916291236877, 1.0083916187286377, 0.26372262835502625, -0.30503717064857483, -0.03706888109445572, -0.02223781868815422, 0.19560213387012482, 0.14830848574638367, -0.35898566246032715, -0.21264487504959106, -0.12615084648132324, 0.19523504376411438, 0.3906850516796112, 0.3496062755584717, -0.7024929523468018, 0.028710247948765755, 14.745604515075684, 0.031270984560251236, -0.19022364914417267, 0.08232519030570984, 0.5794633626937866, 0.19753415882587433, -0.0707971602678299, -0.0033705923706293106, -1.134562611579895, -0.05492483451962471, 1.3639243841171265, -0.059466853737831116, 0.4421963095664978, -0.17383921146392822, -0.05654115974903107, 0.5217742323875427, -1.0170804262161255, 0.6393596529960632, 0.324934184551239, -1.391133189201355, 0.1394485980272293, 0.33028051257133484, 0.13540124893188477, 0.12425125390291214, 0.6720154881477356, 0.6135445237159729, 0.3117847740650177, -0.6329821944236755, 0.6850683093070984, 0.5478667616844177, 0.9343852400779724, 0.24321512877941132, 0.41760310530662537, 0.05884941667318344, -1.428961992263794, -0.5098419189453125, -0.7054677605628967, -1.0953508615493774, 0.07760533690452576, -0.2757273018360138, -0.8233715891838074, -0.21240970492362976, 0.34627413749694824, 1.1218867301940918, 0.05308785289525986, 0.11509723216295242, 0.3085748553276062, 0.6836888194084167, 0.36784395575523376, 0.3377416729927063, 0.25312700867652893, 0.7544978260993958, -0.12901490926742554, -0.273361474275589, 0.27274197340011597, 0.18656346201896667, -0.16040566563606262, 0.07117494940757751, -0.39076414704322815, -0.02960258163511753, -0.35873353481292725, -0.44109341502189636, 0.23337267339229584, 0.5613219738006592, 0.6554503440856934, -0.03308439254760742, -0.6955567598342896, -0.05122935399413109, 0.2496328204870224, 0.05781606584787369, -0.27166464924812317, -0.08747942745685577, 0.25851595401763916, 0.19873172044754028, 0.35623395442962646, 0.7838272452354431, -0.3988196551799774, -0.4537959694862366, -0.8758994936943054, -0.1836898922920227, 1.4022001028060913, -0.8797312378883362, -1.0541843175888062, 1.4497618675231934, -0.2352008819580078, -1.0059599876403809, -0.3435419201850891, -0.8614550232887268, -0.23123160004615784, 0.4472534656524658, -1.008910059928894, -0.30592137575149536, -0.5807311534881592, 0.16487424075603485, -0.1279112547636032, -0.178361713886261, 1.3652094602584839, 0.14493198692798615, -0.33896711468696594, -0.15573500096797943, -0.0708840936422348, -0.09859426319599152, 0.16441300511360168, -1.0605500936508179, 0.7662569284439087, -0.06859862804412842, -0.15365281701087952, 0.3475991487503052, -0.016693903133273125, -0.030422702431678772, -0.2920290529727936, -0.2950863540172577, 1.078813910484314, -1.3073471784591675, 0.06264718621969223, -0.6770381927490234, -1.1224421262741089, 0.6944960951805115, 0.6245089769363403, -0.5279831886291504, 0.20923589169979095, 0.4377482533454895, -0.4830421507358551, -0.49630114436149597, -0.4953126311302185, -0.16438962519168854, -0.10536080598831177, -0.6242099404335022, -0.6338880658149719, -0.19662348926067352, 0.1913774460554123, -0.5165542960166931, -1.1089074611663818, -0.14501728117465973, 0.3009050488471985, -0.27197492122650146, 0.8039480447769165, -0.5762301087379456, 0.8190113306045532, 0.8704979419708252, -0.5011986494064331, -0.5887951850891113, -0.3816511631011963, -0.8380268216133118, -0.18447890877723694, 0.3169047236442566, 0.39313074946403503, -0.4345565438270569, 0.13966518640518188, 0.9430877566337585, 0.32627564668655396, -0.2812850773334503, -0.0004749213985633105, -0.03864414989948273, -0.06114592030644417, -0.2629336714744568, 0.8060234189033508, 0.27076441049575806, 0.11104482412338257, 0.047496695071458817, 0.028617821633815765, 0.40785905718803406, -0.5857523679733276, -0.13289082050323486, -0.003106191521510482, -0.6763649582862854, 0.20944403111934662, -0.5739132165908813, -0.4167368710041046, -1.0010485649108887, -0.5640526413917542, -0.5091732740402222, -0.07375568151473999, -1.2679468393325806, -0.6961259841918945, 0.2506524622440338, -1.1251471042633057, 0.35154256224632263, 0.35829368233680725, -0.4932379722595215, -0.6060031056404114, -0.33569514751434326, -0.2021792083978653, 0.6652129888534546, 0.7452393174171448, -0.7521147727966309, 0.1981305330991745, -0.08059562742710114, 0.029139604419469833, 0.032012175768613815, 0.3664040267467499, -0.5823161005973816, -0.5132898688316345, -0.9251052141189575, 0.03411790728569031, 0.5957398414611816, -0.1637851595878601, -0.5136784315109253, 0.7932212352752686, -0.10627984255552292, 0.004874702077358961, -0.8107107281684875, 0.7263051867485046, -1.0222959518432617, -0.22848038375377655, 0.067389115691185, -0.8072168231010437, 0.5027639269828796, 0.3431108891963959, -0.6759342551231384, -0.9151495695114136, 1.1878085136413574, -0.18622401356697083, -0.7952232360839844, -0.3778977394104004, 0.8229097127914429, -0.28726303577423096, 0.054726842790842056, -0.24124686419963837, -0.05668899044394493, -0.9856572151184082, -0.41468095779418945, 0.1128137931227684, 0.7901201844215393, -0.5893964767456055, 0.9722723960876465, -0.08556997030973434, -1.2780232429504395, 0.2310369908809662, 0.317098468542099, 0.2724896967411041, -0.29524174332618713, 0.40204471349716187, 0.5445961952209473, 0.12087158858776093, 1.2081947326660156, -0.22962301969528198, 0.24117515981197357, -0.6086508631706238, 0.4616397023200989, 0.7232358455657959, -0.3722849190235138, -0.12846115231513977, 0.7983749508857727, 0.02017018012702465, -0.27996817231178284, 0.5032604932785034, -1.3912829160690308, -1.1294748783111572, 0.43710848689079285, 0.5709684491157532, 0.3011567294597626, -0.03431491181254387, 0.01586049050092697, -0.7318379282951355, 0.08872154355049133, -0.11865759640932083, -0.3131825625896454, 0.8926323652267456, 0.01394799817353487, -0.25018319487571716, 1.26646888256073, 0.34044384956359863, -0.8403429388999939, -0.6821215748786926, -0.7565794587135315, -0.12176602333784103, -0.1257483959197998, 0.17474889755249023, -0.2594553530216217, -0.46860790252685547, 0.6740856766700745, 0.266315221786499, 1.2878631353378296, 0.5995530486106873, -0.1351393610239029, -0.08206795156002045, 0.3420213460922241, 0.05054815486073494, -0.699958086013794, -0.5019381642341614, 1.129061222076416, 1.6181650161743164, -0.6588776111602783, 0.2251282036304474, 0.280714750289917, -0.6025026440620422, 0.945397138595581, 0.4727937579154968, -0.14482879638671875, 1.0012757778167725, -0.685961127281189, 0.14070050418376923, -0.21182340383529663, -1.8874120712280273, 0.03367236256599426, 0.9399546384811401, 0.7979610562324524, 0.6726246476173401, 0.4219006597995758, 0.05966798588633537, 1.0267544984817505, -0.11580248922109604, 0.020176954567432404, 0.3777094781398773, 0.28521913290023804, 0.14962323009967804, 0.13415153324604034, -0.17502593994140625, 0.8483091592788696, -0.7465565800666809, -0.21077725291252136, 0.17253680527210236, 0.6276717185974121, -0.05781816318631172, 0.7291871309280396, 1.1312726736068726, -0.11549275368452072, 1.030314564704895, 0.20054373145103455, 0.0939723551273346, -0.3540685474872589, -0.49082669615745544, -0.04606279730796814, -0.6396482586860657, -0.161789208650589, -0.16571636497974396, -1.2539700269699097, -0.07680397480726242, 0.2293100208044052, 0.788407564163208, 0.36539652943611145, 0.004056719597429037, 0.6781290769577026, 0.32723453640937805, 0.8491258025169373, 0.020101459696888924, -0.2722046971321106, -0.3825201392173767, -1.1256228685379028, -0.013465125113725662, -0.3084457218647003, 0.4560803174972534, -0.6792076230049133, -0.054708678275346756, 0.01142649445682764]}, "authors": [{"authorId": "2143094160", "name": "Rapha\u00ebl Azorin"}, {"authorId": "51339215", "name": "Z. B. Houidi"}, {"authorId": "2190827792", "name": "Massimo Gallo"}, {"authorId": "2835398", "name": "A. Finamore"}, {"authorId": "2261299905", "name": "Pietro Michiardi"}], "references": [{"paperId": "f1fff40fff36d546873705ee564f4d59b88bed59", "title": "FATA-Trans: Field And Time-Aware Transformer for Sequential Tabular Data"}, {"paperId": "2ebfa7db6e0899041fff28b9f7fd212581d4f7e8", "title": "One Transformer for All Time Series: Representing and Training with Time-Dependent Heterogeneous Tabular Data"}, {"paperId": "7f851841e6420004312942ef5ffc2f875a574c13", "title": "Revisiting Pretraining Objectives for Tabular Deep Learning"}, {"paperId": "1057c047156594c8494b7e5f1f747d9f15dd1162", "title": "On Embeddings for Numerical Features in Tabular Deep Learning"}, {"paperId": "5fa06d856ba6ae9cd1366888f8134d7fd0db75b9", "title": "Revisiting Deep Learning Models for Tabular Data"}, {"paperId": "6fa1cfc4f97f03a8485692418c7aa1a06c574a85", "title": "Nystr\u00f6mformer: A Nystr\u00f6m-Based Algorithm for Approximating Self-Attention"}, {"paperId": "1b055049c568be70d6a762679cdb93f630d5d6e6", "title": "Tabular Transformers for Modeling Multivariate Time Series"}, {"paperId": "ad4bae9e8d8adbbab804452321df3ed728501494", "title": "Time-Aware Transformer-based Network for Clinical Notes Series Prediction"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "5f4a22ee70ca613d9c0630eafc96364fe365fdf8", "title": "Efficient Attention: Attention with Linear Complexities"}, {"paperId": "0033fb983d24c184410130b21c8c0c543958a851", "title": "Probabilistic Automatic Outlier Detection for Surface Air Quality Measurements from the China National Environmental Monitoring Network"}, {"paperId": "8512401a7242d2a260937cad810f563b07782833", "title": "Attribution Modeling Increases Efficiency of Bidding in Display Advertising"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "244e27bf8c5a5277a733c5271fdeb306f98115d5", "title": "Experiencing SAX: a novel symbolic representation of time series"}, {"paperId": "5a00b32876f7d4869bce980500d4ccc978389315", "title": "Why do tree-based models still outperform deep learning on typical tabular data?"}, {"paperId": null, "title": "Tabbie: Pretrainedrepresentationsoftabulardata"}, {"paperId": "32ead456a7316d26893861169f57ddaeb512dabb", "title": "CTR-BERT: Cost-effective knowledge distillation for billion-parameter teacher models"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Deep learning based recommender system: A survey and new perspectives"}, {"paperId": null, "title": "Beijing Multi-Site Air-Quality Data"}, {"paperId": null, "title": "XGBoost:Ascalabletreeboostingsystem"}, {"paperId": null, "title": "PKDD\u201999 Discovery challenge guide to the financial data set"}]}