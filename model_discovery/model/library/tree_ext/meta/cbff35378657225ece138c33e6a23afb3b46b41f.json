{"paperId": "cbff35378657225ece138c33e6a23afb3b46b41f", "title": "SALO: an efficient spatial accelerator enabling hybrid sparse attention mechanisms for long sequences", "abstract": "The attention mechanisms of transformers effectively extract pertinent information from the input sequence. However, the quadratic complexity of self-attention w.r.t the sequence length incurs heavy computational and memory burdens, especially for tasks with long sequences. Existing accelerators face performance degradation in these tasks. To this end, we propose SALO to enable hybrid sparse attention mechanisms for long sequences. SALO contains a data scheduler to map hybrid sparse attention patterns onto hardware and a spatial accelerator to perform the efficient attention computation. We show that SALO achieves 17.66x and 89.33x speedup on average compared to GPU and CPU implementations, respectively, on typical workloads, i.e., Longformer and ViL.", "venue": "Design Automation Conference", "year": 2022, "citationCount": 14, "influentialCitationCount": 1, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "SALO contains a data scheduler to map hybrid sparse attention patterns onto hardware and a spatial accelerator to perform the efficient attention computation and shows that SALO achieves 17.66x and 89.33x speedup on average compared to GPU and CPU implementations, respectively, on typical workloads."}, "embedding": {"model": "specter_v2", "vector": [0.4293893873691559, 0.27491500973701477, -0.352946937084198, 0.1810537874698639, 0.09976737201213837, 0.184734508395195, 0.10456480085849762, -0.04165524244308472, -0.08336781710386276, -0.3303881883621216, 0.723842978477478, 0.31700074672698975, 0.5672299265861511, -0.06379753351211548, 0.06950466334819794, -0.05801994353532791, -1.0564134120941162, -0.32990336418151855, 0.48747700452804565, -0.1752665489912033, 0.795854389667511, -0.557841956615448, -1.4273641109466553, 0.29895463585853577, 0.5172532200813293, 0.9262405037879944, 0.48252615332603455, 0.8732717633247375, -0.42148497700691223, 0.6276832818984985, 0.35997700691223145, 0.1692182719707489, 0.2811698615550995, -0.22597259283065796, -0.1393199861049652, -0.311094731092453, 0.6797597408294678, 0.006168128456920385, -0.602321982383728, 0.8687584400177002, -0.0060035004280507565, 0.12826205790042877, 0.25234127044677734, -0.6280935406684875, 0.14595384895801544, 0.5575993657112122, 0.39955005049705505, 1.1740031242370605, 0.09014521539211273, -0.21005578339099884, 1.3897860050201416, -1.3532941341400146, 0.011766445823013783, 1.1041549444198608, 0.6000863909721375, -0.08043859899044037, 0.08218157291412354, -0.5397260785102844, 0.3593244254589081, 0.42712879180908203, -0.4806566834449768, -0.5053291916847229, 0.3333803117275238, -0.21184685826301575, 1.7207448482513428, -0.021089432761073112, 0.14528653025627136, 0.45674800872802734, 0.4195949137210846, 1.3684440851211548, -0.29063013195991516, -0.7672282457351685, 0.1863851696252823, -0.1963234394788742, 0.6446525454521179, 0.6180128455162048, -0.3627236783504486, 0.21597819030284882, -1.4950308799743652, -0.032172054052352905, 0.40561720728874207, 0.1307692974805832, 0.2501192092895508, -0.460377961397171, -0.33683738112449646, 0.49167683720588684, 0.37346866726875305, 0.7750394940376282, -0.3711913824081421, 0.43384432792663574, 0.9641534686088562, 0.05399008095264435, -0.20860493183135986, 0.2534404695034027, 0.6220048069953918, 0.1627916544675827, -1.018669843673706, 0.03719833493232727, -0.036636833101511, 1.3416184186935425, -0.370165079832077, 0.8945489525794983, -0.6515400409698486, 0.15387693047523499, 0.7378729581832886, 0.19949418306350708, 0.599759578704834, -0.3983425199985504, -0.0786559209227562, -0.590925395488739, -0.0568576417863369, -1.125798225402832, -0.09263763576745987, -0.5879150032997131, -1.0629562139511108, -0.7532077431678772, -0.6602437496185303, 0.5978397130966187, -0.5004854202270508, 0.15268424153327942, -0.6199488043785095, 0.1794193536043167, -0.20611442625522614, 0.20208030939102173, 0.6940088868141174, 0.5565948486328125, 0.19540247321128845, 0.06867183744907379, 1.180585503578186, -1.2520127296447754, -0.6404593586921692, -1.227605938911438, -0.02515837922692299, -0.3582873046398163, 0.3969990909099579, -0.07783693075180054, -1.2909154891967773, -1.2408064603805542, -0.9901994466781616, 0.049696121364831924, -0.23300515115261078, -0.21794451773166656, 0.8480284214019775, -0.012214593589305878, -1.088523268699646, 0.7087273597717285, -0.30262064933776855, -0.35889843106269836, 0.6745060682296753, -0.0733368992805481, 0.8530458807945251, 0.013521093875169754, -1.1700598001480103, 0.07673872262239456, -0.08637496083974838, -0.8925428986549377, -0.22980955243110657, -0.8693618178367615, -1.2595807313919067, 0.40506839752197266, 0.3875468969345093, -0.21499431133270264, 1.0886504650115967, -0.16418837010860443, -0.7530313730239868, 0.5045385956764221, -0.4874381124973297, -0.05269528552889824, -0.17728623747825623, -0.07717195153236389, -0.33349698781967163, 0.06368483603000641, 0.14753474295139313, 0.3732057511806488, 0.5714279413223267, 0.013941619545221329, -0.28605732321739197, 0.12821373343467712, -0.44790521264076233, -0.07465272396802902, -0.5180860757827759, 1.179826259613037, -0.4735882878303528, -0.39331626892089844, 0.26216161251068115, 0.6184137463569641, -0.30311235785484314, -0.2810612916946411, -0.3552781045436859, -0.7578572034835815, 0.8009988069534302, 0.1842096894979477, 1.5265930891036987, -1.102434515953064, -0.9325886964797974, -0.22487950325012207, -0.367385596036911, -0.027514493092894554, -0.46719321608543396, 0.47416821122169495, -0.6560850143432617, -0.23905745148658752, 0.03655411675572395, -0.45718464255332947, -0.371680349111557, -0.4948309063911438, -0.9165355563163757, -0.3266153037548065, -0.1920401006937027, 0.9945693016052246, -1.263131856918335, -0.3321225345134735, -0.14692576229572296, 0.0014732596464455128, -0.8856214284896851, 1.2918163537979126, -0.2657468914985657, -0.1701030731201172, 0.0157634150236845, 0.15718181431293488, -0.04859887808561325, -0.610168993473053, 0.42528653144836426, -0.7518730759620667, -0.23716305196285248, 0.3378259539604187, 0.048977650701999664, 1.1728109121322632, -0.21785122156143188, 0.7237781882286072, -0.3465149402618408, -0.5913669466972351, 0.424500048160553, 0.24959240853786469, 0.2553960978984833, -0.9099580645561218, 0.40921714901924133, 0.06017465889453888, -0.6047428250312805, -0.13361413776874542, 0.7858167290687561, 1.3163295984268188, -0.6094178557395935, 0.028132731094956398, 0.6056721210479736, 0.04640752822160721, 0.5303543210029602, 0.4888659715652466, 0.9602057337760925, 0.20611006021499634, 0.7901660799980164, -0.5109098553657532, 0.45449748635292053, -0.632286787033081, -0.005014211405068636, 0.6285943388938904, 0.41728222370147705, 0.7704229950904846, 0.4243917167186737, -0.9134739637374878, -0.7482704520225525, 0.17478244006633759, 0.7411672472953796, 1.4917383193969727, 0.11717364937067032, -0.08956760913133621, -0.6108857989311218, -0.3157442808151245, -0.3670177757740021, 0.09396474063396454, -0.1581324338912964, -0.31682533025741577, -0.5924333333969116, -0.46917566657066345, 0.5244189500808716, 0.5134325623512268, 0.7404847145080566, -1.3652794361114502, -1.1284555196762085, -0.17165854573249817, 0.31021663546562195, -0.6371305584907532, -1.0743803977966309, 0.5979588031768799, -0.44596177339553833, -0.13625262677669525, 0.14490661025047302, -0.09675668179988861, 0.13678279519081116, -0.17202547192573547, 1.1144522428512573, -0.7586379051208496, -0.42856094241142273, 0.07826535403728485, 0.38487106561660767, -0.6595271825790405, -0.24728210270404816, 0.30667227506637573, -0.05207553878426552, -0.1914963573217392, 0.4276513457298279, -0.22440208494663239, -0.21863387525081635, 0.052720312029123306, -0.11913353204727173, 0.029767246916890144, 0.31305092573165894, 0.09568655490875244, 0.2966730296611786, -0.4540780186653137, 0.09868303686380386, -0.8799974918365479, 0.5694820880889893, 0.04560253396630287, -0.3559374511241913, -0.27089568972587585, -0.45756858587265015, -0.27672210335731506, 0.5171453952789307, -0.6134382486343384, -0.19210587441921234, -0.6540654897689819, 0.2791276276111603, -0.3818838894367218, -0.31852826476097107, -0.16080385446548462, 0.2737283706665039, -0.2039480209350586, 0.4203333258628845, 0.8382149934768677, 0.23446913063526154, 0.41454046964645386, -0.2752718925476074, -0.4007204473018646, 0.787530779838562, 0.29246488213539124, -0.2559424340724945, 0.04239857569336891, 0.00026398510090075433, -1.025130033493042, -0.777859091758728, -0.5799853205680847, -0.40502500534057617, -0.4814131259918213, 0.15560106933116913, -0.3627927601337433, -1.2520434856414795, -0.2629161775112152, -1.1615536212921143, -0.17543910443782806, -0.005409971345216036, -0.5065028071403503, -0.4646191895008087, -0.7326376438140869, -0.8879585266113281, -0.6015419363975525, -1.2222249507904053, -1.054033637046814, 0.3071102499961853, 0.2687445282936096, -0.8349342942237854, -0.21280868351459503, -0.21389541029930115, -0.9491282105445862, 1.2191787958145142, -0.2987501621246338, 0.2444741129875183, -0.11023739725351334, -0.5577520728111267, -0.021111108362674713, 0.1392422467470169, 0.006877447012811899, -0.17859888076782227, -0.14881698787212372, -0.5176219940185547, 0.2916792929172516, -0.0419793426990509, 0.017824500799179077, 0.10464203357696533, 0.352620005607605, 0.9328808784484863, 0.08767027407884598, -0.4420892894268036, 0.24275797605514526, 1.4379247426986694, 0.12659254670143127, 0.20244379341602325, 0.09901785105466843, 0.8442947268486023, 0.010999062098562717, 0.21172623336315155, 0.9571640491485596, 0.030885325744748116, 0.645977795124054, 0.37392526865005493, -0.1693069189786911, -0.20618458092212677, -0.01762198470532894, 0.5671016573905945, 1.6222506761550903, 0.5529192686080933, 0.2847534120082855, -0.92985600233078, 0.8801475763320923, -0.9456128478050232, -1.214316725730896, 0.52445387840271, 0.4560895264148712, 0.2972129285335541, -0.18615934252738953, -0.12352634966373444, 0.034980256110429764, 0.4499426782131195, 0.7043604254722595, -0.6618874073028564, -0.969103991985321, 0.07580427825450897, 0.5341200828552246, 0.2820819318294525, 0.577150285243988, -0.28029969334602356, 0.20534436404705048, 15.24959659576416, 0.5489363074302673, -0.18587185442447662, 0.3789476156234741, 0.5781835913658142, 0.35835206508636475, 0.11572924256324768, -0.13351882994174957, -1.1421955823898315, 0.39434048533439636, 1.238672137260437, -0.08816129714250565, 0.18818943202495575, 0.4882848262786865, 0.08486341685056686, 0.013292629271745682, -0.48762044310569763, 0.8047612309455872, 0.9549115896224976, -1.432931900024414, -0.11743918061256409, 0.06479509174823761, 0.1233285591006279, 0.2220098227262497, 0.6265476942062378, 0.3114469349384308, 0.44903212785720825, 0.11134573072195053, 0.5909327268600464, 0.2108682096004486, 1.024970293045044, -0.16073887050151825, 0.19377365708351135, 0.1554647535085678, -1.1604963541030884, -0.06978841871023178, -0.4409666657447815, -1.105812430381775, 0.3318076729774475, 0.3061574101448059, -0.44942691922187805, -0.4123918414115906, -0.056621477007865906, 0.7893730998039246, 0.26148325204849243, 0.6989962458610535, -0.23548680543899536, 0.32914602756500244, 0.4169444143772125, -0.18805885314941406, 0.2692455053329468, 0.7663799524307251, 0.19658246636390686, 0.23207293450832367, 0.1688833385705948, 0.17420703172683716, 0.2639525532722473, 0.3369327187538147, 0.2392721027135849, -0.3991759419441223, -0.5356147289276123, -0.14667335152626038, -0.04356352612376213, 0.586010754108429, 0.48952344059944153, 0.118561752140522, -0.47970595955848694, 0.3691532015800476, 0.09406590461730957, -0.1557786762714386, -0.5559216737747192, -0.604623556137085, 0.4133821427822113, -0.47556641697883606, 0.0204661563038826, 0.48343318700790405, -0.8097044229507446, -0.44771918654441833, -1.0981693267822266, -0.6822732090950012, 0.6932626366615295, -0.8854402303695679, -0.44904059171676636, 0.9884448051452637, -0.4385640025138855, -0.6267727017402649, 0.35591354966163635, -0.49090519547462463, -0.5081055760383606, 0.29978254437446594, -0.8952006697654724, -0.1812998503446579, -0.4917553663253784, -0.5203827023506165, 0.1933128386735916, 0.026842236518859863, 0.9166271090507507, 0.03204270079731941, 0.032975196838378906, 0.015663500875234604, -0.617892861366272, -0.3732983469963074, -0.3641042709350586, -0.5354592800140381, 0.8857161402702332, 0.5168912410736084, -0.35823485255241394, 0.044801078736782074, 0.5301414132118225, -0.032420117408037186, -0.8956848978996277, 0.05011093243956566, 0.6192064881324768, -0.4039043188095093, -0.2415020763874054, -1.0424023866653442, -1.1422230005264282, 0.10635937750339508, 0.7902222275733948, 0.04378846660256386, 0.22003032267093658, -0.1910846084356308, -0.2654325067996979, -0.27171239256858826, -0.36502671241760254, 0.0005976551328785717, 0.7368623614311218, -0.6173684597015381, -0.31968072056770325, -0.574482798576355, 0.46546104550361633, -1.1046600341796875, -0.20617695152759552, -0.13149377703666687, 0.1927361935377121, -0.6895453929901123, 1.1710692644119263, 0.1330515295267105, 0.8288284540176392, 0.7917450070381165, 0.2858142852783203, -0.4437640905380249, -0.23425960540771484, -0.7668086886405945, -0.11795272678136826, 0.07084733247756958, -0.05337342992424965, -0.031360890716314316, 0.8362324833869934, 0.09761308878660202, -0.14627397060394287, -0.5096555948257446, -0.36267244815826416, -0.27038732171058655, -0.8321918845176697, -0.3676850497722626, 0.11914904415607452, 0.06942735612392426, 0.35890039801597595, 0.15903083980083466, 0.14742013812065125, 0.39302223920822144, 0.22593693435192108, -0.21103736758232117, 0.2475937455892563, 0.039493098855018616, 0.04327913001179695, -0.6591420769691467, -0.6914721131324768, -1.285826325416565, -0.20981615781784058, -0.8573701977729797, 0.16322346031665802, -0.41459664702415466, -0.36737725138664246, 0.21431557834148407, -0.38264650106430054, 0.16618973016738892, 0.27090659737586975, -0.19517989456653595, -0.5041939616203308, -0.6895250082015991, -0.8277993202209473, 0.7829242944717407, 0.5783027410507202, -0.536146342754364, -0.08207894116640091, -0.2662685513496399, -0.07842187583446503, 0.32664716243743896, 0.4475199580192566, -0.49853140115737915, -0.36505094170570374, -0.7206704616546631, 0.07672037184238434, 0.10878890007734299, -0.37386712431907654, -1.1647206544876099, 1.0166562795639038, 0.09731084853410721, -0.26619306206703186, -0.4452905058860779, 0.040356285870075226, -0.9241957068443298, -0.47296303510665894, 0.7333508133888245, -0.7225273847579956, 0.23576720058918, 0.3989473879337311, -0.8628870844841003, -0.46221670508384705, 0.6679699420928955, 0.3631547689437866, -0.9616794586181641, -0.9992237091064453, 0.5030947923660278, -0.3883756697177887, 0.29728418588638306, 0.06853147596120834, -0.2993084788322449, -1.00677490234375, -0.30484992265701294, 0.0728585496544838, 0.1997271329164505, -0.5265085101127625, 0.9797848463058472, 0.5146505236625671, -1.3025578260421753, 0.4320824444293976, 0.680531919002533, -0.17686223983764648, -0.20979094505310059, 0.7104016542434692, 0.44343796372413635, -0.27521613240242004, 0.7680226564407349, -0.26624244451522827, -0.01400896068662405, -1.017459750175476, 0.42474937438964844, 0.362162709236145, -0.2378498911857605, -0.03313400596380234, 0.6900971531867981, -0.262780100107193, -0.2500540316104889, 0.302061527967453, -0.9026563763618469, -0.6321853995323181, -0.08457774668931961, 0.8439722657203674, 0.36412739753723145, -0.2675706148147583, -0.16825489699840546, -0.8310392498970032, 0.16437536478042603, 0.22145357728004456, -0.06661883741617203, 0.5340570211410522, 0.07309804856777191, -0.32259097695350647, 0.5904001593589783, 0.622849702835083, -0.5476531982421875, -0.5038600564002991, -0.6128042936325073, -0.2967419922351837, -0.456592321395874, -0.010891256853938103, 0.19270290434360504, -0.5347230434417725, 0.9028348326683044, 0.3417389392852783, 0.5409865975379944, 0.4206678569316864, -0.14885275065898895, 0.2277485579252243, -0.04132428392767906, 0.15763206779956818, -0.232504203915596, -0.0207744762301445, 1.5762423276901245, 1.5037243366241455, -0.28467315435409546, 0.14399878680706024, -0.549862802028656, -0.5025473237037659, 0.9198253750801086, 0.5965806245803833, -0.3366375267505646, 0.6523461937904358, 0.3629560172557831, -0.09114125370979309, 0.09826232492923737, -1.0147508382797241, -0.1872912496328354, 0.6669580340385437, 0.8216362595558167, 0.7394580841064453, -0.12507811188697815, 0.1325749307870865, 0.5993022918701172, 0.15684616565704346, 0.31291207671165466, 0.45698386430740356, 0.48645511269569397, -0.3447380065917969, 0.08002003282308578, -0.11095793545246124, 0.6191856265068054, -0.5790757536888123, -0.6879202127456665, 0.7376864552497864, 0.17538471519947052, -0.08380243182182312, 0.18956342339515686, 1.2626525163650513, -0.11607589572668076, 0.7805330157279968, -0.26177990436553955, 0.32197028398513794, -0.5837627053260803, -0.2365039438009262, -0.0752965658903122, -0.814982533454895, -0.4954410195350647, 0.0018655380699783564, -0.8456374406814575, -0.21310663223266602, 0.021138517186045647, 0.43843287229537964, -0.013500561937689781, 0.11736646294593811, 0.6384811401367188, 0.8965374231338501, 1.0386229753494263, -0.10585056990385056, -0.9486178159713745, -0.40200933814048767, -0.8859279155731201, 0.30198389291763306, -0.4455386698246002, -0.07063674926757812, -0.1227201521396637, -0.09484219551086426, -0.08565862476825714]}, "authors": [{"authorId": "2174027859", "name": "Guan Shen"}, {"authorId": "11446977", "name": "Jieru Zhao"}, {"authorId": "1596812259", "name": "Quan Chen"}, {"authorId": "1831521", "name": "Jingwen Leng"}, {"authorId": "46651287", "name": "C. Li"}, {"authorId": "2151671216", "name": "Minyi Guo"}], "references": [{"paperId": "b97c3c370401dc34d2adbeb24f34de5180a14be6", "title": "Sanger: A Co-Design Framework for Enabling Sparse Attention using Reconfigurable Architecture"}, {"paperId": "3cbe314cc5407a6c3249815b5173f22ea15173c2", "title": "Multi-Scale Vision Longformer: A New Vision Transformer for High-Resolution Image Encoding"}, {"paperId": "b080ba53a471348e7e76234decdf14e730fea7db", "title": "Softermax: Hardware/Software Co-Design of an Efficient Softmax for Transformers"}, {"paperId": "73e0f38ab49b19b86321016b773e15f1d02e3a72", "title": "SpAtten: Efficient Sparse Attention Architecture with Cascade Token and Head Pruning"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "7c6c31412c5dad22543bb71e31620e8868d644a3", "title": "FTRANS: energy-efficient acceleration of transformers using FPGA"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "d3c6c635b9cfd8890c7244d3db4be53d45944963", "title": "A^3: Accelerating Attention Mechanisms in Neural Networks with Approximation"}, {"paperId": "3c8a456509e6c0805354bd40a35e3f2dbf8069b1", "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library"}, {"paperId": "76df2eba276123657d8ba72fe70ae83fb8a85e3a", "title": "QPyTorch: A Low-Precision Arithmetic Simulation Framework"}, {"paperId": "c95383f251a62c63217586059c67f63507c3e839", "title": "HuggingFace's Transformers: State-of-the-art Natural Language Processing"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "021464b67bb87cf6132b2eb5b0c4a61f31ec2775", "title": "Chisel: Constructing hardware in a Scala embedded language"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Star-transformer. arXiv preprint arXiv:1902.09113 (2019"}]}