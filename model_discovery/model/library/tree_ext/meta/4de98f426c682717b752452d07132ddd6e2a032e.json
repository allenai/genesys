{"paperId": "4de98f426c682717b752452d07132ddd6e2a032e", "title": "Speed Is All You Need: On-Device Acceleration of Large Diffusion Models via GPU-Aware Optimizations", "abstract": "The rapid development and application of foundation models have revolutionized the field of artificial intelligence. Large diffusion models have gained significant attention for their ability to generate photorealistic images and support various tasks. On-device deployment of these models provides benefits such as lower server costs, offline functionality, and improved user privacy. However, common large diffusion models have over 1 billion parameters and pose challenges due to restricted computational and memory resources on devices. We present a series of implementation optimizations for large diffusion models that achieve the fastest reported inference latency to-date(under 12 seconds for Stable Diffusion 1.4 without INT8 quantization for a 512 \u00d7 512 image with 20 iterations) on GPU-equipped mobile devices. These enhancements broaden the applicability of generative AI and improve the overall user experience across a wide range of devices.", "venue": "2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops (CVPRW)", "year": 2023, "citationCount": 26, "influentialCitationCount": 2, "openAccessPdf": {"url": "https://arxiv.org/pdf/2304.11267", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "A series of implementation optimizations for large diffusion models are presented that achieve the fastest reported inference latency to-date and broaden the applicability of generative AI and improve the overall user experience across a wide range of devices."}, "embedding": {"model": "specter_v2", "vector": [0.3296772241592407, 0.3401448130607605, -0.316562682390213, 0.17115338146686554, 0.26030993461608887, 0.06072443723678589, 0.756955087184906, -0.4157413840293884, -0.41054779291152954, -0.8313923478126526, 0.26815277338027954, 0.4076964557170868, -0.023877417668700218, -0.07655312865972519, -0.32214927673339844, 0.003993094898760319, -0.9001269936561584, 0.09371321648359299, 0.2123207002878189, -0.42855969071388245, 0.09302998334169388, 0.010723916813731194, -1.2803521156311035, 0.08791536092758179, 0.18134838342666626, 0.8439319133758545, -0.3134298622608185, 1.4716157913208008, 0.15497368574142456, 0.2273620367050171, 0.38478073477745056, -0.3096362352371216, 0.49915337562561035, 0.040278106927871704, -0.09277980774641037, 0.0017890325980260968, 0.1784348338842392, -0.893174946308136, -0.5588359832763672, 0.5329210162162781, 0.04369143024086952, 0.08968797326087952, 0.6566373109817505, -0.5822070240974426, -0.8988643288612366, 0.12926675379276276, -0.049730975180864334, 1.214765191078186, -0.003697550855576992, -0.18238414824008942, 0.8113132119178772, -1.0178881883621216, 0.7317988872528076, 1.5498405694961548, 0.29659801721572876, 0.27029114961624146, -0.34767472743988037, -0.5187061429023743, 0.3606100380420685, 0.045595381408929825, -0.778491199016571, -0.12799406051635742, 0.18483544886112213, -0.2975285053253174, 1.350335955619812, -0.3218710422515869, 0.4302532374858856, 0.8891319036483765, 0.23169642686843872, 1.773354411125183, 0.21161766350269318, -0.9684928059577942, 0.28807127475738525, 0.07620831578969955, 0.047211091965436935, 0.783364474773407, -0.3675888478755951, 0.3313159644603729, -1.003724455833435, -0.2523447871208191, 1.0568584203720093, -0.3248499929904938, 0.3944571912288666, -0.09211248904466629, -0.09542479366064072, 0.994966983795166, 0.5512558817863464, 0.46918433904647827, -0.4323346018791199, 0.8922774195671082, 0.17428798973560333, 0.10012839734554291, 0.14045517146587372, -0.11594938486814499, 0.6150961518287659, 0.40424394607543945, -0.7548747062683105, 0.4471096396446228, -0.15480922162532806, 0.706544816493988, -0.33456122875213623, 0.11153852939605713, -0.8173398375511169, 0.12960712611675262, 0.9932502508163452, 0.12990470230579376, 0.46103304624557495, -0.8796447515487671, -0.24321283400058746, -0.8437804579734802, 0.3737105131149292, -0.8801453709602356, 0.06002046912908554, -0.1106511652469635, -1.1755133867263794, -0.6368551850318909, -0.577038586139679, 0.04446805268526077, -0.887740969657898, 0.1592792570590973, 0.056939657777547836, 0.2803799510002136, -0.24858012795448303, 0.5941227674484253, 0.172962486743927, 0.6615688800811768, 0.17913809418678284, 0.5751489400863647, 0.47143682837486267, -1.1392592191696167, -0.6870591044425964, -0.9860785007476807, 0.319189190864563, -0.18060946464538574, 0.45701682567596436, 0.14114241302013397, -1.581517219543457, -1.028414249420166, -0.8850483298301697, -0.006792104337364435, -0.2930263578891754, 0.3797856867313385, 1.6467939615249634, 0.4971908926963806, -0.9531471133232117, 0.7202370762825012, -0.480832040309906, -0.2288123369216919, 0.7191875576972961, 0.2772761583328247, 0.45216211676597595, -0.4181385636329651, -0.5571523308753967, -0.11109688133001328, -0.20539958775043488, -0.2952665388584137, 0.07592616975307465, -0.2594592273235321, -0.5413146615028381, -0.06586150825023651, -0.0032478952780365944, -0.6634606122970581, 0.849570631980896, -0.3725550174713135, -1.2520067691802979, 0.5309535264968872, -0.10400979965925217, -0.0029841307550668716, 0.46379703283309937, -0.20352999866008759, -0.446937620639801, -0.24833713471889496, -0.42179393768310547, 0.9676526784896851, 0.937244176864624, -0.1914885938167572, -0.054607778787612915, -0.09120389074087143, -0.044654812663793564, -0.028859132900834084, -0.554455041885376, 0.970904529094696, -0.7493045926094055, -0.3656344413757324, 0.027019329369068146, 0.12802131474018097, -0.4055192768573761, 0.17625923454761505, -0.25795644521713257, -0.9145322442054749, 0.8256577849388123, 0.13397543132305145, 1.0451807975769043, -1.0052201747894287, -0.4999009966850281, 0.18909777700901031, 0.10696425288915634, -0.2904558479785919, -0.7411639094352722, 0.43367642164230347, 0.048567961901426315, 0.3187912106513977, 0.18584835529327393, -0.7027794718742371, 0.006947745569050312, -0.44825389981269836, -0.5807510018348694, -0.16908515989780426, 0.09464319050312042, 1.3275489807128906, -0.41825440526008606, 0.23251570761203766, -0.23994292318820953, 0.5217944979667664, -1.107994556427002, 0.9195265173912048, -0.29807808995246887, 0.2981337308883667, -0.2279880791902542, -0.23755870759487152, 0.3467468023300171, -0.6842542290687561, -0.037418000400066376, -0.3074859380722046, 0.18674801290035248, -0.3233666718006134, -0.6759423613548279, 1.5566530227661133, 0.03012028895318508, 0.5048007369041443, -0.21873770654201508, -0.0406649224460125, 0.10774805396795273, -0.08432627469301224, -0.3478067219257355, -0.2634395360946655, 0.23723377287387848, 0.3919612467288971, -0.34893885254859924, 0.44307640194892883, 0.57980877161026, 1.0616472959518433, -0.21552208065986633, 0.24692752957344055, 0.20335662364959717, -0.5152698159217834, 0.4213484525680542, 0.5397529602050781, 0.7681952118873596, 0.5399578213691711, -0.1258671134710312, -0.010933758690953255, -0.05101218447089195, -0.9551641941070557, -0.5178958177566528, 1.0128278732299805, 0.7276073098182678, 0.85443514585495, 0.17336635291576385, -1.0884218215942383, -0.37216803431510925, -0.1052853986620903, 0.6941875219345093, 1.128305435180664, 0.10265961289405823, -0.1881261020898819, -0.8558735251426697, -0.03645886480808258, -0.33770203590393066, -0.20248621702194214, -0.8287338614463806, -0.11340444535017014, -0.24252969026565552, -1.1425455808639526, 0.6475170254707336, 0.2255779504776001, 0.9741988182067871, -0.6473050117492676, -0.5449345707893372, -0.4669624865055084, 0.6919309496879578, -0.47525516152381897, -0.4927833378314972, -0.29773005843162537, -0.39717617630958557, 0.6645960807800293, -0.4395168721675873, 0.19001054763793945, 0.07253324240446091, -0.47256672382354736, 0.4169078767299652, -0.044825226068496704, -0.6969322562217712, 0.2800583243370056, 0.9261190891265869, -0.7900234460830688, -0.5992961525917053, -0.09125647693872452, -0.03476130589842796, 0.08873672038316727, 0.19220739603042603, 0.2857268750667572, -0.5509194731712341, 0.21986468136310577, -0.6324995756149292, 0.09860306233167648, -0.032862160354852676, -0.26916036009788513, 0.5617116689682007, -0.0620141327381134, -0.3797867000102997, -0.6724396347999573, 1.3906170129776, 0.2327469289302826, -0.561486542224884, 0.11032283306121826, -0.7006794810295105, -0.4622190296649933, 0.21996837854385376, -1.242056131362915, -0.6456568837165833, -0.8023257255554199, 0.31776443123817444, -0.29473742842674255, -0.3165690004825592, -0.21355755627155304, 0.9328125715255737, -0.3978968560695648, 0.7752516865730286, 0.10147853195667267, -0.16556482017040253, 0.04384821653366089, 0.5510688424110413, -0.7113823294639587, 0.48664793372154236, 0.24013732373714447, 0.26272809505462646, 0.5454922318458557, 0.02848409302532673, -0.8696820735931396, -0.36202046275138855, -0.002452861052006483, -0.5072460174560547, -0.6999027729034424, 0.355899453163147, -0.45550286769866943, -1.005696177482605, 0.22189168632030487, -0.8635299205780029, -0.31340712308883667, -0.041241779923439026, -0.3518695533275604, -0.20792162418365479, -0.9368476867675781, -1.4323163032531738, -0.6561033129692078, -0.6233596801757812, -1.0232064723968506, 0.5714265704154968, 0.4111390709877014, -0.41866546869277954, -0.5255311131477356, -0.08179140836000443, -0.20486122369766235, 1.060192584991455, -0.4626382291316986, 0.41457098722457886, 0.6431796550750732, -0.6241200566291809, -0.6301842331886292, 0.26474758982658386, 0.053514864295721054, -0.4221261739730835, 0.6536938548088074, -0.8894009590148926, 0.23496294021606445, -0.4866509437561035, -0.43587547540664673, 0.06944568455219269, 0.6913919448852539, 0.6899227499961853, 0.339009553194046, -0.45368024706840515, 0.23313921689987183, 0.9524456858634949, -0.775964081287384, 0.18733298778533936, 0.18743854761123657, 0.9751861095428467, 0.04716091975569725, -0.33471155166625977, 0.9542356133460999, 0.12216618657112122, 0.5064433813095093, -0.31283023953437805, -0.3959991931915283, -0.3554563522338867, -0.7876285910606384, 0.46872028708457947, 1.0834629535675049, -0.06011359393596649, -0.30892717838287354, -0.631758987903595, 0.09529819339513779, -1.0777592658996582, -0.7804237604141235, 0.619720458984375, 0.8300316333770752, -0.20092366635799408, -0.07511672377586365, 0.0705641508102417, -0.3077533543109894, 0.3031426966190338, 0.356402188539505, -0.8193972110748291, -0.7305320501327515, -0.22181619703769684, 0.30886706709861755, -0.0005045110010541975, 0.5061704516410828, -0.19725416600704193, 0.6942161321640015, 15.221302032470703, 1.0644181966781616, -0.17825347185134888, 0.3835093379020691, 1.212982177734375, 0.1775307059288025, -0.6419277787208557, -0.27291446924209595, -1.1964031457901, -0.19771063327789307, 1.0191524028778076, 0.2343970239162445, 0.8924795389175415, 0.08309437334537506, -0.08175448328256607, -0.15910138189792633, -0.15394823253154755, 0.7425987124443054, 0.42500394582748413, -1.6533986330032349, 0.23044131696224213, 0.4807562530040741, 0.6016173958778381, 0.561451256275177, 1.3350752592086792, 0.24586926400661469, 0.5306009650230408, -0.23575405776500702, 0.4954124987125397, 0.25875595211982727, 0.7929859161376953, 0.07173334807157516, -0.10749934613704681, 0.682007908821106, -0.6018351316452026, -0.27020469307899475, -0.8136420249938965, -1.0256223678588867, 0.31783682107925415, -0.22386476397514343, -0.44184353947639465, -0.7587981820106506, 0.1835820972919464, 0.7538296580314636, -0.15955235064029694, 0.2684524953365326, -0.27684059739112854, 0.6147472262382507, -0.6844983696937561, 0.04431590065360069, 0.2261221557855606, -0.002614983357489109, -0.06891993433237076, -0.311879962682724, 0.140546515583992, 0.16144415736198425, -0.11171175539493561, 0.6903382539749146, -0.22150906920433044, 0.09072623401880264, -0.33901989459991455, -0.2314470112323761, -0.4256587624549866, 0.7174617648124695, -0.10799205303192139, 0.3007999360561371, -0.2688683569431305, 1.0355761051177979, 0.5416725277900696, 0.3147195279598236, -0.3920983076095581, 0.39084094762802124, -0.08601388335227966, -0.4050004184246063, 0.022738128900527954, 0.4302748143672943, -0.15459319949150085, -0.5921869874000549, -0.5116105675697327, -0.2754787802696228, 0.4091385304927826, -1.0331730842590332, -0.8364269137382507, 0.9525250792503357, -0.1153654232621193, 0.0840311124920845, 0.22584351897239685, -0.5011032223701477, -0.3834340572357178, 0.4497499465942383, -1.0441818237304688, -1.0927168130874634, 0.35396096110343933, -0.2166977971792221, -0.15673863887786865, 0.17198151350021362, 1.072556972503662, -0.13023704290390015, -0.3963347375392914, 0.037334032356739044, 0.06939836591482162, -0.6342808604240417, -0.4653034210205078, -0.40613558888435364, 1.3462307453155518, 0.33810046315193176, 0.16445937752723694, 0.14004172384738922, 0.010033201426267624, -0.09963389486074448, -1.0400179624557495, 0.7522179484367371, -0.045431144535541534, -0.8183452486991882, -0.29997721314430237, -0.8328104615211487, -0.6592360138893127, 0.13952645659446716, 0.5966823101043701, -0.014116303995251656, 0.14030960202217102, -0.027653062716126442, -0.3123822808265686, -0.07405467331409454, -0.6330838799476624, 0.5421656966209412, 0.5057260990142822, -0.44388478994369507, 0.4604237973690033, 0.04314432293176651, -0.07409974932670593, -0.8628547191619873, -0.6003340482711792, -0.1885356605052948, 0.5013353824615479, -0.5841622948646545, 1.2884200811386108, -0.15808258950710297, 0.5089399218559265, 1.0611937046051025, 0.1973617821931839, -0.39873096346855164, -0.3841460645198822, -1.2879637479782104, -0.025665070861577988, -0.14312583208084106, 0.42118746042251587, -0.045610252767801285, 0.7766847014427185, 1.3174244165420532, 1.128785252571106, -0.2721168100833893, -0.3017062246799469, -0.1937435269355774, 0.1163581982254982, -0.35214027762413025, 0.1737227588891983, -0.6000826954841614, -0.5756965279579163, 0.13475167751312256, -0.09718898683786392, 0.5189267992973328, 0.01569104939699173, -0.4984395205974579, 0.7290695905685425, -0.2097783386707306, -0.2533271610736847, -0.48871269822120667, -0.364688903093338, -1.931593894958496, -0.46721750497817993, -0.8194314241409302, -0.5127388834953308, -0.8490158915519714, -0.6680023670196533, -0.13679978251457214, 0.017856163904070854, -0.46057161688804626, 0.48158007860183716, -0.010839397087693214, -0.2467436045408249, -0.24065174162387848, -0.2819356322288513, 0.617000937461853, 1.2663575410842896, -0.6955620646476746, -0.174114391207695, 0.026658043265342712, 0.35554859042167664, 0.5419905185699463, 0.30233627557754517, -0.516026496887207, -1.099657416343689, -1.1474618911743164, 0.4278605580329895, -0.22393977642059326, -0.19082391262054443, -1.0411505699157715, 0.5757479071617126, 0.19752833247184753, 0.35496222972869873, 0.31963875889778137, 1.0523041486740112, -0.6174710988998413, -0.18693171441555023, 0.4085332751274109, -1.0306519269943237, 0.24752166867256165, 0.11900536715984344, -0.18952393531799316, 0.39103826880455017, 0.7652297019958496, -0.16982366144657135, -0.6679883003234863, -0.690971314907074, 0.6007487773895264, -0.6727034449577332, -0.19293498992919922, -0.4194534420967102, -0.3162757456302643, -0.8937915563583374, -0.7045318484306335, -0.1348530501127243, -0.3998366892337799, -0.17364223301410675, 1.1134698390960693, 0.5736542344093323, -0.9605650305747986, 0.15618064999580383, 0.5083290934562683, -0.3568370044231415, -0.26744794845581055, 0.8509784936904907, 0.1762942522764206, -0.3616149127483368, 0.09351719170808792, 0.12938694655895233, 0.22404257953166962, -0.7132324576377869, 0.2881396412849426, 0.31142163276672363, -0.3400666415691376, -0.3347543179988861, 1.3391793966293335, 0.10321753472089767, -0.5659728050231934, -0.040449708700180054, -0.8509549498558044, -0.3775768280029297, -0.8704752922058105, 0.6493499279022217, 0.11070556938648224, -0.3609668016433716, 0.03871036320924759, -0.1734025478363037, 0.4372982680797577, -0.2675844132900238, -0.7492291927337646, 0.4434191882610321, -0.2713455855846405, 0.004470731597393751, 0.46209150552749634, 0.3897956609725952, -0.3557121455669403, -1.1039485931396484, -0.5769780874252319, -0.4622119963169098, -0.6327840089797974, 0.44192948937416077, -0.5275832414627075, -0.575054407119751, 1.0669629573822021, 0.9426769614219666, 0.1468542367219925, 0.43788623809814453, 0.11680028587579727, 0.37218648195266724, 0.5311391949653625, -0.12661950290203094, -0.6806140542030334, -0.17427127063274384, 0.42698708176612854, 1.2265496253967285, -0.6917356848716736, 0.46410855650901794, -0.5649306774139404, -0.8981411457061768, 0.7615381479263306, 0.23838479816913605, -0.3006393313407898, 1.0816826820373535, 0.004530595615506172, 0.11254259943962097, -0.005121152848005295, -0.6660261750221252, 0.2446245551109314, 1.1469953060150146, 0.9142177104949951, 0.40872785449028015, 0.1334017813205719, 0.17616215348243713, 0.4481249749660492, 0.355884850025177, 0.5980243682861328, 0.4729996621608734, 0.481677383184433, 0.22410650551319122, 0.10011414438486099, 0.036429304629564285, 0.4485378861427307, -0.427837073802948, -0.3175206780433655, 0.25135546922683716, 0.369708776473999, 0.04682615399360657, 0.5640907287597656, 0.6532896757125854, 0.23969359695911407, 0.35978955030441284, -0.7069504857063293, 0.881950318813324, 0.001303180935792625, -0.21819272637367249, 0.4788452088832855, -0.9370257258415222, -0.05660548433661461, -0.0747612863779068, -0.338844358921051, -0.06810421496629715, -0.31915679574012756, 0.18749068677425385, -0.4673226773738861, 0.2785877585411072, 0.6138554811477661, 0.9691084027290344, -0.06257309764623642, -0.4333641827106476, -0.8631410598754883, 0.03784763067960739, -0.5743110179901123, -0.006260602734982967, -0.07072987407445908, -0.5276559591293335, -0.2634064555168152, -0.1499924510717392, -0.251832515001297]}, "authors": [{"authorId": "2215222706", "name": "Yu-Hui Chen"}, {"authorId": "150283989", "name": "Raman Sarokin"}, {"authorId": "2144703503", "name": "Juhyun Lee"}, {"authorId": "2295750", "name": "Jiuqiang Tang"}, {"authorId": "3345720", "name": "Chuo-Ling Chang"}, {"authorId": "150018632", "name": "Andrei Kulik"}, {"authorId": "150213295", "name": "Matthias Grundmann"}], "references": [{"paperId": "efbe97d20c4ffe356e8826c01dc550bacc405add", "title": "Adding Conditional Control to Text-to-Image Diffusion Models"}, {"paperId": "5b19bf6c3f4b25cac96362c98b930cf4b37f6744", "title": "DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "929dd1222d115b888d34dde27a93808bc0de37c1", "title": "Winograd Convolution for Deep Neural Networks: Efficient Point Selection"}, {"paperId": "c10075b3746a9f3dd5811970e93c8ca3ad39b39d", "title": "High-Resolution Image Synthesis with Latent Diffusion Models"}, {"paperId": "38c0234304fef9307d8bc92da47e3faab19c0c3e", "title": "A pseudo-softmax function for hardware-based high speed image classification"}, {"paperId": "3fbf6339273c50b04e886fa9bd4ad18c952a683d", "title": "Rethinking Attention with Performers"}, {"paperId": "5c126ae3421f05768d8edd97ecd44b1364e2c99a", "title": "Denoising Diffusion Probabilistic Models"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "6130d3066e1e29590c82c0b5454a231a9976fd5e", "title": "Efficient Memory Management for Deep Neural Net Inference"}, {"paperId": "ceb2ebef0b41e31c1a21b28c2734123900c005e2", "title": "A Style-Based Generator Architecture for Generative Adversarial Networks"}, {"paperId": "7145a7f391c71efc6f6c0fc82197cf93adcbf63a", "title": "Hardware-Aware Softmax Approximation for Deep Neural Networks"}, {"paperId": "22aab110058ebbd198edb1f1e7b4f69fb13c0613", "title": "Large Scale GAN Training for High Fidelity Natural Image Synthesis"}, {"paperId": "d08b35243edc5be07387a9ed218070b31e502901", "title": "Group Normalization"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "2f85b7376769473d2bed56f855f115e23d727094", "title": "Wasserstein GAN"}, {"paperId": "ac97d35ca2bcb5eca8a496c8aa2e90f57fb58517", "title": "Efficient hardware architecture of softmax layer in deep neural network"}, {"paperId": "4361e64f2d12d63476fdc88faf72a0f70d9a2ffb", "title": "Bridging Nonlinearities and Stochastic Regularizers with Gaussian Error Linear Units"}, {"paperId": "de5e7320729f5d3cbb6709eb6329ec41ace8c95d", "title": "Gaussian Error Linear Units (GELUs)"}, {"paperId": "8388f1be26329fa45e5807e968a641ce170ea078", "title": "Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks"}, {"paperId": "1121ff5cdeaa470521b8dff084ba1424dd613cc1", "title": "Fast Algorithms for Convolutional Neural Networks"}, {"paperId": "6364fdaa0a0eccd823a779fcdd489173f938e91a", "title": "U-Net: Convolutional Networks for Biomedical Image Segmentation"}, {"paperId": "13bc4e683075bdd6a3f0155241c276a772d4aa06", "title": "Generative adversarial networks"}, {"paperId": "5f5dc5b9a2ba710937e2c413b37b053cd673df02", "title": "Auto-Encoding Variational Bayes"}, {"paperId": null, "title": "World's first on-device demonstration of stable diffusion on an android phone"}, {"paperId": null, "title": "Stable diffusion with core ml on apple silicon, 2022"}, {"paperId": null, "title": "Github: Compvis/stable-diffusion, 2022"}, {"paperId": null, "title": "Goodfellow , Jean Pouget - Abadie , Mehdi Mirza , Bing Xu , David Warde - Farley , Sherjil Ozair , Aaron Courville , and Yoshua Bengio"}]}