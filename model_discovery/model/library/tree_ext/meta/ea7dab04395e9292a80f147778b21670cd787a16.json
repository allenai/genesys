{"paperId": "ea7dab04395e9292a80f147778b21670cd787a16", "title": "Towards Transformer-based Automated ICD Coding: Challenges, Pitfalls and Solutions", "abstract": "Automated ICD coding, which aims to predict the International Classification of Disease (ICD) codes based on clinical discharge summaries, has received widespread concern from machine learning researchers due to its ability to save massive time and labour required by human coders. Unlike most NLP tasks, state-of-the-art ICD coding models were based on convolutional neural networks (CNN) or recurrent neural networks (RNN), while the popular transformer architecture did not perform well in ICD coding. In this paper, we investigate the challenges and pitfalls of transformer-based ICD coding by experimenting with different transformer architectures using an encoder-decoder architecture. We then present our solution to transformer-based ICD coding: our Longformer-based model significantly outperforms the CNN-based baseline models in five out of six metrics on the MIMIC-III full code dataset, and all evaluation metrics on the MIMIC-III top-50 code dataset. The source code for this project can be found at https://github.com/wren93/CSC2541-repo .", "venue": "", "year": 2021, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "The solution to transformer-based ICD coding is presented: the Longformer-based model significantly outperforms the CNN-based baseline models in five out of six metrics on the MIMIC-III full code dataset, and all evaluation metrics on a top-50 code dataset."}, "embedding": {"model": "specter_v2", "vector": [0.2048686444759369, 1.168446660041809, -0.6125299334526062, 0.3371437191963196, -0.4710819721221924, -0.3691198527812958, 0.32709407806396484, 0.4039500653743744, 0.11126882582902908, -0.24107594788074493, 0.854645311832428, -0.7747243642807007, 0.10786603391170502, 0.32615718245506287, 0.3141306936740875, 0.19097667932510376, -0.13489137589931488, 0.17453737556934357, -0.43879279494285583, 0.41006603837013245, -0.2707817256450653, -0.463603138923645, -0.2172774076461792, 0.5189276337623596, 0.769986093044281, 0.8625880479812622, -0.19977618753910065, 0.46339115500450134, -0.25737690925598145, 1.1208524703979492, 0.7350215315818787, -0.9895521998405457, 0.3789808750152588, -0.48411014676094055, -0.4662710726261139, 0.06021970883011818, -0.12226545065641403, -0.5869215130805969, -0.6055096983909607, 0.6796748042106628, -0.5005539059638977, -0.4313902258872986, 0.6737342476844788, -0.7624210119247437, -0.7534204721450806, 0.8117631673812866, 1.053823709487915, 0.41250669956207275, -0.12015225738286972, -0.6247848868370056, 0.9924641847610474, -0.7623160481452942, 0.35647404193878174, 1.0299584865570068, 1.130950689315796, 0.29540324211120605, 0.08232318609952927, -0.6848191618919373, -0.2378249615430832, -0.1723373830318451, -0.8460503816604614, -0.05651567503809929, -0.08557616919279099, -0.8011875748634338, 1.4545248746871948, -0.7100822925567627, 0.2039024382829666, 0.25235167145729065, 0.08372322469949722, 0.7820325493812561, 0.016064554452896118, -0.43694427609443665, -0.3708973228931427, 0.35460710525512695, -0.2060154229402542, 0.9861467480659485, -0.18342803418636322, 0.1651795506477356, -0.37128329277038574, -0.7281466722488403, 0.28067728877067566, 0.4580739140510559, -0.022065432742238045, -0.37900620698928833, -0.121514692902565, 0.48324063420295715, 0.3213807940483093, 0.6322413086891174, -0.23974977433681488, 0.16133323311805725, 0.8642664551734924, 0.032186634838581085, -0.15797458589076996, 0.4796616733074188, -0.14423635601997375, 0.12192078679800034, -0.871364414691925, -0.003012078581377864, -0.21478772163391113, 0.8002632856369019, -0.616603672504425, -0.11944107711315155, -0.7479130625724792, 0.25870028138160706, 1.0289833545684814, -0.3086980879306793, 0.6960779428482056, -0.6364307403564453, 0.08818299323320389, -0.22053740918636322, 0.041877299547195435, -0.7264460325241089, -0.2348187118768692, -0.10274139046669006, -1.1719111204147339, -1.3866868019104004, -0.7910451889038086, 0.07677142322063446, -0.9471794366836548, 0.2031572312116623, -1.2181005477905273, -0.05886213108897209, 0.3908584415912628, -0.13083241879940033, 0.6527515053749084, -0.03663802146911621, 0.2205231636762619, -0.1313997060060501, 0.9633079767227173, -0.42267104983329773, -0.7075770497322083, -0.3453880250453949, 1.0930193662643433, -0.2981254756450653, -0.3755871057510376, -0.3767021596431732, -0.9770853519439697, -0.5771487355232239, -0.47866058349609375, -0.09159523993730545, -0.1568557769060135, 0.3164139986038208, 0.6696625351905823, 0.29065757989883423, -1.1833394765853882, 0.6635453104972839, -0.24796201288700104, -0.5149416923522949, 0.8467421531677246, -0.3516422510147095, 0.2029273808002472, -0.2554229199886322, -0.971024215221405, 0.4787411391735077, 0.11912956833839417, -1.017560601234436, -0.3779343068599701, -0.6000396013259888, -1.1674913167953491, 0.1590222865343094, -0.1473243087530136, -0.41470247507095337, 1.3061195611953735, 0.20756904780864716, -0.41263139247894287, 0.9591314196586609, -0.1744088977575302, -0.10933686047792435, 0.3293669819831848, 0.430572509765625, -0.5725754499435425, 0.015614002011716366, 0.3363773226737976, 0.2834048271179199, 0.09836612641811371, -0.011110699735581875, -0.23866088688373566, 0.771305501461029, -0.33424443006515503, -0.3606554865837097, -0.37962111830711365, 0.9684274792671204, 0.02981646917760372, -0.46013984084129333, 0.10321982949972153, 0.48311835527420044, -0.16441477835178375, 0.3131130337715149, -0.5955542922019958, -0.785908043384552, 0.44223469495773315, -0.10686710476875305, 1.199709177017212, -1.1031302213668823, -1.1899442672729492, -0.29779908061027527, 0.19549556076526642, 0.07544724643230438, 0.127818301320076, 0.4589841365814209, -0.8254752159118652, 0.6198621988296509, -0.3317553400993347, -0.8332076072692871, -0.17498843371868134, -0.09669435769319534, -0.7324762940406799, -0.37915462255477905, -0.01729431375861168, 0.9126238226890564, -0.702286422252655, 0.07272446155548096, -0.10846541076898575, 0.026764342561364174, -0.9479589462280273, 1.1597753763198853, 0.4075350761413574, -0.1123228371143341, 0.19745616614818573, 0.3230273127555847, 0.2122379094362259, -0.5792365670204163, 0.5103746056556702, -0.49380627274513245, 0.13498058915138245, 0.7257658839225769, 0.13965515792369843, 1.3454110622406006, 0.00849414523690939, 0.2464291751384735, -0.25221148133277893, -1.068992257118225, 0.10962136089801788, 1.1698087453842163, 0.21095025539398193, -0.1450527012348175, 0.3603905141353607, 0.4639492332935333, -0.4758308231830597, 0.1339699625968933, 0.17807361483573914, 0.21326062083244324, -0.3768184781074524, 0.22175996005535126, 0.580223798751831, 0.1842302531003952, 0.06090521812438965, 0.6088970303535461, 1.157707929611206, -0.31579193472862244, 0.8967836499214172, -0.021875428035855293, 0.1693422943353653, -0.5171486735343933, 0.4934312105178833, 0.5281828045845032, 0.24159207940101624, 1.3304227590560913, 1.0124284029006958, -0.7749238610267639, -0.2746672034263611, -0.17978787422180176, 0.17719994485378265, 0.23200829327106476, -0.4532248377799988, -0.5052613615989685, -0.3643634617328644, -0.7075573801994324, -0.3686275780200958, 0.0015747087309136987, -0.5037885308265686, -0.8391479849815369, 0.32168468832969666, -1.0477863550186157, 1.6088807582855225, 0.29340070486068726, 0.6603761911392212, -0.4996126592159271, -0.34255123138427734, -0.21260498464107513, -0.1963430643081665, -0.8945654034614563, -0.3661111891269684, 0.7412926554679871, -0.4701616168022156, -0.6360227465629578, -0.16608087718486786, -0.21476680040359497, 0.37117740511894226, -1.0633506774902344, 0.7237344980239868, -0.5466139912605286, -0.6023090481758118, 0.40758299827575684, 0.3225848376750946, -0.6392136812210083, -1.3743456602096558, -0.24166171252727509, -0.12889301776885986, -0.33060553669929504, 0.7398287057876587, 0.5343950986862183, -0.06024307385087013, -0.34802016615867615, -0.4673430621623993, -0.05048777908086777, 0.25846096873283386, 0.4744797945022583, 0.4184845983982086, -0.08447091281414032, -0.014440877363085747, -0.8552986979484558, 1.0165108442306519, -0.0033591962419450283, 0.04209483414888382, 0.37859824299812317, -1.0043061971664429, -0.3831968903541565, 0.7598370909690857, 0.11582465469837189, -0.1503044217824936, -0.9683264493942261, 0.035337720066308975, -0.31933706998825073, -0.44449013471603394, 0.3788362443447113, 0.5791036486625671, 0.5784775018692017, 0.1556449681520462, 0.6014273166656494, 0.294291615486145, -0.23293805122375488, -0.08190922439098358, 0.010585767216980457, 0.5583533644676208, 0.6753904819488525, -0.14790038764476776, -0.1927766501903534, -0.2675585448741913, 0.15462493896484375, -0.5690802335739136, -0.3208729922771454, -0.28919634222984314, 0.26439401507377625, 0.2540454566478729, -1.0506442785263062, -0.2634653151035309, -0.31418174505233765, -1.3362659215927124, 0.2149597555398941, -0.1827048808336258, -0.24781671166419983, -0.14594773948192596, -1.0755689144134521, -1.4473567008972168, -0.10334531962871552, -0.6625880002975464, -1.115539312362671, 0.17285101115703583, -0.4081917107105255, -0.5887212157249451, -0.3457440733909607, -0.09067291766405106, -0.41926324367523193, 0.2644139230251312, -0.23820997774600983, 1.329885721206665, -0.27726808190345764, 0.5060952305793762, -0.09847613424062729, -0.21360506117343903, 0.7500059604644775, 0.549835205078125, 0.2925901710987091, -0.3634033799171448, 0.737582802772522, 0.009623642079532146, -0.017927823588252068, -0.004099288955330849, 0.20350342988967896, 0.9292162656784058, 0.22642920911312103, -0.6350187063217163, 0.5397512316703796, 1.2069355249404907, -0.080630362033844, 0.24452510476112366, -0.06097283214330673, 1.0148847103118896, -0.20018801093101501, -0.2237836867570877, 0.8688333034515381, 0.3087729513645172, 0.20665980875492096, 0.27479687333106995, -0.43213170766830444, -0.11992000043392181, -0.654226541519165, -0.027643797919154167, 1.0431779623031616, 0.4012961983680725, 0.1667260080575943, -1.5550479888916016, 0.9866547584533691, -0.98183274269104, -0.5934061408042908, 0.5014114379882812, 0.310958594083786, 0.6553357243537903, -0.42963871359825134, -0.5551004409790039, 0.23728647828102112, 0.2990061342716217, -0.3685286343097687, 0.05104320868849754, -1.086000680923462, 0.4380684196949005, 0.47581538558006287, 0.25343847274780273, -0.1521858423948288, -0.4493415951728821, -0.13702860474586487, 14.977784156799316, 0.3430383801460266, -0.005819758865982294, 0.8219756484031677, 0.5001940727233887, 0.5025404095649719, -0.16656100749969482, -0.13413812220096588, -0.843726634979248, 0.22562232613563538, 1.1359500885009766, -0.1490766406059265, 0.041477806866168976, 0.42339417338371277, -0.33824241161346436, 0.4992368221282959, -0.5559360980987549, 1.0366814136505127, 0.6271933913230896, -1.6073259115219116, 0.6254181861877441, 0.6385852694511414, 0.451656699180603, 0.4330191910266876, 0.7460340261459351, 0.3759458065032959, 0.22083407640457153, -0.741544783115387, 0.25740596652030945, -0.16515031456947327, 1.2066303491592407, -0.3769100606441498, 1.1291545629501343, 0.2256801426410675, -0.7938243746757507, -0.7439792156219482, -0.718134880065918, -0.9708755016326904, 0.13118459284305573, 0.46425390243530273, -1.0228180885314941, -0.2675977051258087, -0.22553639113903046, 1.2224023342132568, 0.06090432405471802, 0.5297077298164368, -0.16548405587673187, 0.21300730109214783, 0.37993213534355164, 0.8702631592750549, 0.18207567930221558, 0.8231989741325378, 0.06698742508888245, 0.1653953194618225, 0.6358059644699097, -0.007131969090551138, 0.032300081104040146, 0.3003626763820648, -0.7067342400550842, -0.2453608512878418, -0.9414871335029602, -0.27548813819885254, -0.3867720067501068, 0.5204747915267944, 0.23202729225158691, 0.0008182964520528913, -0.705162763595581, 0.402780681848526, 0.3135737478733063, -0.21176935732364655, -0.36897069215774536, -0.23892825841903687, 0.6612216830253601, 0.1479531228542328, 0.0006773440400138497, 1.069657564163208, -0.39969882369041443, -0.756066620349884, -0.6534830927848816, -0.22006478905677795, 0.6891490817070007, -0.6795309782028198, -0.5966918468475342, 1.1332595348358154, -0.5837501883506775, -1.301115870475769, 0.20106571912765503, -0.5722089409828186, 0.19241417944431305, -0.004872160032391548, -1.123121738433838, -0.5053982734680176, 0.007719316054135561, 0.04851667955517769, -0.814918041229248, -0.27673470973968506, 1.6593321561813354, 0.37409156560897827, -0.014821100980043411, 0.22160214185714722, -0.01935742422938347, 0.6217337250709534, 0.07602740824222565, -0.785451352596283, 0.3116209805011749, 0.31621071696281433, -0.2746916711330414, 0.25527340173721313, -0.3522821068763733, 0.24433517456054688, 0.07867749035358429, -0.710952877998352, 0.87712162733078, -1.0716755390167236, -0.3019765317440033, -0.6969851851463318, -0.5156224966049194, 0.3366573452949524, 0.6274456977844238, 0.04158766567707062, 0.853988528251648, -0.1287800371646881, -0.5954403281211853, -0.05818790942430496, -1.1551471948623657, -0.22655431926250458, 0.5465055108070374, -1.2638882398605347, -0.7287324070930481, 0.1062600314617157, 0.14959050714969635, -0.5764501690864563, -0.7702983021736145, 0.12545807659626007, -0.026573508977890015, -0.3581548035144806, 0.5048257112503052, -0.07803952693939209, 1.128373622894287, 0.8797917366027832, 0.30757129192352295, -1.0243245363235474, -0.27770891785621643, -0.6613516807556152, 0.24980586767196655, 0.1328749656677246, 0.43186795711517334, -0.41163113713264465, -0.15092720091342926, 1.1744285821914673, -0.21776166558265686, -0.4001357853412628, -0.5569444298744202, 0.09357419610023499, 0.020515866577625275, -0.23643691837787628, 0.24221600592136383, 0.1756005585193634, 0.7359400987625122, -0.4327514171600342, 0.3818323314189911, 0.39315155148506165, -0.457111120223999, -0.6407213807106018, -0.3505879044532776, -0.4498618543148041, 0.1706097424030304, -0.39741089940071106, -0.8647763133049011, -0.9075944423675537, -0.01319233886897564, -1.2800172567367554, 0.009726962074637413, -0.9105595946311951, 0.031219858676195145, 0.1970643848180771, -0.5910065174102783, 0.408760666847229, 0.4921812415122986, -0.1310696303844452, -0.6854502558708191, -0.42115917801856995, -0.5754749774932861, 0.34427836537361145, 0.5814498066902161, -0.5896307229995728, 0.28376904129981995, -0.4871867895126343, -0.7384640574455261, 0.5204848051071167, 0.20557641983032227, -1.0373938083648682, -0.9630017876625061, -0.9148865342140198, 0.14612503349781036, -0.15941116213798523, 0.17231161892414093, -0.7178532481193542, 0.4651118516921997, 0.5979862809181213, -0.3277339041233063, -0.01991085894405842, -0.2460874766111374, -1.1166538000106812, -0.2865006923675537, 0.7314794063568115, -0.8600010871887207, 0.1835632026195526, 0.11752878874540329, -0.7412401437759399, -0.7459042072296143, 0.46826064586639404, -0.04205234348773956, -1.099129557609558, -0.05712398514151573, 0.540224552154541, -1.0583322048187256, 0.1382424682378769, 0.005087348632514477, 0.06982559710741043, -0.6200791001319885, -0.07470536977052689, -0.13829459249973297, -0.005554277915507555, -0.1616949886083603, 0.7815192341804504, 0.28806963562965393, -1.0576093196868896, 0.26530638337135315, 0.5279616117477417, 0.17494505643844604, -0.3937404751777649, 0.20007148385047913, 0.47842901945114136, -0.6703680753707886, 0.8962568640708923, 0.16662169992923737, 0.3670929968357086, -0.939338743686676, 0.2114434540271759, 0.7632176280021667, -0.49557194113731384, -0.5500968098640442, 0.812674880027771, -0.12263749539852142, -0.9887384176254272, 0.18922428786754608, -1.6243494749069214, -0.6203081607818604, -0.37506505846977234, 0.6169252991676331, -0.2445010542869568, 0.2570718824863434, 0.013133931905031204, -0.7656686902046204, -0.24914564192295074, -0.09154041111469269, 0.0035086008720099926, 0.3752727508544922, -0.029608527198433876, -0.6153251528739929, 0.05223589017987251, 0.8199478387832642, -1.045379877090454, -0.00542149692773819, -0.16370993852615356, -0.3828344941139221, 0.08706430345773697, -0.06636357307434082, -0.3209514617919922, -0.7294110655784607, 0.7092421650886536, 0.5679059028625488, 0.4299982488155365, 0.659324586391449, -0.03378641977906227, 0.13429519534111023, 0.5187525153160095, 0.14657321572303772, -0.42670321464538574, -0.7791616320610046, 0.8766485452651978, 0.8047911524772644, -0.8931763768196106, 0.23887260258197784, -0.18074405193328857, -0.7386825084686279, 0.9553776979446411, -0.1632898896932602, 0.204345241189003, 1.3182390928268433, 0.10563235729932785, 0.17276929318904877, -0.082741878926754, -0.9704172015190125, 0.11108042299747467, 0.4616912603378296, 1.2425144910812378, 1.0017176866531372, 0.3236503601074219, 0.05846428871154785, 1.2976233959197998, 0.043837498873472214, 0.7177287936210632, 0.9826228618621826, 0.26536592841148376, 0.6654022336006165, -0.31691333651542664, 0.29950904846191406, 1.1713969707489014, -1.0611897706985474, -0.7443636655807495, 0.002275619190186262, 0.09477102011442184, 0.9088307619094849, 0.7328434586524963, 0.7910186052322388, -0.060078416019678116, 0.5179959535598755, 0.48271483182907104, -0.10723497718572617, -0.8787921667098999, -0.4456925392150879, -0.28728851675987244, -0.4303094744682312, 0.07629308849573135, -0.3672352433204651, -0.6588931679725647, -0.5530418157577515, 0.3039722442626953, 0.6812170743942261, 0.21923497319221497, -0.1091548427939415, 0.991027295589447, 1.008800983428955, 0.6426546573638916, -0.4958932399749756, 0.566702663898468, -0.07785850018262863, -0.6581596732139587, -0.3161839544773102, -0.21923965215682983, 0.17644505202770233, -0.05001650005578995, -0.2948424816131592, 0.1370689421892166]}, "authors": [{"authorId": "2180395463", "name": "Weiming Ren"}, {"authorId": "2285173402", "name": "Tianshu Zhu"}, {"authorId": "2180395952", "name": "Ruijing Zeng"}, {"authorId": "2285091337", "name": "Tongzi Wu"}], "references": [{"paperId": "d8d2e574965fe733eb1416e03df2b5c2914fc530", "title": "A Survey of Transformers"}, {"paperId": "d4d37ad448e845552583658cc2c3928c82b7045b", "title": "Towards BERT-based Automatic ICD Coding: Limitations and Opportunities"}, {"paperId": "2a37db4e6c4f2313bd5d765fca41a0d8b3663f4a", "title": "TransICD: Transformer Based Code-wise Attention Model for Explainable ICD Coding"}, {"paperId": "044e13d7dd4e0655eb76f0bd00b2c1bdb44e2be3", "title": "Big Bird: Transformers for Longer Sequences"}, {"paperId": "d27669c82faf78ea08cceaa0a171b540cccc304d", "title": "ETC: Encoding Long and Structured Inputs in Transformers"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "42f0bae2dacba44e9b5d8f050da3cbe41b9fc437", "title": "Clinical XLNet: Modeling Sequential Clinical Notes and Predicting Prolonged Mechanical Ventilation"}, {"paperId": "aa201de20f71c8777144aaf7f1d5d30ca7b7cce8", "title": "ICD Coding from Clinical Text Using Multi-Filter Residual Convolutional Neural Network"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "b3c2c9f53ab130f3eb76eaaab3afa481c5a405eb", "title": "ClinicalBERT: Modeling Clinical Notes and Predicting Hospital Readmission"}, {"paperId": "2a31319e73d4486716168b65cdf7559baeda18ce", "title": "Star-Transformer"}, {"paperId": "1e43c7084bdcb6b3102afaf301cce10faead2702", "title": "BioBERT: a pre-trained biomedical language representation model for biomedical text mining"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "5b721c8767f895f03e1316c5e7ce6d93f19e2937", "title": "Explainable Prediction of Medical Codes from Clinical Text"}, {"paperId": "5b5f0e19131877a2c085ed8eacfd287adecc5c17", "title": "Multi-Label Classification of Patient Notes a Case Study on ICD Code Assignment"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "4c16a6fd7b4aad8c1331e4753b30701fdf6d12f4", "title": "Neural Domain Adaptation for Biomedical Question Answering"}, {"paperId": "95cd83603a0d2b6918a8e34a5637a8f382da96f5", "title": "MIMIC-III, a freely accessible critical care database"}, {"paperId": "0e6824e137847be0599bb0032e37042ed2ef5045", "title": "Aligning Books and Movies: Towards Story-Like Visual Explanations by Watching Movies and Reading Books"}, {"paperId": "c15488f2732c7f13dc5e2b33048d25974efc642e", "title": "Diagnosis code assignment: models and evaluation metrics"}, {"paperId": "87f40e6f3022adbc1f1905e3e506abad05a9964f", "title": "Distributed Representations of Words and Phrases and their Compositionality"}, {"paperId": "70dad986b772b92b19b8cd5e4043f1fa23e69348", "title": "Combining classifiers in text categorization"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "\u201cTowards automated icd coding using deep learning,\u201d"}, {"paperId": "1c46943103bd7b7a2c7be86859995a4144d1938b", "title": "Visualizing Data using t-SNE"}, {"paperId": null, "title": "Multi-label text classification with a mixture model trained by EM"}]}