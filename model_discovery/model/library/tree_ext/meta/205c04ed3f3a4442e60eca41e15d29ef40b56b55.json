{"paperId": "205c04ed3f3a4442e60eca41e15d29ef40b56b55", "title": "Grokfast: Accelerated Grokking by Amplifying Slow Gradients", "abstract": "One puzzling artifact in machine learning dubbed grokking is where delayed generalization is achieved tenfolds of iterations after near perfect overfitting to the training data. Focusing on the long delay itself on behalf of machine learning practitioners, our goal is to accelerate generalization of a model under grokking phenomenon. By regarding a series of gradients of a parameter over training iterations as a random signal over time, we can spectrally decompose the parameter trajectories under gradient descent into two components: the fast-varying, overfitting-yielding component and the slow-varying, generalization-inducing component. This analysis allows us to accelerate the grokking phenomenon more than $\\times 50$ with only a few lines of code that amplifies the slow-varying components of gradients. The experiments show that our algorithm applies to diverse tasks involving images, languages, and graphs, enabling practical availability of this peculiar artifact of sudden generalization. Our code is available at https://github.com/ironjr/grokfast.", "venue": "arXiv.org", "year": 2024, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work spectrally decomposes the parameter trajectories under gradient descent into two components: the fast-varying, overfitting-yielding component and the slow-varying, generalization-inducing component by regarding a series of gradients of a parameter over training iterations as a random signal over time."}, "embedding": {"model": "specter_v2", "vector": [0.10233987867832184, 0.4890938401222229, -0.5005215406417847, 0.08730929344892502, 0.20781302452087402, -0.10513447225093842, 0.4042518734931946, -0.5524192452430725, -0.1497368961572647, -0.4474516808986664, -0.37867531180381775, 0.17217420041561127, 0.3315248489379883, 0.28029298782348633, -0.26716890931129456, -0.39612841606140137, -1.5850921869277954, -0.34560295939445496, -0.1470155417919159, -0.16015727818012238, -0.34011515974998474, -0.5147765874862671, -0.9119617938995361, 0.1059851348400116, 0.5295732021331787, 0.648119330406189, -0.34604236483573914, 1.389799952507019, -0.14805704355239868, 0.31537824869155884, 0.5319510102272034, -0.3625001609325409, 0.683325469493866, -0.03230159729719162, -0.3409120738506317, 0.22205421328544617, 0.586688756942749, -0.3238958716392517, -0.4315730631351471, 0.7645948529243469, -0.5376905798912048, 0.44621095061302185, 0.1822298765182495, -0.9800335168838501, -0.29307180643081665, 0.38933661580085754, 0.2513028383255005, 0.9468436241149902, -0.2089831531047821, -0.46758532524108887, 0.9629790782928467, -1.3318679332733154, 0.39224228262901306, 1.18536376953125, 0.887776792049408, 0.614715039730072, -0.18647463619709015, -0.40833625197410583, 1.0974029302597046, -0.0009411164210177958, -1.0385187864303589, 0.17326436936855316, 0.07532016187906265, -0.4392295181751251, 1.0666552782058716, -0.8458709716796875, -0.2084837406873703, 0.7745256423950195, 0.10862517356872559, 1.283901333808899, 0.3502639830112457, -0.5223076939582825, -0.05374342203140259, 0.5208026766777039, 0.35610318183898926, 1.1209100484848022, -0.363212913274765, 0.6488872170448303, -1.139567255973816, -0.24956877529621124, 0.32096970081329346, -0.08522838354110718, -0.24595360457897186, -0.3490917384624481, 0.47028204798698425, 0.8496553301811218, 0.7352494597434998, 0.3553910255432129, -0.3086387515068054, 1.370521068572998, 0.2730175852775574, 0.5986266136169434, 0.7005518078804016, -0.09419773519039154, -0.17232045531272888, 0.3503301441669464, -0.504988968372345, 0.2793169915676117, -0.13247276842594147, 0.8043169975280762, 0.42567116022109985, 0.00023916039208415896, 0.025388607755303383, 0.09280027449131012, 1.1600013971328735, -0.7202739715576172, 0.6413034796714783, -0.35999882221221924, 0.327923446893692, -0.5751829743385315, 0.29722821712493896, -0.9455558061599731, -0.6202429533004761, -0.7093315720558167, -0.8284250497817993, -0.9864782094955444, -0.1838153451681137, -0.08864778280258179, -0.9029679894447327, 0.9077319502830505, 0.047606050968170166, 0.02551022358238697, -0.28353679180145264, 0.9003450274467468, -0.027990121394395828, 0.6558111906051636, 0.6277859807014465, -0.019259093329310417, 0.3427473306655884, -0.8104243278503418, -0.22833193838596344, -0.6893354058265686, 0.8254978060722351, 0.14868582785129547, 0.5319952964782715, -0.03130306676030159, -1.0551327466964722, -1.2226020097732544, -1.271383285522461, 0.6661977171897888, -0.4781211316585541, 0.09979615360498428, 1.5327348709106445, 0.7078605890274048, -0.9449724555015564, 1.3325380086898804, -0.4177752733230591, -0.5006827712059021, 0.4963502287864685, 0.21830587089061737, 0.3670073449611664, -0.4226684868335724, -0.7181050777435303, -0.04555165767669678, 0.67337566614151, -0.43342670798301697, -0.039844710379838943, -0.908818781375885, -0.6159245371818542, -0.24661323428153992, 0.4280112385749817, -0.9642435312271118, 1.0832717418670654, -0.39218854904174805, -1.118155598640442, 0.6768128871917725, 0.33158448338508606, 0.14704719185829163, 1.0234711170196533, -0.3937164843082428, -0.7761513590812683, -0.1305527538061142, -0.637955904006958, 0.374508261680603, 0.7404495477676392, -0.46638888120651245, 0.18522614240646362, -0.18305610120296478, -0.5798588991165161, -0.5319938659667969, -0.09502995759248734, 0.10256131738424301, 0.05959866940975189, -0.3676648736000061, 0.481868177652359, 0.2985253930091858, -0.18101903796195984, -0.14250966906547546, -0.00910832267254591, -1.1886765956878662, 0.8287477493286133, -0.09447386115789413, 1.1197233200073242, -0.9766063690185547, -0.669293999671936, 0.26114925742149353, 0.1878286600112915, -0.508247435092926, -0.5271159410476685, 0.7120525240898132, -0.45547589659690857, 0.8213012218475342, -0.13367147743701935, -0.6952710151672363, 0.015220836736261845, -0.15890204906463623, -0.4609294533729553, 0.098381906747818, 0.3625686764717102, 1.0120339393615723, -1.2660505771636963, 0.6436994671821594, -0.46610182523727417, 0.051223643124103546, -1.0454657077789307, 0.837289035320282, -0.24569390714168549, 0.09835027903318405, 0.1056981086730957, 0.09421522915363312, 0.4745712876319885, -0.5339364409446716, 0.1593022495508194, -0.1963445544242859, 0.40928974747657776, -0.24017277359962463, -0.7019643187522888, 1.5242969989776611, -0.15766623616218567, 0.25137633085250854, -0.475272536277771, -0.63039231300354, 0.045866481959819794, 0.17586790025234222, 0.11022670567035675, -0.10427577793598175, 0.1391972303390503, 0.3476629853248596, -0.8293147087097168, 0.19239172339439392, 0.6597096920013428, 0.8931163549423218, -0.19403789937496185, -0.02460366301238537, 0.924426794052124, -0.33069339394569397, 0.08702493458986282, 0.40687814354896545, 0.286504864692688, 0.6875584721565247, 0.2527681291103363, -0.26415154337882996, 0.0011655533453449607, -1.0020931959152222, -0.184236079454422, 0.5886175632476807, 0.5203286409378052, 0.3219837248325348, 0.00028740311972796917, -1.1565169095993042, -0.3834891617298126, -0.3122312128543854, 0.5143531560897827, 1.5082340240478516, -0.09066295623779297, -0.46152541041374207, -0.5654277205467224, -0.47453710436820984, 0.08166913688182831, -0.23476500809192657, -0.7900062799453735, -0.5900408029556274, -0.17470701038837433, -1.5826356410980225, 0.4888790547847748, 0.07775145769119263, 1.3658313751220703, 0.016260290518403053, -0.07040006667375565, 0.0057780263014137745, 0.6473156213760376, -0.5058216452598572, -0.5942756533622742, 0.1300441324710846, -0.708306074142456, 0.05120694264769554, -0.18768547475337982, 0.044296473264694214, 0.28191637992858887, -0.6102002263069153, 0.8518500924110413, -0.047658827155828476, -0.5091297030448914, 0.4843108057975769, 0.5385802984237671, -0.7051749229431152, -0.6805885434150696, 0.21933478116989136, 0.24147239327430725, 0.0853746309876442, 0.022183118388056755, 0.3265884816646576, -0.25101593136787415, 0.23315997421741486, -0.5754441022872925, -0.10802889615297318, -0.3435133099555969, 0.10304657369852066, 0.057255253195762634, -0.10826840996742249, 0.5367570519447327, -1.0222499370574951, 1.1306102275848389, -0.3712170124053955, -0.471488893032074, -0.020316947251558304, -1.2272114753723145, -0.2267012894153595, 0.4376622438430786, -1.369227647781372, 0.0783592015504837, -1.146738886833191, 0.7675569653511047, -0.015077861957252026, 0.16040901839733124, 0.029044950380921364, 0.8988874554634094, -0.47257405519485474, 0.850395917892456, -0.032634928822517395, 0.08401317894458771, 0.020377809181809425, 0.5929633378982544, -1.076332688331604, 0.5939713716506958, -0.05172615125775337, 0.44884854555130005, -0.2448584884405136, 0.041149675846099854, -0.5807806849479675, -0.5025449991226196, -0.4354250431060791, -0.25406718254089355, -0.6416889429092407, -0.3209696412086487, -0.35757875442504883, -0.9480898380279541, 0.22430360317230225, -0.3147737383842468, -0.6021273732185364, 0.09853016585111618, -0.2293483465909958, -0.5590161085128784, -1.0152552127838135, -1.2173833847045898, -0.375990629196167, -0.21637555956840515, -0.5237438678741455, -0.08083559572696686, 0.4375700354576111, -0.3571488559246063, -0.6447553634643555, 0.029982298612594604, -0.6299943327903748, 0.9900099039077759, -0.3901423513889313, 0.7531161904335022, 0.5436903834342957, -0.4686969816684723, -0.07158033549785614, 0.14905279874801636, 0.5968739986419678, -0.3345339298248291, 0.2766699194908142, -1.0425266027450562, -0.12258219718933105, -0.6470590829849243, -0.35451677441596985, 0.010937071405351162, 0.1398530900478363, 0.6492868661880493, -0.34692949056625366, -0.371061235666275, 0.7475497126579285, 1.5157305002212524, -0.7582079172134399, 0.040489546954631805, 0.31336066126823425, 0.7635164260864258, 0.3440525233745575, -0.2747630476951599, 0.7917417883872986, 0.11965668946504593, 0.045094363391399384, 0.1374826580286026, -0.21335409581661224, -0.1238090768456459, -0.866085410118103, 0.4736977815628052, 1.34467613697052, 0.17192497849464417, 0.19525453448295593, -0.8729572296142578, 0.37825071811676025, -1.1474406719207764, -0.4514006972312927, 0.8872424960136414, 0.8617862462997437, 0.1969418227672577, -0.5618752837181091, 0.06858714669942856, -0.40335309505462646, 0.0049898200668394566, 0.24903061985969543, -0.6100636124610901, -0.6892424821853638, 0.13835906982421875, 0.06671464443206787, 0.36678802967071533, 0.6712111830711365, -0.013757848180830479, 0.8476916551589966, 15.211090087890625, 0.5964459776878357, -0.09543360024690628, 0.31609925627708435, 0.49689435958862305, 0.5388428568840027, -0.3959561586380005, -0.317279577255249, -0.7578837275505066, 0.029044535011053085, 0.9259648323059082, 0.03325381129980087, 0.899426281452179, 0.3865150511264801, -0.1113138347864151, 0.1137857735157013, -0.08481736481189728, 0.8169874548912048, 0.18963976204395294, -0.9916165471076965, 0.25417429208755493, 0.07054664194583893, 0.8213251233100891, 0.49742597341537476, 0.8751055002212524, 0.8601197600364685, 0.4394628405570984, -0.2049143761396408, 0.33244985342025757, 0.3300633728504181, 0.6398248672485352, -0.18516670167446136, 0.19796164333820343, 0.47533634305000305, -0.7990731000900269, -0.22339209914207458, -0.6489095091819763, -0.9281709790229797, -0.08436907082796097, 0.185930073261261, -0.9680669903755188, -0.05795040726661682, 0.2681688964366913, 0.8315984606742859, -0.23844167590141296, 0.16072577238082886, 0.08991430699825287, 0.6555039286613464, -0.05742308124899864, 0.12088916450738907, 0.2273847758769989, 0.11888524144887924, 0.297690749168396, -0.18873284757137299, 0.023742076009511948, -0.2950577735900879, 0.3851153552532196, 0.5354520678520203, -0.6960363388061523, 0.213023841381073, -0.17937777936458588, -0.4404989778995514, -0.3931252956390381, 0.7823244333267212, 0.42459386587142944, 0.013393295928835869, -0.006592093501240015, 0.7322660088539124, 0.6624085903167725, 0.7379921078681946, -0.21230320632457733, 0.11783244460821152, 0.2936815321445465, -0.5134497880935669, -0.4984700679779053, -0.05048685893416405, -0.08515182137489319, -0.5582696199417114, -0.2287159115076065, -0.20281609892845154, 0.4113546907901764, -0.8736338019371033, -0.8259020447731018, 0.6308863162994385, -0.3570946753025055, -0.2748226225376129, 0.1703522801399231, -0.6272780299186707, 0.11973006278276443, 0.4988728165626526, -1.228180170059204, -0.5487123131752014, -0.2951356768608093, -0.09842829406261444, -0.21697884798049927, 0.2018313705921173, 1.0224686861038208, 0.14882348477840424, -0.43301013112068176, 0.2359188199043274, -0.3502126634120941, -0.6212971806526184, -0.1466761976480484, -1.047633171081543, 1.1098179817199707, 0.3546525239944458, -0.14754417538642883, 0.39375823736190796, 0.10041583329439163, 0.4616450071334839, -0.5734992623329163, 0.1834617406129837, -0.2228112667798996, -0.7641800045967102, -0.04981652647256851, -0.5271634459495544, -1.3416740894317627, 0.26696765422821045, -0.12304502725601196, 0.051928069442510605, 0.03802954778075218, 0.22709135711193085, -0.800094723701477, 0.03342905268073082, -0.77366042137146, 0.1083870530128479, 0.6820093393325806, -0.7050504684448242, 0.09976547956466675, 0.14654089510440826, 0.2989523112773895, -0.8178324103355408, -0.5644642114639282, 0.014469585381448269, 0.24460594356060028, -0.1717693954706192, 0.7702195048332214, -0.870286762714386, -0.007265245076268911, 0.646178662776947, -0.028986385092139244, -1.0216494798660278, -0.2458987683057785, -1.446863055229187, 0.11962535232305527, 0.08883970975875854, 0.5411260724067688, -0.5529305338859558, 0.4594234824180603, 0.6710457801818848, 0.30785125494003296, -0.34515902400016785, -0.2603459656238556, -0.3410486876964569, 0.14443789422512054, -0.7565374374389648, 0.041930168867111206, 0.15525615215301514, -0.19441746175289154, -0.3574165999889374, 0.1803899109363556, 0.9012318849563599, -0.1769985407590866, -1.187191367149353, 0.6187635064125061, -0.1380189061164856, -0.2032499760389328, -0.6355624198913574, -0.9036906957626343, -1.2050819396972656, -0.5513389110565186, -1.2072863578796387, -0.269998162984848, -0.30224233865737915, -0.8475796580314636, 0.0014510175678879023, -0.26327088475227356, -0.4479927122592926, -0.005339356139302254, -0.4761119484901428, -0.294018030166626, -0.28635063767433167, -0.011873234994709492, 0.5776170492172241, 0.8533381819725037, -0.42418479919433594, -0.47218695282936096, 0.19781368970870972, 0.1204979196190834, 0.3201814591884613, 0.6505839824676514, -0.35367292165756226, -0.6977885365486145, -0.6733434200286865, 0.7991516590118408, -0.611057460308075, 0.15781456232070923, -0.8680626749992371, 0.22486171126365662, 0.3246072828769684, 0.07795225828886032, 0.30502384901046753, 0.060049641877412796, -0.6780650019645691, -0.20222951471805573, 0.3076198399066925, -0.38852351903915405, 0.4246431887149811, 0.12434163689613342, -0.159245565533638, 0.15782363712787628, 0.8529872894287109, 0.2009354829788208, -0.7893084287643433, -1.2199596166610718, 0.6911963224411011, -0.32399725914001465, 0.07721035182476044, -0.06091366708278656, -0.18962381780147552, -1.1477808952331543, -0.035891011357307434, -0.5167620182037354, 0.2783554196357727, 0.04498275741934776, 1.0192970037460327, -0.12620756030082703, -1.1338517665863037, 0.2533975839614868, 0.35039085149765015, 0.26995864510536194, 0.0740845575928688, 0.9728890657424927, 0.16367076337337494, -0.22605745494365692, -0.24951957166194916, 0.356363445520401, -0.09395216405391693, -0.5837550163269043, 0.41748282313346863, 0.9083836078643799, -0.3106120228767395, -0.46693480014801025, 1.2593371868133545, -0.17379020154476166, -0.9142709970474243, 0.022928666323423386, -1.0267513990402222, 0.24677835404872894, -0.3232792019844055, 0.5752397775650024, 0.5948909521102905, -0.08993666619062424, 0.6614399552345276, -0.5329993367195129, 0.6726194024085999, -0.32640036940574646, -0.10000912100076675, 0.13533639907836914, -0.6598566770553589, 0.17659930884838104, 0.8960192203521729, 0.8869006037712097, -0.7245674729347229, -1.3216043710708618, -0.9573659896850586, -0.0055269948206841946, -0.2075701653957367, 0.22903688251972198, -0.448518306016922, -0.38216882944107056, 0.46252062916755676, 0.9801591634750366, 0.2913191020488739, 0.10236136615276337, -0.0459713377058506, -0.33027559518814087, 0.5881496667861938, 0.3303837478160858, -0.9775400757789612, -0.0073727797716856, 0.36905643343925476, 1.1134872436523438, -0.9267898797988892, 0.4473106265068054, -0.4061781167984009, -0.7362210154533386, 1.0538320541381836, 0.10420320183038712, -0.47791239619255066, 0.6967326402664185, -0.7640054225921631, 0.4814737141132355, -0.09491927921772003, -0.9015293717384338, -0.09109298139810562, 0.9608995318412781, 0.9199754595756531, 0.1489635407924652, 0.44860056042671204, 0.18130505084991455, 0.5123764276504517, -0.2282533198595047, 0.38327550888061523, 0.8044458031654358, 0.48810121417045593, -0.09452154487371445, 0.30440688133239746, 0.19373783469200134, 0.09735153615474701, -0.8307719826698303, 0.013145443052053452, 0.19646506011486053, 1.007246732711792, -0.04161829873919487, 0.4705621600151062, 0.41242867708206177, -0.20446956157684326, 0.2590264678001404, 0.4062347412109375, 0.742487370967865, -0.25515562295913696, -0.04648521915078163, -0.38916799426078796, -0.9373056888580322, -0.3303995132446289, -0.11748018115758896, -0.2657887935638428, -0.09892985224723816, -0.27059584856033325, 0.1622561365365982, -0.17011164128780365, 0.5558656454086304, 0.8154400587081909, 0.5121368765830994, 0.5080955028533936, 0.4771367907524109, -0.5172296762466431, -0.570274293422699, -0.7176932692527771, -0.20946231484413147, -0.23937039077281952, 0.02774761989712715, -0.285937637090683, -0.8423590064048767, -0.18408578634262085]}, "authors": [{"authorId": "71710083", "name": "Jaerin Lee"}, {"authorId": "2304371207", "name": "Bong Gyun Kang"}, {"authorId": "2279077397", "name": "Kihoon Kim"}, {"authorId": "2278783408", "name": "Kyoung Mu Lee"}], "references": [{"paperId": "7d417465bdf254f8b4491c0e4adbace8f49010ab", "title": "Unified View of Grokking, Double Descent and Emergent Abilities: A Perspective from Circuits Competition"}, {"paperId": "a82cb396035eab1746a125cb3fa10b720203513a", "title": "Training Dynamics of Deep Network Linear Regions"}, {"paperId": "fb6ecf67c275fe775a12ad4ddf2c8dc7cfad1348", "title": "Unifying Grokking and Double Descent"}, {"paperId": "f680d47a51a0e470fcb228bf0110c026535ead1b", "title": "Progress measures for grokking via mechanistic interpretability"}, {"paperId": "30f468c83afea5c3c94daa5ac285cdaa8019a573", "title": "Grokking modular arithmetic"}, {"paperId": "ad065eed8e1f727a8b0d8675802e4ffb1fcb87b4", "title": "Omnigrok: Grokking Beyond Algorithmic Data"}, {"paperId": "f5f5616f39493566a9d502f611adcc8f1ceb394e", "title": "Hidden Progress in Deep Learning: SGD Learns Parities Near the Computational Limit"}, {"paperId": "ff53cb49cb18e71e622fce7d96692e813630e878", "title": "The Slingshot Mechanism: An Empirical Study of Adaptive Optimizers and the Grokking Phenomenon"}, {"paperId": "20de79ec4fe682b68930eb4dcd91b1801b8d4731", "title": "Towards Understanding Grokking: An Effective Theory of Representation Learning"}, {"paperId": "a1d1983a7b19845141e6505bd32dc395e5a136ba", "title": "Grokking: Generalization Beyond Overfitting on Small Algorithmic Datasets"}, {"paperId": "52b2156c830b9dfbe92ced52f8ab3b1956927808", "title": "Multi-scale Feature Learning Dynamics: Insights for Double Descent"}, {"paperId": "ea415809bf87ef4b99966c6c50de6cb996a02a97", "title": "Deep double descent: where bigger models and more data hurt"}, {"paperId": "3c8a456509e6c0805354bd40a35e3f2dbf8069b1", "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library"}, {"paperId": "f86f1748d1b6d22870f4347fd5d65314ba800583", "title": "Reconciling modern machine-learning practice and the classical bias\u2013variance trade-off"}, {"paperId": "d07284a6811f1b2745d91bdb06b040b57f226882", "title": "Decoupled Weight Decay Regularization"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "97fb4e3d45bb098e27e0071448b6152217bd35a5", "title": "Layer Normalization"}, {"paperId": "de5e7320729f5d3cbb6709eb6329ec41ace8c95d", "title": "Gaussian Error Linear Units (GELUs)"}, {"paperId": "d44efdc542f2cc5e196f04bc76bc783bfd7084af", "title": "Incorporating Nesterov Momentum into Adam"}, {"paperId": "d6f2f611da110b5b5061731be3fc4c7f45d8ee23", "title": "Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification"}, {"paperId": "a058935fd019c2367fd32c16cd1ce6983a29aafb", "title": "Efficient mini-batch training for stochastic optimization"}, {"paperId": "89655dc3c3a794cb25e055aed79424c66301d70f", "title": "Quantum chemistry structures and properties of 134 kilo molecules"}, {"paperId": "4453295600cc89c33f643c8729972fa64aab0233", "title": "Enumeration of 166 Billion Organic Small Molecules in the Chemical Universe Database GDB-17"}, {"paperId": "46f74231b9afeb0c290d6d550043c55045284e5f", "title": "The MNIST Database of Handwritten Digit Images for Machine Learning Research [Best of the Web]"}, {"paperId": "1c61f9ef06fe74505775a833ff849185757199e7", "title": "Learning Word Vectors for Sentiment Analysis"}, {"paperId": "cfab5dd9fef8f7640a9290939a5cccdfc0f1bd12", "title": "Noise injection for training artificial neural networks: a comparison with weight decay and early stopping."}, {"paperId": "2e9d221c206e9503ceb452302d68d10e293f2a10", "title": "Long Short-Term Memory"}, {"paperId": "34f25a8704614163c4095b3ee2fc969b60de4698", "title": "Dropout: a simple way to prevent neural networks from overfitting"}]}