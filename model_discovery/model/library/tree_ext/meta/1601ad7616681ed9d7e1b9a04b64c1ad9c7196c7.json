{"paperId": "1601ad7616681ed9d7e1b9a04b64c1ad9c7196c7", "title": "Prefixing Attention Sinks can Mitigate Activation Outliers for Large Language Model Quantization", "abstract": "Despite recent advances in LLM quantization, activation quantization remains to be challenging due to the activation outliers. Conventional remedies, e.g., mixing precisions for different channels, introduce extra overhead and reduce the speedup. In this work, we develop a simple yet effective strategy to facilitate per-tensor activation quantization by preventing the generation of problematic tokens. Precisely, we propose a method to find a set of key-value cache, coined CushionCache, which mitigates outliers in subsequent tokens when inserted as a prefix. CushionCache works in two steps: First, we greedily search for a prompt token sequence that minimizes the maximum activation values in subsequent tokens. Then, we further tune the token cache to regularize the activations of subsequent tokens to be more quantization-friendly. The proposed method successfully addresses activation outliers of LLMs, providing a substantial performance boost for per-tensor activation quantization methods. We thoroughly evaluate our method over a wide range of models and benchmarks and find that it significantly surpasses the established baseline of per-tensor W8A8 quantization and can be seamlessly integrated with the recent activation quantization method.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A method to find a set of key-value cache, coined CushionCache, which mitigates outliers in subsequent tokens when inserted as a prefix is proposed, providing a substantial performance boost for per-tensor activation quantization methods."}, "embedding": {"model": "specter_v2", "vector": [0.1229027509689331, 0.6063567399978638, -0.7529525756835938, 0.26150786876678467, -0.4496035575866699, -0.0020870768930763006, 0.6384180188179016, 0.12274542450904846, -0.4925841987133026, -0.42809081077575684, 0.9158583283424377, 0.13727059960365295, 0.8096675872802734, 0.30333372950553894, -0.04333311319351196, -0.3291345536708832, -0.9498394131660461, 0.06221604719758034, -0.4385419487953186, -0.011687864549458027, 0.36921343207359314, -0.6737427115440369, -1.0891971588134766, 0.489494264125824, 0.2499460130929947, 0.9623615741729736, -0.4142378866672516, 0.6344508528709412, -0.9287476539611816, -0.04418952390551567, 0.17393286526203156, -0.04705999046564102, 0.4428480863571167, 0.4193226993083954, -0.32002323865890503, 0.22114364802837372, 0.24297623336315155, -0.35502302646636963, 0.028928808867931366, 1.046897053718567, -0.10138095170259476, 0.1300176978111267, 0.3420926034450531, -0.8346868753433228, -0.5607184171676636, 1.037684440612793, 0.28303682804107666, 0.5047193169593811, -0.4787357747554779, -0.45131784677505493, 1.4624353647232056, -1.8593178987503052, 0.07932671159505844, 1.363762378692627, -0.07341059297323227, 0.18768416345119476, -0.39000508189201355, -0.3633674085140228, 0.9427844285964966, 0.14579522609710693, -1.1678005456924438, -0.34065884351730347, -0.05386931821703911, -0.2781701982021332, 1.6469612121582031, -0.3799827992916107, 0.14153504371643066, 0.5486845374107361, -0.23008878529071808, 1.6514530181884766, -0.002649899572134018, -0.8880245685577393, 0.3017617464065552, -0.09761619567871094, 0.21869422495365143, 0.336290180683136, -0.35405319929122925, 0.2965039014816284, -1.1472527980804443, -0.3526265621185303, 0.5463370680809021, -0.22392414510250092, 0.4088398218154907, 0.19278563559055328, -0.4508914351463318, 0.5396728515625, 0.03655565530061722, 0.7115854620933533, -0.6082277894020081, 1.3075159788131714, 0.9607775211334229, -0.061154283583164215, 0.38183748722076416, 0.2911490201950073, -0.006365322042256594, -0.19397345185279846, -0.90024334192276, 0.4487701952457428, -0.33266711235046387, 0.5609720349311829, -0.21753881871700287, 0.5020641684532166, -1.2872599363327026, -0.12338483333587646, 1.2831242084503174, -0.09712832421064377, 0.5357084274291992, -0.9609293937683105, 0.11124858260154724, -0.6323927640914917, 0.3550538718700409, -0.42098376154899597, 0.2705768346786499, 0.018158327788114548, -0.7475325465202332, -1.318268895149231, -0.663102388381958, 0.12963062524795532, -0.7594959139823914, 0.6860119104385376, -0.22236065566539764, 0.20707590878009796, -0.14359958469867706, 0.7308189272880554, -0.0319860465824604, 0.807210385799408, 0.4817603528499603, -0.07524418085813522, 0.9067564010620117, -0.9383716583251953, -0.6901007890701294, -0.6136810183525085, 1.1924787759780884, -0.4515272080898285, 0.3409743905067444, 0.0993737205862999, -1.3657711744308472, -0.9573037028312683, -0.7878388166427612, 0.4058738052845001, -0.2513519525527954, 0.2764939069747925, 0.8989974856376648, 0.3871782124042511, -1.2710293531417847, 0.6062220931053162, -0.2692132592201233, 0.24826747179031372, 0.2621842622756958, 0.10737190395593643, 0.4416789710521698, -0.12153133749961853, -1.528090238571167, -0.04221365228295326, 0.19789603352546692, -0.3308912515640259, -0.028163498267531395, -0.5998175740242004, -0.9075605869293213, -0.058083560317754745, 0.2246231883764267, 0.05622771754860878, 1.4160674810409546, 0.016505423933267593, -1.3563092947006226, 0.27042296528816223, -0.14600393176078796, 0.4096797704696655, 0.02842533588409424, -0.41131851077079773, -0.4862343668937683, -0.4606712758541107, -0.014164078049361706, 1.0539894104003906, 0.7416552305221558, -0.07992582768201828, -0.11097222566604614, 0.24558869004249573, -0.5015050172805786, 0.2699650824069977, -0.48671954870224, 0.7972655892372131, -0.127463236451149, -0.3409111499786377, 0.46589720249176025, 0.7688517570495605, -0.1651366502046585, -0.5433818101882935, -0.5734958648681641, -1.4554603099822998, 0.5822233557701111, 0.39544031023979187, 1.2231265306472778, -0.9758566617965698, -0.8006358742713928, -0.010536141693592072, -0.04863082244992256, -0.14049077033996582, -0.7882437109947205, 0.7735500335693359, -0.3879610598087311, 0.8254673480987549, 0.38253554701805115, -1.265901803970337, 0.4264082908630371, -0.15508024394512177, -1.1143170595169067, -0.29407182335853577, 0.04475443437695503, 0.9784823060035706, -0.9479418396949768, 0.1562168449163437, -0.16973161697387695, 0.04661966860294342, -0.8435239195823669, 1.2208632230758667, -0.19007843732833862, 0.3334740996360779, 0.21164245903491974, -0.05098363757133484, 0.09610637277364731, -0.2937769591808319, 0.13794869184494019, -0.300171434879303, -0.38483354449272156, 0.532522976398468, -0.7604640126228333, 1.1495369672775269, 0.06287768483161926, 0.11356048285961151, -0.3230668008327484, -0.5492560267448425, 0.3140740990638733, 0.721796989440918, 0.33020395040512085, -0.3507775068283081, 0.16044919192790985, 0.6489726305007935, -0.5684731602668762, 0.3571837544441223, 1.3754717111587524, 0.8372438549995422, -0.8675186634063721, 0.20842374861240387, 0.36957308650016785, 0.09201601892709732, 0.6938539743423462, 0.5987507700920105, 0.28247931599617004, 0.1587497740983963, 0.31303805112838745, -0.13040176033973694, 0.22391849756240845, -0.9625870585441589, 0.021374301984906197, 0.5900763273239136, 0.3614252209663391, 0.5294725298881531, 0.6163521409034729, -0.9852375388145447, -0.5927243828773499, 0.20777525007724762, 0.75406414270401, 1.6894959211349487, -0.16786207258701324, -0.6288546919822693, -0.6915354132652283, 0.15966857969760895, -0.1575663834810257, -0.20384088158607483, -0.23641446232795715, -0.15733188390731812, -0.532640814781189, -1.1924906969070435, 1.0551189184188843, 0.5046740770339966, 0.6074792742729187, -0.6200066804885864, -0.11565809696912766, -0.210103839635849, 0.22693410515785217, -0.784823477268219, -0.6828048229217529, 0.2913518249988556, -0.27299585938453674, 0.6863064169883728, -0.0022969101555645466, 0.16329534351825714, 0.18769842386245728, -0.9897881746292114, 0.7179957032203674, -0.46877750754356384, -0.05204413831233978, -0.12836147844791412, 0.3343055546283722, -0.4415985345840454, -0.8770912289619446, 0.2102668732404709, 0.5613619685173035, 0.1074507012963295, 0.6064389944076538, 0.8560823202133179, -0.2590080201625824, -0.3518002927303314, -0.4962144196033478, 0.22948291897773743, 0.0850525051355362, -0.1256815642118454, 0.7641822695732117, -0.9238476157188416, -0.020578907802700996, -0.5994093418121338, 1.3157258033752441, 0.14644695818424225, -0.42451024055480957, -0.1474296897649765, -0.9500723481178284, -0.30131450295448303, 0.26659518480300903, -0.7273653149604797, 0.10349612683057785, -0.9690462946891785, 0.4786519408226013, -0.37767764925956726, -0.2832070589065552, 0.1387510895729065, 0.43723905086517334, 0.35538357496261597, 0.10880958288908005, 0.44025900959968567, -0.32917940616607666, -0.33542126417160034, 0.9416102170944214, -0.5299679040908813, 0.44423073530197144, -0.3400174379348755, -0.3297306299209595, -0.12862785160541534, -0.4349839389324188, -0.6519390344619751, 0.05543549358844757, -0.6366131901741028, -0.31885826587677, -0.19912418723106384, 0.18246299028396606, -0.5641975402832031, -0.8411024212837219, -0.08172117173671722, -1.7059764862060547, 0.21077948808670044, -0.20046833157539368, -0.30419105291366577, -0.12396326661109924, -0.8729074597358704, -1.6272130012512207, -0.6171326637268066, -0.6621255278587341, -1.416711688041687, 0.5969885587692261, -0.26372164487838745, -0.6413202285766602, -0.09212660789489746, -0.020902598276734352, -0.7690200209617615, 0.9287436604499817, -0.9981400370597839, 0.7547251582145691, -0.043938152492046356, -0.48183855414390564, -0.13479331135749817, 0.2900230586528778, 0.5781500339508057, -0.4582217335700989, 0.4382789433002472, -0.8369320034980774, 0.1750597506761551, -0.42536914348602295, -0.2985423505306244, 0.3054044544696808, 0.27553558349609375, 1.1591248512268066, -0.3859231173992157, -0.39323556423187256, 0.1586133986711502, 0.9447674751281738, -0.8521696925163269, 0.05377235263586044, -0.014564591459929943, 1.1537835597991943, 0.3009180724620819, -0.302193820476532, 1.0456385612487793, 0.24478252232074738, 0.6535566449165344, 0.2204410880804062, -0.26833370327949524, 0.2967676818370819, -0.48063328862190247, 0.8549548983573914, 2.366269111633301, 0.23647844791412354, 0.1688656061887741, -0.9306563138961792, 0.7891882061958313, -1.469221830368042, -0.4241575002670288, 0.4808901846408844, 0.7319513559341431, 0.2518204152584076, -0.698498547077179, -0.26280656456947327, -0.21425648033618927, 0.3189772367477417, 0.5623660087585449, -0.12112908810377121, -1.417518973350525, -0.0009343935525976121, 0.11546827852725983, 0.23621118068695068, 0.5918689370155334, -0.2697540819644928, 0.6583663821220398, 14.565284729003906, 0.8556243181228638, -0.22192971408367157, 0.7148718237876892, 1.042541265487671, 0.26052325963974, -0.4535277783870697, 0.07530108839273453, -1.4295086860656738, 0.3714940547943115, 1.3539812564849854, 0.24329409003257751, 0.20707078278064728, -0.09953053295612335, 0.14752432703971863, 0.34638142585754395, -0.41803303360939026, 0.7238399982452393, 0.15849462151527405, -1.3874309062957764, 0.3861345946788788, 0.1976601928472519, 0.8672789931297302, 0.5827803611755371, 0.7560286521911621, 0.6287026405334473, 0.29307034611701965, -0.4098745882511139, 0.7225394248962402, -0.12009225785732269, 1.0377366542816162, 0.09383799135684967, 0.4093821346759796, 0.31138622760772705, -0.9669439196586609, -0.05250716954469681, -0.6715133786201477, -1.5900858640670776, 0.48252367973327637, 0.47908297181129456, -0.841414749622345, -0.5992096066474915, -0.37019047141075134, 0.4410732686519623, 0.38880082964897156, 0.12892688810825348, -0.35089990496635437, 0.8417317867279053, -0.09412405639886856, 0.22022870182991028, 0.6427375674247742, 0.4178890883922577, 0.005043592303991318, 0.12552115321159363, 0.10140957683324814, -0.4626084566116333, 0.6501784324645996, 0.6781920790672302, -0.5701749324798584, 0.2894424498081207, 0.19413027167320251, -0.43896085023880005, 0.3401017189025879, 0.9301007390022278, 0.5443414449691772, -0.3607335388660431, -0.26454341411590576, 0.4555495083332062, 0.4051227569580078, 0.4490896463394165, -0.11649870872497559, 0.3002297580242157, 0.5231842398643494, -0.34581804275512695, -0.3222253918647766, 0.579886794090271, -0.31874948740005493, -0.5509780049324036, -0.6138506531715393, -0.04173605144023895, 0.02236236073076725, -0.4491554796695709, -0.7071886658668518, 0.5801002383232117, 0.0885734036564827, -0.41331997513771057, -0.01986888237297535, -0.6538504958152771, -0.13426151871681213, 0.4720480442047119, -1.0378228425979614, -0.5080339312553406, 0.5913046598434448, -0.7393066883087158, -0.5558583736419678, 0.12129306048154831, 1.3586760759353638, 0.3343825340270996, -0.43079057335853577, 0.07941583544015884, 0.1170213595032692, -0.043554406613111496, -0.1500372737646103, -0.9836633205413818, 1.201614260673523, 0.25595155358314514, -0.17771302163600922, 0.4168943166732788, -0.09267380833625793, 0.17195536196231842, -0.38608431816101074, -0.08219429850578308, 0.765415370464325, -0.6249314546585083, -0.562522828578949, -0.927314043045044, -1.0155272483825684, -0.002630824688822031, 0.447157621383667, 0.12667955458164215, 0.42712512612342834, 0.18303035199642181, -0.30608874559402466, 0.03770240768790245, -0.08572769910097122, 0.12031213939189911, -0.016025397926568985, -0.7441120743751526, 0.2551518678665161, -0.10751381516456604, 0.5102404952049255, -0.9909736514091492, -0.8410792946815491, -0.31643202900886536, -0.1305350810289383, 0.30962610244750977, 0.8600742816925049, -0.4885571002960205, 0.6577035188674927, 0.45400968194007874, -0.20278871059417725, -0.8504129648208618, -0.11405649036169052, -1.3634058237075806, -0.12850414216518402, 0.16139031946659088, 0.5021385550498962, 0.03507103770971298, 0.5322091579437256, 0.9010108709335327, 0.25501516461372375, -0.640545129776001, -0.8184109330177307, -0.24814952909946442, 0.1875505894422531, -0.7134393453598022, 0.6354866027832031, -0.21964117884635925, 0.7050468325614929, -0.029416633769869804, 0.1295308768749237, 0.1357860267162323, -0.1942252367734909, -0.9242831468582153, 0.03330892696976662, 0.3880239725112915, 0.26932910084724426, -0.6507095098495483, -0.5099695324897766, -1.6314300298690796, -0.23465090990066528, -1.1130528450012207, -0.011331955902278423, -0.5196626782417297, -0.38455095887184143, -0.021197989583015442, -0.7266862988471985, 0.17481093108654022, 0.24671177566051483, -0.025481028482317924, -0.383125901222229, -0.001352527178823948, -0.6946385502815247, 1.0457055568695068, 0.8020150065422058, -0.5769833326339722, 0.0688823014497757, -0.41913142800331116, 0.1943022608757019, 0.16218388080596924, 0.4563460052013397, -0.32703670859336853, -0.40993523597717285, -1.172996163368225, 0.6347095966339111, -0.462625116109848, -0.29696717858314514, -0.2648252844810486, 0.4526458978652954, 0.29966413974761963, -0.18526259064674377, 0.031772829592227936, 0.2651388347148895, -0.28030750155448914, -0.6906327605247498, 0.26440519094467163, -1.056488037109375, 0.7042480707168579, -0.12248730659484863, -0.7966338396072388, -0.524625301361084, 1.0005584955215454, -0.40597298741340637, -0.9083971381187439, -1.029096007347107, 0.5420601963996887, -0.643353283405304, -0.1400318592786789, -0.47701695561408997, -0.13895995914936066, -1.0375386476516724, -0.17395901679992676, 0.1922828108072281, 0.06688089668750763, -0.09372903406620026, 1.062273621559143, 0.5418575406074524, -1.5070983171463013, -0.016241436824202538, 0.696037232875824, 0.19566862285137177, -0.02279367297887802, 0.3182416260242462, 0.6864427924156189, 0.03594273701310158, 0.6890854239463806, 0.35956189036369324, -0.030290521681308746, -0.5945154428482056, -0.06965965777635574, 0.32634279131889343, -0.5202221274375916, 0.0038648422341793776, 1.1416845321655273, -0.3043948709964752, -0.7971769571304321, 0.032435812056064606, -1.6457619667053223, -0.3425987660884857, -0.5545499920845032, 0.7685253024101257, 0.3787187933921814, 0.1880253106355667, -0.2100154161453247, -0.6309747695922852, -0.3575591444969177, -0.2868509292602539, -0.7908158302307129, -0.22319801151752472, -0.10138498246669769, -0.6925961971282959, 0.4835189878940582, 0.864408016204834, -0.7132264971733093, -0.6839116215705872, -0.5666429996490479, -0.153062641620636, -0.20190896093845367, 0.4512171745300293, 0.0224443431943655, -0.2335902750492096, 1.1279739141464233, 0.6921870112419128, 0.25624528527259827, -0.29520130157470703, -0.16681452095508575, 0.3329484760761261, 0.23614057898521423, -0.06691091507673264, -1.1973379850387573, -0.16773898899555206, 1.1372406482696533, 1.0468567609786987, -0.6369721293449402, 0.05989416688680649, 0.11972850561141968, -0.7925366759300232, 0.6484365463256836, 0.5408090353012085, 0.1824873685836792, 0.47285744547843933, 0.12226817011833191, 0.22973628342151642, 0.12274853885173798, -1.2780300378799438, 0.110739566385746, 0.6852725148200989, 0.6795127391815186, 1.1540807485580444, 0.7414880990982056, -0.06384426355361938, 0.7245209813117981, 0.5583951473236084, 0.015478949062526226, 0.5907915234565735, 0.3565625846385956, -0.33428338170051575, -0.25949203968048096, -0.40552571415901184, 0.6168491840362549, -0.7857460975646973, -0.9859840869903564, 0.4394458532333374, -0.14660656452178955, 0.45528072118759155, 0.2656029164791107, 1.1498092412948608, -0.02220270410180092, 0.22760534286499023, 0.23019735515117645, 0.28882718086242676, -0.5752501487731934, -0.22814522683620453, 0.2102879285812378, -0.9449037909507751, -0.215596005320549, -0.08057054132223129, -0.28875717520713806, -0.5574365854263306, -0.3834966719150543, 0.35353779792785645, 0.005842653568834066, 0.36304527521133423, 0.9775041937828064, 0.8741611242294312, 0.37609755992889404, -0.42695337533950806, -0.8275177478790283, -0.9401562213897705, -1.0189309120178223, -0.30116981267929077, 0.0021071413066238165, -0.4300658702850342, -0.057472072541713715, 0.22375386953353882, -0.419879287481308]}, "authors": [{"authorId": "2307079570", "name": "Seungwoo Son"}, {"authorId": "2307279019", "name": "Wonpyo Park"}, {"authorId": "2215449616", "name": "Woohyun Han"}, {"authorId": "2307219959", "name": "Kyuyeun Kim"}, {"authorId": "2307220789", "name": "Jaeho Lee"}], "references": [{"paperId": "a41a372966c1d8dacf90fea9dd6f00564b430855", "title": "An Empirical Study of LLaMA3 Quantization: From LLMs to MLLMs"}, {"paperId": "dd85e6cab147d237a0b1ab6f674570d3efb4d4a0", "title": "QuaRot: Outlier-Free 4-Bit Inference in Rotated LLMs"}, {"paperId": "fdc53c2c10742464087c0525f77e32604827a21d", "title": "Efficient Streaming Language Models with Attention Sinks"}, {"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "d193675b92fbfbf22ed82fda35cd2e73587e33bd", "title": "Quantizable Transformers: Removing Outliers by Helping Attention Heads Do Nothing"}, {"paperId": "db9507cdd3e2d7d9c90ed185bd831e55c62dcec9", "title": "AWQ: Activation-aware Weight Quantization for On-Device LLM Compression and Acceleration"}, {"paperId": "f3275146eb973c9726dc550a88cc552f0dfa5ea7", "title": "Outlier Suppression+: Accurate quantization of large language models by equivalent and effective shifting and scaling"}, {"paperId": "964bd39b546f0f6625ff3b9ef1083f797807ef2e", "title": "BLOOM: A 176B-Parameter Open-Access Multilingual Language Model"}, {"paperId": "4be7d1524edb0137599a5cc95f72844b85a52fe1", "title": "LLM.int8(): 8-bit Matrix Multiplication for Transformers at Scale"}, {"paperId": "e03609f2587f690867e7ea0bedaf0db25282c548", "title": "ZeroQuant: Efficient and Affordable Post-Training Quantization for Large-Scale Transformers"}, {"paperId": "13a0d8bb38f739990c8cd65a44061c6534f17221", "title": "OPT: Open Pre-trained Transformer Language Models"}, {"paperId": "73bcf4577284fa116ee73487b7cbb85c8266eaa0", "title": "Understanding and Overcoming the Challenges of Efficient Transformer Quantization"}, {"paperId": "51b0c571d89bd2d39a194f60f91f0a03d74574b5", "title": "All Bark and No Bite: Rogue Dimensions in Transformer Language Models Obscure Representational Quality"}, {"paperId": "5a09edeb26f9f116f2c0503cd020f38fb943f79b", "title": "BERT Busters: Outlier Dimensions that Disrupt Transformers"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "59d0d7ccec2db66cad20cac5721ce54a8a058294", "title": "Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "bb0656031cb17adf6bac5fd0fe8d53dd9c291508", "title": "An empirical analysis of compute-optimal large language model training"}, {"paperId": "53d8b356551a2361020a948f64454a6d599af69f", "title": "Prefix-Tuning: Optimizing Continuous Prompts for Generation"}, {"paperId": null, "title": "2023. Mistral 7B"}, {"paperId": null, "title": "2024. OmniQuant: Omnidirectionally calibrated quantization for large language models"}, {"paperId": null, "title": "2024. Vision transformers need registers"}, {"paperId": null, "title": "2023. A framework for few-shot language model evaluation"}]}