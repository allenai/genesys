{"paperId": "0664d52b1040e048fff7e7d1d13a310964207768", "title": "Accelerating Toeplitz Neural Network with Constant-time Inference Complexity", "abstract": "Toeplitz Neural Networks (TNNs) have exhibited outstanding performance in various sequence modeling tasks. They outperform commonly used Transformer-based models while benefiting from log-linear space-time complexities. On the other hand, State Space Models (SSMs) achieve lower performance than TNNs in language modeling but offer the advantage of constant inference complexity. In this paper, we aim to combine the strengths of TNNs and SSMs by converting TNNs to SSMs during inference, thereby enabling TNNs to achieve the same constant inference complexities as SSMs. To accomplish this, we formulate the conversion process as an optimization problem and provide a closed-form solution. We demonstrate how to transform the target equation into a Vandermonde linear system problem, which can be efficiently solved using the Discrete Fourier Transform (DFT). Notably, our method requires no training and maintains numerical stability. It can be also applied to any LongConv-based model. To assess its effectiveness, we conduct extensive experiments on language modeling tasks across various settings. Additionally, we compare our method to other gradient-descent solutions, highlighting the superior numerical stability of our approach. The source code is available at https://github.com/OpenNLPLab/ETSC-Exact-Toeplitz-to-SSM-Conversion.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2023, "citationCount": 6, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper aims to combine the strengths of TNNs and SSMs by converting Toeplitz Neural Networks to SSMs during inference, thereby enabling Tnns to achieve the same constant inference complexities as SSMs."}, "embedding": {"model": "specter_v2", "vector": [0.3662610948085785, 0.34120258688926697, -0.17039766907691956, -0.29672959446907043, -0.13135938346385956, -0.2762421667575836, 0.5402840375900269, -0.330385684967041, -0.7455549240112305, -0.323190301656723, 0.21063774824142456, -0.4647422432899475, 0.5943728089332581, 0.20575430989265442, -0.3600667417049408, 0.4407894015312195, -0.6959724426269531, 0.23058825731277466, -0.17782077193260193, -0.17174822092056274, -0.20413453876972198, -0.6329954862594604, -0.6807236671447754, -0.2897263765335083, 0.05039171501994133, 1.0223281383514404, -0.008193413726985455, 0.7792256474494934, -0.6448500752449036, 0.4308759272098541, 0.7878971695899963, -0.48331382870674133, 0.4863523542881012, 0.15037493407726288, -0.21360698342323303, -0.44398272037506104, -0.030103139579296112, -0.7869793772697449, -0.766231894493103, 1.12471604347229, -0.4903300404548645, 0.3758625090122223, 0.47584620118141174, -0.705753743648529, -0.1616392880678177, 0.6112397313117981, 0.5380467772483826, 0.8769412040710449, -0.4348548352718353, -0.8594227433204651, 1.2531201839447021, -1.1834511756896973, -0.14600583910942078, 1.5547423362731934, 0.9320156574249268, 0.41904115676879883, -0.2494349181652069, -0.794589638710022, 0.4125136435031891, 0.19832950830459595, -0.6061743497848511, -0.36774882674217224, -0.16177533566951752, -0.0100422827526927, 1.7215594053268433, -0.2906137704849243, 0.21037787199020386, 0.7768609523773193, 0.022449033334851265, 1.2438762187957764, 0.06133832037448883, -0.488231897354126, -0.11340834200382233, 0.1601284146308899, 0.45503678917884827, 0.8378824591636658, -0.4271402060985565, 0.5148449540138245, -1.0196467638015747, -0.135362446308136, 0.3018953800201416, 0.19242888689041138, 0.4333193004131317, -0.12992525100708008, -0.10307841002941132, 0.7629405856132507, 0.1451077163219452, 0.363381564617157, -0.09623270481824875, 1.0388872623443604, 1.0083767175674438, 0.12736673653125763, 0.11043597757816315, -0.07846160978078842, -0.031043773517012596, 0.12398173660039902, -0.9050731658935547, -0.2027755081653595, 0.0038462807424366474, 0.7337071299552917, -0.4044618606567383, 0.7414584755897522, -0.4147929549217224, 0.04473745822906494, 1.3870700597763062, 0.12061125040054321, 0.13220961391925812, -0.6105942130088806, -0.04362965747714043, -0.9178435802459717, 0.17787690460681915, -0.8122091889381409, -0.05181620642542839, -0.47828373312950134, -1.0418041944503784, -1.4467267990112305, -0.7310258746147156, 0.05317855626344681, -0.7645309567451477, 0.907427966594696, -0.5443919897079468, 0.6300074458122253, 0.047337859869003296, -0.024662652984261513, -0.029832996428012848, 1.2594988346099854, 0.035688597708940506, -0.16458013653755188, 0.8683874011039734, -0.8203771710395813, -1.0846352577209473, -1.0452507734298706, 0.2398611158132553, -0.007434465456753969, -0.09313328564167023, -0.34371110796928406, -1.0910309553146362, -0.8969674110412598, -0.6767430305480957, 0.13946431875228882, -0.1321748048067093, 0.4775753319263458, 0.9390978813171387, 0.41266852617263794, -1.0565811395645142, 0.6560651659965515, -0.9554769396781921, -0.09707420319318771, 0.19606934487819672, 0.2322254776954651, 0.656902015209198, 0.1525258719921112, -1.3016020059585571, 0.6606619954109192, 0.6257488131523132, -0.3270317018032074, -0.20687106251716614, -0.6736558675765991, -0.9377161860466003, 0.628250241279602, 0.30381080508232117, -0.284609854221344, 1.2972310781478882, 0.29083555936813354, -1.4237512350082397, 0.17187286913394928, -0.446871817111969, -0.1972886621952057, 0.29362958669662476, -0.07921707630157471, -0.8527736067771912, -0.4792664349079132, -0.13828960061073303, 0.20572304725646973, 0.31235453486442566, 0.07055729627609253, -0.060425594449043274, 0.33990931510925293, -0.7514702081680298, -0.4167666733264923, -0.36189523339271545, 1.0477274656295776, -0.09340576827526093, -0.15212328732013702, 0.12257549166679382, 0.3555380702018738, -0.25114279985427856, -0.007193665485829115, -0.7048318982124329, -0.8894888162612915, 0.6433699727058411, -0.4464200735092163, 1.146366834640503, -0.6665089726448059, -0.9753597378730774, 0.038823943585157394, 0.060944877564907074, 0.05293814092874527, -0.6179713010787964, 0.8050829172134399, -0.7481279969215393, 0.055013298988342285, -0.14572773873806, -0.9239469766616821, 0.08433014899492264, -0.32512784004211426, -0.7932784557342529, -0.23374627530574799, 0.03744432330131531, 1.0734007358551025, -0.7713978886604309, 0.40245065093040466, 0.06739961355924606, 0.2973475158214569, -1.0672355890274048, 1.028762698173523, -0.05387919396162033, -0.19657792150974274, 0.18819867074489594, -0.7349525094032288, 0.0819721594452858, -0.7450515031814575, 0.5353277325630188, -0.4668108820915222, -0.18757018446922302, 0.43238088488578796, -0.5683711767196655, 1.0968090295791626, -0.34871408343315125, 0.9556906819343567, -0.21651533246040344, -0.8924741744995117, 0.16256368160247803, 0.2492927610874176, 0.11295872181653976, -0.08098559826612473, 0.6314727067947388, 0.2293485552072525, -0.6465730667114258, 0.49604570865631104, 0.515774667263031, 0.7941593527793884, -0.12757554650306702, 0.4562610387802124, 0.2444097399711609, 0.3153919577598572, 0.48665499687194824, 0.5542121529579163, 0.39597776532173157, -0.11666349321603775, 0.5704634189605713, -0.2050582617521286, 0.26794376969337463, -1.0712056159973145, -0.1333383172750473, 0.26652172207832336, 0.6460101008415222, 0.08953123539686203, 0.4330681562423706, -0.5894161462783813, -0.8263096809387207, -0.2803497314453125, 0.33348360657691956, 1.097755789756775, -0.24088041484355927, -0.42663779854774475, -0.7594190835952759, 0.22600635886192322, -0.4252821207046509, 0.2711801528930664, -0.2680134177207947, -0.330548495054245, -0.23573312163352966, -0.9514303803443909, 1.091573715209961, 0.6708464622497559, 1.1684423685073853, 0.1904730647802353, -0.21979430317878723, -0.025810057297348976, -0.11904904991388321, -0.9302904605865479, -0.9510166049003601, 0.4576769769191742, -0.4898262619972229, 0.24174295365810394, -0.01734941266477108, 0.16550981998443604, -0.06720378249883652, -1.0017682313919067, 0.4322877824306488, -0.9244170784950256, 0.027498597279191017, -0.03998081758618355, 1.0428930521011353, -0.9157865643501282, -1.1673752069473267, 0.046387817710638046, 0.6120957136154175, -0.08089954406023026, 0.4776165783405304, 0.5432282090187073, 0.1467432826757431, -0.03811602666974068, -0.2837381660938263, 0.43526482582092285, -0.13509425520896912, 0.3438419997692108, 0.0972098857164383, -0.32659560441970825, 0.010871424339711666, -0.7409698963165283, 0.9564160108566284, 0.28407981991767883, -0.6633321046829224, 0.47702890634536743, -0.9550686478614807, 0.10868313908576965, 0.4288480579853058, -0.7205822467803955, -0.20558539032936096, -0.6758065223693848, -0.12590409815311432, -0.5101705193519592, 0.3210148513317108, 0.24257074296474457, 0.7242981791496277, 0.3504950702190399, 0.06955534219741821, 0.8887279629707336, 0.708602249622345, 0.14004738628864288, -0.038169827312231064, -0.6745092868804932, 0.5616167783737183, 0.5667515993118286, 0.3841730058193207, -0.2619134485721588, -0.11261963844299316, -0.4822840392589569, -0.4377894699573517, -0.33528730273246765, -0.1324058324098587, -0.3976115882396698, 0.1989302635192871, -0.4449741244316101, -1.3786261081695557, 0.07092005759477615, -1.3100754022598267, 0.09580174833536148, 0.48939111828804016, -0.07181653380393982, -0.19510844349861145, -0.8019276857376099, -1.5840492248535156, -1.0865180492401123, -0.45306822657585144, -0.6804457902908325, 0.11409373581409454, -0.0820501297712326, -0.2819775342941284, -0.5620078444480896, -0.20852406322956085, -0.5587813854217529, 0.9659264087677002, -0.8204159736633301, 1.0139777660369873, -0.05209717899560928, -0.2602222263813019, -0.3857010304927826, -0.03835749253630638, 0.7219728827476501, -0.42541804909706116, 0.26772043108940125, -0.742891788482666, 0.06431964039802551, -0.5803288817405701, 0.12537553906440735, -0.07938724011182785, 0.5639689564704895, 0.7090311050415039, -0.16621853411197662, -0.3179105222225189, 0.24698102474212646, 1.3172940015792847, -0.053060382604599, -0.10302078723907471, -0.15245072543621063, 0.7365932464599609, -0.17636705935001373, -0.4578973352909088, 0.8739050030708313, 0.16118967533111572, 0.44990962743759155, -0.16075867414474487, 0.10777468234300613, 0.5789952874183655, -0.771609365940094, 0.51338791847229, 1.6214659214019775, 0.2453729659318924, -0.04856143519282341, -0.9999666213989258, 0.23419442772865295, -1.0987318754196167, -1.0926973819732666, 0.5865673422813416, 0.320119708776474, 0.31883731484413147, -0.32288700342178345, -0.2514422833919525, 0.09672552347183228, 0.6308789849281311, 0.49133190512657166, -0.7779427766799927, -0.6466338634490967, 0.25902441143989563, 0.06431317329406738, 0.34341731667518616, 0.40055596828460693, -0.16622626781463623, 0.5615166425704956, 14.937165260314941, 0.8027046322822571, -0.21839724481105804, 0.6274820566177368, 0.3766443431377411, 0.3090817630290985, -0.21568796038627625, -0.2847670018672943, -1.197183609008789, 0.03730747848749161, 1.4775733947753906, -0.3335287868976593, 0.8029976487159729, 0.13058672845363617, 0.16000783443450928, 0.5776196718215942, -0.6600331664085388, 1.1908001899719238, 0.25558602809906006, -1.5976057052612305, 0.16690410673618317, 0.008653213270008564, -0.011910834349691868, 0.34608423709869385, 0.6443153619766235, 0.6559292078018188, 0.4517240524291992, -0.28542107343673706, 0.5597444176673889, 0.2538520395755768, 1.1540017127990723, -0.03380170837044716, 0.3213757574558258, 0.715029239654541, -1.2750624418258667, -0.13281050324440002, -0.42077693343162537, -0.907289445400238, 0.6473180651664734, 0.15579937398433685, -0.3778423070907593, -0.41592881083488464, 0.018729405477643013, 1.061381459236145, 0.7966699004173279, 0.2296135276556015, 0.46313604712486267, 0.6576282978057861, -0.4733908474445343, -0.329951673746109, 0.13190579414367676, -0.03572770953178406, 0.19771519303321838, -0.2260347604751587, 0.1571960300207138, 0.13115103542804718, -0.1504565328359604, 0.7197179794311523, -0.17455804347991943, -0.3591197729110718, -0.1295333057641983, -0.7552241683006287, 0.04036100208759308, 0.4099922180175781, 0.32956233620643616, 0.09137487411499023, -0.2630022466182709, 0.3125935196876526, 0.24621903896331787, 0.44066324830055237, -0.7307249903678894, 0.1564384400844574, 0.592193067073822, -0.5484868884086609, -0.3286721110343933, 0.32231995463371277, -0.26312360167503357, -0.8059733510017395, -0.8791253566741943, -0.45863398909568787, 0.09469198435544968, -0.7651441097259521, -0.592767596244812, 1.0339678525924683, -0.41714709997177124, -0.1397547423839569, 0.3365195393562317, -0.8595805764198303, 0.0239886324852705, 0.4703030586242676, -1.031213641166687, -0.1506357043981552, 0.5721750855445862, -0.34789222478866577, -0.10062728077173233, -0.038845062255859375, 1.1020910739898682, 0.6396067142486572, -0.7350638508796692, 0.007985837757587433, 0.2884691059589386, 0.10742709040641785, -0.63349449634552, -0.5056208968162537, 1.1801735162734985, 0.5578374862670898, -0.15099677443504333, 0.6887381672859192, 0.2855204939842224, -0.07410962879657745, -0.5917254686355591, -0.05641203746199608, 0.6277925968170166, -0.6909784078598022, 0.0612868033349514, -1.0204120874404907, -0.6353024244308472, 0.6040704250335693, 0.0995631143450737, -0.7549424171447754, 0.08836648613214493, 0.027424369007349014, -0.5216270685195923, -0.02815748006105423, -0.22806960344314575, 0.27827733755111694, 0.5694794654846191, -1.1368885040283203, 0.09349633008241653, -0.26188528537750244, -0.011754784733057022, -0.8773166537284851, -0.25473839044570923, 0.06449428200721741, 0.3590134084224701, 0.021002188324928284, 1.136479139328003, -0.6588355898857117, 0.9246335625648499, 0.9938567876815796, -0.1902819275856018, -0.605735719203949, -0.2024107128381729, -0.577903151512146, 0.024490054696798325, -0.1723065823316574, 0.265585720539093, -0.48370933532714844, 0.41345611214637756, 0.7516199946403503, 0.20521223545074463, -0.4220688045024872, -0.5242511034011841, -0.6674604415893555, -0.4679213762283325, -0.6591008305549622, 0.1379273384809494, -0.3206028342247009, -0.4413853585720062, 0.1806066781282425, -0.2858368754386902, 0.5950593948364258, -0.333420991897583, -0.9697408676147461, -0.06616924703121185, -0.46003279089927673, -0.13089041411876678, -0.49411696195602417, -0.382207989692688, -1.7407102584838867, 0.4886351227760315, -1.2729368209838867, -0.10948751121759415, -0.9379312992095947, -0.014324878342449665, 0.3573874533176422, -0.05243111029267311, -0.02496740221977234, 0.4657909870147705, -0.6241982579231262, -0.37447983026504517, -0.6703941822052002, -0.13186022639274597, 1.0133801698684692, 0.48941147327423096, -0.6387100219726562, 0.5770618915557861, 0.2803201377391815, 0.5094481706619263, 0.2179742306470871, 0.1556786149740219, -0.3894106447696686, -0.7589348554611206, -1.1114537715911865, 0.2936612665653229, 0.360679030418396, 0.03762983903288841, -0.5450981855392456, 0.70830899477005, 0.35470879077911377, -0.14711984992027283, -0.23656512796878815, 0.6548624634742737, -1.122725009918213, 0.05290306359529495, 1.015511393547058, -1.0196722745895386, 0.515430748462677, 0.27411049604415894, -0.2453628033399582, 0.010039572604000568, 0.7187013030052185, 0.24151751399040222, -0.38105475902557373, -0.7069295644760132, 0.9237136840820312, -0.7957775592803955, 0.016444867476820946, -0.15122763812541962, -0.22698304057121277, -0.7075483798980713, -0.7985950708389282, 0.05244772136211395, 0.1165151447057724, -0.759209156036377, 0.8021917343139648, 0.3007729947566986, -1.1435996294021606, 0.3052418529987335, 0.5896272659301758, -0.20504428446292877, -0.7708925604820251, 0.49101704359054565, 0.3217272162437439, -0.2514055669307709, 0.8950044512748718, 0.12964075803756714, 0.22198590636253357, -1.1244217157363892, -0.10829814523458481, 1.0329660177230835, -0.3406437635421753, -0.08979880809783936, 0.9799326658248901, -0.2965256869792938, -0.9971704483032227, 0.2595904469490051, -1.072792649269104, -0.17628854513168335, -0.41510680317878723, 0.23254092037677765, 0.747604489326477, -0.19634751975536346, 0.3220606744289398, -0.5739310383796692, -0.02374333143234253, 0.20726899802684784, -0.514676570892334, 0.3500302731990814, -0.4917846620082855, -0.29842281341552734, 0.9181693196296692, 1.0479732751846313, -0.9495043158531189, -0.916061282157898, -0.8212546110153198, -0.17508089542388916, -0.03375811129808426, 0.26882877945899963, -0.07898566871881485, -0.5001277327537537, 0.8707927465438843, 0.7548701763153076, 0.41878190636634827, 0.12308396399021149, -0.4080101549625397, 0.43301451206207275, 0.7006538510322571, 0.15979301929473877, -0.502044677734375, -0.6008094549179077, 1.604918122291565, 0.8792278170585632, -0.8117380738258362, 0.01066297572106123, -0.6294100880622864, -0.6691060066223145, 0.7083337306976318, -0.008154187351465225, 0.004770974162966013, 1.0068962574005127, 0.07942075282335281, -0.01149076409637928, 0.5894923210144043, -1.0649735927581787, 0.14133892953395844, 0.7764930129051208, 0.5863861441612244, 0.29791495203971863, 0.1633387953042984, 0.3425908088684082, 0.8799296021461487, -0.26995566487312317, 0.21752327680587769, 0.36938172578811646, 0.2181837260723114, 0.036203108727931976, 0.0997454896569252, 0.24187448620796204, 1.147095799446106, -0.7891812324523926, -1.0131677389144897, 0.45249608159065247, 0.22750066220760345, -0.5724643468856812, 0.5686902403831482, 1.1048353910446167, -0.1140856221318245, 0.45738881826400757, 0.17441992461681366, 0.28326216340065, -0.1451951563358307, 0.06098932772874832, -0.09391976147890091, -0.7265123128890991, 0.012931336648762226, 0.05928567796945572, -0.5104414820671082, -0.4820253849029541, -0.7796511054039001, 0.18633216619491577, 0.13714781403541565, 0.6062597036361694, 0.9828248620033264, 0.2695204019546509, 0.6161733865737915, -0.05282759666442871, -0.27338337898254395, -0.9762207865715027, -0.589306116104126, -0.21554844081401825, -0.8551004528999329, -0.036359693855047226, 0.09383778274059296, 0.03609173372387886, -0.19434334337711334]}, "authors": [{"authorId": "2171650015", "name": "Zhen Qin"}, {"authorId": "2266275708", "name": "Yiran Zhong"}], "references": [{"paperId": "2a38daf98d506477f8180806f503409d5036eaf4", "title": "TransNormerLLM: A Faster and Better Large Language Model with Improved TransNormer"}, {"paperId": "f35f5aedc30e2c5ded210d9c91ba6e84bd029425", "title": "Toeplitz Neural Network for Sequence Modeling"}, {"paperId": "240300b1da360f22bf0b82c6817eacebba6deed4", "title": "What Makes Convolutional Models Great on Long Sequence Modeling?"}, {"paperId": "86c8d930b492a4f9cadc6c60aecdaaded49acc86", "title": "Neural Architecture Search on Efficient Transformers and Beyond"}, {"paperId": "71e15a9a52dcafca57bff5f310b95e2c7d0cfc87", "title": "Diagonal State Spaces are as Effective as Structured State Spaces"}, {"paperId": "9b3fa3a80afdb6d34984307e457656420e60e7e7", "title": "Should You Mask 15% in Masked Language Modeling?"}, {"paperId": "57150ca7d793d6f784cf82da1c349edf7beb6bc2", "title": "MetaFormer is Actually What You Need for Vision"}, {"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "3fbf6339273c50b04e886fa9bd4ad18c952a683d", "title": "Rethinking Attention with Performers"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "0170fc76e934ee643f869df18fb617d5357e8b4e", "title": "Conformer: Convolution-augmented Transformer for Speech Recognition"}, {"paperId": "09e2c7adbed37440d4a339852cfa34e5b660f768", "title": "Transformer Transducer: A Streamable Speech Recognition Model with Transformer Encoders and RNN-T Loss"}, {"paperId": "ffe1416bcfde82f567dd280975bebcfeb4892298", "title": "Improving Transformer-Based End-to-End Speech Recognition with Connectionist Temporal Classification and Language Model Integration"}, {"paperId": "c8b25fab5608c3e033d34b4483ec47e68ba109b7", "title": "Swin Transformer: Hierarchical Vision Transformer using Shifted Windows"}, {"paperId": null, "title": "How (un) stable are vander-monde systems?"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "2022. Ef-ficiently modeling long sequences with structured state spaces"}, {"paperId": null, "title": "2023d. Hgru: Hierarchically gated recurrent units for long sequence modeling"}, {"paperId": null, "title": "2022a. Locality matters: A locality-biased linear attention for automatic speech recognition"}, {"paperId": null, "title": "2023c. Linearized relative positional encoding"}, {"paperId": null, "title": "2022b. cosformer: Rethinking softmax in attention"}, {"paperId": null, "title": "2022a. The devil in linear transformer"}, {"paperId": null, "title": "2022. Efficiently scaling transformer inference"}]}