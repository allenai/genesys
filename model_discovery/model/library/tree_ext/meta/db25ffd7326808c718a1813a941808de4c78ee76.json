{"paperId": "db25ffd7326808c718a1813a941808de4c78ee76", "title": "Ef\ufb01\ufb01cent Language Modeling of Long-Term Dependencies", "abstract": "The transformer architecture [1] has received signi\ufb01cant research attention due to its ability to effectively model word-level and global contextual dependencies exclusively using self-attention, thereby enabling language models such as BERT [2] to achieve state-of-the-art performance. However, the quadratic cost of attention and linear memory cost per layer have severely limited the transformer to operate solely on short sequences, a problem partially addressed by the reversible layers and LSH attention proposed in the reformer [3]. In this work, we study and improve properties of the reformer as a language model, introducing k -means clustering for attention and connection tying in reversible layers to improve reformer complexity and representational power. We evaluate our model on masked language modeling as well as selected GLUE benchmarks, and we \ufb01nd that our modi\ufb01cations signi\ufb01-cantly improve training times and model capacity. The methods presented in our work are generalizable to other attention-based models and have the potential to drastically improve the ef\ufb01cacy of long-term language dependency modeling.", "venue": "", "year": 2020, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work study and improve properties of the reformer as a language model, introducing k -means clustering for attention and connection tying in reversible layers to improve reformer complexity and representational power."}, "embedding": {"model": "specter_v2", "vector": [-0.04606383666396141, 0.40941980481147766, -0.49383506178855896, -0.2852342426776886, -0.16121560335159302, -0.2020987868309021, 0.6669560074806213, -0.1090259850025177, -0.22202278673648834, -0.25650930404663086, 0.9288125038146973, -0.02031003311276436, 0.44594860076904297, 0.2352975606918335, -0.11717376112937927, 0.10726964473724365, -1.103639006614685, 0.1679023802280426, 0.21291711926460266, -0.412121057510376, 0.05915496498346329, -0.7891757488250732, -0.9440323114395142, 0.18812556564807892, 0.3605314791202545, 0.20733524858951569, 0.4418337941169739, 0.6232748031616211, -0.3595012128353119, 0.33309048414230347, 0.3841879069805145, -0.3626439571380615, -0.04551265388727188, -0.14138086140155792, -0.06059858575463295, 0.12065064907073975, 0.06345386803150177, -0.13895893096923828, -0.3960600793361664, 0.5638222694396973, -0.19754403829574585, 0.0452997162938118, 0.20707379281520844, -0.48488888144493103, -0.40085703134536743, 1.5839954614639282, 0.6480227112770081, 0.8379818201065063, -0.43409493565559387, -1.010926365852356, 1.5281494855880737, -1.2415906190872192, 0.0804922878742218, 1.2765772342681885, 0.3001902401447296, 0.34587353467941284, -0.41800457239151, -0.68736332654953, 1.1831555366516113, 0.2926580607891083, -0.8786419034004211, -0.49689003825187683, 0.2674059271812439, -0.16079477965831757, 1.9872024059295654, -0.43712782859802246, 0.14688701927661896, 0.5606681704521179, 0.16013821959495544, 0.9370937347412109, -0.06538251787424088, -0.7303722500801086, -0.32315438985824585, -0.09436288475990295, 0.5192114114761353, 0.6096524596214294, -0.3645581305027008, 0.3019365966320038, -0.9208612442016602, 0.2741326689720154, 0.20278717577457428, -0.020694419741630554, 0.22695134580135345, 0.004278553184121847, 0.04763510078191757, 0.6251384019851685, 0.41439223289489746, 0.9187250137329102, -0.2743395268917084, 0.6474531888961792, 0.3152497112751007, 0.2550957202911377, 0.08628984540700912, 0.1223907545208931, -0.02156987227499485, 0.3956397473812103, -0.9127374291419983, -0.13870574533939362, -0.19430707395076752, 0.9012112617492676, 0.015929853543639183, 0.5068426728248596, -0.502363920211792, 0.1239534318447113, 1.5590790510177612, 0.003490215865895152, 0.6010276079177856, -0.5213998556137085, 0.06300776451826096, -0.7474805116653442, 0.03698331490159035, -0.7039435505867004, -0.2221088409423828, -0.39675599336624146, -0.6352391839027405, -1.485390305519104, -0.7785462141036987, 0.13986824452877045, -0.8251312971115112, 1.0112179517745972, -0.48002904653549194, 0.16081151366233826, 0.08299329876899719, 0.13513003289699554, 0.38772261142730713, 0.657495379447937, 0.32068130373954773, -0.1287514716386795, 0.7414038181304932, -0.9529467821121216, -0.7332631349563599, -1.1394164562225342, 0.618868350982666, -0.25169503688812256, -0.13361944258213043, -0.42149868607521057, -1.167332649230957, -1.0528041124343872, -0.9878417253494263, 0.14071382582187653, -0.4515800476074219, -0.03258654102683067, 0.6199963688850403, 0.47904518246650696, -1.3919612169265747, 0.835640013217926, -0.34939199686050415, -0.17900115251541138, 0.09522462636232376, 0.16796670854091644, 0.39590078592300415, -0.21438243985176086, -1.4882597923278809, 0.2493707686662674, 0.040592748671770096, -0.2622077167034149, -0.20964889228343964, -0.607016384601593, -1.199041724205017, 0.019433526322245598, 0.3895208239555359, 0.06644067913293839, 1.3060859441757202, 0.05188727006316185, -1.1823362112045288, 0.5779553055763245, -0.721882700920105, 0.06373622268438339, -0.3795524537563324, -0.25746503472328186, -0.7588939070701599, -0.67768394947052, -0.08123046159744263, 0.2553786635398865, 0.4084160327911377, -0.4179505407810211, -0.1603977084159851, -0.07833775877952576, -0.4819205701351166, -0.14070327579975128, -0.15235580503940582, 1.2395036220550537, -0.38322409987449646, -0.3831053674221039, 0.18107017874717712, 0.5838634371757507, 0.062531478703022, -0.8630236387252808, -0.5008179545402527, -0.9621638655662537, 0.6651789546012878, -0.12444394826889038, 1.5876246690750122, -0.9649147987365723, -0.5693629384040833, -0.26677900552749634, -0.46341565251350403, 0.046955738216638565, -0.8605765700340271, 0.978370189666748, -0.8806325793266296, 0.5915000438690186, -0.2014276534318924, -1.156962275505066, -0.0863681212067604, -0.02251351624727249, -0.8214318156242371, -0.5994076132774353, 0.1536562740802765, 1.24658203125, -0.6909642815589905, 0.2014959752559662, -0.09696655720472336, 0.42883384227752686, -0.8686069846153259, 1.2214821577072144, -0.3331945538520813, 0.21190808713436127, 0.11491265892982483, -0.28114354610443115, -0.008245431818068027, -0.2624175250530243, 0.6973327398300171, -0.18370133638381958, -0.41481688618659973, 0.6972039341926575, -0.23872533440589905, 0.9855664372444153, -0.10821861028671265, 0.23568668961524963, 0.12415380030870438, -1.005898118019104, 0.3092757761478424, 0.40837666392326355, 0.16574230790138245, -0.4551108181476593, 0.28029072284698486, 0.23698653280735016, -0.29234808683395386, 0.2901647984981537, 0.5678211450576782, 0.6087648868560791, -0.45551082491874695, 0.15999941527843475, 0.3685683608055115, -0.30724358558654785, 0.5462528467178345, 0.32456013560295105, 0.7685648202896118, 0.39914074540138245, 0.3556508719921112, -0.2782820165157318, 0.31528133153915405, -0.8645251989364624, 0.293070524930954, 0.1342458873987198, 0.6035377979278564, 0.7298547029495239, 0.45126256346702576, -0.36038902401924133, -0.4011231064796448, 0.13516497611999512, 0.6692384481430054, 1.4853674173355103, -0.25165513157844543, -0.43176010251045227, -0.7013647556304932, -0.13697180151939392, -0.3981558680534363, 0.12919102609157562, -0.2672908306121826, -0.14319010078907013, -1.0389126539230347, -1.0271373987197876, 0.5075550675392151, 0.5141817331314087, 0.7657607793807983, -0.671657919883728, -0.037296589463949203, -0.014924755319952965, 0.2129708230495453, -0.8965937495231628, -0.7706940770149231, 0.5218218564987183, -0.3581698536872864, -0.11345203965902328, 0.22744940221309662, -0.44282013177871704, 0.03228013962507248, -0.5153635144233704, 0.9913512468338013, -0.0511404313147068, -0.23697787523269653, 0.04888903722167015, 0.19541119039058685, -0.3525139093399048, -0.4741603136062622, 0.15309347212314606, 0.2549065947532654, -0.21338199079036713, 0.3764915466308594, 0.3324723541736603, -0.10191863775253296, 0.3147491216659546, -0.3450424075126648, -0.02283983863890171, 0.10155954957008362, 0.015828680247068405, 0.445151150226593, 0.014513195492327213, 0.03951014205813408, -1.0948253870010376, 0.7518288493156433, 0.23878444731235504, -0.3448098599910736, 0.26853427290916443, -0.7987135648727417, -0.3424025774002075, 0.33636215329170227, -0.3970472514629364, -0.2730707824230194, -1.11734938621521, 0.35770702362060547, 0.014761480502784252, -0.07047238945960999, 0.5555846095085144, -0.012121804989874363, 0.6014281511306763, -0.29874521493911743, 0.2795550227165222, 0.10542704164981842, -0.159561887383461, 0.5538502931594849, -0.631101667881012, 0.679718554019928, 0.34567129611968994, 0.24708464741706848, -0.2734985053539276, -0.4272981286048889, -0.9192779660224915, -0.4287962317466736, -0.3494524359703064, -0.5864493250846863, -0.06483140587806702, 0.6034950613975525, -0.5839365720748901, -0.49520596861839294, 0.03602598235011101, -1.1601048707962036, -0.345332533121109, 0.16226400434970856, -0.46865910291671753, 0.18832318484783173, -0.9753259420394897, -1.3257685899734497, -0.5042028427124023, -0.3572554886341095, -0.8769358396530151, 0.26133793592453003, 0.10284634679555893, -0.25785940885543823, -0.5269054770469666, 0.10880899429321289, -0.4667762219905853, 1.0767244100570679, -0.7484948039054871, 1.1084908246994019, 0.0008614356629550457, -0.46991974115371704, 0.13852356374263763, 0.34117957949638367, 0.6709066033363342, -0.05288661643862724, 0.42775505781173706, -0.3988575339317322, 0.17884275317192078, -0.2167247235774994, 0.24960902333259583, 0.21674884855747223, 0.5092455744743347, 0.5715004205703735, 0.20897795259952545, -0.43280741572380066, 0.17194576561450958, 1.2406259775161743, -0.34414392709732056, 0.23949967324733734, -0.031059186905622482, 1.088638186454773, 0.556623637676239, -0.4366540312767029, 0.18341927230358124, 0.6072211265563965, 0.3746066391468048, 0.16808462142944336, 0.021782025694847107, -0.15182359516620636, -0.48704347014427185, 0.5851269364356995, 2.3959076404571533, 0.1937304139137268, 0.04469261318445206, -0.9877018332481384, 0.9023522734642029, -1.2308562994003296, -0.7676189541816711, 0.6219677329063416, 0.7413613200187683, 0.28843966126441956, -0.6399433016777039, -0.3274427354335785, 0.0419006310403347, 0.8233450055122375, 0.44748732447624207, -0.23345115780830383, -0.811303436756134, 0.04009738564491272, 0.6292967200279236, 0.009307965636253357, 0.9386361837387085, -0.3638150095939636, 0.8578565120697021, 15.061530113220215, 0.23069769144058228, 0.10427484661340714, 0.6155263781547546, 0.5392964482307434, 0.34918272495269775, -0.45222631096839905, 0.19280767440795898, -1.5212616920471191, 0.18480071425437927, 1.3739347457885742, 0.07853157073259354, 0.6339074373245239, -0.3545342981815338, 0.2817126214504242, 0.30887094140052795, -0.437704861164093, 0.2250133752822876, 0.7528290152549744, -0.9268209934234619, 0.20580275356769562, 0.18808302283287048, 0.31332600116729736, 0.5314027667045593, 0.7732049822807312, 0.8828561305999756, 0.8215305805206299, -0.32880493998527527, 0.325029194355011, 0.06511713564395905, 0.8351696729660034, -0.3276933431625366, 0.1984160840511322, 0.28396764397621155, -0.9688526391983032, -0.4181329607963562, -0.45283615589141846, -1.150928258895874, 0.6266530156135559, 0.1388077586889267, -0.20983800292015076, -0.48228147625923157, -0.08745913952589035, 0.7469783425331116, -0.10517114400863647, 0.21329909563064575, -0.6515228152275085, 0.8565033674240112, 0.39941078424453735, 0.08412272483110428, 0.1898057758808136, 0.32089316844940186, 0.18017466366291046, -0.00466917036101222, 0.12414120882749557, 0.18346431851387024, 0.23976905643939972, -0.08915997296571732, -0.37108245491981506, -0.2044147551059723, -0.24354733526706696, -0.47190332412719727, 0.017203249037265778, 0.5383630990982056, 0.5259462594985962, 0.32872286438941956, -0.43983766436576843, 0.14541585743427277, 0.49778062105178833, 0.28873035311698914, -0.3732772767543793, 0.06572666764259338, 0.4565804600715637, -0.0728611946105957, 0.46363434195518494, 0.0733257606625557, 0.05677945539355278, -0.38033661246299744, -0.957022488117218, -0.22896000742912292, 0.3042719066143036, -0.8906013369560242, -0.7895140051841736, 1.0106215476989746, -0.16386835277080536, -0.1333799511194229, -0.04221131280064583, -0.9458087086677551, -0.38418006896972656, 0.23289145529270172, -1.5392850637435913, -0.6037082672119141, 0.23451200127601624, -0.18047021329402924, -0.5547725558280945, 0.2841534912586212, 1.2644628286361694, 0.23813533782958984, -0.6257562041282654, -0.2143360674381256, 0.12310101091861725, 0.18556161224842072, -0.1374744027853012, -0.89323490858078, 0.7373203635215759, 0.5477275848388672, -0.11307400465011597, 0.4619176387786865, -0.15963420271873474, -0.24177278578281403, -0.6320600509643555, -0.12147108465433121, 1.0670347213745117, -0.9229418039321899, -0.1734752506017685, -0.9389553070068359, -1.0669845342636108, 0.5082531571388245, 0.946394145488739, -0.3621271848678589, 0.5320348739624023, 0.20383219420909882, -0.6146508455276489, -0.5151486396789551, -0.4240434467792511, 0.08107646554708481, 0.8319372534751892, -0.9615709185600281, -0.48726409673690796, -0.3373323082923889, 0.7321265339851379, -0.7082788944244385, -0.29519200325012207, 0.007399342022836208, -0.10801929980516434, -0.07654903084039688, 0.8492710590362549, -0.34391963481903076, 0.805068850517273, 0.8538343906402588, -0.18128275871276855, -0.9519678354263306, -0.47450149059295654, -1.1100870370864868, 0.1945720911026001, 0.5371821522712708, 0.6435685753822327, -0.18682101368904114, -0.10428865998983383, 0.8700715899467468, 0.12559214234352112, -0.3717515170574188, -0.8797473311424255, -0.21286992728710175, -0.03900158777832985, -0.5318269729614258, 0.3740687966346741, 0.1314380168914795, 0.10336530208587646, 0.24529215693473816, 0.34803512692451477, 0.6342370510101318, -0.19014491140842438, -0.7820374965667725, 0.05116309970617294, -0.15840117633342743, 0.0738876610994339, -0.5010592937469482, -0.533200204372406, -1.057474970817566, 0.3082179129123688, -1.2350929975509644, 0.29709169268608093, -0.8762022852897644, -0.4175024628639221, 0.22747348248958588, -0.5318809747695923, -0.10322895646095276, 0.44461843371391296, -0.23737193644046783, -0.6069697141647339, -0.6543962955474854, -0.5550870299339294, 0.7298624515533447, 0.48125317692756653, -0.6064158082008362, -0.06874708086252213, -0.2956933379173279, -0.2642212510108948, 0.02922467142343521, 0.4831766188144684, -0.33773359656333923, -0.7589012384414673, -1.7114403247833252, 0.13305723667144775, -0.37093377113342285, -0.3281083405017853, -0.4602639377117157, 0.695051372051239, 0.41711416840553284, -0.42601874470710754, 0.07225017249584198, 0.19800494611263275, -0.7728135585784912, -0.5368465185165405, 0.29895010590553284, -0.7835909128189087, 0.6516309380531311, 0.16455046832561493, -0.4398971498012543, -0.2697348892688751, 0.8537573218345642, -0.29040780663490295, -1.174595594406128, -0.601940929889679, 0.3502592146396637, -0.8792576789855957, 0.023649975657463074, -0.16458742320537567, 0.11206479370594025, -1.19790780544281, -0.33424827456474304, -0.0031987372785806656, 0.4884347915649414, -0.508428692817688, 1.4797378778457642, 0.2110973447561264, -0.9582529067993164, 0.02287079580128193, 0.39300858974456787, -0.3260822594165802, -0.2340191751718521, 0.38373973965644836, 0.19098037481307983, -0.0673474371433258, 0.61944580078125, 0.4680863618850708, 0.2991638481616974, -1.019895076751709, 0.24307584762573242, 0.4454667866230011, -0.3490062654018402, -0.12242761254310608, 0.9853272438049316, -0.4859771132469177, -0.859719455242157, 0.2656365633010864, -1.3527390956878662, -0.8215641379356384, -0.22947095334529877, 0.6404505372047424, -0.05811399593949318, -0.3219430446624756, -0.3334227502346039, -0.596278190612793, 0.3449200689792633, -0.19642339646816254, -0.6855477094650269, 0.8684284687042236, -0.24851512908935547, -0.6994901895523071, 0.6490626335144043, 0.5235555171966553, -0.500566303730011, -0.5624279379844666, -0.5870496034622192, -0.1959497034549713, -0.06056039407849312, 0.3473031520843506, -0.35331621766090393, -0.5048893690109253, 0.975288987159729, 0.3042356073856354, 0.4990043342113495, -0.05713852494955063, -0.13462868332862854, 0.007214365527033806, 0.2734373211860657, 0.09577950090169907, -0.6565551161766052, -0.4415856599807739, 1.4895546436309814, 1.4511772394180298, -0.4758891761302948, 0.13435465097427368, -0.2841504216194153, -0.7614166140556335, 0.5717050433158875, 0.3582843840122223, 0.024444449692964554, 1.3378669023513794, 0.11602099239826202, 0.5405864119529724, 0.26656392216682434, -1.155856728553772, -0.5093858242034912, 0.531061589717865, 1.0656726360321045, 0.8350306153297424, 0.4365465044975281, 0.06558486074209213, 1.0031375885009766, 0.14646093547344208, -0.15617579221725464, 0.5141352415084839, 0.4626408517360687, -0.2100767195224762, -0.624846875667572, 0.33164462447166443, 0.2035321146249771, -0.7596769332885742, -0.699964702129364, -0.004171242006123066, 0.44353416562080383, 0.1575445830821991, 0.9933622479438782, 1.0773038864135742, -0.21970368921756744, 0.4994441568851471, 0.34560248255729675, 0.1738898605108261, -0.8569403886795044, -0.32104402780532837, 0.07250561565160751, -0.5437644124031067, -0.20360252261161804, -0.37431466579437256, -0.5866717100143433, -0.2802424728870392, -0.020791832357645035, 0.2989792823791504, 0.13964036107063293, 0.4093833863735199, 1.1641532182693481, 0.7794565558433533, 0.6055344343185425, 0.04139193147420883, -0.3082667291164398, -0.22975927591323853, -0.8918722867965698, -0.008475922979414463, -0.6425491571426392, -0.17107877135276794, -0.13438907265663147, -0.05154317989945412, -0.275993287563324]}, "authors": [{"authorId": "73698428", "name": "Manan A. Shah"}], "references": [{"paperId": null, "title": "Transformers: State-of-the-Art Natural Language Processing"}, {"paperId": "43f2ad297941db230c089ba353efc3f281ab678c", "title": "5\u5206\u3067\u5206\u304b\u308b!? \u6709\u540d\u8ad6\u6587\u30ca\u30ca\u30e1\u8aad\u307f\uff1aJacob Devlin et al. : BERT : Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "1cf1ec50e75f2c9f3064a411ea1428695a1df910", "title": "Fully Quantized Transformer for Improved Translation"}, {"paperId": "f6390beca54411b06f3bde424fb983a451789733", "title": "Adaptively Sparse Transformers"}, {"paperId": "e0c6abdbdecf04ffac65c440da77fb9d66bb474c", "title": "XLNet: Generalized Autoregressive Pretraining for Language Understanding"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "54a13bcc9613dcaa76fb25fbe96572f376cfcca9", "title": "Adafactor: Adaptive Learning Rates with Sublinear Memory Cost"}, {"paperId": "3a6d4cd0768ae8768e733280d362bdb4d25924e7", "title": "The Reversible Residual Network: Backpropagation Without Storing Activations"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "50645e3dc912d597e89d59bffb96ccc0f8e1aefa", "title": "Practical and Optimal LSH for Angular Distance"}, {"paperId": "e1fd15f879d7745ffeefa48725d06d4399325e7d", "title": "Perplexity of Index Models over Evolving Linked Data"}, {"paperId": "7e338a86996ca9d8438b949a3f421553a94e5966", "title": "Complexity of Word Collocation Networks: A Preliminary Structural Analysis"}, {"paperId": "12f735ae99dc5a1453409306da09331ad0d60aac", "title": "How the initialization affects the stability of the $k$-means algorithm"}, {"paperId": null, "title": "reformer-pytorch"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}]}