{"paperId": "3650f802699e9d04d337d0d466581683341b67e1", "title": "Partitioning-Guided K-Means: Extreme Empty Cluster Resolution for Extreme Model Compression", "abstract": "Compactness in deep learning can be critical to a model's viability in low-resource applications, and a common approach to extreme model compression is quantization. We consider Iterative Product Quantization (iPQ) with Quant-Noise to be state-of-the-art in this area, but this quantization framework suffers from preventable inference quality degradation due to prevalent empty clusters. In this paper, we propose several novel enhancements aiming to improve the accuracy of iPQ with Quant-Noise by focusing on resolving empty clusters. Our contribution, which we call Partitioning-Guided k-means (PG k-means), is a heavily augmented k-means implementation composed of three main components. First, we propose a partitioning-based pre-assignment strategy that ensures no initial empty clusters and encourages an even weight-to-cluster distribution. Second, we propose an empirically superior empty cluster resolution heuristic executed via cautious partitioning of large clusters. Finally, we construct an optional optimization step that consolidates intuitively dense clusters of weights to ensure shared representation. The proposed approach consistently reduces the number of empty clusters in iPQ with Quant-Noise by 100x on average, uses 8x fewer iterations during empty cluster resolution, and improves overall model accuracy by up to 12%, when applied to RoBERTa on a variety of tasks in the GLUE benchmark.", "venue": "arXiv.org", "year": 2023, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": {"url": "http://arxiv.org/pdf/2306.14031", "status": "CLOSED"}, "tldr": {"model": "tldr@v2.0.0", "text": "This paper proposes several novel enhancements aiming to improve the accuracy of iPQ with Quant-Noise by focusing on resolving empty clusters, and proposes a partitioning-based pre-assignment strategy that ensures no initial empty clusters and encourages an even weight-to-cluster distribution."}, "embedding": {"model": "specter_v2", "vector": [-0.023258479312062263, 0.8504186272621155, -0.7356461882591248, 0.24640779197216034, -0.41178998351097107, 0.42716461420059204, 0.36555546522140503, -0.04512502998113632, -0.41142547130584717, -0.6484026312828064, 0.5509090423583984, 0.2845674455165863, -0.11285372823476791, 0.17720359563827515, -0.11271125078201294, -0.13728520274162292, -0.8627463579177856, 0.37426331639289856, 0.028818441554903984, 0.03881211206316948, 0.14822103083133698, -0.7615328431129456, -1.288681149482727, 0.33061039447784424, 0.3296341896057129, 1.251189947128296, 0.06281868368387222, 0.7779312133789062, -0.6568958759307861, 0.2986566722393036, 0.4559357464313507, -0.42907944321632385, 0.32436323165893555, -0.07179537415504456, -0.33178699016571045, 0.09041832387447357, 0.2288750261068344, -0.20882180333137512, -0.3764829933643341, 0.9276356101036072, -0.1648133248090744, 0.3054727613925934, 0.6962165236473083, -0.9049499034881592, -0.23466214537620544, 0.8616514205932617, 0.3302953243255615, 0.5027861595153809, -0.9579880237579346, -0.7958906292915344, 1.3218052387237549, -1.3501611948013306, 0.06760812550783157, 1.2862766981124878, 0.7423610091209412, 0.15985259413719177, -0.6822311282157898, -0.6017282605171204, 0.5313607454299927, 0.3399307429790497, -1.2140276432037354, -0.32356828451156616, 0.06320994347333908, -0.020520228892564774, 1.837146520614624, -0.38126179575920105, -0.06447704136371613, 0.2985811233520508, 0.07389611005783081, 1.1523323059082031, -0.1251879334449768, -0.5878453850746155, 0.42000719904899597, 0.330144464969635, 0.25556084513664246, 0.6762822866439819, -0.39513760805130005, 0.5230592489242554, -0.9866797924041748, -0.2243468016386032, 0.12245859205722809, -0.013927490450441837, 0.33006560802459717, -0.3478018343448639, 0.3082011938095093, 0.6550307869911194, 0.43021392822265625, 0.2605263292789459, -0.33087417483329773, 1.0617362260818481, 0.5192202925682068, -0.10957654565572739, 0.15032702684402466, 0.3890300989151001, -0.1134360209107399, 0.15535621345043182, -1.174455165863037, 0.18659228086471558, 0.07246854156255722, 0.7948410511016846, -0.17466874420642853, 0.3529301881790161, -0.39490818977355957, 0.48013216257095337, 1.2755175828933716, -0.4351564943790436, 0.7617586851119995, -1.147735595703125, 0.21587727963924408, -0.5612314343452454, 0.08056847751140594, -0.740301251411438, -0.23616722226142883, -0.4762510359287262, -0.9438992738723755, -0.7221368551254272, -0.6857224106788635, 0.3339795470237732, -0.7184019088745117, 0.543820321559906, -0.4530057907104492, 0.6703384518623352, 0.21554674208164215, 0.4572220742702484, 0.30067795515060425, 0.623475968837738, 0.4748549163341522, 0.27453991770744324, 0.8874576091766357, -1.0230234861373901, -0.25634676218032837, -0.6755838990211487, 0.29881536960601807, 0.05475275591015816, 0.06669498234987259, 0.011321869678795338, -1.3424993753433228, -1.2796273231506348, -0.8759831190109253, 0.2725929319858551, -0.6550873517990112, 0.14020684361457825, 0.7147700190544128, 0.17483459413051605, -0.7389329671859741, 1.1506394147872925, -0.35901856422424316, -0.022031376138329506, 0.743843138217926, 0.3777850568294525, 0.566236674785614, 0.10510935634374619, -1.0238596200942993, -0.23968473076820374, 0.6980682015419006, -0.8080557584762573, -0.06332407146692276, -0.7935540676116943, -0.9187537431716919, 0.41556107997894287, 0.4704032838344574, -0.49857184290885925, 1.0459067821502686, 0.20492768287658691, -1.1724259853363037, 0.3911675810813904, 0.1433251053094864, -0.09935379773378372, 0.05193157121539116, 0.12629497051239014, -0.43985337018966675, 0.1069893166422844, -0.5114306807518005, 0.8558541536331177, 0.8953270316123962, -0.5477452874183655, -0.07518881559371948, 0.20712916553020477, -0.6313651204109192, -0.01797362044453621, -0.6090347766876221, 0.6974145174026489, -0.5444437861442566, -0.3414745628833771, 0.7036344408988953, 0.7771396040916443, -0.1652577966451645, -0.10901834070682526, -0.46354028582572937, -0.9965544939041138, 0.5767685174942017, 0.4204941689968109, 0.9962555766105652, -0.9782177209854126, -0.7351471781730652, 0.15625372529029846, 0.16678845882415771, -0.03264597803354263, -0.43449321389198303, 0.07191602140665054, -0.5758281350135803, 0.7064826488494873, -0.16700468957424164, -1.2811065912246704, 0.7234900593757629, -0.00035142269916832447, -0.7242746949195862, -0.5047931671142578, 0.29158473014831543, 1.0010453462600708, -0.7625345587730408, -0.21205711364746094, -0.18277516961097717, 0.22583293914794922, -1.0361930131912231, 0.8737785816192627, -0.4639695882797241, -0.31222108006477356, 0.019475571811199188, -0.2870807647705078, 0.24273963272571564, -0.4332128167152405, 0.2606309652328491, -0.38538792729377747, 0.22662998735904694, 0.5012004375457764, -0.9041095972061157, 1.1227577924728394, -0.11351577192544937, -0.07236282527446747, -0.20864291489124298, -0.6831912994384766, 0.1646135300397873, 0.290107786655426, 0.07307291030883789, -0.4039645195007324, 0.41472378373146057, 0.25218120217323303, -0.6801449656486511, 0.3376975357532501, 1.149755597114563, 0.6485297083854675, -0.4836874306201935, 0.24171875417232513, 0.8598166704177856, -0.5330777168273926, 0.6276000142097473, 0.3744644820690155, 0.3970077931880951, 0.5106761455535889, 0.11694033443927765, -0.046545255929231644, -0.18913301825523376, -0.7851800322532654, 0.2448963224887848, 0.6221059560775757, 0.4755038321018219, 1.1317311525344849, 0.6776583790779114, -0.662701427936554, -0.762804388999939, -0.10572992265224457, 0.34350618720054626, 1.2677470445632935, -0.1267406940460205, -0.623506486415863, -0.8747418522834778, -0.4362070858478546, -0.2213800996541977, 0.029229091480374336, -0.4184970557689667, -0.5569887161254883, 0.019712746143341064, -1.4098457098007202, 0.8147991895675659, 0.3667450249195099, 0.8919062614440918, -0.4626074433326721, -0.23979872465133667, -0.2555915415287018, 0.4801839590072632, -0.5842801332473755, -0.24875131249427795, 0.9648407697677612, -0.4014417231082916, -0.1583520472049713, 0.42654356360435486, 0.256120890378952, 0.26882970333099365, -0.9018449187278748, 1.239576816558838, -0.5741060376167297, -0.477356493473053, -0.057752545922994614, 0.45974740386009216, -0.617876410484314, -0.7250451445579529, 0.17978455126285553, 0.10387884825468063, -0.3377660810947418, 0.6985126733779907, 0.2592182457447052, -0.005678542423993349, -0.004050876945257187, -0.4923582375049591, 0.03270812705159187, -0.0525512732565403, -0.1024269163608551, 1.1611077785491943, 0.13794703781604767, -0.032480522990226746, -0.9090423583984375, 0.8959670662879944, -0.2512975335121155, -0.27853870391845703, -0.18792815506458282, -0.8151039481163025, -0.2012731432914734, 0.8622193336486816, -0.4472644031047821, -0.05203736200928688, -0.8781899213790894, 0.310359925031662, -0.9264301657676697, -0.49089691042900085, -0.03344680741429329, 0.46137115359306335, 0.21887589991092682, 0.5951963067054749, 0.27727940678596497, 0.10483555495738983, -0.06588362157344818, 0.6667964458465576, -0.7014957070350647, 0.8655005693435669, -0.035646628588438034, -0.3721294403076172, -0.27282917499542236, -0.09470769762992859, -0.5253363251686096, -0.1884946972131729, -0.4688812494277954, -0.21257677674293518, 0.054544076323509216, 0.30212169885635376, -0.5284221172332764, -0.547170877456665, -0.2541619539260864, -0.29666393995285034, -0.3203568160533905, -0.5415877103805542, -0.24316348135471344, -0.6861048936843872, -0.9591813087463379, -1.2886343002319336, -0.29771506786346436, -0.6725566387176514, -1.1898193359375, 0.48022034764289856, 0.10805048048496246, -0.5163919925689697, -0.28920871019363403, -0.43284109234809875, -0.6683496236801147, 0.7756673693656921, -0.7749862670898438, 0.7847505807876587, -0.07598628103733063, 0.052097566425800323, 0.051500603556632996, -0.14294132590293884, 0.8145432472229004, -0.5819410681724548, 0.24639731645584106, -0.6009409427642822, 0.639151394367218, -0.2543696463108063, -0.4480142295360565, 0.4656727612018585, 0.046106476336717606, 1.2144107818603516, 0.029298068955540657, -0.33712267875671387, 0.7736626863479614, 1.4600096940994263, -1.0547518730163574, 0.2380913347005844, -0.23610016703605652, 0.7946589589118958, 0.009496348910033703, -0.3330116271972656, 0.8897876739501953, 0.1299925297498703, 0.2636077105998993, 0.46782419085502625, -0.03174162656068802, -0.4769749343395233, -0.29879283905029297, -0.0559171661734581, 1.6651170253753662, 0.6867436170578003, 0.21294578909873962, -0.7427511811256409, 0.8727113604545593, -1.1362841129302979, -0.5874654650688171, 0.7766084671020508, 0.5990304946899414, 0.215624138712883, -0.33437809348106384, -0.381862074136734, -0.16131028532981873, 0.20731021463871002, 0.14532345533370972, -0.3477746546268463, -0.8611049652099609, 0.4746861159801483, 0.6716031432151794, 0.324409544467926, 0.3554758131504059, -0.39180901646614075, 0.22074204683303833, 14.974480628967285, 1.1242073774337769, 0.2289719134569168, 0.32431334257125854, 1.041260838508606, 0.17757952213287354, -0.22591012716293335, -0.3188270032405853, -1.21470308303833, 0.41796162724494934, 1.606302261352539, 0.3491332232952118, 0.4530787467956543, 0.5009909272193909, -0.09394814074039459, 0.20777949690818787, -0.30802324414253235, 0.7759926915168762, 0.37166890501976013, -1.3469736576080322, 0.21391409635543823, 0.1424323469400406, 0.6925556659698486, 0.5889664888381958, 0.8667023777961731, 0.8728007078170776, 0.55802321434021, -0.4549483358860016, 0.4881623685359955, 0.5761092305183411, 0.7219163775444031, -0.7200998663902283, 0.428110271692276, 0.503313422203064, -0.8301712870597839, -0.35757213830947876, -1.1094788312911987, -0.770538866519928, 0.025947391986846924, 0.2040049433708191, -0.4149346649646759, -0.2852080166339874, 0.12808933854103088, 0.4458410143852234, 0.01186847873032093, 0.27258795499801636, 0.0672716274857521, 0.5150805711746216, -0.5281956791877747, 0.49989795684814453, 0.4027954638004303, 0.15511202812194824, -0.28857097029685974, 0.034199997782707214, 0.13221846520900726, -0.2788736820220947, 0.5685874223709106, 0.7554066777229309, -0.5099254250526428, -0.30720895528793335, -0.07523717731237411, 0.08956693112850189, -0.10273629426956177, 0.906646728515625, 0.2144712209701538, -0.15203918516635895, -0.298565536737442, 0.5517652630805969, 0.7844574451446533, 0.23117481172084808, -0.2683981657028198, -0.2757335305213928, 0.42280903458595276, -0.5960772633552551, 0.2904723882675171, 0.8858535885810852, -0.43221962451934814, -0.045211311429739, -0.9753134846687317, 0.018745658919215202, 0.38329899311065674, -0.7964326739311218, -0.6489272713661194, 0.6934568285942078, -0.01991947367787361, -0.5692893266677856, -0.1393117606639862, -0.637061357498169, -0.057051319628953934, 0.35292136669158936, -1.1442946195602417, -0.1577400118112564, 0.14376483857631683, -0.6092599630355835, -0.6098926663398743, -0.055838584899902344, 1.4510741233825684, 0.04366759583353996, -0.3794177770614624, 0.0971527025103569, 0.39217159152030945, -0.25155672430992126, -0.31422755122184753, -1.1374523639678955, 0.9091561436653137, 0.0013110085856169462, 0.018287433311343193, 0.24597305059432983, -0.2811655104160309, 0.5828530788421631, -0.0976940244436264, -0.5250179171562195, 0.2074112594127655, -0.47321999073028564, -0.3092823624610901, -0.49306729435920715, -0.8186581134796143, -0.016805823892354965, 0.32385915517807007, 0.5035247802734375, 0.8707948923110962, -0.019030611962080002, -0.5999709367752075, 0.018603038042783737, -0.9376094937324524, -0.07620309293270111, 0.21590258181095123, -0.7180050015449524, -0.36844107508659363, -0.18861380219459534, 0.24977393448352814, -0.7647457122802734, -1.040418267250061, -0.16349348425865173, -0.07172337919473648, -0.3675459623336792, 1.2202730178833008, -0.34512847661972046, 1.042602300643921, 0.6819918751716614, -0.3524830639362335, -0.8983451128005981, -0.23258104920387268, -0.743655264377594, -0.38790521025657654, 0.06826073676347733, 0.3863663673400879, 0.008717384189367294, 0.7986036539077759, 0.8311246633529663, -0.0468866191804409, -0.7317959070205688, -0.48073896765708923, -0.09771377593278885, 0.02350342459976673, -0.8496198654174805, 0.23349905014038086, -0.19323378801345825, 0.1769830286502838, -0.17620301246643066, 0.8278018236160278, 0.38726896047592163, 0.12789738178253174, -0.6667604446411133, 0.12828050553798676, 0.10250673443078995, -0.3904227316379547, -0.6107030510902405, -0.6933876276016235, -1.366191029548645, -0.025757258757948875, -1.4132813215255737, -0.026080308482050896, -0.6260225772857666, -0.4240649342536926, -0.053966931998729706, -0.8178796172142029, -0.23623956739902496, 0.3292500972747803, 0.4352559745311737, -0.23164591193199158, -0.43017521500587463, -1.0596537590026855, 0.7016620635986328, 0.4422254264354706, -0.5568870902061462, -0.08690806478261948, -0.3779379427433014, -0.2490096539258957, 0.5692024230957031, 0.6734485030174255, -0.5935052633285522, -0.8907265663146973, -0.6799299120903015, 0.3532275855541229, -0.46711766719818115, -0.09057898819446564, -1.178245186805725, 0.674700915813446, 0.7051135897636414, 0.06371601670980453, -0.09676218032836914, 0.34713253378868103, -1.1048189401626587, -0.3476656377315521, 0.11106285452842712, -0.7924531102180481, -0.38041210174560547, 0.19192691147327423, -0.34328600764274597, -0.46913135051727295, 0.1935591697692871, 0.23660653829574585, -1.1206743717193604, -0.8769871592521667, 0.34594637155532837, -0.343245267868042, 0.1363760381937027, -0.4520637094974518, -0.2894708812236786, -0.8926286101341248, 0.15828660130500793, -0.46694833040237427, 0.2758440673351288, -0.16305950284004211, 0.7582684755325317, 0.4333406984806061, -1.3735730648040771, 0.42140716314315796, 0.4494612216949463, 0.13241168856620789, 0.2254929542541504, 0.4353589713573456, 0.4082132577896118, -0.2575017511844635, 0.08352357894182205, 0.3324604630470276, 0.3100244104862213, -0.43824103474617004, 0.21803809702396393, 0.7215057015419006, -0.5595191717147827, -0.3976604640483856, 1.1448713541030884, -0.45830583572387695, -1.0912024974822998, 0.33349189162254333, -1.4077774286270142, -0.4665243625640869, -0.20847009122371674, 0.9862267971038818, 0.4118180572986603, 0.06667699664831161, -0.009272182360291481, -0.2381027340888977, 0.1979522407054901, -0.26135802268981934, -0.19308073818683624, 0.4302929937839508, -0.11293210834264755, -0.4426211714744568, 0.548475444316864, 1.0701892375946045, -1.203847885131836, -1.0926392078399658, -0.6701736450195312, -0.4052715599536896, -0.18798236548900604, 0.37447187304496765, -0.3355109989643097, -0.6010324954986572, 0.6435508728027344, 0.7243911623954773, 0.34816697239875793, 0.17720003426074982, -0.14343300461769104, 0.19417768716812134, 0.7381404042243958, -0.07850918918848038, -1.308807373046875, -0.2909117043018341, 0.8270476460456848, 0.9321594834327698, -0.6140724420547485, 0.4605252146720886, -0.11831175535917282, -0.6590878367424011, 0.6935015320777893, 0.101339191198349, -0.24164116382598877, 0.9224402904510498, 0.14867305755615234, -0.1504444181919098, -0.14454005658626556, -1.1447466611862183, -0.35446739196777344, 0.7382339835166931, 1.0203031301498413, 0.23388607800006866, 0.25312191247940063, 0.48403802514076233, 1.2268675565719604, -0.05181731656193733, -0.12083878368139267, 0.35424095392227173, 0.09757430106401443, -0.47065219283103943, 0.25167208909988403, -0.06678543984889984, 1.0696460008621216, -0.9652918577194214, -0.4868182837963104, 0.31136834621429443, 0.4747104346752167, 0.5875689387321472, 0.6896091103553772, 1.1534713506698608, -0.22319401800632477, 0.2572450041770935, 0.2746486961841583, 0.28742945194244385, -0.3722124993801117, -0.1781633049249649, -0.03294941037893295, -0.8507294058799744, -0.39071834087371826, 0.006356303580105305, -0.06648816168308258, -0.8218995332717896, -0.11390865594148636, 0.45579373836517334, 0.1591312438249588, 0.40685197710990906, 0.6148059964179993, 0.8681648969650269, 1.0664916038513184, -0.22933082282543182, -0.708678126335144, -0.7109411358833313, -0.8419215679168701, -0.6025043725967407, -0.16917571425437927, -0.5841825008392334, -0.08520519733428955, -0.2568519413471222, -0.16109655797481537]}, "authors": [{"authorId": "2193459907", "name": "Tianhong Huang"}, {"authorId": "2214580025", "name": "Victor Agostinelli"}, {"authorId": "2135229505", "name": "Lizhong Chen"}], "references": [{"paperId": "36ea027d9521ac710b09fcda9caaf552f744d323", "title": "Coordinate Descent Method for <inline-formula><tex-math notation=\"LaTeX\">$k$</tex-math><alternatives><mml:math><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href=\"xue-ieq1-3085739.gif\"/></alternatives></inline-formula>-means"}, {"paperId": "43b13a2c0584363efb179f2dd822040957408a68", "title": "A Hybrid Genetic XK-means++ Clustering Algorithm with Empty Cluster Reassignment"}, {"paperId": "cfb5549c36b4d673cb509fee066579d4fd581daf", "title": "SimulMT to SimulST: Adapting Simultaneous Text Translation to End-to-End Simultaneous Speech Translation"}, {"paperId": "f83866ad21d14f684b9807f4c15f405e671c8f6e", "title": "Initializing k-means Clustering by Bootstrap and Data Depth"}, {"paperId": "0171ad4cc87cc7db25b4ec3169e293eed9a13b39", "title": "Training with Quantization Noise for Extreme Model Compression"}, {"paperId": "a54b56af24bb4873ed0163b77df63b92bd018ddc", "title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter"}, {"paperId": "0cbf97173391b0430140117027edcaf1a37968c7", "title": "TinyBERT: Distilling BERT for Natural Language Understanding"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "adce96bdd3f3093a90933f288106b67f20e094f6", "title": "And the Bit Goes Down: Revisiting the Quantization of Neural Networks"}, {"paperId": "faadd7d081c8d67e8c2567e8a5579e46cd6b2280", "title": "fairseq: A Fast, Extensible Toolkit for Sequence Modeling"}, {"paperId": "ac4dafdef1d2b685b7f28a11837414573d39ff4e", "title": "Universal Transformers"}, {"paperId": "59d0d7ccec2db66cad20cac5721ce54a8a058294", "title": "Quantization and Training of Neural Networks for Efficient Integer-Arithmetic-Only Inference"}, {"paperId": "994dccb83e1dda3f80021882cbe96d23f86c48b1", "title": "On Strategies to Fix Degenerate k-means Solutions"}, {"paperId": "123ae35aa7d6838c817072032ce5615bb891652d", "title": "BinaryNet: Training Deep Neural Networks with Weights and Activations Constrained to +1 or -1"}, {"paperId": "a5733ff08daff727af834345b9cfff1d0aa109ec", "title": "BinaryConnect: Training Deep Neural Networks with binary weights during propagations"}, {"paperId": "0c908739fbff75f03469d13d4a1a07de3414ee19", "title": "Distilling the Knowledge in a Neural Network"}, {"paperId": "b7cf49e30355633af2db19f35189410c8515e91f", "title": "Deep Learning with Limited Numerical Precision"}, {"paperId": "62c76ca0b2790c34e85ba1cce09d47be317c7235", "title": "Estimating or Propagating Gradients Through Stochastic Neurons for Conditional Computation"}, {"paperId": "e7297db245c3feb1897720b173a59fe7e36babb7", "title": "Optimal Brain Damage"}, {"paperId": null, "title": "Least square quantization in pcm"}]}