{"paperId": "0da3cefb4e15347760f64f5045a34b38515ef0f0", "title": "Funnel Vision Transformer for image classification", "abstract": "Vision Transformer(ViT) [6] adopts the Transformer architecture on the image classification tasks and outperforms the state-of-the-art convolutional networks with substantially fewer computational resources. However, it\u2019s still expensive to train Transformer either on a very large pre-training dataset or with a large model size. So model efficiency is still an important area to explore. Spatial compression is a common technique widely used in convolutional networks for image classification tasks, which indicates the spatial information redundancy for classification tasks. In addition, inspired by the success of Funnel-Transformer [4] in NLP, this project examines a similar idea on the ImageNet dataset that gradually shrink the image patch length dimension of Vision Transformer as the layers go deeper, in order to save the computational resources (Funnel-ViT). The results show that with with a small pre-training accuracy compromise ( < 1% ), we can save 40% memory, get 37.5% speedup with three funnel blocks, and get 0.6% fine-tuning accuracy improvement. The saved resources can even be re-invested to a wider and deeper Funnel-ViT model to further reduce the pre-training accuracy loss to 0.1%.", "venue": "", "year": 2022, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This project examines a similar idea on the ImageNet dataset that gradually shrink the image patch length dimension of Vision Transformer as the layers go deeper, in order to save the computational resources (Funnel-ViT), and shows that with with a small pre-training accuracy compromise, it can save 40% memory."}, "embedding": {"model": "specter_v2", "vector": [0.28917020559310913, 0.6648992896080017, -0.6908702850341797, 0.3121151030063629, -0.0015205610543489456, -0.0571468360722065, 0.7945543527603149, -0.38099756836891174, -0.38411983847618103, -0.47386980056762695, 0.5814865827560425, -0.2556900978088379, 0.379034161567688, -0.13997535407543182, -0.17406049370765686, -0.14744006097316742, -0.22913293540477753, -0.1229095309972763, 0.5246456265449524, 0.013046606443822384, 0.27639496326446533, -0.41737765073776245, -1.4806530475616455, 0.3755154013633728, 0.2212221324443817, 1.4784873723983765, 0.34917691349983215, 0.8788072466850281, -0.4439062774181366, 0.7392771244049072, 0.47036561369895935, -0.5443692803382874, 0.6681102514266968, 0.10604987293481827, -0.6822951436042786, 0.22345492243766785, 0.7666979432106018, -0.18162910640239716, -0.7643430233001709, 0.8798663020133972, -0.3468351364135742, 0.34832829236984253, 0.5650434494018555, -1.0131797790527344, -0.5529603362083435, -0.05372031033039093, 0.5464102029800415, 0.7557588815689087, -0.5968054533004761, -0.10023490339517593, 1.198191523551941, -1.0388628244400024, -0.049418456852436066, 1.1360927820205688, 0.6762389540672302, 0.3826005160808563, 0.0728612095117569, -0.5603165626525879, 0.1091681495308876, 0.36294183135032654, -0.19057528674602509, 0.047356702387332916, -0.009528662078082561, -0.341908723115921, 1.7372798919677734, -0.4715161919593811, 0.2284131497144699, 0.3446784019470215, 0.23354566097259521, 1.2674059867858887, 0.15894758701324463, -0.5491883754730225, -0.33092284202575684, -0.18521751463413239, 0.20959076285362244, 0.9755191206932068, -0.33274951577186584, 0.5411515235900879, -1.084441900253296, 0.009519530460238457, 0.6034342646598816, 0.3273375332355499, 0.22756528854370117, -0.15741710364818573, -0.08515749126672745, 0.7223617434501648, 1.1126725673675537, 0.6437574625015259, -0.1680786907672882, 0.7342491745948792, 0.6094703674316406, 0.22694125771522522, -0.18562713265419006, 0.5030069351196289, 0.16690024733543396, 0.8480064868927002, -0.5373545289039612, 0.2015983611345291, -0.386854887008667, 0.9378251433372498, -0.22231298685073853, 0.13791999220848083, -0.9133222103118896, 0.15942062437534332, 1.1279109716415405, -0.19402797520160675, 0.4260450303554535, -0.9617718458175659, 0.09330816566944122, -0.343087762594223, -0.2086893916130066, -0.5481610298156738, 0.22040502727031708, -0.475376695394516, -1.1491659879684448, -0.6398940682411194, -0.33852526545524597, 0.6554352045059204, -1.3812803030014038, 0.15840044617652893, -0.8610436320304871, 0.1387762725353241, 0.1593049168586731, 0.5908592343330383, 0.7406229972839355, 0.48256343603134155, 0.31100621819496155, 0.5605723261833191, 1.30143404006958, -1.5510716438293457, -0.2708943486213684, -1.0176732540130615, -0.14974229037761688, -0.3266719579696655, 0.46724098920822144, -0.27287349104881287, -0.9819421172142029, -1.210310935974121, -0.8993998765945435, -0.05150727927684784, -0.6153157949447632, -0.009705879725515842, 1.2053496837615967, 0.04083350673317909, -1.124752402305603, 1.0162523984909058, -0.07580531388521194, -0.4409022629261017, 0.9413160681724548, -0.16081677377223969, 0.30108997225761414, -0.39408570528030396, -0.8718273639678955, 0.42735135555267334, -0.029910871759057045, -0.7838047742843628, -0.6069653630256653, -0.6516984701156616, -0.8357470631599426, 0.28483355045318604, -0.07098092883825302, -0.8091279864311218, 1.313964605331421, -0.3730877935886383, -0.5748047232627869, 0.5457305312156677, -0.2554817795753479, 0.043052639812231064, 0.12960807979106903, 0.03423609212040901, 0.22874470055103302, -0.2219567596912384, 0.11939769238233566, 0.6583395004272461, 0.8856289982795715, -0.01733557879924774, -0.3502134382724762, 0.1816503256559372, -0.2356041967868805, -0.164260134100914, -0.4709942936897278, 0.7553524374961853, -0.3820994198322296, -0.30360138416290283, 0.249953031539917, 0.8126007914543152, -0.16686776280403137, 0.34760338068008423, 0.05865279957652092, -1.103681206703186, 1.0127642154693604, 0.23923295736312866, 0.28895303606987, -0.997124195098877, -0.9416539072990417, -0.32454225420951843, 0.1823720484972, 0.034100890159606934, -0.754314661026001, 0.23866021633148193, -0.38208359479904175, 0.21787604689598083, 0.05862303823232651, -0.8152255415916443, -0.2820799946784973, -0.2274257093667984, -0.8623160123825073, -0.2858048975467682, 0.3096395432949066, 1.1492050886154175, -0.6903303861618042, 0.013577459380030632, -0.30528607964515686, 0.3265807330608368, -1.080022931098938, 1.2113754749298096, -0.3604567050933838, -0.05904695764183998, 0.050829026848077774, 0.08731584995985031, 0.018182413652539253, -0.47328412532806396, -0.015513780526816845, -0.7243912816047668, 0.0507982037961483, 0.43834245204925537, 0.21418611705303192, 1.0291751623153687, 0.006507065612822771, 0.8953967690467834, -0.33419403433799744, -0.9957866668701172, 0.3793974220752716, 0.49457210302352905, -0.5029934048652649, -0.532141387462616, 0.3746907711029053, 0.19057366251945496, -0.9233067035675049, 0.21393437683582306, 0.7049217224121094, 0.7571015954017639, 0.058126311749219894, 0.02227175608277321, 0.8368990421295166, -0.3177858591079712, -0.05829562991857529, 0.18267479538917542, 0.7235010862350464, 0.1884475201368332, -0.11568395048379898, -0.16524216532707214, 0.014361312612891197, -0.5087440013885498, -0.188490629196167, 0.6358997225761414, 0.2589375376701355, 1.2025363445281982, 0.7752909064292908, -0.9122771620750427, -0.6467329263687134, -0.18662357330322266, 0.6374218463897705, 1.2208877801895142, 0.007617136929184198, -0.19356340169906616, -0.5766611695289612, -0.582709789276123, -0.3425321877002716, -0.7161173820495605, -0.45343130826950073, -0.5158857107162476, 0.11305011063814163, -0.9999560117721558, 1.220476508140564, 0.3618099093437195, 1.7810015678405762, -0.7067818641662598, -0.5185655355453491, -0.9828566908836365, 0.12598708271980286, -0.6154208779335022, -0.5111479163169861, 0.464126318693161, -0.704792857170105, -0.38857850432395935, -0.35502761602401733, -0.5577481985092163, 0.11599612981081009, -0.060969699174165726, 0.7160876393318176, -0.143738254904747, -0.6000058650970459, 0.005816277116537094, 0.5446987152099609, -0.6738235950469971, -0.27631238102912903, 0.06096642091870308, -0.25682374835014343, -0.29355987906455994, 0.1831885725259781, 0.32396242022514343, -0.24594761431217194, 0.23460231721401215, -0.5696727633476257, -0.3248096704483032, 0.1445683389902115, 0.2936800420284271, 0.8428099751472473, -0.24709974229335785, -0.34121042490005493, -0.40770047903060913, 1.0075279474258423, 0.41628900170326233, -0.4535788893699646, 0.03114907816052437, -0.9537492394447327, -0.15063919126987457, 0.26719367504119873, -0.5930748581886292, 0.09340392798185349, -0.9114951491355896, 0.5650938153266907, -0.9979502558708191, -0.038677845150232315, -0.057240892201662064, 0.5648891925811768, -0.19725945591926575, 0.8178941011428833, 0.3957137167453766, 0.6238332390785217, 0.10338480025529861, 0.4132853150367737, -0.646661639213562, 0.6649541854858398, 0.36641326546669006, 0.04968593269586563, -0.1516425460577011, 0.11869510263204575, -0.4579087495803833, -0.8493579030036926, -0.3503195345401764, 0.00811480637639761, -0.4545474350452423, 0.46877703070640564, -0.46553918719291687, -0.7515414953231812, 0.03733483701944351, -0.970458984375, -0.11918292194604874, -0.17146407067775726, -0.366142213344574, -0.38000643253326416, -1.1644712686538696, -0.8654619455337524, -0.13198105990886688, -0.6364326477050781, -1.2353763580322266, 0.23292332887649536, 0.4421041011810303, 0.18612167239189148, -0.17200201749801636, -0.5348015427589417, -0.0883033350110054, 1.2380595207214355, -0.5271040201187134, 0.9367020130157471, 0.0857272744178772, -0.5613711476325989, -0.03258947655558586, -0.7109100222587585, 0.7560244202613831, -0.35399624705314636, -0.182382732629776, -1.105437994003296, 0.420206755399704, -0.1613929122686386, -0.48030802607536316, 0.7114083766937256, 0.13758890330791473, 0.8786851167678833, -0.0685056820511818, -0.3538072407245636, 0.6748269200325012, 1.4247945547103882, -0.7434566617012024, 0.41526350378990173, 0.34953397512435913, 0.8720678091049194, 0.15736231207847595, -0.22711139917373657, 0.08575494587421417, 0.07132142037153244, -0.09098532050848007, 0.7345198392868042, -0.4095790684223175, -0.7816793322563171, -0.6474347710609436, 0.045664407312870026, 0.6175611019134521, 0.17001216113567352, 0.2915284335613251, -1.1433451175689697, 0.8342949748039246, -0.9757117629051208, -0.7662137150764465, 0.962500810623169, 0.4623958468437195, 0.05782758817076683, -0.43944820761680603, -0.2403354048728943, 0.10288595408201218, 0.5431246757507324, 0.7168411612510681, -0.08704084157943726, -0.6197935938835144, 0.28312167525291443, 0.4807191789150238, 0.8152481913566589, 0.5594222545623779, -0.2687150835990906, 0.5421971082687378, 14.840555191040039, 0.8403710722923279, -0.3551167845726013, 0.5202345252037048, 0.6281280517578125, 0.5873346328735352, -0.10939115285873413, 0.057702161371707916, -0.8734579086303711, -0.4240018129348755, 0.45984381437301636, 0.3196072578430176, 0.7438274025917053, 0.3781702518463135, -0.503018856048584, 0.25499311089515686, 0.01779695600271225, 0.8629470467567444, 0.5572739839553833, -1.7160793542861938, 0.49354344606399536, 0.3260476291179657, 0.24873392283916473, 0.7506587505340576, 1.025285243988037, 0.5431294441223145, 0.014330662786960602, -0.6115881204605103, 0.6352183818817139, 0.025143824517726898, 1.095206618309021, -0.13573035597801208, 0.499734103679657, 0.26312342286109924, -0.9966909885406494, -0.26511767506599426, -0.9829409122467041, -1.1636193990707397, -0.3867238461971283, -0.11784572899341583, -0.2849399149417877, -0.5954715609550476, 0.2698477804660797, 0.9782420992851257, -0.34427356719970703, 0.545483410358429, -0.29002872109413147, 0.3636082708835602, 0.18194404244422913, 0.04235566034913063, 0.6089794039726257, 0.57423996925354, 0.1931663602590561, -0.19256310164928436, 0.08632084727287292, -0.08714833110570908, -0.003466577734798193, 0.37313541769981384, -0.714106559753418, -0.49909061193466187, -0.6371766328811646, -0.19171413779258728, -0.5492488741874695, 0.6887616515159607, -0.010546714067459106, 0.44840294122695923, -0.30236077308654785, 0.11044551432132721, 0.4953004717826843, 0.33949053287506104, -0.3974345922470093, -0.5123185515403748, 0.393069863319397, 0.1671045422554016, 0.36229026317596436, 0.7344869375228882, -0.7257505059242249, -0.5432615280151367, -0.6635290384292603, -0.0837942361831665, 0.2635575830936432, -1.1007205247879028, -0.6531995534896851, 1.2226945161819458, -0.2946360111236572, -0.4849261939525604, 0.8740720748901367, -1.115450382232666, -0.56441330909729, 0.3685634136199951, -1.6581629514694214, -0.933840811252594, -0.3185541033744812, 0.044928472489118576, -0.31858623027801514, -0.3470723628997803, 0.8107644319534302, 0.07746351510286331, 0.32741010189056396, -0.039501797407865524, -0.5489485859870911, 0.15633361041545868, -0.2000856101512909, -0.7144128084182739, 0.6173416972160339, 0.23208631575107574, -0.11338457465171814, -0.1484399139881134, -0.1169455274939537, 0.3648589551448822, -0.22241292893886566, -0.4250151813030243, 0.5704827904701233, -0.40294402837753296, -0.38528648018836975, -0.4777875244617462, -0.7839154005050659, 0.11372677236795425, 0.778674840927124, 0.2731313407421112, 0.15724657475948334, -0.0323297418653965, -1.1385629177093506, -0.28753867745399475, -1.06850004196167, 0.22062981128692627, 0.5440848469734192, -0.9195000529289246, -0.48565489053726196, -0.07135690003633499, 0.5825899243354797, -0.6682648658752441, -0.31328076124191284, -0.11378122121095657, 0.31476667523384094, -0.5529076457023621, 1.133827567100525, -0.3936290442943573, 1.0057086944580078, 0.8885270953178406, -0.3436715006828308, -0.5273144841194153, -0.19264566898345947, -0.750420331954956, 0.595090925693512, 0.07314988970756531, 0.5808501243591309, -0.6538304090499878, 0.6978287100791931, 0.5359567999839783, 0.24311460554599762, -0.6104491949081421, -0.6227733492851257, -0.18986892700195312, -0.033597566187381744, -0.48345813155174255, 0.3356546461582184, -0.25398364663124084, -0.12385676056146622, 0.19040055572986603, 0.6194684505462646, 0.1619499921798706, 0.029808588325977325, -0.5344231724739075, 0.05265403911471367, -0.25024914741516113, -0.03542611747980118, -0.47774866223335266, -0.7869873046875, -1.3877482414245605, -0.2226933240890503, -1.4578733444213867, -0.13765870034694672, -1.081100583076477, -0.4221213161945343, 0.29973605275154114, -0.27630868554115295, 0.3285142481327057, 0.4489113390445709, 0.16120052337646484, 0.09191513806581497, -0.3150613009929657, -0.2932869493961334, 0.9347295165061951, 1.2746599912643433, -0.7764143943786621, 0.2597840428352356, -0.017487909644842148, -0.38349735736846924, 0.3779783844947815, 0.42628028988838196, -0.3992209732532501, -0.9207870364189148, -1.1024826765060425, -0.03669479489326477, -0.3129955232143402, 0.18424682319164276, -0.9618521928787231, 0.9088392853736877, 0.6378804445266724, 0.00987534411251545, 0.3017854690551758, 0.1945774108171463, -0.9429687857627869, -0.8411089777946472, 0.46333783864974976, -0.6124186515808105, 0.20080740749835968, 0.29393911361694336, -0.34524986147880554, -0.5218392014503479, 0.673616886138916, 0.5025986433029175, -1.015260934829712, -0.5807030200958252, 0.5600707530975342, -0.5518479943275452, 0.022656681016087532, -0.18445844948291779, -0.2379770427942276, -1.4197940826416016, -0.2200043797492981, 0.013880347833037376, 0.20407243072986603, -0.3639774024486542, 0.8351141214370728, 0.6884381771087646, -1.3960949182510376, 0.7203251719474792, 0.5659911632537842, -0.17416450381278992, 0.17495842278003693, 0.00037065017386339605, 0.41582363843917847, -0.497308611869812, 0.30821990966796875, -0.24240323901176453, 0.08698497712612152, -0.8118432760238647, 0.21770107746124268, 0.9558168649673462, -0.331381618976593, -0.2950016260147095, 1.0261061191558838, -0.20373864471912384, -0.9277376532554626, 0.49476924538612366, -1.1252309083938599, -0.537024199962616, -0.31533947587013245, 0.6579418778419495, 0.01064842939376831, -0.12889502942562103, 0.33451566100120544, -0.2965005338191986, 0.37250927090644836, 0.11881767213344574, -0.5294912457466125, 0.42648687958717346, 0.2238815277814865, -0.3748222887516022, 0.14912281930446625, 0.7773035168647766, -1.348703145980835, -1.2007920742034912, -0.6972686648368835, -0.35909563302993774, -0.6138129830360413, 0.3440752625465393, -0.20306651294231415, -0.9559635519981384, 0.881413459777832, 0.6625113487243652, 0.3752177953720093, 0.6506404876708984, 0.15261560678482056, 0.14265373349189758, 0.48921191692352295, -0.20707988739013672, -0.08108656853437424, -0.045604970306158066, 1.4110947847366333, 1.2463313341140747, -0.6129273772239685, 0.3326973021030426, -0.3901691734790802, -0.7090309262275696, 0.8013126254081726, 0.37281283736228943, -0.5703752040863037, 0.9865027070045471, -0.3451409637928009, -0.04738672077655792, -0.00013131143350619823, -0.9517498016357422, -0.3824198246002197, 0.830043375492096, 1.5407253503799438, 0.4256117343902588, -0.30135223269462585, 0.44748613238334656, 0.7261560559272766, 0.17993535101413727, 0.22453446686267853, 0.4886729419231415, 0.3722954988479614, -0.2686370015144348, 0.23481668531894684, -0.22628363966941833, 0.6643414497375488, -0.8114266395568848, -0.5027251839637756, 0.10898397117853165, 0.5686196088790894, 0.1837991625070572, 0.485828697681427, 0.8676832914352417, -0.32556289434432983, 0.9080328345298767, 0.0050208596512675285, 0.6269738078117371, -0.3255816102027893, -0.4264962077140808, -0.23056751489639282, -1.09511399269104, -0.40123847126960754, -0.314095139503479, -0.4046492874622345, 0.048381783068180084, -0.19739237427711487, 0.583611011505127, 0.16361400485038757, 0.3167974650859833, 0.674289345741272, 0.3983463943004608, 0.708672285079956, -0.3984506130218506, -0.6489356160163879, -0.17988234758377075, -0.9572741985321045, 0.2281796783208847, -0.8542840480804443, 0.1834239363670349, -0.5105764269828796, -0.4057396352291107, -0.1082160547375679]}, "authors": [{"authorId": "2286861993", "name": "Yujing Zhang"}], "references": [{"paperId": "268d347e8a55b5eb82fb5e7d2f800e33c75ab18a", "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale"}, {"paperId": "4ca3b0ea12f02e2dea01a4aa505956bae5500a09", "title": "Funnel-Transformer: Filtering out Sequential Redundancy for Efficient Language Processing"}, {"paperId": "a0185d4f32dde88aa1749f3a8000ed4721787b65", "title": "Visual Transformers: Token-based Image Representation and Processing for Computer Vision"}, {"paperId": "bb713d56a39a040b35e4f9e036fb4422f543e614", "title": "On the Relationship between Self-Attention and Convolutional Layers"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "1db9bd18681b96473f3c82b21edc9240b44dc329", "title": "Image Transformer"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "9c9d7247f8c51ec5a02b0d911d1d7b9e8160495d", "title": "TensorFlow: Large-Scale Machine Learning on Heterogeneous Distributed Systems"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "e15cf50aa89fee8535703b9f9512fca5bfc43327", "title": "Going deeper with convolutions"}, {"paperId": "eb42cf88027de515750f230b23b1a057dc782108", "title": "Very Deep Convolutional Networks for Large-Scale Image Recognition"}, {"paperId": "d2c733e34d48784a37d717fe43d9e93277a8c53e", "title": "ImageNet: A large-scale hierarchical image database"}, {"paperId": "bea5780d621e669e8069f05d0f2fc0db9df4b50f", "title": "Convolutional Deep Belief Networks on CIFAR-10"}]}