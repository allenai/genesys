{"paperId": "a30ac45ac5b7bd2148d3fb80ee7f3c29724e3170", "title": "How to Train Your HiPPO: State Space Models with Generalized Orthogonal Basis Projections", "abstract": "Linear time-invariant state space models (SSM) are a classical model from engineering and statistics, that have recently been shown to be very promising in machine learning through the Structured State Space sequence model (S4). A core component of S4 involves initializing the SSM state matrix to a particular matrix called a HiPPO matrix, which was empirically important for S4's ability to handle long sequences. However, the specific matrix that S4 uses was actually derived in previous work for a particular time-varying dynamical system, and the use of this matrix as a time-invariant SSM had no known mathematical interpretation. Consequently, the theoretical mechanism by which S4 models long-range dependencies actually remains unexplained. We derive a more general and intuitive formulation of the HiPPO framework, which provides a simple mathematical interpretation of S4 as a decomposition onto exponentially-warped Legendre polynomials, explaining its ability to capture long dependencies. Our generalization introduces a theoretically rich class of SSMs that also lets us derive more intuitive S4 variants for other bases such as the Fourier basis, and explains other aspects of training S4, such as how to initialize the important timescale parameter. These insights improve S4's performance to 86% on the Long Range Arena benchmark, with 96% on the most difficult Path-X task.", "venue": "International Conference on Learning Representations", "year": 2022, "citationCount": 51, "influentialCitationCount": 4, "openAccessPdf": {"url": "http://arxiv.org/pdf/2206.12037", "status": "GREEN"}, "tldr": {"model": "tldr@v2.0.0", "text": "A more general and intuitive formulation of the HiPPO framework is derived, which provides a simple mathematical interpretation of S4 as a decomposition onto exponentially-warped Legendre polynomials, explaining its ability to capture long dependencies."}, "embedding": {"model": "specter_v2", "vector": [-0.07504598051309586, 0.1160544604063034, -0.17729923129081726, -0.16866979002952576, 0.2699391841888428, -0.3076106905937195, 0.7944556474685669, -0.6441279649734497, -0.17928944528102875, -0.34329527616500854, 0.43639668822288513, 0.0754590705037117, -0.09796632826328278, 0.2230929434299469, -0.19146566092967987, -0.4194703996181488, -1.4420199394226074, 0.09035490453243256, 0.27658477425575256, -0.4003525972366333, 0.12016379088163376, -0.19002477824687958, -0.6189861297607422, -0.5066259503364563, -0.040519729256629944, 0.6750132441520691, -0.3929327726364136, 1.0941214561462402, -0.046691685914993286, 0.2742287516593933, 0.3770325779914856, 0.2154509574174881, 0.7216991186141968, -0.12231945991516113, -0.20493243634700775, -0.39987707138061523, 0.11793199181556702, -0.21380148828029633, -1.1883643865585327, 0.34299004077911377, -0.6178982257843018, 0.48555609583854675, 0.7226187586784363, -0.9638283848762512, 0.2448999583721161, 0.12084384262561798, 0.7162417769432068, 1.075610637664795, -0.6297435760498047, -0.4934259057044983, 1.2215672731399536, -0.8166002631187439, 0.291918009519577, 1.0969340801239014, 1.011853814125061, 0.06352201104164124, -0.3189455568790436, -0.66289883852005, 0.05082995444536209, 0.26592493057250977, -0.5127621293067932, 0.09460532665252686, 0.03963803872466087, -0.37725627422332764, 1.0889886617660522, -0.5368292927742004, 0.28356826305389404, 1.0405712127685547, 0.4724414348602295, 0.7649750709533691, 0.4469703733921051, -0.5880725979804993, 0.2241203784942627, 0.1493379920721054, 0.6891642808914185, 0.42774033546447754, -0.4870232343673706, 0.8061656355857849, -1.2783169746398926, -0.07168079912662506, 0.18139830231666565, -0.09237262606620789, -0.06960508227348328, -0.40875256061553955, -0.7597591280937195, 0.7837520837783813, 0.620320200920105, 0.3018023669719696, -0.16840894520282745, 0.8446086645126343, 0.6206028461456299, 0.5778786540031433, -0.2836020588874817, 0.42262735962867737, -0.23552823066711426, 0.3475976586341858, -0.7157443165779114, 0.002986292587593198, 0.3611888289451599, 0.6594589948654175, 0.00992438942193985, 0.3866841495037079, -0.17579954862594604, -0.12406378984451294, 1.1673080921173096, -0.1938817799091339, 0.47542765736579895, -0.9163686633110046, -0.07984491437673569, -0.9057586789131165, 0.4283827543258667, -0.8790923357009888, -0.698428750038147, -0.7384815812110901, -0.6697202324867249, -1.0029730796813965, -0.40165555477142334, 0.16444772481918335, -0.48270559310913086, 0.7154204249382019, -0.07699226588010788, 0.5146387815475464, 0.3415455222129822, 0.3631986081600189, 0.1512550413608551, 0.9118191599845886, -0.14515823125839233, 0.18847820162773132, 0.48835015296936035, -0.9016463756561279, -0.441791296005249, -0.9631506204605103, -0.1313217729330063, 0.10764997452497482, -0.043117456138134, -0.3620356321334839, -0.7119073867797852, -1.157504916191101, -1.003822922706604, 0.6028144955635071, -0.1281328797340393, 0.08938882499933243, 1.348142385482788, -0.14006386697292328, -0.43705713748931885, 1.2990175485610962, -0.9236528277397156, -0.6888048648834229, -0.24885018169879913, -0.2933637797832489, 0.43727272748947144, 0.3830535113811493, -1.2137401103973389, 0.5691971182823181, 0.660493791103363, -0.6134116649627686, -0.40017208456993103, -0.4010159969329834, -0.6330929398536682, 0.26487213373184204, 0.0039809891022741795, -0.6115372776985168, 1.1378753185272217, 0.4675532579421997, -0.8814459443092346, -0.06350893527269363, 0.1398041695356369, -0.4040277898311615, 0.06649034470319748, 0.09629858285188675, -0.7251543402671814, 0.12816233932971954, -0.2524060606956482, 0.42087963223457336, 0.5074290633201599, -0.28656521439552307, 0.13478025794029236, 0.05581768602132797, -0.5955381393432617, -0.2730844020843506, -0.3131406009197235, 0.49420857429504395, -0.0550367645919323, -0.10970114171504974, 0.6721283197402954, -0.3817826509475708, -0.3013765215873718, 0.01694817654788494, 0.005649984814226627, -0.5233407020568848, 0.46134912967681885, -0.038946378976106644, 0.7646451592445374, -0.8957238793373108, -0.7103013396263123, 0.014923961833119392, -0.42611145973205566, -0.8055766224861145, -0.3064458668231964, 0.7593857645988464, -0.8267307877540588, -0.12250196933746338, -0.3931625485420227, -0.6710842251777649, -0.23834171891212463, 0.10008111596107483, -0.885359525680542, -0.0043031624518334866, -0.202596515417099, 0.8042444586753845, -0.9975117444992065, 0.38339000940322876, 0.19071394205093384, -0.12741674482822418, -0.5380493998527527, 0.8883059024810791, 0.15967097878456116, 0.3421280086040497, 0.2061806619167328, -0.4072595238685608, -0.30498066544532776, -0.5772358775138855, -0.12130647897720337, -0.3274877667427063, 0.11514396220445633, 0.4753477871417999, -0.45546454191207886, 1.6806879043579102, -0.058057334274053574, 0.935228168964386, -0.32433247566223145, -0.6384928226470947, 0.4021523594856262, 0.19662100076675415, 0.5598853230476379, -0.04603821039199829, 0.4336546063423157, 0.021188294515013695, -0.5610273480415344, 0.13457141816616058, 0.2694587707519531, 0.869970440864563, -0.3766578733921051, 0.31296879053115845, 0.6994094848632812, -0.5319052934646606, 0.20560654997825623, 0.6809610724449158, 0.5138708353042603, 0.4923577904701233, 0.4700711965560913, -0.23575076460838318, -0.0535714291036129, -0.6269014477729797, -0.047502461820840836, 0.19169795513153076, 0.22946129739284515, 0.7477906942367554, 0.1776496171951294, -0.9643502235412598, -0.5663323402404785, -0.519221842288971, 0.24777598679065704, 0.8150311708450317, 0.07394172996282578, -0.4668840765953064, -0.42767465114593506, 0.1984376460313797, -0.2495780885219574, 0.1996231973171234, -0.44293585419654846, -0.6272723078727722, -0.29408472776412964, -1.148738980293274, 0.5902312397956848, 0.21316693723201752, 1.024215579032898, -0.42519551515579224, -0.5482437610626221, -0.3289185166358948, 0.28193190693855286, -0.599588930606842, -0.6260378956794739, 0.701642632484436, -0.5527957081794739, -0.32469114661216736, 0.27277106046676636, 0.45439574122428894, -0.3686675429344177, -0.3926275372505188, 0.5285066366195679, -0.9943726062774658, -0.43119388818740845, 0.6899202466011047, 0.4050692617893219, -1.243405818939209, -0.5679616928100586, 0.13945099711418152, 0.6315286755561829, -0.176849827170372, -0.10223889350891113, -0.09667137265205383, -0.2245437651872635, 0.10897035896778107, -0.47373104095458984, 0.004035899415612221, -0.10808444768190384, 0.3565891981124878, 0.20440739393234253, -0.11361601948738098, -0.03126698359847069, -0.1656564474105835, 0.7473225593566895, 0.01741790398955345, -0.5471599698066711, 0.10339205712080002, -1.0536562204360962, 0.1268736571073532, 0.1580200046300888, -0.5400693416595459, 0.13701491057872772, -0.6855648159980774, 0.5991596579551697, -0.5149246454238892, -0.10483631491661072, 0.08974485099315643, 1.3320543766021729, -0.3232835531234741, 1.0168510675430298, 0.4397350549697876, 0.40052565932273865, 0.29940563440322876, 0.1394643932580948, -0.7833868861198425, 0.9677157402038574, 0.2917831540107727, 0.7529850006103516, 0.23367881774902344, 0.4650961458683014, -0.8898563385009766, -0.7244015336036682, -0.698917031288147, -0.6623140573501587, -0.5790842771530151, 0.3618689775466919, -0.49469348788261414, -0.7158635258674622, -0.19824634492397308, -0.6509098410606384, -0.2539944052696228, 0.16612783074378967, 0.22963804006576538, -0.5048359036445618, -0.7053640484809875, -0.9472593665122986, -0.5362866520881653, -0.5639168620109558, -0.5242149829864502, 0.1978321522474289, 0.35732302069664, -0.6807020306587219, -0.4285494387149811, 0.4419958293437958, -0.6135023832321167, 0.8857122659683228, -0.11495287716388702, 0.20664538443088531, 0.3261911869049072, -0.4331631064414978, -0.08809385448694229, 0.20768514275550842, 0.22117577493190765, -0.5370115041732788, 0.35219964385032654, -0.4854522943496704, 0.024903597310185432, -0.2398523986339569, -0.2527947723865509, 0.22761079668998718, 0.06985023617744446, 0.7782576680183411, 0.2707042694091797, -0.0234880018979311, 0.8204189538955688, 0.9462292194366455, -0.34438493847846985, -0.1885211020708084, 0.4265662729740143, 0.44413498044013977, 0.5615362524986267, -0.2198708951473236, 0.8458911180496216, 0.25171443819999695, 0.4059940278530121, 0.467430979013443, 0.3773173689842224, 0.15390419960021973, -0.5676666498184204, 0.5265731811523438, 1.4424617290496826, 0.14966008067131042, 0.6190800666809082, -0.7935260534286499, 0.3920825719833374, -0.9015225768089294, -0.7809207439422607, 0.4515717625617981, 0.9397302269935608, -0.24604254961013794, -0.33781808614730835, -0.33201834559440613, -0.1429440677165985, -0.05904963240027428, 0.571300745010376, -0.7680876851081848, -0.215504989027977, 0.14485116302967072, 0.29584649205207825, 0.44171619415283203, 0.2299196422100067, -0.7059981822967529, 0.14306101202964783, 15.434894561767578, 0.23046404123306274, -0.03689634054899216, 0.12343419343233109, -0.20792466402053833, 0.21021385490894318, 0.006988260895013809, 0.12668456137180328, -0.6886863708496094, 0.27869755029678345, 1.8512177467346191, -0.011874910444021225, 1.1014443635940552, 0.2670774757862091, -0.12555713951587677, 0.2891908288002014, -0.2848787307739258, 1.0709989070892334, 0.40367481112480164, -1.1607632637023926, -0.48836252093315125, 0.13026095926761627, 0.3003784120082855, 1.0569928884506226, 0.29419535398483276, 0.8098844289779663, 0.06880123913288116, 0.11864913254976273, 0.591403603553772, 0.26500365138053894, 0.6462885737419128, -0.06681803613901138, 0.022338928654789925, 0.5290055274963379, -1.3022387027740479, -0.26223546266555786, -0.5623925924301147, -0.7348120808601379, 0.6080994009971619, -0.24539245665073395, -0.4190214276313782, -0.09206957370042801, 0.3577699065208435, 0.8910602331161499, 0.14191730320453644, 0.5255244374275208, -0.19575878977775574, 0.4902552664279938, -0.41080519556999207, 0.3154127895832062, 0.3787939250469208, 0.15617747604846954, 0.5132503509521484, -0.48966100811958313, 0.2932908833026886, -0.13633695244789124, 0.05899617075920105, 0.4048103988170624, 0.12131237983703613, -0.46773311495780945, -0.42167001962661743, -0.4382130801677704, -0.2838433086872101, 0.8904827237129211, 0.22216777503490448, 0.2158670574426651, -0.03631187975406647, 0.3657711148262024, 0.05242021754384041, 0.507663369178772, -0.5156648755073547, -0.2894667088985443, 0.46536871790885925, -0.8350782990455627, -0.6611058115959167, -0.32899200916290283, -0.30945223569869995, -0.9482767581939697, -0.719495415687561, 0.04579544439911842, 0.3437383472919464, -1.1438696384429932, -0.7471969127655029, 0.9661886692047119, -0.06737462431192398, -0.9460306167602539, 0.47865015268325806, -0.8196382522583008, -0.5478774905204773, 0.24231675267219543, -1.0233654975891113, -0.0661950558423996, -0.42561423778533936, -0.16644077003002167, -0.029428886249661446, -0.27074986696243286, 1.1820240020751953, -0.24267834424972534, -0.41110190749168396, -0.5872715711593628, 0.3387426435947418, -0.5391572713851929, 0.23242978751659393, -0.9475481510162354, 1.1371278762817383, 0.3186960518360138, 0.16699036955833435, 0.5063470602035522, 0.49053049087524414, 0.21271321177482605, -0.3011624813079834, 0.1601586639881134, -0.11048836261034012, -1.1707481145858765, 0.5069326162338257, -0.4738787114620209, -1.1007856130599976, 0.3222038149833679, 0.32092541456222534, -0.17424537241458893, 0.20087085664272308, 0.040987953543663025, -0.5841256380081177, -0.2843644618988037, -0.2791442573070526, -0.09140577167272568, 0.40583324432373047, -0.9563553333282471, -0.8251405954360962, 0.15737347304821014, 0.2778785228729248, -0.7704023718833923, -0.7497237920761108, 0.0798039361834526, 0.5033616423606873, -0.3086986541748047, 1.4199079275131226, -0.7293744087219238, 0.4010935127735138, 0.684858500957489, -0.172137051820755, -1.1186498403549194, -0.06987322866916656, -0.7299700379371643, -0.2496820092201233, -0.5809941291809082, 0.09536755830049515, -0.9209349155426025, 0.49790892004966736, 0.4799816608428955, -0.11915106326341629, -0.14169016480445862, -0.3780304491519928, -0.7411181926727295, -0.6113666296005249, -0.482965350151062, 0.005537351593375206, -0.245122030377388, -0.28543856739997864, 0.20268002152442932, 0.05301104113459587, 1.0036802291870117, 0.11429568380117416, -0.46155551075935364, 0.6405029892921448, -0.48711782693862915, -0.6056596636772156, -0.05599919334053993, -0.4430442154407501, -1.1436716318130493, -0.19480861723423004, -1.3535165786743164, -0.1188846156001091, -0.4485035538673401, -0.6366997957229614, -0.02376999892294407, -0.4895116090774536, -0.4274936020374298, 0.7534480690956116, -0.5108625888824463, -0.26605790853500366, 0.02561313845217228, -0.19305211305618286, 1.1626352071762085, 0.549557089805603, -0.501132071018219, -0.13922660052776337, 0.25759416818618774, 0.5793632864952087, 0.43009912967681885, 0.6485284566879272, -0.5448009967803955, -0.5881001353263855, -0.6350275278091431, 0.2960832417011261, 0.16997775435447693, 0.05406136438250542, -1.3963418006896973, 0.6061370372772217, 0.32819634675979614, 0.07914047688245773, -0.3872857987880707, 0.7644201517105103, -1.1159884929656982, 0.10972786694765091, 0.5347924828529358, -0.5108578205108643, -0.057749055325984955, 0.15053623914718628, 0.060892995446920395, -0.04325089231133461, 0.6970346570014954, 0.17619511485099792, -0.7314368486404419, -0.5487240552902222, 0.5704948306083679, -0.3119772672653198, -0.5407373905181885, 0.02751126140356064, 0.05813680961728096, -0.9034569263458252, -0.3871152400970459, -0.4140443503856659, 0.538995087146759, -0.3060082197189331, 1.1443029642105103, -0.2443591058254242, -1.1589748859405518, 0.7130681872367859, 0.44474807381629944, 0.49240610003471375, -0.36714091897010803, 0.5574256777763367, 0.4375946819782257, -0.5581542253494263, 0.7713358998298645, -0.43045610189437866, -0.02025812678039074, -0.5338227152824402, 0.0046750386245548725, 0.6454874277114868, -0.007699255831539631, -0.21334263682365417, 0.7104599475860596, -0.29289522767066956, -1.2285734415054321, 0.12194492667913437, -0.8298740983009338, -0.5609599351882935, -0.18255804479122162, 0.3804360628128052, 0.6754165291786194, -0.4004421830177307, 0.12392262369394302, -0.3168790638446808, 0.5919138789176941, 0.46888333559036255, -0.49871155619621277, 0.5038464665412903, -0.47376421093940735, 0.16199471056461334, 1.3105169534683228, 0.914800763130188, -0.8738511204719543, -1.139008641242981, -0.5020913481712341, -0.2615538239479065, -0.1458783596754074, -0.11387807130813599, -0.035482317209243774, -0.18446514010429382, 0.7782657146453857, 0.915187418460846, 0.1640557199716568, 0.05182661861181259, -0.04640587419271469, 0.3753601908683777, 0.9691674113273621, 0.5103557705879211, -0.3709343373775482, -0.17666517198085785, 1.2241806983947754, 1.2995489835739136, -0.8393841981887817, 0.48991847038269043, -0.0014574152883142233, -0.4552153944969177, 1.157072901725769, 0.31433066725730896, -0.2554919719696045, 0.822902500629425, -0.9353896379470825, 0.09276791661977768, -0.1007232815027237, -0.7394581437110901, 0.2136577069759369, 0.8813769817352295, 0.5295434594154358, -0.15965458750724792, 0.45151087641716003, 0.19547826051712036, 0.4041995108127594, -0.5861486792564392, -0.24455329775810242, 0.5920213460922241, 0.38203665614128113, -0.275957316160202, 0.2530863881111145, -0.31801778078079224, 0.6992183327674866, -0.10916779190301895, 0.2674708664417267, 0.28909292817115784, 0.7353158593177795, -0.250875860452652, 0.05121345445513725, 0.7098455429077148, -0.09038230776786804, 0.4471127986907959, 0.3267962336540222, 0.4154224097728729, -0.3426498472690582, 0.23312440514564514, -0.2952989339828491, -0.6424476504325867, -0.3751133680343628, -0.004698964301496744, -0.7810245156288147, -0.4944033622741699, -0.006319349631667137, 0.380748450756073, 0.15726305544376373, 0.809722363948822, 0.7321441769599915, 0.5015647411346436, 0.7011452913284302, 0.06227096542716026, -1.0520795583724976, -0.7268922924995422, -0.8662696480751038, -0.09533082693815231, -0.6225563883781433, -0.020232198759913445, -0.5547957420349121, -0.7572598457336426, -0.29686611890792847]}, "authors": [{"authorId": "39499001", "name": "Albert Gu"}, {"authorId": "2135397895", "name": "Isys Johnson"}, {"authorId": "2173528923", "name": "Aman Timalsina"}, {"authorId": "1755572", "name": "A. Rudra"}, {"authorId": "1803218", "name": "Christopher R\u00e9"}], "references": [{"paperId": "240300b1da360f22bf0b82c6817eacebba6deed4", "title": "What Makes Convolutional Models Great on Long Sequence Modeling?"}, {"paperId": "6d7d141c75af752ffc0d8a6184cca3f9323d6c74", "title": "Simplified State Space Layers for Sequence Modeling"}, {"paperId": "ca444821352a4bd91884413d8070446e2960715a", "title": "On the Parameterization and Initialization of Diagonal State Space Models"}, {"paperId": "71e15a9a52dcafca57bff5f310b95e2c7d0cfc87", "title": "Diagonal State Spaces are as Effective as Structured State Spaces"}, {"paperId": "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51", "title": "Efficiently Modeling Long Sequences with Structured State Spaces"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "0964490205fdc38c2f0980c9d778069089ca92e3", "title": "HiPPO: Recurrent Memory with Optimal Polynomial Projections"}, {"paperId": "34eccf3528e4350543c76752cac978e0f2c5b7a2", "title": "Legendre Memory Units: Continuous-Time Representation in Recurrent Neural Networks"}, {"paperId": "c854390243603045dcf89ed7b33032664c77cd12", "title": "Dynamical Systems in Spiking Neuromorphic Hardware"}, {"paperId": "97fb4e3d45bb098e27e0071448b6152217bd35a5", "title": "Layer Normalization"}, {"paperId": "995c5f5e62614fcb4d2796ad2faab969da51713e", "title": "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift"}, {"paperId": "d6f2f611da110b5b5061731be3fc4c7f45d8ee23", "title": "Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification"}, {"paperId": "ea9d2a2b4ce11aaf85136840c65f3bc9c03ab649", "title": "Understanding the difficulty of training deep feedforward neural networks"}, {"paperId": "57923211710a9684f7156b8dc6ebd8dc0dba0e55", "title": "An Introduction to Orthogonal Polynomials"}, {"paperId": null, "title": "Combining recurrent, convolutional, and continuous-time models with the structured learnable linear state space layer"}, {"paperId": "0c36366413f08c6f635af6897627a3f113f6115a", "title": "Catformer: Designing Stable Transformers via Sensitivity Analysis"}, {"paperId": "3f3d13e95c25a8f6a753e38dfce88885097cbd43", "title": "Untersuchungen zu dynamischen neuronalen Netzen"}, {"paperId": null, "title": "It remains to show that the p n (ct) are orthonormal with respect to measure c\u03c9(ct): p j (ct)p k (ct)\u03c9(ct)"}, {"paperId": null, "title": "Note that orthonormality of a set of basis functions can be expressed as p(t)\u03c9(t)p(t) = I, so that (V p(t))\u03c9(t"}, {"paperId": null, "title": "The SSM kernels are e t(cA) (cB) = ce (ct)A) B = cp(ct)\u03c9(ct)"}]}