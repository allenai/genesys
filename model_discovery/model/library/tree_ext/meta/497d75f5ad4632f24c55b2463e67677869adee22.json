{"paperId": "497d75f5ad4632f24c55b2463e67677869adee22", "title": "Transformer Layers as Painters", "abstract": "Despite their nearly universal adoption for large language models, the internal workings of transformers are not well understood. We aim to better understand the impact of removing or reorganizing information throughout the layers of a pretrained transformer. Such an understanding could both yield better usage of existing models as well as to make architectural improvements to produce new variants. We present a series of empirical studies on frozen models that show that the lower and final layers of pretrained transformers differ from middle layers, but that middle layers have a surprising amount of uniformity. We further show that some classes of problems have robustness to skipping layers, running the layers in an order different from how they were trained, or running the layers in parallel. Our observations suggest that even frozen pretrained models may gracefully trade accuracy for latency by skipping layers or running layers in parallel.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A series of empirical studies on frozen models are presented that show that the lower and final layers of pretrained transformers differ from middle layers, but that middle layers have a surprising amount of uniformity."}, "embedding": {"model": "specter_v2", "vector": [0.09278487414121628, 0.6372929215431213, -0.3900752663612366, -0.17615477740764618, -0.3921095132827759, 0.02137867920100689, 0.4827306866645813, -0.4586568772792816, -0.410478413105011, -0.7555179595947266, 0.512138843536377, 0.0670764148235321, 0.4494519531726837, 0.2140355408191681, -0.1725027859210968, 0.32877692580223083, -0.9963242411613464, 0.23507846891880035, 0.2664550244808197, -0.5778635740280151, -0.47541287541389465, -0.31475383043289185, -0.8238548636436462, 0.3625749945640564, 0.2674884796142578, 0.6930107474327087, 0.1086406484246254, 0.5660125613212585, -0.5266181230545044, 0.6795860528945923, 0.5063247084617615, -0.4199196398258209, 0.13042758405208588, 0.33906060457229614, -0.22933587431907654, -0.03808842599391937, 0.5540987253189087, -0.35030466318130493, -0.311066210269928, 0.6969117522239685, -0.6075051426887512, -0.03172348812222481, -0.008422319777309895, -0.8712391257286072, -0.21995165944099426, 1.163195252418518, 0.6954202055931091, 0.6719791889190674, -0.4639592170715332, -0.7928304076194763, 1.3256875276565552, -1.5047990083694458, 0.167020782828331, 1.4903591871261597, 0.9053606986999512, 0.42338716983795166, -0.5817599296569824, -0.7071582078933716, 1.1516119241714478, -0.12519243359565735, -1.1037956476211548, -0.8155688643455505, 0.07380665838718414, 0.06901689618825912, 1.9275221824645996, -0.23066337406635284, 0.14384910464286804, 0.29054397344589233, 0.44377657771110535, 1.51923406124115, 0.12936602532863617, -0.5580244064331055, -0.6688158512115479, 0.3639555871486664, 0.3508121371269226, 1.093709111213684, -0.5187548995018005, 0.15072473883628845, -1.0271788835525513, -0.15524430572986603, 0.27891916036605835, 0.09492862224578857, 0.11267577111721039, -0.25036054849624634, -0.0032888788264244795, 0.5624474287033081, 0.6322062015533447, 0.9512913227081299, -0.3858503997325897, 0.6675952672958374, 0.25999200344085693, 0.4699198007583618, 0.15703292191028595, 0.20646530389785767, -0.23622570931911469, 0.8328778147697449, -1.150793433189392, 0.034632228314876556, 0.03485216572880745, 0.600756824016571, -0.03586474433541298, 0.1414540857076645, -0.6808279752731323, 0.32271847128868103, 1.4641956090927124, 0.0691419169306755, 0.2399597316980362, -0.6098212599754333, 0.3637111783027649, -0.733078122138977, -0.25623220205307007, -0.4670746922492981, -0.2100987583398819, -0.45232850313186646, -0.6634919047355652, -1.1872472763061523, -0.5572472810745239, 0.414739727973938, -1.1542905569076538, 0.8925654888153076, -0.5889285206794739, -0.01399181131273508, -0.2849980890750885, 0.169048011302948, 0.228279247879982, 0.5468550324440002, 0.5176064968109131, 0.2203984558582306, 0.9004196524620056, -0.939781904220581, -0.7667145133018494, -1.3123708963394165, 0.6863548159599304, -0.45044708251953125, 0.3727578818798065, 0.027256445959210396, -1.1583759784698486, -0.8781243562698364, -0.7685222625732422, 0.05859969183802605, -0.6789318323135376, -0.0008539483533240855, 1.13240647315979, 0.29895707964897156, -1.560551643371582, 0.9220515489578247, -0.4177156388759613, 0.13214221596717834, 0.6615443825721741, 0.36467379331588745, 0.18023976683616638, -0.2914484143257141, -1.1079797744750977, 0.3673792779445648, -0.11331599950790405, -0.3446103632450104, -0.19742803275585175, -0.7438655495643616, -0.951309859752655, 0.01234634779393673, 0.2350533902645111, -0.40151283144950867, 1.4652178287506104, -0.3469889760017395, -1.2843033075332642, 0.5913921594619751, -0.5389178395271301, 0.2223522961139679, -0.12019965052604675, -0.42125216126441956, -0.512535572052002, -0.40798062086105347, -0.36358514428138733, 0.48605212569236755, 0.8102259039878845, -0.37744179368019104, 0.03161828964948654, 0.04155360534787178, -0.16940529644489288, -0.18728908896446228, -0.1972576528787613, 1.137548804283142, -0.4537283480167389, -0.13944923877716064, 0.4190574586391449, 0.6438575983047485, -0.11532501876354218, -0.1482604593038559, -0.6298966407775879, -1.01339590549469, 0.6225950717926025, -0.32305362820625305, 1.2526110410690308, -1.1171064376831055, -0.47647523880004883, 0.12090349197387695, 0.11052267998456955, -0.2947675883769989, -0.90758216381073, 0.6797826886177063, -0.4762580692768097, 0.6153925657272339, 0.13402743637561798, -1.4182523488998413, 0.26031118631362915, -0.31409960985183716, -0.7135031223297119, -0.5844789147377014, 0.13815633952617645, 0.971653938293457, -0.49591895937919617, -0.12468993663787842, -0.16845808923244476, 0.8292611837387085, -0.7971119284629822, 1.1759982109069824, -0.06320611387491226, -0.4333849847316742, 0.12867669761180878, -0.04826478660106659, 0.06710673868656158, -0.2602231502532959, 0.29447680711746216, -0.5264254212379456, -0.05277925729751587, 0.7974493503570557, -0.1799124777317047, 1.2054402828216553, -0.49604901671409607, 0.29165366291999817, 0.1969892382621765, -0.24810434877872467, -0.23808994889259338, 0.3481646776199341, -0.31210196018218994, -0.3940199017524719, 0.2875514030456543, 0.5149340033531189, -0.6708360314369202, 1.0906153917312622, 1.075974702835083, 0.3850950598716736, -0.35001078248023987, -0.12485562264919281, 0.6642591953277588, -0.2580145001411438, 0.2540540397167206, 0.6470242142677307, 0.7516952157020569, 0.3288613259792328, -0.10673095285892487, -0.06850483268499374, 0.12354420870542526, -0.8405757546424866, -0.028567954897880554, 0.2358008176088333, 0.7291644215583801, 0.6874743103981018, 0.4353592097759247, -0.5499802827835083, -0.07041071355342865, -0.3029284179210663, 0.6513718962669373, 1.5850040912628174, -0.5505394339561462, -0.4631466865539551, -0.600077211856842, -0.28312909603118896, -0.5477890968322754, -0.08670756965875626, -0.39930596947669983, -0.04032402113080025, -0.584865927696228, -0.7402572631835938, 0.7009676694869995, 0.16537660360336304, 0.7044051885604858, -0.2625291347503662, -0.181990385055542, -0.37256380915641785, 0.49949324131011963, -0.8189425468444824, -0.5971705913543701, 0.7036043405532837, -0.8877297639846802, -0.08680135011672974, 0.12309812754392624, -0.18822802603244781, 0.11731190979480743, -0.5702105164527893, 1.0093395709991455, -0.10381772369146347, 0.1325041800737381, 0.10076804459095001, 0.7515882253646851, -0.3399430215358734, -0.6888660788536072, 0.3675301671028137, 0.23193949460983276, -0.09238622337579727, 0.0920274555683136, 0.5089992880821228, 0.05759749934077263, 0.05127177760004997, -0.32240718603134155, 0.3903433680534363, 0.2618217468261719, -0.20115524530410767, 0.6977790594100952, -0.09326964616775513, -0.3796262741088867, -1.6434136629104614, 0.9662691950798035, 0.42977479100227356, -0.3630288541316986, 0.43467944860458374, -0.702467679977417, -0.2521674633026123, 0.6327190399169922, -0.4551161527633667, -0.1533348113298416, -1.004624843597412, 0.2964629828929901, -0.5651503801345825, 0.33145540952682495, 0.08254650235176086, 0.2530158460140228, 0.18450360000133514, -0.11745670437812805, 0.32756543159484863, 0.16170339286327362, -0.43643638491630554, 0.3709765374660492, -0.9753647446632385, 0.27166491746902466, 0.431538850069046, 0.5917478799819946, -0.18845735490322113, -0.40282300114631653, -0.5802348852157593, -0.4274117946624756, -0.23282715678215027, 0.05843539535999298, -0.055783458054065704, 0.003635476343333721, -0.6542254090309143, -0.4126477539539337, 0.1358109712600708, -0.7151768207550049, -0.4724845290184021, 0.17143163084983826, -0.6979981660842896, 0.35154327750205994, -1.3564717769622803, -1.7265349626541138, -0.47759774327278137, -0.8170180916786194, -1.023495078086853, 0.5961694717407227, 0.04678777977824211, -0.2789117097854614, -0.5864402055740356, -0.2670958340167999, -0.43400707840919495, 1.3919310569763184, -0.820210337638855, 0.9991661906242371, 0.20259429514408112, -0.5603492259979248, -0.1431432068347931, 0.2552716135978699, 0.7682207822799683, -0.4415113627910614, 0.3788659870624542, -1.252504587173462, 0.15594689548015594, -0.36703261733055115, 0.06689327955245972, 0.24869243800640106, 0.32332614064216614, 0.5870962142944336, -0.22480972111225128, -0.6640668511390686, 0.46673062443733215, 1.3820843696594238, -0.9704426527023315, 0.3336551785469055, 0.17124472558498383, 0.892088770866394, 0.11455502361059189, -0.790054202079773, -0.019420981407165527, 0.442956805229187, 0.2549237608909607, 0.11268719285726547, -0.16937054693698883, -0.24958942830562592, -0.7833216786384583, 0.9187777638435364, 1.9747395515441895, 0.4666669964790344, 0.13529208302497864, -0.9485625624656677, 0.5146474838256836, -0.7095476984977722, -0.5291813611984253, 0.9534069299697876, 0.8543828129768372, 0.4117196798324585, -0.2006305456161499, -0.387192040681839, -0.036399394273757935, 0.2906077802181244, 0.6541732549667358, -0.1572888344526291, -0.9626823663711548, 0.20077292621135712, 0.8793541193008423, 0.37070682644844055, 0.8484273552894592, -0.15144503116607666, 0.7759976387023926, 14.650129318237305, 0.5584867596626282, -0.24202319979667664, 0.621690034866333, 0.6270573735237122, 0.23121027648448944, -0.5705681443214417, 0.1385086327791214, -1.2353382110595703, -0.24790561199188232, 1.251143217086792, 0.5337560772895813, 0.9591479301452637, -0.10523015260696411, -0.2864840030670166, 0.2987034022808075, -0.3913786709308624, 0.3692653477191925, 0.3049813508987427, -1.1181604862213135, 0.5367679595947266, 0.16194576025009155, -0.027042925357818604, 0.8138898015022278, 0.7195668816566467, 0.8498321771621704, 0.47822096943855286, -0.5159372687339783, 0.6926219463348389, 0.34745851159095764, 0.8891248106956482, -0.002730921609327197, 0.17092309892177582, 0.3089810907840729, -0.968031108379364, -0.09270097315311432, -0.09196645766496658, -1.1076594591140747, 0.15209883451461792, 0.07809922099113464, -0.5950441360473633, -0.7778574824333191, 0.06667087227106094, 0.6289902925491333, -0.48037853837013245, 0.14985720813274384, -0.2073301076889038, 0.7325171828269958, -0.7132851481437683, 0.456208199262619, 0.32095664739608765, 0.6929404735565186, -0.058746811002492905, -0.08004043996334076, -0.08137382566928864, -0.5309187769889832, 0.15488892793655396, 0.38598883152008057, -0.6315577030181885, -0.10934681445360184, -0.1367681324481964, -0.6175578832626343, -0.06322823464870453, 0.9630438685417175, 0.22326518595218658, 0.3297386169433594, -0.48590174317359924, 0.41636258363723755, 0.5912008881568909, 0.25216078758239746, -0.011838695034384727, 0.18521015346050262, 0.5147312879562378, 0.0819125771522522, -0.16882216930389404, 0.6214821934700012, 0.19909000396728516, -0.6326061487197876, -0.6821118593215942, -0.3037499487400055, 0.36697548627853394, -0.9153451919555664, -0.5779608488082886, 1.0240286588668823, -0.22496215999126434, -0.13410651683807373, 0.3548524081707001, -0.8768671154975891, -0.16194556653499603, 0.39373648166656494, -1.6972721815109253, -0.9450727105140686, 0.4399689733982086, -0.21571578085422516, -0.6465352773666382, 0.14266987144947052, 1.327865481376648, 0.1707509607076645, -0.39669615030288696, 0.2327796369791031, -0.21383661031723022, 0.3279901444911957, -0.5115954279899597, -0.6653918027877808, 0.8707106113433838, 0.37852010130882263, 0.2659575641155243, 0.5627586245536804, -0.01751299574971199, 0.3911004364490509, -0.870121955871582, 0.12923188507556915, 1.1756070852279663, -0.7592204213142395, -0.3249048888683319, -0.6612684726715088, -0.812803328037262, 0.6747651696205139, 0.697697639465332, -0.22089539468288422, 0.45173949003219604, 0.3931780457496643, -0.9278967976570129, -0.35952693223953247, -0.6509279012680054, -0.021836740896105766, 0.6598963141441345, -1.1960248947143555, -0.21345734596252441, -0.27426740527153015, 0.14407946169376373, -0.9524487257003784, -0.4532923102378845, -0.24998249113559723, 0.18714174628257751, -0.21374115347862244, 0.9517548084259033, -0.34296858310699463, 0.4428183436393738, 0.8307655453681946, -0.2311198115348816, -0.9064538478851318, -0.22952131927013397, -1.0494775772094727, 0.0949566513299942, -0.029206641018390656, 0.833990216255188, -0.4864305257797241, -0.000629184243734926, 0.8943153023719788, 0.17644375562667847, -0.4909486770629883, -0.466363787651062, -0.014382258988916874, -0.07636115700006485, -0.6994038820266724, 0.3034380078315735, -0.283317506313324, -0.36270785331726074, 0.45868736505508423, 0.7043153047561646, 0.5537480711936951, -0.044821206480264664, -0.9350126385688782, 0.12575176358222961, -0.39618048071861267, 0.0004072624142281711, -0.5800555348396301, -0.34078916907310486, -1.12848961353302, -0.11292664706707001, -1.1644316911697388, -0.017971569672226906, -1.1952706575393677, -0.37532052397727966, -0.29771435260772705, -0.7375140190124512, 0.3854253888130188, 0.44682037830352783, -0.15364974737167358, -0.05229252576828003, -0.4568628966808319, -0.5546354055404663, 0.4456831216812134, 0.8536373376846313, -0.7321262955665588, 0.1701984852552414, -0.19790740311145782, -0.20077930390834808, 0.48070332407951355, 0.34378018975257874, -0.6193705797195435, -0.9015783071517944, -1.6434714794158936, 0.6958650350570679, -0.4323767423629761, -0.17841796576976776, -0.5732795596122742, 0.6632866263389587, 0.5073649883270264, -0.19080887734889984, 0.15112154185771942, 0.5823690295219421, -0.9945694208145142, -0.2849384546279907, 0.08818734437227249, -0.46899181604385376, 0.5971280336380005, 0.42611026763916016, -0.8077554106712341, -0.28587254881858826, 0.9706130027770996, -0.031481485813856125, -1.0878839492797852, -0.8495893478393555, 0.4624585211277008, -0.5386862754821777, -0.13776998221874237, -0.6150068044662476, -0.20719122886657715, -0.9355093836784363, -0.07609719783067703, -0.1391208916902542, 0.13846883177757263, -0.16630350053310394, 1.1777905225753784, 0.5286899209022522, -0.9649502038955688, 0.27267760038375854, 0.6926218867301941, -0.319892555475235, -0.010421467013657093, 0.32170596718788147, 0.5548856854438782, -0.4397759437561035, 0.3686332404613495, 0.4262031316757202, 0.35199251770973206, -1.0982602834701538, -0.40921661257743835, 0.9598012566566467, -0.7749863862991333, -0.28071579337120056, 1.4597233533859253, -0.2970550060272217, -0.8756484985351562, 0.05124792829155922, -1.6883418560028076, -0.35490888357162476, -0.2629685401916504, 0.6404210329055786, -0.40549662709236145, 0.046162139624357224, -0.3052155375480652, -0.7173920273780823, 0.29075077176094055, -0.21992340683937073, -0.41033515334129333, 0.731520414352417, -0.06454622745513916, -0.5635783076286316, 0.8185149431228638, 0.6213400959968567, -0.5342332124710083, -0.6443455815315247, -0.818891167640686, -0.30424416065216064, 0.11302484571933746, 0.7434023022651672, -0.46798545122146606, -1.0123493671417236, 0.8987165093421936, 0.548405110836029, 0.17203763127326965, 0.29885831475257874, -0.2529568076133728, 0.41390085220336914, 0.5063902139663696, 0.5466594696044922, -0.7138888239860535, -0.8977175951004028, 1.2563154697418213, 1.1023855209350586, -0.3773641586303711, 0.2718874216079712, -0.21781030297279358, -0.45406806468963623, 0.6042289137840271, -0.08638663589954376, -0.19351491332054138, 1.2758926153182983, 0.2621193528175354, 0.3499477505683899, 0.11484724283218384, -1.2174755334854126, -0.2148609608411789, 0.748999297618866, 0.6504136323928833, 0.9168899655342102, 0.5123240947723389, 0.5200727581977844, 0.9019756317138672, 0.007407945115119219, 0.3594294488430023, 0.14703369140625, 0.6980708241462708, -0.16418392956256866, -0.16006119549274445, 0.13901522755622864, 0.6195507049560547, -0.9218457937240601, -0.9472399353981018, -0.08193036913871765, 0.7841578125953674, 0.28746065497398376, 0.3280717432498932, 0.5237909555435181, -0.3469350039958954, 0.6154342889785767, 0.680034339427948, 0.7577614188194275, -0.7081775069236755, -0.7033252716064453, -0.07993565499782562, -0.5422850847244263, -0.3035886883735657, 0.010568053461611271, -0.1709134876728058, -0.2830357849597931, -0.5114045739173889, 0.15134626626968384, -0.06673039495944977, 0.2755550444126129, 0.9987397193908691, 0.5722928643226624, 0.5551983118057251, -0.32950299978256226, -0.46726399660110474, -0.27531349658966064, -0.9467321038246155, -0.041519489139318466, -0.5637801289558411, -0.06003650277853012, 0.013067476451396942, -0.1831410974264145, -0.4071078896522522]}, "authors": [{"authorId": "2311130482", "name": "Qi Sun"}, {"authorId": "2311117397", "name": "Marc Pickett"}, {"authorId": "2231686079", "name": "Aakash Kumar Nain"}, {"authorId": "2311317355", "name": "Llion Jones"}], "references": [{"paperId": "828f98e0feba2baa55a5486f354fd074cca0880c", "title": "Evolutionary Optimization of Model Merging Recipes"}, {"paperId": "b32fdc4b6d62edb015ed1242940c0005109fb7e1", "title": "DenseFormer: Enhancing Information Flow in Transformers via Depth Weighted Averaging"}, {"paperId": "96c88b196e3e432710debab39f49ee72f2b96a10", "title": "Anisotropy Is Inherent to Self-Attention in Transformers"}, {"paperId": "be55e8ec4213868db08f2c3168ae666001bea4b8", "title": "Pythia: A Suite for Analyzing Large Language Models Across Training and Scaling"}, {"paperId": "56c3f1286585f14aa6b34c53f4c09c6e5e6e068a", "title": "A Study on Transformer Configuration and Training Objective"}, {"paperId": "d6045d2ccc9c09ca1671348de86d07da6bc28eea", "title": "Training Verifiers to Solve Math Word Problems"}, {"paperId": "d2a3bb6356d439146cd8d8e72dc728a1e3d93e7f", "title": "Understanding Robustness of Transformers for Image Classification"}, {"paperId": "fdacf2a732f55befdc410ea927091cad3b791f13", "title": "Switch Transformers: Scaling to Trillion Parameter Models with Simple and Efficient Sparsity"}, {"paperId": "726320cdbd04804ffa8f3a78c095bd1b55a2a695", "title": "Similarity of Neural Network Representations Revisited"}, {"paperId": "8b0f27bb594b1eaaf493eaf1e2ee723a2b0a19ad", "title": "HellaSwag: Can a Machine Really Finish Your Sentence?"}, {"paperId": "451d4a16e425ecbf38c4b1cca0dcf5d9bec8255c", "title": "GLUE: A Multi-Task Benchmark and Analysis Platform for Natural Language Understanding"}, {"paperId": "88bb0a28bb58d847183ec505dda89b63771bb495", "title": "Think you have Solved Question Answering? Try ARC, the AI2 Reasoning Challenge"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "5ed791f810da580c78df6a052c6b9f2e258f6b0a", "title": "The LAMBADA dataset: Word prediction requiring a broad discourse context"}, {"paperId": "2c03df8b48bf3fa39054345bafabfeff15bfd11d", "title": "Deep Residual Learning for Image Recognition"}, {"paperId": "a010fe2f9404a951c3a9f50cba2006a551690917", "title": "How Many Layers and Why? An Analysis of the Model Depth in Transformers"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "92e121c6e114fe3cfb89370df03847c66a9b4e28", "title": "An Adversarial Winograd Schema Challenge at Scale"}, {"paperId": null, "title": "Shortened llama: A simple depth"}, {"paperId": null, "title": "Layers in large language models"}, {"paperId": null, "title": "Comparing representational and functional similarity in small transformer language models"}]}