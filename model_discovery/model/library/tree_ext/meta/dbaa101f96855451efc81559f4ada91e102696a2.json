{"paperId": "dbaa101f96855451efc81559f4ada91e102696a2", "title": "Algebraic Positional Encodings", "abstract": "We introduce a novel positional encoding strategy for Transformer-style models, addressing the shortcomings of existing, often ad hoc, approaches. Our framework provides a flexible mapping from the algebraic specification of a domain to an interpretation as orthogonal operators. This design preserves the algebraic characteristics of the source domain, ensuring that the model upholds the desired structural properties. Our scheme can accommodate various structures, including sequences, grids and trees, as well as their compositions. We conduct a series of experiments to demonstrate the practical applicability of our approach. Results suggest performance on par with or surpassing the current state-of-the-art, without hyperparameter optimizations or ``task search'' of any kind. Code will be made available at \\url{github.com/konstantinosKokos/UnitaryPE}.", "venue": "arXiv.org", "year": 2023, "citationCount": 1, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work introduces a novel positional encoding strategy for Transformer-style models, addressing the shortcomings of existing, often ad hoc, approaches, and provides a flexible mapping from the algebraic specification of a domain to an interpretation as orthogonal operators."}, "embedding": {"model": "specter_v2", "vector": [0.6926465630531311, 0.722970187664032, -0.7487803101539612, -0.07962866127490997, -0.46487319469451904, -0.43332338333129883, 0.3616981506347656, -0.15998953580856323, -0.09156298637390137, -0.15255612134933472, 0.409745454788208, 0.07437014579772949, -0.42631328105926514, -0.5668244361877441, -0.1714167594909668, -0.029867757111787796, -0.9036895632743835, 0.4333575367927551, 0.3558988571166992, -0.5237083435058594, 0.3249513506889343, -0.2965002954006195, -1.10973060131073, 0.21727365255355835, 0.20576943457126617, 0.943287193775177, -0.13104525208473206, 0.5457408428192139, -0.16386863589286804, 0.5195364952087402, 0.5432196259498596, -0.24301636219024658, 0.643319845199585, 0.0013806431088596582, -0.35879266262054443, -0.3439480662345886, 0.022593455389142036, -0.3444145917892456, -0.9846161603927612, 0.7403513193130493, -0.547240674495697, 0.06668910384178162, 0.4775656759738922, -1.2421189546585083, -0.5621504187583923, 0.9373310208320618, 0.852349042892456, 0.31138521432876587, -0.22592681646347046, -0.932079553604126, 1.7862603664398193, -1.2010107040405273, 0.6980785131454468, 0.8861597180366516, 0.6386817693710327, 0.3433080017566681, -0.7192034125328064, -0.2502228915691376, -0.24423064291477203, 0.47556576132774353, -1.3320707082748413, -0.5458515286445618, 0.14316484332084656, 0.198659285902977, 0.9947212338447571, -0.10603970289230347, -0.16074702143669128, -0.15809334814548492, -0.23700548708438873, 1.0917950868606567, 0.500996470451355, -0.7201170325279236, 0.029766887426376343, 0.08963669836521149, 0.07135029137134552, 0.8502445816993713, -0.142261803150177, 0.580319344997406, -1.188853144645691, -0.24790646135807037, 0.7476220726966858, -0.318095862865448, 0.02719130553305149, -1.3304378986358643, -0.11109676212072372, 0.26695334911346436, 0.27865421772003174, 0.5223547220230103, -0.14712518453598022, 0.8467198014259338, 0.26941585540771484, 0.4947607219219208, -0.5565217733383179, 0.59380042552948, 0.0640200600028038, 0.19014041125774384, -0.5903878808021545, 0.41021043062210083, -0.013430053368210793, 1.1195652484893799, -0.1544390171766281, 0.3287946581840515, -0.13944903016090393, -0.25271904468536377, 1.2064406871795654, 0.026668980717658997, -0.052295293658971786, -1.1711887121200562, -0.2887720763683319, -0.47997668385505676, 0.43336158990859985, -0.7810778021812439, 0.25965577363967896, -0.296739399433136, -0.42722412943840027, -1.139283299446106, -0.24170087277889252, 0.6018792390823364, -0.49379804730415344, 0.8065880537033081, -0.7174553275108337, 0.26097986102104187, 0.4410945177078247, 0.18200084567070007, 0.29491040110588074, 0.5762794613838196, -0.09328795969486237, -0.15918052196502686, 0.6477486491203308, -0.40572279691696167, -0.752790629863739, -0.5136086344718933, 0.9901356101036072, 0.03310098871588707, -0.20941366255283356, -0.27813518047332764, -1.5649912357330322, -1.0926785469055176, -0.7635491490364075, 0.0910838395357132, -0.6595956683158875, 0.15074458718299866, 0.6669335961341858, 0.40292829275131226, -1.2990915775299072, 0.6801194548606873, -0.08926370739936829, 0.2786003649234772, 0.804202675819397, 0.6337817907333374, 0.04194391146302223, -0.2694961130619049, -1.2554326057434082, 0.47028848528862, 0.3617613613605499, -0.7174515128135681, -0.23652319610118866, -1.1749006509780884, -1.537265419960022, 0.03205347806215286, 0.543234646320343, -0.4672006070613861, 1.00638747215271, 0.9790014624595642, -1.0560365915298462, 0.6996440291404724, -0.33892005681991577, -0.3233973979949951, 0.1369049996137619, 0.18895931541919708, -0.436849445104599, -0.29252690076828003, 0.04754234850406647, 0.4720005989074707, 0.28154513239860535, -0.7580488324165344, -0.09550058841705322, 0.3745020627975464, -0.03402944281697273, 0.029264861717820168, -0.2628517746925354, 0.9518451690673828, -0.05004696547985077, -0.25147151947021484, 0.6105850338935852, 0.7051433324813843, -0.44045260548591614, 0.1338961124420166, -0.570427656173706, -0.7112300992012024, 0.8485414385795593, 0.4353901147842407, 1.5749715566635132, -0.9146715998649597, 0.033155955374240875, 0.010199163109064102, -0.0016318828565999866, -0.4698541760444641, -0.22906652092933655, 0.6789523959159851, -0.8879978656768799, 0.6201989054679871, -0.729183554649353, -0.36676478385925293, 0.31107097864151, -0.170994833111763, -0.8265835046768188, -0.12479196488857269, -0.039992403239011765, 1.0625234842300415, -0.8375915884971619, 0.07398206740617752, 0.09336172789335251, -0.15537482500076294, -1.11647629737854, 0.9902867078781128, -0.174834206700325, 0.019721483811736107, 0.2064274549484253, -0.06745456904172897, -0.02052336372435093, -0.14839549362659454, 0.7647747993469238, -0.48415666818618774, -0.21271079778671265, 0.42383241653442383, -1.0100536346435547, 1.3646107912063599, 0.000935251300688833, 0.15980616211891174, 0.037752117961645126, -0.7790794968605042, 0.24438297748565674, 0.34455403685569763, 0.2671809196472168, -0.36768192052841187, 0.200807586312294, 0.6434273719787598, -0.07223782688379288, 0.6043022274971008, 0.7932540774345398, 0.7365863919258118, -0.8200110793113708, 0.2475249320268631, 0.41056177020072937, -0.737330436706543, 0.6141924262046814, 0.19267714023590088, 0.8413490653038025, 0.7474231719970703, 0.5745231509208679, -0.5911489129066467, 0.4429819583892822, -0.3977530598640442, -0.1356104016304016, 0.3497380316257477, 0.7864477038383484, 0.6981973052024841, 0.3347683250904083, -0.8186087012290955, -0.7775232195854187, -0.32138746976852417, 0.1617138683795929, 1.108825922012329, 0.5564644932746887, -0.9784419536590576, -0.4385995864868164, -0.118692547082901, -0.26058968901634216, -0.05313701182603836, -0.5874389410018921, -0.5813506841659546, -0.8102546334266663, -0.5109109878540039, 1.1805649995803833, 1.1862024068832397, 0.9019982218742371, -0.17887583374977112, -0.75957852602005, -0.3659571707248688, 0.16917569935321808, -0.5435466766357422, -0.07272739708423615, 0.7299941182136536, -0.2686787247657776, -0.2771766185760498, 0.13207951188087463, -0.3028755784034729, 0.22512850165367126, -0.9288350343704224, 0.6781123280525208, -0.6787246465682983, -0.4482251703739166, -0.18664750456809998, 0.8604835271835327, -0.47444239258766174, -0.497303307056427, 0.07621647417545319, 0.07406482100486755, -0.4818326532840729, 0.1978112757205963, 0.22997744381427765, 0.3280942440032959, 0.7523281574249268, -0.7233541011810303, 0.10155245661735535, 0.03735322877764702, 0.6910223364830017, 0.8726373314857483, 0.3268420398235321, -0.3544592261314392, -1.1123111248016357, 0.5801724791526794, 0.6325557827949524, -0.5719594359397888, 0.17629022896289825, -0.5400271415710449, -0.3852330148220062, 0.476290762424469, -0.42760416865348816, -0.022979075089097023, -0.9192516803741455, 0.5739529728889465, -0.32894062995910645, -0.423880010843277, 0.37560907006263733, -0.12069796025753021, 0.010504829697310925, 0.37760424613952637, 0.6749504208564758, 0.2880670428276062, 0.20202936232089996, 0.7298100590705872, -1.1986790895462036, 0.7155997157096863, -0.19966788589954376, 0.6905918717384338, -0.018441585823893547, 0.5926473736763, -0.6096937656402588, 0.07487957924604416, -0.03654372692108154, -0.5776348114013672, 0.062425851821899414, 0.07926160097122192, -0.24177208542823792, -0.7605104446411133, -0.015704242512583733, -0.9228929877281189, -0.35548728704452515, -0.3023566007614136, -0.8242893815040588, -0.5937959551811218, -1.0669405460357666, -1.124499797821045, -0.6805264353752136, 0.11047666519880295, -1.0340524911880493, 0.5703356862068176, -0.21574993431568146, -0.6814098954200745, -0.3059804439544678, -0.3009780943393707, -0.682103157043457, 0.922636866569519, -0.36086010932922363, 1.3608726263046265, -0.07596158236265182, -0.5906209349632263, -0.21600812673568726, 0.260432630777359, 0.23218584060668945, -0.5062864422798157, 0.15883196890354156, -0.2521953284740448, 0.6295921206474304, -0.23694264888763428, -0.2798195779323578, -0.45411595702171326, 0.384800523519516, 1.0879603624343872, -0.013624537736177444, -0.7357653379440308, 0.05980502814054489, 1.3963087797164917, 0.06988891214132309, 0.6143753528594971, 0.4253259003162384, 0.7936620116233826, 0.7207033038139343, 0.1257673054933548, 0.5230296850204468, 0.021496020257472992, 0.9180694818496704, 0.46381402015686035, 0.13896451890468597, 0.08432203531265259, -0.337775856256485, 0.06560895591974258, 0.8251322507858276, 0.20871078968048096, 0.14262831211090088, -1.1102266311645508, 0.837070643901825, -1.2186976671218872, -1.0100762844085693, 0.8347069621086121, 0.8194599747657776, 0.028537219390273094, -0.3939400613307953, 0.09110389649868011, 0.6519327163696289, 0.7183763980865479, 0.37183284759521484, 0.056379303336143494, -0.2584191858768463, -0.0282217338681221, 1.0251684188842773, 0.22938507795333862, 0.47702616453170776, -0.4595608711242676, 0.3891989588737488, 14.884492874145508, 0.906777560710907, 0.28003495931625366, 0.1358032524585724, 0.5282610654830933, 0.7571024298667908, -0.4677272140979767, 0.2072318196296692, -0.8989937901496887, -0.009870098903775215, 1.0138843059539795, -0.2416905164718628, 0.21841397881507874, 0.3123391568660736, -0.5387871861457825, 0.6901904344558716, -0.5959039330482483, 0.20904552936553955, 0.08715099841356277, -1.506787896156311, 0.1013861820101738, 0.5625486969947815, 0.004669812973588705, -0.4276837706565857, 0.9078812599182129, 0.24989770352840424, 0.4080442786216736, -0.9083431363105774, 0.8374500274658203, 0.030771110206842422, 1.495489478111267, -0.22454151511192322, 0.333246648311615, -0.04300077259540558, -1.3112268447875977, -0.3105482757091522, -0.5231444835662842, -1.042447805404663, 0.4003809988498688, -0.5668110251426697, -0.3231264054775238, -0.34528669714927673, -0.3382405936717987, 0.8965233564376831, 0.633831799030304, 0.3791303038597107, -0.08525323122739792, 0.15454062819480896, -0.2377394288778305, 0.38946443796157837, -0.18349525332450867, 0.12825149297714233, -0.03376895189285278, -0.44212278723716736, 0.350589394569397, 0.19099298119544983, 0.0256415493786335, 0.679155707359314, -0.28364109992980957, -0.2119274139404297, -1.3385194540023804, -0.5907189846038818, 0.11364720016717911, 0.554077684879303, 0.4256468713283539, 0.3118235170841217, -0.035053595900535583, -0.18225540220737457, -0.12621894478797913, -0.24976730346679688, -0.7015902996063232, -0.657534122467041, 0.4775185286998749, 0.05499996244907379, -0.09922481328248978, 0.6836621165275574, -0.8580842018127441, -0.031034031882882118, -1.1859854459762573, -0.3869021236896515, 0.5070382952690125, -0.6664099097251892, -0.13750196993350983, 1.143149733543396, 0.08919477462768555, -0.8224429488182068, 0.30505844950675964, -1.107496976852417, 0.15409083664417267, -0.01464072335511446, -0.6850358247756958, -0.8336812853813171, 0.25122353434562683, -0.3198256492614746, -0.48869553208351135, 0.23972490429878235, 1.5795693397521973, 0.0016254844376817346, 0.12889495491981506, -0.15593676269054413, -0.4842742085456848, -0.03957506641745567, -0.3204220235347748, -1.2837767601013184, 0.5974985361099243, 0.1787201166152954, 0.06424123793840408, 0.8888835906982422, 0.2690073847770691, 0.24854260683059692, -0.6648604869842529, 0.014896025881171227, 0.6824187636375427, -1.0424484014511108, -0.06034915894269943, -0.6699524521827698, -0.8028277158737183, 0.4013005495071411, 0.405605286359787, 0.006567398086190224, 0.7299671769142151, -0.235402911901474, -0.5307554602622986, -0.042772695422172546, -0.8540326952934265, 0.16550198197364807, 1.2891789674758911, -1.0616165399551392, -0.4728151261806488, -0.3952541947364807, -0.00831229705363512, -1.2437824010849, -0.8798830509185791, 0.6455245018005371, 0.22858279943466187, -0.23512159287929535, 1.4007353782653809, -0.30789729952812195, 1.1250035762786865, 0.3690411448478699, -0.5842175483703613, -0.5517212152481079, -0.34982678294181824, -1.0523185729980469, -0.19602417945861816, -0.2986523509025574, 0.728800356388092, -0.07978861033916473, 0.5559760928153992, 0.5792343020439148, -0.2118767350912094, -0.5671226382255554, -0.32251641154289246, -0.07159969210624695, -0.27049580216407776, -0.5283734202384949, 0.3526662290096283, -0.014372408390045166, -0.05000470578670502, -0.04204455390572548, 0.11529011279344559, 0.8076947331428528, -0.2691449522972107, -0.2543456554412842, 0.24400299787521362, -0.13208499550819397, -0.10044900327920914, -0.8142578601837158, -1.0905851125717163, -1.3338334560394287, -0.004481818992644548, -0.9585725665092468, 0.30463552474975586, -1.021087884902954, -0.8199041485786438, 0.085037961602211, -0.24630935490131378, -0.10739494115114212, 1.2751117944717407, 0.2214863896369934, -0.9592263102531433, -0.6612058281898499, -0.5643389821052551, 0.4250665009021759, 0.6293967962265015, -0.3922518193721771, 0.31047722697257996, -0.2290988266468048, -0.11535127460956573, 0.43178823590278625, 0.25559377670288086, -0.34187859296798706, -0.8538241982460022, -0.9809598326683044, 0.15927599370479584, 0.10618728399276733, -0.019597260281443596, -0.6144461035728455, 0.7390458583831787, 0.3225157856941223, -0.4923032820224762, 0.16986379027366638, 0.6775838136672974, -1.1215577125549316, -0.0034171256702393293, 0.5317786335945129, -0.9878762364387512, 0.35183870792388916, 0.02463679201900959, -0.5643548369407654, -0.4505493640899658, 0.816956102848053, 0.02163071557879448, -0.8346704244613647, -0.765673816204071, 0.16726773977279663, -0.6333147287368774, -0.23675589263439178, 0.203669935464859, -0.527370035648346, -1.063133716583252, -0.21402312815189362, -0.16555172204971313, -0.1439749151468277, 0.055239614099264145, 0.44307413697242737, 0.39053577184677124, -1.1894567012786865, 0.5781050324440002, 0.5064358115196228, 0.10224472731351852, 0.10657618194818497, 0.19707708060741425, 0.5247151851654053, -0.5979338884353638, 0.6339874863624573, -0.2620573341846466, 0.4402174651622772, -1.139807939529419, -0.16941986978054047, 0.4559633731842041, -0.23119209706783295, 0.07435224205255508, 1.131022572517395, -0.22530962526798248, -0.7774582505226135, 0.02141573652625084, -0.8930615186691284, -0.38022804260253906, -0.4938458800315857, 0.36274880170822144, 0.6344919204711914, -0.5875684022903442, -0.3644839823246002, -0.37199607491493225, 0.4341980218887329, 0.29843974113464355, -0.6170337200164795, 0.528511106967926, 0.28825196623802185, -0.8464111089706421, 0.1538664698600769, 0.11116743087768555, -0.5341930389404297, -0.0960223600268364, -0.608675479888916, -0.15559810400009155, -0.668286144733429, 0.03418280556797981, -0.023299571126699448, -0.032031379640102386, 0.8123273253440857, 0.17526063323020935, 0.8926030397415161, 0.05098187178373337, -0.14760176837444305, -0.021944357082247734, 0.43671751022338867, 0.450356662273407, -0.4137141704559326, -0.4801710546016693, 0.806908369064331, 1.1123080253601074, 0.13336315751075745, 0.10735449939966202, -1.0772919654846191, -0.26755180954933167, 0.8923261761665344, 0.3056833744049072, -0.21313826739788055, 0.6423311233520508, 0.23046422004699707, -0.16442115604877472, 0.0633561983704567, -0.6964161992073059, -0.2643527090549469, 0.7221137285232544, 1.5021785497665405, 0.17325495183467865, 0.023102018982172012, -0.0349268801510334, 0.9194574356079102, 0.05505291000008583, 0.12359972298145294, 0.6427119374275208, 1.1201437711715698, -0.06168438121676445, -0.6393570303916931, 0.13038891553878784, 0.4390047788619995, -0.7234347462654114, -0.42904436588287354, -0.19623881578445435, 1.0723180770874023, 0.4447583854198456, 0.2109849900007248, 0.742368221282959, -0.4150364100933075, 0.5784830451011658, 0.2171395719051361, 0.6825397610664368, -0.7763239741325378, 0.47864845395088196, 0.18305478990077972, -0.2684606909751892, 0.204685240983963, -0.5353785753250122, -0.3890129625797272, -0.566352903842926, -0.08721505105495453, -0.1364760845899582, 0.28156912326812744, 0.0531981959939003, 0.8592116832733154, 0.5910685658454895, 0.5202553868293762, -0.28180187940597534, -0.18918399512767792, -0.4929121732711792, -0.21913321316242218, 0.05503583699464798, -0.5754093527793884, -0.8637727499008179, -0.550468921661377, 0.4325515627861023, -0.12458042055368423]}, "authors": [{"authorId": "134254282", "name": "Konstantinos Kogkalidis"}, {"authorId": "144701616", "name": "Jean-Philippe Bernardy"}, {"authorId": "2266238603", "name": "Vikas Garg"}], "references": [{"paperId": "2e644c67a697073d561da4f4dad35e5ad5316cfd", "title": "SOFT: Softmax-free Transformer with Linear Complexity"}, {"paperId": "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4", "title": "RoFormer: Enhanced Transformer with Rotary Position Embedding"}, {"paperId": "4b06c7e29280b1c6bc05c9df39023b48fef02c93", "title": "Escaping the Big Data Paradigm with Compact Transformers"}, {"paperId": "7072db6eddb85ecd2c117365d91bd694760f726e", "title": "Position Information in Transformers: An Overview"}, {"paperId": "d8342a02f1c03023b8298b2047cb34d4f771cc30", "title": "DA-Transformer: Distance-aware Transformer"}, {"paperId": "cd4ffe5e014601a3d6b64121355d29a730591490", "title": "Fast Transformers with Clustered Attention"}, {"paperId": "6f68e1bb253925d8431588555d3010419f322e04", "title": "Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention"}, {"paperId": "8256f48f759cf85044db251cc512f965834945b3", "title": "Rethinking Positional Encoding in Language Pre-training"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "d0e28f5dc1feae19e41087a92a87992977fd85af", "title": "Encoding word order in complex embeddings"}, {"paperId": "f3f90b45f4d9916d65731a1b11e0c2483605c79f", "title": "On the Relation between Position Information and Sentence Length in Neural Machine Translation"}, {"paperId": "37a23c43ddf09ea97b82b38e2827a2229cfae545", "title": "Novel positional encodings to enable tree-based transformers"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "d07284a6811f1b2745d91bdb06b040b57f226882", "title": "Decoupled Weight Decay Regularization"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "43428880d75b3a14257c3ee9bda054e61eb869c0", "title": "Convolutional Sequence to Sequence Learning"}, {"paperId": "e9c771197a6564762754e48c1daafb066f449f2e", "title": "Unitary Evolution Recurrent Neural Networks"}, {"paperId": "492f57ee9ceb61fb5a47ad7aebfec1121887a175", "title": "Gated Graph Sequence Neural Networks"}, {"paperId": "5d90f06bb70a0a3dced62413346235c02b1aa086", "title": "Learning Multiple Layers of Features from Tiny Images"}, {"paperId": "bda503afae20ae947e921a43919728f2bf1f26be", "title": "Foundations and applications of Montague grammar"}, {"paperId": null, "title": "our sequential model corresponds to a version of RoPE where the rotation matrix D may vary and be optimized during training"}, {"paperId": null, "title": "computational cost \u2013 what is the added memory footprint and temporal cost of the modeling, if any?"}, {"paperId": null, "title": "content-dependence \u2013 does positional information have a static effect on the output of A ( \u00b7 , \u00b7 ) regardless of what X and Y are, or does it vary with its input?"}, {"paperId": null, "title": "unifying perspective of orthogonal operators"}, {"paperId": null, "title": "2023. Positional"}, {"paperId": null, "title": "the left and right unitaries U and U \u2020 unaffected). Assuming f q and f k are linear functions, they can be composed with U and U \u2020 respectively"}, {"paperId": null, "title": "above implies that our model and RoPE coincide, but only for some collection of eigenvalues \u03a3 = D (and corresponding angles)"}, {"paperId": null, "title": "B Hyperparameters In all sequence and tree tasks, we use a simple Transformer with the hyperparameters of Table"}]}