{"paperId": "683de10cda9cd3b709983db2da67f1f059fa516a", "title": "Towards More Effective and Economic Sparsely-Activated Model", "abstract": "The sparsely-activated models have achieved great success in natural language processing through large-scale parameters and relatively low computational cost, and gradually become a feasible technique for training and implementing extremely large models. Due to the limit of communication cost, activating multiple experts is hardly affordable during training and inference. Therefore, previous work usually activate just one expert at a time to alleviate additional communication cost. Such routing mechanism limits the upper bound of model performance. In this paper, we first investigate a phenomenon that increasing the number of activated experts can boost the model performance with higher sparse ratio. To increase the number of activated experts without an increase in computational cost, we propose SAM (Switch and Mixture) routing, an efficient hierarchical routing mechanism that activates multiple experts in a same device (GPU). Our methods shed light on the training of extremely large sparse models and experiments prove that our models can achieve significant performance gain with great efficiency improvement.", "venue": "arXiv.org", "year": 2021, "citationCount": 8, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "To increase the number of activated experts without an increase in computational cost, SAM (Switch and Mixture) routing is proposed, an efficient hierarchical routing mechanism that activates multiple experts in a same device (GPU)."}, "embedding": {"model": "specter_v2", "vector": [0.22052544355392456, 0.6980438828468323, -0.4897399842739105, -0.282321572303772, -0.19265525043010712, -0.026645241305232048, 0.6120773553848267, -0.5771674513816833, -0.48753806948661804, -0.30611616373062134, 0.5557718276977539, 0.3970659077167511, 0.25033262372016907, 0.1735718846321106, -0.3035430908203125, 0.11651591956615448, -1.0121541023254395, 0.49130192399024963, 0.3540797531604767, -0.33948326110839844, -0.31462258100509644, -0.43687790632247925, -1.3431446552276611, 0.6003966331481934, 0.5145561099052429, 0.5532189011573792, 0.10392984747886658, 0.765902042388916, -0.46548154950141907, 0.37610122561454773, 0.7289652824401855, -0.21154385805130005, 0.5011087656021118, 0.0362471304833889, 0.13178886473178864, -0.3276577889919281, 0.4312859773635864, -0.43648311495780945, -0.6820801496505737, 0.8052948713302612, -0.12718245387077332, 0.6389498710632324, 0.16483914852142334, -0.8573702573776245, 0.43401360511779785, 1.2100776433944702, 0.4671909213066101, 0.9350997805595398, -0.36166617274284363, -0.6115759611129761, 1.0792770385742188, -1.425285816192627, 0.15499305725097656, 1.6751679182052612, 0.13910794258117676, 0.12634864449501038, -0.11894594132900238, -0.9463449120521545, 1.0601439476013184, 0.11679555475711823, -0.7092616558074951, -0.667561948299408, 0.05226580426096916, -0.07964280992746353, 1.931138277053833, -0.44476017355918884, 0.2160082459449768, 0.8677733540534973, -0.3395031988620758, 1.2854995727539062, -0.010006217285990715, -0.6057256460189819, -0.17002363502979279, 0.3146724998950958, 0.368853896856308, 1.162416696548462, -0.1512371003627777, 0.33061733841896057, -1.4224251508712769, -0.4745819866657257, 0.46506744623184204, -0.09721933305263519, 0.3287765383720398, -0.2833554744720459, -0.2159973680973053, 0.9544861912727356, 0.3430442214012146, 0.8438271284103394, -0.3814559876918793, 0.5643337368965149, 0.5082039833068848, 0.0860925018787384, -0.033161066472530365, 0.3959487974643707, -0.3472653031349182, 0.43954402208328247, -0.8426639437675476, 0.16667352616786957, 0.14709223806858063, 0.7960100769996643, -0.5683037638664246, 0.45834028720855713, -0.3476310670375824, 0.3368180990219116, 1.5952551364898682, -0.01050621084868908, 0.42907196283340454, -0.9844003915786743, 0.06000173091888428, -0.4303988814353943, 0.10004640370607376, -0.924004852771759, -0.13254453241825104, -0.37132757902145386, -1.1294617652893066, -1.3475459814071655, -0.7044861316680908, 0.24308419227600098, -0.48432663083076477, 0.7919372320175171, -0.13498009741306305, 0.7695351243019104, -0.1743682473897934, 0.36014115810394287, 0.5862175822257996, 1.1634074449539185, 0.45862287282943726, 0.19817738234996796, 1.0392652750015259, -1.0601199865341187, -0.5369580984115601, -1.3088546991348267, 0.5806589126586914, 0.17958904802799225, 0.08185089379549026, 0.10120265185832977, -1.037697434425354, -0.8368744850158691, -0.6974831819534302, 0.63641357421875, -0.5403976440429688, 0.4687787890434265, 1.3495573997497559, 0.25905245542526245, -1.0996196269989014, 0.4752577543258667, -0.5130159854888916, -0.2557726502418518, 0.5560535788536072, 0.523415744304657, 0.057461753487586975, -0.3892386853694916, -1.4398125410079956, 0.16712117195129395, 0.4852691888809204, -0.32033583521842957, -0.31369274854660034, -0.2829693555831909, -1.1519489288330078, 0.40977105498313904, 0.48640668392181396, -0.844122588634491, 0.9538693428039551, -0.24323348701000214, -1.6626218557357788, 0.6462063789367676, -0.15807388722896576, 0.10704050213098526, -0.007776388432830572, -0.17558281123638153, -0.7422528862953186, -0.25739583373069763, -0.5109156966209412, 0.6210120320320129, 0.6049536466598511, -0.1659426987171173, -0.3110899031162262, 0.2637028992176056, -0.16243571043014526, -0.08772402256727219, -0.41417941451072693, 1.108331561088562, -0.35974040627479553, -0.2105882316827774, 0.5817282795906067, 0.46344998478889465, -0.4899694323539734, -0.0915699228644371, -0.22808519005775452, -1.1248916387557983, 0.6537702679634094, 0.07131614536046982, 0.9445496201515198, -0.9227192997932434, -0.6509632468223572, 0.1058536246418953, -0.012112993746995926, -0.046653807163238525, -0.9336168169975281, 0.39773795008659363, -0.3200394809246063, 0.25115349888801575, -0.33983615040779114, -0.8679194450378418, -0.051044683903455734, -0.2068168967962265, -0.7109634280204773, -0.136747345328331, 0.07851415872573853, 0.6957931518554688, -1.044914960861206, 0.045317310839891434, -0.007168932817876339, 0.36354050040245056, -1.3527737855911255, 1.2659279108047485, -0.4496914744377136, 0.0011678512673825026, -0.2793081998825073, -0.19896206259727478, 0.23001572489738464, -0.3209230899810791, 0.5681241154670715, -0.49916210770606995, 0.07852870225906372, 0.5938162803649902, -1.135469913482666, 1.4886329174041748, -0.26884931325912476, 0.46848905086517334, 0.29531532526016235, -0.9159667491912842, 0.10287575423717499, 0.6297712922096252, -0.19100195169448853, -0.18194730579853058, 0.4391847252845764, 0.4696773886680603, -0.42315277457237244, 0.09084463864564896, 0.5205246210098267, 1.0004268884658813, -0.5265352129936218, 0.03006092458963394, 0.4924878478050232, 0.057311538606882095, 0.36905086040496826, 0.9087286591529846, 0.45432958006858826, 0.1489974409341812, 0.47877538204193115, -0.14047600328922272, 0.28153741359710693, -1.1486027240753174, 0.161174476146698, 0.7085091471672058, 0.6539826393127441, 0.26619425415992737, 0.302497923374176, -0.6383864879608154, 0.013567010872066021, 0.3140275776386261, 0.9220045804977417, 1.8451539278030396, -0.08589576929807663, -0.09408935159444809, -0.48705700039863586, -0.24382680654525757, -0.43160295486450195, -0.053597841411828995, 0.10109759122133255, -0.13722491264343262, -0.634049117565155, -1.2649614810943604, 0.6933597326278687, 0.18877455592155457, 0.8926934003829956, -0.7913422584533691, -0.36597710847854614, -0.3525252640247345, 0.30532461404800415, -0.8480691313743591, -0.07547950744628906, 0.2914719879627228, -0.7495042681694031, -0.15123796463012695, 0.2921275496482849, 0.03419060632586479, 0.25360214710235596, -0.8125810027122498, 1.0987870693206787, -0.606180727481842, 0.06221677362918854, 0.01669975183904171, 0.5306328535079956, -0.23433955013751984, -0.4605365991592407, 0.26795515418052673, 0.40452316403388977, 0.1685197502374649, 0.0986967459321022, 0.5912335515022278, 0.09193907678127289, 0.026479627937078476, -0.24047185480594635, 0.081981360912323, 0.2130037099123001, -0.22264032065868378, 0.564424991607666, -0.3200485408306122, 0.21201661229133606, -1.6708208322525024, 0.3947483003139496, -0.4323275685310364, -0.5460718870162964, -0.05321722477674484, -0.20346999168395996, -0.4015456736087799, 0.46377328038215637, -0.8549540042877197, -0.5287585854530334, -0.5347629189491272, 0.15257036685943604, -0.13040320575237274, -0.37546998262405396, 0.17795775830745697, 0.051516879349946976, -0.08609767258167267, 0.20623865723609924, 0.18760140240192413, -0.1092747151851654, -0.29497814178466797, 0.6815860867500305, -0.6241995096206665, 0.39777886867523193, 0.23440636694431305, -0.007452794350683689, -0.04574526101350784, -0.6410987377166748, -0.6782599091529846, -0.07576055824756622, -0.5383971333503723, 0.09356275200843811, 0.10623151063919067, -0.5386173129081726, -1.0259041786193848, -0.8050107955932617, 0.15202683210372925, -1.1001852750778198, -0.1875278204679489, 0.2463604062795639, 0.15157468616962433, 0.1488344520330429, -1.2888906002044678, -1.4079110622406006, -0.5781506896018982, -0.18810345232486725, -1.0307774543762207, 0.31348535418510437, 0.024753035977482796, -0.6178130507469177, -0.33986273407936096, -0.15870682895183563, -0.3932090997695923, 1.2433726787567139, -0.5961344838142395, 0.7471609115600586, -0.5990537405014038, -0.5804707407951355, -0.589733898639679, 0.21054676175117493, 0.110810287296772, -0.6269776225090027, 0.3460628092288971, -0.9791879653930664, 0.11597224324941635, -0.09851739555597305, -0.17144834995269775, 0.48854559659957886, 0.673469603061676, 0.9861176609992981, -0.15374015271663666, -1.0354315042495728, 0.43956267833709717, 1.1922529935836792, -0.6283853650093079, 0.02933862991631031, -0.20806553959846497, 1.0296543836593628, 0.35108745098114014, -0.44413018226623535, 0.4208693504333496, 0.3028992712497711, 0.40823060274124146, 0.14220455288887024, -0.13727489113807678, 0.24578076601028442, -0.359420508146286, 0.6243683695793152, 2.012162685394287, 0.41286206245422363, -0.4027325510978699, -0.5712401866912842, 0.42403867840766907, -1.390055537223816, -0.8297886848449707, 0.6242215633392334, 0.5997787714004517, 0.06709394603967667, -0.2794387638568878, -0.0912322849035263, -0.46407318115234375, 0.7054610252380371, 0.4717843234539032, -0.5494107604026794, -0.5005574226379395, -0.01932091824710369, 0.4153451919555664, -0.010451747104525566, 0.8885106444358826, -0.16824392974376678, 0.779318630695343, 14.905436515808105, 0.8671176433563232, 0.18243126571178436, 0.6863378882408142, 0.8933019042015076, -0.017189571633934975, -0.4342571496963501, -0.026919512078166008, -1.3254201412200928, 0.29053765535354614, 1.426098108291626, 0.3275773227214813, 0.6541088223457336, 0.37242478132247925, -0.14513440430164337, 0.12256528437137604, -0.38776546716690063, 0.8389772772789001, 0.494223028421402, -1.1408547163009644, 0.43841055035591125, -0.07566135376691818, 0.35109326243400574, 0.43025824427604675, 0.45320621132850647, 1.0006393194198608, 0.6142104864120483, -0.5901312828063965, 0.2030610740184784, 0.20124416053295135, 0.6441701650619507, 0.06986059993505478, 0.36924222111701965, 0.6661344766616821, -0.9967144727706909, -0.33286532759666443, -0.5102742314338684, -1.0480626821517944, 0.2559571862220764, 0.46600618958473206, 0.0650542676448822, -0.7155328392982483, -0.0696159303188324, 0.9333506226539612, 0.37888163328170776, 0.5922811031341553, -0.23043157160282135, 0.815628170967102, -0.5997076034545898, 0.27733609080314636, 0.10493692010641098, 0.45021528005599976, 0.30360621213912964, -0.13471539318561554, 0.16446354985237122, 0.32789620757102966, 0.33990228176116943, 0.3999994397163391, -0.731373131275177, -0.185645192861557, -0.3340195417404175, -0.4849131405353546, 0.3883475065231323, 0.9839295744895935, 0.11045454442501068, -0.2036496251821518, -0.28045204281806946, 0.1505126953125, 0.5132653713226318, 0.195743590593338, -0.25202134251594543, 0.25482168793678284, 0.02337544597685337, -0.3353663682937622, -0.23619413375854492, 0.8209883570671082, -0.04061676189303398, -0.6995512247085571, -0.8812515139579773, -0.829403817653656, 0.653047502040863, -0.48487114906311035, -0.7382562160491943, 1.135317087173462, -0.03277341276407242, -0.14352622628211975, 0.38037925958633423, -0.5283144116401672, -0.33301863074302673, 0.14690572023391724, -0.9489390850067139, -0.46704748272895813, 0.35049334168434143, -0.3915233016014099, -0.19420936703681946, -0.3455885648727417, 1.3017805814743042, 0.26896342635154724, -0.6642696261405945, -0.1756654679775238, -0.14442677795886993, -0.41544780135154724, -0.36836543679237366, -0.3285849392414093, 0.8096169829368591, 0.3459794521331787, 0.06529980152845383, 0.3538511395454407, -0.2662573456764221, 0.21870405972003937, -0.3195860683917999, 0.23743180930614471, 0.6065217852592468, -0.834347665309906, -0.6454508900642395, -0.9909175634384155, -0.9927551746368408, 0.3375028371810913, 0.45353007316589355, -0.13137546181678772, 0.3500349521636963, 0.08231376111507416, -0.47894060611724854, -0.16969890892505646, -0.7692553997039795, -0.31600213050842285, 0.6265943050384521, -0.6330562233924866, -0.16414348781108856, -0.0965896025300026, 0.22072556614875793, -0.7954005599021912, -0.11321715265512466, 0.17652949690818787, 0.05589824914932251, -0.13428550958633423, 1.2987658977508545, -0.49400073289871216, 0.29231321811676025, 0.7968376874923706, -0.180606409907341, -0.9770444631576538, -0.041715484112501144, -0.7854411005973816, -0.5673021674156189, -0.1347571462392807, 0.47815167903900146, -0.7101401686668396, 0.2856142222881317, 0.8491880297660828, 0.40660011768341064, -0.5637312531471252, -0.4181583523750305, 0.055065590888261795, -0.5556113719940186, -0.14982599020004272, 0.26406770944595337, 0.26201483607292175, -0.16914568841457367, 0.03075440600514412, 0.384488046169281, 0.722213625907898, -0.11222392320632935, -0.6904098391532898, 0.0049169291742146015, -0.48555901646614075, -0.2538573145866394, -0.5715984106063843, -0.08805742859840393, -1.603819489479065, 0.3205341696739197, -1.0942682027816772, 0.23888367414474487, -0.8175222873687744, -0.37711694836616516, -0.16880406439304352, -0.5277857780456543, -0.02131151594221592, 0.2368016541004181, -0.47251325845718384, -0.6767734289169312, -0.505190372467041, -0.6097694635391235, 0.7444950342178345, 0.4023437201976776, -0.4129684567451477, -0.2669433355331421, -0.08043495565652847, 0.016012251377105713, 0.6210328340530396, 0.477130651473999, -0.9623219966888428, -0.8155221939086914, -1.176246166229248, 0.6672428250312805, -0.16234709322452545, -0.1904861032962799, -0.551673173904419, 0.9916565418243408, 0.3462561070919037, -0.3718571662902832, 0.21490050852298737, 0.7165625095367432, -1.116125226020813, -0.1079663634300232, 0.5165020227432251, -0.8335587978363037, -0.0006374539225362241, 0.17903605103492737, -0.42208054661750793, -0.2883376479148865, 0.6208174228668213, 0.12479915469884872, -1.1720675230026245, -0.9963876605033875, 0.6245259046554565, -0.7124000191688538, 0.28564950823783875, -0.12775588035583496, 0.01125620398670435, -1.097259521484375, -0.1043480858206749, -0.12114234268665314, 0.2557235658168793, -0.5235892534255981, 0.6761505007743835, 0.4681190848350525, -0.9224488139152527, 0.026943279430270195, 0.6129752993583679, -0.36420732736587524, 0.17365366220474243, 0.6617134809494019, 0.26267874240875244, -0.28506091237068176, 0.45850542187690735, 0.341313898563385, 0.36945685744285583, -0.6411592960357666, -0.19629310071468353, 0.8456322550773621, -0.3337234556674957, -0.3442184627056122, 1.5419951677322388, -0.32815471291542053, -1.1886522769927979, 0.4282743036746979, -1.0043261051177979, -0.5744551420211792, -0.3172225058078766, 0.5792547464370728, 0.3351273536682129, -0.4527004659175873, -0.18480904400348663, -0.8172372579574585, 0.03521521016955376, 0.012757977470755577, -0.26739057898521423, 0.7053399085998535, 0.08083024621009827, -0.4587370753288269, 0.6568784117698669, 0.44527381658554077, -0.5174404978752136, -0.7395656704902649, -0.544917643070221, -0.5203835964202881, -0.477272629737854, 0.41321295499801636, -0.2987372577190399, -0.8707179427146912, 0.6958053112030029, 0.5095006823539734, 0.17214825749397278, -0.14062823355197906, 0.06343776732683182, 0.3578156530857086, 0.5572817325592041, 0.2260410487651825, -0.5200826525688171, -0.43532437086105347, 1.048770546913147, 1.1331435441970825, -0.8472357988357544, 0.03170792758464813, -0.8803113698959351, -0.7708874940872192, 0.28649261593818665, 0.6487514972686768, -0.33734992146492004, 0.975674569606781, -0.13945622742176056, -0.18326936662197113, -0.13049735128879547, -1.0657422542572021, -0.1570628434419632, 0.7793022990226746, 0.7055954337120056, 0.6037051677703857, 0.2000124752521515, 0.29217180609703064, 1.1666250228881836, 0.3520258963108063, 0.11731273680925369, 0.41686689853668213, 0.22249609231948853, -0.22225815057754517, 0.050134848803281784, 0.19746577739715576, 0.925560474395752, -0.3438451290130615, -0.6720080971717834, 0.19685646891593933, 0.4130890369415283, 0.3036584258079529, 0.4752759039402008, 0.6459469199180603, 0.35740962624549866, 0.5032978653907776, 0.15323521196842194, 0.3606853783130646, -0.9462355375289917, -0.16935016214847565, -0.1284022033214569, -0.7001785635948181, -0.43609869480133057, -0.41767212748527527, 0.1890820860862732, -0.22316142916679382, -0.3913457989692688, 0.27528446912765503, -0.07120311260223389, 0.18047691881656647, 0.9869546890258789, 0.8756616115570068, 0.5160725116729736, -0.31256598234176636, -0.5794869065284729, -0.20853757858276367, -0.8275899291038513, -0.27301767468452454, -0.51485276222229, -0.46743378043174744, -0.3064440190792084, -0.4928109347820282, -0.4138326346874237]}, "authors": [{"authorId": "2152631472", "name": "Hao Jiang"}, {"authorId": "50324815", "name": "Ke Zhan"}, {"authorId": "2147138528", "name": "Jianwei Qu"}, {"authorId": "2115859566", "name": "Yongkang Wu"}, {"authorId": "2132200788", "name": "Zhaoye Fei"}, {"authorId": null, "name": "Xinyu Zhang"}, {"authorId": "2146072021", "name": "Lei Chen"}, {"authorId": "1897235", "name": "Zhicheng Dou"}, {"authorId": "1767521", "name": "Xipeng Qiu"}, {"authorId": "2112225685", "name": "Zi-Han Guo"}, {"authorId": "2128243415", "name": "Ruofei Lai"}, {"authorId": "2111123834", "name": "Jiawen Wu"}, {"authorId": "2118895517", "name": "Enrui Hu"}, {"authorId": "2129510184", "name": "Yinxia Zhang"}, {"authorId": "2861442", "name": "Yantao Jia"}, {"authorId": "2155386012", "name": "Fan Yu"}, {"authorId": "2106400572", "name": "Zhao Cao"}], "references": [{"paperId": "fdacf2a732f55befdc410ea927091cad3b791f13", "title": "Switch Transformers: Scaling to Trillion Parameter Models with Simple and Efficient Sparsity"}, {"paperId": "1882f194cb43828852cc052887671e55a80f945a", "title": "GShard: Scaling Giant Models with Conditional Computation and Automatic Sharding"}, {"paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0", "title": "Language Models are Few-Shot Learners"}, {"paperId": "e6c561d02500b2596a230b341a8eb8b921ca5bf2", "title": "Scaling Laws for Neural Language Models"}, {"paperId": "395de0bd3837fdf4b4b5e5f04835bcc69c279481", "title": "BART: Denoising Sequence-to-Sequence Pre-training for Natural Language Generation, Translation, and Comprehension"}, {"paperId": "6c4b76232bb72897685d19b3d264c6ee3005bc2b", "title": "Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer"}, {"paperId": "8323c591e119eb09b28b29fd6c7bc76bd889df7a", "title": "Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism"}, {"paperId": "d0086b86103a620a86bc918746df0aa642e2a8a3", "title": "Language Models as Knowledge Bases?"}, {"paperId": "077f8329a7b6fa3b7c877a57b81eb6c18b5f87de", "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach"}, {"paperId": "ad7129af0644dbcafa9aa2f111cb76526ea444a1", "title": "Defending Against Neural Fake News"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "510e26733aaff585d65701b9f1be7ca9d5afc586", "title": "Outrageously Large Neural Networks: The Sparsely-Gated Mixture-of-Experts Layer"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "5ed791f810da580c78df6a052c6b9f2e258f6b0a", "title": "The LAMBADA dataset: Word prediction requiring a broad discourse context"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "2e9d221c206e9503ceb452302d68d10e293f2a10", "title": "Long Short-Term Memory"}, {"paperId": "f6d8a7fc2e2d53923832f9404376512068ca2a57", "title": "Hierarchical Mixtures of Experts and the EM Algorithm"}, {"paperId": "c8d90974c3f3b40fa05e322df2905fc16204aa56", "title": "Adaptive Mixtures of Local Experts"}, {"paperId": "77e73174e606c0820a52a940088832b32d9a033e", "title": "Efficient Large-Scale Language Model Training on GPU Clusters"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": "cd18800a0fe0b668a1cc19f2ec95b5003d0a5035", "title": "Improving Language Understanding by Generative Pre-Training"}, {"paperId": null, "title": "we have designed two losses to align the best experts of local and global, so that the experts we selected through hierarchical routing will be the most suitable ones among all the experts"}]}