{"paperId": "cf188f980d987d70358e414f44505e8427496d08", "title": "IceFormer: Accelerated Inference with Long-Sequence Transformers on CPUs", "abstract": "One limitation of existing Transformer-based models is that they cannot handle very long sequences as input since their self-attention operations exhibit quadratic time and space complexity. This problem becomes especially acute when Transformers are deployed on hardware platforms equipped only with CPUs. To address this issue, we propose a novel method for accelerating self-attention at inference time that works with pretrained Transformer models out-of-the-box without requiring retraining. We experiment using our method to accelerate various long-sequence Transformers, including a leading LLaMA 2-based LLM, on various benchmarks and demonstrate a greater speedup of 2.73x - 7.63x while retaining 98.6% - 99.6% of the accuracy of the original pretrained models. The code is available on our project website at https://yuzhenmao.github.io/IceFormer/.", "venue": "arXiv.org", "year": 2024, "citationCount": 2, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This work proposes a novel method for accelerating self-attention at inference time that works with pretrained Transformer models out-of-the-box without requiring retraining and experiments using this method to accelerate various long-sequence Transformers."}, "embedding": {"model": "specter_v2", "vector": [0.37508830428123474, 0.6427348852157593, -0.46131154894828796, -0.10297882556915283, -0.3301606774330139, -0.28738531470298767, 0.4112982451915741, -0.1907375603914261, -0.38102221488952637, -0.17482340335845947, 0.5312842130661011, -0.04811288043856621, 0.8266487717628479, -0.0020326252561062574, -0.3534979820251465, -0.11795931309461594, -1.034403681755066, 0.18757547438144684, 0.16325952112674713, -0.14187096059322357, 0.2406318038702011, -0.48986849188804626, -1.2132456302642822, 0.14333602786064148, 0.7085365056991577, 1.2379615306854248, 0.03829239681363106, 0.7965994477272034, -0.5325533151626587, 0.4722033739089966, 0.6244404315948486, -0.44854962825775146, 0.22723399102687836, 0.0074066901579499245, -0.6393082737922668, -0.15252459049224854, 0.7330090999603271, -0.4426540434360504, -0.4348770081996918, 0.920246422290802, -0.40680572390556335, 0.36762216687202454, 0.23443034291267395, -0.8196585178375244, -0.11301523447036743, 0.5745859146118164, 0.650444507598877, 0.9394503831863403, -0.42949679493904114, -0.4039821922779083, 1.337303638458252, -1.1606781482696533, 0.07229874283075333, 1.1189874410629272, 0.6341992020606995, 0.30912867188453674, -0.042911894619464874, -0.7123240232467651, 0.5774521827697754, 0.598517894744873, -0.44557443261146545, -0.5056871771812439, 0.020619165152311325, 0.08664415776729584, 1.9701594114303589, -0.28098517656326294, 0.06331767141819, 0.6554211378097534, 0.19937631487846375, 1.5650842189788818, 0.08452656865119934, -0.46050557494163513, 0.09272920340299606, -0.16355781257152557, 0.392765611410141, 0.9802764654159546, -0.508317768573761, 0.24314314126968384, -0.981383740901947, -0.17941145598888397, 0.24961939454078674, 0.03937126323580742, 0.32461827993392944, -0.24766390025615692, -0.0943043902516365, 0.8175273537635803, 0.42562535405158997, 0.7994014024734497, -0.20652160048484802, 0.6196654438972473, 0.8254803419113159, 0.04628462344408035, 0.09151182323694229, 0.4364345073699951, 0.010650105774402618, 0.09466269612312317, -1.140790581703186, -0.029167285189032555, -0.1938924640417099, 1.011803150177002, -0.06327484548091888, 0.6079295873641968, -0.4874320328235626, -0.049407921731472015, 1.0738416910171509, 0.20176884531974792, 0.5645914077758789, -0.6245403289794922, -0.07994843274354935, -0.7363690137863159, -0.21604594588279724, -0.5763496160507202, -0.1167067438364029, -0.5900355577468872, -1.0998705625534058, -1.1770445108413696, -0.6290587782859802, 0.47672131657600403, -0.7948096990585327, 0.5196666121482849, -0.4048961102962494, 0.6232383251190186, -0.04854198545217514, 0.2584005892276764, 0.4479426145553589, 0.5979416370391846, 0.2189163714647293, -0.22201043367385864, 1.1017545461654663, -1.3618814945220947, -0.6369311213493347, -1.1624418497085571, 0.1811702400445938, 0.05413210764527321, 0.2176763117313385, -0.023761464282870293, -1.2415331602096558, -1.1225041151046753, -1.0167248249053955, -0.05156903713941574, -0.2766101062297821, -0.05763707309961319, 1.1222933530807495, 0.06925840675830841, -1.007562518119812, 0.8209741115570068, -0.5354734659194946, -0.013296718709170818, 0.6928185224533081, -0.07374618947505951, 0.36654460430145264, 0.04804321378469467, -1.405107855796814, 0.26300379633903503, 0.1429738700389862, -0.33076319098472595, -0.5106868147850037, -0.8437168002128601, -1.2124671936035156, 0.3653838634490967, 0.46491360664367676, -0.06769373267889023, 1.4016129970550537, -0.029185757040977478, -1.0354111194610596, 0.851350724697113, -0.5126163363456726, -0.417083740234375, 0.26434701681137085, -0.03972357511520386, -0.16807271540164948, -0.22969506680965424, -0.2120489925146103, 0.4139631390571594, 0.6831420660018921, -0.0577138215303421, -0.40544968843460083, -0.022204801440238953, -0.29888278245925903, -0.3089979588985443, -0.38348308205604553, 0.602636456489563, -0.46687614917755127, -0.2638271152973175, 0.3261875808238983, 0.4693404734134674, -0.08984596282243729, -0.3764480650424957, -0.3973951041698456, -1.11528742313385, 0.5796138048171997, 0.10807237029075623, 0.9974693059921265, -0.8891196846961975, -0.9802181720733643, -0.22029925882816315, -0.05023283138871193, -0.08021813631057739, -0.5733981728553772, 0.10756921768188477, -0.5126298666000366, 0.14615751802921295, -0.22709223628044128, -0.9513903856277466, 0.07997290790081024, -0.24243277311325073, -0.9919194579124451, -0.11059339344501495, -0.03903229162096977, 1.005526065826416, -1.2363440990447998, -0.02659674361348152, -0.19121670722961426, 0.2304699420928955, -1.1371878385543823, 1.3939208984375, -0.3439207375049591, -0.053565774112939835, 0.07908858358860016, -0.15444375574588776, 0.21280662715435028, -0.6840097904205322, 0.5356990694999695, -0.6805453896522522, 0.002034555422142148, 0.6348482370376587, -0.05817900225520134, 1.364197850227356, -0.45643147826194763, 0.6523410677909851, -0.36392566561698914, -0.6700116395950317, 0.25081363320350647, 0.07782097160816193, -0.0028491464909166098, -0.61937415599823, 0.3795095980167389, 0.11259035021066666, -0.6887282133102417, 0.11727792024612427, 0.7281391024589539, 0.8938900232315063, -0.18601948022842407, 0.27053627371788025, 0.5986213684082031, -0.13773247599601746, 0.38559064269065857, 0.3475642502307892, 0.6572771668434143, 0.46761295199394226, 0.4254920184612274, -0.22804751992225647, 0.5163354277610779, -0.6961506605148315, 0.050280701369047165, 0.5107021927833557, 0.5451335310935974, 0.5494197607040405, 0.34110522270202637, -1.0160839557647705, -0.5725371241569519, 0.13714730739593506, 0.43742650747299194, 1.4056732654571533, -0.27132901549339294, -0.11132178455591202, -0.9496290683746338, -0.3624151647090912, -0.4325396418571472, 0.20577174425125122, -0.4993070960044861, -0.4779224991798401, -0.32241904735565186, -1.0485912561416626, 0.9196110963821411, 0.416569322347641, 1.5002402067184448, -0.5974915623664856, -0.8038458824157715, -0.2710380256175995, -0.04328795522451401, -0.9736974239349365, -0.8051452040672302, 0.6576527953147888, -0.6843985319137573, -0.13140098750591278, 0.4639906883239746, -0.05112914368510246, 0.2171359807252884, -0.8571591377258301, 0.9156095385551453, -0.6231180429458618, -0.293624609708786, -0.06681129336357117, 0.6707296371459961, -0.33511245250701904, -0.6437925100326538, 0.3722430467605591, 0.21153023838996887, -0.04849841818213463, 0.5377918481826782, 0.113833948969841, 0.17911069095134735, -0.08778712898492813, -0.15247444808483124, -0.10455651581287384, 0.1176503598690033, 0.16618485748767853, 0.6126606464385986, -0.34827086329460144, -0.011906536296010017, -1.202782154083252, 0.5342807173728943, 0.36409884691238403, -0.5077017545700073, 0.11621301621198654, -0.9440887570381165, 0.09163352847099304, 0.6915178894996643, -0.6536507606506348, -0.2536945939064026, -0.68793123960495, 0.10518645495176315, -0.6454386115074158, -0.13602109253406525, -0.2977380156517029, 0.17432446777820587, 0.09377466887235641, 0.25418031215667725, 0.7997246384620667, 0.30124932527542114, -0.014975548721849918, 0.24321536719799042, -0.9222670793533325, 1.0208264589309692, 0.30136534571647644, 0.12785513699054718, -0.17367999255657196, 0.01823573000729084, -0.5610799789428711, -0.7600894570350647, -0.37515732645988464, -0.3082543909549713, -0.2154068499803543, 0.3459823429584503, -0.45285096764564514, -1.174270510673523, 0.18033243715763092, -0.9015995860099792, -0.35028982162475586, 0.3362802565097809, -0.27092891931533813, -0.37329578399658203, -0.8339762687683105, -1.1914507150650024, -0.5938230156898499, -1.1962090730667114, -1.0543055534362793, 0.27025675773620605, 0.17728517949581146, -0.18939551711082458, -0.592182993888855, -0.20138198137283325, -0.389652281999588, 1.2624341249465942, -0.6335760354995728, 0.5270593762397766, -0.23141388595104218, -0.4853377342224121, 0.03331183269619942, 0.153507798910141, 0.44812342524528503, -0.21388936042785645, -0.04483621194958687, -1.1405096054077148, 0.2155264914035797, -0.025126958265900612, -0.32633641362190247, 0.1332174688577652, 0.13078299164772034, 0.8877325654029846, -0.2770422399044037, -0.45649534463882446, 0.5858122706413269, 1.5092734098434448, -0.4434898793697357, 0.3594129681587219, 0.32665449380874634, 0.7828038334846497, -0.3561583161354065, 0.1862342357635498, 0.5378087759017944, 0.17564871907234192, 0.25029298663139343, 0.373662531375885, 0.04877424240112305, 0.2818368077278137, -0.28159481287002563, 0.516716480255127, 1.3943157196044922, 0.39492541551589966, 0.34914645552635193, -1.0015605688095093, 0.7245610952377319, -0.8223109841346741, -1.0774506330490112, 0.8448628783226013, 0.5849197506904602, 0.594015896320343, -0.2885648310184479, -0.3911137878894806, -0.16317875683307648, 0.31786707043647766, 0.47604766488075256, -0.779214084148407, -0.8389213681221008, 0.17525449395179749, 0.6140535473823547, 0.320611834526062, 0.48161086440086365, -0.4377073049545288, 0.4776603877544403, 15.121739387512207, 0.7382798790931702, -0.11667811870574951, 0.5508518815040588, 0.9737592935562134, 0.45594003796577454, -0.22407492995262146, -0.08075204491615295, -1.062582015991211, -0.06238989159464836, 1.374001383781433, 0.3076925575733185, 0.5532029271125793, 0.5370944142341614, -0.16575852036476135, 0.15861274302005768, -0.5100282430648804, 0.6870121359825134, 0.7803598046302795, -1.3782904148101807, 0.05356381833553314, 0.03794384002685547, 0.15797030925750732, 0.3668379783630371, 0.5969672799110413, 0.7228036522865295, 0.5877416729927063, -0.1456119865179062, 0.328316867351532, 0.37949860095977783, 1.1347931623458862, -0.24056075513362885, 0.5997752547264099, 0.0968688502907753, -0.921511709690094, -0.08099120855331421, -0.6073353886604309, -0.8933800458908081, -0.04463091865181923, 0.21505112946033478, -0.6986321210861206, -0.3702848255634308, 0.16879518330097198, 0.7694733738899231, 0.014874872751533985, 0.4305785298347473, -0.21501892805099487, 0.6162090301513672, 0.2672717273235321, 0.18307167291641235, 0.49311909079551697, 0.29674530029296875, 0.00776931457221508, -0.2182486653327942, -0.028527017682790756, 0.07446712255477905, 0.013015319593250751, 0.3548648953437805, -0.37732961773872375, -0.4974324107170105, -0.0576179176568985, -0.20939992368221283, 0.03528996556997299, 1.02346932888031, 0.5522144436836243, 0.03381966054439545, -0.11139693111181259, 0.382213830947876, 0.431233674287796, -0.18822768330574036, -0.910496175289154, -0.17299260199069977, 0.41751134395599365, -0.6621074676513672, 0.18426819145679474, 0.8034546971321106, -0.26587817072868347, -0.5744418501853943, -0.9452525973320007, -0.8059833645820618, 0.5156092047691345, -0.8354150056838989, -0.43506085872650146, 1.2041646242141724, -0.464351087808609, -0.38100555539131165, 0.13687962293624878, -0.5836330056190491, -0.313656210899353, 0.04356621578335762, -1.187303066253662, -0.41300129890441895, -0.07506389915943146, -0.5075884461402893, -0.24637293815612793, -0.012852110899984837, 1.1054856777191162, 0.25252610445022583, -0.18606775999069214, 0.22202210128307343, -0.12964385747909546, -0.07183384150266647, -0.18025244772434235, -0.7887824177742004, 1.1007508039474487, 0.3931445777416229, -0.22757229208946228, 0.32414790987968445, 0.25868555903434753, 0.3361060917377472, -0.8079462647438049, -0.0753699541091919, 0.500092089176178, -0.8779470920562744, -0.17737440764904022, -0.9155458211898804, -1.0113248825073242, 0.4810900390148163, 0.7091479897499084, 0.006775030866265297, 0.08406399190425873, -0.12521927058696747, -0.6570680737495422, -0.4254801869392395, -0.678101122379303, -0.25177910923957825, 0.7485091686248779, -0.8324036002159119, -0.3275846838951111, -0.44772934913635254, 0.23061275482177734, -1.0352728366851807, -0.6613190770149231, -0.12088736146688461, 0.2109592854976654, -0.25446033477783203, 1.016419529914856, -0.18128080666065216, 0.6382639408111572, 1.0283479690551758, 0.09309541434049606, -0.570405125617981, 0.01363322138786316, -0.7864450812339783, -0.08483132719993591, 0.13685058057308197, 0.36537960171699524, -0.35911989212036133, 0.4579535126686096, 0.5850892066955566, 0.22822710871696472, -0.5664330720901489, -0.6658931374549866, -0.27641406655311584, -0.338797390460968, -0.3696533441543579, 0.4293844997882843, 0.09630581736564636, -0.12761472165584564, 0.1777474731206894, 0.2646593153476715, 0.4890456795692444, 0.1635936051607132, -0.29820716381073, 0.20141443610191345, -0.11983225494623184, -0.02632082998752594, -0.321067214012146, -0.6559375524520874, -1.3010623455047607, 0.18446524441242218, -1.1198464632034302, 0.27529263496398926, -0.6643961071968079, -0.14702695608139038, 0.09581117331981659, -0.11232420057058334, 0.39358028769493103, 0.1742691844701767, -0.3108946681022644, -0.43998709321022034, -0.65195232629776, -0.7359498143196106, 0.8791918754577637, 0.5474359393119812, -0.7733985781669617, 0.35291215777397156, -0.22100691497325897, 0.13717356324195862, -0.007546593900769949, 0.3557291626930237, -0.37532955408096313, -0.7086948752403259, -0.841584324836731, 0.15094025433063507, -0.23690614104270935, -0.212484672665596, -0.8433458805084229, 0.7587367296218872, 0.4210638999938965, -0.24576592445373535, -0.15945854783058167, -0.007229948882013559, -0.9333660006523132, -0.41315650939941406, 0.7026386260986328, -0.7158389091491699, 0.44206181168556213, 0.42200925946235657, -0.6778621673583984, -0.16675902903079987, 0.6055543422698975, 0.2292056828737259, -1.07503080368042, -0.867776095867157, 0.5463555455207825, -0.6421069502830505, 0.31334608793258667, -0.345478355884552, 0.041975848376750946, -1.1089400053024292, -0.3269825279712677, 0.10216887295246124, 0.4445050358772278, -0.3704999089241028, 0.9730634689331055, 0.2982538640499115, -1.1281335353851318, 0.3046715557575226, 0.5732587575912476, -0.23152640461921692, 0.06411270797252655, 0.6291582584381104, 0.6516519784927368, -0.077957384288311, 0.5427120923995972, -0.16523407399654388, 0.15794329345226288, -0.7817094326019287, 0.2646355926990509, 0.9308958053588867, -0.8309720754623413, 0.039239756762981415, 0.9685356616973877, -0.31314727663993835, -0.9917135238647461, 0.232483372092247, -1.147375464439392, -0.5469977855682373, -0.11028114706277847, 0.7746769785881042, 0.21866783499717712, -0.015258407220244408, 0.13253508508205414, -0.9356021881103516, -0.02893543802201748, -0.16967521607875824, -0.2566082775592804, 0.9290068745613098, 0.11623635143041611, -0.56378173828125, 0.6209772229194641, 0.7876741886138916, -0.5708464980125427, -0.8342218995094299, -0.6090404987335205, -0.3941284120082855, -0.12940622866153717, 0.3046509921550751, -0.15389899909496307, -0.8721271753311157, 0.846571683883667, 0.6835315823554993, 0.06275132298469543, 0.3518831133842468, -0.3582705557346344, 0.3138252794742584, 0.688322126865387, 0.09336808323860168, -0.5704568028450012, -0.29027217626571655, 1.1580194234848022, 1.0094255208969116, -0.6720106601715088, 0.31335458159446716, -0.1240321546792984, -0.6295197010040283, 0.8636651635169983, 0.5868211984634399, -0.06835731863975525, 0.529539942741394, 0.011187725700438023, -0.06643136590719223, 0.18727591633796692, -1.2760696411132812, -0.24560771882534027, 0.6908413171768188, 0.9118088483810425, 0.5364733338356018, -0.22848950326442719, 0.5273497700691223, 0.8626649975776672, 0.17394818365573883, 0.09454577416181564, 0.6003105640411377, 0.2732887864112854, -0.21388264000415802, 0.17278963327407837, 0.07603370398283005, 0.7423152327537537, -0.7993572950363159, -0.8234532475471497, 0.5113832354545593, 0.43642306327819824, 0.0033939590211957693, 0.33115947246551514, 1.1749099493026733, -0.026845591142773628, 0.33725839853286743, 0.17239512503147125, 0.4805949628353119, -0.10411051660776138, -0.2573434114456177, -0.31578218936920166, -0.7797197699546814, -0.45582929253578186, -0.28554755449295044, -0.6628889441490173, -0.6146140694618225, -0.2280004322528839, 0.19455154240131378, 0.2873692512512207, 0.23311583697795868, 1.0512440204620361, 0.5629448890686035, 0.6856033205986023, -0.10320258140563965, -0.44550472497940063, -0.6977463960647583, -0.9993510246276855, 0.3535642623901367, -0.5538409948348999, -0.05554503947496414, -0.15763306617736816, -0.32184451818466187, -0.2100149542093277]}, "authors": [{"authorId": "2195055368", "name": "Yuzhen Mao"}, {"authorId": "2285253160", "name": "Martin Ester"}, {"authorId": "2300215737", "name": "Ke Li"}], "references": [{"paperId": "104b0bb1da562d53cbda87aec79ef6a2827d191a", "title": "Llama 2: Open Foundation and Fine-Tuned Chat Models"}, {"paperId": "eb511ae6b9f04e4936891d26787f274b48b99d57", "title": "ZeroSCROLLS: A Zero-Shot Benchmark for Long Text Understanding"}, {"paperId": "87c5b281fa43e6f27191b20a8dd694eda1126336", "title": "FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness"}, {"paperId": "1944cebf4e41a10ea7bd02ce30404c18c9c4e04f", "title": "Linear Complexity Randomized Self-attention Mechanism"}, {"paperId": "dbf53ece1a6a8860e41ff5f721c72ceb0fb18dd6", "title": "H-Transformer-1D: Fast One-Dimensional Hierarchical Attention for Sequences"}, {"paperId": "c1a4278f969acfc6682a924e31b95e1ade9703ee", "title": "Memory-efficient Transformers via Top-k Attention"}, {"paperId": "9ed25f101f19ea735ca300848948ed64064b97ca", "title": "Random Feature Attention"}, {"paperId": "4a9587ad4ed8f755e74524499452ea12bd6c7f3b", "title": "Optimizing Inference Performance of Transformers on CPUs"}, {"paperId": "6fa1cfc4f97f03a8485692418c7aa1a06c574a85", "title": "Nystr\u00f6mformer: A Nystr\u00f6m-Based Algorithm for Approximating Self-Attention"}, {"paperId": "7e9ff94476f41041c75e253e84f487db00e9c861", "title": "Long Range Arena: A Benchmark for Efficient Transformers"}, {"paperId": "3fbf6339273c50b04e886fa9bd4ad18c952a683d", "title": "Rethinking Attention with Performers"}, {"paperId": "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87", "title": "Linformer: Self-Attention with Linear Complexity"}, {"paperId": "d27669c82faf78ea08cceaa0a171b540cccc304d", "title": "ETC: Encoding Long and Structured Inputs in Transformers"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "055fd6a9f7293269f1b22c1470e63bd02d8d9500", "title": "Reformer: The Efficient Transformer"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "8a65888ea8199749f05b95471138fe9f1d946fb0", "title": "ANN-Benchmarks: A Benchmarking Tool for Approximate Nearest Neighbor Algorithms"}, {"paperId": "0d3c46a3cbfe06cec259fec954b6ff6df6c1a566", "title": "Learning long-range spatial dependencies with horizontal gated-recurrent units"}, {"paperId": "8b354d76813bd5375e7e5c8d17f630bec5936a01", "title": "ListOps: A Diagnostic Dataset for Latent Tree Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "36ec448cd2d202e0d0652d61770f8505e14e61fd", "title": "Fast k-Nearest Neighbour Search via Prioritized DCI"}, {"paperId": "50645e3dc912d597e89d59bffb96ccc0f8e1aefa", "title": "Practical and Optimal LSH for Angular Distance"}, {"paperId": "5b0a88bdec473552c6a386cd94fdac53c74b79a8", "title": "On Symmetric and Asymmetric LSHs for Inner Product Search"}, {"paperId": "7ae42cc4b475a2192707d0ada7b3c60c347b621e", "title": "Approximate Nearest Neighbor: Towards Removing the Curse of Dimensionality"}, {"paperId": "1c61f9ef06fe74505775a833ff849185757199e7", "title": "Learning Word Vectors for Sentiment Analysis"}, {"paperId": "e01eae8dea6fbaa1ae7fc83535053932268df430", "title": "The ACL anthology network corpus"}, {"paperId": null, "title": "How long can context length of open-source LLMs truly promise?"}, {"paperId": "5d90f06bb70a0a3dced62413346235c02b1aa086", "title": "Learning Multiple Layers of Features from Tiny Images"}, {"paperId": null, "title": "H _ 2 o"}, {"paperId": null, "title": "OpenAI"}]}