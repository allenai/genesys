{"paperId": "61203ec44f69a1bb6838f772940ea468b2b6f96e", "title": "Weighted Grouped Query Attention in Transformers", "abstract": "The attention mechanism forms the foundational blocks for transformer language models. Recent approaches show that scaling the model achieves human-level performance. However, with increasing demands for scaling and constraints on hardware memory, the inference costs of these models remain high. To reduce the inference time, Multi-Query Attention (MQA) and Grouped-Query Attention (GQA) were proposed in (Shazeer, 2019) and (Ainslieet al., 2023) respectively. In this paper, we propose a variation of Grouped-Query Attention, termed Weighted Grouped-Query Attention (WGQA). We introduced new learnable parameters for each key and value head in the T5 decoder attention blocks, enabling the model to take a weighted average during finetuning. Our model achieves an average of 0.53% improvement over GQA, and the performance converges to traditional Multi-head attention (MHA) with no additional overhead during inference. We evaluated the introduction of these parameters and subsequent finetuning informs the model about the grouping mechanism during training, thereby enhancing performance. Additionally, we demonstrate the scaling laws in our analysis by comparing the results between T5-small and T5-base architecture.", "venue": "", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A variation of Grouped-Query Attention, termed Weighted Grouped-Query Attention (WGQA), is proposed, introduced new learnable parameters for each key and value head in the T5 decoder attention blocks, enabling the model to take a weighted average during finetuning."}, "embedding": {"model": "specter_v2", "vector": [0.26254379749298096, 0.8817833065986633, -0.4735139012336731, -0.14717857539653778, -0.9088926911354065, -0.03584744781255722, 0.41630274057388306, -0.010627932846546173, -0.17964443564414978, -0.2941841185092926, 0.7250351309776306, 0.1904250979423523, 0.06734073162078857, -0.23575526475906372, 0.1595298945903778, 0.35225585103034973, -0.9799804091453552, 0.5403500199317932, 0.36443063616752625, -0.5743168592453003, -0.07976216077804565, -1.0310678482055664, -0.8433364629745483, 0.23469360172748566, 0.509596049785614, 0.7799674868583679, 0.3233143389225006, 0.7652905583381653, -0.15637262165546417, 0.3338189423084259, 0.3891814649105072, -0.5663744211196899, 0.04372910410165787, -0.0018215019954368472, -0.16324195265769958, -0.42872247099876404, 0.583371102809906, -0.4225502908229828, -0.2892613410949707, 0.8552566766738892, 0.18500401079654694, 0.21231572329998016, -0.00880588497966528, -0.8358268737792969, -0.47499948740005493, 1.0167994499206543, 0.9146540760993958, 0.8325537443161011, -0.20956657826900482, -0.7522052526473999, 1.826672077178955, -1.3777997493743896, -0.05823572725057602, 1.5265003442764282, -0.15011785924434662, 0.3323097825050354, -0.036373116075992584, -0.4936920702457428, 0.7397627830505371, 0.16226840019226074, -0.8222286105155945, -0.5149907469749451, -0.07238838076591492, 0.27145257592201233, 1.911989450454712, -0.18695460259914398, 0.14809738099575043, -0.12033124268054962, 0.20506983995437622, 1.384024977684021, -0.7011934518814087, -0.6601378321647644, -0.2929006814956665, -0.12539996206760406, 0.3476702570915222, 0.7919303774833679, -0.45152032375335693, -0.017418885603547096, -1.0406213998794556, -0.16528919339179993, 0.35266342759132385, -0.10329891741275787, 0.08529847860336304, -0.39623087644577026, -0.28242945671081543, 0.7816072106361389, 0.36610147356987, 0.7416002154350281, -0.267367422580719, 0.8267115354537964, 0.4266311526298523, 0.4376797080039978, 0.07077555358409882, 0.6003283858299255, -0.3225473165512085, 0.5976810455322266, -1.0945709943771362, 0.3121546506881714, -0.27652475237846375, 1.1493582725524902, -0.3039681613445282, 0.26551225781440735, -0.9310280084609985, 0.06729865074157715, 1.4413161277770996, 0.34428268671035767, 0.2744830846786499, -0.5436019897460938, 0.25636711716651917, -0.24103567004203796, 0.15147556364536285, -0.42787474393844604, -0.05240962654352188, -0.15777775645256042, -0.43845856189727783, -1.54446280002594, -0.4969395101070404, 0.6326074600219727, -0.6360365748405457, 0.6912001371383667, -0.5776293277740479, -0.13178177177906036, -0.23408952355384827, 0.23728442192077637, 0.5158897638320923, 0.21830439567565918, 0.4409249722957611, 0.29082101583480835, 1.3761667013168335, -0.5296677350997925, -0.5288035273551941, -1.1698532104492188, 0.4708027243614197, -0.2630726099014282, 0.5469862222671509, -0.2893015146255493, -1.4201440811157227, -0.915829598903656, -0.6949082612991333, -0.11591997742652893, -0.4067540466785431, -0.38127341866493225, 0.6546614170074463, 0.5726020932197571, -1.6869688034057617, 0.22240734100341797, -0.2739112675189972, -0.5472109317779541, 0.31302276253700256, 0.4434153437614441, 0.5081755518913269, -0.3242432177066803, -1.5730562210083008, 0.24594318866729736, -0.12793728709220886, -0.8484304547309875, -0.3379054665565491, -0.6597967743873596, -1.3627161979675293, 0.07085361331701279, 0.4118841886520386, -0.5276740789413452, 1.5684142112731934, 0.11134282499551773, -0.9983882904052734, 0.7613092064857483, -0.5837010741233826, 0.20113995671272278, -0.2829720675945282, -0.26398637890815735, -0.5990865230560303, -0.375667005777359, 0.13881459832191467, 0.34944942593574524, 0.4644061326980591, 0.05972332879900932, -0.3372393250465393, -0.2536235451698303, -0.25017547607421875, -0.10432015359401703, -0.4648520350456238, 1.2038724422454834, -0.951566219329834, -0.20855320990085602, 0.3619643747806549, 1.0241986513137817, -0.012587888166308403, -0.009212402626872063, -0.18761064112186432, -1.2308155298233032, 0.5607244968414307, -0.355729341506958, 1.2633543014526367, -0.7988958954811096, -0.552725076675415, -0.07811680436134338, -0.10458172112703323, -0.25853532552719116, -0.43176671862602234, 0.6457290053367615, -0.2936848998069763, 0.3526567220687866, 0.02141525410115719, -0.961130678653717, 0.40514838695526123, -0.3131181299686432, -0.6516234874725342, -0.6419790387153625, 0.07227487117052078, 1.327752947807312, -1.2482821941375732, -0.18635545670986176, -0.0711502656340599, 0.12544216215610504, -0.9834839105606079, 1.4572474956512451, -0.4439399838447571, 0.07776957005262375, -0.5701720118522644, 0.19709087908267975, -0.07246246188879013, -0.053237807005643845, 0.27770793437957764, -0.6034698486328125, -0.055072057992219925, 0.7629538774490356, 0.21049810945987701, 1.171390175819397, -0.43968820571899414, 0.12603090703487396, -0.0073594748973846436, -0.4221370816230774, 0.3359943628311157, 0.3518712818622589, -0.1690523624420166, -0.9921227693557739, 0.314395010471344, 0.3071611225605011, -0.5678001642227173, 0.19029222428798676, 1.0360027551651, 0.936491072177887, -0.9584632515907288, 0.024521177634596825, 0.8041124939918518, -0.6178356409072876, -0.0691353976726532, 0.648228108882904, 0.45388463139533997, 0.23129773139953613, 0.6985802054405212, -0.43390893936157227, 0.22029098868370056, -1.0302255153656006, -0.2798023819923401, 0.5760299563407898, 0.5450366139411926, 0.8522292971611023, 0.5519635677337646, -0.518998920917511, -0.19471494853496552, -0.11545813828706741, 0.8976612091064453, 1.8468968868255615, 0.036715250462293625, -0.19345857203006744, -0.6063504815101624, -0.17755796015262604, -0.3347932696342468, 0.40556806325912476, -0.2538035213947296, -0.34623026847839355, -0.5920992493629456, -0.7279042601585388, 0.7240889072418213, 0.3387087285518646, 0.8434100151062012, -0.7286835312843323, -0.23602455854415894, -0.14776788651943207, 0.35667890310287476, -0.6300123333930969, -0.8115778565406799, 0.5992715358734131, -0.39412689208984375, -0.11161602288484573, 0.3341299593448639, -0.48425719141960144, -0.1062244102358818, -0.8527114987373352, 1.2584649324417114, -0.453000545501709, 0.05051576346158981, 0.23008716106414795, 0.5599726438522339, -0.6956906318664551, -0.40931984782218933, 0.3050850033760071, 0.004747432190924883, -0.1231716126203537, 0.6515490412712097, 0.749630331993103, 0.06332740187644958, 0.19607754051685333, -0.39774537086486816, -0.17113225162029266, 0.12958914041519165, -0.020365867763757706, 0.5147138833999634, -0.7069618105888367, -0.04769805446267128, -0.9672595262527466, 0.7645984292030334, 0.17591315507888794, -0.8088692426681519, 0.3408852219581604, -0.5270442366600037, -0.1577455848455429, 0.3051818907260895, 0.07707180827856064, -0.24887888133525848, -1.108031153678894, 0.21283413469791412, -0.1207614317536354, 0.2434944212436676, 0.12599419057369232, -0.3071857988834381, 0.23016081750392914, -0.2609401345252991, 0.555050790309906, 0.2558279037475586, 0.006803867872804403, 0.4308996796607971, -0.6589193940162659, 0.35463887453079224, 0.10272825509309769, -0.10227885842323303, -0.477467805147171, -0.5300687551498413, -0.799021303653717, -0.11085282266139984, -0.33086320757865906, 0.08200761675834656, 0.006814209278672934, 0.4225865304470062, -0.5001057982444763, -0.7732338309288025, 0.18087100982666016, -0.885122537612915, -0.3594815731048584, 0.12053889036178589, -0.3963046669960022, 0.01184246689081192, -1.2676116228103638, -1.0910727977752686, -0.4472871422767639, -0.9562121033668518, -1.108424425125122, 0.5449391603469849, -0.04298287630081177, -0.5001330375671387, -0.44465577602386475, -0.34376558661460876, -0.40875276923179626, 1.2834672927856445, -0.9827158451080322, 1.1094228029251099, -0.4378020763397217, -0.4865769147872925, -0.3748009502887726, 0.1792968511581421, 0.19192329049110413, 0.08372048288583755, -0.24371337890625, -0.5828221440315247, 0.2812141478061676, -0.24435926973819733, -0.023861102759838104, -0.02731672115623951, 0.3502862751483917, 0.826465368270874, 0.16704551875591278, -0.3554074764251709, 0.14607232809066772, 1.280696153640747, -0.4226507544517517, 0.34483566880226135, 0.033789847046136856, 0.8666567206382751, 0.22729311883449554, 0.05759568139910698, 0.3690258860588074, 0.6314980983734131, 0.9187029600143433, 0.5926427245140076, 0.01600969396531582, -0.050158385187387466, -0.28750666975975037, 0.4352850019931793, 1.515285611152649, 0.4789709448814392, -0.29133376479148865, -0.9755555391311646, 1.0665290355682373, -0.8672723174095154, -0.4395253658294678, 0.6746384501457214, 0.8013513684272766, 0.14135421812534332, -0.37035346031188965, -0.37646064162254333, -0.3639105558395386, 0.38493651151657104, 0.31628432869911194, -0.0198016706854105, -0.7099164724349976, 0.288604736328125, 0.9271712899208069, 0.3256581723690033, 1.0402774810791016, -0.004209415055811405, 0.6764290928840637, 14.79328441619873, 0.5432201027870178, 0.06975675374269485, 0.6309655904769897, 0.3459561765193939, 0.2614484429359436, -0.5554670095443726, -0.23358459770679474, -1.2555360794067383, -0.041295066475868225, 1.0938578844070435, -0.29617545008659363, 0.5583014488220215, -0.03813428059220314, -0.06861520558595657, 0.20968413352966309, -0.6448280215263367, 0.2891256511211395, 0.7795696258544922, -0.6794610619544983, 0.5611116886138916, -0.0037749966140836477, -0.23076686263084412, 0.5892601013183594, 0.6462465524673462, 0.7602473497390747, 0.4994421899318695, -0.34055569767951965, 0.37377244234085083, 0.2414391189813614, 0.8673722743988037, -0.03099721670150757, 0.4215911030769348, 0.10162947326898575, -1.0101741552352905, -0.2775019705295563, -0.4884113371372223, -1.084954857826233, 0.2438906580209732, -0.12421552836894989, -0.6850462555885315, -0.47503551840782166, 0.14261476695537567, 0.37351492047309875, 0.1182532086968422, 0.35423165559768677, -0.3697182238101959, 0.6507357954978943, -0.0914476290345192, -0.27463117241859436, 0.0064965952187776566, 0.6245718598365784, -0.088961660861969, -0.35151469707489014, 0.08955856412649155, 0.0012192841386422515, -0.027527015656232834, 0.3856869041919708, -0.4624050557613373, -0.23553411662578583, -0.2260647565126419, 0.07354461401700974, 0.15334269404411316, 0.5937400460243225, 0.6119129061698914, 0.08784019201993942, -0.6337582468986511, 0.20700857043266296, 0.31395772099494934, -0.12588077783584595, -0.18490569293498993, -0.0409548282623291, 0.5182020664215088, -0.19123023748397827, 0.10657905042171478, 0.8079997301101685, 0.03857334330677986, -0.130204439163208, -1.0537687540054321, -0.46746647357940674, 0.7223110795021057, -0.9883410334587097, -0.5806325674057007, 0.9856415390968323, 0.04783203825354576, -0.49247488379478455, 0.17473702132701874, -0.5944668054580688, -0.20141378045082092, 0.45064470171928406, -1.2424074411392212, -0.9657161831855774, 0.0020038827788084745, -0.06169693544507027, -0.3705592751502991, 0.10716012120246887, 1.604288101196289, 0.26417872309684753, 0.03762728348374367, 0.1462564468383789, -0.3014262616634369, -0.037495989352464676, 0.002444047247990966, -0.9458111524581909, 1.1423357725143433, 0.30442431569099426, -0.2708337604999542, 0.32866615056991577, -0.16560488939285278, 0.2646446228027344, -0.8319193124771118, -0.12208070605993271, 1.2011867761611938, -1.0753264427185059, -0.12932519614696503, -0.9933593273162842, -0.7802079916000366, 0.7491385340690613, 0.8071873784065247, 0.011238561943173409, 0.30734017491340637, -0.037048473954200745, -0.26506924629211426, -0.436139851808548, -0.6845540404319763, -0.19792474806308746, 0.4185667634010315, -0.8886889815330505, -0.47106605768203735, -0.416863352060318, 0.8951269388198853, -1.0135235786437988, -0.6915469169616699, -0.5362053513526917, -0.042342983186244965, 0.16910159587860107, 1.0770025253295898, -0.3359594941139221, 0.17451533675193787, 0.8782482147216797, -0.38926759362220764, -0.8632979989051819, -0.23463205993175507, -0.6424770355224609, -0.011982548981904984, 0.10704438388347626, 0.7095193266868591, -0.40190941095352173, 0.3299333155155182, 0.9124768972396851, -0.00812122318893671, -0.37937629222869873, -0.4920976758003235, 0.12815871834754944, -0.17120495438575745, -0.5498923659324646, 0.7352256774902344, -0.1258918195962906, 0.11980470269918442, 0.12841925024986267, 0.4898701608181, 0.8444183468818665, -0.09994842857122421, -0.8861048817634583, 0.1327246129512787, -0.040521834045648575, 0.09037169814109802, -0.3988002836704254, -1.0143758058547974, -1.423205852508545, -0.3281501233577728, -0.8621899485588074, 0.14923202991485596, -1.0716893672943115, -0.5536131262779236, -0.07040774077177048, -0.6222054958343506, 0.2949689030647278, 0.09098542481660843, -0.08272799104452133, -0.40475404262542725, -0.7936604619026184, -0.8902841806411743, 0.7275530099868774, 0.668049156665802, -0.7029150724411011, 0.32577770948410034, -0.21146737039089203, -0.3332056701183319, -0.1243811622262001, 0.38867685198783875, -0.5186933279037476, -0.779430627822876, -1.478330135345459, 0.3047187328338623, 0.01341031864285469, 0.034799642860889435, -0.44184860587120056, 0.8624860644340515, 0.6224580407142639, -0.47423499822616577, -0.1942029446363449, 0.30069881677627563, -0.73857182264328, -0.8434051275253296, 0.3920867443084717, -0.6702766418457031, 0.022120365872979164, 0.3191787898540497, -1.0036894083023071, -0.5220806002616882, 1.1107542514801025, -0.20865055918693542, -1.026154637336731, -1.1679859161376953, 0.544262170791626, -0.6092110276222229, 0.4372450113296509, -0.28277459740638733, -0.17653851211071014, -0.8441590070724487, -0.6595061421394348, 0.10468222200870514, 0.5772298574447632, -0.4785863757133484, 0.9993536472320557, 0.5152994990348816, -1.0046077966690063, 0.03948193043470383, 0.5753222703933716, 0.2851247787475586, 0.054679349064826965, 0.06407292187213898, 0.45862528681755066, -0.03232546150684357, 0.6689475178718567, 0.13194739818572998, 0.19483716785907745, -0.9032232165336609, 0.04528195410966873, 0.8172191977500916, -0.30441024899482727, 0.2062797099351883, 1.4426478147506714, -0.640811026096344, -1.2193360328674316, -0.10916823893785477, -1.721496343612671, -0.4100133180618286, -0.18302781879901886, 0.7002272009849548, -0.20691350102424622, 0.44391077756881714, -0.053829506039619446, -0.753722071647644, 0.2418505847454071, -0.037249162793159485, -0.20950521528720856, 0.5100041031837463, 0.03268728405237198, -0.7835426926612854, 0.5092998743057251, 0.6891377568244934, -0.5388287305831909, -0.07593327015638351, -0.6473122239112854, -0.331267774105072, 0.10984237492084503, 0.4614275097846985, -0.1500242054462433, -0.8114280700683594, 0.7044116258621216, 0.5277283787727356, 0.6216171979904175, 0.41982945799827576, 0.1396438628435135, 0.17702366411685944, 0.31131070852279663, 0.7785559296607971, -0.11840552091598511, -0.5361862182617188, 1.083158016204834, 1.1540228128433228, -0.8501965999603271, 0.019502483308315277, -0.3001551330089569, -0.4404870867729187, 0.5633939504623413, 0.43845537304878235, 0.09973889589309692, 0.7329902648925781, 0.04586290568113327, 0.19238045811653137, -0.05301257595419884, -0.9408756494522095, -0.3518703877925873, 0.9079601168632507, 1.1182003021240234, 0.9710515141487122, 0.4415554702281952, 0.4630502462387085, 1.092840313911438, 0.2123187631368637, 0.23577123880386353, 0.09373939037322998, 0.5168558359146118, -0.3318791687488556, -0.16622813045978546, -0.1005200669169426, 0.8459604978561401, -0.5086954832077026, -1.132988691329956, -0.06663642078638077, 0.7961934804916382, 0.07867094874382019, 0.7119602560997009, 0.8613824844360352, -0.10434159636497498, 0.771068811416626, 0.038645923137664795, 0.4965585768222809, -0.8915765285491943, -0.3133290112018585, -0.44004714488983154, -0.3811562955379486, -0.37972569465637207, 0.11576471477746964, -0.35569700598716736, -0.32108408212661743, 0.09029331803321838, 0.2620548605918884, 0.004210288170725107, -0.08746898919343948, 0.8397653698921204, 0.5023423433303833, 0.6284853219985962, -0.5389127135276794, -0.274653822183609, -0.39635133743286133, -1.099478006362915, -0.10463833808898926, -0.6710212826728821, -0.017776886001229286, 0.03218315541744232, -0.14015880227088928, -0.6134690046310425]}, "authors": [{"authorId": "2311441969", "name": "Sai Sena Chinnakonduru"}, {"authorId": "2148772778", "name": "Astarag Mohapatra"}], "references": [{"paperId": "db229da82d4821446fb14d084ec58da7d964b7ce", "title": "OpenELM: An Efficient Language Model Family with Open Training and Inference Framework"}, {"paperId": "ac45bbf9940512d9d686cf8cd3a95969bc313570", "title": "OLMo: Accelerating the Science of Language Models"}, {"paperId": "83b90f4a0ae4cc214eb3cc140ccfef9cd99fac05", "title": "Efficient Memory Management for Large Language Model Serving with PagedAttention"}, {"paperId": "f4bdec0cf595720bc8ee5df2196324bac8f52ab4", "title": "Full Parameter Fine-tuning for Large Language Models with Limited Resources"}, {"paperId": "32ac52069e562d4f900afee70bdca63f53461481", "title": "QLoRA: Efficient Finetuning of Quantized LLMs"}, {"paperId": "5ae6fb6b5a3c7df515ff4a82ac9673bae6a8e200", "title": "GQA: Training Generalized Multi-Query Transformer Models from Multi-Head Checkpoints"}, {"paperId": "7da0f2501034522e3d50af7e9b8fa7ec9d7b65b6", "title": "GPTQ: Accurate Post-Training Quantization for Generative Pre-trained Transformers"}, {"paperId": "34b6698bd9ec014bc2de914bc3e5e2678fa4ae80", "title": "BLEU, METEOR, BERTScore: Evaluation of Metrics Performance in Assessing Critical Translation Errors in Sentiment-Oriented Text"}, {"paperId": "a8ca46b171467ceb2d7652fbfb67fe701ad86092", "title": "LoRA: Low-Rank Adaptation of Large Language Models"}, {"paperId": "dc52b09089704ebd6f471177474bc29741c50023", "title": "Fast Transformer Decoding: One Write-Head is All You Need"}, {"paperId": "00c957711b12468cb38424caccdf5291bb354033", "title": "ZeRO: Memory optimizations Toward Training Trillion Parameter Models"}, {"paperId": "a8e4580471908d17e279000d328f39654359bd6e", "title": "Beam Search Strategies for Neural Machine Translation"}, {"paperId": "30feade758d15844a5746fd0de7983d5a0e4af02", "title": "ROUGE 2.0: Updated and Improved Measures for Evaluation of Summarization Tasks"}, {"paperId": "9405cc0d6169988371b2755e573cc28650d14dfe", "title": "Language Models are Unsupervised Multitask Learners"}, {"paperId": null, "title": "2023. Focus: For tech giants, ai like bing and bard poses billion dollar search problem"}, {"paperId": null, "title": "2022. Efficiently scaling transformer inference"}]}