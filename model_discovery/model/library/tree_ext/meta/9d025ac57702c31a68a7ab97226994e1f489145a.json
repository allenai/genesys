{"paperId": "9d025ac57702c31a68a7ab97226994e1f489145a", "title": "A 28nm 57.6TOPS/W Attention-based NN Processor with Correlative Computing-in-Memory Ring and Dataflow-reshaped Digital-assisted Computing-in-Memory Array", "abstract": "Computing-in-memory (CIM) is an attractive approach for energy-efficient neural network (NN) processors. Attention mechanisms shows great performance in NLP and CV by capturing contextual knowledge from the entire tokens (X). The attention mechanism is essentially a content-based similarity search by computing attention probabilities (P) and final attention results (Att). For P, first, the query (Q) and the key (K) are computed by X and weight matrices $(\\text{W}_{Q}, \\text{W}_{K})$ respectively. Then, Q is multiplied by $\\text{K}^{T}($ QxK $^{T})$ for the attention score (S). Finally, P is computed by Softmax-activating S. For Att, V is obtained by multiplying X and a weight matrix $(\\text{W}_{V})$, and then, Att is computed by multiplying P and $\\text{V}(\\text{P}\\times \\text{V})$. As shown in Fig. 1, previous CIM chips face several challenges for P and Att computing [1, 2]. First, CIM shows great advantages only if multiplying a fixed matrix. But in P and Att computing, $\\text{W}_{Q}$, $\\text{W}_{K}, \\text{W}_{V}$ are fixed, involving in 15% computations in Longformer. Thus, most computations mismatch the traditional paradigm of CIM. Second, in QxK $^{T}$, 34.7% of the computations are redundant as many near-zeros from Softmax become zero after quantization. Third, CIM macros perform inner product naturally. For Att, V is generated row-by-row (i.e., token-wise), but in $\\text{P}\\times \\text{V}$, a column of V is left-multiplied by P (i.e., tokenacross). Only when V has been fully generated, can CIM macros perform $\\text{P}\\times \\text{V}$. Thus, Att computing cannot be fully pipelined, reducing system throughput. This paper presents a processor named AttCIM that solves these issues with three key features: 1) A correlative CIM ring (CRCIMR) to avoid it to load dynamically generated matrices. 2) A Softmax-based speculate unit (SSU) to eliminate redundant computations in $\\text{Q}\\times \\text{K}^{T}$. 3) A dataflow-reshaped digital-assisted CIM-array (DRCIMA) to achieve fully pipelined computations in $\\text{P}\\times \\text{V}$.", "venue": "International Symposium on Security in Computing and Communications", "year": 2022, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "A correlative CIM ring (CRCIMR) to avoid it to load dynamically generated matrices and a dataflow-reshaped digital-assisted CIM-array (DRCIMA) to achieve fully pipelined computations in P and Att computing."}, "embedding": {"model": "specter_v2", "vector": [0.5931383967399597, 0.36247479915618896, -0.6641591191291809, 0.354462593793869, -0.5279410481452942, 0.2796150743961334, 0.018006928265094757, 0.13418439030647278, -0.6664007306098938, -0.28286880254745483, 0.5158174633979797, 0.17547465860843658, 0.6493620276451111, -0.11637842655181885, 0.31976577639579773, -0.23085926473140717, -0.9275180101394653, -0.44345778226852417, 0.15011633932590485, 0.16304926574230194, 0.185211643576622, -0.6818612217903137, -1.0713053941726685, 0.5320906639099121, 0.04013784974813461, 1.2870843410491943, 0.4423949718475342, 0.7797935009002686, -0.3171590268611908, 0.42200952768325806, 0.24050669372081757, 0.0005084213917143643, -0.0038780933246016502, 0.14431677758693695, -0.14904941618442535, -0.7454656958580017, 0.37364450097084045, -0.12418056279420853, -0.590777575969696, 1.0397188663482666, 0.25923967361450195, 0.3390676975250244, 0.4632416069507599, -0.15390369296073914, -0.23978443443775177, 0.8866715431213379, 0.39679741859436035, 0.6480823159217834, -0.7229013442993164, -0.7697204351425171, 1.352729082107544, -1.3313120603561401, -0.2770257890224457, 1.118411660194397, 0.19047723710536957, 0.20072178542613983, 0.05344401299953461, -0.3955773413181305, 0.07113140821456909, 0.2276923805475235, -0.605750322341919, -0.6959406137466431, 0.32491281628608704, 0.14726348221302032, 1.8520879745483398, -0.1923980414867401, 0.2361714243888855, 0.07315889000892639, 0.2973659634590149, 1.2843573093414307, -0.3170340657234192, -1.1212965250015259, 0.09469166398048401, -0.36204156279563904, 0.8340390920639038, 0.7322777509689331, 0.32729917764663696, -0.3284723460674286, -1.2374945878982544, -0.17905227839946747, 0.3883456289768219, 0.5669400691986084, 0.7466002702713013, 0.21883264183998108, -0.34221673011779785, 0.47465962171554565, 0.37932828068733215, 0.8442179560661316, -0.28662586212158203, 1.201180100440979, 0.5647774338722229, 0.042136624455451965, -0.5157711505889893, 0.2721191644668579, 0.4416467547416687, 0.08471308648586273, -0.9076945185661316, -0.21289663016796112, -0.31947681307792664, 1.0472711324691772, -0.2758011221885681, 0.8200625777244568, -0.681604266166687, 0.4630412757396698, 1.2162617444992065, 0.4144992530345917, 0.5618624687194824, -0.24868905544281006, 0.32167279720306396, -0.7056746482849121, 0.08096209913492203, -0.5292152166366577, -0.16524343192577362, -0.23702372610569, -0.972279965877533, -0.9540225267410278, -0.5382640957832336, 0.21528054773807526, -1.2010376453399658, 0.19390159845352173, -0.7082036137580872, -0.17465218901634216, 0.304928719997406, 0.13894528150558472, 0.3286457359790802, 0.42516353726387024, 0.16361747682094574, 0.10158686339855194, 1.675833821296692, -1.303551197052002, -0.8957818150520325, -0.7419778108596802, -0.19985638558864594, -0.3309541642665863, -0.13812734186649323, -0.5916317701339722, -1.2721278667449951, -1.110548734664917, -0.9866766333580017, -0.2888416349887848, -0.6600571274757385, 0.08343787491321564, 0.7226666808128357, 0.657889187335968, -1.1947089433670044, 0.6390513181686401, -0.3870762586593628, -0.13561612367630005, 0.3413937985897064, 0.31196582317352295, 1.2062422037124634, 0.10765872150659561, -1.191149115562439, -0.01689746230840683, 0.08388908952474594, -0.33632832765579224, -0.11128880828619003, -0.3522098958492279, -0.5777252912521362, 0.36996927857398987, -0.08876717835664749, -0.6828650236129761, 1.1818724870681763, 0.222490131855011, -1.108633041381836, 0.21125683188438416, -0.4032473564147949, 0.08647262305021286, -0.5337568521499634, 0.10427785664796829, -0.9651160836219788, 0.020054932683706284, -0.4069273769855499, 0.41939130425453186, 0.7455820441246033, 0.07367326319217682, -0.06557542830705643, -0.3571487367153168, -0.6556351184844971, 0.06542620062828064, -0.7978337407112122, 1.089585781097412, -0.8866483569145203, -0.377204030752182, 0.8931135535240173, 0.6740702390670776, -0.4538935422897339, -0.10374204069375992, -0.5111212730407715, -0.5539993047714233, 0.7418855428695679, 0.7524936199188232, 1.1365015506744385, -1.0459680557250977, -1.620538592338562, 0.21100294589996338, -0.2390632927417755, -0.01928952895104885, -0.5799543261528015, 0.17755287885665894, -0.277172714471817, 0.12791229784488678, 0.6293588280677795, -0.551371693611145, -0.03735605627298355, -0.6486667394638062, -0.7896769046783447, -0.440153032541275, 0.09589935839176178, 0.961929202079773, -0.4721209704875946, 0.021422112360596657, -0.5855737328529358, 0.192641481757164, -0.4652315676212311, 0.7259567379951477, -0.13484974205493927, -0.4865694046020508, -0.34363090991973877, 0.5131831765174866, 0.1613863855600357, -0.1651686728000641, 0.5603070855140686, -0.8695864677429199, -0.29173073172569275, 0.19195261597633362, -0.21653708815574646, 1.5173203945159912, -0.0208372063934803, 0.5718060731887817, 0.33168482780456543, -0.2603592276573181, 0.3256158232688904, 0.48414164781570435, -0.1487082839012146, -0.7212550044059753, 0.6725825667381287, 0.11556144058704376, -0.299435019493103, 0.1538993865251541, 1.573490023612976, 1.658661961555481, -0.7264527082443237, 0.3069853186607361, 0.28854772448539734, -0.06133569777011871, 0.2922635078430176, 0.02446569874882698, 0.6623064875602722, -0.3280528783798218, 0.092322438955307, -0.28055450320243835, 0.07725122570991516, -1.1651880741119385, 0.12265308201313019, 1.0209401845932007, 0.026213347911834717, 0.5483260750770569, 0.33330410718917847, -0.725909411907196, -0.41773685812950134, 0.1917203813791275, 0.39909157156944275, 1.2599883079528809, -0.010932380333542824, 0.20181593298912048, -0.6943140029907227, 0.19353488087654114, -0.5555871725082397, -0.46306902170181274, 0.40351465344429016, 0.04013311117887497, -0.33990591764450073, -1.2208982706069946, 1.2421364784240723, 0.3144799470901489, 1.0810624361038208, -0.9872927665710449, -0.6844301223754883, -0.3510741591453552, 0.6528830528259277, -0.7953991293907166, -0.5534018874168396, 0.7778636813163757, -0.5787470936775208, 0.5217940211296082, -0.04635847732424736, -0.42693063616752625, 0.6289764642715454, -0.6028481721878052, 0.6138162016868591, -0.5309423804283142, -0.5558443665504456, -0.2642967402935028, 0.5627104043960571, -0.6965098977088928, -0.2988390624523163, 0.1201268807053566, 0.04761311411857605, -0.2547319829463959, 0.6953253149986267, -0.08830113708972931, -0.5239440202713013, -0.7698909640312195, 0.03249477967619896, -0.39263689517974854, 0.6872589588165283, -0.019449129700660706, 0.8218062520027161, -0.4976631999015808, 0.2644416391849518, -0.7980521321296692, 0.9760473370552063, 0.20101496577262878, -0.12640301883220673, -0.18298406898975372, -0.878829836845398, -0.1451680213212967, 0.5050173997879028, -0.3304104804992676, -0.11582860350608826, -0.7225174307823181, 0.37506479024887085, -0.34832972288131714, -0.15697120130062103, -0.13342909514904022, 0.07619129121303558, -0.083116315305233, 0.13918927311897278, 0.5487520098686218, 0.2250790148973465, 0.5090367794036865, 0.4583115577697754, -0.2160600870847702, 0.6783402562141418, 0.10290733724832535, -0.1240234449505806, 0.11862732470035553, -0.003746699308976531, -0.8243570923805237, 0.14249490201473236, -0.193156898021698, -0.1511736661195755, -0.320808470249176, 0.12196950614452362, -0.6125876903533936, -1.0103240013122559, -0.010860644280910492, -1.3528110980987549, 0.05323747545480728, 0.17928752303123474, -0.16489988565444946, 0.031508054584264755, -0.9936401844024658, -1.1192618608474731, -0.8867798447608948, -1.78411066532135, -1.0147265195846558, -0.04573604464530945, 0.5968348979949951, -0.4917641282081604, -0.17671048641204834, -0.4914490878582001, -0.47497764229774475, 1.4054601192474365, -0.6447634696960449, 0.5905065536499023, -0.03332320228219032, -0.3092862665653229, -0.09443484991788864, -0.12187720835208893, 0.16444852948188782, -0.41164520382881165, -0.028734633699059486, -1.1554582118988037, 0.7014425992965698, -0.1018955409526825, -0.11407502740621567, 0.8974104523658752, 0.4783783257007599, 1.0691994428634644, 0.5522228479385376, -0.675402820110321, 0.22248651087284088, 1.3517663478851318, 0.016393449157476425, 0.45578011870384216, -0.684045135974884, 0.6805499792098999, -0.5322505831718445, -0.18171057105064392, 0.5060385465621948, -0.3511049747467041, 0.508773148059845, 0.11000645160675049, -0.18791736662387848, -0.1743425577878952, 0.27125978469848633, 0.7151966094970703, 1.5238703489303589, 0.5362178087234497, 0.033518556505441666, -0.49307864904403687, 0.909834086894989, -1.1737418174743652, -0.5147389769554138, 0.4651281237602234, 0.6763319373130798, 0.4644874334335327, 0.006460567004978657, -0.5182715654373169, -0.2857109606266022, 0.6855003833770752, 0.6199084520339966, -0.4091353416442871, -1.1434681415557861, -0.11273679882287979, 0.421730101108551, 0.46272534132003784, 0.5909724235534668, -0.48720473051071167, 0.3892616033554077, 14.548216819763184, 0.9130723476409912, 0.09302795678377151, 0.42660146951675415, 0.48484569787979126, 0.006543989293277264, -0.16299042105674744, -0.2136457860469818, -1.2616548538208008, 0.23184962570667267, 1.5134776830673218, 0.5387796759605408, -0.006310019642114639, 0.47617456316947937, 0.1162337213754654, -0.09479717165231705, -0.46000850200653076, 0.7655429244041443, 0.6705994009971619, -1.2898801565170288, 0.1418209820985794, 0.213314950466156, 0.2442081868648529, 0.46378180384635925, 1.0087305307388306, 0.3606029152870178, 0.2334240823984146, -0.19088830053806305, 0.4790973365306854, 0.46098875999450684, 1.2020277976989746, -0.3184506893157959, 0.36825528740882874, -0.044186271727085114, -1.1787375211715698, -0.14437493681907654, -0.8018715381622314, -1.0729016065597534, -0.06234688311815262, 0.6174460649490356, -0.5131449699401855, -0.5595508217811584, -0.19379769265651703, -0.2602209746837616, 0.41488784551620483, 0.20841249823570251, -0.1545376181602478, 0.2938828468322754, 0.25585246086120605, -0.9257967472076416, -0.2845807373523712, 0.513526976108551, -0.10399926453828812, 0.3841065764427185, -0.21042358875274658, 0.010583089664578438, 0.10275967419147491, 0.6443703174591064, -0.7970248460769653, -0.6827634572982788, -0.1036483645439148, -0.19241034984588623, 0.029286092147231102, 1.2886912822723389, 0.3280143439769745, 0.18952201306819916, -0.49602383375167847, 0.3576277494430542, 0.21981140971183777, 0.00534915691241622, -0.25746750831604004, -0.912249743938446, 0.5987226963043213, -0.8164088726043701, 0.1788446456193924, 0.35453903675079346, -0.6457482576370239, -0.21317270398139954, -0.5473313331604004, 0.2184820920228958, 0.21511612832546234, -0.7198677062988281, -0.3686407804489136, 1.2109310626983643, -1.1443382501602173, -0.16980428993701935, 0.6126918792724609, -0.9741914868354797, -0.6062460541725159, 0.6117361187934875, -1.5050140619277954, -0.20171436667442322, 0.14782950282096863, -0.1884353905916214, -0.5499565601348877, 0.2728758454322815, 1.453003168106079, 0.24272318184375763, -0.6710769534111023, 0.0938449278473854, 0.2773047685623169, 0.2934621572494507, 0.08697453886270523, -0.44808781147003174, 0.8530909419059753, 0.7356693744659424, -0.53469318151474, 0.1132945641875267, -0.5172693133354187, 0.2773931622505188, -1.1864663362503052, -0.348993718624115, 0.6850671172142029, -0.1864999234676361, -0.5489864349365234, -0.923650324344635, -0.45549097657203674, -0.1864701360464096, 0.9376555681228638, -0.025471407920122147, 0.3451615273952484, 0.06499342620372772, -0.35510408878326416, -0.5920647382736206, -0.32104501128196716, 0.6247400641441345, 0.33568206429481506, -1.0614588260650635, -0.050679128617048264, -0.27668195962905884, 0.41528305411338806, -1.1223227977752686, -0.7808828949928284, -0.41597506403923035, 0.2918863296508789, -0.012897700071334839, 1.0713121891021729, 0.11873388290405273, 0.7294797897338867, 0.4792635440826416, 0.06843383610248566, -0.2779902517795563, -0.1490480601787567, -0.913711667060852, -0.15428683161735535, 0.26737698912620544, 0.6063361167907715, -0.009213179349899292, 0.8618883490562439, 1.1273255348205566, 0.04726679250597954, -0.5224736332893372, -0.753633975982666, 0.04033134877681732, -0.7463388442993164, -0.7406466007232666, 0.3003630042076111, -0.22537079453468323, 0.9024208188056946, -0.013846506364643574, 0.7512180805206299, 0.48548027873039246, -0.33744245767593384, -0.21100108325481415, -0.08723916113376617, 0.1696632355451584, 0.17619483172893524, -0.6906120181083679, -0.6498703956604004, -1.5143858194351196, -0.3797796964645386, -1.070508599281311, 0.25235193967819214, -0.451250821352005, -0.19121868908405304, -0.11215926706790924, -0.62921541929245, 0.15377120673656464, -0.041504617780447006, -0.2926703989505768, -0.4290197193622589, -0.5370652079582214, -0.6128402948379517, 0.5695443749427795, 0.5233955979347229, -0.8330386281013489, -0.017565209418535233, -0.5453774929046631, -0.15080058574676514, 0.1767624020576477, 0.46733617782592773, -0.2871774733066559, -0.5543467402458191, -1.3805738687515259, -0.2110876590013504, -0.15165750682353973, -0.3907429873943329, -1.2113877534866333, 1.564056158065796, 0.7246983051300049, 0.06425705552101135, -0.45092442631721497, 0.38983455300331116, -0.8757083415985107, -0.7626200914382935, 0.5789546370506287, -0.7535250186920166, 0.14705298840999603, 0.22432838380336761, -0.5073521733283997, -0.35247179865837097, 0.4365834891796112, -0.33461660146713257, -0.7112032175064087, -1.0262360572814941, 0.3240761458873749, -0.6657352447509766, -0.09833745658397675, -0.28214654326438904, -0.0498378686606884, -1.5368767976760864, 0.050059206783771515, 0.062312982976436615, 0.08503042161464691, -0.6898690462112427, 0.47030386328697205, 0.7434531450271606, -0.9929517507553101, 0.22288432717323303, 0.523604691028595, -0.5516138076782227, 0.241769939661026, 0.5414497256278992, 0.5715676546096802, -0.3791235089302063, 0.6049174070358276, 0.17034828662872314, 0.24988502264022827, -0.7916354537010193, 0.14621956646442413, 0.38596367835998535, -0.4754014015197754, 0.24859313666820526, 0.8454935550689697, -1.1157073974609375, -0.09933594614267349, 0.28221818804740906, -1.7448383569717407, -0.4831843674182892, -0.10261547565460205, 0.6519553661346436, 0.14300604164600372, 0.2797747552394867, 0.23082222044467926, -0.5381361246109009, 0.05360420048236847, -0.23081941902637482, -0.44341206550598145, -0.22338449954986572, 0.12223853915929794, -0.5585436224937439, 0.10847204178571701, 0.743768036365509, -0.5378022789955139, -0.5557671785354614, -0.8736526370048523, -0.18193091452121735, 0.13192816078662872, 0.2957540452480316, 0.08319021016359329, -0.7250819802284241, 0.6187522411346436, 0.9479994773864746, 0.4893638789653778, 0.25415724515914917, -0.2621084153652191, 0.3948591947555542, 0.5591974258422852, -0.1365123838186264, -0.9074148535728455, -0.5757852792739868, 1.3505635261535645, 0.8036327958106995, -0.4906587600708008, 0.5067696571350098, -0.39592134952545166, -0.28302040696144104, 1.3673067092895508, 0.2478574812412262, 0.4028667211532593, 0.964475691318512, 0.500341534614563, 0.18407292664051056, 0.11858213692903519, -0.9471248984336853, -0.4245700240135193, 0.10740771144628525, 0.9347218871116638, 0.7170401215553284, 0.4576966464519501, 0.3013821542263031, 1.2603907585144043, 0.7631030678749084, -0.05391079559922218, 0.4196789562702179, 0.48251378536224365, -0.295858770608902, -0.16353608667850494, -0.38332074880599976, 0.6974895596504211, -0.7054203152656555, -1.116487979888916, 0.6409583687782288, 0.2106974571943283, 0.23120291531085968, 0.7550753951072693, 1.5644279718399048, -0.2693462073802948, 0.37791383266448975, 0.0005185913178138435, 0.2352270781993866, -0.30602872371673584, -0.517627477645874, 0.11789658665657043, -0.5403361320495605, -0.26216572523117065, 0.03802160173654556, -0.4632369875907898, -0.7453198432922363, 0.06907295435667038, 0.28970348834991455, -0.08739073574542999, 0.6036938428878784, 0.387093722820282, 1.4287458658218384, 1.1552155017852783, -0.26625388860702515, -0.6362509727478027, -0.3027173578739166, -0.875817060470581, -0.11650710552930832, -0.8571546077728271, -0.06123942881822586, 0.5513615012168884, 0.11789872497320175, -0.221413716673851]}, "authors": [{"authorId": "37495246", "name": "Ruiqi Guo"}, {"authorId": "2068670866", "name": "Zhiheng Yue"}, {"authorId": "2156011088", "name": "Hao Li"}, {"authorId": "2112911817", "name": "Te Hu"}, {"authorId": "2107944078", "name": "Yabing Wang"}, {"authorId": "2118180003", "name": "Hao Sun"}, {"authorId": "2159499702", "name": "Jeng-Long Hsu"}, {"authorId": "153533962", "name": "Yaojun Zhang"}, {"authorId": "2036623", "name": "Bonan Yan"}, {"authorId": "25533190", "name": "Leibo Liu"}, {"authorId": "2152950782", "name": "Ru Huang"}, {"authorId": "1803672", "name": "Shaojun Wei"}, {"authorId": "145746022", "name": "Shouyi Yin"}], "references": [{"paperId": "7ca7fe437f3b8b0ae379c5533384d2fea0a4ac45", "title": "A 28nm 15.59\u00b5J/Token Full-Digital Bitline-Transpose CIM-Based Sparse Transformer Accelerator with Pipeline/Parallel Reconfigurable Modes"}, {"paperId": "24426f8bab670c51193806a95028fc92332bdfc3", "title": "A 6.54-to-26.03 TOPS/W Computing-In-Memory RNN Processor using Input Similarity Optimization and Attention-based Context-breaking with Output Speculation"}, {"paperId": "4d52abeb686fb710ce1849f568cf3402d8e0cbe8", "title": "A 2.75-to-75.9TOPS/W Computing-in-Memory NN Processor Supporting Set-Associate Block-Wise Zero Skipping and Ping-Pong CIM with Simultaneous Computation and Weight Updating"}, {"paperId": "925ad2897d1b5decbea320d07e99afa9110e09b2", "title": "Longformer: The Long-Document Transformer"}, {"paperId": "8691706ad0cf5e83969658b2e6bfffdc379440c9", "title": "Generating Wikipedia by Summarizing Long Sequences"}, {"paperId": null, "title": "A 28nm 27.5TOPS/W Approximate-Computing-Based Processor with Asymptotic Sparsity Speculating and Out-oforder Computing"}]}