{"paperId": "8cef9900c04d7f661c08f4b5b1ed4337ace042a3", "title": "Transformer Dissection: An Unified Understanding for Transformer\u2019s Attention via the Lens of Kernel", "abstract": "Transformer is a powerful architecture that achieves superior performance on various sequence learning tasks, including neural machine translation, language understanding, and sequence prediction. At the core of the Transformer is the attention mechanism, which concurrently processes all inputs in the streams. In this paper, we present a new formulation of attention via the lens of the kernel. To be more precise, we realize that the attention can be seen as applying kernel smoother over the inputs with the kernel scores being the similarities between inputs. This new formulation gives us a better way to understand individual components of the Transformer\u2019s attention, such as the better way to integrate the positional embedding. Another important advantage of our kernel-based formulation is that it paves the way to a larger space of composing Transformer\u2019s attention. As an example, we propose a new variant of Transformer\u2019s attention which models the input as a product of symmetric kernels. This approach achieves competitive performance to the current state of the art model with less computation. In our experiments, we empirically study different kernel construction strategies on two widely used tasks: neural machine translation and sequence prediction.", "venue": "Conference on Empirical Methods in Natural Language Processing", "year": 2019, "citationCount": 187, "influentialCitationCount": 15, "openAccessPdf": {"url": "https://www.aclweb.org/anthology/D19-1443.pdf", "status": "HYBRID"}, "tldr": {"model": "tldr@v2.0.0", "text": "A new formulation of attention via the lens of the kernel is presented, which models the input as a product of symmetric kernels and achieves competitive performance to the current state of the art model with less computation."}, "embedding": {"model": "specter_v2", "vector": [0.3741711676120758, 0.5524473190307617, -0.6120432019233704, -0.2532901465892792, -0.544431209564209, 0.09140166640281677, 0.5971201658248901, -0.14809001982212067, -0.4064277410507202, -0.5481523275375366, 0.7160934805870056, -0.1396578550338745, 0.1610623300075531, 0.03175533190369606, -0.3738700747489929, 0.028639111667871475, -0.3014909327030182, 0.40628382563591003, 0.20800520479679108, -0.44255390763282776, -0.005247318651527166, -0.8224654793739319, -0.747452437877655, 0.18665707111358643, 0.583949625492096, 0.8346480131149292, 0.5153669714927673, 0.7837622165679932, -0.24150517582893372, 0.3514212369918823, 0.8529815673828125, -0.6485183238983154, 0.3879779875278473, -0.15530048310756683, -0.6034525632858276, -0.335402250289917, 0.2562578618526459, -0.44709858298301697, -0.382801353931427, 1.066324234008789, -0.5790379643440247, 0.3365364372730255, 0.4985336661338806, -0.910869300365448, -0.602870523929596, 0.9974502325057983, 0.8114857077598572, 0.7116153240203857, -0.5993152260780334, -0.7769424915313721, 1.477797508239746, -1.3774306774139404, -0.05100785568356514, 1.1777867078781128, 0.6404634714126587, 0.07163107395172119, -0.31765466928482056, -0.24431513249874115, 0.4784577786922455, 0.5267459750175476, -0.5907378792762756, -0.3492908179759979, -0.16352136433124542, -0.13497792184352875, 1.4277621507644653, -0.5377340316772461, 0.129898801445961, 0.3673737943172455, 0.034946221858263016, 1.8764472007751465, -0.22717522084712982, -0.3841703534126282, -0.3218953013420105, 0.1242549940943718, 0.4128386676311493, 0.8761646151542664, -0.7848118543624878, 0.45276525616645813, -0.8977931141853333, -0.37268567085266113, 0.5747721791267395, 0.2874641716480255, 0.013955704867839813, -0.5757448673248291, -0.3855438232421875, 0.9551901817321777, 0.547494649887085, 0.41730254888534546, -0.5720218420028687, 0.9535492658615112, 0.7066625356674194, 0.2802658975124359, 0.22664132714271545, 0.28448691964149475, -0.052010420709848404, 0.1635701209306717, -0.7292692065238953, 0.09393609315156937, -0.25732529163360596, 0.9942845702171326, -0.04338248446583748, 0.21078933775424957, -0.6750853657722473, 0.15028923749923706, 1.2330888509750366, -0.050454240292310715, 0.16547022759914398, -0.44323158264160156, 0.003710906021296978, -0.5777093172073364, -0.20687547326087952, -0.5169488191604614, 0.4444373548030853, -0.025866761803627014, -0.6960484981536865, -1.0782979726791382, -0.4808856248855591, 0.5169978737831116, -0.8205091953277588, 0.6465193629264832, -0.47685307264328003, 0.44083619117736816, 0.14507810771465302, 0.3671022951602936, 0.3388650119304657, 0.6984522938728333, 0.19933630526065826, 0.49101850390434265, 0.9082604646682739, -0.9082648158073425, -0.7569650411605835, -0.6978920698165894, 0.7306076288223267, -0.612890899181366, 0.2929893434047699, -0.267865926027298, -1.1752846240997314, -1.0741300582885742, -0.8155958652496338, -0.030590098351240158, -0.5249361991882324, 0.40002989768981934, 0.8931953310966492, 0.16209402680397034, -1.0264389514923096, 1.228156566619873, -0.23576968908309937, -0.3206317722797394, 0.8527576923370361, 0.3431772291660309, 0.2351672500371933, -0.48222529888153076, -1.3922231197357178, 0.7424817681312561, 0.1558573991060257, -0.5687024593353271, -0.2820531725883484, -1.056821584701538, -1.254978060722351, 0.21717427670955658, 0.23768429458141327, -0.5716078877449036, 1.4164515733718872, -0.28440722823143005, -1.4318877458572388, 0.26437756419181824, -0.481294721364975, 0.09296268224716187, -0.0806514099240303, -0.3460928797721863, -0.07860873639583588, -0.764557957649231, -0.039522960782051086, 0.049630966037511826, 0.6348264217376709, 0.38680920004844666, -0.4495978057384491, 0.14586417376995087, -0.565718412399292, -0.09371016919612885, -0.2737610340118408, 0.9084227681159973, -0.19182926416397095, -0.33984819054603577, -0.03915601223707199, 0.6664852499961853, 0.08951348811388016, -0.40780454874038696, -0.05191466212272644, -1.4490348100662231, 1.1231884956359863, 0.08570186048746109, 0.6606631875038147, -0.8717860579490662, -0.06355920433998108, -0.24470609426498413, -0.03765619173645973, -0.03542192652821541, -0.6869094371795654, 0.5906965732574463, -0.38308146595954895, -0.1346147358417511, -0.04630180075764656, -0.8881558775901794, -0.004845514427870512, -0.27161967754364014, -0.8443273901939392, -0.16044293344020844, 0.32598164677619934, 1.3552887439727783, -1.1443477869033813, 0.4613722562789917, -0.13071070611476898, 0.25699082016944885, -0.7683917880058289, 1.3906261920928955, -0.0223328098654747, -0.35430699586868286, -0.1892014890909195, -0.2791871130466461, -0.00889950804412365, -0.3801473379135132, 0.03979462385177612, -0.871465265750885, 0.08580804616212845, 0.5051661133766174, -0.02626967430114746, 1.542488932609558, -0.09591425210237503, 0.7450914978981018, -0.3368619680404663, -1.1888633966445923, 0.4581889808177948, 0.602594792842865, -0.21612410247325897, -0.3965437412261963, 0.2685066759586334, 0.5996155738830566, -0.6683011054992676, 0.36837127804756165, 0.75629723072052, 0.5163908004760742, -0.3347907066345215, 0.43168753385543823, 0.6951940059661865, -0.15355250239372253, -0.25178027153015137, 0.6548470854759216, 0.5062604546546936, 0.6558600068092346, 0.4678550362586975, -0.34267446398735046, -0.11933767795562744, -0.7199150919914246, -0.097312793135643, 0.45256930589675903, 0.5672976970672607, 0.6522133946418762, 0.3609587848186493, -0.9205413460731506, -0.5379987359046936, -0.5892381072044373, 0.8055620789527893, 1.629408359527588, -0.10057401657104492, -0.38543757796287537, -0.48665836453437805, -0.34538590908050537, -0.04283168166875839, -0.03308233618736267, -0.8025215864181519, -0.7916634678840637, -0.28169867396354675, -1.297344446182251, 1.0362114906311035, 0.6402507424354553, 0.9387351274490356, -0.29462605714797974, -0.2725464999675751, -0.16379423439502716, 0.11176566034555435, -0.6402495503425598, -1.0582455396652222, 0.4537051022052765, -0.48177003860473633, 0.05160076543688774, 0.21245484054088593, 0.09091342240571976, -0.09184326231479645, -0.579185426235199, 0.6152237057685852, -0.776730477809906, -0.3208807110786438, 0.21048256754875183, 0.3918677568435669, -0.9009575843811035, -0.7433302402496338, 0.49769312143325806, 0.1454363912343979, 0.18176892399787903, 0.4418811500072479, 0.637634813785553, 0.28365132212638855, 0.2131856232881546, -0.3084036409854889, 0.2233300656080246, 0.26870375871658325, 0.3021002411842346, 0.33871448040008545, -0.4670911431312561, 0.04341745749115944, -0.8713172078132629, 0.9853119850158691, 0.10303007066249847, -0.32824426889419556, 0.3156328797340393, -0.7520023584365845, -0.1323084682226181, 0.3440396785736084, -0.7452472448348999, -0.1980830579996109, -0.9141333699226379, 0.42530539631843567, -0.5848932266235352, 0.029282815754413605, 0.2451045662164688, 0.31475257873535156, 0.2608739733695984, 0.16502763330936432, 0.6405945420265198, 0.7305663824081421, -0.178142249584198, 0.5523385405540466, -0.9438140988349915, 0.39552614092826843, 0.31662651896476746, 0.16911441087722778, -0.0652703046798706, -0.16623057425022125, -0.6413130164146423, -0.5093369483947754, -0.43644964694976807, -0.2904321253299713, -0.06286522001028061, 0.3072892725467682, -0.4553149938583374, -1.0017660856246948, 0.061731044203042984, -1.1515954732894897, -0.17205692827701569, 0.02563135325908661, -0.02736353687942028, -0.5685719847679138, -1.3373769521713257, -1.167722225189209, -0.15236340463161469, -0.5687456130981445, -1.278899073600769, 0.2345895618200302, 0.02572074718773365, -0.374006062746048, -0.7611159682273865, -0.28771770000457764, -0.4055713713169098, 1.6327093839645386, -0.8893279433250427, 0.9826197624206543, -0.31134697794914246, -0.6466577053070068, -0.0368216298520565, -0.07338929176330566, 0.6820842027664185, 0.19328048825263977, -0.07689089328050613, -0.8322505950927734, 0.36608168482780457, -0.18970642983913422, -0.09585056453943253, 0.1944434493780136, 0.527417778968811, 0.33781903982162476, 0.2187567502260208, -0.5319256782531738, 0.5316901803016663, 1.236538052558899, -0.3631151616573334, 0.17682765424251556, 0.3467947244644165, 1.2928597927093506, 0.16506655514240265, -0.16225773096084595, 0.2139507234096527, 0.3790026009082794, 0.6991710066795349, 0.1771153062582016, -0.28374770283699036, 0.09362082928419113, -0.6425895690917969, 0.7135213613510132, 1.3476051092147827, 0.11717910319566727, 0.43031561374664307, -0.9715050458908081, 0.5738041400909424, -1.7309374809265137, -0.897606372833252, 0.7980286478996277, 0.6410586833953857, 0.1658002883195877, -0.7625300884246826, -0.1899344027042389, -0.4537731111049652, 0.3696564733982086, 0.12690870463848114, -0.23684483766555786, -0.6959527134895325, 0.39630189538002014, 0.5043438673019409, 0.3320280611515045, 0.895206868648529, -0.19993719458580017, 0.9366999268531799, 14.817593574523926, 1.082746982574463, -0.21141745150089264, 0.6765246391296387, 0.35427406430244446, 0.18325312435626984, -0.11713072657585144, 0.18099220097064972, -1.2874788045883179, 0.05199490487575531, 1.080219030380249, -0.31165212392807007, 0.4389018714427948, 0.09128589928150177, -0.03346932679414749, 0.3369220495223999, -0.8663917183876038, 0.6573778986930847, 0.5925840735435486, -1.6978137493133545, 0.6599466800689697, 0.4614050090312958, -0.1740354597568512, 0.5592591166496277, 0.9033337831497192, 0.6262837052345276, 0.4507453739643097, -0.7192546725273132, 0.6117143034934998, 0.33418989181518555, 0.592717707157135, -0.24438631534576416, 0.6187673807144165, 0.3379090130329132, -1.1410675048828125, -0.012280881404876709, -0.61176997423172, -0.8884230852127075, 0.5492488145828247, 0.06039458513259888, -0.6238782405853271, -0.0464993417263031, -0.19240707159042358, 1.2917393445968628, 0.40266716480255127, 0.25994449853897095, 0.016215112060308456, 0.6274204254150391, 0.11194717139005661, 0.2352261245250702, 0.47260525822639465, 0.18364834785461426, 0.10254663228988647, 0.17926764488220215, 0.34324899315834045, -0.25728365778923035, 0.21419042348861694, 0.6029621958732605, -0.3103931248188019, -0.0995190218091011, -0.555991530418396, -0.2255283147096634, -0.3196708858013153, 0.5181145668029785, 0.5606405735015869, -0.12941010296344757, -0.4054736793041229, 0.6507013440132141, 0.477234423160553, 0.001588163897395134, -0.44622424244880676, -0.4323495328426361, 0.7638624906539917, -0.26540860533714294, 0.11145157366991043, 0.7580986618995667, -0.2638663649559021, -0.3959360718727112, -0.9144601225852966, -0.28985655307769775, 0.29875871539115906, -0.7237875461578369, -0.7989467978477478, 0.8420588970184326, -0.09182848781347275, -0.30210039019584656, 0.5800110101699829, -0.7592426538467407, -0.37210813164711, 0.7864773869514465, -1.3513662815093994, -0.8193338513374329, 0.3560505509376526, -0.23458918929100037, -0.18775753676891327, -0.1229778304696083, 1.1869193315505981, 0.29649659991264343, -0.10238683968782425, -0.08094446361064911, -0.2779613137245178, 0.08385521918535233, -0.09436094015836716, -0.9216327667236328, 1.1976368427276611, -0.05435996130108833, -0.16334281861782074, 0.3010336756706238, -0.1301589012145996, 0.1495615690946579, -0.6978998780250549, -0.1727258861064911, 0.6698265075683594, -1.2108945846557617, -0.21455927193164825, -0.591591477394104, -1.034087896347046, 0.40986597537994385, 0.6575198769569397, -0.3968493342399597, 0.5513888597488403, 0.20790889859199524, -0.6093732118606567, -0.3163716793060303, -0.3089748024940491, -0.08881250768899918, 0.20529723167419434, -0.9811728000640869, -0.5978907346725464, -0.20077158510684967, 0.41855257749557495, -0.6975030303001404, -0.5534421801567078, -0.036974139511585236, 0.35367441177368164, 0.06353356689214706, 1.1785762310028076, -0.6758720278739929, 0.5874620079994202, 0.6967107653617859, 0.017733987420797348, -1.099642038345337, -0.4680119454860687, -0.8443818092346191, 0.32915306091308594, -0.07948804646730423, 0.48679399490356445, -0.4175426959991455, 0.275967001914978, 0.4682753086090088, 0.04543221741914749, -0.656145453453064, -0.30640465021133423, -0.326682984828949, -0.3237745761871338, -0.49542000889778137, 0.24073506891727448, 0.19827675819396973, 0.016214434057474136, 0.2783084809780121, 0.006073388736695051, 0.2956923246383667, 0.19930382072925568, -0.8021574020385742, 0.16330736875534058, -0.3406669497489929, 0.08776859939098358, -0.7540527582168579, -0.8327964544296265, -1.500744104385376, -0.05258507654070854, -1.5456405878067017, -0.04860417917370796, -0.9366679191589355, -0.30568620562553406, 0.18839146196842194, -0.48448967933654785, -0.007711474783718586, -0.04813733696937561, -0.5230072736740112, -0.3810192048549652, -0.7903240919113159, -0.10991605371236801, 1.0547053813934326, 0.7690780162811279, -0.5019859671592712, 0.24475868046283722, 0.032892607152462006, -0.07833951711654663, 0.33945563435554504, 0.2983560860157013, -0.6682926416397095, -0.8832014203071594, -1.3435872793197632, 0.14844512939453125, -0.14799872040748596, 0.08398251980543137, -0.15190082788467407, 1.0175949335098267, 0.2514282166957855, -0.2556636333465576, 0.033205948770046234, 0.5354630947113037, -0.7828792333602905, -0.3725578188896179, 0.41249343752861023, -0.780977725982666, 0.6086952686309814, -0.016831068322062492, -0.5099524855613708, -0.29684996604919434, 1.0769904851913452, 0.2169523984193802, -0.8485767245292664, -0.6122382283210754, 0.7391681671142578, -0.7074198722839355, 0.05895115062594414, -0.16654090583324432, -0.17807672917842865, -0.9459842443466187, -0.21391251683235168, 0.20959395170211792, 0.10011801868677139, -0.2403334230184555, 0.9340567588806152, 0.8159413933753967, -1.4135653972625732, 0.0896197184920311, 0.5251089930534363, 0.10470656305551529, -0.2433895617723465, 0.26035934686660767, 0.7178652882575989, 0.21341030299663544, 0.1595638245344162, 0.038094356656074524, 0.10691113770008087, -0.9716164469718933, -0.06895703822374344, 0.6156262159347534, -0.1953738033771515, -0.4914676249027252, 1.0673846006393433, -0.26604583859443665, -1.079179286956787, -0.046348005533218384, -1.3563655614852905, -0.15513914823532104, -0.23772379755973816, 0.6075349450111389, 0.28659018874168396, -0.30240994691848755, 0.07204966247081757, -0.4603724479675293, 0.21520517766475677, -0.2269761860370636, -0.4394575357437134, 0.5421805381774902, -0.006989020388573408, -0.6463794708251953, 0.5598695278167725, 0.7658977508544922, -1.1355620622634888, -0.408914715051651, -1.1618680953979492, -0.07962547242641449, -0.3949258327484131, 0.29091140627861023, 0.12387783825397491, -0.4854795038700104, 0.8783048391342163, 0.19284097850322723, 0.20363464951515198, 0.04526052996516228, 0.2908009886741638, 0.37504544854164124, 0.3501354157924652, -0.34062474966049194, -0.3650936186313629, -0.5390505194664001, 1.5765964984893799, 0.9127355813980103, -0.652558445930481, -0.04081161320209503, -0.49941161274909973, -0.756686270236969, 0.8239742517471313, 0.11593913286924362, -0.05091056600213051, 0.9894484281539917, 0.016324324533343315, 0.18107470870018005, 0.04718521609902382, -1.1885757446289062, -0.32294970750808716, 1.0323375463485718, 1.1943312883377075, 0.49030542373657227, 0.2519323229789734, 0.5352588891983032, 0.5214667320251465, 0.4638330340385437, 0.23154081404209137, 0.5311437845230103, 0.32016047835350037, -0.29466569423675537, -0.14589349925518036, 0.1339651644229889, 0.6819164156913757, -0.6555198431015015, -0.7452284693717957, 0.28331345319747925, 0.38955754041671753, 0.01966293342411518, 0.06391917914152145, 0.7079384326934814, 0.017521250993013382, 0.8588802218437195, 0.33465051651000977, 0.5034377574920654, -0.5752348899841309, -0.3430243730545044, -0.4823678433895111, -0.921525776386261, -0.21249759197235107, -0.13147422671318054, -0.5129774212837219, -0.2621946632862091, -0.16001208126544952, 0.36605456471443176, 0.24719378352165222, 0.21634501218795776, 1.1536670923233032, 0.6051545143127441, 0.5227589011192322, -0.4643595218658447, -0.5225113034248352, -0.5931951999664307, -0.7103490233421326, -0.051238901913166046, -0.14810340106487274, 0.0396093875169754, -0.2745477259159088, -0.07870844751596451, 0.056917596608400345]}, "authors": [{"authorId": "145639633", "name": "Yao-Hung Hubert Tsai"}, {"authorId": "35836381", "name": "Shaojie Bai"}, {"authorId": "50142992", "name": "M. Yamada"}, {"authorId": "49933077", "name": "Louis-Philippe Morency"}, {"authorId": "145124475", "name": "R. Salakhutdinov"}], "references": [{"paperId": "949fef650da4c41afe6049a183b504b3cc91f4bd", "title": "Multimodal Transformer for Unaligned Multimodal Language Sequences"}, {"paperId": "21da617a0f79aabf94272107184606cefe90ab75", "title": "Generating Long Sequences with Sparse Transformers"}, {"paperId": "faadd7d081c8d67e8c2567e8a5579e46cd6b2280", "title": "fairseq: A Fast, Extensible Toolkit for Sequence Modeling"}, {"paperId": "ce079b5a18054eb9434bf7032bcdffb599fd4f6e", "title": "Video Relationship Reasoning Using Gated Spatio-Temporal Energy Graph"}, {"paperId": "3694381e74445a8b9f8cb8d373e39626e47191b5", "title": "On the Turing Completeness of Modern Neural Network Architectures"}, {"paperId": "c4744a7c2bb298e4a52289a1e085c71cc3d37bc6", "title": "Transformer-XL: Attentive Language Models beyond a Fixed-Length Context"}, {"paperId": "512b8ef0002e0bfd0ecb5ab17d533c1762eb9786", "title": "Set Transformer"}, {"paperId": "fb507ada871d1e8c29e376dbf7b7879689aa89f9", "title": "Music Transformer: Generating Music with Long-Term Structure"}, {"paperId": "2cc859e3c9f25c1e0f803b9fe0f06f5fd55a9902", "title": "An Improved Relative Self-Attention Mechanism for Transformer with Application to Music Generation"}, {"paperId": "c8efcc854d97dfc2a42b83316a2109f9d166e43f", "title": "Self-Attention with Relative Position Representations"}, {"paperId": "921196c32213a229245a9705ee4768bc941e7a26", "title": "An Empirical Evaluation of Generic Convolutional and Recurrent Networks for Sequence Modeling"}, {"paperId": "1db9bd18681b96473f3c82b21edc9240b44dc329", "title": "Image Transformer"}, {"paperId": "8899094797e82c5c185a0893896320ef77f60e64", "title": "Non-local Neural Networks"}, {"paperId": "3fc5ed18c2294596af072df929c8ee12c71f96a2", "title": "Classical Structured Prediction Losses for Sequence to Sequence Learning"}, {"paperId": "204e3073870fae3d05bcbc2f6a8e263d9b72e776", "title": "Attention is All you Need"}, {"paperId": "cd1758d3b86c4f1caf01ec222b45daf15888d1a8", "title": "MMD GAN: Towards Deeper Understanding of Moment Matching Network"}, {"paperId": "efbd381493bb9636f489b965a2034d529cd56bcd", "title": "Pointer Sentinel Mixture Models"}, {"paperId": "34ab95637e7723302058f6526e33dc73857b9af2", "title": "Deep Kernel Learning"}, {"paperId": "cea967b59209c6be22829699f05b8b1ac4dc092d", "title": "Sequence to Sequence Learning with Neural Networks"}, {"paperId": "feca3cf344320e3d14045c3dcc8a9975f39c8791", "title": "What you saw is not what you get: Domain adaptation using asymmetric kernel transforms"}, {"paperId": "2196afb3829fb105222e55654ed3741192d6024f", "title": "Object Tracking by Asymmetric Kernel Mean Shift with Automatic Scale and Orientation Selection"}, {"paperId": "0eb36599c7e976b6e52a3693bbe30995cdbbb330", "title": "All of Nonparametric Statistics"}, {"paperId": "9c842b2926fd60b9e6ff80fee28c65e7c1ae5f1d", "title": "A non-local algorithm for image denoising"}, {"paperId": "fc8cda36a0972e7de1ac3a7bcb81dc32da79bee4", "title": "Learning with Kernels: Support Vector Machines, Regularization, Optimization, and Beyond"}, {"paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992", "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"}, {"paperId": null, "title": "Abhinav Gupta, and Kaiming He"}, {"paperId": null, "title": "linked the attention to the message passing in graphical models. In addition to the fundamental difference between graph-structured learning and kernel learning, the prior work"}, {"paperId": "665dfdaab947b770ec2f35a074d59395c9eda63d", "title": "Support Vector Classi er with Asymmetric Kernel Functions"}]}