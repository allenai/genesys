{"paperId": "69d64a3f4af4b7ee939be4c5772c891f08bf05a5", "title": "Constraint-Aware Diffusion Models for Trajectory Optimization", "abstract": "The diffusion model has shown success in generating high-quality and diverse solutions to trajectory optimization problems. However, diffusion models with neural networks inevitably make prediction errors, which leads to constraint violations such as unmet goals or collisions. This paper presents a novel constraint-aware diffusion model for trajectory optimization. We introduce a novel hybrid loss function for training that minimizes the constraint violation of diffusion samples compared to the groundtruth while recovering the original data distribution. Our model is demonstrated on tabletop manipulation and two-car reach-avoid problems, outperforming traditional diffusion models in minimizing constraint violations while generating samples close to locally optimal solutions.", "venue": "arXiv.org", "year": 2024, "citationCount": 0, "influentialCitationCount": 0, "openAccessPdf": null, "tldr": {"model": "tldr@v2.0.0", "text": "This paper introduces a novel hybrid loss function for training that minimizes the constraint violation of diffusion samples compared to the groundtruth while recovering the original data distribution in a constraint-aware diffusion model for trajectory optimization."}, "embedding": {"model": "specter_v2", "vector": [-0.2901393175125122, 0.17749109864234924, -1.0646092891693115, 0.09455550462007523, -0.05591879040002823, -0.0639747828245163, 0.04449254646897316, -0.22898542881011963, -0.5361241698265076, -0.15890856087207794, 0.009171568788588047, -0.24203148484230042, -0.46175575256347656, -0.3279697299003601, -0.4003616273403168, -0.015897439792752266, -1.1152665615081787, 0.45014506578445435, 0.11029739677906036, -0.3948252499103546, -0.33958879113197327, 0.10112264752388, -0.7594194412231445, -0.1593661606311798, 0.66566401720047, 0.5669814944267273, -0.2539241313934326, 1.024461030960083, 0.06565678864717484, 0.05441509932279587, 0.7954848408699036, 0.09478457272052765, 0.5552045702934265, 0.03497599437832832, 0.3127446174621582, -0.1746814250946045, -0.13553212583065033, -0.45163726806640625, -0.5615251660346985, 0.6436739563941956, -0.4450746178627014, 0.5617344975471497, 0.7710914611816406, -0.4878738820552826, -0.21198581159114838, -0.05524700507521629, 0.3264213800430298, 0.6064212918281555, 0.2507734000682831, -0.5518706440925598, 0.6747756600379944, -0.7429628372192383, 0.5069791078567505, 1.0377730131149292, 0.4315774738788605, 0.34448954463005066, 0.025362495332956314, -0.4993281662464142, 0.3534593880176544, -0.07320359349250793, -0.9242479205131531, 0.49079254269599915, -0.026408759877085686, -0.871006190776825, 1.0706884860992432, -0.3385775089263916, 0.2925550639629364, 0.8070868849754333, 0.42858773469924927, 1.5490493774414062, -0.1049010157585144, -0.3682270646095276, 0.3004051744937897, 0.38992828130722046, -0.10772445797920227, 0.957345187664032, -0.17149454355239868, 0.8813918828964233, -0.8183889389038086, 0.017122216522693634, 0.4684600830078125, 0.07614562660455704, 0.015895605087280273, -0.7400804162025452, 0.22022221982479095, 0.827442467212677, 0.4156280755996704, -0.03965749219059944, -0.43962040543556213, 0.6831228137016296, 0.11136040091514587, 0.2073620706796646, -0.2076503187417984, -0.061166197061538696, 0.5442453622817993, -0.1704053282737732, -0.7052658796310425, 0.5116972327232361, -0.11364522576332092, 1.1564831733703613, -0.19036801159381866, 0.1807597428560257, -0.6777190566062927, 0.11516320705413818, 1.2439326047897339, -0.07301370054483414, 0.3318719267845154, -0.513388454914093, 0.8386962413787842, -0.32692307233810425, 0.8856509327888489, -1.0329713821411133, -0.232533797621727, 0.06849589198827744, -0.5238358378410339, -0.028417296707630157, -0.2583402097225189, -0.5018360614776611, -0.8885632157325745, -0.01086620893329382, -0.010047132149338722, -0.1594516783952713, 0.019900986924767494, 0.9991927742958069, -0.5341641902923584, 0.67792147397995, -0.2703642249107361, 0.11857769638299942, -0.5973349213600159, -0.8401978611946106, -0.9911810159683228, -0.5476613640785217, 0.6407729387283325, -0.04205046594142914, 0.23769977688789368, 0.1028052568435669, -1.540550708770752, -0.953942596912384, -1.2559947967529297, 0.43655669689178467, -0.43296390771865845, 0.31046193838119507, 1.0910979509353638, 0.593709409236908, -0.10663466155529022, 1.0958064794540405, -0.772219181060791, -0.09131302684545517, 0.8427739143371582, 0.278106689453125, 0.5398789048194885, -0.3910246789455414, -0.4904929995536804, 0.8027637600898743, 0.4515591561794281, -0.5008783340454102, -0.530605673789978, -0.1967502236366272, -0.9899676442146301, -0.5359910130500793, 0.615028440952301, -0.0004832216363865882, 0.7051068544387817, 0.3789302408695221, -1.5341100692749023, -0.2145613431930542, 0.03391270712018013, 0.24405807256698608, 1.0971965789794922, -0.5427976250648499, -0.6692888736724854, -0.6451297402381897, -0.6626853346824646, 0.23232249915599823, 0.12427102029323578, -0.7265547513961792, -0.3571261465549469, 0.20284712314605713, -0.2928255796432495, -0.16877777874469757, -0.2940414249897003, 0.6064319014549255, -0.6304832696914673, -0.16506586968898773, 0.011766963638365269, 0.1517958641052246, -0.43095120787620544, 0.6757475137710571, -0.47729557752609253, -0.6585009098052979, 1.3041011095046997, 0.13038155436515808, 1.1494321823120117, -0.5449819564819336, -0.11378306150436401, 0.6777876019477844, -0.41272687911987305, 0.06632287800312042, -0.6205451488494873, 0.5390849113464355, 0.09986087679862976, 0.3332624137401581, -0.42913058400154114, -0.8187671303749084, 0.010401642881333828, 0.3594823181629181, -0.5149710774421692, 0.013864198699593544, -0.1682816594839096, 1.2364418506622314, -1.0811007022857666, 0.47116443514823914, 0.5890443921089172, -0.020557792857289314, -0.7783437967300415, 0.9986802339553833, -0.7367797493934631, 0.6438866257667542, -0.6285988092422485, 0.10509534180164337, 0.23605091869831085, 0.38475745916366577, 0.2138880044221878, 0.062407854944467545, 0.17877097427845, -0.18207475543022156, -0.9046298265457153, 1.6016708612442017, -0.21188032627105713, 0.4282103180885315, 0.053799018263816833, -0.382945716381073, 0.40479719638824463, 0.006383108906447887, 0.5244373083114624, -0.19613228738307953, 0.44497397541999817, 0.3499990999698639, -0.5505726933479309, -0.47332367300987244, 0.574293315410614, 0.93682861328125, -0.3934890627861023, 0.2778838574886322, -0.04341833293437958, -0.6656166911125183, 0.5978080630302429, 0.11200695484876633, 0.22768621146678925, 0.8963263630867004, -0.17979037761688232, 0.3992007374763489, -0.4829743206501007, -0.4476794898509979, -0.11980636417865753, 0.37454140186309814, 0.5224425792694092, 0.7586105465888977, 0.16565285623073578, -0.911539614200592, -0.1709759384393692, -0.5450757145881653, 1.0655033588409424, 0.5683443546295166, 0.32450053095817566, -0.22624412178993225, -0.47770562767982483, -0.8488951921463013, 0.15457119047641754, 0.3410983383655548, -0.751384437084198, -0.2100352793931961, -0.7497259974479675, -1.0824943780899048, 0.9142923951148987, 0.531624436378479, 0.9046469330787659, -0.002704730024561286, -0.269065260887146, -0.1321391612291336, 0.5933547019958496, -0.46381402015686035, -0.3703485429286957, -0.11069776117801666, -0.2797926366329193, -0.2344033569097519, 0.11524698138237, 0.395397424697876, -0.001984271453693509, -0.9663823246955872, 0.07349611818790436, -0.1287674456834793, -0.5300016403198242, 0.1302991360425949, 0.380666047334671, -0.938610851764679, -0.3003721237182617, 0.22493278980255127, 0.35960203409194946, -0.2165566384792328, -0.06650656461715698, 0.5643070936203003, 0.12835663557052612, 0.3147943615913391, -0.2799570560455322, -0.3206329643726349, -0.1293836086988449, -0.548455536365509, 0.5182764530181885, 0.1981334537267685, -0.12271220237016678, -0.37166106700897217, 1.623286247253418, -0.11885865777730942, -0.7386521697044373, -0.13530154526233673, -0.8817611932754517, -0.5515366792678833, 0.14206095039844513, -1.1238367557525635, -0.19294564425945282, -0.7082266807556152, 0.13199716806411743, -0.7422471642494202, -0.40683043003082275, 0.6820563673973083, 0.7990630865097046, -0.3615628480911255, 0.7686464786529541, -0.12713396549224854, 0.6269359588623047, -0.0005595466936938465, 0.6177459955215454, -0.6061133742332458, 0.2873608469963074, -0.19173644483089447, 0.23597067594528198, 0.17535127699375153, 0.08015701174736023, -0.7606006264686584, -0.36970824003219604, 0.02549213543534279, -0.5277475118637085, -0.8041161894798279, 0.3447299897670746, 0.028530849143862724, -0.8117912411689758, -0.5339991450309753, -0.6980533003807068, -0.8296995162963867, -0.08441271632909775, 0.32501012086868286, -0.4168291985988617, -1.0731420516967773, -0.8148800134658813, -1.0311870574951172, 0.3080129623413086, -1.3661288022994995, 0.15353688597679138, 0.22248348593711853, -0.5272067189216614, -0.8564069271087646, 0.0030731474980711937, -0.5933387279510498, 0.9107818603515625, 0.18253560364246368, 0.36223408579826355, 0.6086477041244507, -0.5807207226753235, -0.609138011932373, 0.6587345004081726, 0.2631904184818268, 0.0099101597443223, 0.4004269540309906, 0.07411390542984009, -0.1198774054646492, -0.2992209196090698, -0.5642905235290527, -0.13042767345905304, 0.17585207521915436, 1.0374802350997925, -0.03323748707771301, -0.9559507966041565, 0.28026166558265686, 1.287632703781128, -0.5224674344062805, 0.3586074709892273, 0.1259460598230362, 1.0612767934799194, 0.48064860701560974, 0.2287227064371109, 0.4559100568294525, -0.07145418226718903, 0.8433338403701782, 0.5100815296173096, 0.00041409494588151574, -0.052830811589956284, -0.7965824604034424, 0.18757599592208862, 0.9918005466461182, 0.053331416100263596, -0.23717167973518372, -0.8410767912864685, 0.5717283487319946, -1.6964290142059326, -0.5198240876197815, 0.2514253258705139, 0.826163649559021, -0.023933367803692818, 0.10600797832012177, 0.07174064964056015, -0.3876284062862396, 0.06578090041875839, 0.1278592050075531, -0.4555613398551941, -0.3861429691314697, 0.6870472431182861, -0.06266279518604279, 0.31732967495918274, 1.3690365552902222, -0.11611566692590714, 0.33997589349746704, 14.870105743408203, 1.1826465129852295, -0.12118295580148697, 0.45807796716690063, 0.010237883776426315, -0.16529874503612518, -0.024525586515665054, -0.5037684440612793, -0.9010345339775085, 0.37828370928764343, 0.7074029445648193, 0.36974990367889404, 0.7339980602264404, 0.3073042035102844, 0.3758709728717804, -0.08184743672609329, -0.3395019769668579, 0.5641856789588928, 0.2889500558376312, -1.3272695541381836, 0.09444700181484222, 0.31242406368255615, 0.5386847257614136, 0.5795082449913025, 0.9506020545959473, 0.41731327772140503, 0.4295707046985626, -0.7442413568496704, 0.724362850189209, 0.649716317653656, 1.0452035665512085, -0.5033824443817139, 0.1312868446111679, 1.1089563369750977, -0.7218641042709351, -0.32785871624946594, -0.5698413848876953, -0.9623026251792908, 0.9670559763908386, -0.06560462713241577, -0.2276288866996765, -0.035710565745830536, -0.16276724636554718, 0.7236851453781128, 0.5848203897476196, 0.48501917719841003, -0.45394545793533325, 0.46610742807388306, -0.35380038619041443, -0.27710211277008057, 0.434111088514328, -0.13085424900054932, 0.47474202513694763, -0.02328387089073658, -0.016367604956030846, -0.2754976153373718, 0.6470670104026794, 0.5647661685943604, -0.011508902534842491, -0.46054738759994507, -0.6006323099136353, 0.18211285769939423, -0.43739748001098633, 0.4949074685573578, 0.761132001876831, 0.4938414990901947, 0.23121865093708038, 0.3294045031070709, 0.6492772102355957, 0.402294397354126, -0.579401969909668, -0.21991123259067535, 0.5764942765235901, -0.18348461389541626, -0.16428756713867188, -0.4794621169567108, -0.668998122215271, -0.3659842908382416, -0.3653615117073059, -0.03660736605525017, -0.1166594922542572, -0.6110813021659851, -0.7788435816764832, 0.5293979644775391, 0.13563266396522522, -0.47583529353141785, 0.16017335653305054, -0.8966756463050842, -0.22425726056098938, 0.4041133522987366, -1.1275405883789062, -0.4197467565536499, 0.1403416097164154, -0.19411394000053406, -0.16606716811656952, 0.2926388382911682, 0.8021803498268127, 0.301405131816864, -0.522571325302124, -0.14727778732776642, 0.337924987077713, -0.23905298113822937, -0.4267579913139343, -0.5996455550193787, 0.35486292839050293, -0.08941802382469177, -0.3550496995449066, 0.2742796242237091, -0.3188806176185608, -0.7059206962585449, -0.4669427275657654, -0.43287208676338196, -0.6288650035858154, -1.279425859451294, -0.42388662695884705, -0.8727670311927795, -1.1257823705673218, 0.561887800693512, 0.28447967767715454, -0.2531536817550659, 0.23099753260612488, -0.29757729172706604, 0.34570008516311646, 0.26299604773521423, -0.9962085485458374, 0.4021889567375183, 0.3108077943325043, -0.13897265493869781, -0.33082088828086853, 0.23155763745307922, -0.12422234565019608, -1.7453588247299194, -0.6515855193138123, 0.1131332740187645, 0.3443044126033783, -0.11640433967113495, 1.1034111976623535, -0.4992271065711975, 0.43780913949012756, 0.5156994462013245, 0.16075335443019867, -0.9563055038452148, -0.008646596223115921, -0.8880522847175598, -0.09782351553440094, -0.46067696809768677, 0.5833320617675781, 0.008305436931550503, 1.067343831062317, 1.2125318050384521, 0.09616351872682571, -0.9153636693954468, -0.5666019916534424, -0.7586579918861389, 0.44732585549354553, -0.7478491067886353, 0.14724084734916687, -0.14052751660346985, -0.07560409605503082, -0.529960036277771, 0.043364524841308594, 0.7592434287071228, 0.047560419887304306, -0.9443503022193909, 0.5896453857421875, 0.3530433773994446, 0.2635980248451233, -0.6328219771385193, -0.08190462738275528, -1.9986975193023682, -0.3805113136768341, -1.2028446197509766, 0.12051936239004135, -1.2329176664352417, -1.2096185684204102, -0.33003148436546326, 0.1513739973306656, -0.4489853084087372, 0.7176321744918823, -0.9204217195510864, -0.5786741375923157, -0.3731512427330017, -0.36212781071662903, 1.0468782186508179, 1.1349624395370483, -0.6552044749259949, -0.3987959921360016, 0.374034583568573, 0.7303075790405273, 0.6309397220611572, 0.826636552810669, -0.7255668044090271, -0.9553877115249634, -1.212666630744934, 0.27557796239852905, -0.20770595967769623, -0.38672855496406555, -1.2014403343200684, 0.9898468255996704, -0.5460384488105774, 0.21664580702781677, -0.36101657152175903, 0.6807446479797363, -1.3080668449401855, -0.4724820554256439, 0.4000210165977478, -0.9118479490280151, -0.028510790318250656, 0.09662378579378128, 0.1944311112165451, 0.07893677055835724, 0.387834370136261, 0.2595670819282532, -0.571628987789154, -0.2154402881860733, 0.7320075035095215, -0.9728487730026245, 0.008713562972843647, 0.52321857213974, -0.3936357796192169, -0.7913737893104553, -0.4309549331665039, -0.41798135638237, 0.6266838312149048, -0.2733137011528015, 1.1387510299682617, 0.9355992078781128, -1.2615257501602173, 0.32759377360343933, 0.26022377610206604, -0.3570072650909424, 0.3235309422016144, 0.23332250118255615, 0.38348084688186646, -0.419034868478775, 0.08092110604047775, 0.12081633508205414, 0.27537769079208374, -0.198761448264122, 0.15698516368865967, 1.0113418102264404, -0.11286289244890213, -0.18697482347488403, 0.7178323268890381, -1.0574299097061157, -1.324485421180725, 0.5792481899261475, -1.262121319770813, -0.14060263335704803, -0.8739935755729675, 0.6351065635681152, 0.9820265769958496, -0.49909135699272156, 0.20165352523326874, -0.124185711145401, 0.6900772452354431, 0.01421398390084505, -0.5744233727455139, 0.18513040244579315, -0.39313164353370667, 0.3998357951641083, 0.6210697293281555, 0.31968969106674194, -0.35092833638191223, -1.2720378637313843, 0.1866501271724701, -0.38375744223594666, -0.7773209810256958, -0.06633801013231277, -0.7415468096733093, -0.8563877940177917, 0.6069074273109436, 0.7084066867828369, 0.060251954942941666, -0.42831510305404663, -0.24175088107585907, 0.5136295557022095, 0.5611231327056885, 0.3560613989830017, -1.1068148612976074, 0.03448302671313286, 0.779883086681366, 1.7030253410339355, -0.8649661540985107, 0.7365462779998779, -0.42540884017944336, -0.9379438161849976, 0.9753483533859253, 0.7694326043128967, -0.4159332811832428, 1.1912076473236084, -0.3319404721260071, 0.1251598298549652, 0.04543372616171837, 0.0166221521794796, -0.25235265493392944, 0.9231514930725098, 1.2906066179275513, -0.3537047505378723, 0.28926166892051697, 0.3335026502609253, 0.43401485681533813, 0.5713747143745422, 0.7010856866836548, 0.826284646987915, 0.8837694525718689, -0.14417150616645813, -0.4080031216144562, 0.07643985003232956, 0.6456265449523926, -0.4500650465488434, 0.5712068676948547, 0.19655200839042664, 0.9967420101165771, 0.36904874444007874, 0.9804905652999878, 0.4516648054122925, -0.409318208694458, 1.0216190814971924, -0.570261538028717, 0.4429362118244171, -0.5166842341423035, -0.1481066346168518, -0.2539915442466736, -0.6805723905563354, -0.6701348423957825, 0.16500656306743622, -0.33110231161117554, -0.5813642740249634, -0.270434707403183, 0.2482369989156723, -0.0391567125916481, 0.314397394657135, 0.8107824921607971, 0.5959481596946716, 0.2026376724243164, -0.4783269762992859, -0.7143747806549072, -0.2929947078227997, -0.45639166235923767, 0.038743603974580765, -0.539505660533905, 0.009527761489152908, -0.6770056486129761, -0.04604525864124298, -0.7182376384735107]}, "authors": [{"authorId": "2291290651", "name": "Anjian Li"}, {"authorId": "2291077410", "name": "Zihan Ding"}, {"authorId": "34205035", "name": "Adji B. Dieng"}, {"authorId": "2282077981", "name": "Ryne Beeson"}], "references": [{"paperId": "22079bd6fad4cf9f565f0657faf023c0ddf53370", "title": "Denoising Heat-inspired Diffusion with Insulators for Collision Free Motion Planning"}, {"paperId": "f5bc467cb7301acf93bc680cb9d4ad03cbc9df77", "title": "Compositional Diffusion-Based Continuous Constraint Solvers"}, {"paperId": "b90455dd822779a59d688d554092f7b08e62cdd2", "title": "Trajectory Generation, Control, and Safety with Denoising Diffusion Probabilistic Models"}, {"paperId": "74d4de69a1a81ad9a76abbfcffa24e186e96afd3", "title": "Diffusion Models for Black-Box Optimization"}, {"paperId": "345eb3195aac43eb5dcaacc0a7fd288be0fa4491", "title": "DiffDock-PP: Rigid Protein-Protein Docking with Diffusion Models"}, {"paperId": "bdba3bd30a49ea4c5b20b43dbd8f0eb59e9d80e2", "title": "Diffusion Policy: Visuomotor Policy Learning via Action Diffusion"}, {"paperId": "5f90d43e6ece5c6ee6e8186e4b57d46c85377713", "title": "DIFUSCO: Graph-based Diffusion Solvers for Combinatorial Optimization"}, {"paperId": "f19dfc360088922cf1d423c538662aae8d542c28", "title": "Is Conditional Generative Modeling all you need for Decision-Making?"}, {"paperId": "1a1a91f78ec32619a5b2a3b43e0b4d0f7ab97737", "title": "Diffusion Models Beat GANs on Topology Optimization"}, {"paperId": "af9f365ed86614c800f082bd8eb14be76072ad16", "title": "Classifier-Free Diffusion Guidance"}, {"paperId": "3ebdd3db0dd91069fa0cd31cbf8308b60b1b565e", "title": "Planning with Diffusion for Flexible Behavior Synthesis"}, {"paperId": "3b2a675bb617ae1a920e8e29d535cdf27826e999", "title": "Video Diffusion Models"}, {"paperId": "7dbb386a617eacc954940c9540d9cb262529b8b1", "title": "Equivariant Diffusion for Molecule Generation in 3D"}, {"paperId": "f23222ad51b9b1f4c1addcf848906db7698ccbff", "title": "Design-Bench: Benchmarks for Data-Driven Offline Model-Based Optimization"}, {"paperId": "c10075b3746a9f3dd5811970e93c8ca3ad39b39d", "title": "High-Resolution Image Synthesis with Latent Diffusion Models"}, {"paperId": "64ea8f180d0682e6c18d1eb688afdb2027c02794", "title": "Diffusion Models Beat GANs on Image Synthesis"}, {"paperId": "de18baa4964804cf471d85a5a090498242d2e79f", "title": "Improved Denoising Diffusion Probabilistic Models"}, {"paperId": "633e2fbfc0b21e959a244100937c5853afca4853", "title": "Score-Based Generative Modeling through Stochastic Differential Equations"}, {"paperId": "5c126ae3421f05768d8edd97ecd44b1364e2c99a", "title": "Denoising Diffusion Probabilistic Models"}, {"paperId": "6364fdaa0a0eccd823a779fcdd489173f938e91a", "title": "U-Net: Convolutional Networks for Biomedical Image Segmentation"}, {"paperId": "2dcef55a07f8607a819c21fe84131ea269cc2e3c", "title": "Deep Unsupervised Learning using Nonequilibrium Thermodynamics"}, {"paperId": "a6cb366736791bcccc5c8639de5a8f9636bf87e8", "title": "Adam: A Method for Stochastic Optimization"}, {"paperId": "7f4901362e8f8fe603ad90d6aba5f5192ef8ea8b", "title": "SNOPT: An SQP Algorithm for Large-Scale Constrained Optimization"}, {"paperId": "197179262942eec4207cd2f8f45938ab903823d0", "title": "Sequential Quadratic Programming"}, {"paperId": "e44417b55448796ace45374edcfea6ee5a347796", "title": "Sampling Constrained Trajectories Using Composable Diffusion Models"}, {"paperId": null, "title": "Efficient and guaranteed-safe non-convex trajectory optimization with constrained diffusion model"}]}