{
    "acronym": "6dc5c6190dfbe55c8b45b7b23800614c21e5b51c",
    "title": "MegaScale: Scaling Large Language Model Training to More Than 10, 000 GPUs",
    "seed_ids": [
        "longformer",
        "240103933ffe3dac2179cc160a2bd91299357a53",
        "026b3396a63ed5772329708b7580d633bb86bec9",
        "964bd39b546f0f6625ff3b9ef1083f797807ef2e",
        "13a0d8bb38f739990c8cd65a44061c6534f17221",
        "1a883522f3c0051d70be1f8cbdb8989a77395006",
        "6f68e1bb253925d8431588555d3010419f322e04",
        "925ad2897d1b5decbea320d07e99afa9110e09b2",
        "8323c591e119eb09b28b29fd6c7bc76bd889df7a"
    ],
    "s2id": "6dc5c6190dfbe55c8b45b7b23800614c21e5b51c",
    "abstract": "We present the design, implementation and engineering experience in building and deploying MegaScale, a production system for training large language models (LLMs) at the scale of more than 10,000 GPUs. Training LLMs at this scale brings unprecedented challenges to training efficiency and stability. We take a full-stack approach that co-designs the algorithmic and system components across model block and optimizer design, computation and communication overlapping, operator optimization, data pipeline, and network performance tuning. Maintaining high efficiency throughout the training process (i.e., stability) is an important consideration in production given the long extent of LLM training jobs. Many hard stability issues only emerge at large scale, and in-depth observability is the key to address them. We develop a set of diagnosis tools to monitor system components and events deep in the stack, identify root causes, and derive effective techniques to achieve fault tolerance and mitigate stragglers. MegaScale achieves 55.2% Model FLOPs Utilization (MFU) when training a 175B LLM model on 12,288 GPUs, improving the MFU by 1.34x compared to Megatron-LM. We share our operational experience in identifying and fixing failures and stragglers. We hope by articulating the problems and sharing our experience from a systems perspective, this work can inspire future LLM systems research.",
    "authors": [
        "Ziheng Jiang",
        "Haibin Lin",
        "Yinmin Zhong",
        "Qi Huang",
        "Yangrui Chen",
        "Zhi Zhang",
        "Yanghua Peng",
        "Xiang Li",
        "Cong Xie",
        "Shibiao Nong",
        "Yulu Jia",
        "Sun He",
        "Hongmin Chen",
        "Zhihao Bai",
        "Qi Hou",
        "Shipeng Yan",
        "Ding Zhou",
        "Yiyao Sheng",
        "Zhuo Jiang",
        "Haohan Xu",
        "Haoran Wei",
        "Zhang Zhang",
        "Pengfei Nie",
        "Leqi Zou",
        "Sida Zhao",
        "Liang Xiang",
        "Zherui Liu",
        "Zhe Li",
        "X. Jia",
        "Jia-jun Ye",
        "Xin Jin",
        "Xin Liu"
    ],
    "venue": "Symposium on Networked Systems Design and Implementation",
    "year": 2024,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A set of diagnosis tools to monitor system components and events deep in the stack, identify root causes, and derive effective techniques to achieve fault tolerance and mitigate stragglers are developed."
    },
    "citationCount": 16,
    "influentialCitationCount": 2,
    "code": null,
    "description": null,
    "url": null
}