{
    "acronym": "5b2c04e082a56c0eb70ed62bc36148919f665e1c",
    "title": "SampleAttention: Near-Lossless Acceleration of Long Context LLM Inference with Adaptive Structured Sparse Attention",
    "seed_ids": [
        "streamingllm",
        "817f5a9504e59a6afc83cc745dff758f59e0b0a4",
        "713806165610c237f551a7b68e6b09b3ded75502",
        "93e58491830abe1eb965ab37ec64fa97263f6048",
        "539fadfb615ef84c240f4741061c44eeda540091",
        "fdc53c2c10742464087c0525f77e32604827a21d",
        "5e0cb1c4b91a7486e1c2b15a44a0be56bd74bdc0",
        "b31a5884a8ebe96b6300839b28608b97f8f8ef76",
        "0b0debb710366cdff461938c80763eace1651af6",
        "f5afaccfe90268485a9961c5771ec5e71e9b806c",
        "e586a4591ba0303b769f2c07cbddaf1899cb72e4",
        "d203c764fb5dec2b053be667c8b06e516ea6ef10",
        "026b3396a63ed5772329708b7580d633bb86bec9",
        "87c5b281fa43e6f27191b20a8dd694eda1126336",
        "90b21dbad8969b74d704eed15a3d98722a88e464",
        "5f895e84c1fea75de07b4f90da518273c2e57291",
        "66c10bf1f11bc1b2d92204d8f8391d087f6de1c4",
        "50796b0f3edf9cb5ff1e447c298b33755378aa4f",
        "3fbf6339273c50b04e886fa9bd4ad18c952a683d",
        "6f68e1bb253925d8431588555d3010419f322e04",
        "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87",
        "d27669c82faf78ea08cceaa0a171b540cccc304d",
        "925ad2897d1b5decbea320d07e99afa9110e09b2",
        "657329c633709dd1ac34a30d57341b186b1a47c2"
    ],
    "s2id": "5b2c04e082a56c0eb70ed62bc36148919f665e1c",
    "abstract": "Large language models (LLMs) now support extremely long context windows, but the quadratic complexity of vanilla attention results in significantly long Time-to-First-Token (TTFT) latency. Existing approaches to address this complexity require additional pretraining or finetuning, and often sacrifice model accuracy. In this paper, we first provide both theoretical and empirical foundations for near-lossless sparse attention. We find dynamically capturing head-specific sparse patterns at runtime with low overhead is crucial. To address this, we propose SampleAttention, an adaptive structured and near-lossless sparse attention. Leveraging observed significant sparse patterns, SampleAttention attends to a fixed percentage of adjacent tokens to capture local window patterns, and employs a two-stage query-guided key-value filtering approach, which adaptively select a minimum set of key-values with low overhead, to capture column stripe patterns. Comprehensive evaluations show that SampleAttention can seamlessly replace vanilla attention in off-the-shelf LLMs with nearly no accuracy loss, and reduces TTFT by up to $2.42\\times$ compared with FlashAttention.",
    "authors": [
        "Qianchao Zhu",
        "Jiangfei Duan",
        "Chang Chen",
        "Siran Liu",
        "Xiuhong Li",
        "Guanyu Feng",
        "Xin Lv",
        "Huanqi Cao",
        "Chuanfu Xiao",
        "Xingcheng Zhang",
        "Dahua Lin",
        "Chao Yang"
    ],
    "venue": "arXiv.org",
    "year": 2024,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This paper proposes SampleAttention, an adaptive structured and near-lossless sparse attention, which can seamlessly replace vanilla attention in off-the-shelf LLMs with nearly no accuracy loss, and reduces TTFT by up to $2.42\\times compared with FlashAttention."
    },
    "citationCount": 0,
    "influentialCitationCount": 0,
    "code": null,
    "description": null,
    "url": null
}