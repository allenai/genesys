{
    "acronym": "952fb6413499bc377faa51bf71e4d558ac6f6387",
    "title": "MoA: Mixture of Sparse Attention for Automatic Large Language Model Compression",
    "seed_ids": [
        "pi",
        "streamingllm",
        "5be7e6b04c5a240cff340034aae2b57c677e211f",
        "3c6f2e0c5ff5dff6151c3e6489378a53318a75b4",
        "4d76206515d6b33903937474273885476fc2771e",
        "fdc53c2c10742464087c0525f77e32604827a21d",
        "240103933ffe3dac2179cc160a2bd91299357a53",
        "b069c32fcd77160f944ab3ba71ab6f0cfb782c68",
        "f5afaccfe90268485a9961c5771ec5e71e9b806c",
        "e586a4591ba0303b769f2c07cbddaf1899cb72e4",
        "d203c764fb5dec2b053be667c8b06e516ea6ef10",
        "c193eb176985a81ae64f63c5e50b2f11cfb7c4e6",
        "026b3396a63ed5772329708b7580d633bb86bec9",
        "998ac3e945857cf2676ee7efdbaf443a0c6f820a",
        "b0c5c673c690c644a7d4af73adb783bd98486181",
        "240300b1da360f22bf0b82c6817eacebba6deed4",
        "87c5b281fa43e6f27191b20a8dd694eda1126336",
        "13a0d8bb38f739990c8cd65a44061c6534f17221",
        "b97c3c370401dc34d2adbeb24f34de5180a14be6",
        "5af69480a7ae3b571df6782a11ec4437b386a7d9",
        "4e3935ef7da6bcbb202ec7f8b285c313cadcd044",
        "9ed25f101f19ea735ca300848948ed64064b97ca",
        "4badd753be64c5c5b57dd2bb2e515fbe0c0720d8",
        "3fbf6339273c50b04e886fa9bd4ad18c952a683d",
        "7e5709d81558d3ef4265de29ea75931afeb1f2dd",
        "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87",
        "925ad2897d1b5decbea320d07e99afa9110e09b2",
        "657329c633709dd1ac34a30d57341b186b1a47c2",
        "e3aa232577bb427b1f3a34acbdef84bd85734042",
        "4b56eef2862f7f553686f1dd190c56017122a6a0"
    ],
    "s2id": "952fb6413499bc377faa51bf71e4d558ac6f6387",
    "abstract": "Sparse attention can effectively mitigate the significant memory and throughput demands of Large Language Models (LLMs) in long contexts. Existing methods typically employ a uniform sparse attention mask, applying the same sparse pattern across different attention heads and input lengths. However, this uniform approach fails to capture the diverse attention patterns inherent in LLMs, ignoring their distinct accuracy-latency trade-offs. To address this challenge, we propose the Mixture of Attention (MoA), which automatically tailors distinct sparse attention configurations to different heads and layers. MoA constructs and navigates a search space of various attention patterns and their scaling rules relative to input sequence lengths. It profiles the model, evaluates potential configurations, and pinpoints the optimal sparse attention compression plan. MoA adapts to varying input sizes, revealing that some attention heads expand their focus to accommodate longer sequences, while other heads consistently concentrate on fixed-length local contexts. Experiments show that MoA increases the effective context length by $3.9\\times$ with the same average attention span, boosting retrieval accuracy by $1.5-7.1\\times$ over the uniform-attention baseline across Vicuna-7B, Vicuna-13B, and Llama3-8B models. Moreover, MoA narrows the capability gaps between sparse and dense models, reducing the maximum relative performance drop from $9\\%-36\\%$ to within $5\\%$ across two long-context understanding benchmarks. MoA achieves a $1.2-1.4\\times$ GPU memory reduction and boosts decode throughput by $5.5-6.7 \\times$ for 7B and 13B dense models on a single GPU, with minimal impact on performance.",
    "authors": [
        "Tianyu Fu",
        "Haofeng Huang",
        "Xuefei Ning",
        "Genghan Zhang",
        "Boju Chen",
        "Tianqi Wu",
        "Hongyi Wang",
        "Zixiao Huang",
        "Shiyao Li",
        "Shengen Yan",
        "Guohao Dai",
        "Huazhong Yang",
        "Yu Wang"
    ],
    "venue": "arXiv.org",
    "year": 2024,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "The Mixture of Attention (MoA) is proposed, which automatically tailors distinct sparse attention configurations to different heads and layers, and narrows the capability gaps between sparse and dense models."
    },
    "citationCount": 0,
    "influentialCitationCount": 0,
    "code": null,
    "description": null,
    "url": null
}