{
    "acronym": "3e8d4062ec4353ff2701c7769336dbdb97f8814c",
    "title": "Transformers are Multi-State RNNs",
    "seed_ids": [
        "streamingllm",
        "189fde3f4dfa105bb51472a8945618f395919560",
        "62b18cc55dcc7ffe52c28e1086aee893b7bc4334",
        "fdc53c2c10742464087c0525f77e32604827a21d",
        "f5afaccfe90268485a9961c5771ec5e71e9b806c",
        "c193eb176985a81ae64f63c5e50b2f11cfb7c4e6",
        "026b3396a63ed5772329708b7580d633bb86bec9",
        "f393aff1593c2d370ec0ae004910d18e40524967",
        "2537af99905a27d9b84ba9968715f4287f1d3359",
        "eaef083b9d661f42cc0d89d9d8156218f33a91d9",
        "e0cbbca02b332f398c6639b3bea0613f79166220",
        "1f133158a8973fb33fea188f20517cd7e69bfe7f",
        "4e3935ef7da6bcbb202ec7f8b285c313cadcd044",
        "9ed25f101f19ea735ca300848948ed64064b97ca",
        "3fbf6339273c50b04e886fa9bd4ad18c952a683d",
        "6f68e1bb253925d8431588555d3010419f322e04",
        "c0b79e6a5fd88ef13aa4780df5aae0aaa6b2be87",
        "925ad2897d1b5decbea320d07e99afa9110e09b2",
        "f51497f463566581874c941353dd9d80069c5b77",
        "9405cc0d6169988371b2755e573cc28650d14dfe"
    ],
    "s2id": "3e8d4062ec4353ff2701c7769336dbdb97f8814c",
    "abstract": "Transformers are considered conceptually different from the previous generation of state-of-the-art NLP models - recurrent neural networks (RNNs). In this work, we demonstrate that decoder-only transformers can in fact be conceptualized as unbounded multi-state RNNs - an RNN variant with unlimited hidden state size. We further show that transformers can be converted into $\\textit{bounded}$ multi-state RNNs by fixing the size of their hidden state, effectively compressing their key-value cache. We introduce a novel, training-free compression policy - $\\textbf{T}$oken $\\textbf{O}$mission $\\textbf{V}$ia $\\textbf{A}$ttention (TOVA). Our experiments with four long range tasks and several LLMs show that TOVA outperforms several baseline compression policies. Particularly, our results are nearly on par with the full model, using in some cases only $\\frac{1}{8}$ of the original cache size, which translates to 4.8X higher throughput. Our results shed light on the connection between transformers and RNNs, and help mitigate one of LLMs' most painful computational bottlenecks - the size of their key-value cache. We publicly release our code at https://github.com/schwartz-lab-NLP/TOVA",
    "authors": [
        "Matanel Oren",
        "Michael Hassid",
        "Yossi Adi",
        "Roy Schwartz"
    ],
    "venue": "arXiv.org",
    "year": 2024,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work demonstrates that decoder-only transformers can be conceptualized as unbounded multi-state RNNs - an RNN variant with unlimited hidden state size, and shows that transformers can be converted into $\\textit{bounded}$ multi-state RNNs by fixing the size of their hidden state, effectively compressing their key-value cache."
    },
    "citationCount": 10,
    "influentialCitationCount": 1,
    "code": null,
    "description": null,
    "url": null
}