{
    "acronym": "9803d83bbb28d02fb01f00e0e05aa3c192a87255",
    "title": "MInference 1.0: Accelerating Pre-filling for Long-Context LLMs via Dynamic Sparse Attention",
    "seed_ids": [
        "streamingllm",
        "1c7db9fb18246787fbe3de6e0eaa370ae749e795",
        "28eb18717cfa257f0fc49fb9512c48279cafa031",
        "0ac39ef1352641533b01f07c42da0dcb8cdc81a9",
        "4f02df5e50a50d593a3336bf9a566c30e6fef00d",
        "1d4c48335d841014d0145256c3c4e7f6c426b8fb",
        "53a803388e83ae89261624099d7be4287ace67cb",
        "cf188f980d987d70358e414f44505e8427496d08",
        "d0deaec3e1f74701ac43600d9e64c5c969be7391",
        "3fd5bc3077d04965eaa3498372c39bbdd09d55e4",
        "d8b51d518f2dd62943762ceaa8961d3b1bfbcc1a",
        "931c74198f596287245932232bfa95808b3dc1e6",
        "cbaf689fd9ea9bc939510019d90535d6249b3367",
        "4c69d79c0ee7ac964284a75135b317d1ce7fb2d6",
        "e9576198e9ee767ede4b1ac6a739267aa52a9832",
        "c9603ec967879c24973b5bd48861df2e5555932e",
        "ef1b02dc1b82f9955fc4760fcefd92c0fff9f227",
        "3e8d4062ec4353ff2701c7769336dbdb97f8814c",
        "713806165610c237f551a7b68e6b09b3ded75502",
        "02ad9f3fefe33cb9ca546591bec65dbdf7766c80",
        "fdc53c2c10742464087c0525f77e32604827a21d",
        "5fc1a3a49e8f1d106118b69d1d6be3b6caa23da0",
        "a51ac7a5e8f6454268ac16ecdc52ecac98ce54d9",
        "a7fc585cc4c2b6822646b2c410e0c427a20798f2",
        "240103933ffe3dac2179cc160a2bd91299357a53",
        "b069c32fcd77160f944ab3ba71ab6f0cfb782c68",
        "f5afaccfe90268485a9961c5771ec5e71e9b806c",
        "32fa352ee110fd9f80c9d62282611b4a444f5300",
        "e586a4591ba0303b769f2c07cbddaf1899cb72e4",
        "f3ca1504ab4cc14f491f07e5a8b38d93890551e1",
        "026b3396a63ed5772329708b7580d633bb86bec9",
        "dbc368bc8b49347dd27679894524fa62f88492c9",
        "690a37a2ba67b44b012bf9aa92e6a7f7670f487f",
        "b21670e8061a06ab97e7d6052c9345a326e84ff8",
        "ac2618b2ce5cdcf86f9371bcca98bc5e37e46f51",
        "148011adfae37b821407aae84fcbbf7fb4619eb6",
        "4badd753be64c5c5b57dd2bb2e515fbe0c0720d8",
        "6f68e1bb253925d8431588555d3010419f322e04",
        "925ad2897d1b5decbea320d07e99afa9110e09b2",
        "657329c633709dd1ac34a30d57341b186b1a47c2",
        "f51497f463566581874c941353dd9d80069c5b77",
        "5b94dd68c7484d828bb3ed4b065fc58ddbd3b202"
    ],
    "s2id": "9803d83bbb28d02fb01f00e0e05aa3c192a87255",
    "abstract": "The computational challenges of Large Language Model (LLM) inference remain a significant barrier to their widespread deployment, especially as prompt lengths continue to increase. Due to the quadratic complexity of the attention computation, it takes 30 minutes for an 8B LLM to process a prompt of 1M tokens (i.e., the pre-filling stage) on a single A100 GPU. Existing methods for speeding up prefilling often fail to maintain acceptable accuracy or efficiency when applied to long-context LLMs. To address this gap, we introduce MInference (Milliontokens Inference), a sparse calculation method designed to accelerate pre-filling of long-sequence processing. Specifically, we identify three unique patterns in long-context attention matrices-the A-shape, Vertical-Slash, and Block-Sparsethat can be leveraged for efficient sparse computation on GPUs. We determine the optimal pattern for each attention head offline and dynamically build sparse indices based on the assigned pattern during inference. With the pattern and sparse indices, we perform efficient sparse attention calculations via our optimized GPU kernels to significantly reduce the latency in the pre-filling stage of long-context LLMs. Our proposed technique can be directly applied to existing LLMs without any modifications to the pre-training setup or additional fine-tuning. By evaluating on a wide range of downstream tasks, including InfiniteBench, RULER, PG-19, and Needle In A Haystack, and models including LLaMA-3-1M, GLM4-1M, Yi-200K, Phi-3-128K, and Qwen2-128K, we demonstrate that MInference effectively reduces inference latency by up to 10x for pre-filling on an A100, while maintaining accuracy. Our code is available at https://aka.ms/MInference.",
    "authors": [
        "Huiqiang Jiang",
        "Yucheng Li",
        "Chengruidong Zhang",
        "Qianhui Wu",
        "Xufang Luo",
        "Surin Ahn",
        "Zhenhua Han",
        "Amir H. Abdi",
        "Dongsheng Li",
        "Chin-Yew Lin",
        "Yuqing Yang",
        "Lili Qiu"
    ],
    "venue": "",
    "year": 2024,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "MInference (Milliontokens Inference), a sparse calculation method designed to accelerate pre-filling of long-sequence processing, is introduced, which effectively reduces inference latency by up to 10x for pre-filling on an A100, while maintaining accuracy."
    },
    "citationCount": 1,
    "influentialCitationCount": 1,
    "code": null,
    "description": null,
    "url": null
}