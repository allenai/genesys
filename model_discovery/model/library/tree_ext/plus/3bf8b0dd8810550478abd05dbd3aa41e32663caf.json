{
    "paperId": "3bf8b0dd8810550478abd05dbd3aa41e32663caf",
    "externalIds": {
        "ArXiv": "2408.13233",
        "CorpusId": 271946962
    },
    "title": "Multi-Layer Transformers Gradient Can be Approximated in Almost Linear Time",
    "abstract": "The quadratic computational complexity in the self-attention mechanism of popular transformer architectures poses significant challenges for training and inference, particularly in terms of efficiency and memory requirements. Towards addressing these challenges, this paper introduces a novel fast computation method for gradient calculation in multi-layer transformer models. Our approach enables the computation of gradients for the entire multi-layer transformer model in almost linear time $n^{1+o(1)}$, where $n$ is the input sequence length. This breakthrough significantly reduces the computational bottleneck associated with the traditional quadratic time complexity. Our theory holds for any loss function and maintains a bounded approximation error across the entire model. Furthermore, our analysis can hold when the multi-layer transformer model contains many practical sub-modules, such as residual connection, casual mask, and multi-head attention. By improving the efficiency of gradient computation in large language models, we hope that our work will facilitate the more effective training and deployment of long-context language models based on our theoretical results.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A novel fast computation method for gradient calculation in multi-layer transformer models that enables the computation of gradients for the entire multi-layer transformer model in almost linear time, which significantly reduces the computational bottleneck associated with the traditional quadratic time complexity."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -6.959357738494873,
            -0.27300208806991577,
            0.4679242670536041,
            3.5384163856506348,
            -0.6819056868553162,
            0.5184609889984131,
            3.386888027191162,
            -3.67653751373291,
            1.5104047060012817,
            -1.0034911632537842,
            -0.43570640683174133,
            3.882093906402588,
            0.5750030279159546,
            -0.6246913075447083,
            -3.4542810916900635,
            -0.766548752784729,
            -2.347109317779541,
            2.6901228427886963,
            6.415220737457275,
            2.3126749992370605,
            -2.4815473556518555,
            3.3141989707946777,
            -4.255738735198975,
            1.7218997478485107,
            -0.17042756080627441,
            3.262674331665039,
            -0.7558907270431519,
            -2.622028350830078,
            -3.225741147994995,
            -0.9427872896194458,
            -0.5426464676856995,
            -5.931260585784912,
            5.60340690612793,
            -3.5136818885803223,
            3.1177287101745605,
            -1.252941370010376,
            -0.736609160900116,
            6.778104782104492,
            -4.733255386352539,
            -0.3803154230117798,
            0.6270198822021484,
            0.25434890389442444,
            -0.8138756155967712,
            -0.7624291777610779,
            1.9882137775421143,
            3.0101218223571777,
            4.427414417266846,
            0.6530774831771851,
            0.8238801956176758,
            1.228010654449463,
            0.5906286835670471,
            0.2883427143096924,
            1.2534804344177246,
            -0.10861870646476746,
            -0.3250986337661743,
            -1.285501480102539,
            0.28052881360054016,
            -1.6766204833984375,
            3.482118844985962,
            -1.4463586807250977,
            2.7160534858703613,
            3.1978230476379395,
            0.3153603672981262,
            1.2040956020355225,
            3.1222217082977295,
            -0.6109851598739624,
            -1.4692771434783936,
            2.3080570697784424,
            0.6141763925552368,
            -0.4003446698188782,
            0.8376117944717407,
            -7.011503219604492,
            0.3613743484020233,
            0.276175856590271,
            -5.324450492858887,
            -0.11867177486419678,
            -1.5372227430343628,
            -5.955450057983398,
            2.754490375518799,
            -0.9205387830734253,
            -0.5698897838592529,
            3.4157543182373047,
            -0.27812638878822327,
            0.4122135639190674,
            7.803801536560059,
            -3.2950022220611572,
            -2.7254226207733154,
            0.27621421217918396,
            -1.555253028869629,
            -0.1667698323726654,
            1.2243564128875732,
            3.2122390270233154,
            -0.8346046209335327,
            1.6602588891983032,
            -1.2084357738494873,
            -2.261911630630493,
            1.1377264261245728,
            0.2844732403755188,
            -2.668956756591797,
            4.033708572387695,
            1.2324371337890625,
            -1.5810635089874268,
            0.7034664750099182,
            -0.8526856899261475,
            1.1529598236083984,
            -3.92112398147583,
            -2.3877828121185303,
            3.14308500289917,
            0.6409434080123901,
            -3.361497163772583,
            -1.3393495082855225,
            3.822075605392456,
            0.1475953459739685,
            -2.305934190750122,
            -1.8044459819793701,
            -2.4267783164978027,
            -1.706911325454712,
            -0.1772730052471161,
            -1.4227142333984375,
            4.303077697753906,
            0.05349382758140564,
            -1.6621674299240112,
            -3.2021329402923584,
            -0.14464062452316284,
            -1.3873414993286133,
            3.752849578857422,
            -0.23751312494277954,
            0.6055901050567627,
            -1.2624479532241821,
            -3.3200387954711914,
            -1.8828635215759277,
            -3.7974839210510254,
            1.0158511400222778,
            -3.372371196746826,
            1.5905981063842773,
            0.3919021785259247,
            -3.1811792850494385,
            1.0539473295211792,
            -5.007089614868164,
            0.12072163820266724,
            1.1928541660308838,
            2.414520740509033,
            1.669108510017395,
            2.095273971557617,
            4.672676086425781,
            4.169526100158691,
            1.3591248989105225,
            -0.8631062507629395,
            -0.2377622127532959,
            4.944549560546875,
            3.0384421348571777,
            -3.359579563140869,
            0.48396170139312744,
            0.6661157608032227,
            0.9623056650161743,
            3.5273494720458984,
            -6.007925987243652,
            0.576333224773407,
            -1.115896463394165,
            1.5968623161315918,
            1.5825374126434326,
            1.9316840171813965,
            -8.269731521606445,
            1.0762391090393066,
            4.811128616333008,
            -4.2711944580078125,
            -4.022441864013672,
            -0.05894017219543457,
            1.6586673259735107,
            2.3699827194213867,
            -0.7660296559333801,
            1.3542320728302002,
            0.8053567409515381,
            0.00034543871879577637,
            5.4449286460876465,
            4.792440414428711,
            2.198068141937256,
            -1.309090256690979,
            1.7677772045135498,
            0.2580973505973816,
            -2.970907688140869,
            -0.08231592178344727,
            -6.537445068359375,
            1.6484187841415405,
            -3.8953702449798584,
            -1.3343881368637085,
            -4.784035682678223,
            -0.000395357608795166,
            -3.0881237983703613,
            -0.19965064525604248,
            -1.09653639793396,
            -1.2497894763946533,
            2.964226007461548,
            4.804203987121582,
            0.8315048217773438,
            0.9292408227920532,
            1.8123584985733032,
            1.47259521484375,
            -3.088294506072998,
            -0.855846643447876,
            4.778495788574219,
            -2.841231346130371,
            -0.39319711923599243,
            -2.3047125339508057,
            3.477108955383301,
            -0.7075586318969727,
            -2.7317638397216797,
            5.438752174377441,
            1.7823333740234375,
            -0.10990828275680542,
            -0.4100884199142456,
            0.1708495020866394,
            -1.5862151384353638,
            0.9986343383789062,
            -2.2736318111419678,
            -4.4590349197387695,
            -4.115260124206543,
            2.344954252243042,
            1.7765811681747437,
            2.1568121910095215,
            0.7873563170433044,
            2.758124828338623,
            -1.676538348197937,
            -6.088507652282715,
            -1.1057106256484985,
            -0.9480714797973633,
            2.2674145698547363,
            0.5529444813728333,
            -0.6290667057037354,
            3.0919253826141357,
            0.28179681301116943,
            -5.653091907501221,
            -0.909164547920227,
            1.2281073331832886,
            -4.900849342346191,
            -0.8423274755477905,
            -0.9337725639343262,
            2.1266520023345947,
            -0.8532001972198486,
            -1.402036428451538,
            4.942538261413574,
            1.0791206359863281,
            0.33268871903419495,
            2.3281090259552,
            -0.5594066977500916,
            -1.0217865705490112,
            -3.6751723289489746,
            -0.5766793489456177,
            -0.3071252405643463,
            -4.486579895019531,
            0.0022025108337402344,
            -0.19337493181228638,
            5.243967056274414,
            -0.4212290048599243,
            0.2178763747215271,
            1.9433398246765137,
            2.108532428741455,
            -1.6279065608978271,
            2.6234447956085205,
            -0.7074819803237915,
            -2.1614437103271484,
            3.6122183799743652,
            1.0504132509231567,
            3.0312387943267822,
            -1.0895527601242065,
            -1.3493235111236572,
            -2.4017438888549805,
            -1.187035083770752,
            -1.2689476013183594,
            1.5856122970581055,
            0.41027015447616577,
            3.052577018737793,
            -2.946845054626465,
            -5.044498443603516,
            -1.1496400833129883,
            -2.226384162902832,
            -2.1606130599975586,
            -1.5539251565933228,
            3.968082904815674,
            7.066910743713379,
            3.408559560775757,
            -4.0867414474487305,
            -1.1123552322387695,
            0.6417795419692993,
            -1.7079674005508423,
            -3.8645682334899902,
            -1.5675498247146606,
            -2.0877304077148438,
            -1.0741454362869263,
            0.3610736131668091,
            -6.199363708496094,
            2.7970073223114014,
            -4.331286430358887,
            -1.8320204019546509,
            -0.8625331521034241,
            3.4787585735321045,
            3.6619582176208496,
            -2.1570234298706055,
            -2.7723426818847656,
            -2.0719878673553467,
            -1.6945714950561523,
            1.0180866718292236,
            5.176347732543945,
            0.17826658487319946,
            3.0243148803710938,
            3.8117306232452393,
            2.775097370147705,
            -2.916347026824951,
            -1.3436450958251953,
            -0.3531915545463562,
            -0.7725971937179565,
            -0.013687163591384888,
            3.2637195587158203,
            -2.7551965713500977,
            0.55254727602005,
            -1.5478883981704712,
            3.1598339080810547,
            1.4716370105743408,
            -3.7885990142822266,
            3.4461750984191895,
            -3.1326656341552734,
            0.4808981716632843,
            -2.7155184745788574,
            -1.9705196619033813,
            0.1670154333114624,
            -2.0340070724487305,
            4.021327018737793,
            -0.009313717484474182,
            -2.6936593055725098,
            4.930193901062012,
            0.8192316889762878,
            3.171560049057007,
            4.949741840362549,
            1.7402009963989258,
            1.8005437850952148,
            -3.9384031295776367,
            -0.8471958041191101,
            2.9221174716949463,
            -1.7995505332946777,
            1.5985395908355713,
            0.38547179102897644,
            7.586499214172363,
            -1.222007393836975,
            3.3957877159118652,
            -4.615071773529053,
            -1.1744475364685059,
            0.24262139201164246,
            -1.945265769958496,
            0.47965767979621887,
            -0.896659255027771,
            2.190433979034424,
            -0.9873067140579224,
            3.649655342102051,
            -1.9318299293518066,
            0.10109913349151611,
            2.266477108001709,
            0.5638344287872314,
            -0.29007959365844727,
            1.4233633279800415,
            0.8379285335540771,
            0.24830353260040283,
            1.9309598207473755,
            0.7244805097579956,
            -1.9163703918457031,
            1.8641926050186157,
            -1.4632279872894287,
            10.53594970703125,
            0.07743865251541138,
            1.5113061666488647,
            -3.341336965560913,
            -0.6431970000267029,
            -2.0178511142730713,
            -1.5135444402694702,
            2.6428046226501465,
            0.06143876910209656,
            -2.167628526687622,
            -0.42307278513908386,
            -1.9505099058151245,
            0.04030710458755493,
            -0.6675789952278137,
            1.6093448400497437,
            3.3121256828308105,
            1.0976403951644897,
            5.222601413726807,
            1.6021521091461182,
            -2.5472817420959473,
            -2.0060505867004395,
            0.7757295370101929,
            1.3738250732421875,
            -1.4707722663879395,
            -0.37308046221733093,
            2.1077024936676025,
            3.7860493659973145,
            0.6561228036880493,
            -3.058656692504883,
            -3.257091999053955,
            -3.384793519973755,
            -5.183446884155273,
            0.6725513935089111,
            1.1927329301834106,
            0.013846874237060547,
            1.1293258666992188,
            3.687619209289551,
            5.865138053894043,
            -3.6344566345214844,
            -1.552337884902954,
            4.355243682861328,
            2.507658004760742,
            -1.5030385255813599,
            -1.1323082447052002,
            -5.720974922180176,
            -1.6335890293121338,
            -0.9177814722061157,
            -2.2511258125305176,
            2.0465216636657715,
            -3.585505723953247,
            -1.7523605823516846,
            1.7340593338012695,
            5.304752826690674,
            1.447330117225647,
            -0.26034706830978394,
            1.6545562744140625,
            6.204408645629883,
            4.753986358642578,
            -2.4587793350219727,
            0.846651554107666,
            2.7383155822753906,
            2.426267385482788,
            -0.9947164058685303,
            3.6041364669799805,
            -3.8486483097076416,
            2.964611053466797,
            -4.189303874969482,
            2.2928714752197266,
            2.023068428039551,
            3.8730263710021973,
            -2.2141449451446533,
            0.8228415250778198,
            0.47808510065078735,
            2.886897087097168,
            0.4088691174983978,
            4.141604423522949,
            -2.3249223232269287,
            4.545713424682617,
            -1.5520820617675781,
            1.4417400360107422,
            -1.3694391250610352,
            -0.38832420110702515,
            -2.5005686283111572,
            -5.306842803955078,
            3.842069149017334,
            -4.405091762542725,
            -1.4249951839447021,
            -0.08104583621025085,
            2.2185935974121094,
            0.008096575736999512,
            -3.969660758972168,
            -2.9168739318847656,
            2.360513687133789,
            1.4288694858551025,
            -4.85345458984375,
            2.4686713218688965,
            -1.518269658088684,
            4.2431135177612305,
            4.327815055847168,
            2.3614678382873535,
            1.0603399276733398,
            -0.6169860363006592,
            1.6819312572479248,
            0.23131316900253296,
            4.024439811706543,
            0.18754872679710388,
            1.0665687322616577,
            -2.3294126987457275,
            0.04489317536354065,
            -0.06988495588302612,
            2.307450771331787,
            1.5352340936660767,
            0.8657540678977966,
            -3.592015266418457,
            -3.016599655151367,
            -1.8717557191848755,
            1.8249220848083496,
            -1.5032087564468384,
            -2.92248272895813,
            5.967854976654053,
            4.800396919250488,
            1.9663429260253906,
            2.257852077484131,
            2.2460079193115234,
            1.1255607604980469,
            -1.0819419622421265,
            4.580780029296875,
            -2.3165979385375977,
            1.1547019481658936,
            0.8598281145095825,
            -3.4109644889831543,
            0.6059423685073853,
            2.278566360473633,
            -1.2446428537368774,
            0.1450589895248413,
            -2.542820930480957,
            1.6102854013442993,
            -2.4142351150512695,
            -0.695906400680542,
            5.212152481079102,
            1.3121968507766724,
            1.4881203174591064,
            -2.5493218898773193,
            -1.8681907653808594,
            1.4838099479675293,
            0.9540783166885376,
            -3.6729698181152344,
            0.37536144256591797,
            -0.5672829747200012,
            4.914552688598633,
            -0.325318843126297,
            -1.4233967065811157,
            1.8370331525802612,
            -0.4403306543827057,
            0.16613778471946716,
            2.1415855884552,
            -1.3036364316940308,
            2.6992979049682617,
            0.6813644170761108,
            0.019945472478866577,
            -2.6956076622009277,
            5.350663661956787,
            -0.6316376328468323,
            3.7228500843048096,
            5.553277015686035,
            5.883371353149414,
            1.3076378107070923,
            -3.9575958251953125,
            -0.5493789315223694,
            -1.892486333847046,
            2.6159448623657227,
            2.7394943237304688,
            -1.7356666326522827,
            -1.5441442728042603,
            0.512257993221283,
            1.3400620222091675,
            -0.9809170365333557,
            0.49868789315223694,
            -3.8221981525421143,
            1.2604613304138184,
            -0.3428599536418915,
            0.9135116338729858,
            -2.8215222358703613,
            -1.1792553663253784,
            0.6253272294998169,
            -0.3412899076938629,
            1.661956787109375,
            -2.2809464931488037,
            -6.258322715759277,
            0.8835670948028564,
            -1.5522122383117676,
            -3.6902873516082764,
            -0.4694124460220337,
            4.794899940490723,
            0.8080354928970337,
            1.0608887672424316,
            -0.09369367361068726,
            5.145441055297852,
            -6.200946807861328,
            -5.177060127258301,
            -0.9660163521766663,
            1.9752156734466553,
            -1.4376139640808105,
            -2.2671613693237305,
            -0.37522512674331665,
            -0.7530199289321899,
            2.1180055141448975,
            0.6380434036254883,
            1.6320260763168335,
            3.4094676971435547,
            2.9267678260803223,
            0.6982736587524414,
            -4.053563117980957,
            0.7320599555969238,
            -1.3379188776016235,
            -3.908385753631592,
            -5.012237548828125,
            -5.327905654907227,
            1.7128491401672363,
            -6.927746772766113,
            -5.096013069152832,
            0.12175121903419495,
            -2.703209161758423,
            -1.125630497932434,
            1.2957797050476074,
            -2.405348777770996,
            -0.06017923355102539,
            -4.922177314758301,
            -2.963987350463867,
            -1.709446668624878,
            2.3947372436523438,
            1.7006101608276367,
            -3.7518250942230225,
            2.0744001865386963,
            3.3161396980285645,
            3.384918212890625,
            0.7583958506584167,
            -0.3874587416648865,
            -2.47869610786438,
            -0.8723544478416443,
            0.5692601799964905,
            2.767936944961548,
            -0.796855092048645,
            1.1790173053741455,
            -0.2464308738708496,
            0.5710112452507019,
            14.61005973815918,
            1.204066514968872,
            -1.559734582901001,
            -0.9795030355453491,
            -2.2114439010620117,
            -3.324748992919922,
            -2.267432451248169,
            -0.7040852308273315,
            0.24275320768356323,
            2.483761787414551,
            -0.26539474725723267,
            -1.0677968263626099,
            2.0415587425231934,
            0.2825511395931244,
            -2.5637638568878174,
            -0.4170817732810974,
            -0.6412282586097717,
            2.578813314437866,
            0.021553367376327515,
            -2.6869521141052246,
            -0.7504908442497253,
            2.5625085830688477,
            1.7810184955596924,
            -2.8932080268859863,
            -0.3589043617248535,
            4.61912727355957,
            3.04556941986084,
            4.011104106903076,
            -5.2175798416137695,
            3.0056087970733643,
            2.2358238697052,
            2.946598768234253,
            -1.8609659671783447,
            0.3442067503929138,
            -4.708219051361084,
            5.001325607299805,
            3.4997901916503906,
            1.3705264329910278,
            2.706317901611328,
            1.7359205484390259,
            0.7124852538108826,
            1.1622250080108643,
            -0.41368943452835083,
            -0.7033247947692871,
            -1.4637789726257324,
            3.087373733520508,
            0.5516092777252197,
            -3.6460180282592773,
            -1.297261357307434,
            1.8280032873153687,
            3.5176939964294434,
            -2.1261649131774902,
            -0.29145359992980957,
            -0.9891388416290283,
            0.740307629108429,
            4.21245002746582,
            -1.6645597219467163,
            2.313502073287964,
            1.684950351715088,
            1.8293322324752808,
            1.318894386291504,
            0.5775865316390991,
            -4.3349809646606445,
            -3.790752649307251,
            -0.9230313301086426,
            2.7163617610931396,
            -3.7403669357299805,
            1.5335965156555176,
            3.457470417022705,
            2.0203022956848145,
            0.8270692229270935,
            -0.4965873956680298,
            1.9703443050384521,
            -1.7256771326065063,
            -1.6505777835845947,
            -2.5677294731140137,
            0.7675808668136597,
            1.8014438152313232,
            -2.4171464443206787,
            7.059947967529297,
            -4.217098236083984,
            1.338005781173706,
            -3.5023913383483887,
            -1.8876442909240723,
            5.246070861816406,
            -4.432263374328613,
            3.1120753288269043,
            0.5220383405685425,
            -1.1871331930160522,
            3.725939989089966,
            0.08582690358161926,
            -2.687594413757324,
            3.3281168937683105,
            2.587831974029541,
            3.712247610092163,
            -5.410600185394287,
            -0.16561299562454224,
            -1.4308136701583862,
            -4.833702087402344,
            -4.471961975097656,
            4.56491756439209,
            3.231661796569824,
            0.04217398166656494,
            0.07774186134338379,
            -1.6310139894485474,
            1.5345160961151123,
            0.5209714770317078,
            -6.19485330581665,
            -3.7188963890075684,
            -3.794229507446289,
            1.2390249967575073,
            -5.233784198760986,
            -2.2457356452941895,
            -0.059316158294677734,
            0.9094905853271484,
            -0.5456188917160034,
            -1.3802547454833984,
            2.048332929611206,
            1.3435266017913818,
            0.04067628085613251,
            -0.16585773229599,
            -1.3578901290893555,
            -0.589729905128479,
            -1.2849712371826172,
            -0.78983074426651,
            2.652935743331909,
            1.5068559646606445,
            -0.09570270776748657,
            3.110853433609009,
            -0.2698088586330414,
            3.119924545288086,
            -1.0246803760528564,
            -4.227259635925293,
            -0.12141931056976318,
            -1.5788202285766602,
            -2.498523473739624,
            -0.5883990526199341,
            2.1020398139953613,
            -3.7906494140625,
            1.3036730289459229,
            8.12571907043457,
            -1.7620043754577637,
            -1.5749471187591553,
            8.261445999145508,
            -0.26917147636413574,
            1.9713897705078125,
            1.212019920349121,
            -3.8164803981781006,
            -2.301816463470459,
            -2.2193291187286377,
            0.5293756723403931,
            0.9015247225761414,
            4.173671722412109,
            0.6930725574493408,
            -0.2992936372756958,
            -1.1504700183868408
        ]
    },
    "authors": [
        {
            "authorId": "2260827689",
            "name": "Yingyu Liang"
        },
        {
            "authorId": "2261673240",
            "name": "Zhizhou Sha"
        },
        {
            "authorId": "113515522",
            "name": "Zhenmei Shi"
        },
        {
            "authorId": "2284489474",
            "name": "Zhao Song"
        },
        {
            "authorId": "2303410611",
            "name": "Yufa Zhou"
        }
    ],
    "references": []
}