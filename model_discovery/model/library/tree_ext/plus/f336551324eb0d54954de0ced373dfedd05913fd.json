{
    "paperId": "f336551324eb0d54954de0ced373dfedd05913fd",
    "externalIds": {
        "ArXiv": "2408.14721",
        "CorpusId": 271962727
    },
    "title": "PAT: Pruning-Aware Tuning for Large Language Models",
    "abstract": "Large language models (LLMs) excel in language tasks, especially with supervised fine-tuning after pre-training. However, their substantial memory and computational requirements hinder practical applications. Structural pruning, which reduces less significant weight dimensions, is one solution. Yet, traditional post-hoc pruning often leads to significant performance loss, with limited recovery from further fine-tuning due to reduced capacity. Since the model fine-tuning refines the general and chaotic knowledge in pre-trained models, we aim to incorporate structural pruning with the fine-tuning, and propose the Pruning-Aware Tuning (PAT) paradigm to eliminate model redundancy while preserving the model performance to the maximum extend. Specifically, we insert the innovative Hybrid Sparsification Modules (HSMs) between the Attention and FFN components to accordingly sparsify the upstream and downstream linear modules. The HSM comprises a lightweight operator and a globally shared trainable mask. The lightweight operator maintains a training overhead comparable to that of LoRA, while the trainable mask unifies the channels to be sparsified, ensuring structural pruning. Additionally, we propose the Identity Loss which decouples the transformation and scaling properties of the HSMs to enhance training robustness. Extensive experiments demonstrate that PAT excels in both performance and efficiency. For example, our Llama2-7b model with a 25\\% pruning ratio achieves 1.33$\\times$ speedup while outperforming the LoRA-finetuned model by up to 1.26\\% in accuracy with a similar training cost. Code: https://github.com/kriskrisliu/PAT_Pruning-Aware-Tuning",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work proposes the Pruning-Aware Tuning (PAT) paradigm to eliminate model redundancy while preserving the model performance to the maximum extend, and inserts the innovative Hybrid Sparsification Modules between the Attention and FFN components to accordingly sparsify the upstream and downstream linear modules."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -0.4158251881599426,
            1.5637576580047607,
            -0.016493141651153564,
            4.290993690490723,
            0.6959546804428101,
            -0.7219580411911011,
            0.5536870956420898,
            -0.004406794905662537,
            -1.6636850833892822,
            0.06657402217388153,
            -2.0791866779327393,
            5.423650741577148,
            -2.5128936767578125,
            -2.6356425285339355,
            -3.065016984939575,
            3.232286214828491,
            -1.895149827003479,
            -0.638160765171051,
            5.587365627288818,
            2.0644702911376953,
            -1.913374900817871,
            -0.7196820974349976,
            -3.4811911582946777,
            0.3574586510658264,
            -0.7365180253982544,
            0.043256402015686035,
            5.067471027374268,
            0.027394279837608337,
            0.27921274304389954,
            -2.2126150131225586,
            1.9268748760223389,
            -3.9587855339050293,
            5.326123237609863,
            -1.203502893447876,
            6.045168876647949,
            -1.7108922004699707,
            -5.312288284301758,
            10.788878440856934,
            -4.842422962188721,
            0.00669059157371521,
            -3.563979387283325,
            -1.8388100862503052,
            -0.7268685102462769,
            2.4799413681030273,
            2.0539088249206543,
            2.3257853984832764,
            0.6751177310943604,
            -0.4669327735900879,
            0.007321402430534363,
            1.7738728523254395,
            2.47745418548584,
            0.3081017732620239,
            -1.4062602519989014,
            1.1263962984085083,
            1.372668981552124,
            -2.5688891410827637,
            0.84600830078125,
            1.529173493385315,
            3.6243858337402344,
            -4.9573588371276855,
            3.2573699951171875,
            4.265415191650391,
            0.5002691745758057,
            1.1927084922790527,
            2.403909683227539,
            -3.5737595558166504,
            -1.3059436082839966,
            4.529721736907959,
            1.3604375123977661,
            0.15434399247169495,
            -0.2024267166852951,
            -4.785304069519043,
            -0.7639087438583374,
            2.1287624835968018,
            -3.2089121341705322,
            -0.3609379529953003,
            -0.8972306847572327,
            -6.831480979919434,
            0.6391204595565796,
            -1.6575862169265747,
            -1.5304920673370361,
            1.399794101715088,
            0.426638662815094,
            1.0279617309570312,
            2.825361967086792,
            -2.69331955909729,
            -4.514229774475098,
            -0.45169562101364136,
            0.47539132833480835,
            -2.009261131286621,
            -0.04390096664428711,
            2.8092875480651855,
            -1.2692160606384277,
            4.080080032348633,
            -3.835141897201538,
            0.4574403762817383,
            1.208221673965454,
            -2.5636391639709473,
            -4.395158767700195,
            2.972963571548462,
            3.5441486835479736,
            -2.5227861404418945,
            1.2782161235809326,
            1.5500130653381348,
            3.859920024871826,
            -3.255488395690918,
            -0.4542432725429535,
            2.7781810760498047,
            -0.42608755826950073,
            -1.261961579322815,
            -4.992527961730957,
            4.5781569480896,
            -2.1159701347351074,
            -4.040076732635498,
            -2.1069889068603516,
            -3.864715099334717,
            -2.1762008666992188,
            -0.6512109041213989,
            -0.500227689743042,
            4.440282344818115,
            -1.1551196575164795,
            -1.0760282278060913,
            -3.8110849857330322,
            1.0038776397705078,
            -0.34212562441825867,
            3.058677911758423,
            0.4425395727157593,
            0.6057491302490234,
            0.17994391918182373,
            -3.65958309173584,
            1.9459571838378906,
            -4.736628532409668,
            1.227944254875183,
            0.0905768871307373,
            3.785301923751831,
            3.4981071949005127,
            -5.159444332122803,
            2.350393772125244,
            -0.11876213550567627,
            0.1324070692062378,
            -0.07205677032470703,
            3.8699936866760254,
            0.2552095055580139,
            -1.3068082332611084,
            -0.661551833152771,
            3.4285824298858643,
            1.670392394065857,
            0.6422443389892578,
            -1.215563416481018,
            6.796596527099609,
            4.2997894287109375,
            -2.5955605506896973,
            2.913511037826538,
            0.9379616379737854,
            3.794908046722412,
            2.6998775005340576,
            -4.774281024932861,
            1.977909803390503,
            -1.000731110572815,
            2.4670279026031494,
            0.09768715500831604,
            -0.7565221190452576,
            -8.645029067993164,
            -1.3218064308166504,
            6.060731887817383,
            -1.5637221336364746,
            -2.176168441772461,
            -0.5712515711784363,
            3.5494544506073,
            3.699699878692627,
            0.637648344039917,
            3.2712936401367188,
            4.377015113830566,
            4.550148963928223,
            4.337307929992676,
            2.759002685546875,
            3.0855579376220703,
            -0.17125193774700165,
            -0.8519718647003174,
            -2.3924288749694824,
            -3.9068751335144043,
            -0.6040369868278503,
            -6.452497482299805,
            -1.5439034700393677,
            -6.202939033508301,
            -0.8304263353347778,
            -5.004995346069336,
            -2.5245423316955566,
            -3.2412056922912598,
            2.531386613845825,
            -1.374273657798767,
            1.0298748016357422,
            3.9107940196990967,
            3.089411973953247,
            4.443201065063477,
            1.5040702819824219,
            1.7953126430511475,
            2.893641948699951,
            -3.8221969604492188,
            2.3284478187561035,
            3.7506723403930664,
            -0.30450111627578735,
            0.7243993878364563,
            -2.9014883041381836,
            3.070953369140625,
            3.244589328765869,
            -3.3269875049591064,
            1.49688720703125,
            -1.7824851274490356,
            2.8436660766601562,
            0.209463432431221,
            -0.7786792516708374,
            -1.7922276258468628,
            1.6464612483978271,
            -3.206282615661621,
            -3.332690954208374,
            -5.008441925048828,
            3.153017044067383,
            4.029163360595703,
            1.2858660221099854,
            -0.3098876178264618,
            -2.401350498199463,
            0.9240718483924866,
            -1.7006137371063232,
            -1.855821132659912,
            -2.149116039276123,
            1.9322975873947144,
            -0.5498366355895996,
            0.10507392883300781,
            -0.4304891526699066,
            -0.29514235258102417,
            -7.958071708679199,
            3.012606382369995,
            -2.4147229194641113,
            -4.569809913635254,
            -2.09480619430542,
            -3.458221435546875,
            2.268308639526367,
            -0.991336464881897,
            -0.9877408146858215,
            4.987300872802734,
            2.4942870140075684,
            1.6517659425735474,
            4.848271369934082,
            3.514709949493408,
            1.4115322828292847,
            -2.5554187297821045,
            1.147450566291809,
            -1.4495716094970703,
            -2.5338897705078125,
            -0.03611330687999725,
            -3.4573168754577637,
            1.5755670070648193,
            1.203979730606079,
            2.328892230987549,
            3.0166144371032715,
            -0.027510643005371094,
            -0.033628642559051514,
            1.4652466773986816,
            2.058823823928833,
            -0.8188745379447937,
            3.843425750732422,
            1.5502712726593018,
            4.992009162902832,
            -0.9920425415039062,
            -1.099212884902954,
            -4.790093898773193,
            -2.110928773880005,
            -0.14227157831192017,
            1.4322673082351685,
            1.678844690322876,
            -1.3010666370391846,
            0.393429160118103,
            -3.8743319511413574,
            0.33458584547042847,
            -7.180824279785156,
            1.3059442043304443,
            -1.1909736394882202,
            1.005525827407837,
            4.691102981567383,
            2.1588683128356934,
            -1.2994935512542725,
            -2.501387596130371,
            1.0015339851379395,
            -1.5464831590652466,
            -3.3844518661499023,
            -3.2181005477905273,
            -1.6252317428588867,
            1.4050304889678955,
            -0.7380655407905579,
            -4.757898330688477,
            4.04920768737793,
            -2.308171510696411,
            -2.5693981647491455,
            -2.53513240814209,
            2.8468728065490723,
            4.636447906494141,
            -0.15168285369873047,
            1.8294730186462402,
            -1.323347568511963,
            -0.3036065101623535,
            -1.0861291885375977,
            4.121352195739746,
            1.6893786191940308,
            0.2527656555175781,
            3.466188669204712,
            -1.327091097831726,
            -2.7254419326782227,
            0.07854539155960083,
            -5.205418109893799,
            -2.127554416656494,
            0.9185578227043152,
            3.4341604709625244,
            -2.1506829261779785,
            1.1368483304977417,
            1.4809459447860718,
            0.8639147281646729,
            -1.5459263324737549,
            -1.706908941268921,
            2.499889373779297,
            -2.7548372745513916,
            -1.2121562957763672,
            -2.747180938720703,
            -2.8678150177001953,
            -2.4395370483398438,
            -1.098724365234375,
            3.3544468879699707,
            2.843118190765381,
            0.10813510417938232,
            3.881253242492676,
            -0.10981333255767822,
            2.821098566055298,
            1.7458484172821045,
            4.319894790649414,
            -1.6382293701171875,
            -5.978090286254883,
            -1.8699088096618652,
            -1.6989729404449463,
            4.153099060058594,
            1.0171902179718018,
            0.02053770422935486,
            3.782653570175171,
            -2.2975053787231445,
            1.1446969509124756,
            -4.893003463745117,
            -0.45571187138557434,
            2.1544225215911865,
            -4.529449939727783,
            0.43368425965309143,
            -0.07493102550506592,
            -1.6806716918945312,
            2.3940138816833496,
            2.1700732707977295,
            -2.5551538467407227,
            1.7330207824707031,
            0.9643000364303589,
            1.3030681610107422,
            2.4028782844543457,
            0.9958468675613403,
            4.136204242706299,
            1.0979111194610596,
            1.225055456161499,
            3.8578147888183594,
            -1.7823078632354736,
            2.3384461402893066,
            -2.060659408569336,
            11.68216323852539,
            -2.654290199279785,
            3.1298770904541016,
            -4.079813480377197,
            -0.5194952487945557,
            -1.7503407001495361,
            -1.7396835088729858,
            0.8252806663513184,
            -2.2791614532470703,
            -0.24945831298828125,
            5.371623516082764,
            -4.759819507598877,
            1.1910967826843262,
            1.5944061279296875,
            -0.42918750643730164,
            4.475320816040039,
            0.8776675462722778,
            1.5402843952178955,
            -1.5765557289123535,
            -0.796792209148407,
            -1.333885908126831,
            2.2683422565460205,
            0.4830561578273773,
            -0.5352644920349121,
            -1.4114357233047485,
            2.5634381771087646,
            -0.9155442714691162,
            1.6098594665527344,
            -3.2824273109436035,
            1.8790911436080933,
            -2.314974308013916,
            -3.1012682914733887,
            -1.001204252243042,
            2.974893093109131,
            -0.6829150915145874,
            2.256873607635498,
            5.417173385620117,
            3.8194117546081543,
            -3.328268051147461,
            0.8266085386276245,
            3.1482818126678467,
            -0.9874553680419922,
            -1.028711199760437,
            1.4577546119689941,
            -3.3360955715179443,
            -0.9148712754249573,
            -0.3343176543712616,
            -4.361889839172363,
            0.2119162678718567,
            -2.3973212242126465,
            3.320051670074463,
            2.4945337772369385,
            4.875619411468506,
            4.131932258605957,
            -2.6817052364349365,
            3.8761415481567383,
            3.998995780944824,
            3.6357061862945557,
            0.8070000410079956,
            -0.7687998414039612,
            1.9175870418548584,
            1.1058077812194824,
            0.4752628803253174,
            2.748920202255249,
            -0.8230230808258057,
            4.624536514282227,
            -3.952360153198242,
            -1.509962797164917,
            -0.8765548467636108,
            3.1105897426605225,
            -0.03381156921386719,
            1.1346255540847778,
            0.9374516010284424,
            -0.02280402183532715,
            0.379677414894104,
            4.716998100280762,
            -2.897373676300049,
            7.605494499206543,
            0.9742324352264404,
            1.2618391513824463,
            0.09791655838489532,
            -0.7644079923629761,
            -1.7953341007232666,
            -1.648411750793457,
            1.181684970855713,
            -4.509246349334717,
            -1.741295576095581,
            -1.5258654356002808,
            0.21896910667419434,
            1.4545602798461914,
            -1.9771963357925415,
            -0.5666871070861816,
            -1.2055213451385498,
            1.2224466800689697,
            -2.6441569328308105,
            5.6648054122924805,
            -3.1496899127960205,
            -1.874395728111267,
            -1.3877959251403809,
            2.729865312576294,
            -1.8822085857391357,
            -2.731738567352295,
            -0.24540182948112488,
            0.40332332253456116,
            -0.4062497615814209,
            0.5754355192184448,
            -3.176692008972168,
            3.868661403656006,
            -1.0420891046524048,
            -2.255528688430786,
            6.094821929931641,
            -0.846335232257843,
            1.103999137878418,
            -5.696872711181641,
            -2.1126203536987305,
            -0.48092934489250183,
            3.702432155609131,
            -3.552708625793457,
            -2.0555598735809326,
            4.243982315063477,
            3.185420513153076,
            2.8903276920318604,
            1.572941541671753,
            -0.639729917049408,
            0.41641944646835327,
            3.563722610473633,
            4.301967144012451,
            -0.24850648641586304,
            3.262568950653076,
            1.410292625427246,
            -4.516303062438965,
            1.3019150495529175,
            0.6168646216392517,
            -0.4332563579082489,
            -2.2425696849823,
            -3.3822078704833984,
            0.04518413543701172,
            -0.3328791856765747,
            -3.331059694290161,
            4.2180070877075195,
            4.272153377532959,
            0.6895985007286072,
            -3.3381576538085938,
            0.38884639739990234,
            1.1477200984954834,
            -0.11679872870445251,
            -6.059220790863037,
            2.487166166305542,
            -0.7881833910942078,
            1.6216957569122314,
            0.9034914970397949,
            0.3908913731575012,
            0.0042015910148620605,
            -0.7695738077163696,
            -0.35248106718063354,
            0.2126660943031311,
            -1.5105375051498413,
            1.5456364154815674,
            2.41874098777771,
            2.9925625324249268,
            -4.3571624755859375,
            1.1583396196365356,
            1.4827042818069458,
            5.759918689727783,
            8.310689926147461,
            6.398438453674316,
            2.999584436416626,
            -1.393028974533081,
            -0.8845546245574951,
            -2.1950736045837402,
            4.129731178283691,
            2.245753288269043,
            -6.022974014282227,
            -0.5347216129302979,
            -1.4559049606323242,
            -2.250542640686035,
            -1.2503572702407837,
            0.4972092807292938,
            -0.8059791326522827,
            2.848700523376465,
            -2.7895374298095703,
            0.26253947615623474,
            -1.7402698993682861,
            0.6417653560638428,
            2.6645634174346924,
            -2.079118013381958,
            2.207869529724121,
            -0.6217126250267029,
            -2.9784321784973145,
            -1.9782713651657104,
            -3.5861282348632812,
            -3.105494737625122,
            -0.6432167291641235,
            3.5093202590942383,
            -0.610123336315155,
            -0.8650110363960266,
            0.0859868973493576,
            4.77028226852417,
            -3.1503818035125732,
            -3.500054359436035,
            -3.4192092418670654,
            4.396397113800049,
            -0.8150426149368286,
            0.22148320078849792,
            -0.4406713843345642,
            -3.1421256065368652,
            2.2741892337799072,
            0.6260526776313782,
            0.4845837354660034,
            -0.21772056818008423,
            2.840960741043091,
            1.5603673458099365,
            -0.9379603266716003,
            -0.3877878189086914,
            -3.540869951248169,
            -2.1940555572509766,
            -3.999366044998169,
            -6.281497001647949,
            -1.9049932956695557,
            -5.1965813636779785,
            -2.950918674468994,
            1.4798355102539062,
            -5.2252197265625,
            2.7694180011749268,
            3.6676905155181885,
            1.210660457611084,
            -2.653857707977295,
            -2.257891893386841,
            1.0831654071807861,
            -3.073875904083252,
            6.5022196769714355,
            0.5878682136535645,
            -1.1705995798110962,
            3.1832146644592285,
            1.8722467422485352,
            5.474088191986084,
            1.3517276048660278,
            1.9101885557174683,
            -2.805514335632324,
            -1.5001277923583984,
            2.5587613582611084,
            0.9710560441017151,
            -0.5225687026977539,
            0.8666667938232422,
            1.3256772756576538,
            1.9879841804504395,
            16.456134796142578,
            -2.2174715995788574,
            -1.2032583951950073,
            -1.8267645835876465,
            -0.6203056573867798,
            -5.49738073348999,
            -2.2956924438476562,
            2.336160182952881,
            -0.14390462636947632,
            1.5052472352981567,
            -1.051541805267334,
            -1.6966038942337036,
            0.36006441712379456,
            0.4323643147945404,
            -0.7704269886016846,
            -0.4327019453048706,
            -3.4726922512054443,
            -1.3117878437042236,
            -1.501191258430481,
            -1.908141016960144,
            -0.46076369285583496,
            2.214681386947632,
            -0.7974892854690552,
            -0.5771737098693848,
            -0.6652938723564148,
            1.7931936979293823,
            -1.0536304712295532,
            4.136775970458984,
            -2.5827646255493164,
            -0.6110076904296875,
            0.9282733201980591,
            1.2378668785095215,
            -2.2775869369506836,
            2.7920236587524414,
            -1.8346221446990967,
            4.9181742668151855,
            2.553126335144043,
            -0.8928782343864441,
            4.192291259765625,
            2.3381264209747314,
            -1.723124623298645,
            -0.3612775504589081,
            -0.41533881425857544,
            -1.0192240476608276,
            -3.108304023742676,
            2.1721553802490234,
            3.257944107055664,
            -2.3738059997558594,
            -3.369542121887207,
            4.957883358001709,
            -0.06078904867172241,
            -2.32133150100708,
            -2.5184929370880127,
            2.3648393154144287,
            -0.1390138864517212,
            0.6853163838386536,
            1.2621128559112549,
            -1.1280908584594727,
            3.0760657787323,
            0.19254183769226074,
            0.6458048224449158,
            -0.9757443070411682,
            -3.84671688079834,
            -3.2392382621765137,
            -3.082767963409424,
            2.8914051055908203,
            -2.6966419219970703,
            2.7121238708496094,
            -0.397896945476532,
            0.02612742781639099,
            3.3944568634033203,
            0.13106197118759155,
            -0.5378808975219727,
            0.6512835621833801,
            0.043193280696868896,
            -5.67901086807251,
            2.884871482849121,
            -0.7554671764373779,
            -2.262155055999756,
            6.772161483764648,
            -1.6341392993927002,
            3.7655324935913086,
            -2.465346574783325,
            -2.68113374710083,
            5.204045295715332,
            -2.6074585914611816,
            5.421854019165039,
            2.290600299835205,
            -4.0866312980651855,
            3.99461030960083,
            -1.121409296989441,
            0.8180750608444214,
            2.6208057403564453,
            6.405532360076904,
            2.6056861877441406,
            -4.556209564208984,
            -4.403688907623291,
            -2.3778507709503174,
            -3.079399585723877,
            -2.687845468521118,
            4.097502708435059,
            5.173942565917969,
            -0.23309917747974396,
            -3.5673105716705322,
            -0.9386972188949585,
            -0.5720735788345337,
            -1.4740233421325684,
            -6.238917350769043,
            -4.290642738342285,
            -5.0207319259643555,
            3.6396965980529785,
            -3.795125722885132,
            -3.3669891357421875,
            -1.139802098274231,
            -0.6008665561676025,
            -3.908778190612793,
            0.0062668174505233765,
            2.390592575073242,
            1.7867389917373657,
            3.959634780883789,
            1.233254313468933,
            -0.5378609895706177,
            -5.03985595703125,
            -2.676240921020508,
            -0.34448951482772827,
            1.034232497215271,
            0.2554550766944885,
            -0.2804105281829834,
            -0.6780652403831482,
            1.1892406940460205,
            2.405536651611328,
            -3.1245217323303223,
            -7.360969543457031,
            0.930289626121521,
            -4.457485198974609,
            -2.6399426460266113,
            1.2592202425003052,
            3.1615121364593506,
            -2.878262519836426,
            -1.137580156326294,
            4.8961286544799805,
            -1.9408100843429565,
            -4.716610908508301,
            9.573179244995117,
            0.8500257730484009,
            2.304088592529297,
            -0.17169176042079926,
            -1.9764920473098755,
            -0.6979073286056519,
            1.2096774578094482,
            0.07690155506134033,
            -1.7320607900619507,
            3.2813031673431396,
            -2.16624116897583,
            3.342282772064209,
            -4.977766990661621
        ]
    },
    "authors": [
        {
            "authorId": "2290136282",
            "name": "Yijiang Liu"
        },
        {
            "authorId": "2273577170",
            "name": "Huanrui Yang"
        },
        {
            "authorId": "2317036569",
            "name": "Youxin Chen"
        },
        {
            "authorId": "2268799823",
            "name": "Rongyu Zhang"
        },
        {
            "authorId": "2317036562",
            "name": "Miao Wang"
        },
        {
            "authorId": "2273382618",
            "name": "Yuan Du"
        },
        {
            "authorId": "2318277010",
            "name": "Li Du"
        }
    ],
    "references": []
}