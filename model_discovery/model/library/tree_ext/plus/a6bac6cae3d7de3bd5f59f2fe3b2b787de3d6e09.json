{
    "paperId": "a6bac6cae3d7de3bd5f59f2fe3b2b787de3d6e09",
    "externalIds": {
        "ArXiv": "2409.04431",
        "CorpusId": 272463580
    },
    "title": "Theory, Analysis, and Best Practices for Sigmoid Self-Attention",
    "abstract": "Attention is a key part of the transformer architecture. It is a sequence-to-sequence mapping that transforms each sequence element into a weighted sum of values. The weights are typically obtained as the softmax of dot products between keys and queries. Recent work has explored alternatives to softmax attention in transformers, such as ReLU and sigmoid activations. In this work, we revisit sigmoid attention and conduct an in-depth theoretical and empirical analysis. Theoretically, we prove that transformers with sigmoid attention are universal function approximators and benefit from improved regularity compared to softmax attention. Through detailed empirical analysis, we identify stabilization of large initial attention norms during the early stages of training as a crucial factor for the successful training of models with sigmoid attention, outperforming prior attempts. We also introduce FLASHSIGMOID, a hardware-aware and memory-efficient implementation of sigmoid attention yielding a 17% inference kernel speed-up over FLASHATTENTION2 on H100 GPUs. Experiments across language, vision, and speech show that properly normalized sigmoid attention matches the strong performance of softmax attention on a wide range of domains and scales, which previous attempts at sigmoid attention were unable to fully achieve. Our work unifies prior art and establishes best practices for sigmoid attention as a drop-in softmax replacement in transformers.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work unifies prior art and establishes best practices for sigmoid attention as a drop-in softmax replacement in transformers, proving that transformers with sigmoid attention are universal function approximators and benefit from improved regularity compared to softmax attention."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.173460960388184,
            -1.2602996826171875,
            -0.3987564444541931,
            1.5525305271148682,
            0.1806640923023224,
            2.2748332023620605,
            3.781363010406494,
            1.3139135837554932,
            -0.309903085231781,
            1.5640528202056885,
            -1.9040939807891846,
            4.432923793792725,
            -1.538844347000122,
            -0.8668926954269409,
            -2.3286094665527344,
            -0.46222183108329773,
            -0.3727416396141052,
            -1.5657743215560913,
            5.814258098602295,
            0.03568673133850098,
            1.3198115825653076,
            3.013427734375,
            -4.263830184936523,
            -1.7002208232879639,
            0.05977064371109009,
            -0.6974002122879028,
            3.7716774940490723,
            -0.4411007761955261,
            -3.490316390991211,
            0.7106401920318604,
            -0.27441418170928955,
            -8.066761016845703,
            4.474148750305176,
            -1.3977420330047607,
            0.894968569278717,
            -1.007615089416504,
            -3.930424451828003,
            6.56549072265625,
            -1.6949334144592285,
            -2.4819693565368652,
            0.7667611837387085,
            1.2498693466186523,
            1.733223557472229,
            -0.23014822602272034,
            -1.5151101350784302,
            -1.4778504371643066,
            -0.43704068660736084,
            2.4872562885284424,
            -4.038877964019775,
            2.293219804763794,
            1.9488075971603394,
            1.8603252172470093,
            -2.1781387329101562,
            3.3792924880981445,
            1.38039231300354,
            -4.1228346824646,
            3.176248073577881,
            1.2823426723480225,
            -0.31353968381881714,
            -1.1049320697784424,
            2.5805916786193848,
            3.997814416885376,
            0.21807065606117249,
            1.3247798681259155,
            3.0689520835876465,
            -4.125967979431152,
            -0.23106275498867035,
            3.6849875450134277,
            2.646348237991333,
            1.9615715742111206,
            -1.6661067008972168,
            -7.34127140045166,
            0.2875822186470032,
            2.47890305519104,
            -2.6206421852111816,
            -1.4371333122253418,
            1.003885269165039,
            -4.815493106842041,
            1.6075446605682373,
            -2.5230321884155273,
            -1.1185945272445679,
            2.606874942779541,
            0.281951904296875,
            1.5204451084136963,
            4.025267601013184,
            -1.8367490768432617,
            -3.6643307209014893,
            -0.2861255705356598,
            0.7758082151412964,
            -2.903066635131836,
            -1.5671840906143188,
            0.21659940481185913,
            1.8291970491409302,
            -0.5413264632225037,
            -2.713940382003784,
            -1.3573874235153198,
            1.9251775741577148,
            1.0502712726593018,
            -4.650725364685059,
            -0.017053663730621338,
            2.23730206489563,
            -1.3501324653625488,
            1.7599798440933228,
            -0.9173927903175354,
            1.7419219017028809,
            -2.351618766784668,
            0.16969968378543854,
            2.4930779933929443,
            1.5702606439590454,
            -1.1218332052230835,
            -2.1926848888397217,
            0.9812746047973633,
            1.9436055421829224,
            -1.3412309885025024,
            -3.72873592376709,
            -4.213122844696045,
            -2.1233506202697754,
            0.5271632671356201,
            -0.5130227208137512,
            5.2848005294799805,
            -2.420332431793213,
            0.05736842751502991,
            -0.8167845010757446,
            -0.09837710857391357,
            0.987186074256897,
            2.698307752609253,
            -2.1912665367126465,
            1.3257887363433838,
            1.3043053150177002,
            -4.815371513366699,
            0.7236611843109131,
            -3.9518585205078125,
            0.8693929314613342,
            -0.8757186532020569,
            5.878396987915039,
            1.7372932434082031,
            -3.835740566253662,
            0.03916047513484955,
            -2.4459104537963867,
            0.4582463502883911,
            1.258857011795044,
            1.5630168914794922,
            2.485197067260742,
            1.4015237092971802,
            1.6350980997085571,
            5.996391296386719,
            -0.009384602308273315,
            -0.32163572311401367,
            0.6995795369148254,
            4.278299331665039,
            4.8299150466918945,
            -2.546556234359741,
            -2.0486905574798584,
            2.3822832107543945,
            2.4224023818969727,
            2.2292251586914062,
            -4.805596351623535,
            -0.4010646641254425,
            -2.330420970916748,
            1.1835057735443115,
            -1.5770845413208008,
            0.9384642243385315,
            -10.195956230163574,
            -2.7225565910339355,
            2.7983944416046143,
            -5.244324684143066,
            -0.07447642087936401,
            0.9091639518737793,
            -2.931051731109619,
            3.9969282150268555,
            -0.743191123008728,
            1.0104479789733887,
            1.3675373792648315,
            4.37089729309082,
            4.552218914031982,
            6.733190536499023,
            1.726331114768982,
            -4.382384300231934,
            -2.308762788772583,
            -0.06007640063762665,
            -0.9019189476966858,
            -0.3382735252380371,
            -4.096829414367676,
            1.3570101261138916,
            -3.696882724761963,
            -2.6528806686401367,
            -0.8358025550842285,
            -2.44448184967041,
            0.5469103455543518,
            1.5015110969543457,
            1.6564009189605713,
            -0.06243705749511719,
            5.804306983947754,
            6.745967388153076,
            1.8989245891571045,
            2.361245632171631,
            -0.3329401910305023,
            1.5146446228027344,
            0.006325244903564453,
            -3.272129535675049,
            1.3014992475509644,
            0.13810040056705475,
            0.8931714296340942,
            -3.115892171859741,
            1.72357976436615,
            1.0403016805648804,
            -4.158689975738525,
            1.9987181425094604,
            1.3217488527297974,
            -1.0806550979614258,
            0.2500336766242981,
            -1.5823299884796143,
            -3.117687940597534,
            0.7860325574874878,
            -6.310404300689697,
            -3.4135987758636475,
            -3.215897798538208,
            -0.21353444457054138,
            3.8715901374816895,
            0.1860949844121933,
            1.0496360063552856,
            0.6230359077453613,
            -0.2429402470588684,
            -3.402895450592041,
            2.954714298248291,
            -0.05536550283432007,
            0.9132687449455261,
            -0.9227895140647888,
            0.6383787989616394,
            0.0005847960710525513,
            -1.5478521585464478,
            -3.9819350242614746,
            1.434675693511963,
            -1.5260472297668457,
            -2.817390203475952,
            -1.955232858657837,
            -4.772314548492432,
            0.7901813983917236,
            1.4812692403793335,
            -1.7112005949020386,
            5.649110794067383,
            1.1279120445251465,
            2.5305285453796387,
            5.828651428222656,
            0.9872546792030334,
            -2.9027459621429443,
            -1.7107975482940674,
            3.4556896686553955,
            1.3370951414108276,
            -1.883070945739746,
            -0.36868491768836975,
            -2.5675811767578125,
            2.934302806854248,
            -1.9532489776611328,
            0.5489632487297058,
            1.8451945781707764,
            1.796636939048767,
            -2.2510645389556885,
            -2.1554503440856934,
            0.48581811785697937,
            2.1686148643493652,
            6.0320329666137695,
            1.3254354000091553,
            4.458256721496582,
            -0.28282636404037476,
            -2.4610183238983154,
            -1.61836576461792,
            -0.9285902976989746,
            -0.8880599737167358,
            2.8312978744506836,
            -2.068396806716919,
            2.237884759902954,
            -2.997616767883301,
            -1.8783903121948242,
            -1.1367579698562622,
            -1.471091389656067,
            -2.2906227111816406,
            -0.044300585985183716,
            1.4848240613937378,
            2.060011863708496,
            0.05737966299057007,
            0.020800471305847168,
            -5.297994613647461,
            -1.0900969505310059,
            0.080381840467453,
            -1.102691411972046,
            -2.3585715293884277,
            -0.13349312543869019,
            2.561532497406006,
            -1.00547456741333,
            -4.427799701690674,
            2.2345054149627686,
            -3.1177642345428467,
            1.6789392232894897,
            -3.1231906414031982,
            4.117154121398926,
            5.431271553039551,
            -1.4243165254592896,
            -0.7483335733413696,
            -0.49332839250564575,
            -2.6516711711883545,
            2.021329164505005,
            1.321712613105774,
            0.3968108892440796,
            2.843959331512451,
            3.5211992263793945,
            3.4135243892669678,
            -1.3556122779846191,
            0.011099040508270264,
            -4.949761390686035,
            -1.8978193998336792,
            0.38978755474090576,
            4.454872131347656,
            -2.5201308727264404,
            0.4129111170768738,
            0.48987287282943726,
            1.826963186264038,
            -1.0698840618133545,
            -2.5426015853881836,
            1.3078150749206543,
            -2.1846160888671875,
            -1.400482177734375,
            -3.72782564163208,
            -6.372509002685547,
            -0.6560797691345215,
            -0.9288434982299805,
            2.721395492553711,
            3.379318952560425,
            -1.3973925113677979,
            4.257281303405762,
            1.5743200778961182,
            6.352952003479004,
            3.010794162750244,
            1.743117332458496,
            0.15857666730880737,
            -5.073813438415527,
            -4.017084121704102,
            -0.08337417244911194,
            -0.48146528005599976,
            0.3659716844558716,
            -1.2153488397598267,
            6.1937737464904785,
            1.8097842931747437,
            -0.5638177394866943,
            -1.6951045989990234,
            -1.0828230381011963,
            -0.024294212460517883,
            -3.048748731613159,
            0.03619256615638733,
            0.2529252767562866,
            1.0381560325622559,
            1.6449137926101685,
            -1.824603796005249,
            -4.056390762329102,
            3.1341376304626465,
            1.6608635187149048,
            -0.5566800832748413,
            -0.41052675247192383,
            1.144376516342163,
            3.6560091972351074,
            -1.634523868560791,
            -1.8887863159179688,
            1.245967149734497,
            -2.749494791030884,
            0.38135865330696106,
            -4.161389350891113,
            8.761550903320312,
            -1.398876667022705,
            -1.9309200048446655,
            -3.002378463745117,
            -3.380502462387085,
            -1.2001895904541016,
            -4.095651149749756,
            3.5648083686828613,
            -1.1172537803649902,
            -0.13897931575775146,
            -0.3849649727344513,
            -4.960324287414551,
            0.3780874013900757,
            2.468998908996582,
            -1.3508186340332031,
            2.744379758834839,
            3.3204829692840576,
            6.140476226806641,
            -2.6630942821502686,
            3.008148193359375,
            -1.7180895805358887,
            3.768827438354492,
            2.070323944091797,
            2.202965021133423,
            -1.4432284832000732,
            0.37786954641342163,
            3.4018380641937256,
            0.13496118783950806,
            -3.4000799655914307,
            -2.6963980197906494,
            -3.178340435028076,
            -6.320812702178955,
            0.5524719953536987,
            1.2892611026763916,
            -2.6223573684692383,
            0.6289278864860535,
            5.399564743041992,
            3.271280288696289,
            -3.6279072761535645,
            -2.70346736907959,
            3.838008165359497,
            -0.32250577211380005,
            -2.4109599590301514,
            2.282628297805786,
            -4.020169258117676,
            -0.2154744267463684,
            -1.17096745967865,
            -2.8150179386138916,
            0.025377988815307617,
            0.4470590353012085,
            1.6162612438201904,
            3.4508533477783203,
            2.535950183868408,
            1.0984082221984863,
            -3.089780330657959,
            2.1005284786224365,
            3.411243438720703,
            3.158054828643799,
            -2.8049142360687256,
            3.3630170822143555,
            4.729938507080078,
            2.9960474967956543,
            -2.7049989700317383,
            2.764767646789551,
            -2.0600690841674805,
            3.2454934120178223,
            -3.961085319519043,
            0.4439437687397003,
            1.6952763795852661,
            3.1024413108825684,
            -1.7127010822296143,
            -0.07314503192901611,
            0.13494783639907837,
            -0.05903983116149902,
            2.745816707611084,
            3.4979188442230225,
            -4.826014041900635,
            2.3929295539855957,
            1.0575863122940063,
            2.131450653076172,
            1.1036145687103271,
            1.0216888189315796,
            -0.9297825694084167,
            -3.635848045349121,
            3.146575450897217,
            -1.825627088546753,
            -3.6498849391937256,
            -1.123746633529663,
            -0.6067967414855957,
            0.6506108045578003,
            -4.180391788482666,
            -3.7738707065582275,
            0.5583537220954895,
            1.742978811264038,
            -5.1210832595825195,
            0.13210999965667725,
            -2.3475089073181152,
            1.307837963104248,
            0.7595410943031311,
            1.2615582942962646,
            -1.168433666229248,
            -3.5087788105010986,
            -1.8812764883041382,
            -1.5837305784225464,
            4.240630149841309,
            -0.17550504207611084,
            -1.8708683252334595,
            -1.1413377523422241,
            2.4445953369140625,
            2.588197708129883,
            1.103235125541687,
            3.3608880043029785,
            0.23295855522155762,
            -4.871784210205078,
            -2.649226188659668,
            -1.073215365409851,
            4.717040538787842,
            -1.4898533821105957,
            -4.4929351806640625,
            5.617762565612793,
            4.546647071838379,
            1.7760058641433716,
            2.4652557373046875,
            2.2858970165252686,
            3.5715785026550293,
            -1.0466036796569824,
            3.766663074493408,
            -1.0917963981628418,
            2.8677783012390137,
            1.593215823173523,
            -2.660101890563965,
            1.7624573707580566,
            2.0760912895202637,
            0.2806074619293213,
            -1.7253518104553223,
            -4.719618797302246,
            -1.1032603979110718,
            -0.4953847825527191,
            1.253461241722107,
            6.5945963859558105,
            3.3674519062042236,
            2.7895212173461914,
            2.2990097999572754,
            -0.14070367813110352,
            -0.8551310896873474,
            1.6317014694213867,
            -3.368757724761963,
            3.3513197898864746,
            -1.9146702289581299,
            0.04612430930137634,
            3.7475509643554688,
            1.1594805717468262,
            2.6476283073425293,
            2.3316774368286133,
            -1.5666804313659668,
            -0.6220719814300537,
            -0.968855619430542,
            3.0097386837005615,
            1.109932541847229,
            2.0480868816375732,
            -1.04829740524292,
            2.8658058643341064,
            0.15125012397766113,
            5.6485395431518555,
            6.701075077056885,
            5.183963298797607,
            2.937100410461426,
            -1.7142174243927002,
            0.13382995128631592,
            -2.5688488483428955,
            0.7464828491210938,
            6.038424491882324,
            -4.550466060638428,
            -1.6217095851898193,
            0.734227180480957,
            4.0053558349609375,
            -0.1178199052810669,
            1.5366315841674805,
            0.36774423718452454,
            2.46382474899292,
            -2.3900773525238037,
            -1.5286593437194824,
            -3.5118260383605957,
            -0.22874271869659424,
            2.064837694168091,
            1.1693012714385986,
            0.4931371510028839,
            -3.756545066833496,
            -2.741158962249756,
            1.2994080781936646,
            -1.858855962753296,
            -1.5019432306289673,
            2.5425825119018555,
            6.551082611083984,
            2.051260471343994,
            1.8209917545318604,
            -0.8210731744766235,
            0.8057929873466492,
            -5.262123107910156,
            -1.7030174732208252,
            -0.9725707173347473,
            3.8838229179382324,
            -2.8577935695648193,
            -0.5474635362625122,
            -0.4797798693180084,
            -3.412717342376709,
            -0.3697058856487274,
            0.40530434250831604,
            2.688507080078125,
            1.8913689851760864,
            3.228647232055664,
            3.289153575897217,
            -3.772404193878174,
            -0.9800117015838623,
            -2.7986693382263184,
            -2.6779303550720215,
            -0.832372784614563,
            -5.83827018737793,
            -0.41345882415771484,
            -5.247224807739258,
            -2.7176339626312256,
            2.3799877166748047,
            -2.5742111206054688,
            -2.0453391075134277,
            2.3593249320983887,
            -0.8142515420913696,
            0.16748695075511932,
            -2.9028196334838867,
            0.8962495923042297,
            -3.609933376312256,
            0.4485403895378113,
            1.8959829807281494,
            -3.043552875518799,
            2.9825491905212402,
            -0.09078869223594666,
            2.169685125350952,
            3.623406410217285,
            2.901249408721924,
            -2.4272162914276123,
            0.9248859882354736,
            3.171496868133545,
            1.5890812873840332,
            -2.538346767425537,
            -0.14429603517055511,
            1.7380238771438599,
            0.31258654594421387,
            15.973272323608398,
            2.809293270111084,
            0.572515606880188,
            -2.821749210357666,
            0.3181539475917816,
            -5.176812648773193,
            -0.12214052677154541,
            1.736114263534546,
            1.462071180343628,
            1.3376781940460205,
            -2.634514570236206,
            -3.1567885875701904,
            -1.4208565950393677,
            -1.1390907764434814,
            -4.487154006958008,
            -0.05358883738517761,
            -1.697300672531128,
            2.417759895324707,
            -1.674566626548767,
            -0.4137894809246063,
            -0.5441948175430298,
            1.9278260469436646,
            -3.648648262023926,
            0.3413180112838745,
            0.9838556051254272,
            5.452044486999512,
            1.4507713317871094,
            -0.6636896133422852,
            -5.814914703369141,
            -0.3608298897743225,
            -1.0517895221710205,
            -0.64166259765625,
            -0.532670259475708,
            2.10319185256958,
            -3.2636098861694336,
            5.55776309967041,
            2.651777744293213,
            -0.031169965863227844,
            0.45897141098976135,
            2.2426493167877197,
            -4.406040191650391,
            1.0693602561950684,
            -3.285254716873169,
            0.5365952253341675,
            -0.35537809133529663,
            0.4796316623687744,
            1.409590244293213,
            -3.3333053588867188,
            -1.0285216569900513,
            3.496703863143921,
            -0.09339475631713867,
            0.00862032175064087,
            -2.6896941661834717,
            3.230597496032715,
            2.482095956802368,
            6.387700080871582,
            0.16668954491615295,
            -1.621093511581421,
            0.5510328412055969,
            1.7339625358581543,
            3.2670319080352783,
            0.7254023551940918,
            -2.3639771938323975,
            -1.8368138074874878,
            0.48613566160202026,
            -2.1431541442871094,
            -3.5625457763671875,
            2.395444393157959,
            3.080698251724243,
            2.374724864959717,
            3.151431083679199,
            0.5977479219436646,
            0.10015326738357544,
            -3.2665019035339355,
            -1.8876383304595947,
            -6.097259998321533,
            -0.17883306741714478,
            -1.468265175819397,
            2.067725658416748,
            5.480867385864258,
            -2.7665963172912598,
            1.6798136234283447,
            -4.054842948913574,
            1.8443843126296997,
            7.005949974060059,
            -2.651183843612671,
            5.567242622375488,
            -0.011394143104553223,
            -2.482206106185913,
            3.422022819519043,
            -1.3326940536499023,
            -2.1746644973754883,
            2.2551372051239014,
            3.2966761589050293,
            3.4364829063415527,
            -0.4657013714313507,
            -2.1064486503601074,
            -1.6923205852508545,
            -3.445939064025879,
            -4.56849479675293,
            3.308619499206543,
            5.118889808654785,
            -0.016046732664108276,
            0.2453092336654663,
            -1.1440235376358032,
            -1.9495272636413574,
            0.28320252895355225,
            -4.8959455490112305,
            -2.9126827716827393,
            -1.8092399835586548,
            3.2498037815093994,
            -2.3944101333618164,
            -1.6178841590881348,
            -0.7531220316886902,
            -1.829522967338562,
            0.45697829127311707,
            -0.6373460292816162,
            4.805591583251953,
            2.3022701740264893,
            1.9157061576843262,
            2.633157968521118,
            -0.266936719417572,
            -2.358311653137207,
            -1.3613293170928955,
            -4.800768852233887,
            -0.31833261251449585,
            1.4515713453292847,
            -2.368291139602661,
            2.9610352516174316,
            0.19221234321594238,
            1.7414039373397827,
            -2.214695930480957,
            -3.720308303833008,
            -2.288357734680176,
            -1.9820969104766846,
            -1.6958463191986084,
            0.48101046681404114,
            2.1031322479248047,
            -2.7524633407592773,
            2.0811357498168945,
            3.367175340652466,
            -4.223991394042969,
            -4.044763088226318,
            7.41820764541626,
            -2.376612663269043,
            -0.7975265383720398,
            -1.5928748846054077,
            0.6956477165222168,
            -0.40179651975631714,
            -0.5302252173423767,
            3.015467405319214,
            1.4121830463409424,
            1.7369623184204102,
            0.2933875024318695,
            -0.04554152488708496,
            -1.8798989057540894
        ]
    },
    "authors": [
        {
            "authorId": "16092809",
            "name": "Jason Ramapuram"
        },
        {
            "authorId": "2238620937",
            "name": "Federico Danieli"
        },
        {
            "authorId": "76954832",
            "name": "Eeshan Gunesh Dhekane"
        },
        {
            "authorId": "1395932715",
            "name": "Floris Weers"
        },
        {
            "authorId": "2290484744",
            "name": "Dan Busbridge"
        },
        {
            "authorId": "2320149638",
            "name": "Pierre Ablin"
        },
        {
            "authorId": "145827700",
            "name": "T. Likhomanenko"
        },
        {
            "authorId": "2058394941",
            "name": "Jagrit Digani"
        },
        {
            "authorId": "2303358631",
            "name": "Zijin Gu"
        },
        {
            "authorId": "2156931799",
            "name": "Amitis Shidani"
        },
        {
            "authorId": "51138986",
            "name": "Russ Webb"
        }
    ],
    "references": []
}