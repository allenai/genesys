{
    "paperId": "f2b3a778b65770787d0fd9a71398001e71bb062e",
    "externalIds": {
        "ArXiv": "2408.09000",
        "CorpusId": 271903235
    },
    "title": "Classifier-Free Guidance is a Predictor-Corrector",
    "abstract": "We investigate the theoretical foundations of classifier-free guidance (CFG). CFG is the dominant method of conditional sampling for text-to-image diffusion models, yet unlike other aspects of diffusion, it remains on shaky theoretical footing. In this paper, we disprove common misconceptions, by showing that CFG interacts differently with DDPM (Ho et al., 2020) and DDIM (Song et al., 2021), and neither sampler with CFG generates the gamma-powered distribution $p(x|c)^\\gamma p(x)^{1-\\gamma}$. Then, we clarify the behavior of CFG by showing that it is a kind of predictor-corrector method (Song et al., 2020) that alternates between denoising and sharpening, which we call predictor-corrector guidance (PCG). We prove that in the SDE limit, CFG is actually equivalent to combining a DDIM predictor for the conditional distribution together with a Langevin dynamics corrector for a gamma-powered distribution (with a carefully chosen gamma). Our work thus provides a lens to theoretically understand CFG by embedding it in a broader design space of principled sampling methods.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "It is proved that in the SDE limit, CFG is actually equivalent to combining a DDIM predictor for the conditional distribution together with a Langevin dynamics corrector for a gamma-powered distribution (with a carefully chosen gamma)."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -1.3855104446411133,
            -0.2752571105957031,
            0.19206851720809937,
            4.013619422912598,
            0.1647326797246933,
            0.567399799823761,
            0.196011483669281,
            -0.9503718018531799,
            0.9235026836395264,
            -0.06305289268493652,
            -3.044924259185791,
            2.390781879425049,
            4.4181013107299805,
            -0.8509834408760071,
            -1.018733024597168,
            1.2187256813049316,
            0.5573964715003967,
            -0.26944297552108765,
            0.6919505596160889,
            2.3012380599975586,
            0.5183039903640747,
            0.19385862350463867,
            -3.534646987915039,
            -1.2429604530334473,
            -2.1682095527648926,
            -2.7216482162475586,
            1.4986426830291748,
            -0.5226342678070068,
            -2.4319684505462646,
            -0.5009112358093262,
            0.3815280795097351,
            -6.630038261413574,
            4.308591365814209,
            -1.3633153438568115,
            0.5176186561584473,
            -3.3121798038482666,
            3.5121469497680664,
            5.97003698348999,
            -1.7420170307159424,
            -0.7073214650154114,
            -3.285334587097168,
            3.281425952911377,
            2.3534042835235596,
            0.4388284981250763,
            1.4771711826324463,
            -1.8244860172271729,
            0.9435072541236877,
            1.3635998964309692,
            -1.6513251066207886,
            0.8189408779144287,
            1.266305923461914,
            0.6680505871772766,
            1.7309515476226807,
            0.8727675676345825,
            1.169992446899414,
            0.1328887939453125,
            0.7235075235366821,
            0.9030896425247192,
            3.251645803451538,
            -1.8769268989562988,
            2.3158388137817383,
            3.9327352046966553,
            -2.1791915893554688,
            -0.8007309436798096,
            0.10602211952209473,
            -4.9223313331604,
            0.4929494261741638,
            5.466192722320557,
            1.521082878112793,
            0.11905600130558014,
            -0.07466509938240051,
            -2.3568122386932373,
            2.097170114517212,
            -1.4582957029342651,
            0.25733283162117004,
            2.322479009628296,
            1.9929568767547607,
            -1.6373381614685059,
            0.11986055970191956,
            0.277652770280838,
            0.010031521320343018,
            -0.30405503511428833,
            -1.308061122894287,
            1.0401902198791504,
            -0.17361582815647125,
            -0.7580058574676514,
            -5.297207832336426,
            -0.5687770843505859,
            3.0142767429351807,
            -4.815703392028809,
            -2.110394239425659,
            0.9972409009933472,
            2.4667232036590576,
            1.383865475654602,
            -3.0737626552581787,
            0.36726129055023193,
            -0.6827642321586609,
            1.5388420820236206,
            -0.8227484822273254,
            -1.1172959804534912,
            0.4424334466457367,
            0.26052743196487427,
            2.4595441818237305,
            -0.4565025568008423,
            2.931307792663574,
            0.6391696333885193,
            0.0750376284122467,
            1.5998671054840088,
            0.19489401578903198,
            -2.6357176303863525,
            0.4817453622817993,
            0.5307313203811646,
            -1.1432827711105347,
            -3.548302173614502,
            -1.4136226177215576,
            1.5101799964904785,
            -2.386073589324951,
            0.5301787853240967,
            -0.17822003364562988,
            6.82542610168457,
            -1.3320789337158203,
            -3.3857388496398926,
            -3.2054028511047363,
            1.03703773021698,
            -1.4309725761413574,
            -4.210763931274414,
            -2.8031845092773438,
            3.0057077407836914,
            -1.010280966758728,
            -2.953118085861206,
            2.912355899810791,
            -0.672998309135437,
            2.7038540840148926,
            1.2520768642425537,
            3.6728925704956055,
            1.599729299545288,
            1.9445399045944214,
            1.9541627168655396,
            -0.8062964081764221,
            -1.9237711429595947,
            -0.388816237449646,
            2.5602612495422363,
            -0.45035260915756226,
            0.13989335298538208,
            -0.6704363822937012,
            4.3534255027771,
            0.2804797887802124,
            -0.0748593807220459,
            0.526496946811676,
            5.232863903045654,
            3.5710132122039795,
            -4.68902063369751,
            1.2448348999023438,
            0.19903939962387085,
            1.1366360187530518,
            -1.7603205442428589,
            -3.0634570121765137,
            1.5059330463409424,
            1.934878945350647,
            -0.37929463386535645,
            2.90095853805542,
            -1.9369072914123535,
            -6.885034561157227,
            -1.2397973537445068,
            4.463385581970215,
            -5.733160972595215,
            0.19678683578968048,
            0.8342423439025879,
            -0.00782284140586853,
            -0.2849287986755371,
            2.0687084197998047,
            -0.7707231640815735,
            2.132701873779297,
            1.5418744087219238,
            3.364211320877075,
            4.79304313659668,
            -0.4764699935913086,
            -2.6216347217559814,
            -1.3590377569198608,
            2.6912753582000732,
            1.6057934761047363,
            -1.1074554920196533,
            -2.6720614433288574,
            -0.05234441161155701,
            -2.354113817214966,
            -4.35898494720459,
            -0.7562474608421326,
            -2.395174503326416,
            -0.2904258072376251,
            1.8878875970840454,
            -1.858985185623169,
            1.8391730785369873,
            4.430023670196533,
            6.064881801605225,
            -1.4747495651245117,
            0.2954496443271637,
            1.7265994548797607,
            1.3165276050567627,
            -0.7613906860351562,
            0.29715365171432495,
            2.3063554763793945,
            0.5127458572387695,
            -1.7353472709655762,
            1.379496693611145,
            2.872884750366211,
            1.3266607522964478,
            -2.600492000579834,
            5.235496520996094,
            -0.6421417593955994,
            1.6742805242538452,
            -2.8423922061920166,
            -0.90802001953125,
            -4.020209312438965,
            -0.07909715175628662,
            -1.9349780082702637,
            -1.150109052658081,
            -4.534514427185059,
            1.9459182024002075,
            2.4006330966949463,
            -0.2095963954925537,
            -1.317482590675354,
            -1.1695427894592285,
            -0.039988934993743896,
            -0.635917067527771,
            4.403173923492432,
            -1.9332730770111084,
            4.248735427856445,
            -4.902716636657715,
            0.2436099350452423,
            -0.8044350147247314,
            1.2056312561035156,
            -1.6453440189361572,
            -0.8043477535247803,
            0.8850259184837341,
            -2.097254753112793,
            -1.970597743988037,
            -4.3776702880859375,
            1.3178260326385498,
            -0.5227786302566528,
            0.7003612518310547,
            3.4642605781555176,
            -1.2210371494293213,
            0.31512337923049927,
            2.8668484687805176,
            1.7748770713806152,
            2.581997871398926,
            -2.378101348876953,
            3.4598536491394043,
            -3.2057700157165527,
            -2.5125880241394043,
            -0.674471914768219,
            -2.049351930618286,
            3.9506943225860596,
            -2.265533685684204,
            1.578217625617981,
            2.200359582901001,
            -1.924509882926941,
            1.6857267618179321,
            -0.02725633978843689,
            1.675230860710144,
            2.0673630237579346,
            3.749875068664551,
            -1.893162488937378,
            0.4218255877494812,
            -0.6196920871734619,
            -4.122633934020996,
            -3.9319193363189697,
            -4.892430305480957,
            -1.5456939935684204,
            2.7668395042419434,
            4.05905818939209,
            0.4372120797634125,
            2.2126245498657227,
            -3.936086654663086,
            -4.733038902282715,
            -5.895846366882324,
            -2.9510338306427,
            1.5737864971160889,
            2.025009870529175,
            3.5637192726135254,
            -0.44130566716194153,
            -0.00760621577501297,
            1.1242849826812744,
            1.2357406616210938,
            -3.5422048568725586,
            -4.046908378601074,
            0.09466105699539185,
            1.656943917274475,
            2.4182987213134766,
            1.2400050163269043,
            0.2697676718235016,
            4.628554344177246,
            -0.1772269606590271,
            2.648906707763672,
            -2.4108285903930664,
            3.0705137252807617,
            1.9847651720046997,
            -0.6347087025642395,
            2.152625560760498,
            -2.4727225303649902,
            -1.9843908548355103,
            2.3032405376434326,
            1.6256153583526611,
            -1.156862735748291,
            1.787424087524414,
            2.0902633666992188,
            -1.6911616325378418,
            -1.7396001815795898,
            2.2728919982910156,
            -4.217035293579102,
            0.39103198051452637,
            0.17121517658233643,
            2.961676836013794,
            -2.971801280975342,
            -2.8586597442626953,
            -1.9980342388153076,
            -1.4774588346481323,
            -1.7135870456695557,
            -3.866584300994873,
            4.8375244140625,
            3.0524020195007324,
            3.0019445419311523,
            -3.656874895095825,
            -4.289283752441406,
            -2.1775450706481934,
            -1.9998130798339844,
            1.1194920539855957,
            2.4374310970306396,
            -1.349097728729248,
            -1.6583871841430664,
            0.32559508085250854,
            2.1336569786071777,
            2.267535448074341,
            1.8328735828399658,
            -1.9208669662475586,
            -4.194504261016846,
            -2.010406732559204,
            0.932430624961853,
            3.439901828765869,
            -0.8980369567871094,
            2.164475917816162,
            5.583670616149902,
            -1.8196020126342773,
            1.730889081954956,
            -1.1538933515548706,
            -1.205493688583374,
            -0.05927705764770508,
            -3.463357925415039,
            0.1557580828666687,
            1.2046618461608887,
            4.235321998596191,
            0.48931220173835754,
            -1.9805316925048828,
            -2.754101276397705,
            0.5671244859695435,
            2.102658271789551,
            5.586124897003174,
            1.5587329864501953,
            4.354333400726318,
            3.279775381088257,
            -2.187736749649048,
            0.874220609664917,
            2.8586978912353516,
            -1.1736013889312744,
            -2.262934923171997,
            -2.9952316284179688,
            8.370633125305176,
            -1.5257188081741333,
            -0.2865559458732605,
            -4.496889591217041,
            -0.004254549741744995,
            1.265970230102539,
            -2.2624707221984863,
            3.024801254272461,
            -2.90793776512146,
            -4.611170768737793,
            -1.4397530555725098,
            -1.023193120956421,
            1.4239239692687988,
            0.7993650436401367,
            0.17801839113235474,
            2.0561163425445557,
            0.7650660276412964,
            7.5944671630859375,
            -0.3745119571685791,
            2.8226711750030518,
            -0.5926883220672607,
            1.77236008644104,
            1.8976385593414307,
            -1.2749896049499512,
            -0.981201708316803,
            2.686307907104492,
            1.4267981052398682,
            4.323243141174316,
            -6.291131496429443,
            -1.2602611780166626,
            -3.0416855812072754,
            -2.7002813816070557,
            -0.6460734009742737,
            -3.065541982650757,
            -3.797898292541504,
            2.598954200744629,
            5.528316974639893,
            -1.5766515731811523,
            -2.4364266395568848,
            -1.2994678020477295,
            4.013514518737793,
            -2.928680658340454,
            -0.48062655329704285,
            2.080049514770508,
            -1.9068357944488525,
            -0.6652659177780151,
            2.0803439617156982,
            -7.0188493728637695,
            -1.9579805135726929,
            1.6209503412246704,
            1.7762192487716675,
            2.33383846282959,
            1.8350924253463745,
            4.317364692687988,
            -3.8848533630371094,
            1.8856016397476196,
            3.8153817653656006,
            2.5022099018096924,
            -2.1137266159057617,
            3.621666431427002,
            4.2198052406311035,
            1.080501914024353,
            1.0998871326446533,
            0.640234112739563,
            -0.4912646412849426,
            4.003527641296387,
            -1.9744422435760498,
            -1.257362723350525,
            -0.7182907462120056,
            4.568367004394531,
            2.2677574157714844,
            3.358118772506714,
            0.8827052712440491,
            -1.7788333892822266,
            -2.2389328479766846,
            3.1248342990875244,
            -1.2168723344802856,
            5.281828880310059,
            0.47374099493026733,
            1.2561076879501343,
            -1.3860390186309814,
            -0.23425263166427612,
            1.682433009147644,
            -0.5166501402854919,
            2.6088104248046875,
            -3.049330234527588,
            -1.2942078113555908,
            -0.9292566776275635,
            -0.41332244873046875,
            0.5904797911643982,
            0.37155860662460327,
            -2.5467512607574463,
            -0.2892894744873047,
            0.5029274225234985,
            -4.041146278381348,
            2.6696548461914062,
            0.7363879680633545,
            0.4743780493736267,
            1.4837267398834229,
            3.2644808292388916,
            -1.7392934560775757,
            -2.3762600421905518,
            -3.550875663757324,
            -1.449150562286377,
            3.7897253036499023,
            -0.745042622089386,
            -1.1652638912200928,
            -4.842672824859619,
            1.064996600151062,
            3.3738059997558594,
            3.833780288696289,
            1.8356202840805054,
            -1.278105616569519,
            -0.8896762728691101,
            -4.41703987121582,
            -3.2998006343841553,
            1.524158239364624,
            1.7159024477005005,
            -1.6206567287445068,
            -0.2296231985092163,
            0.5465072989463806,
            1.7682266235351562,
            6.130779266357422,
            1.3996880054473877,
            -2.8668909072875977,
            1.4481911659240723,
            5.116250038146973,
            -0.7906989455223083,
            -1.758805751800537,
            1.4857118129730225,
            -4.535879611968994,
            -0.7933846712112427,
            -1.098705530166626,
            -2.033146858215332,
            2.559969425201416,
            -2.706568956375122,
            1.8101128339767456,
            1.3396048545837402,
            -1.4346940517425537,
            3.7813429832458496,
            0.4464987516403198,
            4.592377662658691,
            2.757058620452881,
            -0.4243633449077606,
            -4.31166934967041,
            -0.6732067465782166,
            -2.4616341590881348,
            1.8710048198699951,
            -2.804856777191162,
            -0.36729806661605835,
            0.44395992159843445,
            -3.2031266689300537,
            -0.22207222878932953,
            1.412238359451294,
            2.2304978370666504,
            -2.523618698120117,
            -2.3148891925811768,
            1.9536261558532715,
            2.670067310333252,
            -0.6059950590133667,
            -5.166695594787598,
            0.6331562995910645,
            0.2635800242424011,
            4.426804542541504,
            5.907797813415527,
            4.336848735809326,
            2.9768564701080322,
            -0.19696396589279175,
            -1.478157877922058,
            -1.1271685361862183,
            -0.6112707853317261,
            9.472679138183594,
            -0.8038041591644287,
            0.6428735256195068,
            -1.703384280204773,
            -1.1264050006866455,
            -2.9704360961914062,
            2.706281900405884,
            -0.7501311302185059,
            5.16562032699585,
            0.25843316316604614,
            -6.090190887451172,
            -1.145857810974121,
            0.1250735968351364,
            2.70564866065979,
            0.949791669845581,
            3.169224739074707,
            -0.013959646224975586,
            -1.8467390537261963,
            -1.6925584077835083,
            -0.2004367709159851,
            -3.7548999786376953,
            -1.373492956161499,
            1.8758559226989746,
            0.5216025114059448,
            -2.1424121856689453,
            2.4708151817321777,
            4.399201393127441,
            -0.36079302430152893,
            0.8643209934234619,
            -1.1558822393417358,
            1.0591319799423218,
            0.0425262376666069,
            -2.327397584915161,
            -0.8340161442756653,
            -4.443758010864258,
            -3.4833502769470215,
            -1.9992090463638306,
            -0.6761599779129028,
            2.97843074798584,
            6.602201461791992,
            0.01960866153240204,
            -0.6718664765357971,
            -2.7555582523345947,
            -1.9232633113861084,
            -3.967848300933838,
            -0.34223341941833496,
            -2.979767322540283,
            2.995004177093506,
            -1.8135738372802734,
            -2.254603385925293,
            1.984836459159851,
            -4.963398456573486,
            -1.3018805980682373,
            1.3570079803466797,
            -0.9960262775421143,
            -0.9833744168281555,
            -2.0876903533935547,
            1.3532428741455078,
            -1.0844104290008545,
            2.5068209171295166,
            -1.5853545665740967,
            2.955522060394287,
            -0.440815806388855,
            1.9595997333526611,
            3.4939961433410645,
            2.8826234340667725,
            4.096762180328369,
            1.1679898500442505,
            -0.3723030388355255,
            5.77835750579834,
            2.123838424682617,
            -3.304692029953003,
            1.3682719469070435,
            -1.260970115661621,
            0.2883651554584503,
            17.973276138305664,
            -4.06172513961792,
            -0.006250977516174316,
            3.021285057067871,
            -0.3203210234642029,
            -5.6775031089782715,
            1.0851083993911743,
            5.900069236755371,
            0.7045842409133911,
            -0.13955336809158325,
            -1.2589998245239258,
            -2.4580421447753906,
            -0.6577986478805542,
            2.886185646057129,
            -2.2130162715911865,
            1.3208098411560059,
            -4.689844131469727,
            2.554058790206909,
            -2.3711705207824707,
            1.4386950731277466,
            0.0015084147453308105,
            2.7705492973327637,
            -0.3126639127731323,
            -1.2982242107391357,
            3.809987783432007,
            2.6568048000335693,
            -2.656217098236084,
            2.4503626823425293,
            -4.113465309143066,
            1.036401391029358,
            0.6654572486877441,
            -1.1941556930541992,
            3.6803159713745117,
            -1.149215579032898,
            -0.44582539796829224,
            0.1849360466003418,
            4.474675178527832,
            -2.5725512504577637,
            2.0403497219085693,
            -1.3871467113494873,
            1.0924913883209229,
            1.4332340955734253,
            -6.325402736663818,
            3.938648223876953,
            -4.915501117706299,
            -0.27276816964149475,
            4.332159996032715,
            -3.155552387237549,
            -1.2542840242385864,
            2.689699172973633,
            -0.27785202860832214,
            0.14139366149902344,
            -3.6757211685180664,
            1.9666147232055664,
            2.4617536067962646,
            -0.4184246361255646,
            0.6266347169876099,
            -2.9275999069213867,
            0.2586829662322998,
            2.769369602203369,
            -1.553544282913208,
            -0.03700751066207886,
            -0.18086454272270203,
            -2.4604101181030273,
            -3.5295321941375732,
            -1.0431232452392578,
            -3.3703784942626953,
            0.3173564076423645,
            3.953875780105591,
            2.1683459281921387,
            5.590150833129883,
            0.15819692611694336,
            -2.914564371109009,
            -4.451535701751709,
            -2.6143505573272705,
            -3.632458209991455,
            0.868494987487793,
            -0.03527331352233887,
            2.842754364013672,
            1.3526370525360107,
            -2.1928417682647705,
            0.8837724924087524,
            0.5838993787765503,
            0.05556035041809082,
            6.3767409324646,
            -2.6967339515686035,
            -0.5344557762145996,
            -6.488590717315674,
            -2.341197967529297,
            2.6971940994262695,
            -2.979024648666382,
            0.1876893937587738,
            2.914808750152588,
            0.3788928985595703,
            3.1536715030670166,
            -4.439382553100586,
            -0.9541545510292053,
            -3.5906946659088135,
            -1.7778995037078857,
            -4.001628875732422,
            3.0427658557891846,
            -0.033144235610961914,
            2.4851996898651123,
            1.2847073078155518,
            3.341907501220703,
            2.087899684906006,
            -1.581558346748352,
            -1.171125054359436,
            -0.5724320411682129,
            0.11700019240379333,
            -0.1972399801015854,
            -0.33322253823280334,
            0.22892022132873535,
            3.273611545562744,
            -0.22234465181827545,
            -0.2848470211029053,
            -1.9791202545166016,
            1.642378568649292,
            2.760050058364868,
            4.5326690673828125,
            0.48175132274627686,
            -1.7219531536102295,
            -3.330301284790039,
            -5.318490028381348,
            -0.7825441360473633,
            1.652391791343689,
            -3.6248111724853516,
            -2.669093608856201,
            0.43247172236442566,
            -6.293508529663086,
            -1.3114901781082153,
            -2.265131950378418,
            1.0601978302001953,
            1.3865545988082886,
            -1.654020071029663,
            -1.917182445526123,
            1.9456071853637695,
            0.9311672449111938,
            1.3937749862670898,
            8.66749382019043,
            0.6154043674468994,
            -3.773200273513794,
            -2.691603422164917,
            7.342314720153809,
            -0.49141183495521545,
            -1.6361674070358276,
            -1.6350090503692627,
            0.4115438163280487,
            -1.2172868251800537,
            1.9381078481674194,
            -2.7407450675964355,
            -2.1571614742279053,
            1.8508832454681396,
            -0.8909428119659424,
            0.3601331412792206,
            -3.891098737716675
        ]
    },
    "authors": [
        {
            "authorId": "2261389630",
            "name": "Arwen Bradley"
        },
        {
            "authorId": "2181918",
            "name": "Preetum Nakkiran"
        }
    ],
    "references": []
}