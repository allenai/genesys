{
    "paperId": "6ab7d27787903d78d7222340fd92f03ecd77eeac",
    "externalIds": {
        "ArXiv": "2408.05430",
        "CorpusId": 271854999
    },
    "title": "HoME: Hierarchy of Multi-Gate Experts for Multi-Task Learning at Kuaishou",
    "abstract": "In this paper, we present the practical problems and the lessons learned at short-video services from Kuaishou. In industry, a widely-used multi-task framework is the Mixture-of-Experts (MoE) paradigm, which always introduces some shared and specific experts for each task and then uses gate networks to measure related experts' contributions. Although the MoE achieves remarkable improvements, we still observe three anomalies that seriously affect model performances in our iteration: (1) Expert Collapse: We found that experts' output distributions are significantly different, and some experts have over 90% zero activations with ReLU, making it hard for gate networks to assign fair weights to balance experts. (2) Expert Degradation: Ideally, the shared-expert aims to provide predictive information for all tasks simultaneously. Nevertheless, we find that some shared-experts are occupied by only one task, which indicates that shared-experts lost their ability but degenerated into some specific-experts. (3) Expert Underfitting: In our services, we have dozens of behavior tasks that need to be predicted, but we find that some data-sparse prediction tasks tend to ignore their specific-experts and assign large weights to shared-experts. The reason might be that the shared-experts can perceive more gradient updates and knowledge from dense tasks, while specific-experts easily fall into underfitting due to their sparse behaviors. Motivated by those observations, we propose HoME to achieve a simple, efficient and balanced MoE system for multi-task learning.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "The practical problems and the lessons learned at short-video services from Kuaishou are presented, and HoME is proposed to achieve a simple, efficient and balanced MoE system for multi-task learning."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.274173736572266,
            -1.5971802473068237,
            -0.11168007552623749,
            4.416474342346191,
            -3.2024002075195312,
            -2.8605690002441406,
            1.793594241142273,
            -5.262338161468506,
            0.6904059052467346,
            -1.4657883644104004,
            -4.34354829788208,
            3.0169119834899902,
            -0.4008881449699402,
            0.645038902759552,
            -1.5376217365264893,
            0.3097676634788513,
            0.4008868634700775,
            4.625514507293701,
            3.043025255203247,
            2.639995574951172,
            -3.867551326751709,
            2.832925796508789,
            -3.402961254119873,
            1.9434406757354736,
            1.2192758321762085,
            -3.3124194145202637,
            1.1448981761932373,
            2.4985179901123047,
            0.9604537487030029,
            -0.643905520439148,
            3.4867613315582275,
            -6.854206085205078,
            6.753028869628906,
            -4.373502254486084,
            2.1142382621765137,
            -3.813063144683838,
            -2.766838788986206,
            7.690502643585205,
            -2.112205743789673,
            1.8960343599319458,
            0.2938322424888611,
            3.9238293170928955,
            0.1704954206943512,
            -0.17366933822631836,
            2.565014362335205,
            -1.117342233657837,
            2.7077653408050537,
            2.1890206336975098,
            1.6231399774551392,
            -0.6472687721252441,
            3.4511570930480957,
            -0.13492168486118317,
            -1.690848469734192,
            0.8578341603279114,
            0.49485138058662415,
            -3.1077370643615723,
            3.376373767852783,
            1.9055932760238647,
            5.475466728210449,
            -2.476439952850342,
            3.068223714828491,
            4.174646854400635,
            1.5893268585205078,
            2.3419833183288574,
            5.403868675231934,
            -1.2914766073226929,
            -2.056553363800049,
            6.3917083740234375,
            1.3053733110427856,
            1.8581575155258179,
            1.222373127937317,
            -2.4103736877441406,
            -1.9715335369110107,
            1.852849006652832,
            -3.8870465755462646,
            1.968454360961914,
            1.574538230895996,
            -9.77090072631836,
            -1.439103126525879,
            -0.9650688767433167,
            3.5237672328948975,
            0.12128651142120361,
            -2.07246470451355,
            3.2665586471557617,
            4.149970054626465,
            -0.8024896383285522,
            -5.065677642822266,
            1.3852427005767822,
            3.519674777984619,
            -4.155812740325928,
            1.6723062992095947,
            2.1276144981384277,
            -1.3142833709716797,
            0.9128904342651367,
            -6.09017276763916,
            0.06739899516105652,
            -1.9175726175308228,
            -0.22647011280059814,
            -2.6880242824554443,
            0.03993615508079529,
            0.512846827507019,
            -2.465834617614746,
            0.6028289794921875,
            -0.9090642929077148,
            3.5162014961242676,
            -3.2196285724639893,
            -1.1443006992340088,
            -0.42149636149406433,
            2.7307186126708984,
            -2.532656669616699,
            -1.1506586074829102,
            1.0288375616073608,
            -0.2534273862838745,
            -2.987191677093506,
            -2.371943712234497,
            -3.1805338859558105,
            -3.579998731613159,
            3.364309549331665,
            -0.5607661008834839,
            3.877589225769043,
            -3.264035224914551,
            2.7100183963775635,
            -4.122150421142578,
            1.3543909788131714,
            -1.6863365173339844,
            0.5272014141082764,
            -0.8639504909515381,
            1.1266448497772217,
            -0.6397217512130737,
            -7.947601795196533,
            3.6148276329040527,
            -0.7582041621208191,
            3.6870665550231934,
            -3.457003355026245,
            2.4337382316589355,
            6.874964714050293,
            -2.0426464080810547,
            -1.1519384384155273,
            -0.08360171318054199,
            -0.40845173597335815,
            -1.2761985063552856,
            0.2573360800743103,
            -0.3225356340408325,
            -1.9367482662200928,
            -0.8035500049591064,
            1.2372407913208008,
            -0.9698885679244995,
            1.1253840923309326,
            -0.5625287294387817,
            5.696017265319824,
            5.736404895782471,
            -3.242412567138672,
            -1.0280356407165527,
            2.961277723312378,
            0.5927269458770752,
            2.3744449615478516,
            -5.931395053863525,
            1.0511144399642944,
            -1.7565066814422607,
            -0.6153630018234253,
            -0.7923610210418701,
            3.0374462604522705,
            -7.340239524841309,
            -0.931470513343811,
            2.897587299346924,
            -2.4470038414001465,
            0.910400927066803,
            1.4576711654663086,
            1.5484540462493896,
            1.6464951038360596,
            0.22514228522777557,
            -0.002210557460784912,
            1.1610710620880127,
            2.692161798477173,
            2.040994644165039,
            1.518947720527649,
            -1.2040839195251465,
            -2.282280445098877,
            0.5508550405502319,
            -1.5303149223327637,
            -1.2238342761993408,
            -2.260080337524414,
            -6.59765100479126,
            0.7888187766075134,
            -2.997927188873291,
            -1.8553431034088135,
            -3.1202707290649414,
            -1.562603235244751,
            -3.057559013366699,
            -0.5103925466537476,
            -1.2808318138122559,
            2.8327646255493164,
            7.535336494445801,
            4.315056324005127,
            4.292078971862793,
            3.3409552574157715,
            1.198704481124878,
            0.10379326343536377,
            -1.7578401565551758,
            2.9029712677001953,
            1.4045178890228271,
            -1.4698206186294556,
            -0.15264981985092163,
            -5.385843276977539,
            5.289177417755127,
            3.143012046813965,
            -3.4154839515686035,
            2.204951524734497,
            1.5297894477844238,
            -0.4611038565635681,
            1.486985206604004,
            -0.48817259073257446,
            -2.678884983062744,
            1.614525318145752,
            -0.3756527304649353,
            -2.944831371307373,
            -4.459714889526367,
            2.616508960723877,
            3.8242225646972656,
            3.2051920890808105,
            -2.661512851715088,
            1.7140071392059326,
            1.5726346969604492,
            -2.8265066146850586,
            2.128173589706421,
            -6.653571605682373,
            2.773573398590088,
            1.7730618715286255,
            1.9107413291931152,
            -0.6848185658454895,
            -2.1567745208740234,
            -4.796792030334473,
            -0.9091037511825562,
            -3.2297191619873047,
            -3.6191844940185547,
            -1.9980148077011108,
            -7.009079933166504,
            4.156057357788086,
            -1.0642929077148438,
            -1.6212493181228638,
            6.137716293334961,
            2.6599807739257812,
            -1.867098093032837,
            3.4208812713623047,
            4.1133952140808105,
            1.0019967555999756,
            -3.2027344703674316,
            0.16569018363952637,
            -2.087442398071289,
            -4.048989772796631,
            -0.9645981788635254,
            -2.908987522125244,
            3.3189992904663086,
            -4.34868049621582,
            4.905511856079102,
            4.164555072784424,
            -2.790694236755371,
            3.027899742126465,
            0.660927414894104,
            1.1840810775756836,
            2.4841432571411133,
            3.1568541526794434,
            3.2884631156921387,
            4.175604820251465,
            0.03551238775253296,
            1.9119149446487427,
            0.9501287341117859,
            -3.818235158920288,
            -1.7318156957626343,
            4.027641296386719,
            1.4024111032485962,
            2.827753782272339,
            -0.6749259829521179,
            -4.590904712677002,
            -0.994658350944519,
            -4.207761764526367,
            -3.611536979675293,
            -1.1864994764328003,
            1.4740325212478638,
            4.376733779907227,
            -1.6930241584777832,
            -2.4229965209960938,
            -2.8653712272644043,
            -1.9146029949188232,
            0.9722071886062622,
            -1.6193344593048096,
            -5.924482345581055,
            1.321793556213379,
            1.1976289749145508,
            1.4240915775299072,
            -2.940809726715088,
            4.468544006347656,
            -3.0280847549438477,
            0.1935783326625824,
            0.1320156306028366,
            2.674088478088379,
            4.0945892333984375,
            -0.31692445278167725,
            -1.1123219728469849,
            0.16530901193618774,
            0.530504584312439,
            -2.000354051589966,
            5.2418694496154785,
            -1.4394060373306274,
            2.2702677249908447,
            3.6788175106048584,
            3.048656463623047,
            -2.6577723026275635,
            -4.1309356689453125,
            -4.369848251342773,
            -0.4104725122451782,
            5.442706108093262,
            2.218621253967285,
            -5.285314559936523,
            0.11006352305412292,
            1.4673144817352295,
            1.6428029537200928,
            -3.618718147277832,
            -5.379062652587891,
            2.6705570220947266,
            0.27840229868888855,
            -1.9202334880828857,
            -3.5026655197143555,
            -2.0798275470733643,
            -1.0367960929870605,
            -1.19193696975708,
            -0.2880297601222992,
            3.3328170776367188,
            -3.10427188873291,
            -0.15920838713645935,
            -0.08207932114601135,
            6.3251953125,
            -1.5216586589813232,
            2.734866142272949,
            0.006212174892425537,
            -4.477627754211426,
            -1.6803889274597168,
            -1.4052300453186035,
            1.8215258121490479,
            1.8434393405914307,
            -0.9472724795341492,
            5.471195697784424,
            -0.8276985883712769,
            -0.08298748731613159,
            -2.517054796218872,
            -2.058137893676758,
            1.1948366165161133,
            -3.2511215209960938,
            -2.0815296173095703,
            -5.603896141052246,
            1.670241355895996,
            -0.18745172023773193,
            0.48570549488067627,
            -0.7034885287284851,
            3.4745001792907715,
            4.211184501647949,
            3.6752970218658447,
            0.6739951968193054,
            -1.0136736631393433,
            4.681301116943359,
            0.03847014904022217,
            -4.390888214111328,
            -3.45188570022583,
            -0.695594072341919,
            -0.6614378690719604,
            -0.3311957120895386,
            10.966947555541992,
            -2.8444461822509766,
            1.3155299425125122,
            -2.8458969593048096,
            -4.63568115234375,
            -0.8732266426086426,
            -4.81441068649292,
            3.109067678451538,
            -2.740520477294922,
            -0.17233514785766602,
            -1.4598180055618286,
            -0.2518850564956665,
            1.9545719623565674,
            0.8991667628288269,
            -1.9986011981964111,
            5.879551887512207,
            2.501540184020996,
            2.1400346755981445,
            0.06370900571346283,
            -1.648571491241455,
            -4.25672721862793,
            4.102725505828857,
            -0.9356821775436401,
            1.2021085023880005,
            -1.4367347955703735,
            -0.436344176530838,
            1.8060097694396973,
            1.0952951908111572,
            -3.2314507961273193,
            -4.337230682373047,
            -0.08567196130752563,
            -0.5731249451637268,
            0.08032456040382385,
            -1.9498916864395142,
            0.6299932599067688,
            -1.8654229640960693,
            1.2174781560897827,
            4.837383270263672,
            -3.9053988456726074,
            0.9845451712608337,
            6.182010650634766,
            -3.7394609451293945,
            -1.998902678489685,
            2.491858959197998,
            -3.0595357418060303,
            -1.9043844938278198,
            -0.05820351839065552,
            -4.5123515129089355,
            5.549624919891357,
            -0.27415478229522705,
            3.2200534343719482,
            2.3027608394622803,
            3.955552577972412,
            -0.5276496410369873,
            -5.158419609069824,
            5.058252334594727,
            4.7233805656433105,
            -0.20272797346115112,
            -2.0584750175476074,
            1.3616154193878174,
            6.102906227111816,
            1.6890558004379272,
            -2.1315908432006836,
            2.519605875015259,
            -0.9172578454017639,
            4.8942999839782715,
            -2.551525354385376,
            -0.15608283877372742,
            0.2128840684890747,
            1.4779449701309204,
            0.7262334227561951,
            2.517148494720459,
            3.022254467010498,
            -1.5053441524505615,
            3.498263359069824,
            3.7409300804138184,
            -3.1065285205841064,
            5.311786651611328,
            1.4277515411376953,
            2.153397798538208,
            -0.7585517168045044,
            0.8560037612915039,
            4.605984687805176,
            -0.2572653889656067,
            0.44424858689308167,
            1.0231664180755615,
            -3.2739486694335938,
            -0.8636073470115662,
            0.6754738092422485,
            1.8460743427276611,
            -3.295775890350342,
            -0.603312611579895,
            -0.11499278247356415,
            -2.3326501846313477,
            -5.528141021728516,
            5.9474687576293945,
            2.2349863052368164,
            2.291407585144043,
            1.6863970756530762,
            1.8838675022125244,
            -0.13816696405410767,
            -4.267578125,
            -1.9127689599990845,
            -1.32444167137146,
            4.279230117797852,
            0.7228257656097412,
            -2.7685093879699707,
            -1.161415457725525,
            -0.45908063650131226,
            -0.4758094847202301,
            2.7036924362182617,
            2.620739459991455,
            2.1874470710754395,
            -5.140371322631836,
            -1.4685816764831543,
            -1.5873756408691406,
            4.107428550720215,
            -0.37959009408950806,
            -0.2115478813648224,
            5.785996437072754,
            5.3221635818481445,
            3.960475444793701,
            3.975139856338501,
            7.55777645111084,
            0.5297636985778809,
            5.377734661102295,
            5.290387153625488,
            -0.9134399890899658,
            0.19752874970436096,
            -2.305097818374634,
            -5.194830417633057,
            3.159463882446289,
            1.4621049165725708,
            -0.38634175062179565,
            2.554983139038086,
            -2.469261646270752,
            1.6100075244903564,
            -1.9846192598342896,
            -4.463667869567871,
            8.55471134185791,
            4.390296459197998,
            1.098551630973816,
            -2.3235645294189453,
            -1.9591381549835205,
            -3.5859670639038086,
            -0.5220534205436707,
            -4.465367317199707,
            0.8646080493927002,
            -3.9332966804504395,
            1.8669294118881226,
            4.4525227546691895,
            -3.4585518836975098,
            -0.19125136733055115,
            2.051414966583252,
            -3.6026625633239746,
            -1.1260266304016113,
            -3.106386661529541,
            4.0419535636901855,
            1.6594189405441284,
            0.7269889116287231,
            -6.135072231292725,
            0.8183004856109619,
            1.3816523551940918,
            3.8316335678100586,
            5.7263383865356445,
            4.265777111053467,
            7.074138641357422,
            -1.3666914701461792,
            -1.8222432136535645,
            -2.2274985313415527,
            1.6360307931900024,
            4.395284652709961,
            -1.4573695659637451,
            1.9783446788787842,
            1.6319729089736938,
            0.7725295424461365,
            -0.7378638982772827,
            2.0081613063812256,
            -0.07030928134918213,
            -0.6882439851760864,
            -4.342363357543945,
            0.908061683177948,
            -1.7524135112762451,
            1.6021506786346436,
            -0.3557863235473633,
            -2.2687196731567383,
            5.1984076499938965,
            -2.836923599243164,
            -1.6017436981201172,
            0.6923090219497681,
            -0.7682444453239441,
            -4.4514241218566895,
            -3.6146271228790283,
            5.113125801086426,
            2.002084255218506,
            -5.069850444793701,
            -2.105380058288574,
            1.9850537776947021,
            -2.6710100173950195,
            -2.408796787261963,
            -0.8368427157402039,
            2.354867458343506,
            0.8793549537658691,
            -1.0201547145843506,
            -0.5651334524154663,
            -2.7851099967956543,
            -0.15285000205039978,
            1.813905119895935,
            -0.0719495415687561,
            1.519223928451538,
            1.5721447467803955,
            4.747575759887695,
            -2.6668169498443604,
            -1.8650670051574707,
            -1.5515592098236084,
            -0.33764123916625977,
            -4.866894245147705,
            -3.5542333126068115,
            0.9365847110748291,
            -7.128596305847168,
            -2.172048568725586,
            -1.5069324970245361,
            -4.628718376159668,
            0.852837085723877,
            0.18383163213729858,
            -0.5673253536224365,
            4.233403205871582,
            -3.7010226249694824,
            -0.29522305727005005,
            -4.894003868103027,
            0.7212707996368408,
            2.982257843017578,
            0.8578142523765564,
            -2.2159476280212402,
            2.2194631099700928,
            4.121328353881836,
            1.6463098526000977,
            3.2691287994384766,
            -9.359399795532227,
            -1.0353074073791504,
            1.5741145610809326,
            0.8621994256973267,
            -2.0049691200256348,
            1.021205186843872,
            -0.4352172017097473,
            -1.4217760562896729,
            18.32042121887207,
            -1.2994089126586914,
            3.2234296798706055,
            -1.2895560264587402,
            -4.428546905517578,
            -4.943154335021973,
            -1.9721527099609375,
            1.6172380447387695,
            2.894996404647827,
            -0.14584298431873322,
            -0.880545973777771,
            -1.5708081722259521,
            -2.2235634326934814,
            0.08665890991687775,
            -3.521740674972534,
            0.7210667729377747,
            -0.7690484523773193,
            -0.36867034435272217,
            -2.093644857406616,
            1.0891427993774414,
            0.9959589838981628,
            2.852325916290283,
            -0.2615118622779846,
            -1.0923060178756714,
            0.36649706959724426,
            3.1346330642700195,
            -1.7536202669143677,
            1.758549451828003,
            -6.64768648147583,
            3.8257765769958496,
            2.170734405517578,
            0.3700358271598816,
            0.9524479508399963,
            1.014894723892212,
            -1.6206848621368408,
            3.6550114154815674,
            3.9588747024536133,
            -4.118992805480957,
            2.894559621810913,
            -0.4000595211982727,
            1.1462457180023193,
            1.2719348669052124,
            -3.6292788982391357,
            2.748847484588623,
            -3.6992053985595703,
            1.8798882961273193,
            1.6480783224105835,
            -3.5699775218963623,
            -4.7973952293396,
            2.080739974975586,
            -0.6066515445709229,
            -1.1688967943191528,
            1.6289876699447632,
            -0.12775000929832458,
            4.830706596374512,
            1.0397670269012451,
            0.9280864000320435,
            -4.246463298797607,
            1.9681334495544434,
            4.957273483276367,
            -1.4091130495071411,
            2.3439862728118896,
            -1.3151097297668457,
            -4.088391304016113,
            1.0692414045333862,
            0.20762774348258972,
            -1.8027268648147583,
            3.0011050701141357,
            0.350747674703598,
            2.054338216781616,
            2.136920928955078,
            0.9589411616325378,
            -1.0239782333374023,
            -4.374651908874512,
            -0.05197611451148987,
            -5.226284980773926,
            0.12105751037597656,
            0.44980475306510925,
            -1.9730989933013916,
            6.440817832946777,
            -1.7143687009811401,
            1.8746364116668701,
            -1.0721259117126465,
            -1.4461987018585205,
            4.760420322418213,
            -2.62532377243042,
            6.771522521972656,
            -3.208007335662842,
            -2.1396443843841553,
            1.7404249906539917,
            1.9847900867462158,
            0.6304838061332703,
            -0.2580846846103668,
            3.032938241958618,
            3.6699910163879395,
            -4.506735801696777,
            -5.494874954223633,
            -4.310285568237305,
            -3.4491560459136963,
            -2.9458751678466797,
            5.266109466552734,
            0.6802568435668945,
            3.3087821006774902,
            -2.922060251235962,
            -0.66968834400177,
            -0.0757983922958374,
            -2.1336607933044434,
            -5.698525428771973,
            -3.3801534175872803,
            -1.3085126876831055,
            4.313230514526367,
            -1.0839192867279053,
            -0.2227577120065689,
            -0.9699660539627075,
            -3.3441176414489746,
            1.3743059635162354,
            -0.11460146307945251,
            1.0168408155441284,
            3.116063117980957,
            6.564786911010742,
            0.3503618836402893,
            -0.4420638084411621,
            -2.0357065200805664,
            -4.050882816314697,
            1.0028568506240845,
            3.543241500854492,
            -1.475987195968628,
            1.8513823747634888,
            -0.8865430355072021,
            2.9512791633605957,
            3.9914326667785645,
            -2.119117021560669,
            -2.924405097961426,
            -1.6645841598510742,
            -0.5561206936836243,
            -1.048505425453186,
            1.920734167098999,
            4.511951446533203,
            -2.485933303833008,
            2.883547306060791,
            1.5664758682250977,
            -2.4271771907806396,
            -2.4899022579193115,
            9.340728759765625,
            -1.4007269144058228,
            0.06287723779678345,
            -0.23516279458999634,
            -2.209998846054077,
            -1.4406620264053345,
            -0.8920795917510986,
            -1.4352965354919434,
            1.127289056777954,
            1.5024354457855225,
            -2.2088053226470947,
            -0.7669395208358765,
            -3.174710750579834
        ]
    },
    "authors": [
        {
            "authorId": "2315949558",
            "name": "Xu Wang"
        },
        {
            "authorId": "2316050568",
            "name": "Jiangxia Cao"
        },
        {
            "authorId": "2316020541",
            "name": "Zhiyi Fu"
        },
        {
            "authorId": "2315924675",
            "name": "Kun Gai"
        },
        {
            "authorId": "2315935391",
            "name": "Guorui Zhou"
        }
    ],
    "references": []
}