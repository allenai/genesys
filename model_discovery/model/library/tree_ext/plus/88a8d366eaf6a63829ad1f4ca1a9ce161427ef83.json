{
    "paperId": "88a8d366eaf6a63829ad1f4ca1a9ce161427ef83",
    "externalIds": {
        "ArXiv": "2409.00142",
        "CorpusId": 272367799
    },
    "title": "Dynamic Depth Decoding: Faster Speculative Decoding for LLMs",
    "abstract": "The acceleration of Large Language Models (LLMs) with speculative decoding provides a significant runtime improvement without any loss of accuracy. Currently, EAGLE-2 is the state-of-the-art speculative decoding method, improving on EAGLE with a dynamic draft tree. We introduce Dynamic Depth Decoding (DDD), which optimises EAGLE-2's tree drafting method using a dynamic depth. This extends the average speedup that EAGLE-2 achieves over EAGLE by $44\\%$, giving DDD an average speedup of $3.16$x.",
    "venue": "",
    "year": 2024,
    "referenceCount": 9,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "Dynamic Depth Decoding (DDD) is introduced, which optimises EAGLE-2's tree drafting method using a dynamic depth, extending the average speedup that EAGLE-2 achieves over EAGLE by $44\\% and giving DDD an average speedup of $3.16$x."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -3.143625497817993,
            2.968191623687744,
            -1.2740472555160522,
            1.9948327541351318,
            4.172114849090576,
            4.144753456115723,
            1.4049352407455444,
            0.5671602487564087,
            0.08305448293685913,
            -1.4024804830551147,
            -0.46527907252311707,
            2.533129930496216,
            7.780466079711914,
            -0.4260026514530182,
            -2.8868918418884277,
            1.0461969375610352,
            -1.9538434743881226,
            -4.432342529296875,
            7.871128082275391,
            3.864039659500122,
            -1.9477179050445557,
            0.9166187644004822,
            -2.75716495513916,
            2.255716323852539,
            0.22855675220489502,
            2.517343282699585,
            2.006226062774658,
            2.3985166549682617,
            -2.783172845840454,
            0.37507885694503784,
            -1.1220505237579346,
            -1.5819921493530273,
            3.605461835861206,
            -4.132885932922363,
            4.325798034667969,
            -1.0672110319137573,
            -0.7858748435974121,
            3.5767645835876465,
            -2.21472430229187,
            -2.9629931449890137,
            -3.356544256210327,
            0.10679352283477783,
            -1.9419164657592773,
            -2.1270763874053955,
            1.3566341400146484,
            -0.8061972856521606,
            -0.014465615153312683,
            0.060060858726501465,
            -1.8170253038406372,
            0.47074103355407715,
            2.539351463317871,
            0.503319263458252,
            0.22165077924728394,
            1.5892527103424072,
            -2.340907096862793,
            1.270625352859497,
            0.7591654062271118,
            -2.885974407196045,
            5.242059707641602,
            -1.9620553255081177,
            5.034951210021973,
            3.2309513092041016,
            -0.7148835062980652,
            0.17669087648391724,
            1.8277308940887451,
            -1.3614752292633057,
            -0.6581684350967407,
            5.971918106079102,
            2.150404930114746,
            1.8095234632492065,
            -1.1732829809188843,
            -1.7051339149475098,
            4.412613391876221,
            -3.39098858833313,
            -1.9427862167358398,
            -0.07027007639408112,
            -2.9729068279266357,
            -1.4930773973464966,
            2.00407075881958,
            -4.496809005737305,
            -1.5373942852020264,
            -0.18161669373512268,
            -1.0382461547851562,
            2.1068849563598633,
            3.9673004150390625,
            -2.4784586429595947,
            -2.1302313804626465,
            -0.6445116996765137,
            4.441228866577148,
            1.6525644063949585,
            2.5327582359313965,
            1.258453130722046,
            -2.5784411430358887,
            4.01303243637085,
            -3.120681047439575,
            -1.2474342584609985,
            -0.9952526092529297,
            -1.6620421409606934,
            1.7291669845581055,
            0.1789061427116394,
            3.7355871200561523,
            1.6474180221557617,
            -0.6073336601257324,
            -1.709370493888855,
            4.287220001220703,
            -1.897078275680542,
            0.43177685141563416,
            3.9879794120788574,
            -0.45773667097091675,
            -2.2449374198913574,
            -2.082287549972534,
            -0.39138472080230713,
            -1.4923205375671387,
            -1.9761278629302979,
            -2.9453043937683105,
            -4.828826904296875,
            1.460946798324585,
            -1.7636988162994385,
            -4.5652289390563965,
            1.8637502193450928,
            -0.2971767485141754,
            -3.270333766937256,
            2.151348829269409,
            -1.3559964895248413,
            1.5112946033477783,
            0.19721825420856476,
            -2.2155215740203857,
            -3.4602341651916504,
            -2.2258870601654053,
            -0.6735444664955139,
            0.9546185731887817,
            -0.7159056067466736,
            1.0558278560638428,
            2.1886990070343018,
            -2.286259651184082,
            2.011934280395508,
            -4.961678504943848,
            1.2275642156600952,
            -2.522679090499878,
            0.4830430746078491,
            2.2946975231170654,
            5.717179775238037,
            -1.9359772205352783,
            2.447159767150879,
            -1.6721986532211304,
            0.5562053918838501,
            0.8708163499832153,
            -1.227689266204834,
            -1.8483127355575562,
            5.10990571975708,
            3.6696901321411133,
            -0.9143845438957214,
            3.34024715423584,
            -0.060319796204566956,
            -0.9615594744682312,
            3.6086483001708984,
            -4.449901580810547,
            0.6390711069107056,
            0.8174170851707458,
            -0.13241666555404663,
            -1.0055177211761475,
            2.247530937194824,
            -5.8882598876953125,
            -4.436215400695801,
            1.4416353702545166,
            -2.0130348205566406,
            -2.587031602859497,
            -0.6004786491394043,
            -0.04900234937667847,
            3.02339768409729,
            -1.6661781072616577,
            -0.20573380589485168,
            -0.6124173402786255,
            3.4209489822387695,
            6.514690399169922,
            1.3466331958770752,
            0.9731260538101196,
            -2.5655250549316406,
            -4.212149620056152,
            1.1611658334732056,
            3.865920305252075,
            3.2983410358428955,
            -6.948652267456055,
            2.6368534564971924,
            -6.363927841186523,
            -3.739595890045166,
            -4.195621490478516,
            -0.4253591001033783,
            0.020573794841766357,
            3.021829605102539,
            1.4651234149932861,
            0.30929437279701233,
            3.831993579864502,
            4.647744178771973,
            0.1905977874994278,
            -5.693878173828125,
            3.8525030612945557,
            5.682705879211426,
            -2.8193254470825195,
            -3.895857095718384,
            0.8400719165802002,
            -0.6633288860321045,
            -0.8801336884498596,
            -1.242326259613037,
            1.1909961700439453,
            2.361278772354126,
            -1.142524242401123,
            1.876201868057251,
            -2.6887683868408203,
            -1.9807515144348145,
            2.263469696044922,
            3.201093912124634,
            -3.2517545223236084,
            -4.312437534332275,
            -0.9620673656463623,
            -5.75377893447876,
            -7.724409580230713,
            2.6740221977233887,
            2.8633522987365723,
            -0.8469502329826355,
            -1.159759759902954,
            1.3480589389801025,
            -0.34902605414390564,
            -3.673214912414551,
            0.5258734822273254,
            1.6878652572631836,
            1.359760046005249,
            -2.153630018234253,
            0.36912721395492554,
            2.9455461502075195,
            -2.0735621452331543,
            -4.666258335113525,
            -1.8295270204544067,
            -1.7730815410614014,
            -0.25257235765457153,
            1.9060180187225342,
            -2.5037949085235596,
            0.8525290489196777,
            -0.28711602091789246,
            -0.7313540577888489,
            3.4833855628967285,
            -0.33859992027282715,
            -3.255821466445923,
            6.475954532623291,
            0.9415611028671265,
            0.7395646572113037,
            -4.404963970184326,
            -0.48872607946395874,
            0.565021812915802,
            -1.9298802614212036,
            -0.7633683085441589,
            -1.3194786310195923,
            2.6519360542297363,
            -1.5414800643920898,
            3.3655872344970703,
            2.167860507965088,
            -1.5497593879699707,
            -2.9174447059631348,
            2.1700406074523926,
            1.855000615119934,
            -1.0604968070983887,
            3.2289817333221436,
            3.658400058746338,
            2.4274168014526367,
            0.38994696736335754,
            -1.8114440441131592,
            -6.121037006378174,
            -0.3715774118900299,
            -1.80696702003479,
            3.1675968170166016,
            2.2276809215545654,
            -0.7715637683868408,
            -1.9238182306289673,
            -4.970502853393555,
            0.9048928618431091,
            -6.160824775695801,
            0.08343127369880676,
            -0.9374669790267944,
            0.14037415385246277,
            3.9020392894744873,
            3.0925283432006836,
            -5.3494672775268555,
            -0.6925260424613953,
            0.4569838047027588,
            -4.308022499084473,
            -2.106572151184082,
            3.336092948913574,
            -0.05986061692237854,
            -3.4006009101867676,
            -0.7839889526367188,
            -3.869107723236084,
            2.9897146224975586,
            -3.9032015800476074,
            -4.259512901306152,
            -3.96867299079895,
            0.7565611600875854,
            6.312790870666504,
            -1.2140806913375854,
            -3.3544445037841797,
            -1.5781774520874023,
            -1.4018590450286865,
            2.2729885578155518,
            0.967110276222229,
            3.6411070823669434,
            -0.7650842070579529,
            1.481215476989746,
            0.20627696812152863,
            -5.755878448486328,
            -1.79221773147583,
            -0.8783600926399231,
            -2.6058349609375,
            -1.1622127294540405,
            3.2488656044006348,
            0.7816834449768066,
            -0.8151156902313232,
            0.22188997268676758,
            4.34075403213501,
            2.0779659748077393,
            -1.3404128551483154,
            3.2725653648376465,
            -1.9814172983169556,
            2.767012596130371,
            -7.005013465881348,
            0.297478586435318,
            -3.8171205520629883,
            -1.9437603950500488,
            3.4510273933410645,
            -0.4560689628124237,
            -2.512631416320801,
            0.9763224124908447,
            0.30364951491355896,
            0.3315920829772949,
            0.9021816253662109,
            2.424206256866455,
            -4.906269073486328,
            -2.489638328552246,
            -3.7469542026519775,
            -1.8386560678482056,
            0.16772857308387756,
            -2.639908790588379,
            0.07163654267787933,
            6.746617794036865,
            0.42409971356391907,
            1.611283540725708,
            -3.0146007537841797,
            -1.554140567779541,
            0.14963209629058838,
            2.4840590953826904,
            1.3644051551818848,
            -0.30130118131637573,
            1.655739665031433,
            -2.4026403427124023,
            4.210640907287598,
            1.4802464246749878,
            -1.075465440750122,
            5.2585906982421875,
            1.0704411268234253,
            -4.234495162963867,
            3.2854738235473633,
            2.1372599601745605,
            -0.23686444759368896,
            2.156614065170288,
            1.3827762603759766,
            -1.6012954711914062,
            3.58492374420166,
            -4.263238906860352,
            8.436243057250977,
            -1.2740737199783325,
            3.524190902709961,
            -1.8879826068878174,
            -1.4100022315979004,
            -3.4735422134399414,
            -2.4449520111083984,
            0.11484886705875397,
            -0.27148252725601196,
            -3.0049633979797363,
            -0.33277344703674316,
            -1.5505828857421875,
            -1.0688227415084839,
            0.960434079170227,
            3.4093821048736572,
            0.12138339877128601,
            -0.7762004137039185,
            4.684494495391846,
            -0.364704966545105,
            -0.1547212302684784,
            2.330349922180176,
            3.188802480697632,
            -0.8287625312805176,
            -0.5423650741577148,
            -1.768743872642517,
            1.6799516677856445,
            1.489123821258545,
            3.8362693786621094,
            -1.0089972019195557,
            -0.070105642080307,
            -1.1576733589172363,
            -0.6750127673149109,
            -0.013818085193634033,
            2.7538132667541504,
            -0.30967026948928833,
            -3.265676975250244,
            3.986583709716797,
            2.9494566917419434,
            -0.0005185604095458984,
            1.8597595691680908,
            4.7919816970825195,
            -1.2643688917160034,
            0.26276999711990356,
            -1.551076889038086,
            -4.293867111206055,
            1.2171415090560913,
            -3.6309566497802734,
            -3.45503568649292,
            -1.1715102195739746,
            -4.0069193840026855,
            3.346611976623535,
            1.8182860612869263,
            1.7416133880615234,
            0.3850547969341278,
            3.9451208114624023,
            1.832660436630249,
            8.930952072143555,
            2.9880354404449463,
            -2.294010639190674,
            0.14246061444282532,
            1.318715214729309,
            0.1801827847957611,
            -1.3361361026763916,
            1.4167747497558594,
            -4.111038684844971,
            0.15487277507781982,
            -4.086794376373291,
            -0.4298790395259857,
            -0.8056687116622925,
            4.97456169128418,
            0.46079230308532715,
            0.7279216051101685,
            -0.736676812171936,
            -1.1440658569335938,
            0.7822043895721436,
            4.257368564605713,
            0.6827694177627563,
            1.0232640504837036,
            1.0380669832229614,
            3.258354663848877,
            0.19970977306365967,
            -1.6132229566574097,
            -4.153169631958008,
            -1.4819855690002441,
            0.6233680248260498,
            -6.0620951652526855,
            0.5782034397125244,
            -0.47430914640426636,
            0.6147508025169373,
            3.838711738586426,
            -1.032081961631775,
            1.1966427564620972,
            -0.10637575387954712,
            0.5773138999938965,
            0.2115023136138916,
            5.104301452636719,
            -0.09921054542064667,
            1.7214555740356445,
            0.65720534324646,
            5.0489349365234375,
            -1.1345274448394775,
            -4.22080135345459,
            0.03900033235549927,
            0.9759283065795898,
            1.2627044916152954,
            -2.9849653244018555,
            2.0237653255462646,
            2.6468310356140137,
            -0.21516364812850952,
            1.180680274963379,
            3.1200737953186035,
            2.057922601699829,
            -1.4189155101776123,
            -4.291651248931885,
            -2.0678048133850098,
            -0.4566013813018799,
            2.9648702144622803,
            -0.057425856590270996,
            -2.0307419300079346,
            5.668576717376709,
            2.957122802734375,
            0.08534243702888489,
            0.2824113965034485,
            1.5857973098754883,
            -1.4315292835235596,
            -2.258143186569214,
            1.8875389099121094,
            -1.6688668727874756,
            2.8292198181152344,
            2.852921724319458,
            -2.931137800216675,
            -1.6782090663909912,
            0.34359896183013916,
            1.3122416734695435,
            -2.4844772815704346,
            -3.2976737022399902,
            -0.6634412407875061,
            -3.807614326477051,
            -1.8836086988449097,
            3.053772449493408,
            2.2657225131988525,
            0.6307790279388428,
            1.669926643371582,
            2.1981847286224365,
            3.4659767150878906,
            1.314420461654663,
            -1.5084363222122192,
            1.3223638534545898,
            3.3432445526123047,
            -1.6619747877120972,
            2.60243821144104,
            0.03730607032775879,
            -0.9188812971115112,
            -2.18534517288208,
            -2.556602954864502,
            -0.2418184131383896,
            -1.1897975206375122,
            1.16891348361969,
            2.055088758468628,
            0.6765857338905334,
            1.4736764430999756,
            4.919628143310547,
            0.966694712638855,
            2.6783342361450195,
            6.340699195861816,
            3.00826358795166,
            1.2664213180541992,
            -0.1557140350341797,
            -0.3687707483768463,
            1.7431249618530273,
            4.087382793426514,
            2.4314959049224854,
            -0.8729450106620789,
            -3.24808931350708,
            -3.5541141033172607,
            -1.272810459136963,
            3.6502866744995117,
            -0.07803826779127121,
            -1.7900710105895996,
            3.8957111835479736,
            -0.4694220721721649,
            -3.1713595390319824,
            1.039622187614441,
            1.3749244213104248,
            3.081678867340088,
            0.6265519857406616,
            2.078467607498169,
            -1.1240108013153076,
            0.1363469660282135,
            -4.906718730926514,
            1.4185729026794434,
            -2.0401172637939453,
            -2.6687417030334473,
            8.002102851867676,
            2.376234292984009,
            -0.8197363018989563,
            -0.7445858716964722,
            2.6906955242156982,
            -1.950494647026062,
            0.7591762542724609,
            -5.587316989898682,
            -0.45263057947158813,
            3.2686853408813477,
            0.4226478636264801,
            0.14652198553085327,
            0.266021728515625,
            2.063311815261841,
            -1.2688645124435425,
            1.50871741771698,
            3.195218086242676,
            -1.6007646322250366,
            3.0759787559509277,
            2.3609201908111572,
            -3.5039830207824707,
            -0.3743484616279602,
            -3.8221263885498047,
            -0.9553900957107544,
            -6.631849765777588,
            -0.33973079919815063,
            -1.5828909873962402,
            -3.3122739791870117,
            2.609388828277588,
            -2.6648988723754883,
            -1.4310665130615234,
            -2.074627161026001,
            -2.384458303451538,
            -4.181151866912842,
            -2.3447766304016113,
            1.346037745475769,
            -3.0807576179504395,
            3.9936890602111816,
            -0.9127447009086609,
            -0.22820895910263062,
            1.144205093383789,
            -2.256892204284668,
            3.357015371322632,
            1.6350207328796387,
            3.4486289024353027,
            -0.8570576906204224,
            0.35477086901664734,
            1.157900094985962,
            1.1020188331604004,
            2.0906968116760254,
            -2.2881855964660645,
            -2.9939990043640137,
            2.8913912773132324,
            9.246502876281738,
            -0.4407402276992798,
            -2.3522613048553467,
            2.248582124710083,
            -0.8077719807624817,
            -0.16478997468948364,
            -0.4811412990093231,
            1.8405132293701172,
            1.4106502532958984,
            1.9675824642181396,
            -0.1107020378112793,
            1.2103784084320068,
            -1.1849905252456665,
            3.6412503719329834,
            -4.098564147949219,
            -0.7357895374298096,
            -1.9511661529541016,
            3.3576581478118896,
            -1.4574321508407593,
            2.441389560699463,
            0.40942156314849854,
            -0.25605738162994385,
            -0.6987053155899048,
            -1.349168062210083,
            -3.388761520385742,
            3.4505157470703125,
            2.3745288848876953,
            2.5120491981506348,
            0.886850118637085,
            0.7202305793762207,
            2.4134178161621094,
            -0.48431119322776794,
            0.5870777368545532,
            1.8793593645095825,
            -2.0307867527008057,
            2.2531418800354004,
            0.7451561689376831,
            1.9502851963043213,
            0.28938549757003784,
            4.0761518478393555,
            -0.7417394518852234,
            -1.6866347789764404,
            -3.334023952484131,
            -0.09269002079963684,
            -6.6934309005737305,
            0.05221140384674072,
            1.0702790021896362,
            -0.35121238231658936,
            -2.3484182357788086,
            2.785985231399536,
            -1.3555885553359985,
            -2.5073790550231934,
            -5.760389804840088,
            -0.8955650925636292,
            1.26625657081604,
            5.611557483673096,
            -0.5733124017715454,
            0.2167539894580841,
            1.2861250638961792,
            -4.3614654541015625,
            3.460874080657959,
            0.23837852478027344,
            -1.035577416419983,
            -1.2144759893417358,
            -3.6754629611968994,
            -0.5980612635612488,
            -2.0407276153564453,
            2.3616418838500977,
            0.8798723816871643,
            -3.8020310401916504,
            3.665144920349121,
            -0.8759861588478088,
            -1.5515344142913818,
            -0.14290553331375122,
            -0.5586026906967163,
            0.2987314760684967,
            1.3561384677886963,
            -3.1136105060577393,
            -0.03243282437324524,
            2.794818162918091,
            -1.3629493713378906,
            0.1783028542995453,
            0.21994134783744812,
            -0.06293898820877075,
            1.0985183715820312,
            -1.8970832824707031,
            4.659280776977539,
            3.9208145141601562,
            -1.3760435581207275,
            1.899229884147644,
            -2.076418161392212,
            -1.6683838367462158,
            2.5189058780670166,
            2.521237373352051,
            3.010991096496582,
            -2.1348674297332764,
            -3.279223918914795,
            -2.6040053367614746,
            -1.4800114631652832,
            0.6778756380081177,
            3.1966469287872314,
            7.350449562072754,
            -1.332642912864685,
            2.1703226566314697,
            0.8759998679161072,
            0.5298658609390259,
            -2.0710089206695557,
            -2.6091346740722656,
            -4.284121990203857,
            -1.5121620893478394,
            0.72926265001297,
            -9.02405834197998,
            -1.424332618713379,
            -0.7599563598632812,
            1.699034333229065,
            -1.7820091247558594,
            1.2675000429153442,
            1.6478416919708252,
            1.4361580610275269,
            -0.4767616391181946,
            0.02887783944606781,
            -1.3931052684783936,
            -2.7942824363708496,
            -2.2561275959014893,
            -0.9799089431762695,
            -1.1588897705078125,
            -0.38631585240364075,
            -0.07610230147838593,
            -4.1103925704956055,
            -0.34985455870628357,
            1.8380367755889893,
            -3.733530044555664,
            -0.9961147308349609,
            0.6964603662490845,
            -0.9787155389785767,
            -4.979010105133057,
            -1.4154363870620728,
            -2.226858615875244,
            -4.084725379943848,
            0.9381856918334961,
            6.59836483001709,
            -3.4130144119262695,
            3.761195659637451,
            9.60019302368164,
            -0.3413975238800049,
            -1.9915132522583008,
            -1.904990315437317,
            -2.4413270950317383,
            1.452877402305603,
            2.956496238708496,
            2.71484375,
            -5.18900728225708,
            2.9882965087890625,
            4.509471893310547,
            2.6212306022644043,
            -4.090475082397461
        ]
    },
    "authors": [
        {
            "authorId": "2243015832",
            "name": "Oscar Brown"
        },
        {
            "authorId": "2243913447",
            "name": "Zhengjie Wang"
        },
        {
            "authorId": "2242913697",
            "name": "Andrea Do"
        },
        {
            "authorId": "2243229156",
            "name": "Nikhil Mathew"
        },
        {
            "authorId": "2243375310",
            "name": "Cheng Yu"
        }
    ],
    "references": [
        {
            "paperId": "ace3d2bcecc658a97632c9be4ce461450271eb5b",
            "title": "Parallel Speculative Decoding with Adaptive Draft Length"
        },
        {
            "paperId": "cab58a0263d454604896dce6b8fbf4df1dd99ff0",
            "title": "EAGLE-2: Faster Inference of Language Models with Dynamic Draft Trees"
        },
        {
            "paperId": "b37240bb0be13ff6a5179cae4324dca74aba018f",
            "title": "Optimizing Speculative Decoding for Serving Large Language Models Using Goodput"
        },
        {
            "paperId": "050d66cab131c8e10c230df9469d897622ccf7d2",
            "title": "SpecDec++: Boosting Speculative Decoding via Adaptive Candidate Lengths"
        },
        {
            "paperId": "1b5db3170c195508ff24fee8eda0d4987e806f0b",
            "title": "EAGLE: Speculative Sampling Requires Rethinking Feature Uncertainty"
        },
        {
            "paperId": "d8e9f8c8a37cb4cd26b92ad0d942d641cd512644",
            "title": "Fast Inference from Transformers via Speculative Decoding"
        },
        {
            "paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0",
            "title": "Language Models are Few-Shot Learners"
        },
        {
            "paperId": null,
            "title": "2024. Dynamic speculation looka-head accelerates speculative decoding of large language models"
        },
        {
            "paperId": null,
            "title": "speedup over a constant beam width method such EAGLE-2, which uses beam width 10. Runtime per target model call for EAGLE-2 with depth 6 and Temperature=0 on MT-bench"
        }
    ]
}