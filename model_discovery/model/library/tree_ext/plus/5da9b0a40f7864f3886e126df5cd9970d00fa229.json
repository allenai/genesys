{
    "paperId": "5da9b0a40f7864f3886e126df5cd9970d00fa229",
    "externalIds": {
        "ArXiv": "2407.15545",
        "DBLP": "journals/corr/abs-2407-15545",
        "DOI": "10.48550/arXiv.2407.15545",
        "CorpusId": 271328498
    },
    "title": "Inverted Activations",
    "abstract": "The scaling of neural networks with increasing data and model sizes necessitates more efficient deep learning algorithms. This paper addresses the memory footprint challenge in neural network training by proposing a modification to the handling of activation tensors in pointwise nonlinearity layers. Traditionally, these layers save the entire input tensor for the backward pass, leading to substantial memory use. Our method involves saving the output tensor instead, reducing the memory required when the subsequent layer also saves its input tensor. This approach is particularly beneficial for transformer-based architectures like GPT, BERT, Mistral, and Llama. Application of our method involves taken an inverse function of nonlinearity. To the best of our knowledge, that can not be done analitically and instead we buid an accurate approximations using simpler functions. Experimental results confirm that our method significantly reduces memory usage without affecting training accuracy. The implementation is available at https://github.com/PgLoLo/optiacts.",
    "venue": "arXiv.org",
    "year": 2024,
    "referenceCount": 4,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This paper addresses the memory footprint challenge in neural network training by proposing a modification to the handling of activation tensors in pointwise nonlinearity layers, reducing the memory required when the subsequent layer also saves its input tensor."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -2.9142818450927734,
            -1.5337646007537842,
            0.7438423037528992,
            3.0624873638153076,
            0.1290069818496704,
            0.38037651777267456,
            1.5829343795776367,
            -3.357895851135254,
            -0.18854117393493652,
            2.1520402431488037,
            0.3694237470626831,
            4.1927900314331055,
            3.202028751373291,
            0.23671329021453857,
            -6.562811851501465,
            -0.927606463432312,
            -4.003711700439453,
            2.965202808380127,
            3.967872142791748,
            1.9978830814361572,
            0.13905924558639526,
            0.9578328132629395,
            -1.1266688108444214,
            2.497406482696533,
            -4.383903980255127,
            2.612692356109619,
            0.8321120738983154,
            -0.26775938272476196,
            -2.9649977684020996,
            0.8813238143920898,
            1.9028517007827759,
            -7.4371490478515625,
            5.405317783355713,
            -1.1922988891601562,
            5.267182350158691,
            1.4113171100616455,
            -0.25548458099365234,
            5.276259899139404,
            -6.015654563903809,
            -1.9538615942001343,
            3.3565330505371094,
            -0.9000280499458313,
            2.0373520851135254,
            4.8024678230285645,
            -1.4297784566879272,
            1.4146058559417725,
            -0.22454530000686646,
            0.2516304850578308,
            0.32321697473526,
            1.889866828918457,
            3.513659954071045,
            -1.9510297775268555,
            0.9118289947509766,
            -1.123396635055542,
            0.4745439887046814,
            0.8058850169181824,
            -0.07194039225578308,
            1.793473482131958,
            1.5579044818878174,
            -0.6933689713478088,
            3.476099967956543,
            3.7140157222747803,
            -4.0640974044799805,
            0.28932252526283264,
            -1.9465396404266357,
            -3.181121349334717,
            -0.8218291401863098,
            4.21309757232666,
            -0.530709981918335,
            1.128062129020691,
            -3.111316204071045,
            -4.436882495880127,
            -0.7480783462524414,
            -0.7228692770004272,
            -3.1035614013671875,
            0.7507994174957275,
            0.8372713327407837,
            -6.91485595703125,
            0.054049476981163025,
            -0.18426744639873505,
            -3.0981321334838867,
            5.90201473236084,
            -1.4876818656921387,
            5.49931001663208,
            2.821640968322754,
            -2.1540167331695557,
            -0.07585413753986359,
            -3.2231433391571045,
            -0.8477634191513062,
            -3.368777275085449,
            0.147541344165802,
            -1.7618637084960938,
            2.172572135925293,
            2.476149082183838,
            -6.086887836456299,
            -0.7169091701507568,
            -0.07794103026390076,
            -0.023375749588012695,
            -2.9453957080841064,
            0.795486569404602,
            4.294027328491211,
            -2.035933494567871,
            3.266202449798584,
            -0.16455191373825073,
            4.453764915466309,
            -4.138151168823242,
            0.4785143733024597,
            2.057231903076172,
            -1.9740655422210693,
            -3.2465147972106934,
            -3.9786903858184814,
            2.817220449447632,
            -1.6169047355651855,
            1.4047460556030273,
            -3.4058492183685303,
            -1.7002596855163574,
            0.12386763095855713,
            -0.3344005346298218,
            -2.213998556137085,
            4.43048095703125,
            -0.12195645272731781,
            -0.554831326007843,
            -3.9474937915802,
            -0.5404026508331299,
            -0.8301141858100891,
            0.7138852477073669,
            -0.015072047710418701,
            3.1389198303222656,
            -1.4237027168273926,
            -3.651064872741699,
            0.23536483943462372,
            -5.5243425369262695,
            2.6930041313171387,
            1.0986641645431519,
            2.426302909851074,
            0.2671996057033539,
            -1.0487709045410156,
            1.834802508354187,
            -4.538650035858154,
            -0.9366545677185059,
            3.7634336948394775,
            3.2072856426239014,
            1.5518622398376465,
            0.4176170527935028,
            2.6838345527648926,
            4.63700532913208,
            -0.07665106654167175,
            3.7790355682373047,
            2.542564868927002,
            4.838881492614746,
            0.8052645325660706,
            -3.5703134536743164,
            0.8883020877838135,
            3.4702491760253906,
            2.3795976638793945,
            4.372560024261475,
            -4.990553855895996,
            -2.3762612342834473,
            -0.42156651616096497,
            1.7014766931533813,
            -0.41615909337997437,
            -3.0253682136535645,
            -8.162342071533203,
            -0.783778190612793,
            3.8708128929138184,
            -3.1776299476623535,
            -2.0254204273223877,
            0.4356985092163086,
            0.7690180540084839,
            0.3735213577747345,
            0.5007691383361816,
            1.1411831378936768,
            1.5123698711395264,
            5.35385799407959,
            5.252655506134033,
            2.874361038208008,
            3.4051551818847656,
            -0.9306222200393677,
            -2.7452688217163086,
            0.7256420850753784,
            -2.7382373809814453,
            -2.795717239379883,
            -6.340529918670654,
            -0.49058496952056885,
            -3.422163724899292,
            -2.0534982681274414,
            -3.243086338043213,
            -1.581671953201294,
            0.5350722074508667,
            0.16433900594711304,
            0.8183793425559998,
            -4.710744380950928,
            2.393747091293335,
            7.438474178314209,
            1.1093913316726685,
            2.3103864192962646,
            1.2628018856048584,
            -1.263542890548706,
            -5.847689628601074,
            1.2340799570083618,
            2.579421043395996,
            0.7303687930107117,
            0.42040419578552246,
            -0.3103475570678711,
            0.938833475112915,
            2.0585129261016846,
            -0.30989208817481995,
            3.3893442153930664,
            0.491300106048584,
            0.04813116788864136,
            -0.19750943779945374,
            -0.5467308163642883,
            -0.31041231751441956,
            4.247936725616455,
            -3.2410550117492676,
            -2.564615249633789,
            -1.6771329641342163,
            4.256972312927246,
            3.7231478691101074,
            1.4883407354354858,
            -1.2922756671905518,
            1.1935451030731201,
            -0.4467034339904785,
            -1.529152750968933,
            0.28779128193855286,
            -4.047731399536133,
            0.4671199321746826,
            1.9936985969543457,
            0.09108564257621765,
            1.5736634731292725,
            -0.10193145275115967,
            -7.889581680297852,
            1.324286699295044,
            0.016492724418640137,
            -4.973730087280273,
            0.7982918620109558,
            -0.006923973560333252,
            -0.4399075210094452,
            -1.6131702661514282,
            -3.3657755851745605,
            3.9056811332702637,
            -0.6319153308868408,
            3.7419097423553467,
            3.548213005065918,
            2.376741409301758,
            -2.7708239555358887,
            -3.3328866958618164,
            2.577230930328369,
            -0.41745811700820923,
            -1.0794059038162231,
            -1.035884141921997,
            -0.8859939575195312,
            2.166496515274048,
            0.9796111583709717,
            2.7996106147766113,
            0.552397608757019,
            4.049703598022461,
            1.9782692193984985,
            -0.203541100025177,
            -0.4336289167404175,
            -2.0900790691375732,
            5.877803802490234,
            1.0945829153060913,
            4.686051845550537,
            -3.2274060249328613,
            -2.6348447799682617,
            -1.4914225339889526,
            -0.26990562677383423,
            0.44985252618789673,
            3.076446533203125,
            -0.9512698650360107,
            1.406516432762146,
            -2.0235300064086914,
            -4.758500099182129,
            -1.1764296293258667,
            -3.356926441192627,
            -2.3918144702911377,
            -1.1404359340667725,
            2.5202689170837402,
            2.634566307067871,
            1.449360966682434,
            -2.617673873901367,
            -3.548025131225586,
            -2.815075635910034,
            -4.302047252655029,
            -4.171576023101807,
            -1.7592438459396362,
            0.3599085211753845,
            2.2946512699127197,
            -0.5979423522949219,
            -3.959272861480713,
            2.0230906009674072,
            -5.27410888671875,
            -4.376094818115234,
            -4.641497611999512,
            2.920532464981079,
            1.9096702337265015,
            1.08833909034729,
            -0.6267639398574829,
            0.6939020156860352,
            -1.9199868440628052,
            3.660949468612671,
            2.737708568572998,
            -1.189739465713501,
            0.6108140349388123,
            4.744279861450195,
            1.6682319641113281,
            -4.989940643310547,
            -0.13429179787635803,
            -4.005014419555664,
            -4.335332870483398,
            -3.4963512420654297,
            0.822066605091095,
            -1.4042052030563354,
            1.3189997673034668,
            -0.8915045261383057,
            2.3440613746643066,
            1.9494460821151733,
            -2.7020888328552246,
            4.168290138244629,
            0.20723974704742432,
            2.0959343910217285,
            -4.675145626068115,
            -2.4387354850769043,
            -2.523263454437256,
            -0.11693021655082703,
            5.5228424072265625,
            3.141707420349121,
            -2.4083707332611084,
            4.332149028778076,
            0.4516969323158264,
            2.5282883644104004,
            2.8904967308044434,
            5.307696342468262,
            0.1782381236553192,
            -4.488735675811768,
            -3.119558095932007,
            -0.235150545835495,
            -0.3133127689361572,
            5.7441487312316895,
            -0.897814154624939,
            6.777641296386719,
            -1.8608999252319336,
            1.8380966186523438,
            0.38587895035743713,
            -1.7333266735076904,
            3.4774155616760254,
            -0.8044195175170898,
            1.0637547969818115,
            -0.5526385307312012,
            -0.5519585609436035,
            1.2175488471984863,
            3.9539456367492676,
            -2.617304801940918,
            1.7140882015228271,
            5.031162261962891,
            2.973578929901123,
            2.7882180213928223,
            3.3260245323181152,
            -1.283238410949707,
            1.2081972360610962,
            -3.307147979736328,
            0.1375369429588318,
            -1.733128309249878,
            1.055420160293579,
            -2.1109466552734375,
            11.967975616455078,
            -2.5653152465820312,
            0.04047110676765442,
            -4.219390869140625,
            -0.19802135229110718,
            -1.6544480323791504,
            -1.773749589920044,
            3.2279210090637207,
            -2.4867162704467773,
            -0.8263586759567261,
            0.4556193947792053,
            -1.970605731010437,
            2.153810739517212,
            1.2928632497787476,
            1.8778492212295532,
            4.489668369293213,
            1.5880231857299805,
            2.7081096172332764,
            -2.2790298461914062,
            0.8151327967643738,
            -1.3970394134521484,
            2.1156468391418457,
            5.208092212677002,
            3.3720884323120117,
            -5.165306091308594,
            2.2120304107666016,
            0.9842655658721924,
            0.5406646132469177,
            -1.03212571144104,
            -3.723268747329712,
            -5.5976409912109375,
            -3.8218610286712646,
            -1.3687669038772583,
            1.897733449935913,
            -2.2941622734069824,
            1.3646113872528076,
            2.469925880432129,
            1.682118535041809,
            -5.725129127502441,
            -2.696061611175537,
            2.118921995162964,
            -1.1822278499603271,
            -1.5586800575256348,
            -1.608657956123352,
            -0.474781334400177,
            -1.677394151687622,
            -4.4538774490356445,
            -5.091480255126953,
            -0.9174431562423706,
            1.2856074571609497,
            -0.608725905418396,
            3.89422869682312,
            5.40132999420166,
            0.800897479057312,
            1.6830246448516846,
            3.2815046310424805,
            4.414215087890625,
            4.847991466522217,
            -1.10590398311615,
            3.862105369567871,
            0.7442034482955933,
            1.4175969362258911,
            -3.194744825363159,
            2.048276901245117,
            -1.2187151908874512,
            4.65421199798584,
            -1.2675726413726807,
            2.3336825370788574,
            -0.1677551120519638,
            1.8660874366760254,
            0.433773398399353,
            0.5052208304405212,
            2.8060226440429688,
            -1.549896240234375,
            -0.9509146213531494,
            1.3983112573623657,
            0.6188963651657104,
            5.1423749923706055,
            0.283105731010437,
            -0.35097503662109375,
            -0.17018264532089233,
            1.8186535835266113,
            -2.1356868743896484,
            -5.532200336456299,
            2.7527832984924316,
            -0.7453081011772156,
            -2.371061086654663,
            -0.24049130082130432,
            0.7804247140884399,
            -1.9425361156463623,
            -1.9865480661392212,
            -2.7107670307159424,
            2.9754080772399902,
            1.4604707956314087,
            -2.4543933868408203,
            4.867699146270752,
            -3.250459671020508,
            0.9304416179656982,
            -0.5694128274917603,
            4.234052658081055,
            -2.0261223316192627,
            0.288030743598938,
            -0.7827490568161011,
            -0.6679823398590088,
            1.50050687789917,
            -0.4523288607597351,
            -1.4988701343536377,
            -3.275850296020508,
            0.5965224504470825,
            -2.852895736694336,
            5.632930278778076,
            0.15255102515220642,
            0.1166248768568039,
            -5.967085838317871,
            -2.1753668785095215,
            -2.607933521270752,
            2.4498000144958496,
            -4.2897748947143555,
            -3.0966944694519043,
            2.741511344909668,
            5.427433013916016,
            0.8867449760437012,
            3.849090099334717,
            2.0296666622161865,
            0.3633890151977539,
            0.62737637758255,
            2.4799225330352783,
            2.113067865371704,
            3.616763114929199,
            -2.302288770675659,
            -5.431661605834961,
            0.5656296014785767,
            1.7307062149047852,
            -0.23549848794937134,
            0.6905572414398193,
            -1.3704153299331665,
            0.48302310705184937,
            0.283622145652771,
            -3.6077582836151123,
            3.976217031478882,
            2.5144619941711426,
            1.638706088066101,
            -1.8093891143798828,
            -2.045635938644409,
            -1.2326041460037231,
            0.22736889123916626,
            -5.570628643035889,
            2.9300074577331543,
            -0.46476227045059204,
            -0.0648285448551178,
            1.6634466648101807,
            -1.3409230709075928,
            0.7731722593307495,
            2.8110275268554688,
            -5.36637020111084,
            -2.9897685050964355,
            0.7651572823524475,
            1.1483123302459717,
            -0.42797982692718506,
            0.003954976797103882,
            -1.9091298580169678,
            1.3855972290039062,
            -0.48843812942504883,
            3.9251766204833984,
            3.195302724838257,
            4.072473526000977,
            0.3505288362503052,
            -4.942986011505127,
            -0.8844128847122192,
            -4.573062896728516,
            2.9328207969665527,
            2.1640467643737793,
            -6.072640419006348,
            -2.2653656005859375,
            0.08674532175064087,
            2.227457046508789,
            -1.9208396673202515,
            1.1389884948730469,
            -0.7017530798912048,
            3.0355520248413086,
            -1.5562278032302856,
            -1.3691142797470093,
            -2.5528361797332764,
            2.4381043910980225,
            -0.9921061992645264,
            0.2585033178329468,
            1.0967657566070557,
            -0.11527121067047119,
            -2.5308101177215576,
            -1.8719474077224731,
            -3.7994043827056885,
            -1.0958563089370728,
            1.5017485618591309,
            1.758129358291626,
            0.5448571443557739,
            -0.44202935695648193,
            1.6330809593200684,
            4.9136762619018555,
            -3.7037250995635986,
            -1.3139774799346924,
            -4.833293437957764,
            4.194628715515137,
            -0.3212438225746155,
            -6.898942947387695,
            -1.88209068775177,
            -2.5262351036071777,
            0.15154320001602173,
            -0.4062148332595825,
            1.943067193031311,
            1.9060041904449463,
            3.4449656009674072,
            3.518738031387329,
            -0.4183228313922882,
            1.480319857597351,
            -0.7052081823348999,
            -5.0824995040893555,
            -3.91247296333313,
            -2.218432903289795,
            0.5599768161773682,
            -4.613119125366211,
            -4.839549541473389,
            1.114209532737732,
            -6.701201438903809,
            -2.3937039375305176,
            2.029724597930908,
            -3.0342025756835938,
            0.20248866081237793,
            -5.891358852386475,
            -3.956874132156372,
            0.3103894889354706,
            -0.18450093269348145,
            1.2059993743896484,
            -0.9819960594177246,
            1.7182817459106445,
            0.39095187187194824,
            6.787217617034912,
            4.669167518615723,
            4.781893730163574,
            1.90662682056427,
            -3.9246249198913574,
            1.8763914108276367,
            1.3602471351623535,
            -1.6926045417785645,
            -2.1772711277008057,
            2.3072824478149414,
            1.2015923261642456,
            12.42426872253418,
            -0.6233085989952087,
            -0.31349632143974304,
            -5.155429840087891,
            -0.22521425783634186,
            -4.514263153076172,
            1.2290059328079224,
            1.3371098041534424,
            0.3312893509864807,
            3.97408390045166,
            1.7596960067749023,
            -4.560003280639648,
            3.1833505630493164,
            -0.2321380078792572,
            2.406870126724243,
            0.3186800479888916,
            -0.7539932727813721,
            1.9929566383361816,
            -1.4290263652801514,
            -1.2992054224014282,
            -1.14159095287323,
            1.7188259363174438,
            0.902918815612793,
            -1.3564249277114868,
            -1.129668116569519,
            4.036987781524658,
            1.975703239440918,
            0.028469912707805634,
            -6.754616737365723,
            1.4780030250549316,
            5.322105407714844,
            4.22160530090332,
            0.533133327960968,
            2.3978731632232666,
            -1.4272522926330566,
            2.99493408203125,
            5.736542701721191,
            1.961031436920166,
            3.9531490802764893,
            0.8932780027389526,
            -1.9924089908599854,
            1.3650124073028564,
            -3.5825419425964355,
            3.156836748123169,
            -0.8462497591972351,
            -0.0007455050945281982,
            0.3142881691455841,
            0.33815836906433105,
            -1.5930861234664917,
            5.144072532653809,
            1.2275892496109009,
            2.182257652282715,
            -1.9389292001724243,
            2.078885078430176,
            1.7773668766021729,
            1.7079148292541504,
            -2.698155403137207,
            2.751058340072632,
            0.2728031873703003,
            2.3348441123962402,
            -0.11756710708141327,
            -0.09908789396286011,
            0.1836221069097519,
            -4.983732223510742,
            0.22758331894874573,
            3.3864192962646484,
            -4.4127302169799805,
            3.8749637603759766,
            2.122994899749756,
            2.51833438873291,
            4.533300876617432,
            2.4596643447875977,
            -0.36788299679756165,
            -3.147268533706665,
            -2.450305461883545,
            -3.4308624267578125,
            0.7355411052703857,
            2.921706199645996,
            1.8356692790985107,
            8.454604148864746,
            -4.617753028869629,
            1.3738574981689453,
            -3.5954675674438477,
            0.09594708681106567,
            4.223764419555664,
            -1.855375051498413,
            4.531842231750488,
            1.3495781421661377,
            -0.24433283507823944,
            1.8378791809082031,
            2.2500951290130615,
            -3.975879669189453,
            2.9615235328674316,
            -2.0026302337646484,
            4.540859222412109,
            -3.577486991882324,
            -0.37974321842193604,
            -4.048834323883057,
            -4.846296787261963,
            -4.201295852661133,
            5.17159366607666,
            3.0661091804504395,
            2.517721652984619,
            -3.6507983207702637,
            2.8015918731689453,
            0.9112076759338379,
            -2.4506540298461914,
            -5.531660079956055,
            -5.854483604431152,
            -1.2717621326446533,
            4.109131813049316,
            -4.961386680603027,
            -0.6781255006790161,
            -1.6303730010986328,
            -0.4308664798736572,
            -3.8565726280212402,
            0.3496139645576477,
            0.5874652862548828,
            2.0906622409820557,
            3.90254807472229,
            1.9516324996948242,
            -2.38387393951416,
            -3.1888206005096436,
            -4.03215217590332,
            -2.337226390838623,
            2.0386807918548584,
            2.0598971843719482,
            -2.2628121376037598,
            -0.05329950153827667,
            -1.0016388893127441,
            -0.6007892489433289,
            -0.7519828081130981,
            -1.029483437538147,
            0.5874201059341431,
            -2.584461212158203,
            -2.1529464721679688,
            0.36854368448257446,
            -0.40027740597724915,
            -3.608494758605957,
            2.7511696815490723,
            3.427032232284546,
            -1.8262073993682861,
            -2.45095157623291,
            5.465073585510254,
            -1.5608786344528198,
            1.64117431640625,
            -0.996381938457489,
            -2.875627040863037,
            -0.20147141814231873,
            -0.7027975916862488,
            2.166811227798462,
            2.448913097381592,
            5.511357307434082,
            -0.3804745674133301,
            -3.176424264907837,
            0.12208157777786255
        ]
    },
    "authors": [
        {
            "authorId": "2122345733",
            "name": "Georgii Sergeevich Novikov"
        },
        {
            "authorId": "2257279038",
            "name": "Ivan Oseledets"
        }
    ],
    "references": [
        {
            "paperId": "3836ccb33191799e748e8e96f85a813eaf650ff8",
            "title": "Data Movement Is All You Need: A Case Study on Optimizing Transformers"
        },
        {
            "paperId": "b36a5bb1707bb9c70025294b3a310138aae8327a",
            "title": "Automatic differentiation in PyTorch"
        },
        {
            "paperId": "b587ee7c802a5bd222a69090f59285e0dfdb29f1",
            "title": "Sigmoid-Weighted Linear Units for Neural Network Function Approximation in Reinforcement Learning"
        },
        {
            "paperId": "4361e64f2d12d63476fdc88faf72a0f70d9a2ffb",
            "title": "Bridging Nonlinearities and Stochastic Regularizers with Gaussian Error Linear Units"
        }
    ]
}