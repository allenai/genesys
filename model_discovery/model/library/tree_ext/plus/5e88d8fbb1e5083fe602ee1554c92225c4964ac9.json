{
    "paperId": "5e88d8fbb1e5083fe602ee1554c92225c4964ac9",
    "externalIds": {
        "DBLP": "journals/corr/abs-2407-13399",
        "ArXiv": "2407.13399",
        "DOI": "10.48550/arXiv.2407.13399",
        "CorpusId": 271270840
    },
    "title": "Correcting the Mythos of KL-Regularization: Direct Alignment without Overoptimization via Chi-Squared Preference Optimization",
    "abstract": "Language model alignment methods, such as reinforcement learning from human feedback (RLHF), have led to impressive advances in language model capabilities, but existing techniques are limited by a widely observed phenomenon known as overoptimization, where the quality of the language model plateaus or degrades over the course of the alignment process. Overoptimization is often attributed to overfitting to an inaccurate reward model, and while it can be mitigated through online data collection, this is infeasible in many settings. This raises a fundamental question: Do existing offline alignment algorithms make the most of the data they have, or can their sample-efficiency be improved further? We address this question with a new algorithm for offline alignment, $\\chi^2$-Preference Optimization ($\\chi$PO). $\\chi$PO is a one-line change to Direct Preference Optimization (DPO; Rafailov et al., 2023), which only involves modifying the logarithmic link function in the DPO objective. Despite this minimal change, $\\chi$PO implicitly implements the principle of pessimism in the face of uncertainty via regularization with the $\\chi^2$-divergence -- which quantifies uncertainty more effectively than KL-regularization -- and provably alleviates overoptimization, achieving sample-complexity guarantees based on single-policy concentrability -- the gold standard in offline reinforcement learning. $\\chi$PO's simplicity and strong guarantees make it the first practical and general-purpose offline alignment algorithm that is provably robust to overoptimization.",
    "venue": "arXiv.org",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A new algorithm for offline alignment, $\\chi^2$-Preference Optimization ($\\chi$PO), which is a one-line change to Direct Preference Optimization (DPO), and is the first practical and general-purpose offline alignment algorithm that is provably robust to overoptimization."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.132998943328857,
            1.5261993408203125,
            -2.0589447021484375,
            4.3868937492370605,
            -1.704709529876709,
            0.7173465490341187,
            2.8116655349731445,
            -1.0869101285934448,
            -1.7467604875564575,
            -0.5773029923439026,
            -3.1968002319335938,
            1.2620725631713867,
            1.0780503749847412,
            -1.9872158765792847,
            -3.315000057220459,
            1.9983553886413574,
            0.3752264976501465,
            -2.0870909690856934,
            3.5306296348571777,
            2.592884063720703,
            -2.49603271484375,
            2.315769672393799,
            -3.7426505088806152,
            -2.2390568256378174,
            -2.0651068687438965,
            -1.330254077911377,
            1.3020861148834229,
            0.45174676179885864,
            -1.471880316734314,
            -0.19433051347732544,
            -0.4126831293106079,
            -6.420228958129883,
            6.223355293273926,
            -2.5283069610595703,
            2.095745086669922,
            -1.7934926748275757,
            0.37250852584838867,
            5.86362361907959,
            -2.873563766479492,
            0.11756488680839539,
            -4.52896785736084,
            0.2521567642688751,
            0.12060673534870148,
            -1.3543667793273926,
            -1.9145795106887817,
            0.5071473121643066,
            4.210231781005859,
            1.2554528713226318,
            -0.3515540361404419,
            1.6122454404830933,
            5.030381202697754,
            3.2170698642730713,
            1.4668350219726562,
            4.208859920501709,
            1.054114580154419,
            -2.024448871612549,
            -1.6667535305023193,
            2.992234706878662,
            0.7396091818809509,
            -0.8891720175743103,
            4.810717582702637,
            6.319345474243164,
            -0.8327782154083252,
            -1.1719245910644531,
            1.6198186874389648,
            -5.0605549812316895,
            -1.1505975723266602,
            3.9399662017822266,
            1.409770131111145,
            1.1175497770309448,
            -2.3190155029296875,
            -6.372992515563965,
            0.8113410472869873,
            0.7942735552787781,
            -3.0466866493225098,
            4.944697380065918,
            -1.5923677682876587,
            -5.807809829711914,
            -2.3089041709899902,
            0.43492186069488525,
            0.2887173295021057,
            0.2739914655685425,
            1.2208542823791504,
            0.4829399585723877,
            4.077980995178223,
            -0.7252281904220581,
            -0.48415517807006836,
            -1.8438515663146973,
            4.570228099822998,
            -2.6248111724853516,
            -0.9475070238113403,
            1.4106907844543457,
            -0.794831395149231,
            4.943425178527832,
            -2.817460536956787,
            2.5709846019744873,
            0.34343478083610535,
            2.0047194957733154,
            -1.6494140625,
            -0.7126889228820801,
            4.114165306091309,
            -0.4217156767845154,
            2.4660210609436035,
            1.6428196430206299,
            0.8685271739959717,
            -2.6417365074157715,
            1.5635908842086792,
            2.228612184524536,
            4.260500907897949,
            -2.2432284355163574,
            0.5910081267356873,
            3.5257954597473145,
            -1.1487727165222168,
            0.9064702987670898,
            -1.9821820259094238,
            -1.7282906770706177,
            -3.2993879318237305,
            0.20185118913650513,
            -1.9654560089111328,
            4.552901268005371,
            -1.1078956127166748,
            -4.300931453704834,
            -0.9735950231552124,
            1.355079174041748,
            0.9745481610298157,
            0.13757236301898956,
            -3.134827136993408,
            -0.0923067107796669,
            -2.3405938148498535,
            -5.525333881378174,
            2.9681925773620605,
            -2.650343418121338,
            4.219790458679199,
            -2.879962921142578,
            6.024677276611328,
            4.691902160644531,
            -3.7820897102355957,
            1.0415730476379395,
            -0.29066723585128784,
            -1.3308637142181396,
            -0.06363199651241302,
            3.0176877975463867,
            0.6467137932777405,
            -1.1486015319824219,
            3.1761863231658936,
            1.8798484802246094,
            0.7184268236160278,
            1.3567039966583252,
            -1.1470855474472046,
            4.012109279632568,
            3.3994603157043457,
            -4.036797523498535,
            2.2512636184692383,
            1.9184074401855469,
            -0.8510760068893433,
            4.440035343170166,
            -3.124713659286499,
            1.9465320110321045,
            1.101152777671814,
            -0.10060811042785645,
            1.9630858898162842,
            -1.7764663696289062,
            -11.58299446105957,
            -4.177868843078613,
            1.95820951461792,
            -3.90694522857666,
            -1.498936653137207,
            1.36025071144104,
            -3.6451282501220703,
            0.20014223456382751,
            0.7600661516189575,
            1.8297669887542725,
            1.5556602478027344,
            3.6632368564605713,
            1.6777464151382446,
            2.1368160247802734,
            1.9588044881820679,
            -3.1011013984680176,
            1.2693836688995361,
            2.5634894371032715,
            2.2654523849487305,
            -0.8133514523506165,
            -8.297039985656738,
            -1.8191481828689575,
            -3.5316739082336426,
            -2.9554052352905273,
            -1.382553219795227,
            -1.405182123184204,
            -2.186561107635498,
            -0.6546201109886169,
            -2.6679694652557373,
            -1.4153954982757568,
            4.316033840179443,
            6.0918660163879395,
            1.5488030910491943,
            0.6295966506004333,
            -0.06311589479446411,
            1.047407865524292,
            0.38927239179611206,
            0.33228445053100586,
            3.0526132583618164,
            2.527090549468994,
            -4.125261306762695,
            1.1697458028793335,
            4.355505466461182,
            2.697895050048828,
            -2.564044952392578,
            4.520516395568848,
            0.808529794216156,
            -0.005435094237327576,
            2.087259531021118,
            0.1820378601551056,
            -2.3338730335235596,
            -0.5491521954536438,
            -3.561784267425537,
            -2.1754374504089355,
            -5.948433876037598,
            1.2450053691864014,
            2.6482136249542236,
            2.1934268474578857,
            -0.4811044931411743,
            -0.10723993182182312,
            -0.2642897367477417,
            -3.2888479232788086,
            1.7492607831954956,
            -1.8795607089996338,
            2.4808826446533203,
            -0.03756271302700043,
            1.4913594722747803,
            1.3651983737945557,
            -0.3244614601135254,
            -4.7103471755981445,
            -0.5264874696731567,
            -2.2505531311035156,
            -1.0976171493530273,
            -2.4895386695861816,
            -4.324251174926758,
            -0.02063465118408203,
            -1.2391071319580078,
            0.6873719096183777,
            5.194057464599609,
            0.13523544371128082,
            0.5829474925994873,
            5.306211471557617,
            2.095607280731201,
            1.8370387554168701,
            -2.739680290222168,
            0.37594491243362427,
            -5.195871829986572,
            -0.3606792986392975,
            -1.7519278526306152,
            -0.6202088594436646,
            -0.4860400855541229,
            -0.3145301342010498,
            3.5256004333496094,
            3.5243043899536133,
            -0.3298717439174652,
            0.8725973963737488,
            1.2300554513931274,
            1.2255501747131348,
            0.12802517414093018,
            2.3556504249572754,
            0.8321858048439026,
            2.4119796752929688,
            -0.7593653202056885,
            -2.2875657081604004,
            -3.5561399459838867,
            -2.8956079483032227,
            -5.446815013885498,
            0.7310328483581543,
            3.332383155822754,
            -0.07157844305038452,
            -1.3163719177246094,
            -6.4217987060546875,
            -0.7119560241699219,
            -2.809494733810425,
            -0.2035948932170868,
            0.9433813095092773,
            3.6974542140960693,
            2.1717453002929688,
            -0.09325438737869263,
            -2.954106092453003,
            1.857332468032837,
            -1.4933358430862427,
            -2.221724510192871,
            -3.698146343231201,
            -0.00471070408821106,
            2.290517568588257,
            1.041113018989563,
            -3.1999716758728027,
            -5.205112457275391,
            3.103555679321289,
            -2.6464531421661377,
            1.3322933912277222,
            -4.566364288330078,
            1.749324083328247,
            2.0935378074645996,
            -2.1785707473754883,
            1.147721767425537,
            1.1478198766708374,
            2.040501832962036,
            1.713252067565918,
            1.672082543373108,
            1.4356424808502197,
            3.502655267715454,
            2.9983248710632324,
            0.007333025336265564,
            -0.4514901638031006,
            1.7941285371780396,
            -3.7331326007843018,
            -1.235762596130371,
            0.6857929229736328,
            3.3034002780914307,
            -4.491302490234375,
            -0.1458072066307068,
            0.6830184459686279,
            0.23546546697616577,
            1.374997854232788,
            -4.874075412750244,
            2.434446334838867,
            0.455757200717926,
            -0.2683415114879608,
            -4.282454490661621,
            -1.8260337114334106,
            -1.4896254539489746,
            1.8005363941192627,
            0.6357269287109375,
            1.2251319885253906,
            -4.137175559997559,
            1.9556978940963745,
            1.1524653434753418,
            4.659326076507568,
            3.93766188621521,
            3.6878628730773926,
            -0.7144867181777954,
            -4.326309680938721,
            -1.6913955211639404,
            1.180161714553833,
            2.821824073791504,
            -0.10317407548427582,
            -1.1167621612548828,
            5.013862609863281,
            -3.2662129402160645,
            -1.504834532737732,
            -2.4104628562927246,
            0.09427912533283234,
            2.529845714569092,
            -1.5414453744888306,
            -1.2048938274383545,
            -0.9566954970359802,
            3.3228230476379395,
            1.579115867614746,
            1.2697192430496216,
            2.1672635078430176,
            3.178083658218384,
            1.5229732990264893,
            3.035126209259033,
            -1.2141704559326172,
            -1.063910722732544,
            2.400230646133423,
            0.029102027416229248,
            2.044597864151001,
            2.0673747062683105,
            0.4909239411354065,
            -1.2818753719329834,
            -2.8750243186950684,
            8.503203392028809,
            -2.5392866134643555,
            3.3483715057373047,
            -2.8208119869232178,
            0.24270427227020264,
            -2.18922758102417,
            -4.001626968383789,
            1.896809458732605,
            -2.299403190612793,
            -2.9650802612304688,
            1.691004991531372,
            -2.138991117477417,
            1.8712677955627441,
            -0.011925682425498962,
            1.8838139772415161,
            2.170051336288452,
            -0.15755899250507355,
            2.781306028366089,
            1.1581823825836182,
            1.3932759761810303,
            -1.1853337287902832,
            2.06245756149292,
            -1.0509753227233887,
            -0.49925509095191956,
            0.028105422854423523,
            2.2145743370056152,
            0.07391375303268433,
            2.800342321395874,
            1.124160885810852,
            -4.323290824890137,
            -2.5013680458068848,
            -3.242280960083008,
            1.176095962524414,
            0.014816775918006897,
            -0.8232793807983398,
            1.6856591701507568,
            3.2317373752593994,
            0.9572833776473999,
            -5.858419895172119,
            -0.7047216296195984,
            5.540335655212402,
            0.23436573147773743,
            -1.837106704711914,
            1.6031420230865479,
            -2.5619044303894043,
            -4.786980628967285,
            -1.0721604824066162,
            -6.108914375305176,
            -0.619033932685852,
            -2.826326370239258,
            0.3656940460205078,
            3.581220865249634,
            3.0069258213043213,
            4.246577262878418,
            1.0785276889801025,
            2.732840061187744,
            5.050372123718262,
            1.951961874961853,
            1.424525499343872,
            1.588252305984497,
            0.5870574116706848,
            -1.1764978170394897,
            -7.198906898498535,
            4.021620750427246,
            -2.031750202178955,
            4.619064807891846,
            -3.681814193725586,
            1.0908873081207275,
            2.202524423599243,
            3.6989965438842773,
            3.681018829345703,
            2.2121620178222656,
            3.7896392345428467,
            -2.1850552558898926,
            0.23065760731697083,
            -0.20706412196159363,
            -2.752694606781006,
            6.429084777832031,
            2.3844656944274902,
            1.4003329277038574,
            -0.9352281093597412,
            -0.577228844165802,
            -0.6204324960708618,
            -5.507601737976074,
            4.1443023681640625,
            -3.327406167984009,
            -0.07455188035964966,
            -0.19837188720703125,
            -0.6318986415863037,
            1.8645504713058472,
            -2.694890022277832,
            -1.6642488241195679,
            0.8487131595611572,
            -0.3329656720161438,
            -5.465345859527588,
            4.158132553100586,
            -0.38121604919433594,
            -0.16627594828605652,
            -1.2763584852218628,
            2.309319496154785,
            -3.7717161178588867,
            -3.3656044006347656,
            -2.2440571784973145,
            3.1584157943725586,
            -1.7397589683532715,
            -1.155916690826416,
            -3.227389335632324,
            -3.561815023422241,
            0.7754112482070923,
            -1.116990566253662,
            2.9632205963134766,
            3.3981480598449707,
            1.946843147277832,
            -2.30075740814209,
            -3.5882272720336914,
            -2.0453779697418213,
            3.7467403411865234,
            -0.43953102827072144,
            -2.3385074138641357,
            5.857327938079834,
            0.812761127948761,
            3.2328011989593506,
            4.711526393890381,
            2.444411039352417,
            1.475588083267212,
            4.673915386199951,
            3.6645538806915283,
            2.7436227798461914,
            3.39353084564209,
            -1.0238476991653442,
            -5.953630447387695,
            1.685095191001892,
            0.09848275780677795,
            -1.0224075317382812,
            1.9432446956634521,
            -3.0389480590820312,
            -1.4419699907302856,
            -1.2783105373382568,
            -0.4366382658481598,
            2.419255495071411,
            2.390744924545288,
            2.50341796875,
            -0.5022112131118774,
            -2.3142335414886475,
            -0.4328156113624573,
            3.1112282276153564,
            -6.1939592361450195,
            1.655430555343628,
            -2.22031831741333,
            0.6603504419326782,
            6.298846244812012,
            -3.7664895057678223,
            -0.8880527019500732,
            0.03359547257423401,
            -1.9280749559402466,
            -0.7219140529632568,
            -0.6182302832603455,
            1.3618817329406738,
            3.277390956878662,
            -0.7328113913536072,
            -4.266626358032227,
            -0.5515225529670715,
            3.064067840576172,
            5.140385627746582,
            6.462062835693359,
            4.033296585083008,
            4.771944522857666,
            -0.40856948494911194,
            -1.7651350498199463,
            -0.2704094648361206,
            3.406433343887329,
            4.757784843444824,
            -4.38734245300293,
            0.09451669454574585,
            -1.3631776571273804,
            -3.3518683910369873,
            2.2195863723754883,
            2.943915367126465,
            -0.8116353154182434,
            2.6220502853393555,
            -5.873318672180176,
            -2.2511401176452637,
            -2.3238539695739746,
            2.239931106567383,
            0.3423802852630615,
            -3.455259323120117,
            0.7105432152748108,
            -0.7412825226783752,
            -3.494931697845459,
            -2.2360918521881104,
            -0.5841772556304932,
            -1.1540104150772095,
            -2.146965980529785,
            0.38673460483551025,
            3.7390220165252686,
            -2.802236557006836,
            -2.2932205200195312,
            0.8758307695388794,
            -2.74288010597229,
            2.736877918243408,
            -3.485365390777588,
            3.9001827239990234,
            3.6484899520874023,
            0.6649277210235596,
            -0.1537645161151886,
            -4.201186180114746,
            0.41777175664901733,
            1.1183546781539917,
            0.618379533290863,
            -1.5023760795593262,
            3.580878734588623,
            2.2124736309051514,
            -1.290084719657898,
            0.22914227843284607,
            -0.39838510751724243,
            -3.3951239585876465,
            -3.5687637329101562,
            -4.620619297027588,
            -2.23785662651062,
            -4.18902587890625,
            -0.726670503616333,
            4.81538200378418,
            -6.434809684753418,
            -2.119642734527588,
            2.861698627471924,
            -1.9440088272094727,
            -1.371064305305481,
            -3.679995059967041,
            3.9230971336364746,
            -3.3097639083862305,
            1.7178311347961426,
            2.272507667541504,
            1.230071783065796,
            -0.07939350605010986,
            2.8416354656219482,
            4.92911434173584,
            2.7449469566345215,
            4.245818138122559,
            -0.9746468663215637,
            -0.01934361457824707,
            3.225240707397461,
            -0.012876451015472412,
            -2.2581512928009033,
            1.5329698324203491,
            0.35442355275154114,
            3.523348808288574,
            20.194122314453125,
            -1.8963960409164429,
            -0.17076542973518372,
            0.5780981779098511,
            0.8838562965393066,
            -1.289292335510254,
            -4.289036750793457,
            5.206103801727295,
            -0.9625623226165771,
            1.8183670043945312,
            -5.591703414916992,
            -2.699070930480957,
            -2.2864980697631836,
            -0.4043060541152954,
            -5.951519012451172,
            0.29566290974617004,
            -2.190723419189453,
            6.744870185852051,
            -0.510700523853302,
            2.868523120880127,
            0.06561174988746643,
            1.77158522605896,
            -0.3693259358406067,
            -2.1894967555999756,
            -1.033448576927185,
            3.3775904178619385,
            1.0528464317321777,
            1.5802600383758545,
            -6.262295246124268,
            2.3066272735595703,
            -0.8526906371116638,
            0.7418103218078613,
            -1.6166445016860962,
            1.3515554666519165,
            0.5059070587158203,
            1.7648471593856812,
            4.407697677612305,
            -0.4821838140487671,
            3.0374820232391357,
            0.6927372813224792,
            -0.653899073600769,
            0.7135915756225586,
            -1.9833087921142578,
            2.2757327556610107,
            -4.1129350662231445,
            1.4533848762512207,
            2.42220401763916,
            -0.9439828395843506,
            -1.722000002861023,
            2.296931743621826,
            0.5367656946182251,
            -0.09884767234325409,
            -1.5148756504058838,
            0.4609975814819336,
            1.1940655708312988,
            -0.2627069354057312,
            0.6259009838104248,
            0.11251652240753174,
            1.421339750289917,
            -0.6116050481796265,
            0.8155652284622192,
            -0.18265444040298462,
            -0.49524691700935364,
            -4.730405807495117,
            -0.315649151802063,
            1.003629446029663,
            -1.8226048946380615,
            1.4260765314102173,
            2.0099644660949707,
            0.4905503988265991,
            5.253013610839844,
            1.3656940460205078,
            0.6690782904624939,
            -0.7431965470314026,
            -1.203779935836792,
            -5.954388618469238,
            1.199291706085205,
            -0.39991939067840576,
            0.5971328020095825,
            7.2713422775268555,
            -0.657455325126648,
            0.16418465971946716,
            -1.8927383422851562,
            -1.070922613143921,
            3.757359743118286,
            -5.065985202789307,
            0.9248540997505188,
            -0.9922423362731934,
            -0.11944770812988281,
            1.557284951210022,
            -0.29317808151245117,
            0.7149863243103027,
            2.0777714252471924,
            1.9310426712036133,
            1.7058829069137573,
            -3.6215133666992188,
            -2.8959882259368896,
            -3.7018027305603027,
            -6.359585762023926,
            -2.882631778717041,
            3.7338438034057617,
            0.09802895784378052,
            2.088813543319702,
            1.6407065391540527,
            2.8715391159057617,
            0.3133606016635895,
            -1.8879138231277466,
            -6.04268741607666,
            -3.7089712619781494,
            -1.8210127353668213,
            1.3078142404556274,
            -5.3421630859375,
            -1.2539739608764648,
            -1.2069497108459473,
            0.5068449974060059,
            -2.9382920265197754,
            -1.0182286500930786,
            -0.24066276848316193,
            -0.18766817450523376,
            4.25411319732666,
            -1.1143962144851685,
            -0.9209306240081787,
            -0.271749883890152,
            -1.3268952369689941,
            -2.9465417861938477,
            1.8148384094238281,
            -1.2393500804901123,
            -2.8814144134521484,
            -0.169436514377594,
            -0.8551890850067139,
            3.1909961700439453,
            -2.056272268295288,
            -1.677851676940918,
            1.6748180389404297,
            1.3360564708709717,
            -0.47534745931625366,
            0.9995715618133545,
            -1.292137622833252,
            -2.381279945373535,
            5.568824768066406,
            -0.4320524036884308,
            -4.054729461669922,
            -3.5971670150756836,
            11.146514892578125,
            -0.6428459882736206,
            -0.12837651371955872,
            -0.7281569838523865,
            -0.7569839954376221,
            -2.230039596557617,
            1.2616840600967407,
            2.027618646621704,
            -1.1772818565368652,
            5.064480304718018,
            1.6700947284698486,
            -1.4264414310455322,
            -3.1738672256469727
        ]
    },
    "authors": [
        {
            "authorId": "2312002293",
            "name": "Audrey Huang"
        },
        {
            "authorId": "1858443952",
            "name": "Wenhao Zhan"
        },
        {
            "authorId": "2297771684",
            "name": "Tengyang Xie"
        },
        {
            "authorId": "2257354792",
            "name": "Jason D. Lee"
        },
        {
            "authorId": "2257373093",
            "name": "Wen Sun"
        },
        {
            "authorId": "2268062211",
            "name": "Akshay Krishnamurthy"
        },
        {
            "authorId": "2279828764",
            "name": "Dylan J. Foster"
        }
    ],
    "references": []
}