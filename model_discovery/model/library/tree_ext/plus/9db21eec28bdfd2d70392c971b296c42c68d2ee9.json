{
    "paperId": "9db21eec28bdfd2d70392c971b296c42c68d2ee9",
    "externalIds": {
        "ArXiv": "2407.16153",
        "DBLP": "journals/corr/abs-2407-16153",
        "DOI": "10.48550/arXiv.2407.16153",
        "CorpusId": 271334516
    },
    "title": "On the Benefits of Rank in Attention Layers",
    "abstract": "Attention-based mechanisms are widely used in machine learning, most prominently in transformers. However, hyperparameters such as the rank of the attention matrices and the number of heads are scaled nearly the same way in all realizations of this architecture, without theoretical justification. In this work we show that there are dramatic trade-offs between the rank and number of heads of the attention mechanism. Specifically, we present a simple and natural target function that can be represented using a single full-rank attention head for any context length, but that cannot be approximated by low-rank attention unless the number of heads is exponential in the embedding dimension, even for short context lengths. Moreover, we prove that, for short context lengths, adding depth allows the target to be approximated by low-rank attention. For long contexts, we conjecture that full-rank attention is necessary. Finally, we present experiments with off-the-shelf transformers that validate our theoretical findings.",
    "venue": "arXiv.org",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work shows that there are dramatic trade-offs between the rank and number of heads of the attention mechanism, and proves that, for short context lengths, adding depth allows the target to be approximated by low-rank attention."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -6.043796539306641,
            -0.7577704191207886,
            1.8534901142120361,
            2.8032772541046143,
            -0.10532698035240173,
            -0.21128839254379272,
            1.7967033386230469,
            -3.9124398231506348,
            0.4937073588371277,
            0.8939626812934875,
            0.23709595203399658,
            6.3194379806518555,
            -0.895977258682251,
            1.1098930835723877,
            -4.387294769287109,
            -2.355215072631836,
            -2.355647087097168,
            -1.495835304260254,
            3.0836334228515625,
            2.945157527923584,
            -2.373478889465332,
            2.7094063758850098,
            -6.59943962097168,
            -1.4879512786865234,
            -1.7400519847869873,
            0.1469699740409851,
            0.45500117540359497,
            -1.0422970056533813,
            -3.1036152839660645,
            0.9503127336502075,
            -0.07912203669548035,
            -6.001660346984863,
            5.849276542663574,
            -3.8737988471984863,
            2.131166696548462,
            -4.151379108428955,
            -1.6287565231323242,
            6.421898365020752,
            -3.1052417755126953,
            -2.954926013946533,
            -0.8128935098648071,
            1.1139932870864868,
            -0.7636999487876892,
            0.2461189329624176,
            -0.026125222444534302,
            1.6509511470794678,
            0.17550331354141235,
            2.784116744995117,
            0.8104486465454102,
            4.627414703369141,
            5.207103252410889,
            -1.8784762620925903,
            -2.051779270172119,
            3.5070292949676514,
            0.6188780069351196,
            -0.5035621523857117,
            4.090891361236572,
            1.1843206882476807,
            1.8761568069458008,
            -0.6736966371536255,
            3.988651752471924,
            5.116415500640869,
            0.07545885443687439,
            0.2669917643070221,
            3.12995982170105,
            -1.2093055248260498,
            -1.424471139907837,
            8.021024703979492,
            4.7482404708862305,
            1.064840316772461,
            -0.5989287495613098,
            -7.477913856506348,
            1.1895787715911865,
            0.5913547277450562,
            -4.613369464874268,
            1.205573558807373,
            2.433366298675537,
            -8.384746551513672,
            0.827159583568573,
            -0.8489684462547302,
            -1.3411338329315186,
            2.2787747383117676,
            -0.5662375688552856,
            1.9075500965118408,
            1.7518426179885864,
            -1.6609865427017212,
            -4.511673450469971,
            1.027486801147461,
            2.664287567138672,
            -0.5069666504859924,
            -1.8223068714141846,
            -2.1549792289733887,
            1.4678328037261963,
            0.4748454689979553,
            -5.519379138946533,
            0.1335618793964386,
            2.357767343521118,
            -0.009404897689819336,
            -5.1243157386779785,
            0.8617119789123535,
            -0.6283806562423706,
            0.8947575092315674,
            1.9178929328918457,
            1.4509375095367432,
            4.426488876342773,
            -2.532412528991699,
            -3.819779872894287,
            -0.5259688496589661,
            2.8606441020965576,
            -1.5768704414367676,
            -1.3997957706451416,
            2.9972620010375977,
            3.190655469894409,
            -0.9914807081222534,
            -2.7747936248779297,
            -3.832939624786377,
            -1.8330457210540771,
            0.13577711582183838,
            0.9950441122055054,
            4.9247894287109375,
            -2.0891237258911133,
            2.726987361907959,
            -4.42094612121582,
            -0.6485359072685242,
            0.956177830696106,
            1.566221833229065,
            -3.2729897499084473,
            1.7835288047790527,
            -0.0022741779685020447,
            -3.621217727661133,
            -1.377263069152832,
            -1.5674705505371094,
            0.7567013502120972,
            -1.6298813819885254,
            8.108875274658203,
            1.3945285081863403,
            -2.960702896118164,
            0.689791202545166,
            -3.5544989109039307,
            -2.1595683097839355,
            1.5010559558868408,
            3.079282760620117,
            2.126340866088867,
            -2.142500162124634,
            3.0402798652648926,
            3.010946273803711,
            0.9250527024269104,
            -0.89371657371521,
            -1.6347875595092773,
            5.335599899291992,
            2.976627826690674,
            -5.184063911437988,
            0.6393264532089233,
            2.7691266536712646,
            -1.1382458209991455,
            1.1403977870941162,
            -5.7128801345825195,
            1.3571410179138184,
            0.2229222059249878,
            2.253814697265625,
            0.5519314408302307,
            2.5758330821990967,
            -9.50495719909668,
            -0.6346513032913208,
            5.695180892944336,
            -3.053330898284912,
            -1.8629412651062012,
            0.31687432527542114,
            -1.2325955629348755,
            1.4657596349716187,
            0.8940979838371277,
            0.2567867040634155,
            -1.264540672302246,
            5.0304951667785645,
            2.89491605758667,
            6.858284950256348,
            1.3142164945602417,
            -3.858809471130371,
            0.19298556447029114,
            0.7678534984588623,
            0.3194584250450134,
            -1.450119972229004,
            -7.544891357421875,
            0.44602909684181213,
            -4.345331192016602,
            -1.549726963043213,
            -2.059762954711914,
            -3.5823190212249756,
            -2.4034345149993896,
            -1.1494531631469727,
            -0.5555659532546997,
            1.5563523769378662,
            5.342874526977539,
            5.154945373535156,
            1.9518520832061768,
            0.16326913237571716,
            1.5826244354248047,
            -0.2977527976036072,
            -3.982619524002075,
            -0.33113259077072144,
            2.0406899452209473,
            3.2423458099365234,
            0.3360258936882019,
            -1.9377719163894653,
            2.69801926612854,
            2.3291139602661133,
            -3.58994197845459,
            4.770325660705566,
            3.29223895072937,
            3.111985683441162,
            1.882629632949829,
            -2.4043593406677246,
            -2.2613773345947266,
            1.3015631437301636,
            -6.023089408874512,
            -2.508699893951416,
            -5.099031925201416,
            3.560640335083008,
            2.209689140319824,
            0.17787230014801025,
            -1.0418908596038818,
            -1.5219556093215942,
            3.0915374755859375,
            -1.7238569259643555,
            4.1090497970581055,
            0.07983118295669556,
            2.1599326133728027,
            -0.348117858171463,
            -0.8714888095855713,
            -0.40646541118621826,
            -3.2497735023498535,
            0.1886935532093048,
            0.6315511465072632,
            -4.19633674621582,
            -8.89586353302002,
            -0.9659764766693115,
            -4.438057899475098,
            1.1631361246109009,
            0.41216713190078735,
            -0.05499890446662903,
            7.560510635375977,
            2.6146512031555176,
            2.984496593475342,
            5.1735687255859375,
            0.35358208417892456,
            -0.5715493559837341,
            -1.3875240087509155,
            2.2094573974609375,
            0.8474835157394409,
            -4.252211093902588,
            -0.4783705472946167,
            1.3793224096298218,
            3.6104962825775146,
            -2.3157219886779785,
            2.099637269973755,
            3.124793529510498,
            2.479403257369995,
            -0.5516526699066162,
            3.092928171157837,
            -0.17235419154167175,
            0.8704110980033875,
            7.008886814117432,
            3.2418272495269775,
            6.555712699890137,
            -0.4549572467803955,
            0.8559178709983826,
            -4.253776550292969,
            -2.893923282623291,
            -0.5446828603744507,
            4.739706039428711,
            -0.8186060786247253,
            4.31421422958374,
            -3.0701732635498047,
            -2.03139591217041,
            -1.5868968963623047,
            -6.632427215576172,
            -6.094225883483887,
            -2.625020742416382,
            2.821122169494629,
            3.240086078643799,
            1.9027992486953735,
            -0.9148319959640503,
            -2.615692615509033,
            -1.3891737461090088,
            -2.6493828296661377,
            -0.662340521812439,
            -4.73154354095459,
            0.5939546823501587,
            2.4096598625183105,
            -0.6972954273223877,
            -5.021114826202393,
            2.4196043014526367,
            -2.063450574874878,
            -2.0084426403045654,
            -3.6280417442321777,
            2.3434853553771973,
            4.249591827392578,
            -2.189098834991455,
            -0.07736306637525558,
            0.029169023036956787,
            -1.4015812873840332,
            0.8304760456085205,
            2.1563000679016113,
            1.7830326557159424,
            2.1888110637664795,
            4.744999885559082,
            0.9729282855987549,
            -0.2030087113380432,
            -1.8724768161773682,
            -5.891692161560059,
            -0.8449045419692993,
            -1.0867252349853516,
            5.217341423034668,
            -3.528311252593994,
            2.9462242126464844,
            0.8017083406448364,
            4.5189409255981445,
            1.068233847618103,
            -1.6302937269210815,
            4.229804039001465,
            1.5287028551101685,
            -0.039102405309677124,
            -3.7859957218170166,
            -2.4156031608581543,
            -2.208458662033081,
            -0.5458117127418518,
            2.7309722900390625,
            2.541250467300415,
            -6.8670525550842285,
            0.5786018371582031,
            1.255275845527649,
            3.8876044750213623,
            6.0719380378723145,
            0.515717625617981,
            -0.8120161294937134,
            -6.270730972290039,
            -1.4950718879699707,
            -0.5001862049102783,
            1.3084756135940552,
            4.649815559387207,
            -0.7523383498191833,
            4.202322959899902,
            1.557802677154541,
            0.42468366026878357,
            -2.221524238586426,
            -1.2576065063476562,
            1.0498570203781128,
            -2.912670135498047,
            -0.6065775156021118,
            -3.042755603790283,
            0.1770169883966446,
            -0.9868049621582031,
            1.2602466344833374,
            -6.001768112182617,
            1.72456693649292,
            4.674775123596191,
            1.9925415515899658,
            0.7861119508743286,
            2.5400571823120117,
            0.3300320506095886,
            -0.9419203400611877,
            -0.8750137090682983,
            0.3021913766860962,
            -1.088636875152588,
            -2.20279860496521,
            -1.5673184394836426,
            8.677865028381348,
            -4.351891040802002,
            -0.11150896549224854,
            -5.820949554443359,
            -3.3098256587982178,
            0.18542711436748505,
            -2.3846213817596436,
            5.203793525695801,
            -1.9890910387039185,
            -3.1580822467803955,
            -0.23139634728431702,
            -3.295414924621582,
            1.9399358034133911,
            2.148437261581421,
            -0.1318327784538269,
            3.0995728969573975,
            1.3598153591156006,
            3.5158090591430664,
            -0.5357422828674316,
            -2.327831745147705,
            -2.0500526428222656,
            3.1812071800231934,
            1.9608367681503296,
            2.4280052185058594,
            -0.14241307973861694,
            1.3203904628753662,
            -1.6534981727600098,
            1.3712422847747803,
            -2.8181562423706055,
            -3.7004475593566895,
            -4.059260368347168,
            -5.4408698081970215,
            3.3361740112304688,
            0.6191689372062683,
            2.3122496604919434,
            1.165541172027588,
            3.17912220954895,
            3.8234519958496094,
            -4.501069068908691,
            -0.3670061230659485,
            5.587589263916016,
            0.2618221342563629,
            -0.515969455242157,
            0.5171410441398621,
            -1.1854057312011719,
            0.5086982250213623,
            0.5378248691558838,
            -3.685298204421997,
            1.4375083446502686,
            -0.4385973811149597,
            -0.44644033908843994,
            0.696685791015625,
            1.9066883325576782,
            2.513740062713623,
            -1.227514386177063,
            2.388502836227417,
            4.613670349121094,
            1.9159886837005615,
            -1.3629863262176514,
            0.07979238033294678,
            0.8870819807052612,
            1.7730712890625,
            -0.263415664434433,
            1.1138092279434204,
            -2.4499809741973877,
            4.091629505157471,
            -2.7566938400268555,
            -0.29049599170684814,
            1.8981034755706787,
            4.42783784866333,
            -0.15320217609405518,
            0.6073501110076904,
            2.8233642578125,
            2.7777352333068848,
            1.052428126335144,
            4.951258182525635,
            -5.274432182312012,
            6.321173667907715,
            0.7529020309448242,
            2.345595598220825,
            1.5653069019317627,
            0.9597718715667725,
            -0.7562277317047119,
            -2.330427408218384,
            4.154935836791992,
            -5.862287998199463,
            -2.2841358184814453,
            -1.1494112014770508,
            -0.5094561576843262,
            -0.1871558427810669,
            0.42438051104545593,
            -0.6109068989753723,
            0.8984524011611938,
            0.02978515625,
            -3.827025890350342,
            4.267026424407959,
            0.42810651659965515,
            -0.7148929834365845,
            -0.9189440011978149,
            0.9645349979400635,
            -1.0111079216003418,
            -1.6593815088272095,
            -1.769561767578125,
            -0.7927368879318237,
            2.384254217147827,
            1.6015064716339111,
            -0.39108002185821533,
            -1.098982572555542,
            -1.4083037376403809,
            0.7987079620361328,
            1.824986457824707,
            2.525787830352783,
            -0.5117588043212891,
            -7.040563106536865,
            -4.776259422302246,
            -1.6185513734817505,
            2.1078200340270996,
            -2.135112762451172,
            -1.3731658458709717,
            6.141617774963379,
            5.109475135803223,
            3.5200891494750977,
            3.6843349933624268,
            2.6132559776306152,
            0.761566162109375,
            0.8982856869697571,
            4.924783706665039,
            1.187856912612915,
            0.4826306402683258,
            1.0417375564575195,
            -2.776212215423584,
            2.9469494819641113,
            3.568532705307007,
            1.7444342374801636,
            0.6530431509017944,
            -2.987454414367676,
            -1.8044869899749756,
            -3.070918560028076,
            -1.158827543258667,
            7.242003440856934,
            3.9864461421966553,
            0.25741779804229736,
            0.16164493560791016,
            -1.2487139701843262,
            -1.41129469871521,
            1.4349069595336914,
            -7.284567832946777,
            1.618863821029663,
            -1.9710662364959717,
            0.5867279767990112,
            4.503897666931152,
            -0.988795816898346,
            -1.5137157440185547,
            2.589236259460449,
            -4.862641334533691,
            -0.689977765083313,
            0.20733678340911865,
            3.616079807281494,
            0.7705963253974915,
            0.919894814491272,
            -2.8953499794006348,
            -0.17762145400047302,
            -0.6515318155288696,
            5.958708763122559,
            5.957633018493652,
            5.861152648925781,
            1.9083300828933716,
            -0.8427579402923584,
            -2.9334030151367188,
            -2.908848285675049,
            3.645200252532959,
            4.257363796234131,
            -2.0628395080566406,
            -3.453355312347412,
            -0.23077692091464996,
            1.8761494159698486,
            0.36756253242492676,
            2.1905694007873535,
            -1.7599828243255615,
            3.5459823608398438,
            -3.4848999977111816,
            -0.16822709143161774,
            -4.876691818237305,
            2.610945701599121,
            -0.4875079393386841,
            1.2897593975067139,
            4.751758575439453,
            -1.5393072366714478,
            -3.7892634868621826,
            2.9690229892730713,
            -1.9847588539123535,
            -1.4495413303375244,
            -0.5627964735031128,
            2.0199387073516846,
            1.3855535984039307,
            -2.0753636360168457,
            -1.775310754776001,
            1.9321980476379395,
            -4.467283248901367,
            -2.601041793823242,
            -3.445859432220459,
            3.206085205078125,
            -2.446885824203491,
            -2.5753703117370605,
            0.5191890001296997,
            -3.3626017570495605,
            0.9942039251327515,
            0.8540379405021667,
            0.0751684308052063,
            3.527522563934326,
            2.8696823120117188,
            3.327225685119629,
            -1.2225806713104248,
            -2.791207790374756,
            -0.8296104073524475,
            -2.2281670570373535,
            -3.6792922019958496,
            -4.865246772766113,
            -0.06863093376159668,
            -2.7783308029174805,
            -1.208397388458252,
            -1.3833527565002441,
            -6.021416664123535,
            -2.812592029571533,
            2.8051655292510986,
            -1.1970407962799072,
            -0.3655632734298706,
            -3.1786608695983887,
            0.3339184522628784,
            -1.1047645807266235,
            3.677255630493164,
            -1.3739973306655884,
            -1.61441171169281,
            1.496382474899292,
            2.376249074935913,
            4.4742350578308105,
            5.56046199798584,
            3.725057601928711,
            -2.4224765300750732,
            -2.3761632442474365,
            1.0852255821228027,
            -0.41220006346702576,
            -2.5952112674713135,
            -1.0895493030548096,
            1.9606170654296875,
            3.9610605239868164,
            14.209685325622559,
            1.4807934761047363,
            -0.32279717922210693,
            -0.8067514896392822,
            -0.43770352005958557,
            -5.383403778076172,
            -3.040092706680298,
            1.385652780532837,
            0.6777678728103638,
            1.4055780172348022,
            -2.32755708694458,
            -5.148635387420654,
            1.6459529399871826,
            -0.4540168046951294,
            -2.724360704421997,
            -2.179415225982666,
            -3.663710832595825,
            0.41910266876220703,
            -2.842021942138672,
            -1.4277781248092651,
            -0.7900815606117249,
            4.922895908355713,
            -0.7625986337661743,
            0.7060354948043823,
            0.29608598351478577,
            2.946483850479126,
            1.369544506072998,
            3.0222768783569336,
            -7.206398010253906,
            1.1800603866577148,
            3.6518852710723877,
            1.5450085401535034,
            1.3704673051834106,
            0.26087191700935364,
            -4.1057891845703125,
            2.1981558799743652,
            4.788427352905273,
            -1.8074133396148682,
            5.419578552246094,
            1.7600024938583374,
            -3.4467010498046875,
            1.9137617349624634,
            -5.256134033203125,
            3.4122042655944824,
            -1.3658115863800049,
            -1.162988543510437,
            1.7968924045562744,
            -2.167393445968628,
            -0.10489942133426666,
            4.11629581451416,
            -0.21631425619125366,
            -0.34264901280403137,
            -1.1682895421981812,
            2.0056920051574707,
            5.699176788330078,
            2.537903308868408,
            1.1937273740768433,
            -0.6747243404388428,
            1.1514225006103516,
            3.9874985218048096,
            3.0750856399536133,
            1.6996862888336182,
            -2.068382501602173,
            -3.99569034576416,
            -2.308387517929077,
            0.38213056325912476,
            -4.413394927978516,
            2.107452630996704,
            1.3713501691818237,
            1.4251962900161743,
            7.794676780700684,
            -1.5379846096038818,
            -1.090684175491333,
            -1.7245080471038818,
            -1.2282642126083374,
            -0.8097494840621948,
            -0.22853237390518188,
            1.8581522703170776,
            -0.7747771143913269,
            9.28915023803711,
            -5.009357452392578,
            1.0367857217788696,
            -2.759643077850342,
            -3.2866392135620117,
            7.50318717956543,
            -2.2708067893981934,
            6.164453506469727,
            -2.1174476146698,
            -2.532727003097534,
            5.158949851989746,
            -0.3506326675415039,
            -0.8948091268539429,
            2.901238441467285,
            2.178020715713501,
            4.926354885101318,
            -2.7189793586730957,
            -6.032527923583984,
            -5.796178817749023,
            -5.300718307495117,
            -3.860405445098877,
            5.7816081047058105,
            0.5362516641616821,
            2.0442535877227783,
            0.5166518688201904,
            -1.0731967687606812,
            0.7595095038414001,
            -0.24591517448425293,
            -5.846959114074707,
            -4.754714012145996,
            -0.5353571772575378,
            2.5970957279205322,
            0.08790203928947449,
            -1.953282117843628,
            0.15994586050510406,
            -1.0299882888793945,
            -0.8460066318511963,
            0.45482614636421204,
            3.0924792289733887,
            -0.10675865411758423,
            5.896064281463623,
            -0.8731352090835571,
            -1.0604491233825684,
            -0.3875194191932678,
            -4.585554122924805,
            -1.9402461051940918,
            3.2126145362854004,
            0.8815521001815796,
            -2.6974995136260986,
            0.4125922620296478,
            -0.9548828601837158,
            0.06246890127658844,
            -2.3264312744140625,
            -4.771807670593262,
            -2.257713794708252,
            0.3870317041873932,
            -4.2138800621032715,
            -0.2591654658317566,
            3.698725938796997,
            -3.015510082244873,
            0.863457977771759,
            1.829254150390625,
            -2.741243362426758,
            -0.7224071025848389,
            9.318233489990234,
            -1.4919097423553467,
            0.7837977409362793,
            -3.8557591438293457,
            -3.0801899433135986,
            -3.960728645324707,
            0.6362295746803284,
            -0.826892614364624,
            -0.6650060415267944,
            4.933297157287598,
            -1.8796271085739136,
            -1.747251272201538,
            -2.8596320152282715
        ]
    },
    "authors": [
        {
            "authorId": "81087552",
            "name": "Noah Amsel"
        },
        {
            "authorId": "90287577",
            "name": "Gilad Yehudai"
        },
        {
            "authorId": "2312404239",
            "name": "Joan Bruna"
        }
    ],
    "references": []
}