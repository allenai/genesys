{
    "paperId": "39df36e98966c974680a4e7eb1cf1f71528f3625",
    "externalIds": {
        "ArXiv": "2408.17131",
        "CorpusId": 272310464
    },
    "title": "VQ4DiT: Efficient Post-Training Vector Quantization for Diffusion Transformers",
    "abstract": "The Diffusion Transformers Models (DiTs) have transitioned the network architecture from traditional UNets to transformers, demonstrating exceptional capabilities in image generation. Although DiTs have been widely applied to high-definition video generation tasks, their large parameter size hinders inference on edge devices. Vector quantization (VQ) can decompose model weight into a codebook and assignments, allowing extreme weight quantization and significantly reducing memory usage. In this paper, we propose VQ4DiT, a fast post-training vector quantization method for DiTs. We found that traditional VQ methods calibrate only the codebook without calibrating the assignments. This leads to weight sub-vectors being incorrectly assigned to the same assignment, providing inconsistent gradients to the codebook and resulting in a suboptimal result. To address this challenge, VQ4DiT calculates the candidate assignment set for each weight sub-vector based on Euclidean distance and reconstructs the sub-vector based on the weighted average. Then, using the zero-data and block-wise calibration method, the optimal assignment from the set is efficiently selected while calibrating the codebook. VQ4DiT quantizes a DiT XL/2 model on a single NVIDIA A100 GPU within 20 minutes to 5 hours depending on the different quantization settings. Experiments show that VQ4DiT establishes a new state-of-the-art in model size and performance trade-offs, quantizing weights to 2-bit precision while retaining acceptable image generation quality.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "Experiments show that VQ4DiT establishes a new state-of-the-art in model size and performance trade-offs, quantizing weights to 2-bit precision while retaining acceptable image generation quality."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -5.322099685668945,
            0.07694679498672485,
            -1.605377197265625,
            4.029081344604492,
            -0.3850133419036865,
            -0.886086106300354,
            4.688053607940674,
            0.37203145027160645,
            1.222497820854187,
            -4.445625305175781,
            -3.1212329864501953,
            1.0848941802978516,
            1.8190034627914429,
            1.8133196830749512,
            -0.5381230115890503,
            -4.143157005310059,
            -1.3628913164138794,
            5.14354133605957,
            3.5351879596710205,
            -0.012921363115310669,
            -2.613952159881592,
            0.9676175117492676,
            -4.207342624664307,
            0.4987337589263916,
            -1.705723524093628,
            -1.426534652709961,
            -2.053241729736328,
            0.6985702514648438,
            -2.834501266479492,
            0.25107109546661377,
            -0.4357772767543793,
            -5.052018165588379,
            5.01179313659668,
            -2.509381055831909,
            3.2083005905151367,
            0.8786059021949768,
            1.64912748336792,
            5.523933410644531,
            -4.542202949523926,
            0.280542254447937,
            3.242884874343872,
            -0.38294392824172974,
            2.7936887741088867,
            1.5530898571014404,
            -3.085798978805542,
            -0.684539794921875,
            0.3892587125301361,
            1.9959864616394043,
            -2.929774284362793,
            2.6330652236938477,
            -0.915474534034729,
            1.9207789897918701,
            2.6522743701934814,
            -1.8568713665008545,
            -0.6483449935913086,
            -0.2777617573738098,
            3.1301863193511963,
            -0.09014397859573364,
            1.8419439792633057,
            2.064133405685425,
            3.057168960571289,
            2.030423164367676,
            2.7290220260620117,
            1.7826398611068726,
            3.0453834533691406,
            -1.1564826965332031,
            0.9206559062004089,
            6.757840156555176,
            1.92839777469635,
            -1.795629620552063,
            -1.022189974784851,
            -2.421220302581787,
            0.8297163844108582,
            -0.1436784267425537,
            -4.311284065246582,
            -1.9775416851043701,
            0.586014986038208,
            -4.081354141235352,
            0.34820353984832764,
            -1.750950574874878,
            -0.0063500553369522095,
            5.130954742431641,
            -3.065073013305664,
            -0.2619505226612091,
            2.8717517852783203,
            -3.7236340045928955,
            -1.9288139343261719,
            0.5514347553253174,
            -1.9727668762207031,
            -2.1612679958343506,
            -0.23380035161972046,
            1.4875634908676147,
            0.3461032211780548,
            0.20867587625980377,
            -2.0278916358947754,
            1.177585244178772,
            -0.8375490307807922,
            -0.6997289657592773,
            -2.8976492881774902,
            1.1275525093078613,
            0.6222600936889648,
            -2.091648578643799,
            -1.8401298522949219,
            0.21145856380462646,
            -2.417998790740967,
            -1.7584037780761719,
            -3.8048954010009766,
            -2.644902229309082,
            1.1907702684402466,
            -5.047061920166016,
            -1.198548674583435,
            1.621103048324585,
            0.18620312213897705,
            -0.6638370752334595,
            -3.366197109222412,
            -2.6624817848205566,
            0.09995383024215698,
            1.321828842163086,
            -1.7240091562271118,
            3.3647336959838867,
            -1.4594321250915527,
            -3.528512477874756,
            -5.042936325073242,
            3.873525619506836,
            1.523677945137024,
            4.7331695556640625,
            1.6400299072265625,
            1.380660057067871,
            -1.828840970993042,
            -4.694645404815674,
            -0.08824506402015686,
            -0.9757145643234253,
            3.20025372505188,
            0.696968674659729,
            4.922109603881836,
            1.796028733253479,
            -2.0673398971557617,
            1.7152554988861084,
            -5.746367454528809,
            -0.6055905818939209,
            4.123328685760498,
            1.3105010986328125,
            1.5020489692687988,
            6.751854419708252,
            2.42327880859375,
            1.198278546333313,
            -2.3404295444488525,
            1.5601048469543457,
            0.7124236822128296,
            3.454221725463867,
            3.5741591453552246,
            -2.1137895584106445,
            2.6739320755004883,
            1.393288493156433,
            0.1966056525707245,
            1.0302821397781372,
            -5.479058265686035,
            2.4697508811950684,
            0.47786277532577515,
            0.44157305359840393,
            0.25182420015335083,
            0.8023609519004822,
            -7.503789901733398,
            0.4801688492298126,
            4.814165115356445,
            -2.4520955085754395,
            0.548115074634552,
            0.617484450340271,
            -1.4706683158874512,
            4.736471176147461,
            2.5402255058288574,
            -0.3096466660499573,
            1.942335844039917,
            3.543381452560425,
            3.0218517780303955,
            4.209201812744141,
            2.808436393737793,
            -4.24889612197876,
            -0.8130120038986206,
            0.3617819547653198,
            -1.3508992195129395,
            -0.32087212800979614,
            -3.274467945098877,
            1.6828515529632568,
            -4.323439121246338,
            0.27846479415893555,
            -2.1243300437927246,
            0.7434210777282715,
            -2.3639211654663086,
            -0.2587307095527649,
            3.349888563156128,
            1.3862706422805786,
            4.611400127410889,
            3.228123188018799,
            -0.20354652404785156,
            0.34808349609375,
            0.4483763575553894,
            1.6064151525497437,
            -2.3589959144592285,
            2.221754550933838,
            4.523390769958496,
            1.6172033548355103,
            -3.1316003799438477,
            -2.1083884239196777,
            1.4379233121871948,
            0.8300061225891113,
            -4.118093490600586,
            2.927051067352295,
            -0.09297573566436768,
            -1.509416103363037,
            -1.046776294708252,
            -1.9169440269470215,
            -0.12264138460159302,
            3.5201220512390137,
            -2.5238547325134277,
            -2.6851186752319336,
            -3.104215383529663,
            0.6050076484680176,
            4.020633697509766,
            1.5360348224639893,
            1.093062400817871,
            0.6998975872993469,
            -1.5283100605010986,
            -6.062124252319336,
            4.304076194763184,
            -5.140833377838135,
            4.461051940917969,
            4.466255187988281,
            3.6464719772338867,
            4.965092658996582,
            3.6248602867126465,
            -6.670288562774658,
            -1.4118661880493164,
            0.5264997482299805,
            -4.223825454711914,
            0.15914463996887207,
            -3.2940890789031982,
            -0.05289572477340698,
            0.6210982799530029,
            -1.109704613685608,
            7.6716389656066895,
            1.6926839351654053,
            2.7967817783355713,
            -1.1207388639450073,
            3.5469250679016113,
            -1.5074272155761719,
            -2.5346126556396484,
            -2.114675760269165,
            0.05584093928337097,
            -2.3930540084838867,
            0.2435397505760193,
            -0.08502143621444702,
            5.223666191101074,
            -7.022411346435547,
            -1.0773887634277344,
            -0.7742966413497925,
            1.619126558303833,
            -1.288068413734436,
            2.494488000869751,
            1.8219140768051147,
            -4.769382476806641,
            2.54061222076416,
            1.4498786926269531,
            2.4426279067993164,
            -0.7297881841659546,
            -0.6058546304702759,
            -4.990915775299072,
            -2.300809383392334,
            -1.0856163501739502,
            1.8340914249420166,
            0.7202352285385132,
            3.309018611907959,
            -2.418765068054199,
            -2.871687173843384,
            -5.2528181076049805,
            -5.033596992492676,
            -2.962881565093994,
            -0.29438039660453796,
            3.1813302040100098,
            3.3630356788635254,
            -0.5469391942024231,
            -2.1110846996307373,
            -3.5058255195617676,
            -2.3804931640625,
            -3.819693088531494,
            -0.08543896675109863,
            -2.333359956741333,
            -2.9423441886901855,
            -1.5920475721359253,
            0.9721324443817139,
            -6.161610126495361,
            0.6415743827819824,
            -2.782949924468994,
            4.797778129577637,
            -3.0417275428771973,
            5.506099700927734,
            3.756127119064331,
            2.087766170501709,
            -0.4286823272705078,
            0.32546234130859375,
            -0.7222676873207092,
            3.1648597717285156,
            2.5997891426086426,
            -1.7242579460144043,
            3.3961119651794434,
            3.991708755493164,
            1.0495545864105225,
            -1.35969877243042,
            -1.2200820446014404,
            -2.1027817726135254,
            -3.9078855514526367,
            -1.615763545036316,
            3.7127418518066406,
            -4.067259788513184,
            1.333810567855835,
            -3.7285704612731934,
            0.21538445353507996,
            0.9220921993255615,
            -1.5420657396316528,
            2.488609552383423,
            2.465402603149414,
            1.5928221940994263,
            -5.476238250732422,
            -2.221177339553833,
            0.4310341477394104,
            -1.7351621389389038,
            2.1333203315734863,
            1.5310629606246948,
            -0.763856053352356,
            4.764789581298828,
            -0.3529413044452667,
            2.448274612426758,
            2.493690013885498,
            3.3118093013763428,
            1.6028465032577515,
            -2.3846912384033203,
            0.15462103486061096,
            -0.7053194046020508,
            -0.5049096941947937,
            0.015234708786010742,
            4.506279945373535,
            5.01023530960083,
            0.6814190745353699,
            4.8800811767578125,
            -0.11463701725006104,
            -0.6282945275306702,
            4.392638683319092,
            -2.971642017364502,
            0.5739902853965759,
            -3.8201777935028076,
            2.816086769104004,
            0.3349282145500183,
            3.0829968452453613,
            -2.476555109024048,
            1.13966965675354,
            3.0605309009552,
            3.459240674972534,
            -1.7922371625900269,
            4.7390336990356445,
            3.046642541885376,
            1.5492067337036133,
            -4.7950439453125,
            -0.5702834129333496,
            -4.3876566886901855,
            2.896498680114746,
            -2.9648213386535645,
            10.126465797424316,
            1.672792911529541,
            0.7421829700469971,
            0.5569086074829102,
            -3.3670971393585205,
            -0.742530345916748,
            -1.3107938766479492,
            1.3703222274780273,
            -0.9514390826225281,
            -0.13192909955978394,
            2.3696722984313965,
            -0.632516086101532,
            1.5238078832626343,
            0.5565075278282166,
            1.8196589946746826,
            4.149798393249512,
            2.7863969802856445,
            3.984363079071045,
            0.5814887285232544,
            -2.602172374725342,
            -0.2603875696659088,
            3.047492504119873,
            4.32934045791626,
            -0.22362279891967773,
            -2.8150384426116943,
            2.031540870666504,
            1.9737131595611572,
            2.089916944503784,
            -3.4024569988250732,
            -4.277815818786621,
            -6.154497146606445,
            -4.96474027633667,
            2.517775535583496,
            1.559623122215271,
            2.1048667430877686,
            -0.10351620614528656,
            5.474432945251465,
            3.8361399173736572,
            -2.320462226867676,
            -2.238088607788086,
            2.032241106033325,
            -0.8335492610931396,
            0.6857023239135742,
            1.5523625612258911,
            -5.275535583496094,
            0.6469706296920776,
            -2.455657482147217,
            -2.630079746246338,
            -0.9903668165206909,
            -1.3770815134048462,
            0.4667196273803711,
            5.243474960327148,
            1.4625604152679443,
            0.7268426418304443,
            -0.875226616859436,
            1.7088313102722168,
            2.772789478302002,
            0.779718279838562,
            -3.0030949115753174,
            4.581167697906494,
            3.272588014602661,
            1.8826653957366943,
            -1.3478031158447266,
            1.1055011749267578,
            -1.8839483261108398,
            5.259049415588379,
            -0.06371912360191345,
            1.6642091274261475,
            -2.1031711101531982,
            0.673588752746582,
            2.5938522815704346,
            1.9419972896575928,
            3.009594440460205,
            0.4705583453178406,
            0.8254877328872681,
            3.991844654083252,
            -0.7763772010803223,
            4.776730060577393,
            0.0984906554222107,
            -1.8918377161026,
            0.5393631458282471,
            0.010479748249053955,
            -0.21326327323913574,
            -2.575033187866211,
            2.2692534923553467,
            -6.144016265869141,
            -0.3355194926261902,
            1.7261083126068115,
            3.073068141937256,
            -1.311790108680725,
            -4.696538925170898,
            0.48059359192848206,
            1.0049090385437012,
            0.23404330015182495,
            -3.5989649295806885,
            0.7880577445030212,
            2.319364070892334,
            0.9068284034729004,
            1.2159693241119385,
            3.741328239440918,
            -0.13758957386016846,
            -2.6475377082824707,
            -2.906677484512329,
            -2.1700680255889893,
            5.0361151695251465,
            -1.0602649450302124,
            0.02008262276649475,
            -3.525163173675537,
            -1.8971567153930664,
            -2.639005184173584,
            1.7526426315307617,
            2.2397994995117188,
            -1.274808645248413,
            -4.704941272735596,
            -3.213141918182373,
            -0.08709201216697693,
            3.8694324493408203,
            -1.402365803718567,
            -1.3765594959259033,
            2.273383617401123,
            3.642643451690674,
            3.5599546432495117,
            2.6725597381591797,
            4.2355451583862305,
            -2.441837787628174,
            -0.8801842927932739,
            4.00937032699585,
            -3.3185675144195557,
            3.687950372695923,
            -0.6941767930984497,
            -1.6750032901763916,
            0.6116273403167725,
            6.726661682128906,
            -2.2828755378723145,
            -2.5275943279266357,
            -3.8919315338134766,
            -2.2948482036590576,
            -0.22846736013889313,
            -0.6889418959617615,
            1.0634125471115112,
            3.705272674560547,
            5.806697368621826,
            -0.3079048991203308,
            1.379451870918274,
            0.6429999470710754,
            -2.039200782775879,
            -4.14561653137207,
            0.8329038619995117,
            -0.05385309457778931,
            1.885101318359375,
            1.5461418628692627,
            -2.6867575645446777,
            3.3842482566833496,
            2.20748233795166,
            -0.7844911217689514,
            0.30174481868743896,
            1.02586030960083,
            4.242694854736328,
            -1.5728609561920166,
            2.5931918621063232,
            -4.813645362854004,
            2.297417640686035,
            0.7230696678161621,
            4.192343711853027,
            6.395285606384277,
            1.0292963981628418,
            -0.10093340277671814,
            -1.6239800453186035,
            -2.986741065979004,
            -2.6377224922180176,
            1.0476173162460327,
            2.1370198726654053,
            -2.599966526031494,
            1.4635703563690186,
            1.8388097286224365,
            0.9846711158752441,
            2.784031867980957,
            -2.173921585083008,
            -2.9913487434387207,
            -0.8096110820770264,
            -2.8883256912231445,
            -3.1967697143554688,
            -1.0908987522125244,
            -0.16403907537460327,
            1.8589880466461182,
            1.4912742376327515,
            -1.0600098371505737,
            -4.329639434814453,
            -0.7210123538970947,
            -2.440467596054077,
            -1.3058103322982788,
            -2.4398646354675293,
            -1.016364336013794,
            5.697527885437012,
            -0.2514580488204956,
            -0.8928576111793518,
            1.4222363233566284,
            1.208047866821289,
            -3.3884878158569336,
            -1.2807260751724243,
            0.5682158470153809,
            1.6519575119018555,
            -2.116346597671509,
            -3.089127540588379,
            -1.9990367889404297,
            -5.315062522888184,
            1.884511113166809,
            2.493781805038452,
            -1.296152949333191,
            2.233262062072754,
            4.441908836364746,
            -0.49253106117248535,
            -4.828041076660156,
            0.31569111347198486,
            -4.931095123291016,
            -0.9274338483810425,
            -5.112733840942383,
            -4.76147985458374,
            4.260260581970215,
            -5.215870380401611,
            -5.8979268074035645,
            2.102457284927368,
            -1.790755033493042,
            0.1640165150165558,
            -0.23000121116638184,
            -2.3149375915527344,
            -1.1409690380096436,
            -4.349117279052734,
            -2.228641986846924,
            -3.3127970695495605,
            -0.48090630769729614,
            -0.6693956851959229,
            -1.667297601699829,
            -2.068524122238159,
            4.921797752380371,
            4.147465229034424,
            2.3210911750793457,
            1.8981447219848633,
            -2.901738166809082,
            2.468651056289673,
            3.321383476257324,
            -0.33980312943458557,
            -0.7092705965042114,
            0.6144458055496216,
            -0.7112852334976196,
            2.056025981903076,
            14.327072143554688,
            -3.2954630851745605,
            -3.328528881072998,
            -4.791906356811523,
            1.3721363544464111,
            -2.981734275817871,
            -3.554901361465454,
            4.063790321350098,
            1.9928240776062012,
            5.076719284057617,
            0.6582134962081909,
            -0.9954274296760559,
            2.412275791168213,
            0.8252968788146973,
            -4.238403797149658,
            3.35622501373291,
            -0.7152886986732483,
            4.7606658935546875,
            -1.9223783016204834,
            -1.7939910888671875,
            -0.1333465427160263,
            2.4186956882476807,
            2.4894559383392334,
            0.06930267810821533,
            -5.667364120483398,
            4.171313285827637,
            -1.8948030471801758,
            2.3580760955810547,
            -2.833608627319336,
            0.5006273984909058,
            0.2971688508987427,
            1.9958235025405884,
            3.1792421340942383,
            -0.23249931633472443,
            -1.3168890476226807,
            -0.17090506851673126,
            4.546961784362793,
            -4.375916004180908,
            3.3493664264678955,
            0.3526337146759033,
            -2.607616901397705,
            3.0694539546966553,
            -3.5065066814422607,
            -1.813779592514038,
            1.2602670192718506,
            -0.04519851505756378,
            1.9726256132125854,
            -5.318385601043701,
            -3.3913414478302,
            1.1029598712921143,
            2.646583318710327,
            3.451718807220459,
            -0.5301703810691833,
            -0.2595292329788208,
            3.132380485534668,
            6.698221206665039,
            2.2355856895446777,
            -2.771519660949707,
            3.4619436264038086,
            1.028798222541809,
            -1.7648001909255981,
            0.8527496457099915,
            -1.247918725013733,
            0.41199401021003723,
            -0.23673857748508453,
            0.3753664493560791,
            -2.84183406829834,
            3.4776194095611572,
            -0.011124685406684875,
            -1.3831781148910522,
            2.173003673553467,
            0.016531050205230713,
            3.5521039962768555,
            -3.8944625854492188,
            -3.036409616470337,
            -4.149929046630859,
            -0.9940047264099121,
            2.3392348289489746,
            1.7169629335403442,
            3.672581672668457,
            -5.685811519622803,
            0.916075587272644,
            2.4767065048217773,
            -0.664825975894928,
            4.338830947875977,
            -4.3006696701049805,
            3.995377779006958,
            -1.6623283624649048,
            -3.448154926300049,
            3.8847670555114746,
            1.0356228351593018,
            -0.6147566437721252,
            -0.5708636045455933,
            1.195194959640503,
            5.878777503967285,
            -1.7670353651046753,
            -3.4395346641540527,
            -3.3643624782562256,
            -2.097477436065674,
            -3.6850457191467285,
            3.3003153800964355,
            1.89520263671875,
            3.323857307434082,
            -3.0891358852386475,
            -0.35871702432632446,
            0.6479384303092957,
            -0.03628390282392502,
            -1.1238811016082764,
            -4.94566011428833,
            0.8731174468994141,
            2.3282735347747803,
            -5.2646098136901855,
            0.48390644788742065,
            2.110593795776367,
            0.6963551044464111,
            -3.2998149394989014,
            -1.1460890769958496,
            4.203620910644531,
            -0.012914687395095825,
            4.041595458984375,
            0.13546933233737946,
            -1.9213850498199463,
            -3.461427927017212,
            -3.944915771484375,
            -1.5474833250045776,
            1.9133539199829102,
            -0.9931843876838684,
            -1.2179298400878906,
            2.481299877166748,
            -2.7043209075927734,
            0.20058482885360718,
            -2.6722824573516846,
            -0.3102530241012573,
            -0.17805039882659912,
            -3.9331088066101074,
            -1.758543848991394,
            -0.8573839664459229,
            4.033946990966797,
            -1.8594534397125244,
            2.4358088970184326,
            4.11904239654541,
            -2.1440696716308594,
            -0.3051825761795044,
            5.221953868865967,
            -2.5478925704956055,
            -2.5761258602142334,
            -0.22827915847301483,
            -0.22030320763587952,
            0.09577146172523499,
            -0.8755367994308472,
            -3.2243289947509766,
            -0.13803398609161377,
            4.624485492706299,
            -2.587801694869995,
            -1.5043761730194092,
            -2.5119690895080566
        ]
    },
    "authors": [
        {
            "authorId": "2312700934",
            "name": "Juncan Deng"
        },
        {
            "authorId": "2282161054",
            "name": "Shuaiting Li"
        },
        {
            "authorId": "2259359079",
            "name": "Zeyu Wang"
        },
        {
            "authorId": "2320075178",
            "name": "Hong Gu"
        },
        {
            "authorId": "2319405953",
            "name": "Kedong Xu"
        },
        {
            "authorId": "2261914788",
            "name": "Kejie Huang"
        }
    ],
    "references": []
}