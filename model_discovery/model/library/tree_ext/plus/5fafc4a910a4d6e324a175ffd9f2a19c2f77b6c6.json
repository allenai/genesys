{
    "paperId": "5fafc4a910a4d6e324a175ffd9f2a19c2f77b6c6",
    "externalIds": {
        "CorpusId": 271705272
    },
    "title": "Multi-task BERT Fine-Tuning with Gradient Tricks",
    "abstract": "This project explores advanced techniques for improving multi-task learning in language models, focusing on mitigating gradient conflicts and leveraging dataset imbalances. We used a combination of four primary methods: PCGrad, sample-weighted PCGrad, two-step fine-tuning, and model ensemble. PCGrad, a technique that projects conflicting gradients, was used to address gradient conflicts during multi-task model fine-tuning. We introduced sample-weighted PCGrad, which extends PCGrad by proportionally scaling gradients to balance tasks with differing dataset sizes. We also introduced a two-step fine-tuning process inspired by meta-learning, where a model is first trained on multiple tasks and then fine-tuned separately for each task to specialize on individual tasks further. Finally, we utilized a model ensemble to aggregate predictions from the best-performing models, enhancing overall accuracy. We implemented and evaluated these methods using three tasks: sentiment analysis, paraphrase detection, and textual similarity. Our experimental results show that sample-weighted PCGrad combined with two-step fine-tuning achieved significant performance improvements over the baselines. The model ensemble approach further boosted the predictive performance across all tasks. Our best model achieved an overall test score of 0.792, ranking fifth on the test leaderboard.",
    "venue": "",
    "year": null,
    "referenceCount": 6,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": null
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -3.0628550052642822,
            -3.8708608150482178,
            -2.6125526428222656,
            4.59031343460083,
            0.12134340405464172,
            0.7547518014907837,
            0.003873586654663086,
            -2.6020116806030273,
            -2.5167081356048584,
            -0.14649254083633423,
            -1.289300560951233,
            2.949467658996582,
            -0.7974405288696289,
            -0.41907551884651184,
            -3.1688785552978516,
            1.7534844875335693,
            2.1064162254333496,
            2.1732542514801025,
            4.472673416137695,
            1.512174367904663,
            -2.263641595840454,
            2.5160064697265625,
            -0.8741394877433777,
            -1.6641950607299805,
            -2.8914589881896973,
            -1.8604192733764648,
            3.5836338996887207,
            1.872822642326355,
            -1.926998496055603,
            -0.7825254797935486,
            3.309687614440918,
            -9.494698524475098,
            4.3452043533325195,
            -2.400447130203247,
            4.362100124359131,
            -3.6674065589904785,
            -0.38435739278793335,
            10.631145477294922,
            -2.2079672813415527,
            -0.8435088396072388,
            -1.272731065750122,
            0.9917908906936646,
            1.8462634086608887,
            -0.3415796756744385,
            1.6201927661895752,
            -0.6750232577323914,
            1.4223754405975342,
            2.2953598499298096,
            0.22768256068229675,
            2.626600742340088,
            1.2523224353790283,
            0.1906297206878662,
            -1.9889976978302002,
            -0.23650243878364563,
            2.1052327156066895,
            -0.5995608568191528,
            0.9348821640014648,
            -0.320493221282959,
            1.7268866300582886,
            -2.1601145267486572,
            3.1975038051605225,
            2.8940610885620117,
            -1.636110782623291,
            2.4750852584838867,
            2.8393025398254395,
            -0.8986139297485352,
            -0.5302031636238098,
            6.834693908691406,
            1.7380073070526123,
            1.2020522356033325,
            -0.5400731563568115,
            -2.9570159912109375,
            2.567646026611328,
            1.4051918983459473,
            -1.5080770254135132,
            1.1963768005371094,
            1.1286356449127197,
            -6.141692161560059,
            -2.6054608821868896,
            1.4098162651062012,
            -0.4518776834011078,
            1.6402587890625,
            0.5250526070594788,
            1.6066346168518066,
            3.869253635406494,
            -1.5924875736236572,
            -3.217383623123169,
            1.2882027626037598,
            1.7406201362609863,
            -3.655900001525879,
            -1.167580008506775,
            2.888749837875366,
            -1.4607059955596924,
            4.258798599243164,
            -4.024824142456055,
            -0.45834729075431824,
            -0.5768855810165405,
            1.1830060482025146,
            -0.8431693911552429,
            0.920972466468811,
            3.7368950843811035,
            -0.9544994831085205,
            0.9849643111228943,
            0.6711791157722473,
            4.620268821716309,
            -4.8044586181640625,
            -0.8823174834251404,
            1.5869946479797363,
            0.14008325338363647,
            -3.139327049255371,
            -2.3063511848449707,
            2.7262027263641357,
            1.297895908355713,
            1.3852291107177734,
            -2.3742880821228027,
            -2.1711537837982178,
            -3.2278614044189453,
            -2.873701572418213,
            -0.761894702911377,
            4.819382190704346,
            -0.8116894960403442,
            -2.870601177215576,
            -3.7100319862365723,
            -0.8501270413398743,
            -0.9079172015190125,
            0.1929711401462555,
            -1.45851731300354,
            -0.33106887340545654,
            -2.491583824157715,
            -5.752622127532959,
            4.779617786407471,
            -0.962225079536438,
            3.5296452045440674,
            -2.734055519104004,
            2.9438462257385254,
            3.7983558177948,
            -5.021467685699463,
            0.7637109756469727,
            -0.8691011071205139,
            -0.7917309999465942,
            -1.7761890888214111,
            0.649787425994873,
            0.9477927088737488,
            1.5192939043045044,
            2.228144645690918,
            3.0334649085998535,
            0.7333157062530518,
            -1.229349136352539,
            0.9462168216705322,
            3.006711006164551,
            5.66510009765625,
            -1.8065279722213745,
            0.5417706966400146,
            2.343283176422119,
            0.013664692640304565,
            1.9181543588638306,
            -2.327610969543457,
            -1.3139406442642212,
            0.7228941917419434,
            0.8822810649871826,
            1.9924843311309814,
            -1.9237860441207886,
            -6.335715293884277,
            1.7329121828079224,
            3.979219913482666,
            -4.988776206970215,
            -1.746859073638916,
            1.4491130113601685,
            2.9616870880126953,
            1.446325659751892,
            -2.0918800830841064,
            0.29265689849853516,
            3.2642688751220703,
            1.93391752243042,
            2.04457426071167,
            -1.4681346416473389,
            -0.5211328268051147,
            -1.7243406772613525,
            -2.140209197998047,
            1.3356348276138306,
            0.4353058338165283,
            -1.4599900245666504,
            -3.4993088245391846,
            1.8302032947540283,
            -6.390584945678711,
            -1.320459246635437,
            -3.679771900177002,
            -3.4330973625183105,
            -1.3480029106140137,
            0.484149307012558,
            -1.7982131242752075,
            2.204453945159912,
            5.002058029174805,
            3.185852289199829,
            3.937913417816162,
            1.5927884578704834,
            4.395589828491211,
            1.5636917352676392,
            -1.7849979400634766,
            -0.06884674727916718,
            1.2479768991470337,
            -1.5036650896072388,
            3.0845930576324463,
            -2.026175022125244,
            4.365811347961426,
            0.8459537029266357,
            -0.5026193261146545,
            1.3543436527252197,
            -0.028219759464263916,
            -0.0490756630897522,
            1.0479037761688232,
            0.2681061029434204,
            -2.2787842750549316,
            -1.2422730922698975,
            -1.816931962966919,
            -4.2104692459106445,
            -4.019948959350586,
            5.544106960296631,
            3.0628538131713867,
            1.9168689250946045,
            -0.474678635597229,
            0.3675823509693146,
            2.193258285522461,
            -5.66601037979126,
            0.2889288067817688,
            -4.450465202331543,
            0.8398241996765137,
            0.40885424613952637,
            -1.765618085861206,
            0.4983184337615967,
            -0.648524284362793,
            -3.3753502368927,
            -1.0984890460968018,
            -2.3411622047424316,
            -2.245421886444092,
            -3.654757261276245,
            -4.360705375671387,
            1.5360329151153564,
            -2.2696733474731445,
            -1.8760986328125,
            7.928134918212891,
            -1.6280195713043213,
            0.37762370705604553,
            6.652674674987793,
            4.559027194976807,
            -0.34400397539138794,
            -3.3530068397521973,
            -0.0978158712387085,
            -1.6715033054351807,
            2.019876480102539,
            3.6026270389556885,
            -2.220329999923706,
            2.4440550804138184,
            0.5759860873222351,
            2.5221428871154785,
            4.305336952209473,
            0.6700702905654907,
            0.1943087875843048,
            0.5699658393859863,
            1.7108827829360962,
            2.696115732192993,
            7.6413702964782715,
            4.061188220977783,
            5.096040725708008,
            0.5216903686523438,
            1.2890945672988892,
            -1.7593215703964233,
            -3.0314221382141113,
            -2.3139379024505615,
            3.8621459007263184,
            3.064680337905884,
            0.6807719469070435,
            0.9470518231391907,
            -5.089324951171875,
            -1.9169472455978394,
            -4.65654182434082,
            0.127414733171463,
            -3.6493117809295654,
            -0.5110047459602356,
            2.4825592041015625,
            1.1025402545928955,
            2.325460195541382,
            -1.9598438739776611,
            -2.037173271179199,
            -0.26713863015174866,
            -5.091030597686768,
            -6.571568965911865,
            -0.14403647184371948,
            -1.0389221906661987,
            -2.3234009742736816,
            -3.063432216644287,
            3.1455440521240234,
            -3.575389862060547,
            0.9264795780181885,
            1.5183175802230835,
            3.6674652099609375,
            3.2515995502471924,
            -1.0686113834381104,
            -2.1743545532226562,
            -1.4697320461273193,
            -1.0629528760910034,
            1.3802828788757324,
            2.377681255340576,
            1.0317742824554443,
            1.6558917760849,
            2.5714969635009766,
            0.6091701984405518,
            0.14317749440670013,
            -1.0569555759429932,
            -1.2678937911987305,
            1.0274291038513184,
            2.7295260429382324,
            3.491694450378418,
            -2.6810531616210938,
            -0.49723005294799805,
            -0.1237955093383789,
            -0.8648068904876709,
            0.03979578614234924,
            -3.925955295562744,
            -0.03847844898700714,
            -1.5714493989944458,
            -3.658360004425049,
            -0.8547484874725342,
            0.4634143114089966,
            -1.5329891443252563,
            0.9176011085510254,
            1.3890963792800903,
            3.371213436126709,
            -1.7049098014831543,
            0.7855653762817383,
            -2.8458991050720215,
            5.407059669494629,
            -0.5187679529190063,
            1.860154628753662,
            0.9220374226570129,
            -4.161780834197998,
            -3.0966053009033203,
            -2.2765493392944336,
            4.27078914642334,
            4.040894508361816,
            0.451414555311203,
            2.5078423023223877,
            -1.989278793334961,
            -0.46574532985687256,
            -2.507974147796631,
            -0.47877493500709534,
            -2.3125293254852295,
            -2.5417678356170654,
            -0.8446309566497803,
            -2.7552764415740967,
            2.883002281188965,
            1.465927243232727,
            0.3611413240432739,
            0.12908339500427246,
            2.4876747131347656,
            3.2868196964263916,
            3.6953248977661133,
            -0.09607800841331482,
            2.0567574501037598,
            3.8483524322509766,
            -0.7501479387283325,
            -1.8276641368865967,
            -1.7653393745422363,
            0.8957080245018005,
            2.041775941848755,
            -3.227509021759033,
            8.020116806030273,
            1.1653345823287964,
            4.446784973144531,
            -1.1678582429885864,
            -3.0170950889587402,
            -4.953586578369141,
            -2.803022623062134,
            4.519012451171875,
            -2.563951015472412,
            -1.7365409135818481,
            0.14355206489562988,
            -1.5336997509002686,
            0.5453221201896667,
            3.4305434226989746,
            0.8869584202766418,
            4.388859748840332,
            -0.6759008765220642,
            2.4150047302246094,
            -1.360393762588501,
            -1.226386308670044,
            -1.4293848276138306,
            4.1529951095581055,
            -0.1475120633840561,
            0.7779091596603394,
            -0.9307163953781128,
            -0.7758083343505859,
            0.25759899616241455,
            1.7745225429534912,
            0.3777843713760376,
            2.189629316329956,
            -0.5818984508514404,
            0.1804347038269043,
            -0.9727722406387329,
            -1.5194611549377441,
            -0.4368392825126648,
            2.582268238067627,
            3.205765724182129,
            3.9522931575775146,
            -7.615289688110352,
            -1.3968695402145386,
            5.855915546417236,
            -3.2105438709259033,
            -2.520090103149414,
            3.1181843280792236,
            1.397648572921753,
            -1.9771838188171387,
            -2.373039722442627,
            -4.889768123626709,
            -2.1276044845581055,
            -0.8009806871414185,
            2.728635311126709,
            2.539074420928955,
            3.5523855686187744,
            1.4501762390136719,
            -2.0499048233032227,
            5.6942830085754395,
            6.1277337074279785,
            3.0287580490112305,
            -0.7728728652000427,
            -0.7131065130233765,
            2.521179676055908,
            -1.043809413909912,
            -2.247281551361084,
            4.7802019119262695,
            0.6402478814125061,
            5.177797794342041,
            -3.062502145767212,
            -2.493159770965576,
            0.8778814077377319,
            2.7421064376831055,
            2.656503677368164,
            1.2674143314361572,
            0.9571517705917358,
            -2.6939809322357178,
            -0.8126773834228516,
            4.749274253845215,
            -2.2337887287139893,
            8.68712043762207,
            -0.3510846793651581,
            4.34102725982666,
            0.5160127878189087,
            1.7737300395965576,
            -0.026786357164382935,
            -0.191800057888031,
            2.167025327682495,
            -3.995333671569824,
            -0.8226216435432434,
            -4.168984413146973,
            0.24501341581344604,
            -0.9968270063400269,
            -5.4054341316223145,
            -2.387053966522217,
            -0.4203682541847229,
            2.185957908630371,
            -4.383597373962402,
            7.824143409729004,
            -3.1749541759490967,
            0.13694503903388977,
            -1.827304482460022,
            -1.6391520500183105,
            -0.12324938178062439,
            -1.6243574619293213,
            -0.06416446715593338,
            -0.9876735210418701,
            2.69000506401062,
            -0.3922785520553589,
            -2.464228391647339,
            2.1555612087249756,
            2.260727882385254,
            0.22139474749565125,
            2.274782180786133,
            -1.9791386127471924,
            2.2530601024627686,
            -3.3917908668518066,
            -1.1907715797424316,
            -1.545583963394165,
            4.533497333526611,
            -3.564164638519287,
            -1.368996262550354,
            6.971539497375488,
            3.1158738136291504,
            2.0757975578308105,
            2.64308762550354,
            2.7812771797180176,
            3.0068440437316895,
            3.103876829147339,
            5.310565948486328,
            0.7126703262329102,
            0.733944833278656,
            -1.1626825332641602,
            -3.3089661598205566,
            1.5116028785705566,
            0.4411841928958893,
            -2.610264301300049,
            1.776680588722229,
            -0.3793458342552185,
            1.1393784284591675,
            -4.141960144042969,
            -3.5994887351989746,
            4.535355567932129,
            5.1305742263793945,
            1.673057198524475,
            -2.7887120246887207,
            -2.3053362369537354,
            -1.1088309288024902,
            -1.8053350448608398,
            -4.124037742614746,
            1.5867875814437866,
            -2.126006841659546,
            0.3914635479450226,
            4.595178604125977,
            -2.219684600830078,
            -2.3444786071777344,
            0.41887348890304565,
            0.49450406432151794,
            -4.215434551239014,
            -2.2455453872680664,
            -0.696042537689209,
            2.1086082458496094,
            1.8314733505249023,
            -1.8288217782974243,
            0.015432372689247131,
            0.7218279838562012,
            4.1273908615112305,
            4.047656059265137,
            4.637640476226807,
            3.5576138496398926,
            -1.8426002264022827,
            0.6553075909614563,
            -0.5178335905075073,
            1.2731820344924927,
            3.1016855239868164,
            -3.059105396270752,
            -0.8296180963516235,
            0.19111821055412292,
            0.8480799198150635,
            -3.801374912261963,
            3.362459182739258,
            1.217560052871704,
            -0.2722211182117462,
            -4.515286922454834,
            -4.233880519866943,
            0.04900401830673218,
            1.5171658992767334,
            1.819434642791748,
            -3.4446518421173096,
            1.9669501781463623,
            -2.306063175201416,
            -1.3720650672912598,
            -1.402953863143921,
            -0.15196847915649414,
            -2.836048126220703,
            -1.2190839052200317,
            2.2334117889404297,
            2.47202467918396,
            -1.282267689704895,
            1.8631374835968018,
            2.2739455699920654,
            -0.16202616691589355,
            -2.733888626098633,
            -4.707035064697266,
            4.323071479797363,
            1.1030080318450928,
            0.09307265281677246,
            -2.59607195854187,
            -2.830639362335205,
            -1.2443747520446777,
            -0.3344310522079468,
            0.25555741786956787,
            0.8850323557853699,
            3.126328945159912,
            3.840677261352539,
            -0.2499321699142456,
            -2.5031044483184814,
            -4.0927510261535645,
            -1.2182765007019043,
            -3.4646501541137695,
            -6.528874397277832,
            1.2383623123168945,
            -6.519615173339844,
            -1.8126013278961182,
            1.6925232410430908,
            -4.965322494506836,
            -0.44192075729370117,
            4.652359485626221,
            3.2718615531921387,
            1.656790018081665,
            -4.272418022155762,
            -0.7804595232009888,
            -3.3577752113342285,
            4.073002815246582,
            1.9581413269042969,
            0.5668243765830994,
            0.8667667508125305,
            -1.5183640718460083,
            4.348897933959961,
            2.5648488998413086,
            2.922274112701416,
            -3.00767183303833,
            -1.3925538063049316,
            1.5384340286254883,
            -0.8921868801116943,
            -1.9672486782073975,
            -0.013288795948028564,
            1.9180550575256348,
            1.8329557180404663,
            15.784835815429688,
            -0.14681529998779297,
            2.8643505573272705,
            -0.5310551524162292,
            -1.9467921257019043,
            -2.5507431030273438,
            -3.8492910861968994,
            3.006554126739502,
            1.1788769960403442,
            0.9304101467132568,
            -1.3929979801177979,
            -4.625521659851074,
            -2.3742563724517822,
            -0.2352035939693451,
            -3.3798155784606934,
            -1.1810808181762695,
            -3.9028754234313965,
            1.0541422367095947,
            -2.1915154457092285,
            0.29881107807159424,
            1.2599332332611084,
            2.3277056217193604,
            -2.443336248397827,
            -3.3567910194396973,
            0.6909233331680298,
            4.100499153137207,
            0.13001707196235657,
            2.5048036575317383,
            -2.4583921432495117,
            -1.1911364793777466,
            1.541567325592041,
            2.833261489868164,
            -3.38247013092041,
            6.731457710266113,
            -1.2099097967147827,
            3.9733049869537354,
            0.5525082349777222,
            -4.910760879516602,
            -0.847098708152771,
            0.18275786936283112,
            -0.9562843441963196,
            -0.6441147327423096,
            -0.920795738697052,
            -1.3702609539031982,
            -1.5740885734558105,
            -0.14206582307815552,
            0.09434697031974792,
            -2.132521629333496,
            -3.172933340072632,
            5.097040176391602,
            1.04942786693573,
            -1.365870475769043,
            1.4359800815582275,
            2.0877106189727783,
            3.0087997913360596,
            -0.3294389843940735,
            0.6794856786727905,
            -2.900027275085449,
            2.0267043113708496,
            5.031591415405273,
            -1.3092615604400635,
            1.0827374458312988,
            -3.5760512351989746,
            -4.265707492828369,
            -3.051395893096924,
            0.1327090859413147,
            -2.9386773109436035,
            2.115999698638916,
            1.5112309455871582,
            0.5020812153816223,
            2.465845823287964,
            3.4340763092041016,
            -2.0113420486450195,
            -5.133457660675049,
            -1.5885820388793945,
            -2.9153409004211426,
            0.43573087453842163,
            -0.8891496062278748,
            1.4358737468719482,
            2.268749237060547,
            -1.5635467767715454,
            2.913085460662842,
            -0.258982390165329,
            1.7543036937713623,
            3.048438787460327,
            -2.815704107284546,
            4.779541492462158,
            -1.74122154712677,
            -4.045807361602783,
            1.1835416555404663,
            0.8431036472320557,
            3.004326105117798,
            -0.31086239218711853,
            5.014805793762207,
            4.079366683959961,
            -3.548445224761963,
            -2.9998340606689453,
            -3.117122173309326,
            -1.7392780780792236,
            -1.6560982465744019,
            4.479623794555664,
            4.478202819824219,
            1.2605119943618774,
            -2.5958471298217773,
            -2.0450174808502197,
            2.2980241775512695,
            -4.043476581573486,
            -6.424804210662842,
            0.6751348376274109,
            -0.5973519086837769,
            -0.4771421551704407,
            -3.783151626586914,
            -0.5094130039215088,
            1.1065140962600708,
            0.17368963360786438,
            -0.3044818043708801,
            1.3572670221328735,
            -0.5304624438285828,
            1.0026177167892456,
            4.897895336151123,
            2.1260032653808594,
            -1.483411431312561,
            -3.832083225250244,
            -2.3274261951446533,
            -3.492934465408325,
            0.7223384380340576,
            -1.5610039234161377,
            -0.9584302306175232,
            -0.5227063894271851,
            2.158541440963745,
            3.2333438396453857,
            -5.0812554359436035,
            -7.09599494934082,
            -2.270883083343506,
            0.30437737703323364,
            -0.5587218999862671,
            0.5865331292152405,
            4.206016540527344,
            0.6889482736587524,
            2.8358750343322754,
            3.5574545860290527,
            -2.9176840782165527,
            -0.8428926467895508,
            8.173819541931152,
            3.503225088119507,
            0.04780310392379761,
            -0.06590357422828674,
            -1.0476925373077393,
            -1.2835166454315186,
            0.17097991704940796,
            -0.45160073041915894,
            0.35108762979507446,
            3.272097110748291,
            -1.0010994672775269,
            0.15529286861419678,
            -4.18931770324707
        ]
    },
    "authors": [
        {
            "authorId": "2220791003",
            "name": "Stanford CS224N"
        },
        {
            "authorId": "2285050066",
            "name": "Default Project"
        },
        {
            "authorId": "2314766784",
            "name": "Henry Ang"
        },
        {
            "authorId": "2286882816",
            "name": "Timothy Dai"
        }
    ],
    "references": [
        {
            "paperId": "f229557011920c440b89f199d6fc334853092643",
            "title": "Multi-Task Learning as a Bargaining Game"
        },
        {
            "paperId": "74f23063ca77f5b1caa3770a5957ae5fc565843e",
            "title": "Multi-Task Learning with Deep Neural Networks: A Survey"
        },
        {
            "paperId": "020bb2ba5f3923858cd6882ba5c5a44ea8041ab6",
            "title": "Meta-Learning in Neural Networks: A Survey"
        },
        {
            "paperId": "449c5660d637741f7aa7ff42549c32b43c9968bf",
            "title": "Gradient Surgery for Multi-Task Learning"
        },
        {
            "paperId": "df2b0e26d0599ce3e70df8a9da02e51594e0e992",
            "title": "BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding"
        },
        {
            "paperId": null,
            "title": "Bert and pals: Projected attention layers for efficient adaptation in multi-task learning"
        }
    ]
}