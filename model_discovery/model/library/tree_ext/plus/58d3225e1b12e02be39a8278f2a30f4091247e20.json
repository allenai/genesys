{
    "paperId": "58d3225e1b12e02be39a8278f2a30f4091247e20",
    "externalIds": {
        "ArXiv": "2408.04278",
        "CorpusId": 271768802
    },
    "title": "LaDiMo: Layer-wise Distillation Inspired MoEfier",
    "abstract": "The advent of large language models has revolutionized natural language processing, but their increasing complexity has led to substantial training costs, resource demands, and environmental impacts. In response, sparse Mixture-of-Experts (MoE) models have emerged as a promising alternative to dense models. Since training MoE models from scratch can be prohibitively expensive, recent studies have explored leveraging knowledge from pre-trained non-MoE models. However, existing approaches have limitations, such as requiring significant hardware resources and data. We propose a novel algorithm, LaDiMo, which efficiently converts a Transformer-based non-MoE model into a MoE model with minimal additional training cost. LaDiMo consists of two stages: layer-wise expert construction and routing policy decision. By harnessing the concept of Knowledge Distillation, we compress the model and rapidly recover its performance. Furthermore, we develop an adaptive router that optimizes inference efficiency by profiling the distribution of routing weights and determining a layer-wise policy that balances accuracy and latency. We demonstrate the effectiveness of our method by converting the LLaMA2-7B model to a MoE model using only 100K tokens, reducing activated parameters by over 20% while keeping accuracy. Our approach offers a flexible and efficient solution for building and deploying MoE models.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "A novel algorithm, LaDiMo, is proposed, which efficiently converts a Transformer-based non-MoE model into a MoE model with minimal additional training cost and develops an adaptive router that optimizes inference efficiency by profiling the distribution of routing weights and determining a layer-wise policy that balances accuracy and latency."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.678874969482422,
            0.18957391381263733,
            0.7150677442550659,
            4.582045078277588,
            0.623555064201355,
            0.19976508617401123,
            0.2875182628631592,
            -1.271369218826294,
            -1.6365938186645508,
            -0.11545586585998535,
            -1.1006617546081543,
            5.400605201721191,
            -0.1686852127313614,
            -1.391495704650879,
            -3.6759209632873535,
            1.4956674575805664,
            -2.6444196701049805,
            3.3351526260375977,
            5.652365207672119,
            2.6631085872650146,
            -4.430482387542725,
            3.587131977081299,
            -1.9044380187988281,
            -0.15479779243469238,
            -3.8614752292633057,
            -1.327151894569397,
            2.952563762664795,
            1.3587760925292969,
            -0.8570038676261902,
            2.810178518295288,
            3.8754124641418457,
            -3.792341470718384,
            5.5162034034729,
            -7.762752532958984,
            2.1094212532043457,
            -4.9492950439453125,
            -2.843186855316162,
            7.931494235992432,
            -3.718214750289917,
            -0.25228169560432434,
            -1.1720495223999023,
            0.7712462544441223,
            3.6771256923675537,
            0.9347997307777405,
            0.6761876344680786,
            1.0869746208190918,
            2.2021820545196533,
            -0.42498287558555603,
            2.700136661529541,
            0.8112347722053528,
            1.3163151741027832,
            2.0000863075256348,
            -0.39711853861808777,
            2.1684765815734863,
            -2.2678890228271484,
            -0.2374984323978424,
            -0.7981017231941223,
            2.1324377059936523,
            2.1359026432037354,
            -2.395921468734741,
            3.6235971450805664,
            7.148434638977051,
            1.8700190782546997,
            0.8471997976303101,
            4.701635837554932,
            -3.247223138809204,
            -0.5508989095687866,
            5.3695831298828125,
            -0.9277617931365967,
            1.983242154121399,
            -2.2329273223876953,
            -5.945508003234863,
            -0.4787461459636688,
            1.830461025238037,
            -5.085676670074463,
            1.6515460014343262,
            -0.5896459221839905,
            -8.239980697631836,
            -0.8009257912635803,
            -0.23375405371189117,
            -0.3059171438217163,
            2.012637138366699,
            -0.5814790725708008,
            4.170012474060059,
            1.959991216659546,
            -0.6902850866317749,
            -3.467306613922119,
            0.7875653505325317,
            2.265228033065796,
            -4.735147953033447,
            -0.3994363844394684,
            0.3819509744644165,
            -1.708038330078125,
            3.345432758331299,
            -5.616751670837402,
            -0.49676916003227234,
            1.542178750038147,
            -0.7475717663764954,
            -1.388806700706482,
            0.9722468256950378,
            1.36385977268219,
            0.47409939765930176,
            3.598001480102539,
            0.13556697964668274,
            5.125356674194336,
            -3.4023427963256836,
            0.33268827199935913,
            3.0381553173065186,
            1.5966662168502808,
            -1.5061087608337402,
            -3.8205394744873047,
            2.4406704902648926,
            0.316436231136322,
            -1.2327041625976562,
            -2.2677204608917236,
            -3.237609624862671,
            -2.276527166366577,
            -1.1479276418685913,
            -2.673645257949829,
            4.028187274932861,
            -0.004229366779327393,
            0.644274115562439,
            -2.2604873180389404,
            1.7002145051956177,
            0.6288559436798096,
            -0.7782192230224609,
            -0.975849986076355,
            0.8274731636047363,
            1.1209087371826172,
            -4.242424488067627,
            3.498793601989746,
            -2.792001962661743,
            3.400620460510254,
            -3.2924842834472656,
            1.3308801651000977,
            2.558220386505127,
            -5.409355163574219,
            2.680433750152588,
            -4.054678916931152,
            -0.43737009167671204,
            -0.4655919075012207,
            4.053918838500977,
            0.6736007332801819,
            -0.06201905012130737,
            0.14606918394565582,
            2.785411834716797,
            2.172365188598633,
            3.788926124572754,
            0.14075404405593872,
            6.0052924156188965,
            5.959349632263184,
            -5.484122276306152,
            1.769232988357544,
            2.7194063663482666,
            0.9590592384338379,
            4.786285400390625,
            -4.939084529876709,
            2.121182918548584,
            -0.8929725289344788,
            1.1962792873382568,
            2.0939126014709473,
            -0.34069544076919556,
            -11.480330467224121,
            1.6260180473327637,
            3.601863384246826,
            -2.5589091777801514,
            -2.5526275634765625,
            1.7684037685394287,
            -1.6987959146499634,
            4.531551837921143,
            1.9282207489013672,
            4.2476983070373535,
            2.1365621089935303,
            4.318027019500732,
            4.0147480964660645,
            4.136962890625,
            -0.1803445816040039,
            -0.29429692029953003,
            0.5088668465614319,
            0.5764240026473999,
            -2.436474561691284,
            -1.1120271682739258,
            -3.4650349617004395,
            2.934755325317383,
            -3.9323174953460693,
            -1.7503910064697266,
            -5.179314613342285,
            -1.5803152322769165,
            -2.288506507873535,
            2.062615394592285,
            -4.702022075653076,
            0.6602528095245361,
            3.6098713874816895,
            4.318785667419434,
            1.7619283199310303,
            -0.3455740213394165,
            2.123570203781128,
            2.404244899749756,
            -3.1367554664611816,
            2.8817384243011475,
            4.467240333557129,
            0.3795838952064514,
            -2.3610715866088867,
            1.1977598667144775,
            4.142733573913574,
            1.7849148511886597,
            -2.1083712577819824,
            3.674597978591919,
            -0.7612364292144775,
            4.304071426391602,
            -0.5369909405708313,
            -2.255553960800171,
            -0.4932376742362976,
            3.7213025093078613,
            -3.4019932746887207,
            0.42312848567962646,
            -8.61785888671875,
            2.9030091762542725,
            5.064998626708984,
            2.7330541610717773,
            -1.633518099784851,
            -0.1627042293548584,
            1.7268903255462646,
            -3.5374867916107178,
            1.7718485593795776,
            -2.034390449523926,
            3.2031335830688477,
            0.35003340244293213,
            -0.9280519485473633,
            0.281745582818985,
            -2.752042055130005,
            -6.638340950012207,
            0.2578725814819336,
            -1.341806173324585,
            -5.728630542755127,
            -1.3572461605072021,
            -5.486371994018555,
            3.4729976654052734,
            -2.2735235691070557,
            -2.572458505630493,
            6.2262420654296875,
            0.5020861029624939,
            -0.33760666847229004,
            2.8150064945220947,
            2.930847644805908,
            -2.9259071350097656,
            -2.6359925270080566,
            -0.1567469835281372,
            -2.3948287963867188,
            0.5103837251663208,
            -2.3976707458496094,
            -1.3054454326629639,
            5.1080451011657715,
            -0.08010601997375488,
            1.9768797159194946,
            3.2169549465179443,
            0.6922708749771118,
            -1.9685707092285156,
            0.8435803055763245,
            -1.1361520290374756,
            1.1876580715179443,
            3.9023451805114746,
            1.285871982574463,
            5.831997871398926,
            -1.8416476249694824,
            -2.124164581298828,
            0.0020301640033721924,
            -3.1807050704956055,
            -3.356569766998291,
            1.8949289321899414,
            2.7997429370880127,
            1.180876612663269,
            -4.216999053955078,
            -7.03271484375,
            -2.3216652870178223,
            -7.435769081115723,
            -3.65244197845459,
            -0.7119461297988892,
            0.0662698745727539,
            4.548276424407959,
            0.6156140565872192,
            -2.517868995666504,
            1.8025269508361816,
            -0.737138569355011,
            -0.3827071785926819,
            -2.7626101970672607,
            -2.3827877044677734,
            0.7752482891082764,
            0.4632665514945984,
            -0.5586907863616943,
            -5.100180625915527,
            3.995687961578369,
            -5.615388870239258,
            -2.957589864730835,
            -2.4939589500427246,
            2.8702774047851562,
            4.043768882751465,
            -0.8161600828170776,
            2.285951614379883,
            0.6015841960906982,
            1.808053731918335,
            0.41949424147605896,
            1.3435598611831665,
            -0.1511654555797577,
            3.2742602825164795,
            5.305794715881348,
            1.1508588790893555,
            -2.863112449645996,
            0.7704857587814331,
            -0.8736248016357422,
            -3.4339938163757324,
            0.7183964848518372,
            3.5586280822753906,
            -5.477482795715332,
            4.33986234664917,
            2.5005245208740234,
            0.9249039888381958,
            -2.799480438232422,
            -1.0516233444213867,
            1.4379818439483643,
            1.5920783281326294,
            1.1026583909988403,
            -6.687771797180176,
            -0.9143710136413574,
            -2.378495216369629,
            -0.7274023294448853,
            0.9389065504074097,
            2.8063738346099854,
            -2.863576889038086,
            2.756563186645508,
            -4.053762912750244,
            4.486100196838379,
            5.682697296142578,
            3.185335159301758,
            -0.7051982879638672,
            -5.514103412628174,
            0.11438167095184326,
            -1.8771125078201294,
            1.2471296787261963,
            1.543321132659912,
            1.6735644340515137,
            7.359790802001953,
            -2.168147087097168,
            0.31615447998046875,
            -0.3677852153778076,
            -0.1261681318283081,
            3.6449332237243652,
            -2.021260976791382,
            -1.5466127395629883,
            -2.6953163146972656,
            -1.5911451578140259,
            1.8062238693237305,
            2.0286471843719482,
            -1.2348010540008545,
            2.851356029510498,
            6.282549858093262,
            1.538574457168579,
            3.0549633502960205,
            -0.5030110478401184,
            2.7108755111694336,
            -0.5641421675682068,
            -0.8709944486618042,
            0.7507636547088623,
            0.2578439712524414,
            2.3565001487731934,
            -0.7358203530311584,
            10.911303520202637,
            -0.4070240259170532,
            -0.5199370980262756,
            -6.802895545959473,
            -3.605984687805176,
            -3.3273813724517822,
            -5.015061378479004,
            1.820338249206543,
            -1.4704115390777588,
            -0.9757506251335144,
            1.0420684814453125,
            -3.7095775604248047,
            2.2686495780944824,
            -1.2099061012268066,
            -1.0592982769012451,
            2.3490076065063477,
            -1.7623406648635864,
            3.757294178009033,
            -1.5359965562820435,
            0.6104534268379211,
            -1.7965378761291504,
            4.116674900054932,
            0.9612677693367004,
            0.8733382821083069,
            -2.3002495765686035,
            1.3263323307037354,
            2.5029451847076416,
            1.7576680183410645,
            -4.976372241973877,
            -2.85758113861084,
            -4.678070068359375,
            -1.5508601665496826,
            -2.657625436782837,
            2.4447054862976074,
            0.5423839688301086,
            0.8087801933288574,
            5.714447975158691,
            4.073585510253906,
            -3.3503835201263428,
            -0.4982384741306305,
            5.785813808441162,
            -1.7207012176513672,
            -4.871548652648926,
            -0.9323109984397888,
            -2.99532413482666,
            -2.9297773838043213,
            -1.4304840564727783,
            -3.660893678665161,
            -0.9308167695999146,
            -3.27152156829834,
            3.210780382156372,
            1.2954928874969482,
            4.519112586975098,
            3.262357234954834,
            0.6440640687942505,
            2.39333438873291,
            5.136314868927002,
            2.4184746742248535,
            0.4485741853713989,
            0.375933974981308,
            0.28819483518600464,
            0.4667215943336487,
            -2.5552961826324463,
            3.2152185440063477,
            -0.9002365469932556,
            2.7863283157348633,
            -3.8281242847442627,
            1.1486314535140991,
            0.15028858184814453,
            4.096161365509033,
            3.736628532409668,
            2.301088333129883,
            -0.143207386136055,
            -2.318556308746338,
            2.1632401943206787,
            4.064266204833984,
            -2.773210287094116,
            4.283733367919922,
            -0.43051156401634216,
            2.1913394927978516,
            2.2895102500915527,
            0.8121036887168884,
            -1.014344334602356,
            -4.824427127838135,
            1.5599734783172607,
            -3.8990635871887207,
            -3.1421985626220703,
            -2.655928134918213,
            0.6463736891746521,
            1.2259236574172974,
            -3.0364785194396973,
            1.5173970460891724,
            -1.2495036125183105,
            0.6338589787483215,
            -5.015789031982422,
            4.973694801330566,
            -0.7749404311180115,
            3.0357608795166016,
            1.7232036590576172,
            2.9573447704315186,
            -1.2138901948928833,
            -1.525107741355896,
            -1.2558552026748657,
            -0.3468872904777527,
            1.362112045288086,
            -1.4287055730819702,
            -1.0826036930084229,
            1.207382321357727,
            -1.9184716939926147,
            -0.24153855443000793,
            3.2392709255218506,
            3.0211586952209473,
            0.5549726486206055,
            -3.1934361457824707,
            -4.3137359619140625,
            -0.8009486198425293,
            2.4943461418151855,
            -4.278088569641113,
            -1.3606534004211426,
            0.3552420735359192,
            3.692086696624756,
            2.683738946914673,
            4.367793083190918,
            1.9099295139312744,
            -0.08168429136276245,
            2.0647237300872803,
            5.633212566375732,
            -0.421547532081604,
            1.7804107666015625,
            -0.7111520767211914,
            -5.329108238220215,
            2.8973803520202637,
            1.3859314918518066,
            1.5531213283538818,
            -0.2919078469276428,
            -1.9569203853607178,
            1.5040202140808105,
            -1.535525918006897,
            -3.37461519241333,
            6.193850994110107,
            5.386944770812988,
            0.7930409908294678,
            -6.784477233886719,
            -0.6314617395401001,
            -1.5425465106964111,
            0.9932318329811096,
            -7.402260780334473,
            3.5894036293029785,
            -2.3753275871276855,
            2.5241026878356934,
            4.98488187789917,
            -1.422859787940979,
            -0.41467005014419556,
            1.2287123203277588,
            -3.593996047973633,
            -1.2716052532196045,
            -1.0884807109832764,
            1.268383502960205,
            1.3033583164215088,
            1.8733669519424438,
            -6.279607772827148,
            4.2520270347595215,
            0.6024276614189148,
            3.810236930847168,
            5.773987770080566,
            4.039632797241211,
            2.005307912826538,
            -3.6718053817749023,
            0.0611778199672699,
            -2.1643075942993164,
            2.0862715244293213,
            4.954211235046387,
            -5.0820159912109375,
            -0.9763445854187012,
            -2.357178211212158,
            1.2700527906417847,
            1.0943893194198608,
            2.280223846435547,
            -1.748049259185791,
            4.488224029541016,
            -5.034965515136719,
            0.011070221662521362,
            -4.356784820556641,
            2.1413745880126953,
            2.242699146270752,
            -4.901361465454102,
            3.393392324447632,
            -0.9079442024230957,
            -3.8361246585845947,
            -0.3594326972961426,
            -1.9074677228927612,
            -0.3178554177284241,
            -0.08493191003799438,
            1.963845133781433,
            2.177321434020996,
            1.3958561420440674,
            -0.8287141919136047,
            3.8247838020324707,
            -4.050585746765137,
            0.6027172803878784,
            -4.520564079284668,
            3.686899185180664,
            1.8312695026397705,
            -0.46169203519821167,
            0.6893094778060913,
            -2.2330245971679688,
            -0.42341697216033936,
            0.0019089430570602417,
            0.030713379383087158,
            -1.6257736682891846,
            1.7696681022644043,
            1.787433385848999,
            -3.2261791229248047,
            -1.8781886100769043,
            -4.107542991638184,
            -3.6980140209198,
            -1.5759648084640503,
            -5.026760578155518,
            -1.2430880069732666,
            -3.870284080505371,
            -2.8766229152679443,
            3.5099802017211914,
            -3.930842876434326,
            -1.414086103439331,
            3.329787492752075,
            -0.9379466772079468,
            -1.0132803916931152,
            -5.299098968505859,
            1.854669213294983,
            -3.498075485229492,
            0.2572610378265381,
            -0.9405244588851929,
            -3.3632140159606934,
            2.7055187225341797,
            1.3653515577316284,
            4.072467803955078,
            5.123215675354004,
            0.7658075094223022,
            -2.1352193355560303,
            -0.5895074009895325,
            1.806384801864624,
            0.6996533274650574,
            -2.3794164657592773,
            -0.7490184307098389,
            1.8784947395324707,
            1.8118798732757568,
            18.139842987060547,
            -1.6201409101486206,
            0.371685266494751,
            -2.1961662769317627,
            -1.8604036569595337,
            -6.18082332611084,
            -4.2052903175354,
            1.058371663093567,
            1.1712822914123535,
            1.3585909605026245,
            -2.97617769241333,
            -2.22421932220459,
            -0.010248363018035889,
            -0.9462969303131104,
            -0.9365270733833313,
            0.5899590253829956,
            -3.226447343826294,
            -0.6562848091125488,
            -2.61427640914917,
            0.46191367506980896,
            2.3952555656433105,
            0.27646884322166443,
            -2.9435253143310547,
            -1.35225248336792,
            -2.583181858062744,
            5.997149467468262,
            1.3322503566741943,
            3.384707450866699,
            -2.1528332233428955,
            -0.037200331687927246,
            1.4963698387145996,
            3.4742379188537598,
            1.0508019924163818,
            2.0717101097106934,
            -2.973193645477295,
            3.493436098098755,
            4.920428276062012,
            -0.32752692699432373,
            1.0734748840332031,
            0.9046220183372498,
            0.056148841977119446,
            -0.7832150459289551,
            -1.841752529144287,
            1.9046173095703125,
            -4.270899772644043,
            0.824647068977356,
            2.8303537368774414,
            -1.284308910369873,
            -0.407992422580719,
            4.747439384460449,
            -2.1832234859466553,
            -1.7225701808929443,
            -0.49640005826950073,
            0.2529570460319519,
            -1.543499231338501,
            3.398174285888672,
            -0.2388782501220703,
            -3.5722718238830566,
            1.7602640390396118,
            0.4413268566131592,
            -1.4484859704971313,
            0.009041011333465576,
            -3.817704677581787,
            -5.289238929748535,
            -4.617733001708984,
            1.1398558616638184,
            -2.2520835399627686,
            1.7432806491851807,
            3.333218812942505,
            3.619387149810791,
            3.1376304626464844,
            -0.47190847992897034,
            0.2834179401397705,
            -0.32416367530822754,
            0.940841794013977,
            -6.297358512878418,
            4.700066566467285,
            -2.5293004512786865,
            3.471654176712036,
            8.75606918334961,
            -0.36011719703674316,
            2.362818479537964,
            -0.4721642732620239,
            -3.5470423698425293,
            2.8512930870056152,
            -3.9128365516662598,
            3.8881795406341553,
            -0.39752012491226196,
            -2.4332404136657715,
            4.087985992431641,
            -0.5273460149765015,
            -0.9985676407814026,
            2.831235885620117,
            4.678155422210693,
            -0.027616173028945923,
            -6.431196212768555,
            -3.837703227996826,
            -4.962827682495117,
            -1.1780579090118408,
            -3.704616069793701,
            4.7467756271362305,
            3.541799545288086,
            2.3752856254577637,
            -3.743548631668091,
            -1.1753484010696411,
            -1.60068678855896,
            -2.3563928604125977,
            -8.13668441772461,
            -4.489879608154297,
            -2.5390095710754395,
            2.596255302429199,
            -1.3023748397827148,
            -1.1799485683441162,
            1.8846526145935059,
            0.4818107485771179,
            -3.3103837966918945,
            0.22858725488185883,
            2.7594339847564697,
            1.1950771808624268,
            5.677690029144287,
            0.7975913286209106,
            -1.3017747402191162,
            0.5231202840805054,
            -1.186466097831726,
            -0.03267833590507507,
            -2.056555986404419,
            -0.9843940138816833,
            -2.991913080215454,
            -1.6154816150665283,
            1.2388060092926025,
            1.3808058500289917,
            -2.560490608215332,
            1.1989922523498535,
            0.033837854862213135,
            -1.7212929725646973,
            -0.2738439738750458,
            0.1965814232826233,
            2.6878838539123535,
            -1.2512156963348389,
            2.628365993499756,
            -0.06501874327659607,
            -3.2874460220336914,
            -1.9871678352355957,
            10.061786651611328,
            3.892322063446045,
            -0.1307094246149063,
            -0.0563679039478302,
            -0.6379507184028625,
            -0.1690727174282074,
            1.1730220317840576,
            -0.16993767023086548,
            -2.177197217941284,
            3.6238064765930176,
            0.4616961181163788,
            1.7835255861282349,
            -3.232830047607422
        ]
    },
    "authors": [
        {
            "authorId": "2315345179",
            "name": "Sungyoon Kim"
        },
        {
            "authorId": "2315440877",
            "name": "Youngjun Kim"
        },
        {
            "authorId": "2315310512",
            "name": "Kihyo Moon"
        },
        {
            "authorId": "2315301769",
            "name": "Minsung Jang"
        }
    ],
    "references": []
}