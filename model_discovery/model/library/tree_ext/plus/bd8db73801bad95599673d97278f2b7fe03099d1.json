{
    "paperId": "bd8db73801bad95599673d97278f2b7fe03099d1",
    "externalIds": {
        "ArXiv": "2409.01483",
        "CorpusId": 272367500
    },
    "title": "Revisiting SMoE Language Models by Evaluating Inefficiencies with Task Specific Expert Pruning",
    "abstract": "Sparse Mixture of Expert (SMoE) models have emerged as a scalable alternative to dense models in language modeling. These models use conditionally activated feedforward subnetworks in transformer blocks, allowing for a separation between total model parameters and per-example computation. However, large token-routed SMoE models face a significant challenge: during inference, the entire model must be used for a sequence or a batch, resulting in high latencies in a distributed setting that offsets the advantages of per-token sparse activation. Our research explores task-specific model pruning to inform decisions about designing SMoE architectures, mainly modulating the choice of expert counts in pretraining. We investigate whether such pruned models offer advantages over smaller SMoE models trained from scratch, when evaluating and comparing them individually on tasks. To that end, we introduce an adaptive task-aware pruning technique UNCURL to reduce the number of experts per MoE layer in an offline manner post-training. Our findings reveal a threshold pruning factor for the reduction that depends on the number of experts used in pretraining, above which, the reduction starts to degrade model performance. These insights contribute to our understanding of model design choices when pretraining with SMoE architectures, particularly useful when considering task-specific inference optimization for later stages.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "An adaptive task-aware pruning technique UNCURL is introduced to reduce the number of experts per MoE layer in an offline manner post-training, revealing a threshold pruning factor for the reduction that depends on the number of experts used in pretraining, above which, the reduction starts to degrade model performance."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -1.7457817792892456,
            2.482545852661133,
            0.16065627336502075,
            3.0751864910125732,
            2.3521289825439453,
            0.2504732608795166,
            0.3412044644355774,
            -1.709855318069458,
            -1.0387451648712158,
            0.23183900117874146,
            -1.8458110094070435,
            4.5941057205200195,
            -0.22372972965240479,
            -0.6474123001098633,
            -2.4334187507629395,
            2.5614774227142334,
            0.7196624279022217,
            -2.1837689876556396,
            3.350640296936035,
            3.413942337036133,
            -1.070173978805542,
            5.1100053787231445,
            -0.9747626185417175,
            0.17469185590744019,
            -1.0033880472183228,
            -1.3094677925109863,
            2.7323737144470215,
            -1.6081403493881226,
            -3.2074742317199707,
            4.284323215484619,
            -0.5268567800521851,
            -5.8488264083862305,
            5.987301349639893,
            -4.067821502685547,
            1.3445894718170166,
            -2.8466098308563232,
            -3.574864387512207,
            7.535552501678467,
            -4.598574638366699,
            -1.2937450408935547,
            -2.59275484085083,
            -1.5282301902770996,
            -0.2902982234954834,
            1.3146618604660034,
            4.166935443878174,
            1.8185595273971558,
            4.602813720703125,
            1.8759074211120605,
            -2.3711249828338623,
            2.9114761352539062,
            2.3281681537628174,
            2.9327950477600098,
            -2.432753801345825,
            1.7100845575332642,
            -0.9096044301986694,
            -1.4564682245254517,
            -0.24445003271102905,
            0.9719600677490234,
            5.138288497924805,
            -3.1597418785095215,
            3.387843608856201,
            1.5762457847595215,
            -1.2937010526657104,
            0.46634039282798767,
            4.059197425842285,
            -4.465643882751465,
            -0.05547225475311279,
            3.8769166469573975,
            2.0094969272613525,
            1.5443756580352783,
            1.1191771030426025,
            -4.528153419494629,
            -0.20716851949691772,
            1.4696241617202759,
            -2.5431277751922607,
            -0.9142711758613586,
            0.2971956133842468,
            -7.717096328735352,
            -1.2903975248336792,
            -1.2522705793380737,
            0.35202088952064514,
            0.034721970558166504,
            1.763404130935669,
            2.210655450820923,
            3.992138385772705,
            -3.1741909980773926,
            -4.562238693237305,
            0.21418389678001404,
            0.5979973673820496,
            -4.114048957824707,
            -0.4187951683998108,
            1.4951002597808838,
            -2.9762604236602783,
            2.5889792442321777,
            -6.03852653503418,
            0.004784107208251953,
            -0.632035493850708,
            0.28730887174606323,
            -3.8608477115631104,
            -1.1955710649490356,
            3.2065768241882324,
            -1.0103590488433838,
            4.022636413574219,
            3.721358299255371,
            5.696579456329346,
            -3.2263965606689453,
            0.8622890710830688,
            1.4423848390579224,
            -0.1571829617023468,
            -1.4847891330718994,
            -2.9026546478271484,
            1.5590288639068604,
            -1.8975632190704346,
            -2.106842041015625,
            1.469205379486084,
            -3.7724368572235107,
            -5.004568576812744,
            0.13244403898715973,
            -1.5818865299224854,
            6.1133952140808105,
            -3.4290707111358643,
            -1.6292450428009033,
            -3.1279258728027344,
            -0.5048884749412537,
            1.4832227230072021,
            2.4216675758361816,
            0.7997852563858032,
            -0.008835136890411377,
            0.4640548527240753,
            -3.0573320388793945,
            1.9073586463928223,
            -0.7645179629325867,
            3.9596877098083496,
            -2.6319000720977783,
            2.180860996246338,
            6.272423267364502,
            -2.0947375297546387,
            2.73443603515625,
            -1.30869460105896,
            -0.4190879166126251,
            -2.0105690956115723,
            2.750427722930908,
            0.7819414734840393,
            -1.9078757762908936,
            -0.6428238153457642,
            5.547121524810791,
            2.2119863033294678,
            2.206265449523926,
            -0.639108419418335,
            5.5888800621032715,
            4.328347682952881,
            -4.686121940612793,
            0.4468761086463928,
            -0.062015414237976074,
            -0.49129030108451843,
            4.112344741821289,
            -7.3118133544921875,
            1.2182128429412842,
            -2.449868679046631,
            1.1840829849243164,
            0.4877229630947113,
            -2.871058225631714,
            -7.057072639465332,
            -1.1183340549468994,
            2.698836326599121,
            -6.415133953094482,
            -2.175337076187134,
            1.371161699295044,
            -2.279109239578247,
            3.0622003078460693,
            -0.17531368136405945,
            1.808880090713501,
            1.6424119472503662,
            2.1779417991638184,
            4.316275596618652,
            2.125131368637085,
            1.2383193969726562,
            -2.363487482070923,
            5.698047161102295,
            0.7585456371307373,
            -0.7022637128829956,
            -1.3807501792907715,
            -5.932701587677002,
            1.57328200340271,
            -2.373835563659668,
            -0.6549768447875977,
            -2.1996445655822754,
            -2.6841959953308105,
            0.4679158627986908,
            0.5700538754463196,
            -2.697620391845703,
            1.699291467666626,
            4.598255157470703,
            4.952399253845215,
            2.802839517593384,
            4.126217842102051,
            3.1259407997131348,
            2.4496772289276123,
            -3.9140172004699707,
            -1.4082581996917725,
            2.055799961090088,
            -0.046966612339019775,
            1.8646798133850098,
            1.4682425260543823,
            4.120567321777344,
            2.6141319274902344,
            -2.829305410385132,
            3.549380302429199,
            -0.3201718330383301,
            -0.23494157195091248,
            0.3599703013896942,
            -2.3487350940704346,
            -3.6216280460357666,
            1.3108220100402832,
            -2.263662815093994,
            -3.4437198638916016,
            -6.188016414642334,
            1.2008758783340454,
            5.665449142456055,
            2.879716157913208,
            -2.948021650314331,
            0.8094223737716675,
            3.1054468154907227,
            -2.374786853790283,
            -1.2210159301757812,
            -2.746140718460083,
            2.3513150215148926,
            -1.7902369499206543,
            0.9435688257217407,
            -1.042873740196228,
            -0.47682952880859375,
            -6.835659027099609,
            -1.0009101629257202,
            -1.5020543336868286,
            -3.1777243614196777,
            0.5826672911643982,
            -5.6391754150390625,
            2.7924342155456543,
            0.5276573896408081,
            -1.307072639465332,
            3.4102094173431396,
            2.2142553329467773,
            -0.3652329444885254,
            2.743410348892212,
            3.6188297271728516,
            0.5326297283172607,
            -4.867607116699219,
            0.5980628728866577,
            -3.7101287841796875,
            -0.37398356199264526,
            0.4648894667625427,
            -0.43301910161972046,
            3.438877582550049,
            1.832456111907959,
            2.3361470699310303,
            3.3340020179748535,
            -2.339615821838379,
            0.04271140694618225,
            -1.2610645294189453,
            1.0677121877670288,
            1.6633579730987549,
            7.148880958557129,
            1.8942339420318604,
            2.519416093826294,
            -0.9942200183868408,
            -2.03141450881958,
            -3.9332942962646484,
            -3.015601396560669,
            -1.6526575088500977,
            3.949826955795288,
            3.503023862838745,
            1.6315388679504395,
            0.6011878252029419,
            -2.2241506576538086,
            -1.1545963287353516,
            -5.154560089111328,
            -3.9166202545166016,
            0.3336905837059021,
            1.2280066013336182,
            4.010900497436523,
            -0.36559686064720154,
            -3.302250385284424,
            -1.7997100353240967,
            -1.4030187129974365,
            -0.703266978263855,
            -4.532548904418945,
            -2.816453695297241,
            -0.9438701868057251,
            1.4982941150665283,
            -2.357625961303711,
            -3.947547674179077,
            5.46695613861084,
            -4.67805290222168,
            -1.4811336994171143,
            -2.365434408187866,
            2.6321773529052734,
            4.967960357666016,
            -0.41480040550231934,
            1.586925983428955,
            0.8579641580581665,
            0.932294487953186,
            1.8721367120742798,
            3.4708058834075928,
            0.9663709402084351,
            1.593052625656128,
            3.9300503730773926,
            0.18388128280639648,
            -1.3263027667999268,
            -1.9493765830993652,
            -4.565951347351074,
            -4.237802505493164,
            0.8426559567451477,
            1.7848997116088867,
            -3.7575154304504395,
            -0.1255723237991333,
            1.2660000324249268,
            0.41044098138809204,
            -0.11288449168205261,
            -0.5109761953353882,
            2.7825236320495605,
            -2.497992753982544,
            0.3659173250198364,
            -4.404938697814941,
            -1.952383279800415,
            -3.1552491188049316,
            -0.9439659118652344,
            2.3427295684814453,
            4.85699462890625,
            -1.1819790601730347,
            2.7915711402893066,
            0.0014005005359649658,
            5.113653182983398,
            1.1473602056503296,
            1.2662380933761597,
            -2.169105052947998,
            -6.087091445922852,
            0.4169635474681854,
            -1.5886155366897583,
            3.6669669151306152,
            1.7405287027359009,
            0.22131165862083435,
            5.3068132400512695,
            -0.19996953010559082,
            -2.5759310722351074,
            0.47726303339004517,
            -1.5411421060562134,
            -1.352550745010376,
            -1.8610810041427612,
            -0.8248504400253296,
            -0.38782790303230286,
            -0.3974156975746155,
            3.875812530517578,
            2.9527463912963867,
            -1.938817024230957,
            4.767596244812012,
            1.0055204629898071,
            1.3815045356750488,
            0.29401180148124695,
            0.2100163996219635,
            4.678253173828125,
            -0.31269997358322144,
            -1.2124528884887695,
            1.039522409439087,
            0.475807249546051,
            1.8223133087158203,
            -3.715909004211426,
            11.170244216918945,
            -1.770827054977417,
            1.5510040521621704,
            -6.614849090576172,
            -1.269737720489502,
            -1.168044924736023,
            -4.695465087890625,
            4.385454177856445,
            -3.275728464126587,
            -2.082270860671997,
            -0.5466822385787964,
            -2.6993706226348877,
            1.2062177658081055,
            1.3552547693252563,
            0.21210190653800964,
            3.178741455078125,
            -0.17477186024188995,
            2.2112772464752197,
            -1.3597438335418701,
            0.8895784616470337,
            -0.3627001643180847,
            1.2238948345184326,
            2.8930747509002686,
            -0.7773236632347107,
            -1.3782658576965332,
            1.8819334506988525,
            0.05253159999847412,
            1.8731975555419922,
            -3.5891170501708984,
            -0.7552887201309204,
            -2.7059881687164307,
            -2.0041866302490234,
            -1.2511392831802368,
            3.5620031356811523,
            -1.3057060241699219,
            -0.33669108152389526,
            5.914525032043457,
            5.481735706329346,
            -4.5246686935424805,
            -0.32018494606018066,
            2.845255136489868,
            -2.127835750579834,
            -4.104590892791748,
            -1.2065393924713135,
            -1.1624643802642822,
            -0.5323787927627563,
            1.7663512229919434,
            -4.415240287780762,
            0.45006629824638367,
            -2.1769309043884277,
            2.880128860473633,
            3.6579031944274902,
            2.896066665649414,
            2.8206443786621094,
            -0.8061212301254272,
            3.809532880783081,
            3.856199264526367,
            1.1132440567016602,
            2.428990602493286,
            -0.5565239191055298,
            1.5137178897857666,
            0.9547602534294128,
            -2.772444725036621,
            3.7633984088897705,
            1.0464272499084473,
            5.075788974761963,
            -4.084956169128418,
            -3.0288186073303223,
            -0.4156883955001831,
            1.1717109680175781,
            3.818460464477539,
            1.433526873588562,
            0.7944519519805908,
            -2.242948293685913,
            -0.1645336002111435,
            3.2234079837799072,
            -2.5909156799316406,
            3.690659523010254,
            1.6631238460540771,
            1.6464977264404297,
            3.474498748779297,
            1.2245161533355713,
            -0.5868330001831055,
            -0.8458462953567505,
            3.6637790203094482,
            -5.5692973136901855,
            -1.4801934957504272,
            -0.16254311800003052,
            -0.43024998903274536,
            1.234158992767334,
            -3.9190127849578857,
            -0.9923046827316284,
            0.5177038908004761,
            -0.9252285957336426,
            -3.6840925216674805,
            3.1636805534362793,
            -1.7666215896606445,
            -0.5800361633300781,
            1.257361650466919,
            1.0422109365463257,
            -3.5640532970428467,
            -3.1009650230407715,
            -3.3365485668182373,
            0.08006006479263306,
            0.25709888339042664,
            0.15196603536605835,
            -1.3816978931427002,
            2.7278716564178467,
            1.1510621309280396,
            0.17841732501983643,
            2.5829176902770996,
            -0.14258326590061188,
            -0.6761139035224915,
            -3.534976005554199,
            -4.127133846282959,
            -1.9364134073257446,
            2.7041871547698975,
            -1.273045539855957,
            -1.1360679864883423,
            3.032024383544922,
            1.3200517892837524,
            2.3744657039642334,
            3.553781509399414,
            2.0322070121765137,
            2.346806526184082,
            3.421156883239746,
            6.898136138916016,
            -0.36451542377471924,
            1.6807528734207153,
            -1.1299879550933838,
            -3.3946311473846436,
            2.4739880561828613,
            2.5022101402282715,
            0.31705740094184875,
            0.652813196182251,
            -2.7636430263519287,
            1.0298149585723877,
            -0.6445280313491821,
            -2.674283266067505,
            5.057254791259766,
            6.9120049476623535,
            1.7670601606369019,
            -4.882753372192383,
            -0.2943727374076843,
            -4.04360294342041,
            0.9092553853988647,
            -6.308751106262207,
            4.589081287384033,
            -0.317274272441864,
            1.0894286632537842,
            4.210612773895264,
            0.8692786693572998,
            1.154460072517395,
            0.27657079696655273,
            -1.632152795791626,
            -1.3930449485778809,
            -2.540043354034424,
            0.8445790410041809,
            -0.7035835981369019,
            3.0928955078125,
            -2.9945013523101807,
            0.293906033039093,
            -0.9304686188697815,
            5.8740692138671875,
            10.047959327697754,
            5.484698295593262,
            4.386201858520508,
            -1.2937994003295898,
            -0.5278895497322083,
            -1.895684003829956,
            0.6060062646865845,
            5.390130043029785,
            -5.3846540451049805,
            -0.49932336807250977,
            -0.07124245166778564,
            -0.11579221487045288,
            -2.3941004276275635,
            4.529134750366211,
            -0.8676823973655701,
            5.282108306884766,
            -4.571115016937256,
            -0.5873551964759827,
            -1.7390278577804565,
            1.080172061920166,
            2.8110175132751465,
            -2.486929416656494,
            3.1179003715515137,
            1.6522042751312256,
            -0.7228233218193054,
            -0.9956113696098328,
            -0.5510553121566772,
            -1.8755919933319092,
            -2.9505515098571777,
            3.7723052501678467,
            2.0141618251800537,
            -1.508561134338379,
            0.006826147437095642,
            4.107389450073242,
            1.3701916933059692,
            -0.5791910290718079,
            -4.498219013214111,
            5.273386001586914,
            3.4934639930725098,
            -0.31315070390701294,
            0.49728482961654663,
            -0.29826438426971436,
            -1.08560311794281,
            -1.2949358224868774,
            0.7269622683525085,
            -0.12429249286651611,
            0.8074756860733032,
            -0.2501221299171448,
            -0.09869174659252167,
            -4.47598934173584,
            -1.940479040145874,
            0.09217128157615662,
            -1.8408653736114502,
            -6.596262454986572,
            -0.25771695375442505,
            -4.385138034820557,
            -4.79257869720459,
            1.469796895980835,
            -4.938958644866943,
            -0.371975839138031,
            2.529550552368164,
            -0.809465765953064,
            3.894576072692871,
            -3.5388972759246826,
            0.9228092432022095,
            -2.820145845413208,
            1.9607350826263428,
            3.3171513080596924,
            0.2022732049226761,
            1.2136263847351074,
            -0.6357081532478333,
            3.238468647003174,
            0.9734130501747131,
            -0.7688477635383606,
            -3.2950785160064697,
            -1.0190916061401367,
            2.5202102661132812,
            0.33605241775512695,
            -2.5695064067840576,
            0.3238481879234314,
            -0.40497010946273804,
            0.4643767476081848,
            15.852436065673828,
            -1.60495924949646,
            0.01728121191263199,
            0.05696214735507965,
            -1.4965829849243164,
            -6.483977317810059,
            -4.550599575042725,
            2.8367772102355957,
            0.05373412370681763,
            1.4484971761703491,
            -1.9625346660614014,
            -4.185737609863281,
            -2.221946954727173,
            0.6679126024246216,
            -0.5018724799156189,
            -0.1749889850616455,
            -3.5041041374206543,
            1.9323004484176636,
            0.22520367801189423,
            -0.5998331308364868,
            0.6695626378059387,
            1.754830002784729,
            -0.39620494842529297,
            -3.970855951309204,
            -0.47276151180267334,
            2.7204537391662598,
            -2.410454750061035,
            3.9493467807769775,
            -4.534388542175293,
            -1.6078484058380127,
            1.5699812173843384,
            0.5334603786468506,
            -2.414606809616089,
            3.430791139602661,
            -2.263029098510742,
            3.639646291732788,
            3.965158224105835,
            -3.3368077278137207,
            5.078718185424805,
            1.318917989730835,
            -0.7498867511749268,
            0.5481451153755188,
            -0.8994877338409424,
            2.0471904277801514,
            -3.8787217140197754,
            1.7504425048828125,
            2.707909107208252,
            -1.5979034900665283,
            -2.8078222274780273,
            3.8552613258361816,
            -1.3854219913482666,
            -2.36836838722229,
            1.9078266620635986,
            1.8856079578399658,
            1.899362564086914,
            1.214916467666626,
            -0.1836593747138977,
            -3.982365131378174,
            4.490755081176758,
            -0.06499683856964111,
            -0.09895205497741699,
            1.598189115524292,
            0.5433782935142517,
            -2.45487642288208,
            -3.234663486480713,
            -1.2346959114074707,
            -4.024527072906494,
            4.13693380355835,
            1.9104464054107666,
            1.2842016220092773,
            2.556359052658081,
            1.6770670413970947,
            -3.581810712814331,
            -1.1073522567749023,
            -1.0176628828048706,
            -6.425623893737793,
            1.365618348121643,
            -3.2850308418273926,
            0.19471558928489685,
            5.3300676345825195,
            -2.5087966918945312,
            2.3405184745788574,
            0.033459603786468506,
            0.4580461084842682,
            3.4785194396972656,
            -3.8689815998077393,
            5.35307502746582,
            -1.2759052515029907,
            -2.937173366546631,
            1.3671046495437622,
            -1.5972627401351929,
            0.20076286792755127,
            2.8149962425231934,
            4.629456520080566,
            2.1480846405029297,
            -4.913725852966309,
            -2.46207857131958,
            -3.0161585807800293,
            -2.215306282043457,
            -3.190575122833252,
            5.180936336517334,
            2.5173988342285156,
            2.2538795471191406,
            -2.406405448913574,
            0.537707507610321,
            0.8750561475753784,
            -2.0114259719848633,
            -6.691783905029297,
            -2.610337018966675,
            -2.3903696537017822,
            2.9681196212768555,
            -4.189783096313477,
            -1.6997219324111938,
            -1.1909880638122559,
            0.951165497303009,
            -1.5403674840927124,
            0.955219030380249,
            1.1506404876708984,
            0.16720902919769287,
            6.924323558807373,
            1.3146816492080688,
            -0.5635508298873901,
            -2.0970687866210938,
            -3.2419447898864746,
            -3.3020529747009277,
            -0.18941420316696167,
            0.045874953269958496,
            -2.94401216506958,
            -1.4162936210632324,
            2.4959659576416016,
            0.7966556549072266,
            -5.739472389221191,
            -2.487351417541504,
            -0.42705345153808594,
            -0.5510948896408081,
            -1.9960417747497559,
            0.5449413061141968,
            2.186824083328247,
            -0.6238266229629517,
            3.895219326019287,
            2.3939919471740723,
            -1.970344066619873,
            -1.1302355527877808,
            9.142215728759766,
            1.2117061614990234,
            -1.8126839399337769,
            -0.5142512321472168,
            0.9901391267776489,
            -3.8612098693847656,
            -1.9617613554000854,
            0.4702674448490143,
            -2.566117525100708,
            3.3061869144439697,
            -0.4572177827358246,
            1.5017986297607422,
            -2.3027327060699463
        ]
    },
    "authors": [
        {
            "authorId": "3081847",
            "name": "Soumajyoti Sarkar"
        },
        {
            "authorId": "8789103",
            "name": "Leonard Lausen"
        },
        {
            "authorId": "1678641",
            "name": "V. Cevher"
        },
        {
            "authorId": "40881843",
            "name": "Sheng Zha"
        },
        {
            "authorId": "2319409769",
            "name": "Thomas Brox"
        },
        {
            "authorId": "2064547804",
            "name": "George Karypis"
        }
    ],
    "references": []
}