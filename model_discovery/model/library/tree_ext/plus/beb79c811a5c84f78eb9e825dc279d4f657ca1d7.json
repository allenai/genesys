{
    "paperId": "beb79c811a5c84f78eb9e825dc279d4f657ca1d7",
    "externalIds": {
        "ArXiv": "2408.12857",
        "CorpusId": 271947366
    },
    "title": "Memory-Efficient LLM Training with Online Subspace Descent",
    "abstract": "Recently, a wide range of memory-efficient LLM training algorithms have gained substantial popularity. These methods leverage the low-rank structure of gradients to project optimizer states into a subspace using projection matrix found by singular value decomposition (SVD). However, convergence of these algorithms is highly dependent on the update rules of their projection matrix. In this work, we provide the \\emph{first} convergence guarantee for arbitrary update rules of projection matrix. This guarantee is generally applicable to optimizers that can be analyzed with Hamiltonian Descent, including most common ones, such as LION, Adam. Inspired by our theoretical understanding, we propose Online Subspace Descent, a new family of subspace descent optimizer without SVD. Instead of updating the projection matrix with eigenvectors, Online Subspace Descent updates the projection matrix with online PCA. Online Subspace Descent is flexible and introduces only minimum overhead to training. We show that for the task of pretraining LLaMA models ranging from 60M to 7B parameters on the C4 dataset, Online Subspace Descent achieves lower perplexity and better downstream tasks performance than state-of-the-art low-rank training methods across different settings and narrows the gap with full-rank baselines.",
    "venue": "",
    "year": 2024,
    "referenceCount": 0,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "It is shown that for the task of pretraining LLaMA models ranging from 60M to 7B parameters on the C4 dataset, Online Subspace Descent achieves lower perplexity and better downstream tasks performance than state-of-the-art low-rank training methods across different settings and narrows the gap with full-rank baselines."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.833365440368652,
            -0.462597131729126,
            -4.14644718170166,
            3.0371084213256836,
            -2.3764524459838867,
            -0.5005319714546204,
            2.464571237564087,
            -5.319392204284668,
            -0.4683090150356293,
            -0.049001544713974,
            -0.3341754078865051,
            4.252032279968262,
            0.3958556056022644,
            -1.0517679452896118,
            -4.995205879211426,
            -0.8824370503425598,
            -4.960572242736816,
            -1.722480297088623,
            3.2583017349243164,
            1.0956834554672241,
            -3.378230094909668,
            2.635486364364624,
            -3.9785473346710205,
            1.1875988245010376,
            -0.7376688122749329,
            0.452204167842865,
            -0.16399192810058594,
            -1.536186695098877,
            0.19934986531734467,
            -4.6785383224487305,
            1.6991740465164185,
            -5.163505554199219,
            6.090638637542725,
            -4.003311634063721,
            4.108481407165527,
            -0.7994617819786072,
            -0.20398002862930298,
            5.8378801345825195,
            -5.353726387023926,
            -0.8441148996353149,
            -0.47203439474105835,
            0.12205904722213745,
            1.5427327156066895,
            0.680133581161499,
            -0.6537894606590271,
            0.8251485824584961,
            -0.23132461309432983,
            2.90814208984375,
            2.2925946712493896,
            1.0348963737487793,
            2.5854151248931885,
            -0.6182676553726196,
            3.7567315101623535,
            0.430052250623703,
            2.536937713623047,
            0.5563961267471313,
            1.2697547674179077,
            0.9998800754547119,
            2.479580879211426,
            0.9588284492492676,
            1.2956525087356567,
            4.104964733123779,
            -1.9595551490783691,
            2.977264642715454,
            0.9681740999221802,
            -2.033723831176758,
            -0.18988540768623352,
            5.732144832611084,
            -3.5158910751342773,
            -0.03622129559516907,
            -3.0100176334381104,
            -3.826962471008301,
            1.2380304336547852,
            2.360452175140381,
            -3.6770172119140625,
            0.5698520541191101,
            -2.090111494064331,
            -5.844483852386475,
            -1.1248893737792969,
            -0.6026327610015869,
            -1.3092485666275024,
            1.298814296722412,
            -0.04528120160102844,
            -1.6938741207122803,
            5.566006660461426,
            -2.624046564102173,
            -2.134795665740967,
            0.20016321539878845,
            1.664437174797058,
            -1.4814152717590332,
            -2.1870813369750977,
            3.2175216674804688,
            -0.297325074672699,
            1.2584336996078491,
            -0.467911958694458,
            0.5009373426437378,
            0.7970386743545532,
            0.6214308738708496,
            -1.0446609258651733,
            -1.222107172012329,
            2.6055748462677,
            0.14677226543426514,
            0.6670193076133728,
            -1.173548936843872,
            2.513054370880127,
            0.01460796594619751,
            -3.001873254776001,
            0.24586817622184753,
            1.1819685697555542,
            -5.833984375,
            -1.685296893119812,
            1.4425880908966064,
            -1.4169244766235352,
            -1.6759827136993408,
            -3.4007325172424316,
            -4.1452836990356445,
            -0.10290193557739258,
            -1.2185144424438477,
            -1.752658486366272,
            4.522103309631348,
            -1.0387473106384277,
            -3.168762683868408,
            -6.908703327178955,
            3.5695669651031494,
            -2.2123637199401855,
            3.1746907234191895,
            -0.9213986396789551,
            2.743279457092285,
            -3.3778555393218994,
            -6.4826250076293945,
            1.5069316625595093,
            -3.204069137573242,
            -2.4780948162078857,
            0.9431935548782349,
            6.3766188621521,
            3.970240831375122,
            -4.671390533447266,
            1.7072291374206543,
            -4.28550910949707,
            -1.3782577514648438,
            4.024449348449707,
            4.018084526062012,
            3.499603748321533,
            4.878061294555664,
            0.8780425786972046,
            3.1678314208984375,
            -2.3309295177459717,
            2.2150845527648926,
            1.2947118282318115,
            5.5732879638671875,
            3.7198052406311035,
            -0.7605829238891602,
            1.8585984706878662,
            0.3045084476470947,
            2.1443467140197754,
            3.2604470252990723,
            -5.620644569396973,
            -1.1302391290664673,
            0.005866378545761108,
            0.5685628056526184,
            2.0821876525878906,
            0.8024749755859375,
            -9.849042892456055,
            0.4524223208427429,
            4.647249221801758,
            -2.4666924476623535,
            -2.0743627548217773,
            -1.0416879653930664,
            0.7817769050598145,
            -1.5945255756378174,
            1.686575174331665,
            2.5574657917022705,
            0.08715939521789551,
            2.085395336151123,
            2.3301873207092285,
            2.5017964839935303,
            4.184091091156006,
            -3.66670560836792,
            -4.753602981567383,
            3.9571902751922607,
            -3.373434066772461,
            -0.6298319101333618,
            -7.902074337005615,
            -0.8208733201026917,
            -4.583732604980469,
            -3.739845037460327,
            -1.5188268423080444,
            -1.4648265838623047,
            -0.6182856559753418,
            1.314636468887329,
            2.5292868614196777,
            -1.4822934865951538,
            6.696185111999512,
            5.4664201736450195,
            1.5120294094085693,
            -2.4837393760681152,
            1.3925189971923828,
            -1.7483693361282349,
            -2.38319993019104,
            2.96420955657959,
            5.677901268005371,
            1.1595392227172852,
            -0.6260036826133728,
            0.6025262475013733,
            -0.014903604984283447,
            -2.2632503509521484,
            -3.970165729522705,
            3.146718740463257,
            0.20478998124599457,
            -0.22815099358558655,
            2.73156476020813,
            -2.3465499877929688,
            -2.472411632537842,
            -3.0513415336608887,
            -3.7553234100341797,
            -3.2010080814361572,
            0.797483503818512,
            3.5736029148101807,
            6.309657096862793,
            -0.0634375810623169,
            -0.5475813150405884,
            -4.2324066162109375,
            -0.1756243109703064,
            -1.686619520187378,
            3.121635675430298,
            -3.1120340824127197,
            1.2043890953063965,
            1.4835373163223267,
            -0.5641871094703674,
            3.2261576652526855,
            1.9344706535339355,
            -2.095292806625366,
            -0.13535022735595703,
            1.2914071083068848,
            -4.980986595153809,
            -1.191009283065796,
            -4.930045127868652,
            2.685762882232666,
            4.038097381591797,
            0.17553812265396118,
            4.02838134765625,
            1.549925684928894,
            2.5393242835998535,
            4.655506134033203,
            4.2662763595581055,
            0.8757121562957764,
            -2.188204288482666,
            0.514061450958252,
            -2.729973316192627,
            -1.5942548513412476,
            -2.6727805137634277,
            0.7986031770706177,
            0.5981669425964355,
            -3.1764090061187744,
            1.4775516986846924,
            2.6941843032836914,
            1.8828315734863281,
            0.9496102333068848,
            1.5663620233535767,
            -2.083472490310669,
            0.16683226823806763,
            5.285404205322266,
            -0.3398588299751282,
            4.559837341308594,
            -0.9512572288513184,
            -2.378704071044922,
            -2.9101579189300537,
            -4.951888561248779,
            -2.252833366394043,
            0.8741464614868164,
            1.251660943031311,
            0.8603329658508301,
            -1.675382137298584,
            -4.110400199890137,
            -3.302994966506958,
            -6.403316497802734,
            -2.5779595375061035,
            1.055081844329834,
            3.009955406188965,
            3.6511425971984863,
            3.9547104835510254,
            -0.28960758447647095,
            -2.248044013977051,
            -1.9811220169067383,
            -3.491157054901123,
            -2.1841795444488525,
            -2.7188167572021484,
            0.9983611702919006,
            2.6175003051757812,
            -0.03686511516571045,
            -4.357538223266602,
            2.2583396434783936,
            -0.6042757630348206,
            2.8781793117523193,
            -4.321478366851807,
            2.984829902648926,
            1.1686203479766846,
            -0.1999649554491043,
            0.5593688488006592,
            2.3235552310943604,
            -0.6526718139648438,
            1.94803786277771,
            2.7511496543884277,
            1.6548197269439697,
            2.3215982913970947,
            4.311323165893555,
            4.04697322845459,
            -0.3909977972507477,
            0.7929484844207764,
            -3.1646053791046143,
            -1.9306951761245728,
            -2.485562324523926,
            4.2411041259765625,
            0.6367738842964172,
            1.5840163230895996,
            0.14083793759346008,
            0.9156870245933533,
            2.7091269493103027,
            -3.3868536949157715,
            4.49461555480957,
            -1.165284276008606,
            2.867295026779175,
            -2.4196152687072754,
            -1.1266155242919922,
            0.03446020185947418,
            2.5605578422546387,
            5.823548316955566,
            4.675692558288574,
            -2.0572915077209473,
            5.9130473136901855,
            -0.6943016648292542,
            2.3030428886413574,
            3.789550304412842,
            2.7937755584716797,
            -0.6003121137619019,
            -2.422605514526367,
            -2.560115337371826,
            0.1412716805934906,
            0.7899103760719299,
            2.4297897815704346,
            0.09660691022872925,
            3.4903299808502197,
            -2.3937761783599854,
            0.752402663230896,
            -1.8354758024215698,
            -1.0597960948944092,
            4.1362996101379395,
            -3.229050397872925,
            0.37973517179489136,
            4.202552318572998,
            2.6911025047302246,
            1.1651979684829712,
            5.462423324584961,
            0.28331467509269714,
            1.2980133295059204,
            4.103389739990234,
            4.088183403015137,
            0.9594631195068359,
            2.216855049133301,
            2.771789073944092,
            2.2473092079162598,
            -0.9732849597930908,
            4.364706039428711,
            -1.7777464389801025,
            1.8581569194793701,
            -1.9381285905838013,
            10.005203247070312,
            -3.437920093536377,
            2.730156421661377,
            -2.2681288719177246,
            -2.7775440216064453,
            -4.696840763092041,
            0.31776079535484314,
            1.694656491279602,
            -3.104445457458496,
            -1.4842642545700073,
            3.5386085510253906,
            -2.7281370162963867,
            3.137179374694824,
            1.4680842161178589,
            2.903449535369873,
            1.0455999374389648,
            0.039943307638168335,
            0.39894789457321167,
            -1.6151143312454224,
            -1.860878825187683,
            1.337067723274231,
            3.0173211097717285,
            1.0563322305679321,
            1.2983729839324951,
            0.7294860482215881,
            3.091768980026245,
            -0.755490243434906,
            2.9409193992614746,
            -3.7237186431884766,
            -0.3915233910083771,
            -3.885838270187378,
            -4.935202121734619,
            0.6793321967124939,
            3.4347410202026367,
            1.0371736288070679,
            0.7755380868911743,
            6.12062931060791,
            3.223381280899048,
            -4.811504364013672,
            -2.9756102561950684,
            3.1818885803222656,
            -0.7166366577148438,
            -0.3714046776294708,
            0.13975679874420166,
            -3.9833521842956543,
            -2.9343767166137695,
            -4.022314548492432,
            -3.166130781173706,
            -0.04367741942405701,
            0.4501900374889374,
            -3.113689422607422,
            2.9213671684265137,
            1.6188788414001465,
            0.09451831877231598,
            -1.3673635721206665,
            2.6681761741638184,
            6.689545631408691,
            2.899822950363159,
            -1.9485429525375366,
            3.2039072513580322,
            1.8507943153381348,
            0.7774767875671387,
            -0.8562419414520264,
            0.4193889796733856,
            -3.8896613121032715,
            5.705875873565674,
            -3.1037521362304688,
            1.9900119304656982,
            0.6992002129554749,
            7.971668243408203,
            -1.3179676532745361,
            2.5827877521514893,
            2.702941417694092,
            1.3293602466583252,
            2.9570963382720947,
            0.7493897676467896,
            -2.358177661895752,
            5.547230243682861,
            1.266280174255371,
            -0.14295798540115356,
            0.15306690335273743,
            0.6208030581474304,
            -3.077096462249756,
            -1.8048456907272339,
            1.3247312307357788,
            -4.699762344360352,
            -1.6763091087341309,
            1.9388201236724854,
            -0.877360999584198,
            0.3112216591835022,
            -1.5411726236343384,
            -2.9660799503326416,
            4.033768177032471,
            0.6851493716239929,
            -1.6718378067016602,
            6.483949661254883,
            -0.37951552867889404,
            3.2600173950195312,
            -1.234071969985962,
            4.074602127075195,
            -0.8692151308059692,
            -0.02061694860458374,
            1.330322265625,
            -1.0908697843551636,
            -1.6553537845611572,
            -2.976247787475586,
            0.09080648422241211,
            -3.1699962615966797,
            -0.28730034828186035,
            -3.0807318687438965,
            6.4073262214660645,
            3.4892830848693848,
            2.7675347328186035,
            -4.4022650718688965,
            -2.996551036834717,
            -4.67993688583374,
            0.8976633548736572,
            -1.4841004610061646,
            -0.5196282863616943,
            4.80111837387085,
            0.30695295333862305,
            1.0346667766571045,
            2.7886362075805664,
            3.256720542907715,
            -2.7842302322387695,
            2.2633790969848633,
            3.3947582244873047,
            -0.27988481521606445,
            2.7487523555755615,
            0.13888177275657654,
            -3.8132424354553223,
            3.2630066871643066,
            1.6454415321350098,
            -3.029770612716675,
            -0.8810336589813232,
            -2.9852945804595947,
            -1.9368497133255005,
            -0.06664106249809265,
            -2.230787515640259,
            1.082556128501892,
            3.5381059646606445,
            -1.3606939315795898,
            -3.7873988151550293,
            0.37410274147987366,
            1.2727952003479004,
            -0.06223177909851074,
            -2.840023994445801,
            0.17254075407981873,
            -1.6765776872634888,
            2.0691113471984863,
            1.9453494548797607,
            -1.889557123184204,
            -1.2012057304382324,
            -0.34691309928894043,
            -0.616520881652832,
            -0.13500890135765076,
            1.6538983583450317,
            4.270936012268066,
            2.762237787246704,
            -1.485946536064148,
            -2.6336822509765625,
            1.0176966190338135,
            2.0132367610931396,
            5.3309125900268555,
            7.41990852355957,
            4.415698051452637,
            0.8612067103385925,
            -3.511481761932373,
            -1.431140422821045,
            -1.6163334846496582,
            2.711728096008301,
            1.4448227882385254,
            -6.143867492675781,
            -2.255061149597168,
            -2.333721160888672,
            0.28865718841552734,
            0.3043516278266907,
            0.3662729859352112,
            -0.4110262393951416,
            -2.1894397735595703,
            1.3036667108535767,
            -2.9704437255859375,
            -2.555314064025879,
            -0.6018444895744324,
            3.3264918327331543,
            0.5007704496383667,
            -0.4735059142112732,
            -4.412727355957031,
            -3.4153335094451904,
            -1.6237435340881348,
            0.6222161054611206,
            -2.6573619842529297,
            -2.386050224304199,
            4.775907516479492,
            -4.192829132080078,
            -2.482954740524292,
            -0.0489797443151474,
            2.44513201713562,
            -1.5387455224990845,
            -0.5173690915107727,
            -3.5959506034851074,
            3.0323758125305176,
            -2.982520818710327,
            -3.6725192070007324,
            -0.16053086519241333,
            -2.6430723667144775,
            -0.9860261082649231,
            0.47185981273651123,
            -1.5421090126037598,
            2.5849509239196777,
            3.270042657852173,
            0.2413824200630188,
            -2.8856637477874756,
            -2.2420763969421387,
            -0.14285501837730408,
            -2.1553282737731934,
            -3.5271730422973633,
            -4.5531182289123535,
            1.8942784070968628,
            -0.9083836078643799,
            -1.5645971298217773,
            -0.9059354066848755,
            -4.884381294250488,
            1.8130271434783936,
            2.8756489753723145,
            -4.341848373413086,
            -2.2338311672210693,
            -5.923468589782715,
            1.5238988399505615,
            -3.233017921447754,
            4.319956302642822,
            3.1457693576812744,
            -4.560281753540039,
            1.3861443996429443,
            3.789775848388672,
            4.1417646408081055,
            2.721801280975342,
            0.8197394609451294,
            -2.865875244140625,
            1.098384141921997,
            -0.07740408182144165,
            -1.8152179718017578,
            0.47581392526626587,
            0.4688710570335388,
            2.320908308029175,
            2.103158473968506,
            18.097200393676758,
            -3.523674964904785,
            -0.36277341842651367,
            -1.1316924095153809,
            0.3771844506263733,
            -3.7582035064697266,
            -2.523834705352783,
            2.042611837387085,
            1.4253032207489014,
            3.4987471103668213,
            0.7677165269851685,
            -3.081880569458008,
            1.8882875442504883,
            0.8803085088729858,
            -3.1971285343170166,
            1.2596356868743896,
            -1.447882056236267,
            1.2439422607421875,
            0.1262197494506836,
            0.39802059531211853,
            -2.639272928237915,
            -0.446952223777771,
            1.6819849014282227,
            -0.9135189056396484,
            -2.3095293045043945,
            3.034928798675537,
            2.0521154403686523,
            -0.15242452919483185,
            -5.467798233032227,
            -0.3724176585674286,
            3.2337474822998047,
            1.9938719272613525,
            0.9589360356330872,
            1.3382563591003418,
            -3.2170932292938232,
            2.030839443206787,
            5.44816780090332,
            0.033161669969558716,
            1.932665228843689,
            1.4945775270462036,
            -1.3971385955810547,
            -3.6944971084594727,
            -4.289059638977051,
            -0.014213740825653076,
            -4.4223785400390625,
            0.8345173597335815,
            -0.49528932571411133,
            -2.381822109222412,
            -2.0613346099853516,
            2.435889720916748,
            1.4544508457183838,
            0.3240692615509033,
            -3.30484676361084,
            1.5105366706848145,
            -2.793140411376953,
            -1.2761822938919067,
            -0.5374871492385864,
            1.2450590133666992,
            3.4058213233947754,
            2.156219005584717,
            0.2303340882062912,
            -0.18838651478290558,
            -2.893843173980713,
            -2.2263786792755127,
            -1.416884183883667,
            3.2584280967712402,
            -1.5324865579605103,
            0.6596974730491638,
            1.2038296461105347,
            1.1792128086090088,
            4.2376909255981445,
            0.49300068616867065,
            0.5531558990478516,
            -0.04419142007827759,
            1.2893595695495605,
            -2.4318947792053223,
            2.626199960708618,
            0.4873374402523041,
            0.5976281762123108,
            7.841442584991455,
            -2.770470142364502,
            0.4877878725528717,
            -1.805437445640564,
            -5.867164611816406,
            6.093803405761719,
            -5.089633941650391,
            5.757245063781738,
            3.8218326568603516,
            -1.1987391710281372,
            2.6104907989501953,
            -0.46720433235168457,
            -0.946306586265564,
            0.799346923828125,
            2.949753761291504,
            4.396485328674316,
            -2.9395012855529785,
            -2.0806093215942383,
            -2.2751855850219727,
            -4.575991630554199,
            -3.6707653999328613,
            3.194455623626709,
            2.4887900352478027,
            -0.31736472249031067,
            -1.9559582471847534,
            1.5552767515182495,
            -1.2924365997314453,
            0.9638612270355225,
            -4.817330360412598,
            -5.6286444664001465,
            -2.235720157623291,
            1.7064568996429443,
            -3.5497827529907227,
            1.2990942001342773,
            -1.8640903234481812,
            0.44572728872299194,
            -4.877122402191162,
            -0.7109659314155579,
            2.796016216278076,
            1.8571796417236328,
            2.322098970413208,
            -0.40117526054382324,
            -2.850222587585449,
            -1.0189884901046753,
            -2.849942684173584,
            -3.3745980262756348,
            -0.7682706117630005,
            -2.90897274017334,
            -1.7568073272705078,
            -0.705855667591095,
            -0.6970242261886597,
            3.5473883152008057,
            -2.1883175373077393,
            -2.120433807373047,
            0.7838462591171265,
            -2.093325138092041,
            -5.13188362121582,
            2.404465675354004,
            -0.1872868537902832,
            -3.6831579208374023,
            4.510228157043457,
            4.129652976989746,
            -1.5072541236877441,
            -2.1375784873962402,
            6.492938995361328,
            -0.5465940833091736,
            0.5024310946464539,
            4.018041610717773,
            0.45713311433792114,
            -1.908975601196289,
            3.092055320739746,
            0.42504584789276123,
            1.313875675201416,
            4.662681579589844,
            1.81331467628479,
            -0.439314603805542,
            -5.2071661949157715
        ]
    },
    "authors": [
        {
            "authorId": "2256998751",
            "name": "Kaizhao Liang"
        },
        {
            "authorId": "2257433986",
            "name": "Bo Liu"
        },
        {
            "authorId": "2257093691",
            "name": "Lizhang Chen"
        },
        {
            "authorId": "2283529853",
            "name": "Qiang Liu"
        }
    ],
    "references": []
}