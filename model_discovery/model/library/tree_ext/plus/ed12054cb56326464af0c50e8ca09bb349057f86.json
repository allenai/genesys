{
    "paperId": "ed12054cb56326464af0c50e8ca09bb349057f86",
    "externalIds": {
        "CorpusId": 271866481
    },
    "title": "Robust DPO with Convex-NN on Single GPU",
    "abstract": "Fine-tuning language models (LMs) to better align to human preferences is a fast-moving and still emerging area of research. Recently, models such as Chat-GPT(OpenAI) and Claude(Anthropic) are able to better assist our daily lives in numerous ways. These models are typically trained via Reinforcement Learning from Human Feedback (RLHF), which is non-trivial to implement. Therefore, Direct Preference Optimization (DPO) emerged as a performant alternative via reparametrization of the objective. This made aligning LMs to human preference significantly more accessible on modest GPU clusters. In this project, we introduce an even more lightweight DPO-Convex algorithm that operates on one GPU, by leveraging the convex optimization reformulation of Neural Networks (NNs). Our aim to provide faster convergence to solutions of better optimality, and higher inter-pretability of the underlying optimization landscape for generative language tasks. We use the Alternating Direction Method of Multipliers (ADMM) to solve this optimization problem, in order to increase parallelization efficiency. Our methods are implemented in JAX to lift the memory constraints across experiments. We ex-periment on three datasets, including one synthetically generated Hotel-Concierge dataset, to demonstrate the efficacy of our novel algorithm in a real world setting. Our method is comparable in user preference generation to DPO when tested on 18 human volunteers, despite being trained on one RTX-4090 with a smaller dataset.",
    "venue": "",
    "year": null,
    "referenceCount": 8,
    "citationCount": 0,
    "influentialCitationCount": 0,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This project introduces an even more lightweight DPO-Convex algorithm that operates on one GPU, by leveraging the convex optimization reformulation of Neural Networks (NNs) by leveraging the convex optimization reformulation of Neural Networks (NNs)."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -4.389346122741699,
            2.2864959239959717,
            -0.1906176656484604,
            4.425495147705078,
            -1.458009958267212,
            2.0752665996551514,
            2.671801805496216,
            -2.9831199645996094,
            -0.355583518743515,
            -1.4067063331604004,
            -3.534374713897705,
            2.1030492782592773,
            0.6452227830886841,
            -1.3982932567596436,
            -5.705937385559082,
            0.8592745065689087,
            -1.7044050693511963,
            0.9113863706588745,
            4.479872703552246,
            3.7377431392669678,
            -4.002684116363525,
            0.5013994574546814,
            -2.39743971824646,
            0.8186665773391724,
            -1.8779675960540771,
            -1.045884609222412,
            2.008880138397217,
            2.2767646312713623,
            1.1043004989624023,
            -2.864962577819824,
            4.2993364334106445,
            -5.565397262573242,
            7.242554664611816,
            -3.4232542514801025,
            4.7635087966918945,
            -3.295504331588745,
            -3.3206677436828613,
            7.235591411590576,
            -3.017327308654785,
            -1.037613868713379,
            -0.8561278581619263,
            1.8947694301605225,
            1.0412360429763794,
            1.6630316972732544,
            -0.24959364533424377,
            1.5636333227157593,
            3.1759109497070312,
            0.626250147819519,
            0.3670370280742645,
            1.3582391738891602,
            4.610740661621094,
            2.2241272926330566,
            0.20378850400447845,
            2.8744595050811768,
            -1.1487560272216797,
            -1.0017341375350952,
            -1.042255163192749,
            2.2652668952941895,
            2.2473888397216797,
            -1.2301007509231567,
            2.9178125858306885,
            4.238701820373535,
            -2.4729385375976562,
            2.793184757232666,
            0.5714700222015381,
            -6.477207183837891,
            -0.09130854904651642,
            8.159968376159668,
            -0.3505706787109375,
            1.936023473739624,
            -3.32090425491333,
            -4.551534175872803,
            0.2575329542160034,
            -0.13786056637763977,
            -2.6747450828552246,
            0.1115415096282959,
            -2.3864879608154297,
            -5.943922996520996,
            1.609299898147583,
            -2.2167491912841797,
            0.9640594720840454,
            1.3241198062896729,
            2.040480136871338,
            1.4607536792755127,
            2.7216596603393555,
            -2.122002124786377,
            -4.299289226531982,
            -1.4930241107940674,
            3.0650577545166016,
            -6.945606231689453,
            0.22181212902069092,
            -0.3954017460346222,
            1.9601080417633057,
            0.9297170042991638,
            -3.3991804122924805,
            0.477157860994339,
            -0.7749936580657959,
            -1.9537811279296875,
            -2.515807628631592,
            -0.04547238349914551,
            1.565435528755188,
            -0.6710107326507568,
            0.09570249915122986,
            0.47939354181289673,
            5.301029682159424,
            -1.6329833269119263,
            -0.7242985963821411,
            3.4173412322998047,
            2.558720588684082,
            -1.4114807844161987,
            -2.996929883956909,
            2.758064031600952,
            -3.5079729557037354,
            0.3997536897659302,
            -1.1471059322357178,
            -0.05992072820663452,
            -1.8745336532592773,
            0.3323073387145996,
            -1.14738929271698,
            4.0313920974731445,
            -1.7234477996826172,
            -2.720515489578247,
            -3.829101085662842,
            -0.45398402214050293,
            -0.37788593769073486,
            1.9929641485214233,
            -0.39363014698028564,
            0.5436123013496399,
            -1.1887712478637695,
            -5.126018047332764,
            0.823611855506897,
            -3.0777573585510254,
            1.765832543373108,
            -1.411455750465393,
            4.591071128845215,
            0.7643851041793823,
            -3.835407018661499,
            -0.03484445810317993,
            -1.7431154251098633,
            -0.243304044008255,
            -1.7746021747589111,
            2.9315357208251953,
            1.0285823345184326,
            -0.7319005131721497,
            3.2185311317443848,
            3.4616198539733887,
            1.072483777999878,
            2.9732203483581543,
            2.5032780170440674,
            4.692551612854004,
            3.9579904079437256,
            -3.770477056503296,
            3.3494365215301514,
            3.066164255142212,
            -0.5569514632225037,
            3.3496570587158203,
            0.5045472979545593,
            -0.7458925843238831,
            0.6781790852546692,
            -0.9722722768783569,
            -0.29154157638549805,
            -2.007246494293213,
            -9.252941131591797,
            -1.0764598846435547,
            1.8043540716171265,
            -3.671515464782715,
            -1.8744266033172607,
            1.6285150051116943,
            1.1011621952056885,
            -1.1471620798110962,
            0.2614445686340332,
            4.645053386688232,
            1.7588233947753906,
            5.631401062011719,
            2.7334954738616943,
            3.5811386108398438,
            2.114834785461426,
            -1.6642098426818848,
            -0.3286172151565552,
            1.936409592628479,
            0.3316861391067505,
            0.457802414894104,
            -5.727549076080322,
            0.3856428861618042,
            -3.750884532928467,
            -4.85760498046875,
            -3.729994058609009,
            -0.4259463846683502,
            -1.6611268520355225,
            0.38695675134658813,
            -1.9036394357681274,
            2.397719621658325,
            3.498541831970215,
            6.339963436126709,
            4.648273468017578,
            -0.878543496131897,
            1.477621078491211,
            2.21134352684021,
            -2.5715150833129883,
            0.5725705623626709,
            6.284036636352539,
            -0.163396418094635,
            -0.7388606667518616,
            -0.4799123704433441,
            5.896132946014404,
            5.1404709815979,
            -2.443826198577881,
            2.7373886108398438,
            -2.4250130653381348,
            0.11407783627510071,
            0.8469518423080444,
            0.029862403869628906,
            -1.8625810146331787,
            -4.146045684814453,
            -3.452178955078125,
            -3.5437204837799072,
            -3.6729543209075928,
            0.5809078812599182,
            2.3978114128112793,
            0.05563783645629883,
            -0.15576553344726562,
            -0.7843219041824341,
            -0.20173227787017822,
            -4.398591995239258,
            1.2453105449676514,
            -1.505353331565857,
            1.5515060424804688,
            0.7047119140625,
            1.020272135734558,
            2.5763370990753174,
            -1.9895657300949097,
            -4.202417373657227,
            1.6755043268203735,
            -1.0084388256072998,
            -7.12817907333374,
            -3.362022876739502,
            -4.345961093902588,
            0.4318872094154358,
            -2.1566858291625977,
            3.457982063293457,
            4.503565788269043,
            -1.8300316333770752,
            2.747399091720581,
            5.1434326171875,
            1.3448323011398315,
            -1.2284424304962158,
            -1.1314008235931396,
            -1.7493816614151,
            -4.283649444580078,
            1.2293094396591187,
            0.6834864616394043,
            -3.459137201309204,
            0.41519469022750854,
            -1.702716588973999,
            2.7051186561584473,
            5.66674280166626,
            0.9469321966171265,
            0.9287654757499695,
            -2.370033025741577,
            -0.07889378070831299,
            0.9634098410606384,
            4.859149932861328,
            0.7238819599151611,
            5.715859413146973,
            -0.544061005115509,
            -0.7182872295379639,
            -2.9980525970458984,
            -2.8163833618164062,
            -4.165873050689697,
            2.4409165382385254,
            2.456214427947998,
            3.56773042678833,
            0.40350210666656494,
            -8.097580909729004,
            -1.888519048690796,
            -4.945361614227295,
            -3.091297149658203,
            -3.119696617126465,
            2.2466840744018555,
            4.183513641357422,
            1.599793553352356,
            -0.6385476589202881,
            -0.26906734704971313,
            -3.4010002613067627,
            -4.4335808753967285,
            -1.7691869735717773,
            -4.643798828125,
            -0.7577066421508789,
            2.9086928367614746,
            -2.6408979892730713,
            -2.363072156906128,
            1.8526445627212524,
            -3.567777633666992,
            1.8405091762542725,
            -3.254800319671631,
            0.43803924322128296,
            4.12685489654541,
            -2.8125476837158203,
            -1.4454032182693481,
            0.5462664365768433,
            0.4150439500808716,
            4.190587043762207,
            3.818039655685425,
            -1.778884768486023,
            0.7244024872779846,
            7.765214920043945,
            1.306748628616333,
            -2.6255874633789062,
            1.2622029781341553,
            -3.01737117767334,
            -2.391266107559204,
            -1.813774824142456,
            6.00045919418335,
            -5.319480895996094,
            0.015667274594306946,
            0.981520414352417,
            3.9622740745544434,
            1.1971677541732788,
            -2.0122575759887695,
            2.5485568046569824,
            -1.483449935913086,
            0.35909104347229004,
            -4.757789611816406,
            -2.4608659744262695,
            -2.621969699859619,
            0.5447311401367188,
            2.857919692993164,
            3.687709331512451,
            -2.2003018856048584,
            0.28593188524246216,
            -1.5780600309371948,
            7.634011268615723,
            4.109655857086182,
            7.589934825897217,
            -0.4107336103916168,
            -4.19019889831543,
            -1.3831090927124023,
            -1.032189130783081,
            -0.1450989544391632,
            -0.4995192587375641,
            0.22560632228851318,
            5.500205993652344,
            -1.9924516677856445,
            -3.1377573013305664,
            -1.0415709018707275,
            -2.049797773361206,
            0.44107159972190857,
            -3.203773260116577,
            -0.2747095227241516,
            -0.2252972424030304,
            1.9634888172149658,
            1.3976249694824219,
            -0.5813966393470764,
            -1.6623910665512085,
            3.1811137199401855,
            3.640935182571411,
            3.086653232574463,
            0.7037132978439331,
            3.773390769958496,
            2.332995891571045,
            -1.8565410375595093,
            1.2902896404266357,
            2.0147407054901123,
            -1.3405297994613647,
            -2.0427536964416504,
            -1.818404197692871,
            9.10963249206543,
            -0.7552893161773682,
            3.210986375808716,
            -1.8214365243911743,
            -2.219684600830078,
            -1.6003587245941162,
            -2.5929903984069824,
            1.8649787902832031,
            -0.4059942364692688,
            -1.180849313735962,
            0.6546018123626709,
            -2.447600841522217,
            1.7731130123138428,
            1.9703354835510254,
            -1.2464861869812012,
            1.343327522277832,
            1.5896880626678467,
            2.721595287322998,
            -1.9407596588134766,
            0.6497054696083069,
            -0.3362880051136017,
            -1.0207562446594238,
            1.5437166690826416,
            2.780832290649414,
            -4.10357666015625,
            1.910428762435913,
            -1.0046786069869995,
            3.0109753608703613,
            1.1316196918487549,
            -2.2199912071228027,
            -3.7312405109405518,
            -1.4546821117401123,
            -1.04616117477417,
            3.64542555809021,
            -1.1602188348770142,
            0.7285610437393188,
            3.9550957679748535,
            3.9938015937805176,
            -4.692987442016602,
            -1.3088948726654053,
            1.807745099067688,
            -2.61688232421875,
            -2.3592820167541504,
            1.1592483520507812,
            -2.2031617164611816,
            -3.4895224571228027,
            -1.1869007349014282,
            -6.924907684326172,
            -1.6782115697860718,
            -2.4011635780334473,
            -0.9382063150405884,
            6.743549823760986,
            2.5068817138671875,
            2.818244695663452,
            -0.27790313959121704,
            2.4330201148986816,
            5.023435115814209,
            4.450626373291016,
            -1.537144660949707,
            2.8802924156188965,
            3.929084062576294,
            0.014637291431427002,
            -1.6886006593704224,
            4.219453811645508,
            -0.749931812286377,
            4.841713905334473,
            -1.510336995124817,
            2.888072967529297,
            0.8919116258621216,
            3.600713014602661,
            3.2737717628479004,
            5.517009735107422,
            -0.2989082336425781,
            1.2977505922317505,
            0.22042343020439148,
            1.7853617668151855,
            -2.9646120071411133,
            5.967947959899902,
            0.519327700138092,
            3.135380506515503,
            -1.7135124206542969,
            0.3412392735481262,
            -1.6869091987609863,
            -4.203280448913574,
            2.7188310623168945,
            -2.802783489227295,
            -4.344692230224609,
            -2.6455934047698975,
            2.454822063446045,
            2.721174478530884,
            -0.3289029002189636,
            -2.0364370346069336,
            1.433897614479065,
            0.06491565704345703,
            -4.482935428619385,
            4.931964874267578,
            2.4006621837615967,
            0.772521436214447,
            -1.8227204084396362,
            2.060555934906006,
            -3.050165891647339,
            -4.728095054626465,
            -0.272471159696579,
            0.394120991230011,
            -2.358670711517334,
            -1.4618585109710693,
            -1.1189029216766357,
            -0.4870796799659729,
            1.4880404472351074,
            -0.1953085958957672,
            3.688600540161133,
            0.3472631871700287,
            -1.2157599925994873,
            -2.9187045097351074,
            -0.36754918098449707,
            -0.9005495309829712,
            5.517488479614258,
            -2.936662435531616,
            -4.866029739379883,
            5.888027191162109,
            1.9670164585113525,
            2.703335762023926,
            2.89644193649292,
            2.2415173053741455,
            -1.9789011478424072,
            1.7935073375701904,
            5.703085899353027,
            0.9675647616386414,
            1.7603733539581299,
            1.0783138275146484,
            -6.2466864585876465,
            3.6097092628479004,
            -0.6170205473899841,
            0.9797394871711731,
            1.3379814624786377,
            -3.436595916748047,
            0.146303191781044,
            -1.619121789932251,
            -3.978818416595459,
            2.152350902557373,
            2.302100658416748,
            2.840144157409668,
            -3.535428047180176,
            1.1724797487258911,
            -0.6539704203605652,
            2.1498570442199707,
            -4.036144256591797,
            2.1397910118103027,
            -3.0325160026550293,
            1.2335573434829712,
            4.241022109985352,
            -1.516655683517456,
            0.5387715697288513,
            2.086662530899048,
            -3.412440538406372,
            1.2073934078216553,
            -3.668921947479248,
            0.20485107600688934,
            2.7915291786193848,
            1.5776597261428833,
            -4.13688850402832,
            0.3811121881008148,
            1.4659605026245117,
            5.9600324630737305,
            4.813837051391602,
            6.220203876495361,
            2.6114656925201416,
            -4.796696186065674,
            -3.1075286865234375,
            -3.1800379753112793,
            1.9226856231689453,
            5.0250115394592285,
            -2.8172101974487305,
            -3.20963716506958,
            -2.1624438762664795,
            -1.31308913230896,
            -2.170850992202759,
            1.3348733186721802,
            -0.5484998226165771,
            4.156681537628174,
            -5.003569602966309,
            1.6463088989257812,
            -2.162811040878296,
            2.119396209716797,
            1.219509482383728,
            -0.05266284942626953,
            -1.7577252388000488,
            -2.409315347671509,
            -6.229053974151611,
            -2.35609769821167,
            -1.5775467157363892,
            -1.38007652759552,
            -1.310590386390686,
            1.6915738582611084,
            1.353471040725708,
            -4.737536430358887,
            -1.5258909463882446,
            1.6791422367095947,
            -2.87283992767334,
            -1.6007678508758545,
            -3.2060234546661377,
            4.056777000427246,
            -0.9835304021835327,
            -1.1363530158996582,
            -0.3636792004108429,
            -0.9887648820877075,
            -0.9785456657409668,
            -1.2308306694030762,
            -0.02417495846748352,
            0.9656707048416138,
            3.7220122814178467,
            4.339286804199219,
            -0.6290161609649658,
            -0.5342461466789246,
            -0.6973468065261841,
            -4.378423690795898,
            0.1703689694404602,
            -3.5500359535217285,
            -1.4141671657562256,
            -2.203068971633911,
            -0.1389666497707367,
            4.595674514770508,
            -5.506532192230225,
            -0.8717852830886841,
            2.8772029876708984,
            -2.0863752365112305,
            0.22149980068206787,
            -6.812479019165039,
            0.5384789705276489,
            -3.2568697929382324,
            3.3467020988464355,
            3.218747615814209,
            -1.2460664510726929,
            2.0013787746429443,
            2.7916367053985596,
            3.8623642921447754,
            4.304089546203613,
            -1.5003793239593506,
            -1.808410406112671,
            -0.11853575706481934,
            2.620744228363037,
            0.9424111247062683,
            -3.266645908355713,
            -1.5551369190216064,
            0.8584173917770386,
            1.4288883209228516,
            17.927263259887695,
            -0.9279389381408691,
            0.9816489219665527,
            -0.8801391124725342,
            -1.2245802879333496,
            -4.990632057189941,
            -3.367518663406372,
            5.489753246307373,
            -1.5055885314941406,
            2.293611526489258,
            -3.0750670433044434,
            -3.300107955932617,
            -1.2307474613189697,
            2.267213821411133,
            -4.785674571990967,
            1.4934558868408203,
            -1.9607234001159668,
            2.647721290588379,
            -0.3513718843460083,
            0.07835954427719116,
            -2.343069553375244,
            3.1850697994232178,
            -2.5204057693481445,
            -1.35386061668396,
            3.1612043380737305,
            2.8882458209991455,
            3.617429494857788,
            2.6650168895721436,
            -4.791033744812012,
            2.4961957931518555,
            2.9163763523101807,
            1.881344199180603,
            -0.3820051848888397,
            1.606982707977295,
            -0.47897112369537354,
            4.139615058898926,
            4.091526985168457,
            0.16432350873947144,
            3.064862012863159,
            1.159192442893982,
            -0.29169395565986633,
            -1.9424684047698975,
            -1.5617213249206543,
            2.2381253242492676,
            -5.403104782104492,
            2.525010108947754,
            1.3157804012298584,
            -2.8535194396972656,
            -1.5385606288909912,
            3.5244874954223633,
            -1.3669475317001343,
            -1.5720150470733643,
            -4.963315486907959,
            0.8335654139518738,
            1.981510877609253,
            1.1173783540725708,
            1.0709328651428223,
            -3.0124783515930176,
            4.92303466796875,
            0.607680082321167,
            0.70489102602005,
            -1.29654860496521,
            -0.4920497536659241,
            -3.6810081005096436,
            0.630507230758667,
            2.323760509490967,
            -2.204820156097412,
            0.7780663371086121,
            3.406191349029541,
            3.7652876377105713,
            3.4623255729675293,
            -0.5889408588409424,
            2.2697606086730957,
            -2.8255224227905273,
            -1.2677857875823975,
            -2.424402952194214,
            4.636532783508301,
            0.06177365779876709,
            1.86183762550354,
            5.679740905761719,
            -1.0331693887710571,
            0.7220660448074341,
            -0.03586935997009277,
            -1.9644296169281006,
            2.271758556365967,
            -4.725176811218262,
            4.552585601806641,
            0.8868026733398438,
            -2.8737499713897705,
            2.3563013076782227,
            0.7530399560928345,
            0.016649484634399414,
            1.2382400035858154,
            0.9232573509216309,
            1.594006896018982,
            -2.5581717491149902,
            -3.3692688941955566,
            -0.9576506614685059,
            -6.251779079437256,
            -3.1128058433532715,
            7.261648178100586,
            1.802047848701477,
            2.7513577938079834,
            -0.042525842785835266,
            0.9501181244850159,
            -0.08694663643836975,
            -2.02022647857666,
            -5.675365447998047,
            -4.752901077270508,
            -1.640357255935669,
            3.8840560913085938,
            -5.941827297210693,
            -3.3265695571899414,
            0.11729651689529419,
            0.9749183654785156,
            -4.0788397789001465,
            1.5134010314941406,
            1.7910252809524536,
            0.29365038871765137,
            3.7049853801727295,
            0.2717098295688629,
            -2.146152973175049,
            0.33472710847854614,
            -2.291445255279541,
            1.6462891101837158,
            2.3324899673461914,
            -0.16857612133026123,
            -0.412475049495697,
            -0.04076394438743591,
            -0.673913300037384,
            2.3772170543670654,
            -4.911236763000488,
            -3.9193973541259766,
            -2.322697639465332,
            -2.6919913291931152,
            -3.2064578533172607,
            0.07869361340999603,
            -1.639844298362732,
            -3.987919330596924,
            2.0167031288146973,
            2.794528007507324,
            -5.512078285217285,
            -3.063040256500244,
            9.327814102172852,
            -0.31100624799728394,
            -0.8971037864685059,
            1.031846284866333,
            -1.0638463497161865,
            -0.07815766334533691,
            4.482386589050293,
            1.6768121719360352,
            -1.4250667095184326,
            3.679515838623047,
            -1.343092679977417,
            1.4960689544677734,
            -2.334920883178711
        ]
    },
    "authors": [
        {
            "authorId": "2220791003",
            "name": "Stanford CS224N"
        },
        {
            "authorId": "2285220441",
            "name": "Custom Project"
        },
        {
            "authorId": "2316111079",
            "name": "Miria Feng"
        }
    ],
    "references": [
        {
            "paperId": "dff9fb8b3a0af0a26e8ab8fffac75580cdcc041b",
            "title": "Is RLHF More Difficult than Standard RL?"
        },
        {
            "paperId": "0d1c76d45afa012ded7ab741194baf142117c495",
            "title": "Direct Preference Optimization: Your Language Model is Secretly a Reward Model"
        },
        {
            "paperId": "574072ae4556649de1c59d8f284955730f5a71a0",
            "title": "A Short Study on Compressing Decoder-Based Language Models"
        },
        {
            "paperId": "7fd8e4f6e9dff9e68ce869db1c9f60cf08f3b2a7",
            "title": "JAX, M.D. A framework for differentiable physics"
        },
        {
            "paperId": "9705b124f6d3bb77c4bc3ce3d83c2f2ebe8ee770",
            "title": "Neural Networks are Convex Regularizers: Exact Polynomial-time Convex Optimization Formulations for Two-Layer Networks"
        },
        {
            "paperId": "71b44025d88f5aa1c03f164fa9fb82fb2dcd127c",
            "title": "Generalized symmetric ADMM for separable convex optimization"
        },
        {
            "paperId": "758b1d823ac975720e6e81e375cd4432009e5bca",
            "title": "Convex Neural Networks"
        }
    ]
}