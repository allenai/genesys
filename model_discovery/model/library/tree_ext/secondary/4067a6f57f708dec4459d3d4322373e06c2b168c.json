{
    "paperId": "4067a6f57f708dec4459d3d4322373e06c2b168c",
    "externalIds": {
        "ArXiv": "2311.13581",
        "DBLP": "journals/corr/abs-2311-13581",
        "DOI": "10.48550/arXiv.2311.13581",
        "CorpusId": 265351429
    },
    "title": "PaSS: Parallel Speculative Sampling",
    "abstract": "Scaling the size of language models to tens of billions of parameters has led to impressive performance on a wide range of tasks. At generation, these models are used auto-regressively, requiring a forward pass for each generated token, and thus reading the full set of parameters from memory. This memory access forms the primary bottleneck for generation and it worsens as the model size increases. Moreover, executing a forward pass for multiple tokens in parallel often takes nearly the same time as it does for just one token. These two observations lead to the development of speculative sampling, where a second smaller model is used to draft a few tokens, that are then validated or rejected using a single forward pass of the large model. Unfortunately, this method requires two models that share the same tokenizer and thus limits its adoption. As an alternative, we propose to use parallel decoding as a way to draft multiple tokens from a single model with no computational cost, nor the need for a second model. Our approach only requires an additional input token that marks the words that will be generated simultaneously. We show promising performance (up to $30\\%$ speed-up) while requiring only as few as $O(d_{emb})$ additional parameters.",
    "venue": "arXiv.org",
    "year": 2023,
    "referenceCount": 11,
    "citationCount": 15,
    "influentialCitationCount": 2,
    "openAccessPdf": null,
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work proposes to use parallel decoding as a way to draft multiple tokens from a single model with no computational cost, nor the need for a second model, and shows promising performance while requiring only as few as $O(d_{emb})$ additional parameters."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -2.8928611278533936,
            -0.9012241363525391,
            -1.9338412284851074,
            2.65263295173645,
            1.0328726768493652,
            1.2103105783462524,
            2.542882204055786,
            2.0569443702697754,
            0.20869004726409912,
            2.256293773651123,
            1.522271752357483,
            4.3204345703125,
            3.6296846866607666,
            -3.7357964515686035,
            -4.203101634979248,
            -1.5484676361083984,
            1.1678509712219238,
            -2.512131452560425,
            6.174994468688965,
            6.055755615234375,
            -1.1547107696533203,
            2.148632287979126,
            -2.625366449356079,
            1.050020456314087,
            -2.6029231548309326,
            0.9630694389343262,
            -0.057418957352638245,
            -0.7796128988265991,
            -3.5287961959838867,
            1.7597599029541016,
            -3.814089775085449,
            -4.367128372192383,
            4.365436553955078,
            -6.117661476135254,
            4.388538360595703,
            -4.518614768981934,
            -0.7786348462104797,
            7.20440673828125,
            -4.566866874694824,
            -0.3644680678844452,
            1.6701247692108154,
            0.7554356455802917,
            -1.5370581150054932,
            0.5797080993652344,
            2.8361051082611084,
            2.2018094062805176,
            2.420665740966797,
            1.7510356903076172,
            -1.9539484977722168,
            3.308338165283203,
            2.7416486740112305,
            -0.03234574943780899,
            -0.6974500417709351,
            2.311443328857422,
            0.33400845527648926,
            -1.3073891401290894,
            0.03938305377960205,
            -1.2319689989089966,
            1.316516399383545,
            -6.263942241668701,
            5.255856513977051,
            3.570875406265259,
            -1.6750032901763916,
            -2.3728530406951904,
            4.5721588134765625,
            -4.00677490234375,
            -1.2627581357955933,
            5.429699420928955,
            3.617335319519043,
            2.0352227687835693,
            -0.8837622404098511,
            -3.496229887008667,
            2.6371777057647705,
            -0.05583983659744263,
            -5.6021504402160645,
            0.25433269143104553,
            -0.9246941804885864,
            -2.9420061111450195,
            -1.4106922149658203,
            -2.447403907775879,
            -1.9563400745391846,
            0.42753005027770996,
            0.4385344684123993,
            5.22111701965332,
            1.7243590354919434,
            0.03397485613822937,
            -2.810849189758301,
            -1.3133180141448975,
            4.028985023498535,
            1.0105992555618286,
            4.2263336181640625,
            -2.711606979370117,
            -1.375564694404602,
            2.8729372024536133,
            -5.307817459106445,
            -1.6913853883743286,
            -1.5271233320236206,
            1.152771234512329,
            1.021099328994751,
            1.2394558191299438,
            3.1971817016601562,
            -1.2814714908599854,
            2.154109001159668,
            -2.9599740505218506,
            5.699342727661133,
            -1.6860997676849365,
            1.1778712272644043,
            3.5132861137390137,
            0.8392168283462524,
            -5.4700093269348145,
            0.589286744594574,
            1.6107416152954102,
            -2.0192153453826904,
            -1.5861315727233887,
            -1.491391658782959,
            -3.3095240592956543,
            -1.8464558124542236,
            -1.8694581985473633,
            -4.708566188812256,
            1.1583538055419922,
            -0.36640506982803345,
            -1.965682864189148,
            -1.035966396331787,
            0.9278501272201538,
            0.6895884275436401,
            0.04298248887062073,
            -2.768648624420166,
            -0.8246865272521973,
            0.7272790670394897,
            -2.322551727294922,
            1.1683800220489502,
            0.20144933462142944,
            3.6066243648529053,
            -4.080909729003906,
            1.5430920124053955,
            3.187875986099243,
            -4.019855976104736,
            0.2554395794868469,
            -1.2275328636169434,
            1.7795679569244385,
            2.7423272132873535,
            5.14630126953125,
            -1.2056140899658203,
            1.1140719652175903,
            0.9692350625991821,
            5.1203389167785645,
            1.4894107580184937,
            0.7889528274536133,
            -2.376646041870117,
            4.104339122772217,
            6.125327110290527,
            -0.19777055084705353,
            1.4199376106262207,
            -1.226033091545105,
            1.7091583013534546,
            4.683234691619873,
            -2.174290657043457,
            0.22282914817333221,
            -1.2911772727966309,
            0.5515112280845642,
            -2.0837836265563965,
            -3.66581130027771,
            -9.57603645324707,
            -2.4911065101623535,
            2.6524016857147217,
            -5.347780227661133,
            -3.10341739654541,
            1.1943368911743164,
            2.5269365310668945,
            0.9784404039382935,
            -4.468991279602051,
            2.0712244510650635,
            2.1175153255462646,
            0.835922122001648,
            5.5516815185546875,
            3.2021336555480957,
            -0.5185661911964417,
            -1.9332760572433472,
            1.462758183479309,
            -1.6323943138122559,
            0.643876850605011,
            -0.757453203201294,
            -4.716611385345459,
            3.4776687622070312,
            -6.193408966064453,
            -2.4344918727874756,
            -2.891252040863037,
            -2.8823516368865967,
            0.5018342733383179,
            -0.8670108914375305,
            -1.4566606283187866,
            -0.9267003536224365,
            5.515926361083984,
            4.568875312805176,
            0.4524156451225281,
            -0.6415219306945801,
            5.377100944519043,
            2.4743576049804688,
            -2.20628023147583,
            1.4157865047454834,
            -0.4681234061717987,
            0.829438328742981,
            -2.067203998565674,
            0.7248693704605103,
            4.360461235046387,
            -1.1762210130691528,
            -0.022058606147766113,
            1.8058130741119385,
            1.1172820329666138,
            1.6607609987258911,
            2.4479854106903076,
            -1.5286321640014648,
            -4.074059963226318,
            -1.56524658203125,
            -2.156445026397705,
            -3.163755416870117,
            -9.04676342010498,
            1.6022206544876099,
            6.0404863357543945,
            -0.5802323818206787,
            -0.8025407791137695,
            -0.19324690103530884,
            1.4153251647949219,
            -4.423068046569824,
            -0.3155277967453003,
            0.501719057559967,
            3.156339645385742,
            -0.39159148931503296,
            2.4965875148773193,
            0.5883680582046509,
            -3.259932518005371,
            -3.404033660888672,
            -1.5910181999206543,
            -0.7661753296852112,
            -2.2395498752593994,
            -0.9358512163162231,
            -4.946822166442871,
            -0.4074113070964813,
            0.35061344504356384,
            0.4831184148788452,
            4.403039932250977,
            0.8773741722106934,
            -1.0691378116607666,
            4.233564853668213,
            2.2557666301727295,
            -1.2173618078231812,
            -0.16737225651741028,
            1.0919597148895264,
            -0.12706346809864044,
            -1.3988831043243408,
            2.4142074584960938,
            -2.0249576568603516,
            1.672755479812622,
            2.475930690765381,
            3.7278571128845215,
            3.360285758972168,
            0.6984522938728333,
            -2.0929205417633057,
            -0.14296896755695343,
            0.7658637166023254,
            -4.129110336303711,
            5.0884270668029785,
            3.665165901184082,
            3.1081533432006836,
            -1.3610939979553223,
            -1.727318286895752,
            -4.173717498779297,
            1.4885177612304688,
            1.9474072456359863,
            1.7889264822006226,
            3.38850736618042,
            2.5278663635253906,
            -3.1521847248077393,
            -4.341510772705078,
            1.5779309272766113,
            -8.133652687072754,
            -1.9280641078948975,
            -0.8848262429237366,
            1.1341184377670288,
            5.43863582611084,
            5.200069904327393,
            -3.762186050415039,
            -1.9740585088729858,
            1.0020534992218018,
            -0.8990095853805542,
            -4.19946813583374,
            -1.281387209892273,
            0.933296263217926,
            -2.404430866241455,
            -0.4029161334037781,
            -0.24752560257911682,
            6.378840446472168,
            -2.9966211318969727,
            -4.141572952270508,
            -3.5396528244018555,
            0.6662753820419312,
            6.189925193786621,
            -0.1967303603887558,
            -3.0708491802215576,
            -2.4338817596435547,
            -1.4506549835205078,
            3.448665142059326,
            1.920579433441162,
            1.690413236618042,
            -0.8985249996185303,
            1.2507023811340332,
            -1.6331837177276611,
            -3.070253372192383,
            0.3053662180900574,
            -4.845767498016357,
            -0.3042306900024414,
            2.4875569343566895,
            5.854347229003906,
            -5.922063827514648,
            -0.2248452603816986,
            -1.0477553606033325,
            3.1998541355133057,
            -3.166548728942871,
            -1.3430981636047363,
            2.6111886501312256,
            -1.1273221969604492,
            -0.6600922346115112,
            -3.9644196033477783,
            -2.049692392349243,
            -3.5741264820098877,
            -1.2067028284072876,
            4.2695465087890625,
            0.49248558282852173,
            -1.6880171298980713,
            3.4254298210144043,
            2.4954237937927246,
            3.6580915451049805,
            1.5335705280303955,
            4.189204216003418,
            -3.1332828998565674,
            -2.297454357147217,
            1.0091876983642578,
            -3.59440279006958,
            0.7261772155761719,
            -1.3217774629592896,
            -0.4924624562263489,
            6.230700492858887,
            -1.0892424583435059,
            1.8408877849578857,
            0.32879167795181274,
            0.27940958738327026,
            -0.04063040018081665,
            2.018061637878418,
            -1.135035514831543,
            -1.578314185142517,
            0.3343268036842346,
            1.4731744527816772,
            4.955727577209473,
            1.117110252380371,
            2.0632522106170654,
            3.605607032775879,
            2.737509250640869,
            0.9537129402160645,
            1.0430934429168701,
            -1.0913065671920776,
            0.8831620216369629,
            0.7708926200866699,
            4.111605644226074,
            -0.10685088485479355,
            -1.8305445909500122,
            -6.952589511871338,
            12.92120361328125,
            -2.249910831451416,
            0.9711135625839233,
            -2.552460193634033,
            -0.9607998132705688,
            -3.0950934886932373,
            -3.1595985889434814,
            0.7791541814804077,
            -2.5298867225646973,
            -2.614144802093506,
            1.0953818559646606,
            -7.380180358886719,
            -0.3703465461730957,
            0.7712517976760864,
            -0.2820800542831421,
            5.44122838973999,
            -3.208864212036133,
            3.2326128482818604,
            1.741287350654602,
            0.30553844571113586,
            -2.520371198654175,
            0.2776916027069092,
            0.15725144743919373,
            -1.2481811046600342,
            -3.467548370361328,
            0.34027746319770813,
            0.21204809844493866,
            2.652200937271118,
            -3.1504483222961426,
            -2.3419551849365234,
            -1.9521822929382324,
            -0.9883472919464111,
            -0.3448503613471985,
            1.112649917602539,
            -0.5576646327972412,
            -2.0869457721710205,
            6.2959113121032715,
            5.135540008544922,
            -4.10775899887085,
            -1.1390559673309326,
            3.7397303581237793,
            2.4047751426696777,
            -3.6147232055664062,
            -0.556331992149353,
            -1.3427796363830566,
            -5.488224029541016,
            -4.229710578918457,
            -1.1506359577178955,
            -1.9239563941955566,
            0.6029478311538696,
            5.598756313323975,
            5.197511196136475,
            -0.10478538274765015,
            1.487565279006958,
            -0.4075680673122406,
            2.4434127807617188,
            7.0510334968566895,
            5.316275119781494,
            -0.7888983488082886,
            0.5930869579315186,
            2.632416009902954,
            0.9302517771720886,
            -3.827676296234131,
            1.4313616752624512,
            -0.9336256980895996,
            1.627699613571167,
            -3.631833076477051,
            -1.1835176944732666,
            0.855256974697113,
            -0.47272759675979614,
            -0.18179816007614136,
            -0.877438485622406,
            -0.8917858600616455,
            -2.5606839656829834,
            0.1040111780166626,
            4.770410060882568,
            -0.8006868362426758,
            0.4933158755302429,
            2.004629373550415,
            4.514958381652832,
            1.6673369407653809,
            -1.3051129579544067,
            -3.2098045349121094,
            -1.2706339359283447,
            4.03665018081665,
            -7.326346397399902,
            -2.127420663833618,
            -3.20782470703125,
            0.4520312547683716,
            0.39895913004875183,
            0.16216212511062622,
            -1.6330242156982422,
            0.4851815104484558,
            -1.634831428527832,
            -1.2035582065582275,
            3.7799875736236572,
            -1.706804633140564,
            1.063283920288086,
            0.7504388093948364,
            -2.1492276191711426,
            0.12384960055351257,
            -2.2601935863494873,
            4.437542915344238,
            1.9614036083221436,
            -1.0394032001495361,
            0.2730838656425476,
            -3.8381781578063965,
            3.8393521308898926,
            2.404486656188965,
            -0.1449851393699646,
            2.5070505142211914,
            -0.5058404803276062,
            0.19856546819210052,
            -5.196281909942627,
            -3.39677095413208,
            -1.106920599937439,
            4.770439147949219,
            -0.7323756814002991,
            -0.9469372630119324,
            3.2942962646484375,
            2.1948187351226807,
            0.10083962231874466,
            -0.7302865982055664,
            1.4223467111587524,
            3.528919219970703,
            0.34064167737960815,
            6.604732036590576,
            -1.6220122575759888,
            -1.4798579216003418,
            1.547849178314209,
            -4.3487653732299805,
            -0.8323490619659424,
            -0.23918193578720093,
            -1.1539223194122314,
            -1.883803367614746,
            -7.183964729309082,
            -0.2839917242527008,
            -2.59039044380188,
            -4.491941928863525,
            5.896156311035156,
            2.399738311767578,
            2.808872699737549,
            1.314046025276184,
            0.9139536619186401,
            -0.7602184414863586,
            1.4311246871948242,
            -7.0669989585876465,
            0.05546674132347107,
            0.48644477128982544,
            0.7152836322784424,
            4.990097999572754,
            2.2166330814361572,
            1.7157875299453735,
            -3.309518814086914,
            -2.84185791015625,
            -0.9522461891174316,
            -1.3020225763320923,
            0.44543546438217163,
            -0.044629573822021484,
            0.573917031288147,
            1.5675773620605469,
            2.9047279357910156,
            0.363608181476593,
            4.973966598510742,
            3.9532055854797363,
            4.410356521606445,
            -0.204483762383461,
            -2.8234806060791016,
            0.47056448459625244,
            -0.10402853786945343,
            1.0286998748779297,
            3.4086692333221436,
            -2.5954947471618652,
            -2.4508490562438965,
            -0.715811550617218,
            3.5389678478240967,
            -2.772582530975342,
            5.275103569030762,
            -1.9464185237884521,
            5.84779167175293,
            -2.657621383666992,
            -0.47606533765792847,
            -3.7150888442993164,
            3.12056827545166,
            2.4512321949005127,
            -0.8683959245681763,
            2.4284520149230957,
            1.0282022953033447,
            -2.7625184059143066,
            -2.4221508502960205,
            -0.5892462730407715,
            -1.751476526260376,
            -0.3962026834487915,
            8.202431678771973,
            4.040851593017578,
            -0.018615245819091797,
            2.0385189056396484,
            1.9782097339630127,
            -0.6262337565422058,
            -1.7069674730300903,
            0.5876741409301758,
            3.7631001472473145,
            0.42864611744880676,
            -1.6855087280273438,
            -0.025644540786743164,
            -0.2605040669441223,
            0.6629921197891235,
            -0.15209853649139404,
            -0.2351571023464203,
            0.8044213056564331,
            3.602351665496826,
            4.744932174682617,
            4.306223392486572,
            -1.6323987245559692,
            -3.953770637512207,
            -1.8471992015838623,
            -1.4570235013961792,
            -5.974011421203613,
            -2.9378576278686523,
            -2.2022416591644287,
            -2.742661237716675,
            1.3586761951446533,
            -2.978717565536499,
            -0.7998937368392944,
            4.312662601470947,
            -2.4248361587524414,
            -1.4214838743209839,
            -0.739437460899353,
            1.5928943157196045,
            -2.257990837097168,
            1.653804063796997,
            0.1887093186378479,
            0.961095929145813,
            -0.2791981101036072,
            1.9403271675109863,
            5.040990352630615,
            1.7607746124267578,
            3.1160738468170166,
            -1.16304349899292,
            -3.6652565002441406,
            3.803088426589966,
            1.7736166715621948,
            1.1529955863952637,
            -1.7878777980804443,
            1.713107705116272,
            1.3853507041931152,
            15.669002532958984,
            -0.10372744500637054,
            -1.7189255952835083,
            -1.6207129955291748,
            -0.515211820602417,
            -3.083329200744629,
            -4.236998081207275,
            4.240068435668945,
            2.625192880630493,
            1.2791173458099365,
            -0.137202650308609,
            -0.3267088234424591,
            0.21198394894599915,
            2.0119783878326416,
            -2.616122245788574,
            -0.7819933891296387,
            -2.1989784240722656,
            3.639097213745117,
            -4.611319541931152,
            0.660734236240387,
            0.3284716308116913,
            1.5630149841308594,
            -0.19001466035842896,
            -0.8097418546676636,
            1.6849641799926758,
            4.606491565704346,
            2.2691502571105957,
            2.4918134212493896,
            -2.1237058639526367,
            0.4965195059776306,
            4.727643013000488,
            1.4119901657104492,
            0.11047792434692383,
            2.669772148132324,
            -0.9472301006317139,
            3.934328556060791,
            -0.888291597366333,
            -4.698163032531738,
            0.9596317410469055,
            0.048828333616256714,
            -5.031798839569092,
            -1.1321340799331665,
            -1.3048646450042725,
            0.20765072107315063,
            -2.398315668106079,
            3.6899189949035645,
            0.543246865272522,
            0.08648207783699036,
            -1.0643444061279297,
            1.808302640914917,
            -1.3448954820632935,
            -2.687241554260254,
            -3.0358805656433105,
            -3.373900890350342,
            1.962947130203247,
            4.415968894958496,
            -3.349862575531006,
            -2.2512447834014893,
            0.7614005208015442,
            -1.6186552047729492,
            2.867558002471924,
            0.5377883911132812,
            -0.47534987330436707,
            -2.87074613571167,
            -4.632349967956543,
            -0.47441768646240234,
            -4.695842742919922,
            -0.2944074273109436,
            3.800668478012085,
            -0.09135818481445312,
            2.0383713245391846,
            2.852161407470703,
            -0.3405686616897583,
            -5.976836204528809,
            -0.7802589535713196,
            -3.0289721488952637,
            0.994162917137146,
            -1.6185036897659302,
            -2.5751988887786865,
            6.352849960327148,
            -2.995218276977539,
            -0.5686230659484863,
            -3.5927791595458984,
            0.5290934443473816,
            1.5145753622055054,
            -2.8369805812835693,
            6.9448394775390625,
            -0.8801549673080444,
            -2.81099534034729,
            3.1078975200653076,
            -3.0874221324920654,
            -1.139732003211975,
            6.87215518951416,
            3.941598653793335,
            1.2644110918045044,
            -4.0766191482543945,
            -0.4589046537876129,
            -2.5897293090820312,
            -2.670614719390869,
            -0.17821604013442993,
            6.174762725830078,
            3.659252405166626,
            0.4780232310295105,
            -2.07735276222229,
            0.5209338068962097,
            0.7596285343170166,
            -1.9202014207839966,
            -5.073221683502197,
            -0.2089245319366455,
            -2.4791646003723145,
            3.776944160461426,
            -3.9946959018707275,
            -3.5531702041625977,
            -0.4847247898578644,
            2.6917004585266113,
            -0.8880987763404846,
            1.732662320137024,
            4.106924533843994,
            -1.0109610557556152,
            2.2270450592041016,
            1.976137638092041,
            0.5781042575836182,
            -3.091435432434082,
            -2.566683530807495,
            -3.959590196609497,
            0.6483902335166931,
            1.6322002410888672,
            1.3912830352783203,
            -0.7764235734939575,
            -0.7809709310531616,
            -2.258021831512451,
            -1.6988062858581543,
            -0.5543450117111206,
            0.5568111538887024,
            0.5509889125823975,
            -3.9384119510650635,
            1.4588944911956787,
            -2.798779010772705,
            0.12578749656677246,
            2.142033338546753,
            4.73541259765625,
            -2.508772134780884,
            -2.513702392578125,
            9.722922325134277,
            1.3373796939849854,
            0.06440867483615875,
            -3.5235328674316406,
            0.0357075110077858,
            0.24800413846969604,
            1.220603108406067,
            0.4599156379699707,
            -3.36604642868042,
            0.5541070699691772,
            4.840699195861816,
            1.9072798490524292,
            -1.7785614728927612
        ]
    },
    "authors": [
        {
            "authorId": "2269473832",
            "name": "Giovanni Monea"
        },
        {
            "authorId": "2319608",
            "name": "Armand Joulin"
        },
        {
            "authorId": "3024698",
            "name": "Edouard Grave"
        }
    ],
    "references": [
        {
            "paperId": "a1f8082505c7e90b0a033e1b9da0a97d67aad66c",
            "title": "Accelerating Large Language Model Decoding with Speculative Sampling"
        },
        {
            "paperId": "d8e9f8c8a37cb4cd26b92ad0d942d641cd512644",
            "title": "Fast Inference from Transformers via Speculative Decoding"
        },
        {
            "paperId": "f3a6115e5fb2237df938976e005468f0b18da797",
            "title": "The Stack: 3 TB of permissively licensed source code"
        },
        {
            "paperId": "acbdbf49f9bc3f151b93d9ca9a06009f4f6eb269",
            "title": "Evaluating Large Language Models Trained on Code"
        },
        {
            "paperId": "90abbc2cf38462b954ae1b772fac9532e2ccd8b0",
            "title": "Language Models are Few-Shot Learners"
        },
        {
            "paperId": "dc52b09089704ebd6f471177474bc29741c50023",
            "title": "Fast Transformer Decoding: One Write-Head is All You Need"
        },
        {
            "paperId": "5efadc9019ce3378a0eb6c8f939cdde6c8918b1e",
            "title": "Mask-Predict: Parallel Decoding of Conditional Masked Language Models"
        },
        {
            "paperId": "5e04881e91bff952d102d967c4ffb498ec30d4af",
            "title": "Blockwise Parallel Decoding for Deep Autoregressive Models"
        },
        {
            "paperId": "15e81c8d1c21f9e928c72721ac46d458f3341454",
            "title": "Non-Autoregressive Neural Machine Translation"
        },
        {
            "paperId": null,
            "title": "Draft & verify: Lossless large language model acceleration via self-speculative decoding"
        },
        {
            "paperId": null,
            "title": "Medusa: Simple framework for accelerating llm generation with multiple decoding heads"
        }
    ]
}