{
    "paperId": "70c3d5ab03a54281be91709b19e3f50a2e4be0e3",
    "externalIds": {
        "DBLP": "conf/nips/BaiCWXM23",
        "ArXiv": "2306.04637",
        "DOI": "10.48550/arXiv.2306.04637",
        "CorpusId": 259095794
    },
    "title": "Transformers as Statisticians: Provable In-Context Learning with In-Context Algorithm Selection",
    "abstract": "Neural sequence models based on the transformer architecture have demonstrated remarkable \\emph{in-context learning} (ICL) abilities, where they can perform new tasks when prompted with training and test examples, without any parameter update to the model. This work first provides a comprehensive statistical theory for transformers to perform ICL. Concretely, we show that transformers can implement a broad class of standard machine learning algorithms in context, such as least squares, ridge regression, Lasso, learning generalized linear models, and gradient descent on two-layer neural networks, with near-optimal predictive power on various in-context data distributions. Using an efficient implementation of in-context gradient descent as the underlying mechanism, our transformer constructions admit mild size bounds, and can be learned with polynomially many pretraining sequences. Building on these ``base'' ICL algorithms, intriguingly, we show that transformers can implement more complex ICL procedures involving \\emph{in-context algorithm selection}, akin to what a statistician can do in real life -- A \\emph{single} transformer can adaptively select different base ICL algorithms -- or even perform qualitatively different tasks -- on different input sequences, without any explicit prompting of the right algorithm or task. We both establish this in theory by explicit constructions, and also observe this phenomenon experimentally. In theory, we construct two general mechanisms for algorithm selection with concrete examples: pre-ICL testing, and post-ICL validation. As an example, we use the post-ICL validation mechanism to construct a transformer that can perform nearly Bayes-optimal ICL on a challenging task -- noisy linear models with mixed noise levels. Experimentally, we demonstrate the strong in-context algorithm selection capabilities of standard transformer architectures.",
    "venue": "Neural Information Processing Systems",
    "year": 2023,
    "referenceCount": 0,
    "citationCount": 98,
    "influentialCitationCount": 16,
    "openAccessPdf": {
        "url": "https://arxiv.org/pdf/2306.04637",
        "status": "GREEN"
    },
    "tldr": {
        "model": "tldr@v2.0.0",
        "text": "This work provides a comprehensive statistical theory for transformers to perform ICL, and shows that transformers can implement a broad class of standard machine learning algorithms in context, such as least squares, ridge regression, Lasso, learning generalized linear models, and gradient descent on two-layer neural networks, with near-optimal predictive power on various in-context data distributions."
    },
    "embedding": {
        "model": "specter_v1",
        "vector": [
            -2.678840398788452,
            0.12006361782550812,
            0.7413418889045715,
            3.0242176055908203,
            1.0264859199523926,
            1.0730620622634888,
            3.261664390563965,
            -3.6156299114227295,
            0.19095221161842346,
            -0.36072564125061035,
            -0.4958537817001343,
            3.9562623500823975,
            0.09773701429367065,
            -1.2234852313995361,
            -2.4335386753082275,
            1.4702647924423218,
            1.572903037071228,
            3.6937313079833984,
            2.074812412261963,
            3.6407508850097656,
            -2.3363037109375,
            2.5883822441101074,
            -5.919253349304199,
            -0.07933761179447174,
            0.39256447553634644,
            -1.4886724948883057,
            3.092529535293579,
            -1.2836730480194092,
            -4.856528282165527,
            3.8813765048980713,
            0.2723861336708069,
            -4.070858478546143,
            4.664793968200684,
            -6.0706024169921875,
            2.783716917037964,
            -4.572005271911621,
            -2.3924765586853027,
            10.332412719726562,
            -4.515953063964844,
            -2.608546733856201,
            -3.0506274700164795,
            0.06965905427932739,
            0.9123560786247253,
            1.2868075370788574,
            0.36135098338127136,
            -0.7875525951385498,
            6.410959243774414,
            2.120093584060669,
            -2.13448166847229,
            0.8245944976806641,
            3.611548662185669,
            0.044902265071868896,
            -4.429669380187988,
            3.320295572280884,
            1.1244722604751587,
            -2.206908702850342,
            0.6892856359481812,
            -2.451237678527832,
            3.7549848556518555,
            -0.6630880236625671,
            4.569785118103027,
            4.967800617218018,
            -0.13846035301685333,
            1.6083953380584717,
            4.657299518585205,
            -2.039891242980957,
            0.2654045522212982,
            4.1624555587768555,
            -0.8337290287017822,
            4.323577404022217,
            1.8997828960418701,
            -6.893439292907715,
            1.7096163034439087,
            1.5085736513137817,
            0.5274337530136108,
            1.3202439546585083,
            2.2054190635681152,
            -7.2331671714782715,
            1.0863844156265259,
            -3.682307004928589,
            0.673538863658905,
            -0.38185399770736694,
            -1.0846816301345825,
            -0.6424959301948547,
            5.590946197509766,
            -3.4179162979125977,
            -4.596414566040039,
            -0.007600866258144379,
            0.1662062406539917,
            -3.246898651123047,
            -0.4820983409881592,
            2.000312566757202,
            -2.411876916885376,
            0.49515479803085327,
            -2.932386636734009,
            0.1830056607723236,
            3.277055263519287,
            0.9998759031295776,
            -3.5455665588378906,
            1.3150241374969482,
            2.464552640914917,
            1.50668466091156,
            0.6477252244949341,
            5.169069766998291,
            2.0832934379577637,
            -1.0057103633880615,
            -1.2460538148880005,
            3.2703609466552734,
            0.48513302206993103,
            -2.44645094871521,
            -0.22111403942108154,
            2.5545148849487305,
            0.3317315876483917,
            -0.382377564907074,
            1.4715220928192139,
            -3.166008710861206,
            -2.492520332336426,
            1.447838544845581,
            0.29966121912002563,
            3.0524685382843018,
            -1.6920088529586792,
            1.4015049934387207,
            -3.757659673690796,
            0.7003090381622314,
            -4.523739814758301,
            1.5640935897827148,
            0.8625162839889526,
            -0.275775283575058,
            -1.7734380960464478,
            -2.2320659160614014,
            1.2780660390853882,
            -2.906855344772339,
            -1.6038142442703247,
            -1.6032836437225342,
            6.579596519470215,
            6.754127502441406,
            -1.8696508407592773,
            1.6199778318405151,
            -3.7310476303100586,
            -1.527841567993164,
            -0.5210363864898682,
            2.2232983112335205,
            -0.10514235496520996,
            2.1061289310455322,
            3.330583333969116,
            5.153764724731445,
            2.022320508956909,
            2.178339958190918,
            0.22662359476089478,
            5.668610095977783,
            4.076621055603027,
            -1.9458401203155518,
            1.1904323101043701,
            -0.5834435224533081,
            1.8008668422698975,
            5.988637447357178,
            -4.84530782699585,
            0.9191855788230896,
            -1.30949068069458,
            -1.3042936325073242,
            1.4151464700698853,
            2.3900442123413086,
            -9.672653198242188,
            1.864812970161438,
            5.738244533538818,
            -4.857886791229248,
            -0.77516770362854,
            2.799388885498047,
            -1.1045340299606323,
            1.267090916633606,
            0.5982665419578552,
            2.113032341003418,
            -1.839697003364563,
            2.023555040359497,
            4.096569538116455,
            1.3105480670928955,
            2.3024754524230957,
            -2.2075886726379395,
            0.5266315937042236,
            1.6727063655853271,
            -2.3002610206604004,
            0.270709753036499,
            -6.11240291595459,
            -1.0597150325775146,
            -2.3204081058502197,
            -2.8453311920166016,
            -3.8401410579681396,
            -3.600735902786255,
            -2.781447172164917,
            -1.2117019891738892,
            -0.6852542757987976,
            0.4461095929145813,
            5.658154487609863,
            3.737382411956787,
            5.084000110626221,
            1.2291685342788696,
            1.0577999353408813,
            0.5237879753112793,
            -3.062044858932495,
            -0.31643807888031006,
            4.6836442947387695,
            1.7685011625289917,
            -1.6680988073349,
            2.4542245864868164,
            2.0069937705993652,
            2.151487350463867,
            -3.446398973464966,
            4.39695405960083,
            2.473588228225708,
            -0.4557098150253296,
            -1.6235742568969727,
            -1.1738252639770508,
            -1.661611557006836,
            -0.6705674529075623,
            -4.186938285827637,
            -2.271831750869751,
            -4.717006683349609,
            2.941035509109497,
            4.7729034423828125,
            1.3843696117401123,
            -2.0693421363830566,
            1.7649688720703125,
            1.157625436782837,
            -1.1302073001861572,
            1.512120246887207,
            -3.997588872909546,
            4.547983169555664,
            -0.6806219816207886,
            1.377897024154663,
            2.9562489986419678,
            -1.6177458763122559,
            -2.509215831756592,
            -1.243876576423645,
            0.6740034818649292,
            -5.59113883972168,
            -4.17035436630249,
            -5.546457767486572,
            1.5206483602523804,
            -1.0265401601791382,
            -5.229190349578857,
            4.599830627441406,
            1.7245888710021973,
            -1.3479530811309814,
            4.590659141540527,
            -2.2541518211364746,
            -1.1913286447525024,
            -4.725375175476074,
            2.707279682159424,
            -3.3202109336853027,
            -2.600513219833374,
            -3.1318273544311523,
            -1.0978288650512695,
            4.346759796142578,
            -1.9265282154083252,
            2.946011781692505,
            3.9133968353271484,
            -1.796183705329895,
            -1.1681972742080688,
            1.4786725044250488,
            0.10926361382007599,
            -1.8803831338882446,
            4.3780951499938965,
            2.303774833679199,
            3.5936241149902344,
            -1.4435539245605469,
            -1.9102884531021118,
            -1.440548062324524,
            -4.198758602142334,
            -3.086543560028076,
            3.0107309818267822,
            0.8247500658035278,
            -1.6244237422943115,
            -0.8620980381965637,
            -5.62464714050293,
            -1.1804263591766357,
            -5.909426212310791,
            -2.0758700370788574,
            0.6792404651641846,
            1.1152184009552002,
            6.146737575531006,
            2.8538315296173096,
            -3.400393486022949,
            -2.806718587875366,
            -0.9688270092010498,
            0.3948986232280731,
            -1.9033488035202026,
            3.3065314292907715,
            -1.1079847812652588,
            0.5819739699363708,
            -1.837889313697815,
            -6.347031116485596,
            6.225852012634277,
            -3.4504506587982178,
            1.2127923965454102,
            -2.108340263366699,
            3.552098274230957,
            2.904679775238037,
            -3.1338908672332764,
            1.6459771394729614,
            -1.244652271270752,
            -2.41995906829834,
            -0.7025227546691895,
            4.049145698547363,
            0.5555251836776733,
            0.5479474663734436,
            4.31606388092041,
            -0.34181487560272217,
            0.004300594329833984,
            -2.1956260204315186,
            -3.0761630535125732,
            -1.093916654586792,
            0.3575587868690491,
            4.867144584655762,
            -4.501681804656982,
            0.3282400369644165,
            0.20297661423683167,
            -0.3427911102771759,
            1.3274164199829102,
            -1.3415287733078003,
            5.549962043762207,
            0.3253680467605591,
            -0.8869165182113647,
            -2.1376967430114746,
            -1.0810328722000122,
            -2.2970948219299316,
            0.4849343001842499,
            3.2186214923858643,
            2.6892967224121094,
            1.3208990097045898,
            2.17870831489563,
            0.3443104028701782,
            2.441620111465454,
            1.5726836919784546,
            0.3557591438293457,
            1.6888641119003296,
            -7.35150671005249,
            0.022337645292282104,
            -0.5589820742607117,
            1.3402618169784546,
            4.5763397216796875,
            0.40248212218284607,
            8.0914888381958,
            1.2468786239624023,
            2.316741704940796,
            -1.0662672519683838,
            -0.1660718023777008,
            1.2564364671707153,
            -1.8022949695587158,
            -0.4817565977573395,
            -0.4132193326950073,
            4.11987829208374,
            0.24199867248535156,
            -0.5898890495300293,
            -1.0844701528549194,
            1.7372157573699951,
            4.045673370361328,
            4.317601203918457,
            1.166733741760254,
            -0.48485738039016724,
            5.5581769943237305,
            -0.8790582418441772,
            -1.378677248954773,
            1.647089958190918,
            -1.0400089025497437,
            -1.3783173561096191,
            -2.874800205230713,
            8.821232795715332,
            -5.118618965148926,
            -2.264134407043457,
            -5.9455718994140625,
            -2.9187731742858887,
            -0.8999395966529846,
            -0.9949523210525513,
            2.687891721725464,
            -1.6507349014282227,
            -2.0061964988708496,
            0.18544793128967285,
            -0.8250396847724915,
            0.6856247782707214,
            -1.7227778434753418,
            2.358086347579956,
            4.774167060852051,
            1.7749818563461304,
            3.0891594886779785,
            -2.219438076019287,
            -1.3425532579421997,
            -1.0187478065490723,
            -0.31169915199279785,
            -0.19643431901931763,
            1.1693249940872192,
            -0.04935985803604126,
            3.1512346267700195,
            1.8802677392959595,
            0.3469540476799011,
            -4.040811061859131,
            -1.106492519378662,
            0.22634373605251312,
            -5.835703372955322,
            -0.7505084872245789,
            -0.15255819261074066,
            -0.5544189214706421,
            1.6880342960357666,
            2.79718279838562,
            0.04096412658691406,
            -2.8055338859558105,
            -1.5312159061431885,
            6.748653411865234,
            -3.6295511722564697,
            -0.5921187400817871,
            1.1240921020507812,
            -3.204190969467163,
            -1.6403980255126953,
            -0.1284247189760208,
            -4.240362167358398,
            4.361289978027344,
            -1.490945816040039,
            1.067786693572998,
            1.741402506828308,
            3.9706273078918457,
            0.6556580066680908,
            -2.844461679458618,
            2.831462860107422,
            6.238672733306885,
            1.9621450901031494,
            -1.9302177429199219,
            0.7332910299301147,
            2.826982021331787,
            -0.33562612533569336,
            -1.8837833404541016,
            4.319272994995117,
            -1.5089359283447266,
            4.70585823059082,
            -4.224421501159668,
            1.3417173624038696,
            -0.5936335325241089,
            2.4629931449890137,
            3.3483684062957764,
            4.100470066070557,
            -0.483554482460022,
            1.1053836345672607,
            -0.964691698551178,
            3.434859275817871,
            -4.217082977294922,
            2.5383801460266113,
            -2.496514320373535,
            0.8159639835357666,
            3.0397934913635254,
            2.625986337661743,
            -2.77077579498291,
            -4.426416397094727,
            4.780134201049805,
            -3.3618197441101074,
            -3.121579170227051,
            1.5294861793518066,
            1.951942801475525,
            -0.48211678862571716,
            -2.4817686080932617,
            -5.324908256530762,
            -0.42688751220703125,
            3.2236170768737793,
            -4.504079818725586,
            3.1051619052886963,
            -1.7715672254562378,
            0.7924609780311584,
            1.0483107566833496,
            1.6260924339294434,
            -1.240891695022583,
            -3.0683679580688477,
            -0.5392353534698486,
            2.733839750289917,
            2.5956523418426514,
            -1.5198462009429932,
            -4.119937896728516,
            -4.0010666847229,
            -1.052227258682251,
            1.0114333629608154,
            3.157413959503174,
            3.446742057800293,
            3.2776942253112793,
            -3.9822194576263428,
            -4.868289947509766,
            -2.1101717948913574,
            0.8408311009407043,
            1.1671628952026367,
            -2.4231395721435547,
            5.0795488357543945,
            1.6985276937484741,
            1.393316626548767,
            1.491045594215393,
            1.232487678527832,
            1.2246551513671875,
            2.752690553665161,
            5.427743434906006,
            -0.3224197328090668,
            1.7741317749023438,
            0.7479239702224731,
            -3.9166951179504395,
            0.2586807608604431,
            1.4647166728973389,
            1.1626365184783936,
            2.2153444290161133,
            -2.2494568824768066,
            1.278773307800293,
            -1.5079001188278198,
            -1.635765552520752,
            2.0710396766662598,
            2.824023723602295,
            1.8722820281982422,
            -3.606394052505493,
            -1.3274117708206177,
            -1.9688550233840942,
            -1.510658621788025,
            -5.510541915893555,
            1.4358413219451904,
            -0.3824836313724518,
            4.420348167419434,
            1.4765973091125488,
            -0.5091947913169861,
            1.5352003574371338,
            1.7251591682434082,
            -2.1343741416931152,
            2.125762462615967,
            1.829055666923523,
            1.5496230125427246,
            -2.1075022220611572,
            1.863184928894043,
            -3.8763999938964844,
            1.9031908512115479,
            2.791250467300415,
            4.541248321533203,
            8.194253921508789,
            4.335279941558838,
            2.888202428817749,
            -2.7035202980041504,
            0.6173394918441772,
            -1.2157378196716309,
            2.568295955657959,
            5.437671661376953,
            -5.05497932434082,
            2.2514023780822754,
            0.9131341576576233,
            1.8234684467315674,
            -1.3899378776550293,
            0.6387203931808472,
            -1.4026256799697876,
            1.3602732419967651,
            -4.718099594116211,
            -1.300125002861023,
            -2.2570152282714844,
            0.528132438659668,
            0.43211591243743896,
            -0.9799793362617493,
            3.744994640350342,
            -2.86533784866333,
            -5.394423484802246,
            -2.643582582473755,
            -0.9005112051963806,
            -4.135815620422363,
            -6.142281532287598,
            5.92627477645874,
            -0.07306918501853943,
            0.5116596817970276,
            -0.834708571434021,
            2.9032082557678223,
            -1.830675482749939,
            -2.8151252269744873,
            0.4044657051563263,
            3.004181146621704,
            0.6886685490608215,
            -2.8174540996551514,
            -1.0813288688659668,
            -1.039746880531311,
            1.0525362491607666,
            1.968699336051941,
            -0.9571421146392822,
            4.069039821624756,
            2.5351457595825195,
            0.16579633951187134,
            -1.6528770923614502,
            0.6628398895263672,
            -3.773486852645874,
            -1.8910071849822998,
            -4.084352970123291,
            -6.045116424560547,
            1.9974451065063477,
            -2.600999355316162,
            -5.897311210632324,
            2.3429715633392334,
            -5.094392776489258,
            -2.1868162155151367,
            0.4990047216415405,
            1.1831451654434204,
            -0.1929631233215332,
            -1.4351365566253662,
            1.7709766626358032,
            -3.6173295974731445,
            2.3734018802642822,
            -2.953129768371582,
            -2.659641981124878,
            1.2690606117248535,
            -0.32540321350097656,
            1.6000522375106812,
            3.585207462310791,
            -1.2267143726348877,
            0.11802828311920166,
            -0.4506760835647583,
            1.0765941143035889,
            1.9284957647323608,
            2.1209609508514404,
            3.418621063232422,
            -3.3092613220214844,
            -0.7110279202461243,
            17.035253524780273,
            0.1927444189786911,
            -1.0972084999084473,
            1.0027072429656982,
            1.6876238584518433,
            -4.689027786254883,
            -4.918376445770264,
            2.8948748111724854,
            -0.6234910488128662,
            1.1068596839904785,
            -1.178064227104187,
            -4.303829193115234,
            -0.5211780071258545,
            -0.9568340182304382,
            -3.182162046432495,
            -1.50774347782135,
            -0.3859073221683502,
            4.950038433074951,
            -1.246715784072876,
            1.460392713546753,
            -2.8973917961120605,
            4.201977729797363,
            -0.30955711007118225,
            1.5501049757003784,
            0.24853584170341492,
            3.684976100921631,
            -0.7803027629852295,
            3.3929617404937744,
            -4.384819030761719,
            0.008641839027404785,
            0.860098659992218,
            1.665247917175293,
            -1.6609606742858887,
            -1.642598032951355,
            -4.371603488922119,
            1.7800198793411255,
            3.671077013015747,
            -1.6747275590896606,
            3.358731985092163,
            1.8139384984970093,
            -0.7473958134651184,
            1.7453601360321045,
            -6.830455780029297,
            -3.206083297729492,
            -0.8717848658561707,
            1.4692362546920776,
            5.2535223960876465,
            -2.0429835319519043,
            -1.9729740619659424,
            3.569425106048584,
            1.913130283355713,
            -1.84064519405365,
            -1.07935631275177,
            1.6992969512939453,
            1.2035470008850098,
            1.7797898054122925,
            0.8440848588943481,
            -2.3710031509399414,
            2.9599485397338867,
            -0.15273180603981018,
            -1.6239060163497925,
            -1.088046908378601,
            -1.2867391109466553,
            -2.5125927925109863,
            0.97092604637146,
            1.0167150497436523,
            -1.8449300527572632,
            2.0884268283843994,
            2.3039350509643555,
            2.190937042236328,
            0.5766233801841736,
            1.6930272579193115,
            -3.029388189315796,
            -1.7696893215179443,
            -3.5796146392822266,
            -3.7205188274383545,
            1.324973464012146,
            0.09522275626659393,
            -2.8560822010040283,
            4.296483039855957,
            -4.447885513305664,
            0.13704177737236023,
            -3.20717716217041,
            -0.9443216323852539,
            5.8923468589782715,
            -2.6479477882385254,
            3.3389854431152344,
            2.7397890090942383,
            -2.394801139831543,
            1.9187211990356445,
            1.208320140838623,
            -1.513388991355896,
            1.5955562591552734,
            2.396970272064209,
            3.7339537143707275,
            -2.5092334747314453,
            -2.802248954772949,
            -0.22596293687820435,
            -5.585570335388184,
            -5.260739326477051,
            4.007150173187256,
            2.5626027584075928,
            1.8910987377166748,
            -1.3932241201400757,
            0.5011435747146606,
            -0.012209057807922363,
            -2.3047702312469482,
            -4.007572650909424,
            -3.860651969909668,
            -2.1854686737060547,
            3.0253453254699707,
            -4.630094528198242,
            -3.337688684463501,
            0.5166538953781128,
            0.9084151983261108,
            2.314807653427124,
            -0.28034985065460205,
            4.352326393127441,
            1.6144102811813354,
            6.497418403625488,
            -1.2537829875946045,
            -1.9171040058135986,
            -2.681252956390381,
            -2.4809670448303223,
            -1.7150917053222656,
            2.6880903244018555,
            -0.5132461786270142,
            -3.4603207111358643,
            0.9222675561904907,
            0.78368079662323,
            3.7728207111358643,
            -5.892983436584473,
            0.02361103892326355,
            -1.9438800811767578,
            -1.3980755805969238,
            -1.7824599742889404,
            1.0098551511764526,
            1.1664767265319824,
            -6.031108856201172,
            5.033252716064453,
            2.5334274768829346,
            -3.126326560974121,
            0.4271303117275238,
            8.846434593200684,
            -0.9777699112892151,
            -1.4722520112991333,
            0.14511534571647644,
            -0.8220398426055908,
            0.572455644607544,
            0.905376672744751,
            0.5903528928756714,
            0.7189329862594604,
            3.219135284423828,
            0.8130892515182495,
            -0.1292608380317688,
            -3.2967116832733154
        ]
    },
    "authors": [
        {
            "authorId": "8681368",
            "name": "Yu Bai"
        },
        {
            "authorId": "103244045",
            "name": "Fan Chen"
        },
        {
            "authorId": "46507194",
            "name": "Haiquan Wang"
        },
        {
            "authorId": "2054594326",
            "name": "Caiming Xiong"
        },
        {
            "authorId": "2068869988",
            "name": "Song Mei"
        }
    ],
    "references": []
}