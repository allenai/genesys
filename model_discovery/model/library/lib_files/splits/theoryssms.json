{
    "theoryssms-0": "Theoretical Foundations of Deep Selective State-Space Models\n\nNicola Muca Cirone Antonio Orvieto Benjamin Walker Cristopher Salvi Terry Lyons\n\nAbstract\n\nStructured state-space models (SSMs) such as S4, stemming from the seminal work of Gu et al., are gaining popularity as effective approaches for modeling sequential data.",
    "theoryssms-1": "Deep SSMs demonstrate outstanding performance across a diverse set of domains, at a reduced training and inference cost compared to attention-based transformers. Recent developments show that if the linear recurrence powering SSMs allows for multiplicative interactions between inputs and hidden states (e.g. GateLoop, Mamba, GLA), then the resulting architecture can surpass in both in accuracy and efficiency attention-powered foundation models trained on text, at scales of billion parameters. In this paper, we give theoretical grounding to this recent finding using tools from Rough Path Theory: we show that when random linear recurrences are equipped with simple input-controlled transitions (selectivity mechanism), then the hidden state is provably a low-dimensional projection of a powerful mathematical object called the signature of the input \u2013 capturing non-linear interactions between tokens at distinct timescales. Our theory not only motivates the success of modern selective state-space models such as Mamba but also provides a solid framework to understand the expressive power of future SSM variants. Machine Learning, ICML\n\n\\declaretheorem\n\n[name=Theorem,numberwithin=section]thm \\declaretheorem[name=Lemma,numberwithin=section,numberlike=thm]lem \\declaretheorem[name=Corollary,numberwithin=section,numberlike=thm]cor \\declaretheorem[name=Proposition,numberwithin=section,numberlike=thm]prop \\declaretheorem[name=Assumption,numberlike=thm]ass\n\n1 Introduction\n\nSequence-to-sequence blocks are fundamental components of modern deep learning models for language, images, video, audio, time series, and genomics. While attention (Vaswani et al., 2017; Dosovitskiy et al., 2020) has been for the last five years the dominant mechanism powering these architectures, competitive results have been recently achieved by replacing attention with state-space models (SSMs): GPU-efficient linear recurrent sequence-to-sequence blocks stemming from S4 (Gu et al., 2021). SSMs achieve state-of-the-art results on long-range-reasoning benchmarks (Tay et al., 2020) and show outstanding performance in various domain including vision (Nguyen et al., 2022), audio (Goel et al., 2022), biological signals (Gu et al., 2021), reinforcement learning (Lu et al., 2023) and online learning (Zucchet et al., 2023). SSMs recently have gained significant interest in the community since their computational complexity scales linearly in sequence length, while attention scales quadratically; moreover, unlike other recurrent mechanisms such as LSTMs (Hochreiter & Schmidhuber, 1997) and GRUs (Cho et al., 2014), they can be efficiently parallelized on GPUs during training using parallel scans (Martin & Cundy, 2017; Smith et al., 2023). While standard SSMs were shown to be particularly powerful on signal processing tasks, their computation power is limited: the core sequential mechanism of S4 is equivalent to a convolution (filtering) (Li et al., 2022a). This represents a drawback in challenging domains such as text and genetics, where the ability to select data efficiently in an input-dependent manner (i.e., perform content-based reasoning) is crucial (see results in (Wang et al., 2022; Fu et al., 2022)). Towards reaching this goal with recurrent models, various adaptations of S4 have been proposed in the last few months. Notably, Mamba (Gu & Dao, 2023) implements simple and efficient gating mechanisms on the S4 recurrence, unlocking input selectivity in the memory update. Mamba achieved state-of-the-art performance of various language modeling tasks at a fraction of the compute needed to train a transformer model with an equal number of parameters, with inference time still scaling (like S4) with . Similar ideas can be found in recent S4-inspired recurrent linear attention models, such as RWKV (Peng et al., 2023), RetNet (Sun et al., 2023), Gateloop (Katsch, 2023) and Gated Linear Attention (GLA) (Yang et al., 2023). Last, very recently, (De et al., 2024) surpassed the performance of Mamba with a gated RNN architecture \u2013 Griffin \u2013 based on an improved version of the LRU (Orvieto et al., 2023b), perhaps the simplest SSM variant. At the core of the models discussed above is a linear time-varying dynamical system, where content-based reasoning is performed along the input sequence through an efficient and parallelizable update on a hidden state. In this paper, we generalize the structure of such models, drawing a direct link to controlled differential equations (CDEs) (Kidger et al., 2020; Morrill et al., 2021; Arribas et al., 2020; Salvi et al., 2022; Hoglund et al., 2023) and using tools from rough path theory to study expressivity of deep selective SSMs. 1. We provide a framework for the analysis of (input-controlled) linear (in the hidden state) recurrences such as S4, Mamba and GLA. This framework allows the use of powerful tools and results in the Rough Path Theory literature to reason about the expressivity of modern SSM layers and to obtain generalized versions of the universality results of (Li et al., 2022b). This framework captures both S4 and Mamba, as well as recently proposed linear-attention-powered recurrences. 2. We prove that wide enough randomly initialized dense input-controlled linear recurrences are fully expressive: with no need for a multi-layer-perceptron (MLP) block transforming pointwise the recurrence output (as instead is done in the transformers architecture or at the S4 recurrence output), we show that the hidden state contains sufficient input statistics to approximate any continuous function from the input sequence to a target value. This is in clear contrast to S4, where the hidden state is just a convolution of the input sequence with a fixed kernel. 3. We show that diagonal input-controlled linear recurrences (such as Mamba) provably collect input statistics more efficiently than S4. We additionally show that chaining such blocks, by simply placing linear pointwise maps in between, allows computation of higher order global statistics \u2013 matching the dense linear input-controlled setting discussed in point (2) above, in the depth limit. The main objective of our research is to outline the foundational mathematical tools for comprehensive theoretical investigations of modern recurrent blocks. In addition to our results and insights concerning recently proposed SSM models, our work provides a framework that can be useful for analyzing and comparing forthcoming architectural advances. 2 State-space Models\n\nWe describe here the structure of the main SSMs-based strategies for processing length- input sequences of dimensional tokens: . We denote by the -th column of (the -th token) and by the -th row of (time series for the -th channel). 2.1 Review of Modern SSMs\n\nWe start with a quick simplified recap of S4 (Gu et al., 2021) and then describe recently proposed variants such as Mamba (in particular, the S6 block) (Gu & Dao, 2023) and Gated Linear Attention (GLA) (Yang et al., 2023). We restrict our focus to the recurrent mechanism and invite the reader to refer to the original papers for a description of the token-wise operations following and preceding each block. SSM basics (S4). Most111The LRU (Orvieto et al., 2023b) and S5 (Smith et al., 2023) instead build a single recurrence operating on multidimensional (# channels) inputs.SSMs (Gu et al., 2021, 2022) operate independently on input channels. The time-series for each channel is seen as the result of sampling a latent continuous-time signal at multiples of a channel-dependent stepsize :\n\nX \u0394 i \u200b \u2113 i := X i \u200b ( \u0394 i \u200b \u2113 ) = x \u2113 i assign superscript subscript \ud835\udc4b subscript \u0394 \ud835\udc56 \u2113 \ud835\udc56 superscript \ud835\udc4b \ud835\udc56 subscript \u0394 \ud835\udc56 \u2113 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 X_{\\Delta_{i}\\ell}^{i}:=X^{i}(\\Delta_{i}\\ell)=x_{\\ell}^{i}\n\nfor all , . Under S4, each input signal produces a complex-valued state signal according to a linear differential equation:\n\nd d \u200b t \u200b Z t i = A i \u200b Z t i + B \u200b X t i , \ud835\udc51 \ud835\udc51 \ud835\udc61 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc56 subscript \ud835\udc34 \ud835\udc56 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc56 \ud835\udc35 superscript subscript \ud835\udc4b \ud835\udc61 \ud835\udc56 \\displaystyle\\frac{d}{dt}Z_{t}^{i}=A_{i}Z_{t}^{i}+BX_{t}^{i}, (1)\n\nwhere is channel-specific diagonal complex valued matrix: for all . is an input projection shared across input components . SSM models are based on stable discretizations of the continuous time system above: each input sequence channel produces a sequence of hidden states as follows:\n\nz \u2113 i = A \u00af i \u200b z \u2113 \u2212 1 i + B \u00af i \u200b x \u2113 i , superscript subscript \ud835\udc67 \u2113 \ud835\udc56 subscript \u00af \ud835\udc34 \ud835\udc56 superscript subscript \ud835\udc67 \u2113 1 \ud835\udc56 subscript \u00af \ud835\udc35 \ud835\udc56 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 \\displaystyle z_{\\ell}^{i}=\\bar{A}_{i}z_{\\ell-1}^{i}+\\bar{B}_{i}x_{\\ell}^{i}, (2)\n\nwith determined by the discretization technique and the channel-dependent stepsize : under the commonly used Zero-Order Hold discretization 222This corresponds to: (i).",
    "theoryssms-2": "considering the continuous underlying signal to be piecewise constant, (ii). solving exactly the ODE 1 and finally (iii). sampling at the sample times of . ,\n\nA \u00af i = exp \u2061 ( \u0394 i \u200b A i ) , B \u00af i = ( \u0394 i \u200b A i ) \u2212 1 \u200b ( exp \u2061 ( \u0394 i \u200b A i ) \u2212 I ) \u200b \u0394 i \u200b B . formulae-sequence subscript \u00af \ud835\udc34 \ud835\udc56 subscript \u0394 \ud835\udc56 subscript \ud835\udc34 \ud835\udc56 subscript \u00af \ud835\udc35 \ud835\udc56 superscript subscript \u0394 \ud835\udc56 subscript \ud835\udc34 \ud835\udc56 1 subscript \u0394 \ud835\udc56 subscript \ud835\udc34 \ud835\udc56 \ud835\udc3c subscript \u0394 \ud835\udc56 \ud835\udc35 \\bar{A}_{i}=\\exp(\\Delta_{i}A_{i}),\\ \\bar{B}_{i}=(\\Delta_{i}A_{i})^{-1}(\\exp(\\Delta_{i}A_{i})-I)\\Delta_{i}B. Note from eq. 2 that SSMs at inference time are equivalent to linear recurrent neural networks (RNNs). Yet, learning with gradient descent is performed on the continuous-time variables, unlocking stable signal propagation and alleviating vanishing gradients (Orvieto et al., 2023b). Finally, at each dimension , the sequence of hidden states is mapped back to real numbers, and a projection is performed to produce an output a sequence of tokens with the same dimensions as . To conclude, we point out that the transition matrix is often (yet not crucially, as shown by Orvieto et al. (2023b)) structured, i.e. initialized deterministically through HiPPO theory (Gu et al., 2020) in diagonal form. Common choices (Gu et al., 2022) are (S4D-Lin333Reall: denotes the imaginary unit , not to be confused with the index .) and (S4D-Real). Mamba. The Selective SSM (S6) powering the Mamba architecture (Gu & Dao, 2023) augments S4 with input-controlled transitions:\n\nz \u2113 i = A \u00af i \u200b ( x \u2113 i ) \u200b z \u2113 \u2212 1 i + B \u00af \u200b ( x \u2113 i ) \u200b x \u2113 i , superscript subscript \ud835\udc67 \u2113 \ud835\udc56 subscript \u00af \ud835\udc34 \ud835\udc56 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 superscript subscript \ud835\udc67 \u2113 1 \ud835\udc56 \u00af \ud835\udc35 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 \\displaystyle z_{\\ell}^{i}={\\color[rgb]{0,.5,.5}\\definecolor[named]{pgfstrokecolor}{rgb}{0,.5,.5}\\bar{A}_{i}(x_{\\ell}^{i})}z_{\\ell-1}^{i}+{\\color[rgb]{0,.5,.5}\\definecolor[named]{pgfstrokecolor}{rgb}{0,.5,.5}\\bar{B}(x_{\\ell}^{i})}x_{\\ell}^{i}, (3)\n\nwhere the most crucial component (see Table 7 in Gu & Dao (2023)) is the dependency of on the input \u2013 thus making the operation effectively a gate. This dependency of on the input is achieved efficiently through the parameter, which becomes iteration-dependent following the equation444To be more precise, the scalar multiplier map is the result of a low-rank projection (timestamp independent) of the input (all channels). \u0394 \u2113 i = softplus \u200b ( \u03b1 i \u200b x \u2113 i + \u03b2 i ) superscript subscript \u0394 \u2113 \ud835\udc56 softplus subscript \ud835\udefc \ud835\udc56 superscript subscript \ud835\udc65 \u2113 \ud835\udc56 subscript \ud835\udefd \ud835\udc56 \\Delta_{\\ell}^{i}=\\text{softplus}(\\alpha_{i}x_{\\ell}^{i}+\\beta_{i}) (4)\n\nwith . The RG-LRU recurrence in (De et al., 2024) works in a similar way, yet processing all input channels at once. GLA and other linear attention variants. Gated Linear attention555Discussed is only the single-head setting. (Yang et al., 2023) is a recursion on a matrix hidden state with input-controlled transition:\n\nz \u2113 = A \u00af \u200b ( x \u2113 ) \u2299 z \u2113 \u2212 1 + B \u00af \u200b ( x \u2113 ) subscript \ud835\udc67 \u2113 direct-product \u00af \ud835\udc34 subscript \ud835\udc65 \u2113 subscript \ud835\udc67 \u2113 1 \u00af \ud835\udc35 subscript \ud835\udc65 \u2113 z_{\\ell}={\\color[rgb]{0,.5,.5}\\definecolor[named]{pgfstrokecolor}{rgb}{0,.5,.5}\\bar{A}(x_{\\ell})}\\odot z_{\\ell-1}+{\\color[rgb]{0,.5,.5}\\definecolor[named]{pgfstrokecolor}{rgb}{0,.5,.5}\\bar{B}(x_{\\ell})} (5)\n\nwhere denotes the Hadamard product and all channels in the input sequence are fed into the transition through a linear attention mechanism, and is computed through the equation:\n\nB \u00af \u200b ( x \u2113 ) = W key \u22a4 \u200b x \u2113 \u200b x \u2113 \u22a4 \u200b W val \u2208 \u211d d \u00d7 d , \u00af \ud835\udc35 subscript \ud835\udc65 \u2113 superscript subscript \ud835\udc4a key top subscript \ud835\udc65 \u2113 superscript subscript \ud835\udc65 \u2113 top subscript \ud835\udc4a val superscript \u211d \ud835\udc51 \ud835\udc51 \\displaystyle\\bar{B}(x_{\\ell})=W_{\\text{key}}^{\\top}x_{\\ell}x_{\\ell}^{\\top}W_{\\text{val}}\\in\\mathbb{R}^{d\\times d}, A \u00af \u200b ( x \u2113 ) = \u03c4 \u2212 2 \u200b \u03c3 \u200b ( x \u2113 \u22a4 \u200b W \u03b1 + b \u03b1 ) \u22a4 \u200b \u03c3 \u200b ( x \u2113 \u22a4 \u200b W \u03b2 + b \u03b2 ) \u2208 \u211d d \u00d7 d , \u00af \ud835\udc34 subscript \ud835\udc65 \u2113 superscript \ud835\udf0f 2 \ud835\udf0e superscript superscript subscript \ud835\udc65 \u2113 top subscript \ud835\udc4a \ud835\udefc subscript \ud835\udc4f \ud835\udefc top \ud835\udf0e superscript subscript \ud835\udc65 \u2113 top subscript \ud835\udc4a \ud835\udefd subscript \ud835\udc4f \ud835\udefd superscript \u211d \ud835\udc51 \ud835\udc51 \\displaystyle\\bar{A}(x_{\\ell})=\\tau^{-2}\\sigma(x_{\\ell}^{\\top}W_{\\alpha}+b_{\\alpha})^{\\top}\\sigma(x_{\\ell}^{\\top}W_{\\beta}+b_{\\beta})\\in\\mathbb{R}^{d\\times d},\n\nwith , , and is a sigmoid. RetNet (Sun et al., 2023) is similar on but does not have input-controlled . GateLoop (Katsch, 2023) is similar to RetNet, with diagonal and complex-valued: phase and magnitude of each component is controlled via a linear map on the input, similarly to Mamba. 2.2 Known properties of (non-linear) recurrences\n\nExpressiveness of standard nonlinear RNNs of the form , where is a nonlinearity, has been extensively studied since the seminal work of Siegelmann & Sontag (1992), with recent contributions such as (Korsky & Berwick, 2019; Hanson & Raginsky, 2020). In particular, Hanson & Raginsky (2020) proved in the continuous-time setting that wide enough non-linear RNNs can approximate up to vanishing precision non-linear time-homogeneous systems of differential equations, driven by input paths. The argument used here to show universality is based on the celebrated Barron\u2019s theorem (Barron, 1993) for approximation of continuous functions with neural networks with one hidden layer. Indeed, note that non-linear RNNs are recurrent perceptrons with one hidden layer, acting both on the state and the input (Tallec & Ollivier, 2018). Instead, (selective) SSMs such as S4 and Mamba have transition map which is linear in the state \u2013 unlocking parallelization of the recurrent computation (Smith et al., 2023; Gu & Dao, 2023). In the context of linear RNNs and non-selective SSMs, many results (old and new) exist that characterize expressivity. Li et al. (2022b) showed that linear RNNs (i.e. S4-like recurrences) can approximate arbitrary convolution filters in the width limit. Further, Hanson & Raginsky (2020) proved that stacking exponentially (in the sequence length) many temporal convolution filters, chained together with ReLU activations, leads to approximation of arbitrary non-linear filters. Recent works (Orvieto et al., 2023a; Wang & Xue, 2023) prove universality of linear recurrences (one layer) when equipped with a fixed (timestamp independent) point-wise MLP acting across the recurrence output, with intriguing connections to Volterra series (Boyd & Chua, 1985). Mamba (alongside with gated linear attention variants e.g. Yang et al. (2023)) does not fall in the linear RNN or the nonlinear RNN setting: its recurrence is linear on the hidden state (hence it can be parallelized) but it is not linear time-invariant as S4. In this paper, we study this setting. 3 SSMs as Linear CDEs\n\nAs shown by Gu & Dao (2023), the crucial component that unlocks in-context learning and selectivity in modern SSMs is the input-dependent state-to-state transition matrix , gating the hidden state and thus allowing the system to filter out irrelevant information and remember relevant information indefinitely. As we will shortly see, one can study the structure and features of such systems within a unified convenient continuous-time framework (Linear Controlled Differential equations). We define such framework (Def. 6) in full generality, and draw the connection to S4 and Mamba. 3.1 Linear CDEs\n\nLet us consider the separable Banach space of absolutely continuous -valued paths on and starting at the origin 666We remove the subscript if this constrain is removed. { \u03c9 : t \u21a6 \u222b 0 t \u03c9 \u02d9 s \u200b \ud835\udc51 s \u2223 \u03c9 \u02d9 \u2208 L 1 \u200b ( [ 0 , 1 ] ; \u211d d ) } conditional-set \ud835\udf14 maps-to \ud835\udc61 conditional superscript subscript 0 \ud835\udc61 subscript \u02d9 \ud835\udf14 \ud835\udc60 differential-d \ud835\udc60 \u02d9 \ud835\udf14 superscript \ud835\udc3f 1 0 1 superscript \u211d \ud835\udc51 \\left\\{\\omega:t\\mapsto\\int_{0}^{t}\\dot{\\omega}_{s}~{}ds\\mid\\dot{\\omega}\\in L^{1}([0,1];\\mathbb{R}^{d})\\right\\}\n\nendowed with the -variation norm\n\n\u2225 \u03c9 \u2225 1 ; [ 0 , 1 ] := \u222b 0 1 | \u03c9 \u02d9 s | \u200b \ud835\udc51 s . assign subscript delimited-\u2225\u2225 \ud835\udf14 1 0 1 superscript subscript 0 1 subscript \u02d9 \ud835\udf14 \ud835\udc60 differential-d \ud835\udc60 \\left\\lVert\\omega\\right\\rVert_{1;[0,1]}:=\\int_{0}^{1}|\\dot{\\omega}_{s}|~{}ds. Let of be some topological vector space where the input data lies. The prototypical example of considered in the SSM literature is the set of sequences of finite length. Modern selective (or gated) SSMs such as Mamba do not work directly with raw input data. Instead, they introduce continuous embeddings\n\n\u03c9 : \ud835\udd4f \u2192 C 1 , 0 \u200b ( [ 0 , 1 ] ; \u211d d \u03c9 ) , \u03be : \ud835\udd4f \u2192 C 1 , 0 \u200b ( [ 0 , 1 ] ; \u211d d \u03be ) : \ud835\udf14 \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf14 \ud835\udf09 : \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf09 \\displaystyle\\omega:\\mathbb{X}\\to C_{1,0}([0,1];\\mathbb{R}^{d_{\\omega}}),\\quad\\xi:\\mathbb{X}\\to C_{1,0}([0,1];\\mathbb{R}^{d_{\\xi}})\n\nusually referred to as gates. After the data is embedded into continuous paths by means of gates respectively, we define our model as a linear controlled differential equation (CDE) driven by these embeddings: fix , and matrices , and . The model we consider in this paper is the following Linear CDE777More generally, the initial condition can be chosen to be the image of another embedding of the input data, as we discuss in the Appendix. Z : \ud835\udd4f \u2192 C 1 \u200b ( [ 0 , 1 ] ; \u211d N ) : \ud835\udc4d \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 1 superscript \u211d \ud835\udc41 \\displaystyle Z:\\mathbb{X}\\to C_{1}([0,1];\\mathbb{R}^{N}) d \u200b Z t X = \u2211 i = 1 d \u03c9 A i \u200b Z t X \u200b d \u200b \u03c9 t X , i + B \u200b d \u200b \u03be t X , Z 0 X \u2208 \u211d N formulae-sequence \ud835\udc51 subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 subscript superscript \ud835\udc4d X 0 superscript \u211d \ud835\udc41 \\displaystyle dZ^{\\text{X}}_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+Bd\\xi^{\\text{X}}_{t},\\quad Z^{\\text{X}}_{0}\\in\\mathbb{R}^{N} (6)\n\nwhere is the -th channel of the path . We show that both S4 and Mamba can be written in continuous-time as Linear CDEs, for difference choices of and .",
    "theoryssms-3": "We describe this visually in Fig. 1. This motivates us to study the expressivity of the model in Eq. 6 and how it is affected by the choice of and . S4 is a Linear CDE. The S4 model (Gu et al., 2021) is a Linear CDE of the form (6) with \u201cgate\u201d functions\n\n\u03c9 t X = t , \u03be t X = \u222b 0 t X s \u200b \ud835\udc51 s . formulae-sequence subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc61 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\displaystyle\\omega^{\\text{X}}_{t}=t,\\quad\\xi^{\\text{X}}_{t}=\\int_{0}^{t}X_{s}ds. (7)\n\n3.2 Mamba is a Linear CDE\n\nLet us revisit Eqn. (3), dropping the channel index for convenience. We introduce a new parameter and consider the following reparametrization: . Let us further approximate the softplus function with a ReLU: . Eqn. (4) becomes\n\n\u0394 \u2113 = \u03c3 \u200b ( \u03b4 \u200b \u03b1 ~ \u200b x \u2113 + \u03b4 \u200b \u03b2 ~ ) = \u03c3 \u200b ( \u03b1 ~ \u200b x \u2113 + \u03b2 ~ ) \u200b \u03b4 . subscript \u0394 \u2113 \ud835\udf0e \ud835\udeff ~ \ud835\udefc subscript \ud835\udc65 \u2113 \ud835\udeff ~ \ud835\udefd \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc65 \u2113 ~ \ud835\udefd \ud835\udeff \\Delta_{\\ell}=\\sigma(\\delta\\tilde{\\alpha}x_{\\ell}+\\delta\\tilde{\\beta})=\\sigma(\\tilde{\\alpha}x_{\\ell}+\\tilde{\\beta})\\delta. As shown Appendix F, Mamba in Eqn. (3) is equivalent to the following Linear CDE\n\nd \u200b Z t X = A \u200b Z t X \u200b d \u200b \u03c9 t X + B \u200b d \u200b \u03be t X , \ud835\udc51 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc34 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 dZ^{\\text{X}}_{t}=AZ^{\\text{X}}_{t}d\\omega^{\\text{X}}_{t}+Bd\\xi^{\\text{X}}_{t}, (8)\n\nwhere we defined piecewise constant, with values the , on a grid of stepsize and\n\nd \u200b \u03c9 t X = \u03c3 \u200b ( \u03b1 ~ \u200b X t + \u03b2 ~ ) \u200b d \u200b t \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc4b \ud835\udc61 ~ \ud835\udefd \ud835\udc51 \ud835\udc61 \\displaystyle d\\omega^{\\text{X}}_{t}=\\sigma(\\tilde{\\alpha}X_{t}+\\tilde{\\beta})dt d \u200b \u03be t X = \u03c3 \u200b ( \u03b1 ~ \u200b X t + \u03b2 ~ ) \u200b X t \u200b d \u200b t \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc4b \ud835\udc61 ~ \ud835\udefd subscript \ud835\udc4b \ud835\udc61 \ud835\udc51 \ud835\udc61 \\displaystyle d\\xi^{\\text{X}}_{t}=\\sigma(\\tilde{\\alpha}X_{t}+\\tilde{\\beta})X_{t}dt\n\nAs a quick validation, note that Eqn. (3) becomes\n\nz \u2113 subscript \ud835\udc67 \u2113 \\displaystyle z_{\\ell} = exp \u2061 ( \u03c3 \u200b ( \u03b1 ~ \u200b x \u2113 + \u03b2 ~ ) \u200b \u03b4 \u200b A ) \u200b z \u2113 \u2212 1 + \u03c3 \u200b ( \u03b1 ~ \u200b x \u2113 + \u03b2 ~ ) \u200b \u03b4 \u200b B \u200b x \u2113 . absent \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc65 \u2113 ~ \ud835\udefd \ud835\udeff \ud835\udc34 subscript \ud835\udc67 \u2113 1 \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc65 \u2113 ~ \ud835\udefd \ud835\udeff \ud835\udc35 subscript \ud835\udc65 \u2113 \\displaystyle=\\exp(\\sigma(\\tilde{\\alpha}x_{\\ell}+\\tilde{\\beta})\\delta A)z_{\\ell-1}+\\sigma(\\tilde{\\alpha}x_{\\ell}+\\tilde{\\beta})\\delta Bx_{\\ell}. As , the exponential becomes linear and one has\n\nz \u2113 subscript \ud835\udc67 \u2113 \\displaystyle z_{\\ell} = \u03b4 \u2192 0 \u200b z \u2113 \u2212 1 + \u03c3 \u200b ( \u03b1 ~ \u200b x \u2113 + \u03b2 ~ ) \u200b \u03b4 \u200b A \u200b z \u2113 \u2212 1 + \u03c3 \u200b ( \u03b1 ~ \u200b x \u2113 + \u03b2 ~ ) \u200b \u03b4 \u200b B \u200b x \u2113 . \u2192 \ud835\udeff 0 subscript \ud835\udc67 \u2113 1 \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc65 \u2113 ~ \ud835\udefd \ud835\udeff \ud835\udc34 subscript \ud835\udc67 \u2113 1 \ud835\udf0e ~ \ud835\udefc subscript \ud835\udc65 \u2113 ~ \ud835\udefd \ud835\udeff \ud835\udc35 subscript \ud835\udc65 \u2113 \\displaystyle\\overset{\\delta\\to 0}{=}z_{\\ell-1}+\\sigma(\\tilde{\\alpha}x_{\\ell}+\\tilde{\\beta})\\delta Az_{\\ell-1}+\\sigma(\\tilde{\\alpha}x_{\\ell}+\\tilde{\\beta})\\delta Bx_{\\ell}. Which is the standard forward Euler discretization of the Mamba ODE in Eqn. (8). 4 Expressivity of Linear CDEs\n\nHaving established the connection between SSMs and Linear CDEs, we now provide an explicit characterisation of their uniform closure, i.e. a description of all the functions from compact subsets of to that can be uniformly approximated at an arbitrary precision by a Linear CDE of the form given in Eqn. (6). 4.1 Characterization of the closure\n\nFor any path and any sub-interval , we denote by the following path\n\n\u03c9 [ s , t ] \u200b ( u ) = { 0 if \u200b u < s \u03c9 u \u2212 \u03c9 s if \u200b u \u2208 [ s , t ] \u03c9 t \u2212 \u03c9 s if \u200b u > t . subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 \ud835\udc62 cases 0 if \ud835\udc62 \ud835\udc60 subscript \ud835\udf14 \ud835\udc62 subscript \ud835\udf14 \ud835\udc60 if \ud835\udc62 \ud835\udc60 \ud835\udc61 subscript \ud835\udf14 \ud835\udc61 subscript \ud835\udf14 \ud835\udc60 if \ud835\udc62 \ud835\udc61 \\omega_{[s,t]}(u)=\\begin{cases}0&\\text{if }u<s\\\\\n\\omega_{u}-\\omega_{s}&\\text{if }u\\in[s,t]\\\\\n\\omega_{t}-\\omega_{s}&\\text{if }u>t.\\end{cases}\n\nTheorem 4.1. Consider continuous gates such that and 888 These assumptions are of technical nature and can be relaxed at the cost of talking about tree-like equivalence of paths cf. (Hambly & Lyons, 2010). not needed for path-to-point tasks.. Let be a compact subset. Then, the uniform closure of the Linear CDE model in (6) over is given by the following set of functionals\n\n{ ( X , t ) \u21a6 \u03a8 \u200b ( \u03c9 [ 0 , t ] X ) + \u222b 0 t \u03a6 \u200b ( \u03c9 [ s , t ] X ) \u22c5 \ud835\udc51 \u03be s X } maps-to \ud835\udc4b \ud835\udc61 \u03a8 subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript 0 \ud835\udc61 \u22c5 \u03a6 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\left\\{(X,t)\\mapsto\\Psi(\\omega^{\\text{X}}_{[0,t]})+\\int_{0}^{t}\\Phi(\\omega^{\\text{X}}_{[s,t]})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (9)\n\nwhere is the scalar product on , and where\n\n\u03a8 : C 1 , 0 \u200b ( [ 0 , 1 ] , \u211d d \u03c9 ) \u2192 \u211d , \u03a6 : C 1 , 0 \u200b ( [ 0 , 1 ] , \u211d d \u03be ) \u2192 \u211d d \u03be : \u03a8 \u2192 subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf14 \u211d \u03a6 : \u2192 subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf09 superscript \u211d subscript \ud835\udc51 \ud835\udf09 \\Psi:C_{1,0}([0,1],\\mathbb{R}^{d_{\\omega}})\\to\\mathbb{R},\\quad\\Phi:C_{1,0}([0,1],\\mathbb{R}^{d_{\\xi}})\\to\\mathbb{R}^{d_{\\xi}}\n\nare generic continuous functions. If the matrices are constrained to be diagonal, as it is often the case in practice, the requirements , can be dropped and the closure reduces to\n\n{ ( X , t ) \u21a6 \u03c8 \u200b ( \u03c9 t X ) + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X } maps-to \ud835\udc4b \ud835\udc61 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\left\\{(X,t)\\mapsto\\psi(\\omega^{\\text{X}}_{t})+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (10)\n\nfor continuous and .",
    "theoryssms-4": "All proofs can be found in the Appendix. Remark 4.2. This result can be seen as a generalization of the Universal Approximation for Linear RNNs presented by Li et al. (2022b)[Thm. 7] for generic gates . In fact in their setting with gates set as in (7) family (9) reduces to linear input filterings given by convolutions\n\n{ ( X , t ) \u21a6 \u222b 0 t \u03c1 \u200b ( t \u2212 s ) \u22c5 X s \u200b \ud835\udc51 s } maps-to \ud835\udc4b \ud835\udc61 superscript subscript 0 \ud835\udc61 \u22c5 \ud835\udf0c \ud835\udc61 \ud835\udc60 subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\left\\{(X,t)\\mapsto\\int_{0}^{t}\\rho(t-s)\\cdot X_{s}ds\\right\\}\n\nRemark 4.3. The specific restriction of to subsets of is a crucial part of (9). The family of approximable maps does not include all path-to-path causal999A causal map is one which does not \u201dlook in the future\u201d cf. Appendix D. functions but a subset of them, of type , satisfying the specific time-homogeneity specified by the form of the restriction, akin to that in (Li et al., 2022b). 4.2 Signature expansion\n\nTo study expressivity of these generalized SSMs (Linear CDEs), it will be convenient to introduce the so-called signature transform (Lyons et al., 2007; Kidger et al., 2019; Fermanian et al., 2023), a classical path-transform from stochastic analysis. The main reason for doing so is that, as a simple consequence of the Stone-Weirestrass theorem, linear functionals on the signature provide the essential building blocks (analogous to monomials on Euclidean spaces) to approximate continuous functions on path space. Consider a path and define as the set of words (i.e. ordered sequences) in the alphabet 101010So when we write we mean for some integer and letters , then will be the word for .. The signature transform is the following infinite collection of scalar iterated integrals\n\nSig \u200b ( \u03c9 ) s , t := ( Sig \u200b ( \u03c9 ) s , t ( I ) ) I \u2208 \ud835\udd4e d \u03c9 \u2208 l 2 \u200b ( \ud835\udd4e d \u03c9 ) assign Sig subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 subscript Sig superscript subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 \ud835\udc3c \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 superscript \ud835\udc59 2 subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \\text{Sig}(\\omega)_{s,t}:=\\left(\\text{Sig}(\\omega)_{s,t}^{(I)}\\right)_{I\\in\\mathbb{W}_{d_{\\omega}}}\\in l^{2}(\\mathbb{W}_{d_{\\omega}})\n\nwhere\n\nSig \u200b ( \u03c9 ) s , t ( I ) := \u222b s < u 1 < \u2026 < u n < t \u03c9 \u02d9 u 1 ( i 1 ) \u200b \u2026 \u200b \u03c9 \u02d9 u n ( i n ) \u200b \ud835\udc51 u 1 \u200b \u2026 \u200b \ud835\udc51 u n . assign Sig superscript subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 \ud835\udc3c subscript \ud835\udc60 subscript \ud835\udc62 1 \u2026 subscript \ud835\udc62 \ud835\udc5b \ud835\udc61 superscript subscript \u02d9 \ud835\udf14 subscript \ud835\udc62 1 subscript \ud835\udc56 1 \u2026 superscript subscript \u02d9 \ud835\udf14 subscript \ud835\udc62 \ud835\udc5b subscript \ud835\udc56 \ud835\udc5b differential-d subscript \ud835\udc62 1 \u2026 differential-d subscript \ud835\udc62 \ud835\udc5b \\text{Sig}(\\omega)_{s,t}^{(I)}:=\\int_{s<u_{1}<...<u_{n}<t}\\dot{\\omega}_{u_{1}}^{(i_{1})}...\\dot{\\omega}_{u_{n}}^{(i_{n})}du_{1}...du_{n}. We refer the interested reader to Appendix A for additional details and references on the signature. A classical result from rough path theory states that a Linear CDE can be expanded explicitly as an (infinite) linear combination of terms in the signature of the driving path. Next, we specialize this result to the case of Linear CDEs given by Eqn.",
    "theoryssms-5": "(6). Proposition 4.4. For any choice of matrices and , the unique solution to\n\nd \u200b Z t X = \u2211 i = 1 d \u03c9 A i \u200b Z t X \u200b d \u200b \u03c9 t X , i + B \u200b d \u200b \u03be t X , Z 0 X = Z 0 \u2208 \u211d N formulae-sequence \ud835\udc51 subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 subscript superscript \ud835\udc4d X 0 subscript \ud835\udc4d 0 superscript \u211d \ud835\udc41 dZ^{\\text{X}}_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+Bd\\xi^{\\text{X}}_{t},\\quad Z^{\\text{X}}_{0}=Z_{0}\\in\\mathbb{R}^{N}\n\nis given by\n\nZ t X = subscript superscript \ud835\udc4d X \ud835\udc61 absent \\displaystyle Z^{\\text{X}}_{t}= \u2211 I \u2208 \ud835\udd4e d \u03c9 A I \u200b Z 0 \u200b Sig \u200b ( \u03c9 X ) 0 , t ( I ) subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc4d 0 Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc3c \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}Z_{0}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{(I)} (11) + \u2211 i = 1 d \u03be \u2211 I \u2208 \ud835\udd4e d \u03c9 A I \u200b B i \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t ( I ) \u200b \ud835\udc51 \u03be s X , i \u2208 \u211d N superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf09 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc56 superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc56 \ud835\udc60 superscript \u211d \ud835\udc41 \\displaystyle+\\sum_{i=1}^{d_{\\xi}}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}B_{i}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{(I)}d\\xi^{\\text{X},i}_{s}\\in\\mathbb{R}^{N}\n\nwhere we used the notation . Notice that the previous result does not rely on any assumptions on the nature of , , and ; for any such choice the result is a time-independent linear map on a feature vector\n\nT \u200b ( X ) 0 , t := ( Sig \u200b ( \u03c9 X ) 0 , t ( I ) , \u222b 0 t Sig \u200b ( \u03c9 X ) s , t ( I ) \u200b \ud835\udc51 \u03be s X , i ) ( I , i ) assign \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 subscript Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc3c superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc56 \ud835\udc60 \ud835\udc3c \ud835\udc56 T(X)_{0,t}:=\\left(\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{(I)},\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{(I)}d\\xi^{\\text{X},i}_{s}\\right)_{(I,i)}\n\nwhich is a subsequence of , and where the index runs over . 4.3 Randomised Linear CDEs\n\nIt turns out that the same space of functionals in the closure (9) of a Linear CDE can be induced, with high probability, by sampling the matrices and at random according to standard ML practices (LeCun et al., 2012), as stated in the following result:\n\nTheorem 4.5. For any compact subset and for any functional of the form given in Eqn. (9), the following holds\n\nlim N \u2192 \u221e \u2119 [ { \\displaystyle\\lim\\limits_{N\\to\\infty}\\mathbb{P}\\Big{[}\\Big{\\{} \u2203 v \u2208 \u211d N such that \ud835\udc63 superscript \u211d \ud835\udc41 such that \\displaystyle\\exists v\\in\\mathbb{R}^{N}\\quad\\text{such that} sup ( X , t ) \u2208 \ud835\udd42 \u00d7 [ 0 , 1 ] | F ( X , t ) \u2212 \u27e8 v , Z t X \u27e9 | \u2264 \u03f5 } ] = 1 \\displaystyle\\sup\\limits_{(X,t)\\in\\mathbb{K}\\times[0,1]}|F(X,t)-\\langle v,Z^{\\text{X}}_{t}\\rangle|\\leq\\epsilon\\Big{\\}}\\Big{]}=1\n\nwhere the matrices and defining are sampled at random as\n\n[ A j ] n , n \u2032 \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 N ) [ Z ] n , [ B ] n , j \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 ) . subscript delimited-[] subscript \ud835\udc34 \ud835\udc57 \ud835\udc5b superscript \ud835\udc5b \u2032 iid similar-to \ud835\udca9 0 1 \ud835\udc41 subscript delimited-[] \ud835\udc4d \ud835\udc5b subscript delimited-[] \ud835\udc35 \ud835\udc5b \ud835\udc57 iid similar-to \ud835\udca9 0 1 [A_{j}]_{n,n^{\\prime}}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,\\frac{1}{N})\\quad[Z]_{n},[B]_{n,j}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,1). In particular, Thm. 4.5 implies that only the final readout needs to be trained, while the randomly initialised matrices and can be left untrained (cf.",
    "theoryssms-6": "Sec. 6). This is a similar mechanism to the paradigm advocated in reservoir computing (Cuchiero et al., 2021b; Lukoveviius & Jaeger, 2009). Remark 4.6. It can be proved, using the results by Dubach & Peled (2021), that the sampling measure does not have to be Gaussian if it satisfies certain moment requirements. The core argument behind the proof of Thm. 4.5 consists of exhibiting almost-orthogonal vectors trough random linear maps, and then using these as a pseudo-basis of vectors on which to mimic the dynamics of the feature map . It then suffices to bound the error made by this approximate approach, which is proved to disappear as the dimension increases. 4.4 S4 as a special case\n\nIn case and , like in S4, one has . Thus, and the signature reduces to\n\nSig \u200b ( \u03c9 X ) s , t := ( Sig \u200b ( \u03c9 X ) s , t ( k ) ) k \u2208 \u2115 assign Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 subscript Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc58 \ud835\udc58 \u2115 \\text{Sig}(\\omega^{\\text{X}})_{s,t}:=\\left(\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{(k)}\\right)_{k\\in\\mathbb{N}}\n\nwhere\n\nSig \u200b ( \u03c9 X ) s , t ( k ) = ( t \u2212 s ) k k ! . Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc58 superscript \ud835\udc61 \ud835\udc60 \ud835\udc58 \ud835\udc58 \\text{Sig}(\\omega^{\\text{X}})_{s,t}^{(k)}=\\frac{(t-s)^{k}}{k!}. This in turns implies the following expression for\n\nZ t X = \u2211 i = 1 d \u03be \u222b 0 t e A \u200b ( t \u2212 s ) \u200b B i \u200b X s i \u200b \ud835\udc51 s , superscript subscript \ud835\udc4d \ud835\udc61 X superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 superscript \ud835\udc52 \ud835\udc34 \ud835\udc61 \ud835\udc60 subscript \ud835\udc35 \ud835\udc56 subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc60 differential-d \ud835\udc60 Z_{t}^{\\text{X}}=\\sum_{i=1}^{d_{\\xi}}\\int_{0}^{t}e^{A(t-s)}B_{i}X^{i}_{s}ds,\n\nand the corresponding feature vector reads\n\nT \u200b ( X ) 0 , t = ( \u222b 0 t ( t \u2212 s ) k k ! \u200b X s i \u200b \ud835\udc51 s ) ( k , i ) . \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 subscript superscript subscript 0 \ud835\udc61 superscript \ud835\udc61 \ud835\udc60 \ud835\udc58 \ud835\udc58 subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc60 differential-d \ud835\udc60 \ud835\udc58 \ud835\udc56 T(X)_{0,t}=\\left(\\int_{0}^{t}\\frac{(t-s)^{k}}{k!}X^{i}_{s}ds\\right)_{(k,i)}. where the index runs over . As a result, linear maps on are of the type\n\n\u222b 0 t p \u200b ( t \u2212 s ) \u22c5 X s \u200b \ud835\udc51 s superscript subscript 0 \ud835\udc61 \u22c5 \ud835\udc5d \ud835\udc61 \ud835\udc60 subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\int_{0}^{t}p(t-s)\\cdot X_{s}ds\n\nfor polynomials , which reconciles our framework with the results obtained by Li et al. (2022b). It is evident from this discussion that the classical choice of input-independent (i.e. ) precludes the use of higher order statistics of . Architectural choices\n\nThe matrices defining the Linear CDE (6) are generally dense matrices. However, at the core of the efficient GPU-efficient computation strategy of S4 and Mamba is the need for diagonal recurrences (see speed comparisons in (Orvieto et al., 2023b)). Indeed, dense matrix multiplication inevitably takes the computational cost of the forward pass to complexity, where is the sequence length. Instead, using diagonal recurrences results in a complexity. Motivated by the efficiency requirements in S4 and Mamba, in the next section, we discuss the question of whether this choice of diagonal restricts the family of functionals that one can learn. 4.5 The Diagonal Case\n\nIf , due to commutativity of diagonal matrices, one has that for any permutation of a word the equality holds. This means that a linear functional on such as (11) can fundamentally only see the symmetric part of , which is just the tensor exponential\n\ne \u2297 \u222b s t \ud835\udc51 \u03c9 r X := ( \u220f i = 1 d \u03c9 ( \u03c9 t X , i \u2212 \u03c9 s X , i ) k i k i ! ) \ud835\udc8c \u2208 \u2115 d \u03c9 , assign superscript \ud835\udc52 tensor-product absent superscript subscript \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf14 X \ud835\udc5f subscript superscript subscript product \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 subscript \ud835\udc58 \ud835\udc56 subscript \ud835\udc58 \ud835\udc56 \ud835\udc8c superscript \u2115 subscript \ud835\udc51 \ud835\udf14 e^{\\otimes\\int_{s}^{t}d\\omega^{\\text{X}}_{r}}:=\\left(\\prod_{i=1}^{d_{\\omega}}\\frac{(\\omega^{\\text{X},i}_{t}-\\omega^{\\text{X},i}_{s})^{k_{i}}}{k_{i}!}\\right)_{\\boldsymbol{k}\\in\\mathbb{N}^{d_{\\omega}}}, (12)\n\nand as such does not capture higher order channel combinations (cf. See Sect. 6 for empirical validation). In fact the explicit solution a can be written as\n\nZ t X = e diag \u2061 ( V \u200b \u03c9 t X ) \u200b Z 0 + \u222b 0 t e diag \u2061 ( V \u200b ( \u03c9 t X \u2212 \u03c9 s X ) ) \u200b B \u200b \ud835\udc51 \u03be s X superscript subscript \ud835\udc4d \ud835\udc61 X superscript \ud835\udc52 diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4d 0 superscript subscript 0 \ud835\udc61 superscript \ud835\udc52 diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc35 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 Z_{t}^{\\text{X}}=e^{\\operatorname{diag}(V\\omega^{\\text{X}}_{t})}Z_{0}+\\int_{0}^{t}e^{\\operatorname{diag}(V(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s}))}Bd\\xi^{\\text{X}}_{s} (13)\n\nwhere . The closure of linear functionals on solutions of (13) is characterized as the following set of functionals\n\n{ ( X , t ) \u21a6 \u03c8 \u200b ( \u03c9 t X ) + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X } maps-to \ud835\udc4b \ud835\udc61 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\left\\{(X,t)\\mapsto\\psi(\\omega^{\\text{X}}_{t})+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (14)\n\nfor and . Efficiency and Stability. On top of efficiency, an important feature of selective SSMs, crucial for long-range reasoning (see discussion in (Orvieto et al., 2023b)) is their stability in a dynamical system sense: eigenvalues of for those discrete recurrences always have absolute value bounded by . Both S4 and Mamba achieve this by restricting the sign of the diagonal components of their recurrent matrix with positive nonlinearities such as ReLUs (see Sec.",
    "theoryssms-7": "2). Under ZOH numerical integration (see again Sec. 2), the resulting discrete-time is guaranteed to be stable. We can apply the same idea in the general linear diagonal CDE setting (cf. Appendix C.1). Instead, if one works with dense matrices, ensuring stability in numerical integration during training requires heavy adaptations of the optimizer on top of higher overall complexity. Expressivity. Note that the main difference between (9) and (14) is the path-dependence: the latter take as input just a value or increment of while the maps in are functions on whole sections of it. Diagonal selective SSMs (i.e. Mamba111111Instead, expressivity of S4 is unaffected by diagonality in the recurrence, see results above and in (Li et al., 2022b).) are thus fundamentally weaker than their non-diagonal counterparts, as they can at most capture the symmetric part of \u2019s signature and its integrals against (see Appendix for details). 4.6 Chaining Diagonal CDEs\n\nFortunately it is possible to re-gain expressivity without sacrificing the computational advantages of diagonal schemes through chaining. This means driving a new linear CDE by the solution of a previous linear CDE, and repeating this procedure times. With this procedure, one can recover signature entries up to depth with complexity . Proposition 4.7. Assume a compact input set . For any with and there is a sequence of linear maps and weights for the following family of chained linear CDEs\n\nd \u200b Z t 1 , X = \u2211 i = 1 d A i ( 1 ) \u200b Z t 1 , X \u200b d \u200b X t i + B ( 1 ) \u200b d \u200b X t , \ud835\udc51 superscript subscript \ud835\udc4d \ud835\udc61 1 X superscript subscript \ud835\udc56 1 \ud835\udc51 subscript superscript \ud835\udc34 1 \ud835\udc56 subscript superscript \ud835\udc4d 1 X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc61 superscript \ud835\udc35 1 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 \\displaystyle dZ_{t}^{1,\\text{X}}=\\sum_{i=1}^{d}A^{(1)}_{i}Z^{1,\\text{X}}_{t}dX^{i}_{t}+B^{(1)}d{{X}}_{t}, d \u200b Z t k + 1 , X = \u2211 i = 1 d + 1 A i ( k + 1 ) \u200b Z t k + 1 , X \u200b d \u200b [ W k \u200b Z k , X X ] t i \ud835\udc51 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 1 X superscript subscript \ud835\udc56 1 \ud835\udc51 1 subscript superscript \ud835\udc34 \ud835\udc58 1 \ud835\udc56 subscript superscript \ud835\udc4d \ud835\udc58 1 X \ud835\udc61 \ud835\udc51 subscript superscript matrix subscript \ud835\udc4a \ud835\udc58 superscript \ud835\udc4d \ud835\udc58 X \ud835\udc4b \ud835\udc56 \ud835\udc61 \\displaystyle dZ_{t}^{k+1,\\text{X}}=\\sum_{i=1}^{d+1}A^{(k+1)}_{i}Z^{k+1,\\text{X}}_{t}d\\begin{bmatrix}W_{k}Z^{k,\\text{X}}\\\\\n{X}\\end{bmatrix}^{i}_{t} + B ( k + 1 ) \u200b d \u200b X t , superscript \ud835\udc35 \ud835\udc58 1 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 \\displaystyle+B^{(k+1)}dX_{t},\n\nwith , such that for some one has\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | S \u200b i \u200b g \u200b ( X ) 0 , t ( I ) \u2212 \u27e8 v , Z t | I | \u2212 1 , X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc46 \ud835\udc56 \ud835\udc54 subscript superscript \ud835\udc4b \ud835\udc3c 0 \ud835\udc61 \ud835\udc63 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc3c 1 X italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|Sig(X)^{(I)}_{0,t}-\\langle v,Z_{t}^{|I|-1,\\text{X}}\\rangle|\\leq\\epsilon (15)\n\nThe intuition behind this result is the following: with a single diagonal layer it\u2019s possible 121212This is not straightforward since the time in the integral part of (14) is going \u201dbackwards\u201d! to recover the terms\n\n\u222b 0 t ( \u03c9 s X , i \u2212 \u03c9 0 X , i ) \u200b \ud835\udc51 \u03be s X , j superscript subscript 0 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 subscript superscript \ud835\udf14 X \ud835\udc56 0 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\int_{0}^{t}(\\omega^{\\text{X},i}_{s}-\\omega^{\\text{X},i}_{0})d\\xi^{\\text{X},j}_{s}\n\nwhich are just length terms from .",
    "theoryssms-8": "If we pass these terms as in another layer then we can obtain a length term from , and so on. Remark 4.8. The structure of the chaining in Prop. 4.7 seems quite restrictive, in particular it\u2019s not clear to which extent gates which are non-linear in the input allow for such a construction. In the Appendix we address this issue in the simple but important case , where we show that no information is lost and numerical stability can be enforced. 5 Path-to-Path Learning\n\nUp to now we have been dealing with a limited class of path-to-path maps essentially built by functionals of type for a fixed linear map . Crucial for modern machine learning are general continuous path-to-path models of type . As shown in (Orvieto et al., 2023a), classical SSMs followed by a non-linearity and a feed-forward network are universal path-to-path when the inputs are piecewise linear paths on fixed discretizations (i.e. universal on sequences). Orvieto et al. (2023a) discuss an important feature of S4, which we already presented in previous sections: its action on the input is a simple convolution with fixed (independent of the input) parameters. For this exact reason, the construction of (Orvieto et al., 2023a) defers all non-linear computation (reasoning) to the multi-layer perceptron (MLP) acting on the linear recurrence output, which is simply providing in their setting a loss-less compression of the inputs \u2013 with no added reasoning. In our setting, we instead characterized the processing power of input-controlled (dense or diagonal) SSMs precisely, showing that it greatly surpasses linear filtering. For this reason, the computational burden for an MLP action on a general linear CDE, unlocking path-to-path learning, would be greatly diminished and its actual function reduced to a time-consistent interpolation of already good path-to-point approximations. This method is robust to different input discretization schemes and does not offload all the complexity to the network which follows the SSM (cf.",
    "theoryssms-9": "Figure 2). Proposition 5.1. Fix a compact set and continuous with . Then for all and all causal continuous mapping there exist an integer , some Feed Forward neural network , and parameters such that\n\nsup ( X , t ) \u2208 \ud835\udd42 \u00d7 [ 0 , 1 ] | F \u200b ( Z t X ) \u2212 G \u200b ( \u03c9 X , t ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd42 0 1 \ud835\udc39 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc61 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{K}\\times[0,1]}|F(Z^{\\text{X}}_{t})-G(\\omega^{\\text{X}},t)|<\\epsilon (16)\n\nActually, in the above result does not have to be a neural network, it suffices for it to be able to interpolate linear maps in a time-consistent manner cf.",
    "theoryssms-10": "Appendix D. 6 Empirical Validation\n\nA variation on the toy dataset introduced in (Walker et al., 2024) is used to empirically validate our theoretical results. We use two datasets of sample paths each, with dimensions and respectively. In both datasets, paths are defined on regularly spaced time-steps between and . The change in each channel at each time point is an independent sample from a standard Normal distribution rounded to the nearest integer. The datasets are then normalised to range between and . The aim on both datasets is to predict specific terms in the anti-symmetric part of the signature. For the dimensional dataset the prediction is an area integral and for the dimensional a volume integral given, respectively, by\n\n\u222b 0 1 \u222b 0 v \ud835\udc51 X u 1 \u200b \ud835\udc51 X v 2 , \u222b 0 1 \u222b 0 w \u222b 0 v \ud835\udc51 X u 1 \u200b \ud835\udc51 X v 2 \u200b \ud835\udc51 X w 3 . superscript subscript 0 1 superscript subscript 0 \ud835\udc63 differential-d subscript superscript \ud835\udc4b 1 \ud835\udc62 differential-d subscript superscript \ud835\udc4b 2 \ud835\udc63 superscript subscript 0 1 superscript subscript 0 \ud835\udc64 superscript subscript 0 \ud835\udc63 differential-d subscript superscript \ud835\udc4b 1 \ud835\udc62 differential-d subscript superscript \ud835\udc4b 2 \ud835\udc63 differential-d subscript superscript \ud835\udc4b 3 \ud835\udc64 \\int_{0}^{1}\\int_{0}^{v}dX^{1}_{u}dX^{2}_{v},\\quad\\int_{0}^{1}\\int_{0}^{w}\\int_{0}^{v}dX^{1}_{u}dX^{2}_{v}dX^{3}_{w}. We consider five models:\n\n1. A S5 or Mamba recurrence with linear readout. 2. Two stacked S5 or Mamba recurrences with a linear mixing layer in-between, and the final state of the second layer fed into a linear readout. 3. A linear NCDE with gates followed by a linear readout. All state space models have trainable matrices in their recurrences, whereas the linear NCDE is using fixed matrices. All of the models use a hidden dimension of , with the state space models using a state dimension of . The state space models are trained using batch gradient descent with a batch size of and Adam with a learning rate of .",
    "theoryssms-11": "Results are plotted in Fig. 3. The output from the linear NCDE\u2019s recurrence is obtained using an adaptive ODE solver, Tsit5, with an absolute and relative tolerance of . The linear NCDEs linear layer is obtained by ordinary least squares. 7 Conclusions\n\nIn this paper we have considered a family of models, defined by gating functions as solutions to linear CDEs, which extends both classical and modern SSM architectures. Using analytical tools from Rough Paths theory we have characterized the uniform closure of these models generalizing the results of (Li et al., 2022b), shedding light on the expressive advantages of input-controlled transition dynamics, which allow to capture high order statistics of the input as opposed to just the linear ones extracted by convolutions. We point out how the full expressive range is already captured by generic models, and how more efficient computational structures, such as imposing diagonality, weaken these expressive capabilities. A remedy to this loss is presented in the chaining of these models. Finally we show how the substitution of the linear readout with an MLP allows to approximate general path-to-path functions without, in contrast to the S4 case, offloading all the complexity to the neural network. 8 Acknowledgements\n\nNicola Muca Cirone is supported by the EPSRC Centre for Doctoral Training in Mathematics of Random Systems: Analysis, Modelling and Simulation (EP/S023925/1). Antonio Orvieto acknowledges the financial support of the Hector Foundation. Benjamin Walker was funded by the Hong Kong Innovation and Technology Commission (InnoHK Project CIMDA). Terry Lyons was funded in part by the EPSRC [grant number EP/S026347/1], in part by The Alan Turing Institute under the EPSRC grant EP/N510129/1, the Data Centric Engineering Programme (under the Lloyd\u2019s Register Foundation grant G0095), the Defence and Security Programme (funded by the UK Government) and the Office for National Statistics & The Alan Turing Institute (strategic partnership) and in part by the Hong Kong Innovation and Technology Commission (InnoHK Project CIMDA).",
    "theoryssms-12": "References\n\nArribas et al. (2020) Arribas, I. P., Salvi, C., and Szpruch, L. Sig-sdes model for quantitative finance. In Proceedings of the First ACM International Conference on AI in Finance, pp. 1\u20138, 2020. Barron (1993) Barron, A. R. Universal approximation bounds for superpositions of a sigmoidal function. IEEE Transactions on Information theory, 39(3):930\u2013945, 1993. Berlinet & Thomas-Agnan (2011) Berlinet, A. and Thomas-Agnan, C. Reproducing Kernel Hilbert Spaces in Probability and Statistics. Springer US, 2011. ISBN 9781441990969. URL https://books.google.co.uk/books?id=bX3TBwAAQBAJ. Boyd & Chua (1985) Boyd, S. and Chua, L. Fading memory and the problem of approximating nonlinear operators with volterra series. IEEE Transactions on circuits and systems, 32(11):1150\u20131161, 1985. Chen (1958) Chen, K.-T. Integration of paths\u2013a faithful representation of paths by noncommutative formal power series. Transactions of the American Mathematical Society, 89(2):395\u2013407, 1958.",
    "theoryssms-13": "ISSN 00029947. URL http://www.jstor.org/stable/1993193. Chevyrev & Kormilitzin (2016) Chevyrev, I. and Kormilitzin, A. A primer on the signature method in machine learning. arXiv preprint arXiv:1603.03788, 2016. Cho et al. (2014) Cho, K., Van Merri\u00ebnboer, B., Gulcehre, C., Bahdanau, D., Bougares, F., Schwenk, H., and Bengio, Y. Learning phrase representations using rnn encoder-decoder for statistical machine translation.",
    "theoryssms-14": "arXiv preprint arXiv:1406.1078, 2014. Cirone et al. (2023) Cirone, N. M., Lemercier, M., and Salvi, C. Neural signature kernels as infinite-width-depth-limits of controlled resnets, 2023.",
    "theoryssms-15": "Cochrane et al. (2021) Cochrane, T., Foster, P., Chhabra, V., Lemercier, M., Lyons, T., and Salvi, C. Sk-tree: a systematic malware detection algorithm on streaming trees via the signature kernel. In 2021 IEEE international conference on cyber security and resilience (CSR), pp. 35\u201340. IEEE, 2021. Cuchiero et al. (2021a) Cuchiero, C., Gonon, L., Grigoryeva, L., Ortega, J.-P., and Teichmann, J. Expressive power of randomized signature. In The Symbiosis of Deep Learning and Differential Equations, 2021a. Cuchiero et al. (2021b) Cuchiero, C., Gonon, L., Grigoryeva, L., Ortega, J.-P., and Teichmann, J. Discrete-time signatures and randomness in reservoir computing.",
    "theoryssms-16": "IEEE Transactions on Neural Networks and Learning Systems, Forthcoming, 04 2021b. doi: 10.1109/TNNLS.2021.3076777. Dasgupta & Gupta (2003) Dasgupta, S. and Gupta, A. An elementary proof of a theorem of johnson and lindenstrauss. Random Structures & Algorithms, 22, 2003. URL https://api.semanticscholar.org/CorpusID:10327785. De et al. (2024) De, S., Smith, S. L., Fernando, A., Botev, A., Cristian-Muraru, G., Gu, A., Haroun, R., Berrada, L., Chen, Y., Srinivasan, S., Desjardins, G., Doucet, A., Budden, D., Teh, Y. W., Pascanu, R., Freitas, N. D., and Gulcehre, C. Griffin: Mixing gated linear recurrences with local attention for efficient language models, 2024. Dosovitskiy et al. (2020) Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Houlsby, N., Gelly, S., Zhang, X., and Uszkoreit, J. An image is worth 16x16 words: Transformers for image recognition at scale. arXiv preprint arXiv:2010.11929, 2020. Dubach & Peled (2021) Dubach, G. and Peled, Y. On words of non-Hermitian random matrices. The Annals of Probability, 49(4):1886 \u2013 1916, 2021. doi: 10.1214/20-AOP1496. URL https://doi.org/10.1214/20-AOP1496. Fermanian (2020) Fermanian, A. Embedding and learning with signatures, 2020.",
    "theoryssms-17": "Fermanian et al. (2023) Fermanian, A., Lyons, T., Morrill, J., and Salvi, C. New directions in the applications of rough path theory. IEEE BITS the Information Theory Magazine, 2023. Friz & Victoir (2010) Friz, P. K. and Victoir, N. B. Multidimensional Stochastic Processes as Rough Paths: Theory and Applications. Cambridge Studies in Advanced Mathematics. Cambridge University Press, 2010. doi: 10.1017/CBO9780511845079. Fu et al. (2022) Fu, D. Y., Dao, T., Saab, K.",
    "theoryssms-18": "K., Thomas, A. W., Rudra, A., and Re, C. Hungry hungry hippos: Towards language modeling with state space models. In The Eleventh International Conference on Learning Representations, 2022. Goel et al. (2022) Goel, K., Gu, A., Donahue, C., and R\u00e9, C. It\u2019s raw! audio generation with state-space models. International Conference on Machine Learning, 2022. Gu & Dao (2023) Gu, A. and Dao, T. Mamba: Linear-time sequence modeling with selective state spaces, 2023.",
    "theoryssms-19": "Gu et al. (2020) Gu, A., Dao, T., Ermon, S., Rudra, A., and R\u00e9, C. Hippo: Recurrent memory with optimal polynomial projections.",
    "theoryssms-20": "Advances in neural information processing systems, 33:1474\u20131487, 2020. Gu et al. (2021) Gu, A., Goel, K., and Re, C. Efficiently modeling long sequences with structured state spaces. In International Conference on Learning Representations, 2021. Gu et al. (2022) Gu, A., Gupta, A., Goel, K., and R\u00e9, C. On the parameterization and initialization of diagonal state space models. arXiv preprint arXiv:2206.11893, 2022. Hambly & Lyons (2010) Hambly, B. and Lyons, T. Uniqueness for the signature of a path of bounded variation and the reduced path group.",
    "theoryssms-21": "Annals of Mathematics, pp. 109\u2013167, 2010. Hanson & Raginsky (2020) Hanson, J. and Raginsky, M. Universal simulation of stable dynamical systems by recurrent neural nets. In Learning for Dynamics and Control, pp. 384\u2013392. PMLR, 2020. Hochreiter & Schmidhuber (1997) Hochreiter, S. and Schmidhuber, J. Long short-term memory. Neural computation, 1997. Hoglund et al. (2023) Hoglund, M., Ferrucci, E., Hernandez, C., Gonzalez, A. M., Salvi, C., Sanchez-Betancourt, L., and Zhang, Y. A neural rde approach for continuous-time non-markovian stochastic control problems. arXiv preprint arXiv:2306.14258, 2023. Issa et al. (2023) Issa, Z., Horvath, B., Lemercier, M., and Salvi, C. Non-adversarial training of neural sdes with signature kernel scores. Advances in Neural Information Processing Systems, 2023. Katsch (2023) Katsch, T. Gateloop: Fully data-controlled linear recurrence for sequence modeling, 2023. Kidger (2022) Kidger, P. On neural differential equations, 2022. Kidger et al. (2019) Kidger, P., Bonnier, P., Perez Arribas, I., Salvi, C., and Lyons, T. Deep signature transforms. Advances in Neural Information Processing Systems, 32, 2019. Kidger et al. (2020) Kidger, P., Morrill, J., Foster, J., and Lyons, T. Neural controlled differential equations for irregular time series. Advances in Neural Information Processing Systems, 33:6696\u20136707, 2020. Korsky & Berwick (2019) Korsky, S. A. and Berwick, R. C. On the computational power of rnns. arXiv preprint arXiv:1906.06349, 2019. LeCun et al. (2012) LeCun, Y. A., Bottou, L., Orr, G. B., and M\u00fcller, K.-R. Efficient BackProp, pp. 9\u201348. Springer Berlin Heidelberg, Berlin, Heidelberg, 2012. ISBN 978-3-642-35289-8. doi: 10.1007/978-3-642-35289-8\u02d93. URL https://doi.org/10.1007/978-3-642-35289-8_3. Lemercier et al. (2021) Lemercier, M., Salvi, C., Damoulas, T., Bonilla, E. V., and Lyons, T. Distribution regression for sequential data, 2021. Li et al. (2022a) Li, Y., Cai, T., Zhang, Y., Chen, D., and Dey, D. What makes convolutional models great on long sequence modeling?",
    "theoryssms-22": "arXiv preprint arXiv:2210.09298, 2022a. Li et al. (2022b) Li, Z., Han, J., Weinan, E., and Li, Q. Approximation and optimization theory for linear continuous-time recurrent neural networks.",
    "theoryssms-23": "J. Mach. Learn. Res., 23:42\u20131, 2022b. Lu et al. (2023) Lu, C., Schroecker, Y., Gu, A., Parisotto, E., Foerster, J., Singh, S., and Behbahani, F. Structured state space models for in-context reinforcement learning. Advances in Neural Information Processing Systems, 2023. Lukoveviius & Jaeger (2009) Lukoveviius, M. and Jaeger, H. Reservoir computing approaches to recurrent neural network training.",
    "theoryssms-24": "Comput. Sci. Rev., 3:127\u2013149, 2009. URL https://api.semanticscholar.org/CorpusID:554006. Lyons & McLeod (2024) Lyons, T. and McLeod, A. D. Signature methods in machine learning, 2024. Lyons et al. (2007) Lyons, T. J., Caruana, M., and L\u00e9vy, T. Differential equations driven by rough paths. Springer, 2007.",
    "theoryssms-25": "Martin & Cundy (2017) Martin, E. and Cundy, C. Parallelizing linear recurrent neural nets over sequence length. arXiv preprint arXiv:1709.04057, 2017. Morrill et al. (2021) Morrill, J., Salvi, C., Kidger, P., and Foster, J. Neural rough differential equations for long time series. In International Conference on Machine Learning, pp. 7829\u20137838. PMLR, 2021. Nguyen et al. (2022) Nguyen, E., Goel, K., Gu, A., Downs, G. W., Shah, P., Dao, T., Baccus, S. A., and R\u00e9, C. S4nd: Modeling images and videos as multidimensional signals using state spaces. Advances in Neural Information Processing Systems, 2022. Orvieto et al. (2023a) Orvieto, A., De, S., Gulcehre, C., Pascanu, R., and Smith, S. L. On the universality of linear recurrences followed by nonlinear projections. arXiv preprint arXiv:2307.11888, 2023a. Orvieto et al. (2023b) Orvieto, A., Smith, S. L., Gu, A., Fernando, A., Gulcehre, C., Pascanu, R., and De, S. Resurrecting recurrent neural networks for long sequences. arXiv preprint arXiv:2303.06349, 2023b. Peng et al. (2023) Peng, B., Alcaide, E., Anthony, Q., Albalak, A., Arcadinho, S., Cao, H., Cheng, X., Chung, M., Grella, M., GV, K. K., et al. Rwkv: Reinventing rnns for the transformer era. arXiv preprint arXiv:2305.13048, 2023. Salvi et al. (2021a) Salvi, C., Cass, T., Foster, J., Lyons, T., and Yang, W. The signature kernel is the solution of a goursat pde.",
    "theoryssms-26": "SIAM Journal on Mathematics of Data Science, 3(3):873\u2013899, 2021a. doi: 10.1137/20M1366794. URL https://doi.org/10.1137/20M1366794. Salvi et al. (2021b) Salvi, C., Lemercier, M., Cass, T., Bonilla, E. V., Damoulas, T., and Lyons, T. J. Siggpde: Scaling sparse gaussian processes on sequential data. In International Conference on Machine Learning, pp. 6233\u20136242. PMLR, 2021b. Salvi et al. (2021c) Salvi, C., Lemercier, M., Liu, C., Horvath, B., Damoulas, T., and Lyons, T. Higher order kernel mean embeddings to capture filtrations of stochastic processes. Advances in Neural Information Processing Systems, 34:16635\u201316647, 2021c. Salvi et al. (2022) Salvi, C., Lemercier, M., and Gerasimovics, A. Neural stochastic pdes: Resolution-invariant learning of continuous spatiotemporal dynamics. Advances in Neural Information Processing Systems, 35:1333\u20131344, 2022. Siegelmann & Sontag (1992) Siegelmann, H.",
    "theoryssms-27": "T.",
    "theoryssms-28": "and Sontag, E. D. On the computational power of neural nets. In Proceedings of the fifth annual workshop on Computational learning theory, pp. 440\u2013449, 1992. Smith et al. (2023) Smith, J. T. H., Warrington, A., and Linderman, S. W. Simplified state space layers for sequence modeling, 2023. Sun et al. (2023) Sun, Y., Dong, L., Huang, S., Ma, S., Xia, Y., Xue, J., Wang, J., and Wei, F. Retentive network: A successor to transformer for large language models, 2023.",
    "theoryssms-29": "Tallec & Ollivier (2018) Tallec, C. and Ollivier, Y. Can recurrent neural networks warp time?, 2018. Tay et al. (2020) Tay, Y., Dehghani, M., Abnar, S., Shen, Y., Bahri, D., Pham, P., Rao, J., Yang, L., Ruder, S., and Metzler, D. Long range arena: A benchmark for efficient transformers. In International Conference on Learning Representations, 2020. Vaswani et al. (2017) Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, \u0141., and Polosukhin, I. Attention is all you need. Advances in Neural Information Processing Systems, 2017. Walker et al. (2024) Walker, B., McLeod, A. D., Qin, T., Cheng, Y., Li, H., and Lyons, T. Log neural controlled differential equations: The lie brackets make a difference, 2024. Wang et al. (2022) Wang, J., Yan, J. N., Gu, A., and Rush, A. M. Pretraining without attention. arXiv preprint arXiv:2212.10544, 2022. Wang & Xue (2023) Wang, S. and Xue, B. State-space models with layer-wise nonlinearity are universal approximators with exponential decaying memory. arXiv preprint arXiv:2309.13414, 2023. Yang et al. (2023) Yang, S., Wang, B., Shen, Y., Panda, R., and Kim, Y. Gated linear attention transformers with hardware-efficient training.",
    "theoryssms-30": "arXiv preprint arXiv:2312.06635, 2023. Zucchet et al. (2023) Zucchet, N., Meier, R., Schug, S., Mujika, A., and Sacramento, J. Online learning of long-range dependencies, 2023. Appendix A Introduction to Signatures\n\nThis initial section of the Appendix is devoted to a brief introduction to the topic of Signature Transform. For more in-depth surveys we suggest the reader to refer to (Fermanian, 2020; Chevyrev & Kormilitzin, 2016; Lyons & McLeod, 2024). A.1 Intuition - Controlled Differential Equations\n\nIn the simplest setting of smooth paths a CDE is a differential equation of form\n\nd \u200b Z t d \u200b t = F \u200b ( d \u200b X t d \u200b t , Z t ) , Z 0 \u2208 \u211d n formulae-sequence \ud835\udc51 subscript \ud835\udc4d \ud835\udc61 \ud835\udc51 \ud835\udc61 \ud835\udc39 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 \ud835\udc51 \ud835\udc61 subscript \ud835\udc4d \ud835\udc61 subscript \ud835\udc4d 0 superscript \u211d \ud835\udc5b \\frac{dZ_{t}}{dt}=F\\Big{(}\\frac{dX_{t}}{dt},Z_{t}\\Big{)},\\hskip 10.0ptZ_{0}\\in\\mathbb{R}^{n}\n\nwhere is a known smooth path to which we refer as control, the known initial condition and the unknown solution. The natural generalization is the following: assume to have two spaces and , , , and . We say that satisfy the CDE\n\nd \u200b Z t = F \u200b ( Z t ) \u200b d \u200b X t , Z 0 \u2208 \u211d d z formulae-sequence \ud835\udc51 subscript \ud835\udc4d \ud835\udc61 \ud835\udc39 subscript \ud835\udc4d \ud835\udc61 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4d 0 superscript \u211d subscript \ud835\udc51 \ud835\udc67 dZ_{t}=F(Z_{t})dX_{t},\\quad Z_{0}\\in\\mathbb{R}^{d_{z}}\n\nwhenever\n\nZ t = Z 0 + \u222b 0 t F \u200b ( Z s ) \u200b \ud835\udc51 X s subscript \ud835\udc4d \ud835\udc61 subscript \ud835\udc4d 0 superscript subscript 0 \ud835\udc61 \ud835\udc39 subscript \ud835\udc4d \ud835\udc60 differential-d subscript \ud835\udc4b \ud835\udc60 Z_{t}=Z_{0}+\\int_{0}^{t}F(Z_{s})dX_{s}\n\nThe theory of Rough Paths has its origins in the study of such types of differential equations and provides a theoretical framework to define and work in rough settings i.e. when is not kust BV but even -H\u00f6lder for cf. (Friz & Victoir, 2010). Assume thus to have the CDE\n\nd \u200b Z t = \u2211 i = 1 d x V i \u200b ( Z t ) \u200b d \u200b X t i , Z 0 \u2208 \u211d d z formulae-sequence \ud835\udc51 subscript \ud835\udc4d \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udc65 subscript \ud835\udc49 \ud835\udc56 subscript \ud835\udc4d \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc61 subscript \ud835\udc4d 0 superscript \u211d subscript \ud835\udc51 \ud835\udc67 dZ_{t}=\\sum_{i=1}^{d_{x}}V_{i}(Z_{t})dX^{i}_{t},\\quad Z_{0}\\in\\mathbb{R}^{d_{z}}\n\nfor sufficiently regular vector fields and . Given a smooth , by the change of variable formula (i.e. fundamental theorem of calculus) we have\n\nf \u200b ( Z t ) = f \u200b ( Z 0 ) + \u2211 i = 1 d x \u222b 0 t V i \u200b f \u200b ( Z s ) \u200b \ud835\udc51 X s i \ud835\udc53 subscript \ud835\udc4d \ud835\udc61 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udc65 superscript subscript 0 \ud835\udc61 subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d \ud835\udc60 differential-d subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc60 f(Z_{t})=f(Z_{0})+\\sum_{i=1}^{d_{x}}\\int_{0}^{t}V_{i}f(Z_{s})dX^{i}_{s}\n\nwhere . Iterating this procedure on the s, i.e. substituting in the previous equation the analogously obtained equality\n\nV i \u200b f \u200b ( Z s ) = V i \u200b f \u200b ( Z 0 ) + \u2211 j = 1 d x \u222b 0 s V j \u200b ( V i \u200b f ) \u200b ( Z u ) \u200b \ud835\udc51 X u j , subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d \ud835\udc60 subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udc65 superscript subscript 0 \ud835\udc60 subscript \ud835\udc49 \ud835\udc57 subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d \ud835\udc62 differential-d subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc62 V_{i}f(Z_{s})=V_{i}f(Z_{0})+\\sum_{j=1}^{d_{x}}\\int_{0}^{s}V_{j}(V_{i}f)(Z_{u})dX^{j}_{u},\n\nwe get\n\nf \u200b ( Z t ) = f \u200b ( Z 0 ) + \u2211 i = 1 d V i \u200b f \u200b ( Z 0 ) \u200b \u222b 0 t \ud835\udc51 X s i + \u2211 i , j = 1 d \u222b 0 t \u222b 0 s V j \u200b V i \u200b f \u200b ( Z u ) \u200b \ud835\udc51 X u j \u200b \ud835\udc51 X s i \ud835\udc53 subscript \ud835\udc4d \ud835\udc61 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript \ud835\udc56 1 \ud835\udc51 subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript 0 \ud835\udc61 differential-d subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc60 superscript subscript \ud835\udc56 \ud835\udc57 1 \ud835\udc51 superscript subscript 0 \ud835\udc61 superscript subscript 0 \ud835\udc60 subscript \ud835\udc49 \ud835\udc57 subscript \ud835\udc49 \ud835\udc56 \ud835\udc53 subscript \ud835\udc4d \ud835\udc62 differential-d superscript subscript \ud835\udc4b \ud835\udc62 \ud835\udc57 differential-d superscript subscript \ud835\udc4b \ud835\udc60 \ud835\udc56 f(Z_{t})=f(Z_{0})+\\sum_{i=1}^{d}V_{i}f(Z_{0})\\int_{0}^{t}dX^{i}_{s}+\\sum_{i,j=1}^{d}\\int_{0}^{t}\\int_{0}^{s}V_{j}V_{i}f(Z_{u})dX_{u}^{j}dX_{s}^{i}\n\nKeeping with this procedure for steps we get\n\nf \u200b ( Z t ) = f \u200b ( Z 0 ) + \u2211 k = 1 N \u2211 | I | = k V I \u200b f \u200b ( Z 0 ) \u200b \u222b\u22ef\u222b s < u 1 < \u22ef < u k < t \ud835\udc51 X u 1 i 1 \u200b \u22ef \u200b \ud835\udc51 X u k i k + R N \u200b ( t ) \ud835\udc53 subscript \ud835\udc4d \ud835\udc61 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript \ud835\udc58 1 \ud835\udc41 subscript \ud835\udc3c \ud835\udc58 subscript \ud835\udc49 \ud835\udc3c \ud835\udc53 subscript \ud835\udc4d 0 subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 \ud835\udc61 differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 1 subscript \ud835\udc62 1 \u22ef differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 \ud835\udc58 subscript \ud835\udc62 \ud835\udc58 subscript \ud835\udc45 \ud835\udc41 \ud835\udc61 f(Z_{t})=f(Z_{0})+\\sum_{k=1}^{N}\\sum_{|I|=k}V_{I}f(Z_{0})\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k}<t}dX^{i_{1}}_{u_{1}}\\cdots dX^{i_{k}}_{u_{k}}+R_{N}(t)\n\nwhere runs trough the multi-indices, and\n\nR N \u200b ( t ) := \u2211 | J | = k + 1 \u222b\u22ef\u222b s < u 1 < \u22ef < u k + 1 < t V J \u200b f \u200b ( Z u 1 ) \u200b \ud835\udc51 X u 1 j 1 \u200b \u22ef \u200b \ud835\udc51 X u k + 1 j k + 1 assign subscript \ud835\udc45 \ud835\udc41 \ud835\udc61 subscript \ud835\udc3d \ud835\udc58 1 subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 1 \ud835\udc61 subscript \ud835\udc49 \ud835\udc3d \ud835\udc53 subscript \ud835\udc4d subscript \ud835\udc62 1 differential-d subscript superscript \ud835\udc4b subscript \ud835\udc57 1 subscript \ud835\udc62 1 \u22ef differential-d subscript superscript \ud835\udc4b subscript \ud835\udc57 \ud835\udc58 1 subscript \ud835\udc62 \ud835\udc58 1 R_{N}(t):=\\sum_{|J|=k+1}\\hskip 5.0pt\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k+1}<t}V_{J}f(Z_{u_{1}})dX^{j_{1}}_{u_{1}}\\cdots dX^{j_{k+1}}_{u_{k+1}}\n\nAs one can imagine, under reasonable regularity assumptions, the remainder goes to as and at the limit\n\nf \u200b ( Z t ) = f \u200b ( Z 0 ) + \u2211 k = 1 \u221e \u2211 | I | = k V I \u200b f \u200b ( Z 0 ) \u200b \u222b\u22ef\u222b s < u 1 < \u22ef < u k < t \ud835\udc51 X u 1 i 1 \u200b \u22ef \u200b \ud835\udc51 X u k i k \ud835\udc53 subscript \ud835\udc4d \ud835\udc61 \ud835\udc53 subscript \ud835\udc4d 0 superscript subscript \ud835\udc58 1 subscript \ud835\udc3c \ud835\udc58 subscript \ud835\udc49 \ud835\udc3c \ud835\udc53 subscript \ud835\udc4d 0 subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 \ud835\udc61 differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 1 subscript \ud835\udc62 1 \u22ef differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 \ud835\udc58 subscript \ud835\udc62 \ud835\udc58 f(Z_{t})=f(Z_{0})+\\sum_{k=1}^{\\infty}\\sum_{|I|=k}V_{I}f(Z_{0})\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k}<t}dX^{i_{1}}_{u_{1}}\\cdots dX^{i_{k}}_{u_{k}}\n\nThis is a remarkable result: to know the solution to the original CDE it suffices to know the quantities for all multi-indices and in the coordinate maps, together with the iterated integrals\n\nSig \u200b ( X ) s , t I := \u222b\u22ef\u222b s < u 1 < \u22ef < u k < t \ud835\udc51 X u 1 i 1 \u200b \u22ef \u200b \ud835\udc51 X u k i k . assign Sig subscript superscript \ud835\udc4b \ud835\udc3c \ud835\udc60 \ud835\udc61 subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 \ud835\udc61 differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 1 subscript \ud835\udc62 1 \u22ef differential-d subscript superscript \ud835\udc4b subscript \ud835\udc56 \ud835\udc58 subscript \ud835\udc62 \ud835\udc58 \\text{Sig}(X)^{I}_{s,t}:=\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k}<t}dX^{i_{1}}_{u_{1}}\\cdots dX^{i_{k}}_{u_{k}}. This observation is at the core of Rough Path Analysis, the theory can in a sense be considered an extreme development of it. The collection of iterated integrals, the Signature, will be the main for our analysis. In Appendix E we expand and make rigorous the arguments of this section in the case of affine vector fields. A.2 Basic Definitions\n\nDenote by the tensor product of copies , set . Let be the tensor algebra equipped with sum and tensor product. Definition A.1. Let be the canonical basis of , then\n\n{ e i 1 \u2297 \u22ef \u2297 e i k : ( i 1 , \u2026 , i k ) \u2208 [ d ] k } conditional-set tensor-product subscript \ud835\udc52 subscript \ud835\udc56 1 \u22ef subscript \ud835\udc52 subscript \ud835\udc56 \ud835\udc58 subscript \ud835\udc56 1 \u2026 subscript \ud835\udc56 \ud835\udc58 superscript delimited-[] \ud835\udc51 \ud835\udc58 \\{e_{i_{1}}\\otimes\\cdots\\otimes e_{i_{k}}:(i_{1},\\dots,i_{k})\\in[d]^{k}\\}\n\nis a basis of . We equip with the inner product defined on basis elements as\n\n\u27e8 e i 1 \u2297 \u22ef \u2297 e i k , e j 1 \u2297 \u22ef \u2297 e j k \u27e9 ( \u211d d ) \u2297 k = \u03b4 ( i 1 , \u2026 , i k ) ( j 1 , \u2026 , j k ) subscript tensor-product subscript \ud835\udc52 subscript \ud835\udc56 1 \u22ef subscript \ud835\udc52 subscript \ud835\udc56 \ud835\udc58 tensor-product subscript \ud835\udc52 subscript \ud835\udc57 1 \u22ef subscript \ud835\udc52 subscript \ud835\udc57 \ud835\udc58 superscript superscript \u211d \ud835\udc51 tensor-product absent \ud835\udc58 superscript subscript \ud835\udeff subscript \ud835\udc56 1 \u2026 subscript \ud835\udc56 \ud835\udc58 subscript \ud835\udc57 1 \u2026 subscript \ud835\udc57 \ud835\udc58 \\langle e_{i_{1}}\\otimes\\cdots\\otimes e_{i_{k}},e_{j_{1}}\\otimes\\cdots\\otimes e_{j_{k}}\\rangle_{(\\mathbb{R}^{d})^{\\otimes k}}=\\delta_{(i_{1},\\dots,i_{k})}^{(j_{1},\\dots,j_{k})}\n\nWe extend this product to by\n\n\u27e8 A , B \u27e9 T \u200b ( \u211d d ) := \u2211 k = 0 \u221e \u27e8 a k , b k \u27e9 ( \u211d d ) \u2297 k assign subscript \ud835\udc34 \ud835\udc35 \ud835\udc47 superscript \u211d \ud835\udc51 superscript subscript \ud835\udc58 0 subscript subscript \ud835\udc4e \ud835\udc58 subscript \ud835\udc4f \ud835\udc58 superscript superscript \u211d \ud835\udc51 tensor-product absent \ud835\udc58 \\langle A,B\\rangle_{T(\\mathbb{R}^{d})}:=\\sum_{k=0}^{\\infty}\\langle a_{k},b_{k}\\rangle_{(\\mathbb{R}^{d})^{\\otimes k}}\n\nwhere and\n\nNote how for any we have , we refer to this as to the coproduct property. Definition A.2 (Infinite Tensor Algebra). The infinite tensor algebra is defined as the space equipped with the operations and which act in the natural algebraic way; its elements are called tensor series. It is easily seen that is an algebra with unit and we can endow it with a natural product which inherits the coproduct property. Another point of view could be taken on the definitions of these spaces, one that we will prefer later on. If we define to be the set of words in letters then , is the subset of such functions with finite support and\n\n\u27e8 A , B \u27e9 T \u200b ( \u211d d ) = \u2211 I \u2208 \ud835\udd4e d A I \u200b B I = \u2211 k = 0 \u221e \u2211 | I | = k A I \u200b B I subscript \ud835\udc34 \ud835\udc35 \ud835\udc47 superscript \u211d \ud835\udc51 subscript \ud835\udc3c subscript \ud835\udd4e \ud835\udc51 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc3c superscript subscript \ud835\udc58 0 subscript \ud835\udc3c \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc3c \\langle A,B\\rangle_{T(\\mathbb{R}^{d})}=\\sum_{I\\in\\mathbb{W}_{d}}A_{I}B_{I}=\\sum_{k=0}^{\\infty}\\sum_{|I|=k}A_{I}B_{I}\n\nwhere is the length of the word . The empty word, the only one with length , is denoted by and corresponds to the basis element of . In this view the tensor product coincides with concatenation of words accordingly distributed and the closure of with respect to its product is just the space . Definition A.3 (Signature). Given and s.t. , the signature of the path over is defined as\n\nSig \u200b ( \u03b3 ) s , t := ( 1 , \u222b s < u 1 < t \ud835\udc51 \u03b3 u 1 , \u22ef , \u222b\u22ef\u222b s < u 1 < \u22ef < u k < t \ud835\udc51 \u03b3 u 1 \u2297 \u22ef \u2297 \ud835\udc51 \u03b3 u k , \u22ef ) assign Sig subscript \ud835\udefe \ud835\udc60 \ud835\udc61 1 subscript \ud835\udc60 subscript \ud835\udc62 1 \ud835\udc61 differential-d subscript \ud835\udefe subscript \ud835\udc62 1 \u22ef subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 \ud835\udc61 tensor-product differential-d subscript \ud835\udefe subscript \ud835\udc62 1 \u22ef differential-d subscript \ud835\udefe subscript \ud835\udc62 \ud835\udc58 \u22ef \\text{Sig}(\\gamma)_{s,t}:=(1,\\int\\limits_{s<u_{1}<t}d\\gamma_{u_{1}},\\hskip 3.0pt\\cdots,\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k}<t}d\\gamma_{u_{1}}\\otimes\\cdots\\otimes d\\gamma_{u_{k}},\\cdots) (17)\n\nEquivalently is that element of defined recursively on words as\n\nSig \u200b ( \u03b3 ) s , t ( ) = 1 , Sig \u200b ( \u03b3 ) s , t I \u200b j = \u222b s t Sig \u200b ( \u03b3 ) s , r I \u200b \ud835\udc51 \u03b3 r j . formulae-sequence Sig superscript subscript \ud835\udefe \ud835\udc60 \ud835\udc61 1 Sig subscript superscript \ud835\udefe \ud835\udc3c \ud835\udc57 \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc60 \ud835\udc61 Sig subscript superscript \ud835\udefe \ud835\udc3c \ud835\udc60 \ud835\udc5f differential-d subscript superscript \ud835\udefe \ud835\udc57 \ud835\udc5f \\text{Sig}(\\gamma)_{s,t}^{()}=1,\\quad\\text{Sig}(\\gamma)^{Ij}_{s,t}=\\int_{s}^{t}\\text{Sig}(\\gamma)^{I}_{s,r}d\\gamma^{j}_{r}. (18)\n\nA.3 Notable Results\n\nHere we present some notable results of which we will make use through the paper. We omit the proofs if they can be easily found in the suggested references. The first result is about bounding the norm of Signature entries:\n\nProposition A.4 (Factorial Decay Rate). Given , for all and s.t. one has\n\n\u2225 \u222b\u22ef\u222b s < u 1 < \u22ef < u k < t \ud835\udc51 \u03b3 u 1 \u2297 \u22ef \u2297 \ud835\udc51 \u03b3 u k \u2225 ( \u211d d ) \u2297 k \u2264 \u2225 \u03b3 \u2225 1 \u2212 v \u200b a \u200b r , [ s , t ] k k ! subscript delimited-\u2225\u2225 subscript multiple-integral \ud835\udc60 subscript \ud835\udc62 1 \u22ef subscript \ud835\udc62 \ud835\udc58 \ud835\udc61 tensor-product differential-d subscript \ud835\udefe subscript \ud835\udc62 1 \u22ef differential-d subscript \ud835\udefe subscript \ud835\udc62 \ud835\udc58 superscript superscript \u211d \ud835\udc51 tensor-product absent \ud835\udc58 superscript subscript delimited-\u2225\u2225 \ud835\udefe 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f \ud835\udc60 \ud835\udc61 \ud835\udc58 \ud835\udc58 \\left\\lVert\\hskip 5.0pt\\idotsint\\limits_{s<u_{1}<\\cdots<u_{k}<t}d\\gamma_{u_{1}}\\otimes\\cdots\\otimes d\\gamma_{u_{k}}~{}\\right\\rVert_{(\\mathbb{R}^{d})^{\\otimes k}}\\leq\\frac{\\left\\lVert\\gamma\\right\\rVert_{1-var,[s,t]}^{k}}{k!} (19)\n\nThe most important fact about Signature is that it acts as the basis for a Taylor expansion in path space. In fact just as finite linear combinations of monomials are dense in the continuous functions with a compact input set, finite linear combinations of Signature entries are dense in continuous functions from compact path-spaces:\n\nTheorem A.5 (Universal Approximation (Fermanian, 2020)). Fix compact such that for any it holds . For any and there is an integer such that\n\nsup \u03b3 \u2208 K | F \u200b ( \u03b3 ) \u2212 \u2211 | I | \u2264 N \u03b1 I \u200b Sig \u200b ( \u03b3 ) 0 , 1 I | \u2264 \u03f5 subscript supremum \ud835\udefe \ud835\udc3e \ud835\udc39 \ud835\udefe subscript \ud835\udc3c \ud835\udc41 subscript \ud835\udefc \ud835\udc3c Sig subscript superscript \ud835\udefe \ud835\udc3c 0 1 italic-\u03f5 \\sup\\limits_{\\gamma\\in K}|F(\\gamma)-\\sum_{|I|\\leq N}\\alpha_{I}\\text{Sig}(\\gamma)^{I}_{0,1}|\\leq\\epsilon (20)\n\nfor some finite sequence of real numbers. Remark A.6. There is no magic in this result, it is just an application of Stone-Weiestrass enabled by the rich algebraic structure of iterated integrals, studied originally in (Chen, 1958). We will need to restrict some paths to sub-intervals of in such a way to still be able to consider them meaningfully as elements of , this is done in the following way:\n\nDefinition A.7. Given any path we define its restriction on a sub-interval as the path with values\n\n\u03b3 [ s , t ] \u200b ( r ) := { 0 if \u200b r < s \u03b3 r \u2212 \u03b3 s if \u200b s \u2264 r \u2264 t \u03b3 t \u2212 \u03b3 s if \u200b r > t assign subscript \ud835\udefe \ud835\udc60 \ud835\udc61 \ud835\udc5f cases 0 if \ud835\udc5f \ud835\udc60 subscript \ud835\udefe \ud835\udc5f subscript \ud835\udefe \ud835\udc60 if \ud835\udc60 \ud835\udc5f \ud835\udc61 subscript \ud835\udefe \ud835\udc61 subscript \ud835\udefe \ud835\udc60 if \ud835\udc5f \ud835\udc61 \\gamma_{[s,t]}(r):=\\begin{cases}0&\\text{ if }r<s\\\\\n\\gamma_{r}-\\gamma_{s}&\\text{ if }s\\leq r\\leq t\\\\\n\\gamma_{t}-\\gamma_{s}&\\text{ if }r>t\\end{cases} (21)\n\nThis definition is such that the following important equation holds\n\nSig \u200b ( \u03b3 ) s , t = Sig \u200b ( \u03b3 [ s , t ] ) 0 , 1 Sig subscript \ud835\udefe \ud835\udc60 \ud835\udc61 Sig subscript subscript \ud835\udefe \ud835\udc60 \ud835\udc61 0 1 \\text{Sig}(\\gamma)_{s,t}=\\text{Sig}(\\gamma_{[s,t]})_{0,1} (22)\n\nWith the right augmentation of the paths one can see that the Signature distinguishes between different sections of paths, this will be crucial for some of the original results presented in this work. Lemma A.8. Assume with and . Then\n\nSig \u200b ( \u03c9 ) s , t = Sig \u200b ( \u03b3 ) s \u2032 , t \u2032 \u21d4 \u03c9 [ s , t ] = \u03b3 [ s \u2032 , t \u2032 ] iff Sig subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 Sig subscript \ud835\udefe superscript \ud835\udc60 \u2032 superscript \ud835\udc61 \u2032 subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 subscript \ud835\udefe superscript \ud835\udc60 \u2032 superscript \ud835\udc61 \u2032 \\text{Sig}(\\omega)_{s,t}=\\text{Sig}(\\gamma)_{s^{\\prime},t^{\\prime}}\\iff\\omega_{[s,t]}=\\gamma_{[s^{\\prime},t^{\\prime}]} (23)\n\nProof. The if part is follows from . For the only if part, If and the statement holds; this is because if the signatures over the time interval of two time-augmented paths are equal, then the two paths must be equal on . We now show that augmenting the path with and imposing equality of signatures, implies and , which will in turn allow us to conclude the proof by the previous remark. Assume , in particular we must have\n\n\u222b s t d \u200b ( r 2 ) = t 2 \u2212 s 2 = ( t \u2032 ) 2 \u2212 ( s \u2032 ) 2 = \u222b s \u2032 t \u2032 d \u200b ( r 2 ) superscript subscript \ud835\udc60 \ud835\udc61 \ud835\udc51 superscript \ud835\udc5f 2 superscript \ud835\udc61 2 superscript \ud835\udc60 2 superscript superscript \ud835\udc61 \u2032 2 superscript superscript \ud835\udc60 \u2032 2 superscript subscript superscript \ud835\udc60 \u2032 superscript \ud835\udc61 \u2032 \ud835\udc51 superscript \ud835\udc5f 2 \\displaystyle\\int_{s}^{t}d(r^{2})=t^{2}-s^{2}=(t^{\\prime})^{2}-(s^{\\prime})^{2}=\\int_{s^{\\prime}}^{t^{\\prime}}d(r^{2}) (24) \u222b s t d \u200b ( r ) = t \u2212 s = t \u2032 \u2212 s \u2032 = \u222b s \u2032 t \u2032 d \u200b ( r ) superscript subscript \ud835\udc60 \ud835\udc61 \ud835\udc51 \ud835\udc5f \ud835\udc61 \ud835\udc60 superscript \ud835\udc61 \u2032 superscript \ud835\udc60 \u2032 superscript subscript superscript \ud835\udc60 \u2032 superscript \ud835\udc61 \u2032 \ud835\udc51 \ud835\udc5f \\displaystyle\\int_{s}^{t}d(r)=t-s=t^{\\prime}-s^{\\prime}=\\int_{s^{\\prime}}^{t^{\\prime}}d(r) (25)\n\nwhich reduces to the system\n\n{ t 2 \u2212 s 2 = ( t \u2032 ) 2 \u2212 ( s \u2032 ) 2 t \u2212 s = t \u2032 \u2212 s \u2032 \u200b { t + s = t \u2032 + s \u2032 t \u2212 s = t \u2032 \u2212 s \u2032 \u200b { 2 \u200b t = 2 \u200b t \u2032 2 \u200b s = 2 \u200b s \u2032 cases superscript \ud835\udc61 2 superscript \ud835\udc60 2 superscript superscript \ud835\udc61 \u2032 2 superscript superscript \ud835\udc60 \u2032 2 otherwise \ud835\udc61 \ud835\udc60 superscript \ud835\udc61 \u2032 superscript \ud835\udc60 \u2032 otherwise cases \ud835\udc61 \ud835\udc60 superscript \ud835\udc61 \u2032 superscript \ud835\udc60 \u2032 otherwise \ud835\udc61 \ud835\udc60 superscript \ud835\udc61 \u2032 superscript \ud835\udc60 \u2032 otherwise cases 2 \ud835\udc61 2 superscript \ud835\udc61 \u2032 otherwise 2 \ud835\udc60 2 superscript \ud835\udc60 \u2032 otherwise \\begin{cases}t^{2}-s^{2}=(t^{\\prime})^{2}-(s^{\\prime})^{2}\\\\\nt-s=t^{\\prime}-s^{\\prime}\\end{cases}\\begin{cases}t+s=t^{\\prime}+s^{\\prime}\\\\\nt-s=t^{\\prime}-s^{\\prime}\\end{cases}\\begin{cases}2t=2t^{\\prime}\\\\\n2s=2s^{\\prime}\\end{cases}\n\nHence it must be true that and . \u220e\n\nAppendix B Expressivity\n\nB.1 Model Recap\n\nIn the body of the paper we have presented the main results with the simplified assumption of or at best i.e. with an initial value independent from the input. In this appendix we will carry on the proofs in a more general setting in which is allowed to be input-dependent, as previously discussed the choice of initial value is, in contrast to the classical setting, meaningful inasmuch it allows to approximate linear maps on the signature of . In order to do so we have to introduce a new gate, the initial value gate, in the form of a map\n\n( \u22c5 ) 0 subscript \u22c5 0 \\displaystyle(\\cdot)_{0} : \ud835\udd4f \u2192 \u211d d 0 : absent \u2192 \ud835\udd4f superscript \u211d subscript \ud835\udc51 0 \\displaystyle:\\mathbb{X}\\to\\mathbb{R}^{d_{0}} (26) X \u21a6 X 0 maps-to \ud835\udc4b subscript \ud835\udc4b 0 \\displaystyle X\\mapsto X_{0}\n\nDespite the notation, there is no reason why should be the initial value of the path , one should think of this map as the one summarizing the data which still matters for the task but which does not have a time-series nature. To recapitulate, the general setting of our models is the following: a topological input space space ,\n\n( \u22c5 ) 0 : \ud835\udd4f \u2192 \u211d d 0 , : subscript \u22c5 0 \u2192 \ud835\udd4f superscript \u211d subscript \ud835\udc51 0 \\displaystyle(\\cdot)_{0}:\\mathbb{X}\\to\\mathbb{R}^{d_{0}}, ( ( \u22c5 ) 0 subscript \u22c5 0 (\\cdot)_{0} -gate) \u03c9 : \ud835\udd4f \u2192 C 1 , 0 \u200b ( [ 0 , 1 ] ; \u211d d \u03c9 ) , : \ud835\udf14 \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf14 \\displaystyle\\omega:\\mathbb{X}\\to C_{1,0}([0,1];\\mathbb{R}^{d_{\\omega}}), ( \u03c9 \ud835\udf14 \\omega -gate) \u03be : \ud835\udd4f \u2192 C 1 , 0 \u200b ( [ 0 , 1 ] ; \u211d d \u03be ) . : \ud835\udf09 \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf09 \\displaystyle\\xi:\\mathbb{X}\\to C_{1,0}([0,1];\\mathbb{R}^{d_{\\xi}}). ( \u03be \ud835\udf09 \\xi -gate)\n\nwhere all the gates are continuous functions on . The space does not have to be a space of paths, a topological structure suffices, as long as the gates are well defined and continuous. Remark B.1. Typical examples for the choice of gates are space of paths and\n\n( X ) 0 = 0 \u03c9 t X = t \u03be t X = \u222b 0 t X s \u200b \ud835\udc51 s formulae-sequence subscript \ud835\udc4b 0 0 formulae-sequence subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc61 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\displaystyle(X)_{0}=0\\quad\\omega^{\\text{X}}_{t}=t\\quad\\xi^{\\text{X}}_{t}=\\int_{0}^{t}X_{s}ds (S4) ( X ) 0 = 0 \u03c9 t X = \u222b 0 t s \u200b o \u200b f \u200b t \u200b p \u200b l \u200b u \u200b s \u200b ( \u03b1 \u200b X s + \u03b2 ) \u200b \ud835\udc51 s \u03be t X = \u222b 0 t s \u200b o \u200b f \u200b t \u200b p \u200b l \u200b u \u200b s \u200b ( \u03b1 \u200b X s + \u03b2 ) \u200b X s \u200b \ud835\udc51 s formulae-sequence subscript \ud835\udc4b 0 0 formulae-sequence subscript superscript \ud835\udf14 X \ud835\udc61 superscript subscript 0 \ud835\udc61 \ud835\udc60 \ud835\udc5c \ud835\udc53 \ud835\udc61 \ud835\udc5d \ud835\udc59 \ud835\udc62 \ud835\udc60 \ud835\udefc subscript \ud835\udc4b \ud835\udc60 \ud835\udefd differential-d \ud835\udc60 subscript superscript \ud835\udf09 X \ud835\udc61 superscript subscript 0 \ud835\udc61 \ud835\udc60 \ud835\udc5c \ud835\udc53 \ud835\udc61 \ud835\udc5d \ud835\udc59 \ud835\udc62 \ud835\udc60 \ud835\udefc subscript \ud835\udc4b \ud835\udc60 \ud835\udefd subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\displaystyle(X)_{0}=0\\quad\\omega^{\\text{X}}_{t}=\\int_{0}^{t}softplus(\\alpha X_{s}+\\beta)ds\\quad\\xi^{\\text{X}}_{t}=\\int_{0}^{t}softplus(\\alpha X_{s}+\\beta)X_{s}ds (Mamba)\n\nThen the main object of study, \u201dgated\u201d Linear CDEs, are defined as:\n\nDefinition B.2. Fix gates as above, , matrices (), , . The corresponding Linear CDE is the functional\n\nZ : \ud835\udd4f \u2192 C 1 \u200b ( [ 0 , 1 ] ; \u211d N ) : \ud835\udc4d \u2192 \ud835\udd4f subscript \ud835\udc36 1 0 1 superscript \u211d \ud835\udc41 \\displaystyle Z:\\mathbb{X}\\to C_{1}([0,1];\\mathbb{R}^{N}) (27) Z t X = \u2211 i = 1 d \u03c9 A i \u200b Z t X \u200b d \u200b \u03c9 t X , i + B \u200b d \u200b \u03be t X subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 \\displaystyle Z^{\\text{X}}_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+Bd\\xi^{\\text{X}}_{t} (28) Z 0 X = C \u200b X 0 subscript superscript \ud835\udc4d X 0 \ud835\udc36 subscript \ud835\udc4b 0 \\displaystyle Z^{\\text{X}}_{0}=CX_{0} (29)\n\nB.2 Main Result - Statement and Strategy\n\nHere we present the unified expressivity result in its most general form:\n\nTheorem B.3. For any compact set and continuous gates with and . For any and any\n\nF \u2208 { ( X , t ) \u21a6 \u03a8 \u200b ( \u03c9 [ 0 , t ] X ) \u22c5 X 0 + \u222b 0 t \u03a6 \u200b ( \u03c9 [ s , t ] X ) \u22c5 \ud835\udc51 \u03be s X } \ud835\udc39 maps-to \ud835\udc4b \ud835\udc61 \u22c5 \u03a8 subscript superscript \ud835\udf14 X 0 \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 \u03a6 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 F\\in\\left\\{(X,t)\\mapsto\\Psi(\\omega^{\\text{X}}_{[0,t]})\\cdot X_{0}+\\int_{0}^{t}\\Phi(\\omega^{\\text{X}}_{[s,t]})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (30)\n\nwhere and , there exist a choice of hidden dimension and parameters such that\n\nsup ( X , t ) \u2208 \ud835\udd42 \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u27e8 v , Z t X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd42 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{K}\\times[0,1]}|F(X,t)-\\langle v,Z^{\\text{X}}_{t}\\rangle|\\leq\\epsilon (31)\n\nMoreover generic parameters suffice with high probability in the sense that under LeCun initialization\n\n[ A i ] n , j \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 N ) C n , j , B n , j \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 ) subscript delimited-[] subscript \ud835\udc34 \ud835\udc56 \ud835\udc5b \ud835\udc57 iid similar-to \ud835\udca9 0 1 \ud835\udc41 subscript \ud835\udc36 \ud835\udc5b \ud835\udc57 subscript \ud835\udc35 \ud835\udc5b \ud835\udc57 iid similar-to \ud835\udca9 0 1 [A_{i}]_{n,j}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,\\frac{1}{N})\\quad C_{n,j},B_{n,j}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,1)\n\nthe following holds:\n\nlim N \u2192 \u221e \u2119 [ \u2203 v \u2208 \u211d N : ( 31 ) holds ] = 1 \\lim\\limits_{N\\to\\infty}\\mathbb{P}\\big{[}\\exists v\\in\\mathbb{R}^{N}:\\text{ (\\ref{app:eqn:dense_RKHS_main}) holds}\\big{]}=1\n\nIf the s are constrained to be diagonal, as often is the case in practice, the requirements , can be dropped and the existence result only holds with\n\nF \u2208 { ( X , t ) \u21a6 \u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X } \ud835\udc39 maps-to \ud835\udc4b \ud835\udc61 \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 F\\in\\left\\{(X,t)\\mapsto\\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (32)\n\nfor and . Moreover in both the dense and diagonal cases the \u201dreverse\u201d also holds in the sense that, given any choice of matrices there is an -close map in the corresponding family.",
    "theoryssms-31": "As one can see the theorem is composed of different sub-results, which we believe are better understood separately from each other. The proof will thus be split in the following steps:\n\n1. Using the theory developed in Appendix E we see how linear functions on the s can be seen as linear functions on certain terms of the Signature Transform. 2. Such terms define a feature map which generates a Reproducing Kernel Hilbert Space . This abstract space acts as an upper bound on expressivity: linear functions on always belong to its closure (in uniform norm), independently of dimension and weights chosen, hence they cannot reach what functions in can\u2019t approximate.",
    "theoryssms-32": "3. The full expressive range of is shown to be captured by generic s. 4. Diagonal systems are shown to be restricted to a subset of the of which they capture the full expressive range. B.3 Main Result - Proofs\n\nB.3.1 An expansion for\n\nProposition B.4. For any choice of and , the unique solution to\n\nd \u200b Z t X = \u2211 i = 1 d \u03c9 A i \u200b Z t X \u200b d \u200b \u03c9 t X , i + B \u200b d \u200b \u03be t X \ud835\udc51 subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 \\displaystyle dZ^{\\text{X}}_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+Bd\\xi^{\\text{X}}_{t} (33) Z 0 X = C \u200b X 0 \u2208 \u211d N subscript superscript \ud835\udc4d X 0 \ud835\udc36 subscript \ud835\udc4b 0 superscript \u211d \ud835\udc41 \\displaystyle Z^{\\text{X}}_{0}=CX_{0}\\in\\mathbb{R}^{N}\n\nis given, using the notation , by\n\nZ t X = subscript superscript \ud835\udc4d X \ud835\udc61 absent \\displaystyle Z^{\\text{X}}_{t}= \u2211 i = 1 d 0 \u2211 I \u2208 \ud835\udd4e d \u03c9 A I \u200b C i \u200b X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t I + \u2211 j = 1 d \u03be \u2211 I \u2208 \ud835\udd4e d \u03c9 A I \u200b B j \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t I \u200b \ud835\udc51 \u03be s X , j \u2208 \u211d N superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc3c superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript \u211d \ud835\udc41 \\displaystyle\\sum_{i=1}^{d_{0}}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}C_{i}\\hskip 3.0ptX_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{I}+\\sum_{j=1}^{d_{\\xi}}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}B_{j}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}d\\xi^{\\text{X},j}_{s}\\in\\mathbb{R}^{N} (34)\n\nNotice here and .",
    "theoryssms-33": "Proof. Just apply Theorems (E.2) and (E.6) of Appendix E. \u220e\n\nRemark B.5. A property highlighted by the previous result is the interpretability of these models. After training the NCDEs one can compute the matrix multiplications and observe which entries of the signature the model chooses to take into consideration, to attend. B.3.2 The feature map and its RKHS\n\nThe expression in (34) is a linear map on a feature vector given, at time , by\n\nT ( X ) 0 , t := ( X 0 i Sig ( \u03c9 X ) 0 , t I , \u222b 0 t Sig ( \u03c9 X ) s , t I d \u03be s X , j : i \u2208 [ d 0 ] , I \u2208 \ud835\udd4e d \u03c9 , j \u2208 [ d \u03be ] ) T(X)_{0,t}:=\\left(X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{I},\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}d\\xi^{\\text{X},j}_{s}:i\\in[d_{0}],I\\in\\mathbb{W}_{d_{\\omega}},j\\in[d_{\\xi}]\\right) (35)\n\nThis feature vector can be understood as a tensor in the following way:\n\nDefinition B.6. Let be the set of words in the alphabet\n\n\ud835\udc9c d 0 , d \u03c9 , d \u03be := { \ud835\udc86 i } i = 1 , \u2026 , d 0 \u222a { \u03f5 j \u03be } j = 1 , \u2026 , d \u03be \u222a { \u03f5 k \u03c9 } k = 1 , \u2026 , d \u03c9 assign subscript \ud835\udc9c subscript \ud835\udc51 0 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc51 \ud835\udf09 subscript subscript \ud835\udc86 \ud835\udc56 \ud835\udc56 1 \u2026 subscript \ud835\udc51 0 subscript subscript superscript bold-italic-\u03f5 \ud835\udf09 \ud835\udc57 \ud835\udc57 1 \u2026 subscript \ud835\udc51 \ud835\udf09 subscript subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc58 \ud835\udc58 1 \u2026 subscript \ud835\udc51 \ud835\udf14 \\mathcal{A}_{d_{0},d_{\\omega},d_{\\xi}}:=\\{\\boldsymbol{e}_{i}\\}_{i=1,\\dots,d_{0}}\\cup\\{\\boldsymbol{\\epsilon}^{\\xi}_{j}\\}_{j=1,\\dots,d_{\\xi}}\\cup\\{\\boldsymbol{\\epsilon}^{\\omega}_{k}\\}_{k=1,\\dots,d_{\\omega}}\n\nFixed the gates we define as the unique solution to:\n\nT \u200b ( X ) 0 , t = \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 absent \\displaystyle T(X)_{0,t}= \u2211 i = 1 d X 0 i \u200b \ud835\udc86 i + \u2211 j = 1 d \u03be \u03be t X , j \u200b \u03f5 j \u03be + \u2211 k = 1 d \u03c9 \u222b 0 t T \u200b ( X ) 0 , s \u200b \ud835\udc51 \u03c9 s X , k \u2297 \u03f5 k \u03c9 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udc86 \ud835\udc56 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 subscript superscript bold-italic-\u03f5 \ud835\udf09 \ud835\udc57 superscript subscript \ud835\udc58 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript 0 \ud835\udc61 tensor-product \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc58 \\displaystyle~{}\\sum_{i=1}^{d}X_{0}^{i}\\boldsymbol{e}_{i}+\\sum_{j=1}^{d_{\\xi}}\\xi^{\\text{X},j}_{t}\\boldsymbol{\\epsilon}^{\\xi}_{j}+\\sum_{k=1}^{d_{\\omega}}\\int_{0}^{t}T(X)_{0,s}~{}d\\omega^{\\text{X},k}_{s}\\otimes\\boldsymbol{\\epsilon}^{\\omega}_{k} (36)\n\nIn fact one readily sees that the only non-zero terms of defined as above are\n\n\u27e8 T \u200b ( X ) 0 , t , \ud835\udc86 i \u27e9 = X 0 i \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 subscript \ud835\udc86 \ud835\udc56 superscript subscript \ud835\udc4b 0 \ud835\udc56 \\displaystyle\\langle T(X)_{0,t},\\boldsymbol{e}_{i}\\rangle=X_{0}^{i} \u27e8 T \u200b ( X ) 0 , t , \ud835\udc86 i \u2297 \u03f5 I \u200b k \u03c9 \u27e9 = \u222b 0 t \u27e8 T \u200b ( X ) 0 , s , \ud835\udc86 i \u2297 \u03f5 I \u03c9 \u27e9 \u200b \ud835\udc51 \u03c9 s X , k = X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t I \u200b k \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 tensor-product subscript \ud835\udc86 \ud835\udc56 subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc3c \ud835\udc58 superscript subscript 0 \ud835\udc61 \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc60 tensor-product subscript \ud835\udc86 \ud835\udc56 subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc3c differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc3c \ud835\udc58 \\displaystyle\\langle T(X)_{0,t},\\boldsymbol{e}_{i}\\otimes\\boldsymbol{\\epsilon}^{\\omega}_{Ik}\\rangle=\\int_{0}^{t}\\langle T(X)_{0,s},\\boldsymbol{e}_{i}\\otimes\\boldsymbol{\\epsilon}^{\\omega}_{I}\\rangle d\\omega^{\\text{X},k}_{s}=X_{0}^{i}~{}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{Ik} \u27e8 T \u200b ( X ) 0 , t , \u03f5 j \u03be \u27e9 = \u03be t X , j = \u222b 0 t \ud835\udc51 \u03be s X , j \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 subscript superscript bold-italic-\u03f5 \ud835\udf09 \ud835\udc57 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 superscript subscript 0 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\langle T(X)_{0,t},\\boldsymbol{\\epsilon}^{\\xi}_{j}\\rangle=\\xi^{\\text{X},j}_{t}=\\int_{0}^{t}d\\xi^{\\text{X},j}_{s} \u27e8 T \u200b ( X ) 0 , t , \u03f5 j \u03be \u2297 \u03f5 I \u200b k \u03c9 \u27e9 = \u222b 0 t \u27e8 T \u200b ( X ) 0 , s , \u03f5 j \u03be \u2297 \u03f5 I \u03c9 \u27e9 \u200b \ud835\udc51 \u03c9 s X , k = \u222b s = 0 t \u222b r = 0 s Sig \u200b ( \u03c9 X ) r , s I \u200b \ud835\udc51 \u03be r X , j \u200b \ud835\udc51 \u03c9 s X , k \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc61 tensor-product subscript superscript bold-italic-\u03f5 \ud835\udf09 \ud835\udc57 subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc3c \ud835\udc58 superscript subscript 0 \ud835\udc61 \ud835\udc47 subscript \ud835\udc4b 0 \ud835\udc60 tensor-product subscript superscript bold-italic-\u03f5 \ud835\udf09 \ud835\udc57 subscript superscript bold-italic-\u03f5 \ud835\udf14 \ud835\udc3c differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 superscript subscript \ud835\udc60 0 \ud835\udc61 superscript subscript \ud835\udc5f 0 \ud835\udc60 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc5f \ud835\udc60 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc5f differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 \\displaystyle\\langle T(X)_{0,t},\\boldsymbol{\\epsilon}^{\\xi}_{j}\\otimes\\boldsymbol{\\epsilon}^{\\omega}_{Ik}\\rangle=\\int_{0}^{t}\\langle T(X)_{0,s},\\boldsymbol{\\epsilon}^{\\xi}_{j}\\otimes\\boldsymbol{\\epsilon}^{\\omega}_{I}\\rangle d\\omega^{\\text{X},k}_{s}=\\int_{s=0}^{t}\\int_{r=0}^{s}\\text{Sig}(\\omega^{\\text{X}})_{r,s}^{I}d\\xi^{\\text{X},j}_{r}d\\omega^{\\text{X},k}_{s} = \u222b r = 0 t \u222b s = r t Sig \u200b ( \u03c9 X ) r , s I \u200b \ud835\udc51 \u03c9 s X , k \u200b \ud835\udc51 \u03be r X , j = \u222b 0 t Sig \u200b ( \u03c9 X ) r , t I \u200b \ud835\udc51 \u03be r X , j absent superscript subscript \ud835\udc5f 0 \ud835\udc61 superscript subscript \ud835\udc60 \ud835\udc5f \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc5f \ud835\udc60 \ud835\udc3c differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc5f superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc5f \ud835\udc61 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc5f \\displaystyle\\hskip 15.0pt=\\int_{r=0}^{t}\\int_{s=r}^{t}\\text{Sig}(\\omega^{\\text{X}})_{r,s}^{I}d\\omega^{\\text{X},k}_{s}d\\xi^{\\text{X},j}_{r}=\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{r,t}^{I}~{}d\\xi^{\\text{X},j}_{r}\n\nThis is similar to the tensor-valued CDE defining the signature as a tensor i.e. (Salvi et al., 2021a)\n\nSig \u200b ( \u03c9 ) 0 , t = ( ) + \u222b 0 t Sig \u200b ( \u03c9 ) 0 , s \u2297 \ud835\udc51 \u03c9 s Sig subscript \ud835\udf14 0 \ud835\udc61 superscript subscript 0 \ud835\udc61 tensor-product Sig subscript \ud835\udf14 0 \ud835\udc60 differential-d subscript \ud835\udf14 \ud835\udc60 \\text{Sig}(\\omega)_{0,t}=()+\\int_{0}^{t}\\text{Sig}(\\omega)_{0,s}\\otimes d\\omega_{s}\n\nwith the addition of two terms to track and . One could also understand as a sub-tensor of\n\nX 0 \u2297 Sig \u200b ( ( \u03c9 X , \u03be X ) ) s , t tensor-product subscript \ud835\udc4b 0 Sig subscript superscript \ud835\udf14 X superscript \ud835\udf09 X \ud835\udc60 \ud835\udc61 X_{0}\\otimes\\text{Sig}((\\omega^{\\text{X}},\\xi^{\\text{X}}))_{s,t}\n\nbut in doing this one would have to explicitly ignore most of the terms of this vector; the CDE (36) does exactly this, but implicitly. In any case the subtensor view shows that is well defined and continuous. To the feature map with values in the Hilbert space is then associated a Reproducing Kernel Hilbert Space (Berlinet & Thomas-Agnan, 2011), where the Kernel is the one induced by the product, which we denote by\n\n\u210b t ( \u22c5 ) 0 , \u03c9 , \u03b7 \u2286 C 0 \u200b ( \ud835\udd4f ; \u211d ) subscript superscript \u210b subscript \u22c5 0 \ud835\udf14 \ud835\udf02 \ud835\udc61 superscript \ud835\udc36 0 \ud835\udd4f \u211d \\mathcal{H}^{\\tiny(\\cdot)_{0},\\omega,\\eta}_{t}\\subseteq C^{0}(\\mathbb{X};\\mathbb{R}) (37)\n\nClassical RKHS theory tells us that we can characterize its elements as:\n\nProposition B.7. A map is an element of if and only if it is of the form\n\nF \u200b ( x ) t = \ud835\udc39 subscript \ud835\udc65 \ud835\udc61 absent \\displaystyle F(x)_{t}= \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s} (38)\n\nfor . Moreover is equal to the minimal value of\n\n\u2211 i = 1 d 0 \u2225 \u03b1 i \u2225 l 2 \u200b ( \ud835\udd4e d \u03c9 ) 2 + \u2211 j = 1 d \u03be \u2225 \u03b2 j \u2225 l 2 \u200b ( \ud835\udd4e d \u03c9 ) 2 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript superscript delimited-\u2225\u2225 subscript \ud835\udefc \ud835\udc56 2 superscript \ud835\udc59 2 subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript superscript delimited-\u2225\u2225 subscript \ud835\udefd \ud835\udc57 2 superscript \ud835\udc59 2 subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \\sum_{i=1}^{d_{0}}\\left\\lVert\\alpha_{i}\\right\\rVert^{2}_{l^{2}(\\mathbb{W}_{d_{\\omega}})}+\\sum_{j=1}^{d_{\\xi}}\\left\\lVert\\beta_{j}\\right\\rVert^{2}_{l^{2}(\\mathbb{W}_{d_{\\omega}})}\n\ntaken over those for which the above equality holds. Signature kernels (Salvi et al., 2021a) are a class of universal kernels on sequential data which have received attention in recent years thanks to their efficiency in handling path-dependent problems (Lemercier et al., 2021; Salvi et al., 2021c; Cochrane et al., 2021; Salvi et al., 2021b; Cirone et al., 2023; Issa et al., 2023). Just as signature kernels, the kernel associated to can be explicitly written as the solution of a two-parameter CDE:\n\nLemma B.8. Let then\n\n\ud835\udca6 X , Y \u200b ( s , t ) = superscript \ud835\udca6 X Y \ud835\udc60 \ud835\udc61 absent \\displaystyle\\mathcal{K}^{\\text{X},\\text{Y}}(s,t)= \u27e8 X 0 , Y 0 \u27e9 + \u27e8 \u03be s X , \u03be t Y \u27e9 + \u222b \u03b7 = 0 s \u222b \u03c4 = 0 t \ud835\udca6 X , Y \u200b ( \u03b7 , \u03c4 ) \u200b \u27e8 d \u200b \u03c9 \u03b7 X , d \u200b \u03c9 \u03c4 Y \u27e9 subscript \ud835\udc4b 0 subscript \ud835\udc4c 0 subscript superscript \ud835\udf09 X \ud835\udc60 subscript superscript \ud835\udf09 Y \ud835\udc61 superscript subscript \ud835\udf02 0 \ud835\udc60 superscript subscript \ud835\udf0f 0 \ud835\udc61 superscript \ud835\udca6 X Y \ud835\udf02 \ud835\udf0f \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udf02 \ud835\udc51 subscript superscript \ud835\udf14 Y \ud835\udf0f \\displaystyle~{}\\langle X_{0},Y_{0}\\rangle+\\langle\\xi^{\\text{X}}_{s},\\xi^{\\text{Y}}_{t}\\rangle+\\int_{\\eta=0}^{s}\\int_{\\tau=0}^{t}\\mathcal{K}^{\\text{X},\\text{Y}}(\\eta,\\tau)\\langle d\\omega^{\\text{X}}_{\\eta},d\\omega^{\\text{Y}}_{\\tau}\\rangle (39)\n\nor, directly in terms of Signature, also\n\n\ud835\udca6 X , Y \u200b ( s , t ) = superscript \ud835\udca6 X Y \ud835\udc60 \ud835\udc61 absent \\displaystyle\\mathcal{K}^{\\text{X},\\text{Y}}(s,t)= \u27e8 X 0 , Y 0 \u27e9 \u200b \u27e8 Sig \u200b ( \u03c9 X ) 0 , s , Sig \u200b ( \u03c9 Y ) 0 , t \u27e9 + \u222b \u03b7 = 0 s \u222b \u03c4 = 0 t \u27e8 Sig \u200b ( \u03c9 X ) \u03b7 , s , Sig \u200b ( \u03c9 Y ) \u03c4 , t \u27e9 \u200b \u27e8 d \u200b \u03be \u03b7 X , d \u200b \u03be \u03c4 Y \u27e9 subscript \ud835\udc4b 0 subscript \ud835\udc4c 0 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc60 Sig subscript superscript \ud835\udf14 Y 0 \ud835\udc61 superscript subscript \ud835\udf02 0 \ud835\udc60 superscript subscript \ud835\udf0f 0 \ud835\udc61 Sig subscript superscript \ud835\udf14 X \ud835\udf02 \ud835\udc60 Sig subscript superscript \ud835\udf14 Y \ud835\udf0f \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udf02 \ud835\udc51 subscript superscript \ud835\udf09 Y \ud835\udf0f \\displaystyle\\langle X_{0},Y_{0}\\rangle\\langle\\text{Sig}(\\omega^{\\text{X}})_{0,s},\\text{Sig}(\\omega^{\\text{Y}})_{0,t}\\rangle+\\int_{\\eta=0}^{s}\\int_{\\tau=0}^{t}\\langle\\text{Sig}(\\omega^{\\text{X}})_{\\eta,s},\\text{Sig}(\\omega^{\\text{Y}})_{\\tau,t}\\rangle\\langle d\\xi^{\\text{X}}_{\\eta},d\\xi^{\\text{Y}}_{\\tau}\\rangle (40)\n\nProof. The first expression follows immediately from Eqn. (36) the second one by summing the products of \u2019s and \u2019s entries given above. \u220e\n\nDefinition B.9. Define the space as the space of functions of form\n\n( X , t ) \u21a6 maps-to \ud835\udc4b \ud835\udc61 absent \\displaystyle(X,t)\\mapsto \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s} (41)\n\nfor . Thus for all and it holds . B.3.3 Linear maps on are close to the RKHS\n\nThe following proposition will show how linear maps on cannot be more expressive than elements of the RKHS since their closure is in the closure of . In this precise sense these spaces act like upper bounds to expressiveness.",
    "theoryssms-34": "Proposition B.10. Assume compact. Consider fixed the gates and and . Consider a linear readout . For any there exist choices of such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u27e8 v , Z t X \u27e9 \u2212 F \u200b ( X , t ) | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc39 \ud835\udc4b \ud835\udc61 italic-\u03f5 \\sup_{(X,t)\\in\\mathbb{X}\\times[0,1]}|\\langle v,Z^{\\text{X}}_{t}\\rangle-F(X,t)|\\leq\\epsilon (42)\n\nwhere . In other words, linear maps on the are in the uniform closure of .",
    "theoryssms-35": "Proof. Using Eqn. (34) we see that is a linear map on with coefficients\n\nv \u22a4 \u200b A I \u200b B j v \u22a4 \u200b A I \u200b C i superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 v^{\\top}A_{I}B_{j}\\quad v^{\\top}A_{I}C_{i}\n\nusing Cauchy-Schwartz it\u2019s moreover easy to see the existence of a constant such that for all one has\n\n| v \u22a4 \u200b A I \u200b B j | \u2264 \u03bb | I | | v \u22a4 \u200b A I \u200b C i | \u2264 \u03bb | I | . formulae-sequence superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript \ud835\udf06 \ud835\udc3c superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript \ud835\udf06 \ud835\udc3c |v^{\\top}A_{I}B_{j}|\\leq\\lambda^{|I|}\\quad|v^{\\top}A_{I}C_{i}|\\leq\\lambda^{|I|}. Since we have that, given an integer , the bound\n\nR M \u200b ( t ) subscript \ud835\udc45 \ud835\udc40 \ud835\udc61 \\displaystyle R_{M}(t) := | \u2211 i = 1 d 0 \u2211 | I | \u2265 M v \u22a4 \u200b A I \u200b C i \u200b X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t I + \u2211 j = 1 d \u03be \u2211 | I | \u2265 M v \u22a4 \u200b A I \u200b B j \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t I \u200b \ud835\udc51 \u03be s X , j | assign absent superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c \ud835\udc40 superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc3c superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript \ud835\udc3c \ud835\udc40 superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle:=\\left|\\sum_{i=1}^{d_{0}}\\sum_{|I|\\geq M}v^{\\top}A_{I}C_{i}\\hskip 3.0ptX_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{I}+\\sum_{j=1}^{d_{\\xi}}\\sum_{|I|\\geq M}v^{\\top}A_{I}B_{j}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}d\\xi^{\\text{X},j}_{s}\\right| \u2264 ( \u2225 X 0 \u2225 1 + \u2225 \u03be t X \u2225 1 ) \u200b \u2211 m = M \u221e \u03bb m \u200b d \u03c9 m \u200b \u2225 \u03c9 X \u2225 1 \u2212 v \u200b a \u200b r , [ 0 , t ] m m ! absent subscript delimited-\u2225\u2225 subscript \ud835\udc4b 0 1 subscript delimited-\u2225\u2225 subscript superscript \ud835\udf09 X \ud835\udc61 1 superscript subscript \ud835\udc5a \ud835\udc40 superscript \ud835\udf06 \ud835\udc5a superscript subscript \ud835\udc51 \ud835\udf14 \ud835\udc5a superscript subscript delimited-\u2225\u2225 superscript \ud835\udf14 X 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f 0 \ud835\udc61 \ud835\udc5a \ud835\udc5a \\displaystyle\\leq(\\left\\lVert X_{0}\\right\\rVert_{1}+\\left\\lVert\\xi^{\\text{X}}_{t}\\right\\rVert_{1})\\sum_{m=M}^{\\infty}\\frac{\\lambda^{m}d_{\\omega}^{m}\\left\\lVert\\omega^{\\text{X}}\\right\\rVert_{1-var,[0,t]}^{m}}{m!} \u2264 ( \u2225 X 0 \u2225 1 + \u2225 \u03be t X \u2225 1 ) \u200b \u2211 m = M \u221e \u03bb m \u200b d \u03c9 m \u200b \u2225 \u03c9 X \u2225 1 \u2212 v \u200b a \u200b r , [ 0 , 1 ] m m ! \u2264 K \u200b \u2211 m = M \u221e ( \u03bb \u200b d \u03c9 \u200b K ) m m ! absent subscript delimited-\u2225\u2225 subscript \ud835\udc4b 0 1 subscript delimited-\u2225\u2225 subscript superscript \ud835\udf09 X \ud835\udc61 1 superscript subscript \ud835\udc5a \ud835\udc40 superscript \ud835\udf06 \ud835\udc5a superscript subscript \ud835\udc51 \ud835\udf14 \ud835\udc5a superscript subscript delimited-\u2225\u2225 superscript \ud835\udf14 X 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f 0 1 \ud835\udc5a \ud835\udc5a \ud835\udc3e superscript subscript \ud835\udc5a \ud835\udc40 superscript \ud835\udf06 subscript \ud835\udc51 \ud835\udf14 \ud835\udc3e \ud835\udc5a \ud835\udc5a \\displaystyle\\leq(\\left\\lVert X_{0}\\right\\rVert_{1}+\\left\\lVert\\xi^{\\text{X}}_{t}\\right\\rVert_{1})\\sum_{m=M}^{\\infty}\\frac{\\lambda^{m}d_{\\omega}^{m}\\left\\lVert\\omega^{\\text{X}}\\right\\rVert_{1-var,[0,1]}^{m}}{m!}\\leq K\\sum_{m=M}^{\\infty}\\frac{(\\lambda d_{\\omega}K)^{m}}{m!}\n\nwhere is a constant which must exist by compactness of and continuity of the gates. Since is just the tail of the taylor expansion of there must be an such that . But then the choice\n\n\u03b1 i I := v \u22a4 \u200b A I \u200b C i \u200b \ud835\udd40 \u200b ( | I | < M ) \u03b2 j I := v \u22a4 \u200b A I \u200b B j \u200b \ud835\udd40 \u200b ( | I | < M ) formulae-sequence assign superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 \ud835\udd40 \ud835\udc3c \ud835\udc40 assign superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 \ud835\udd40 \ud835\udc3c \ud835\udc40 \\alpha_{i}^{I}:=v^{\\top}A_{I}C_{i}~{}\\mathbb{I}(|I|<M)\\quad\\beta_{j}^{I}:=v^{\\top}A_{I}B_{j}~{}\\mathbb{I}(|I|<M)\n\nsuffices for the required bound. B.3.4 Uniform closure of the RKHS\n\nNow that we have established the theoretical interest of the we proceed to characterize which maps can be uniformly approximated trough them. Proposition B.11. Fix a compact input set and continuous gates with and . For any and any\n\nF \u2208 { ( X , t ) \u21a6 \u03a8 \u200b ( \u03c9 [ 0 , t ] X ) \u22c5 X 0 + \u222b 0 t \u03a6 \u200b ( \u03c9 [ s , t ] X ) \u22c5 \ud835\udc51 \u03be s X } \ud835\udc39 maps-to \ud835\udc4b \ud835\udc61 \u22c5 \u03a8 subscript superscript \ud835\udf14 X 0 \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 \u03a6 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 F\\in\\left\\{(X,t)\\mapsto\\Psi(\\omega^{\\text{X}}_{[0,t]})\\cdot X_{0}+\\int_{0}^{t}\\Phi(\\omega^{\\text{X}}_{[s,t]})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (43)\n\nwhere and , there exist a such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 G \u200b ( X , t ) | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 \ud835\udc3a \ud835\udc4b \ud835\udc61 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-G(X,t)|\\leq\\epsilon (44)\n\nProof. Note first that the map\n\n\ud835\udd4f \u00d7 [ 0 , 1 ] \u00d7 [ 0 , 1 ] \u2192 C 1 , 0 \u200b ( [ 0 , 1 ] ; \u211d d \u03c9 ) ( X , s , t ) \u21a6 \u03c9 [ s , t ] X formulae-sequence \u2192 \ud835\udd4f 0 1 0 1 subscript \ud835\udc36 1 0 0 1 superscript \u211d subscript \ud835\udc51 \ud835\udf14 maps-to \ud835\udc4b \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \\mathbb{X}\\times[0,1]\\times[0,1]\\to C_{1,0}([0,1];\\mathbb{R}^{d_{\\omega}})\\quad(X,s,t)\\mapsto\\omega^{\\text{X}}_{[s,t]}\n\nis a continuous map from a compact space, thus the image must be compact too. Moreover by Prop. A.8 the Signature separates the points in this image. Since any as above has form\n\nG \u200b ( X , t ) \ud835\udc3a \ud835\udc4b \ud835\udc61 \\displaystyle G(X,t) = \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j absent superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle=\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s} = \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 [ 0 , t ] X ) 0 , 1 \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 [ s , t ] X ) 0 , 1 \u27e9 \u200b \ud835\udc51 \u03be s X , j absent superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 0 1 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 0 1 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle=\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}}_{[0,t]})_{0,1}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}}_{[s,t]})_{0,1}\\rangle d\\xi^{\\text{X},j}_{s}\n\nthe proof follows from the uniform density on compact sets of linear functionals on the (truncated) Signature (Thm. A.5), by also uniformly bounding thanks to compactness and continuity the norms of and . \u220e\n\nB.3.5 Generic Weights are fully expressive\n\nWe have seen how linear maps on are in the uniform closure of , and we have explicitly characterized this closure. It is then natural to ask \u201dhow much\u201d of this closure the are able to \u201dexplore\u201d. The present section not only shows that the \u201dexplore\u201d all the closure, but also that a generic choice of weights is enough to eventually do this with high probability. The fact that these maps are \u201duniversal\u201d in the above sense is not surprising, since it is well known that Linear CDEs are universal for path-to-point tasks cf. (Kidger, 2022), what is surprising is that this universality can be achieved probabilistically with one of the standard parametrizations used in ML practice (LeCun) 141414It can be proved, using the results of (Dubach & Peled, 2021), that the sampling measure does not have to be Gaussian if it satisfies certain moment requirements..",
    "theoryssms-36": "Theorem B.12. Fix compact and . For all there exist a choice of hidden dimension and parameters such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u27e8 v , Z t X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\langle v,Z^{\\text{X}}_{t}\\rangle|\\leq\\epsilon (45)\n\nMoreover generic weight choices suffice with high probability, in the sense that under LeCun initialization\n\n[ A j ] n , n \u2032 \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 N ) [ C ] n , i , [ B ] n , j \u200b \u223c iid \u200b \ud835\udca9 \u200b ( 0 , 1 ) subscript delimited-[] subscript \ud835\udc34 \ud835\udc57 \ud835\udc5b superscript \ud835\udc5b \u2032 iid similar-to \ud835\udca9 0 1 \ud835\udc41 subscript delimited-[] \ud835\udc36 \ud835\udc5b \ud835\udc56 subscript delimited-[] \ud835\udc35 \ud835\udc5b \ud835\udc57 iid similar-to \ud835\udca9 0 1 [A_{j}]_{n,n^{\\prime}}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,\\frac{1}{N})\\quad[C]_{n,i},[B]_{n,j}\\overset{\\text{iid}}{\\sim}\\mathcal{N}(0,1)\n\nthe following holds\n\nlim N \u2192 \u221e \u2119 [ \u2203 v \u2208 \u211d N : ( 45 ) holds ] = 1 \\lim\\limits_{N\\to\\infty}\\mathbb{P}\\big{[}\\exists v\\in\\mathbb{R}^{N}:\\text{ (\\ref{app:eqn:dense_RKHS}) holds }\\big{]}=1\n\nWe propose two proofs, the first one of a deterministic character concerns the first claim in the theorem, the second one is probabilistic and concerns the whole result.",
    "theoryssms-37": "The deterministic proof follows the same arguments employed by (Kidger, 2022) and is included to highlight the main idea of the probabilistic result, which reduces to a \u201dspin\u201d on the central argument of this proof. Deterministic Proof.. Any has form\n\nF \u200b ( X , t ) = \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j \ud835\udc39 \ud835\udc4b \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 F(X,t)=\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s} (46)\n\nfor fixed . Consider an integer such that\n\nsup ( x , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03c0 M \u200b \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 \u2212 \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03c0 M \u200b \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j | \u2264 \u03f5 subscript supremum \ud835\udc65 \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 italic-\u03f5 \\sup\\limits_{(x,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\pi_{M}\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle-\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\pi_{M}\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s}|\\leq\\epsilon (47)\n\nwhere is the truncation at length .",
    "theoryssms-38": "Fix . Consider such that . We are going to write to mean the image of trough this identification. Note that is a linear map, it does then correspond to a matrix . Write for and for . Then the solution to\n\n\u211d \u03bc \u200b ( M , d ) \u220b Z ~ t = \u2211 i = 1 d 0 X 0 i \u200b e i + \u2211 j = 1 d \u03be \u03be t X , j \u200b \u03b5 j B + \u2211 k = 1 d \u03c9 \u222b 0 t \u039b d 0 + d \u03be + k \u200b Z ~ s \u200b \ud835\udc51 \u03c9 s X , k contains superscript \u211d \ud835\udf07 \ud835\udc40 \ud835\udc51 subscript ~ \ud835\udc4d \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udc52 \ud835\udc56 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 subscript superscript \ud835\udf00 \ud835\udc35 \ud835\udc57 superscript subscript \ud835\udc58 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript 0 \ud835\udc61 subscript \u039b subscript \ud835\udc51 0 subscript \ud835\udc51 \ud835\udf09 \ud835\udc58 subscript ~ \ud835\udc4d \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc58 \ud835\udc60 \\mathbb{R}^{\\mu(M,d)}\\ni\\tilde{Z}_{t}=\\sum_{i=1}^{d_{0}}X_{0}^{i}e_{i}+\\sum_{j=1}^{d_{\\xi}}\\xi^{\\text{X},j}_{t}\\varepsilon^{B}_{j}+\\sum_{k=1}^{d_{\\omega}}\\int_{0}^{t}\\Lambda_{d_{0}+d_{\\xi}+k}\\tilde{Z}_{s}d\\omega^{\\text{X},k}_{s} (48)\n\nis the object in corresponding to the truncated tensor . This is of the form with , , and . In particular note how these matrices are such that\n\ne J T \u200b A I \u200b C i = \ud835\udd40 \u200b ( e J = e i \u2297 \u03b5 I \u03c9 ) , e J T \u200b A I \u200b B j = \ud835\udd40 \u200b ( e J = \u03b5 j \u03be \u2297 \u03b5 I \u03c9 ) , formulae-sequence superscript subscript \ud835\udc52 \ud835\udc3d \ud835\udc47 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 \ud835\udd40 subscript \ud835\udc52 \ud835\udc3d tensor-product subscript \ud835\udc52 \ud835\udc56 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c superscript subscript \ud835\udc52 \ud835\udc3d \ud835\udc47 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 \ud835\udd40 subscript \ud835\udc52 \ud835\udc3d tensor-product subscript superscript \ud835\udf00 \ud835\udf09 \ud835\udc57 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c e_{J}^{T}A_{I}C_{i}=\\mathbb{I}(e_{J}=e_{i}\\otimes\\varepsilon^{\\omega}_{I}),\\quad e_{J}^{T}A_{I}B_{j}=\\mathbb{I}(e_{J}=\\varepsilon^{\\xi}_{j}\\otimes\\varepsilon^{\\omega}_{I}), (49)\n\nsince it holds that\n\nA I \u200b C i = e i \u2297 \u03b5 I \u03c9 , A I \u200b B j = \u03b5 j \u03be \u2297 \u03b5 I \u03c9 , formulae-sequence subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 tensor-product subscript \ud835\udc52 \ud835\udc56 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 tensor-product subscript superscript \ud835\udf00 \ud835\udf09 \ud835\udc57 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c A_{I}C_{i}=e_{i}\\otimes\\varepsilon^{\\omega}_{I},\\quad A_{I}B_{j}=\\varepsilon^{\\xi}_{j}\\otimes\\varepsilon^{\\omega}_{I}, (50)\n\nand for all one has necessarily . Our strategy is that of using these equaities to create a vector corresponding to the and . Define the vector\n\nv := \u2211 i = 1 d 0 \u2211 | I | \u2264 M \u03b1 i I \u200b e i \u2297 \u03b5 I \u03c9 + \u2211 j = 1 d \u03c9 \u2211 | I | \u2264 M \u03b2 j I \u200b \u03b5 j \u03be \u2297 \u03b5 I \u03c9 \u2208 \u211d \u03bc \u200b ( M , d ) assign \ud835\udc63 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c \ud835\udc40 tensor-product superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c subscript \ud835\udc52 \ud835\udc56 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc3c \ud835\udc40 tensor-product superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c subscript superscript \ud835\udf00 \ud835\udf09 \ud835\udc57 subscript superscript \ud835\udf00 \ud835\udf14 \ud835\udc3c superscript \u211d \ud835\udf07 \ud835\udc40 \ud835\udc51 v:=\\sum_{i=1}^{d_{0}}\\sum_{|I|\\leq M}\\alpha_{i}^{I}~{}e_{i}\\otimes\\varepsilon^{\\omega}_{I}+\\sum_{j=1}^{d_{\\omega}}\\sum_{|I|\\leq M}\\beta_{j}^{I}~{}\\varepsilon^{\\xi}_{j}\\otimes\\varepsilon^{\\omega}_{I}\\in\\mathbb{R}^{\\mu(M,d)} (51)\n\nThen expanding as in (34) and using the equalities above one has\n\n\u27e8 v , Z t X \u27e9 = \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 absent \\displaystyle\\langle v,Z^{\\text{X}}_{t}\\rangle= \u2211 i = 1 d 0 \u2211 I v \u22a4 \u200b A I \u200b C i \u200b X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t + \u2211 j = 1 d \u03c9 \u2211 I v \u22a4 \u200b A I \u200b B j \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc3c superscript \ud835\udc63 top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript subscript 0 \ud835\udc61 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d_{0}}\\sum_{I}v^{\\top}A_{I}C_{i}~{}X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}+\\sum_{j=1}^{d_{\\omega}}\\sum_{I}v^{\\top}A_{I}B_{j}~{}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}d\\xi^{\\text{X},j}_{s} = \\displaystyle= \u2211 i = 1 d 0 \u2211 | I | \u2264 M \u03b1 i I \u200b X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t + \u2211 j = 1 d \u03be \u2211 | I | \u2264 M \u03b2 j I \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c \ud835\udc40 superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript \ud835\udc3c \ud835\udc40 superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c superscript subscript 0 \ud835\udc61 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d_{0}}\\sum_{|I|\\leq M}\\alpha_{i}^{I}X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}+\\sum_{j=1}^{d_{\\xi}}\\sum_{|I|\\leq M}\\beta_{j}^{I}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}d\\xi^{\\text{X},j}_{s} = \\displaystyle= \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03c0 M \u200b \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03c0 M \u200b \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\pi_{M}\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\pi_{M}\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s}\n\nproving that for such and it holds\n\nsup ( x , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u27e8 v , Z t X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc65 \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 italic-\u03f5 \\sup\\limits_{(x,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\langle v,Z^{\\text{X}}_{t}\\rangle|\\leq\\epsilon (52)\n\nThe crucial ingredient for the success of this proof is the possibility to recreate the space as an euclidean space. To do this one needs orthogonal vectors and a way to express them using the matrices and , the essential equations which capture this are given by (49). The core idea of the following probabilistic proof of this same result is that of allowing for some error in (49), so the idea is that of exhibiting only approximately orthogonal vectors. At the cost of losing exactness, one can leverage results of the Johnson-Lindenstrauss (Dasgupta & Gupta, 2003) type to find on the order of vectors in orthogonal up to an error, using random projections. This idea in the context of Signature goes back to (Cuchiero et al., 2021a), and allows for much smaller hidden dimensions. Proof. (Probabilistic Proof) Any has form\n\nF \u200b ( X , t ) = \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 + \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j \ud835\udc39 \ud835\udc4b \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 F(X,t)=\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle+\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s} (53)\n\nfor fixed . Consider an integer such that\n\nsup ( x , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03c0 M \u200b \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 \u2212 \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03c0 M \u200b \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j | \u2264 \u03f5 subscript supremum \ud835\udc65 \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 italic-\u03f5 \\sup\\limits_{(x,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\pi_{M}\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle-\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\pi_{M}\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s}|\\leq\\epsilon (54)\n\nwhere is the truncation at length . From (Cirone et al., 2023)[Appendix C] we know that\n\n\u2225 1 N \u200b C i \u22a4 \u200b A I \u22a4 \u200b A J \u200b C j \u2212 \u03b4 i \u200b I j \u200b J \u2225 L 2 = \ud835\udcaa \u200b ( 1 N ) \u200b 2 | I | + | J | 2 \u200b ( | I | + | J | ) !! subscript delimited-\u2225\u2225 1 \ud835\udc41 superscript subscript \ud835\udc36 \ud835\udc56 top superscript subscript \ud835\udc34 \ud835\udc3c top subscript \ud835\udc34 \ud835\udc3d subscript \ud835\udc36 \ud835\udc57 superscript subscript \ud835\udeff \ud835\udc56 \ud835\udc3c \ud835\udc57 \ud835\udc3d superscript \ud835\udc3f 2 \ud835\udcaa 1 \ud835\udc41 superscript 2 \ud835\udc3c \ud835\udc3d 2 double-factorial \ud835\udc3c \ud835\udc3d \\displaystyle\\left\\lVert\\frac{1}{N}C_{i}^{\\top}A_{I}^{\\top}A_{J}C_{j}-\\delta_{iI}^{jJ}\\right\\rVert_{L^{2}}=\\mathcal{O}(\\frac{1}{\\sqrt{N}})2^{\\frac{|I|+|J|}{2}}(|I|+|J|)!! (55) \u2225 1 N \u200b C i \u22a4 \u200b A I \u22a4 \u200b A J \u200b B j \u2225 L 2 = \ud835\udcaa \u200b ( 1 N ) \u200b 2 | I | + | J | 2 \u200b ( | I | + | J | ) !! subscript delimited-\u2225\u2225 1 \ud835\udc41 superscript subscript \ud835\udc36 \ud835\udc56 top superscript subscript \ud835\udc34 \ud835\udc3c top subscript \ud835\udc34 \ud835\udc3d subscript \ud835\udc35 \ud835\udc57 superscript \ud835\udc3f 2 \ud835\udcaa 1 \ud835\udc41 superscript 2 \ud835\udc3c \ud835\udc3d 2 double-factorial \ud835\udc3c \ud835\udc3d \\displaystyle\\left\\lVert\\frac{1}{N}C_{i}^{\\top}A_{I}^{\\top}A_{J}B_{j}\\right\\rVert_{L^{2}}=\\mathcal{O}(\\frac{1}{\\sqrt{N}})2^{\\frac{|I|+|J|}{2}}(|I|+|J|)!! (56) \u2225 1 N \u200b B i \u22a4 \u200b A I \u22a4 \u200b A J \u200b B j \u2212 \u03b4 i \u200b I j \u200b J \u2225 L 2 = \ud835\udcaa \u200b ( 1 N ) \u200b 2 | I | + | J | 2 \u200b ( | I | + | J | ) !! subscript delimited-\u2225\u2225 1 \ud835\udc41 superscript subscript \ud835\udc35 \ud835\udc56 top superscript subscript \ud835\udc34 \ud835\udc3c top subscript \ud835\udc34 \ud835\udc3d subscript \ud835\udc35 \ud835\udc57 superscript subscript \ud835\udeff \ud835\udc56 \ud835\udc3c \ud835\udc57 \ud835\udc3d superscript \ud835\udc3f 2 \ud835\udcaa 1 \ud835\udc41 superscript 2 \ud835\udc3c \ud835\udc3d 2 double-factorial \ud835\udc3c \ud835\udc3d \\displaystyle\\left\\lVert\\frac{1}{N}B_{i}^{\\top}A_{I}^{\\top}A_{J}B_{j}-\\delta_{iI}^{jJ}\\right\\rVert_{L^{2}}=\\mathcal{O}(\\frac{1}{\\sqrt{N}})2^{\\frac{|I|+|J|}{2}}(|I|+|J|)!! (57)\n\nOur strategy is that of using these bounds to create a vector \u201dacting\u201d like the and . Define, noting that the depend on , the vector\n\nv N := 1 N \u200b ( \u2211 i = 1 d 0 \u2211 | I | \u2264 M \u03b1 i I \u200b A I \u200b C i + \u2211 j = 1 d \u03c9 \u2211 | I | \u2264 M \u03b2 j I \u200b A I \u200b B j ) assign superscript \ud835\udc63 N 1 \ud835\udc41 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c \ud835\udc40 superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc3c \ud835\udc40 superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 v^{\\text{N}}:=\\frac{1}{N}\\left(\\sum_{i=1}^{d_{0}}\\sum_{|I|\\leq M}\\alpha_{i}^{I}~{}A_{I}C_{i}+\\sum_{j=1}^{d_{\\omega}}\\sum_{|I|\\leq M}\\beta_{j}^{I}~{}A_{I}B_{j}\\right) (58)\n\nThen expanding as in (34)\n\nR M := assign subscript \ud835\udc45 \ud835\udc40 absent \\displaystyle R_{M}:= \u2225 sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u27e8 v N , Z t X \u27e9 \u2212 \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03c0 M \u200b \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 \u2212 \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03c0 M \u200b \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j | \u2225 L 2 subscript delimited-\u2225\u2225 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 superscript \ud835\udc63 N subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript \ud835\udc3f 2 \\displaystyle\\left\\lVert\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}\\left|\\langle v^{\\text{N}},Z^{\\text{X}}_{t}\\rangle-\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\pi_{M}\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle-\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\pi_{M}\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s}\\right|\\right\\rVert_{L^{2}} \u2264 \\displaystyle\\leq \u2211 i = 1 d 0 \u2211 | I | \u2264 M \u2225 ( v N ) \u22a4 \u200b A I \u200b C i \u2212 \u03b1 i I \u2225 L 2 \u200b sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t I | superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c \ud835\udc40 subscript delimited-\u2225\u2225 superscript superscript \ud835\udc63 N top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c superscript \ud835\udc3f 2 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig subscript superscript superscript \ud835\udf14 X \ud835\udc3c 0 \ud835\udc61 \\displaystyle\\sum_{i=1}^{d_{0}}\\sum_{|I|\\leq M}\\left\\lVert(v^{\\text{N}})^{\\top}A_{I}C_{i}-\\alpha_{i}^{I}\\right\\rVert_{L^{2}}\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})^{I}_{0,t}| + + \u2211 i = 1 d 0 \u2211 | I | > M \u2225 ( v N ) \u22a4 A I C i \u2225 L 2 sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | X 0 i Sig ( \u03c9 X ) 0 , t I | \\displaystyle++\\sum_{i=1}^{d_{0}}\\sum_{|I|>M}\\left\\lVert(v^{\\text{N}})^{\\top}A_{I}C_{i}\\right\\rVert_{L^{2}}\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})^{I}_{0,t}| + \u2211 j = 1 d \u03c9 \u2211 | I | \u2264 M \u2225 ( v N ) \u22a4 \u200b A I \u200b B j \u2212 \u03b2 j I \u2225 L 2 \u200b sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u222b 0 t S \u200b i \u200b g \u200b ( \u03c9 X ) s , t I \u200b \ud835\udc51 \u03be s X , j | superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc3c \ud835\udc40 subscript delimited-\u2225\u2225 superscript superscript \ud835\udc63 N top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c superscript \ud835\udc3f 2 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 superscript subscript 0 \ud835\udc61 \ud835\udc46 \ud835\udc56 \ud835\udc54 subscript superscript superscript \ud835\udf14 X \ud835\udc3c \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle+\\sum_{j=1}^{d_{\\omega}}\\sum_{|I|\\leq M}\\left\\lVert(v^{\\text{N}})^{\\top}A_{I}B_{j}-\\beta_{j}^{I}\\right\\rVert_{L^{2}}\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|\\int_{0}^{t}Sig(\\omega^{\\text{X}})^{I}_{s,t}d\\xi^{\\text{X},j}_{s}| + + \u2211 j = 1 d \u03c9 \u2211 | I | > M \u2225 ( v N ) \u22a4 A I B j \u2225 L 2 sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u222b 0 t S i g ( \u03c9 X ) s , t I d \u03be s X , j | \\displaystyle++\\sum_{j=1}^{d_{\\omega}}\\sum_{|I|>M}\\left\\lVert(v^{\\text{N}})^{\\top}A_{I}B_{j}\\right\\rVert_{L^{2}}\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|\\int_{0}^{t}Sig(\\omega^{\\text{X}})^{I}_{s,t}d\\xi^{\\text{X},j}_{s}|\n\nNote how for one has\n\n\u2225 ( v N ) \u22a4 \u200b A I \u200b C i \u2212 \u03b1 i I \u2225 L 2 \u2264 \ud835\udcaa M \u200b ( 1 N ) subscript delimited-\u2225\u2225 superscript superscript \ud835\udc63 N top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c superscript \ud835\udc3f 2 subscript \ud835\udcaa \ud835\udc40 1 \ud835\udc41 \\left\\lVert(v^{\\text{N}})^{\\top}A_{I}C_{i}-\\alpha_{i}^{I}\\right\\rVert_{L^{2}}\\leq\\mathcal{O}_{M}(\\frac{1}{\\sqrt{N}})\n\nand that similarly for\n\n\u2225 ( v N ) \u22a4 \u200b A I \u200b C i \u2225 L 2 \u2264 \ud835\udcaa M \u200b ( 1 N ) \u200b 2 | I | 2 \u200b ( M + | I | ) !! subscript delimited-\u2225\u2225 superscript superscript \ud835\udc63 N top subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript \ud835\udc3f 2 subscript \ud835\udcaa \ud835\udc40 1 \ud835\udc41 superscript 2 \ud835\udc3c 2 double-factorial \ud835\udc40 \ud835\udc3c \\left\\lVert(v^{\\text{N}})^{\\top}A_{I}C_{i}\\right\\rVert_{L^{2}}\\leq\\mathcal{O}_{M}(\\frac{1}{\\sqrt{N}})2^{\\frac{|I|}{2}}(M+|I|)!! Which leads, thanks to the same bounds of (Cirone et al., 2023)[Appendix C], to\n\nR M = 1 N \u200b \ud835\udcaa M , \ud835\udd4f \u200b ( 1 ) subscript \ud835\udc45 \ud835\udc40 1 \ud835\udc41 subscript \ud835\udcaa \ud835\udc40 \ud835\udd4f 1 R_{M}=\\frac{1}{\\sqrt{N}}\\mathcal{O}_{M,\\mathbb{X}}(1) (59)\n\nBut then by Markov\u2019s inequality it holds that\n\n\u2119 \u200b [ sup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u27e8 v N , Z t X \u27e9 \u2212 \u2211 i = 1 d 0 X 0 i \u200b \u27e8 \u03c0 M \u200b \u03b1 i , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 \u2212 \u2211 j = 1 d \u03be \u222b 0 t \u27e8 \u03c0 M \u200b \u03b2 j , Sig \u200b ( \u03c9 X ) s , t \u27e9 \u200b \ud835\udc51 \u03be s X , j | \u2264 \u03f5 ] \u2192 1 \u2192 \u2119 delimited-[] subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 superscript \ud835\udc63 N subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 superscript subscript \ud835\udc4b 0 \ud835\udc56 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefc \ud835\udc56 Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 superscript subscript 0 \ud835\udc61 subscript \ud835\udf0b \ud835\udc40 subscript \ud835\udefd \ud835\udc57 Sig subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 italic-\u03f5 1 \\mathbb{P}\\left[\\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}\\left|\\langle v^{\\text{N}},Z^{\\text{X}}_{t}\\rangle-\\sum_{i=1}^{d_{0}}X_{0}^{i}\\langle\\pi_{M}\\alpha_{i},\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle-\\sum_{j=1}^{d_{\\xi}}\\int_{0}^{t}\\langle\\pi_{M}\\beta_{j},\\text{Sig}(\\omega^{\\text{X}})_{s,t}\\rangle d\\xi^{\\text{X},j}_{s}\\right|\\leq\\epsilon\\right]\\to 1 (60)\n\nand thus there must be a choice of such that the inequality holds, and we thus obtain using (54)\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u27e8 v N , Z t X \u27e9 | \u2264 2 \u200b \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 superscript \ud835\udc63 N subscript superscript \ud835\udc4d X \ud835\udc61 2 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\langle v^{\\text{N}},Z^{\\text{X}}_{t}\\rangle|\\leq 2\\epsilon\n\nand we conclude by arbitrariness of . B.4 The Diagonal Case\n\nHere we study the particular, but empirically important, case where the matrices are taken to be diagonal151515It is equivalent to ask for them to be commuting.. What we\u2019ll discover is that the cannot differentiate between and other for any permutation of the letters in the word . B.4.1 Diagonal Expansion for\n\nProposition B.13. For any choice of and , writing , the unique solution to\n\nd \u200b Z t X = \u2211 i = 1 d \u03c9 A i \u200b Z t X \u200b d \u200b \u03c9 t X , i + B \u200b d \u200b \u03be t X \ud835\udc51 subscript superscript \ud835\udc4d X \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 \\displaystyle dZ^{\\text{X}}_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+Bd\\xi^{\\text{X}}_{t} (61) Z 0 X = C \u200b X 0 \u2208 \u211d N subscript superscript \ud835\udc4d X 0 \ud835\udc36 subscript \ud835\udc4b 0 superscript \u211d \ud835\udc41 \\displaystyle Z^{\\text{X}}_{0}=CX_{0}\\in\\mathbb{R}^{N}\n\nis given by\n\nZ t X = e diag \u2061 ( V \u200b \u03c9 t X ) \u200b C \u200b X 0 + \u222b 0 t e diag \u2061 ( V \u200b ( \u03c9 t X \u2212 \u03c9 s X ) ) \u200b B \u200b \ud835\udc51 \u03be s X subscript superscript \ud835\udc4d X \ud835\udc61 superscript \ud835\udc52 diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udc36 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 superscript \ud835\udc52 diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc35 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 Z^{\\text{X}}_{t}=e^{\\operatorname{diag}(V\\omega^{\\text{X}}_{t})}CX_{0}+\\int_{0}^{t}e^{\\operatorname{diag}(V(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s}))}Bd\\xi^{\\text{X}}_{s} (62)\n\nwhich can be expanded as\n\nZ t X = subscript superscript \ud835\udc4d X \ud835\udc61 absent \\displaystyle Z^{\\text{X}}_{t}= \u2211 i = 1 d 0 \u2211 I \u2208 \ud835\udd4e d \u03c9 A I s \u200b y \u200b m \u200b C i \u200b X 0 i \u200b Sig \u200b ( \u03c9 X ) 0 , t s \u200b y \u200b m , I + \u2211 j = 1 d \u03be \u2211 I \u2208 \ud835\udd4e d \u03c9 A I s \u200b y \u200b m \u200b B j \u200b \u222b 0 t Sig \u200b ( \u03c9 X ) s , t s \u200b y \u200b m , I \u200b \ud835\udc51 \u03be s X , j \u2208 \u211d N superscript subscript \ud835\udc56 1 subscript \ud835\udc51 0 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript superscript \ud835\udc34 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c subscript \ud835\udc36 \ud835\udc56 superscript subscript \ud835\udc4b 0 \ud835\udc56 Sig superscript subscript superscript \ud835\udf14 X 0 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c superscript subscript \ud835\udc57 1 subscript \ud835\udc51 \ud835\udf09 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript superscript \ud835\udc34 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c subscript \ud835\udc35 \ud835\udc57 superscript subscript 0 \ud835\udc61 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript \u211d \ud835\udc41 \\displaystyle\\sum_{i=1}^{d_{0}}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A^{sym}_{I}C_{i}~{}X_{0}^{i}\\text{Sig}(\\omega^{\\text{X}})_{0,t}^{sym,I}+\\sum_{j=1}^{d_{\\xi}}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A^{sym}_{I}B_{j}\\int_{0}^{t}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{sym,I}d\\xi^{\\text{X},j}_{s}\\in\\mathbb{R}^{N} (63)\n\nwhere\n\nA I s \u200b y \u200b m := 1 | I | !",
    "theoryssms-39": "\u200b \u2211 \u03c3 \u2208 S k A \u03c3 \u200b ( I ) = A I Sig \u200b ( \u03c9 X ) s , t s \u200b y \u200b m , I := 1 | I | ! \u200b \u2211 \u03c3 \u2208 S k Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) . formulae-sequence assign subscript superscript \ud835\udc34 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c 1 \ud835\udc3c subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 subscript \ud835\udc34 \ud835\udf0e \ud835\udc3c subscript \ud835\udc34 \ud835\udc3c assign Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c 1 \ud835\udc3c subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c A^{sym}_{I}:=\\frac{1}{|I|!}\\sum_{\\sigma\\in S_{k}}A_{\\sigma(I)}=A_{I}\\quad\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{sym,I}:=\\frac{1}{|I|!}\\sum_{\\sigma\\in S_{k}}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}. (64)\n\nProof. By Theorem E.1 and Theorem E.6 we know that the solution of\n\nZ t X = Z 0 X + \u2211 i = 1 d \u03c9 \u222b 0 t A i \u200b Z t X \u200b \ud835\udc51 \u03c9 t X , i + \u222b 0 t B \u200b \ud835\udc51 \u03be t X subscript superscript \ud835\udc4d X \ud835\udc61 subscript superscript \ud835\udc4d X 0 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript 0 \ud835\udc61 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4d X \ud835\udc61 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 superscript subscript 0 \ud835\udc61 \ud835\udc35 differential-d subscript superscript \ud835\udf09 X \ud835\udc61 Z^{\\text{X}}_{t}=Z^{\\text{X}}_{0}+\\sum_{i=1}^{d_{\\omega}}\\int_{0}^{t}A_{i}Z^{\\text{X}}_{t}d\\omega^{\\text{X},i}_{t}+\\int_{0}^{t}Bd\\xi^{\\text{X}}_{t} (65)\n\nis explicitly given by\n\nZ t X = W 0 , t X \u200b Z 0 X + \u222b 0 t W s , t X \u200b B \u200b \ud835\udc51 \u03be s X superscript subscript \ud835\udc4d \ud835\udc61 X subscript superscript \ud835\udc4a X 0 \ud835\udc61 subscript superscript \ud835\udc4d X 0 superscript subscript 0 \ud835\udc61 subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 \ud835\udc35 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 Z_{t}^{\\text{X}}=W^{\\text{X}}_{0,t}Z^{\\text{X}}_{0}+\\int_{0}^{t}W^{\\text{X}}_{s,t}Bd\\xi^{\\text{X}}_{s} (66)\n\nwhere is the unique solution to\n\nW s , t X = I \u200b d + \u2211 i = 1 d \u03c9 \u222b s t A i \u200b W s , r X \u200b \ud835\udc51 \u03c9 r X , i subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 \ud835\udc3c \ud835\udc51 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc60 \ud835\udc61 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc5f differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f W^{\\text{X}}_{s,t}=Id+\\sum_{i=1}^{d_{\\omega}}\\int_{s}^{t}A_{i}W^{\\text{X}}_{s,r}d\\omega^{\\text{X},i}_{r} (67)\n\nIn case the s are commuting matrices one can explicitly write the solution as\n\nW s , t X = exp \u2061 ( \u2211 i = 1 d \u03c9 \u222b s t A i \u200b \ud835\udc51 \u03c9 r X , i ) = exp \u2061 ( diag \u2061 ( V \u200b ( \u03c9 t X \u2212 \u03c9 s X ) ) ) subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc60 \ud835\udc61 subscript \ud835\udc34 \ud835\udc56 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 W^{\\text{X}}_{s,t}=\\exp{\\left(\\sum_{i=1}^{d_{\\omega}}\\int_{s}^{t}A_{i}d\\omega^{\\text{X},i}_{r}\\right)}=\\exp{\\left(\\operatorname{diag}(V(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s}))\\right)} (68)\n\nsince for fixed one has, using commutativity, that\n\nd \u200b W s , t X = W s , t X \u200b ( \u2211 i = 1 d \u03c9 A i \u200b d \u200b \u03c9 t X , i ) = \u2211 i = 1 d \u03c9 A i \u200b W s , t X \u200b d \u200b \u03c9 t X , i \ud835\udc51 subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 dW^{\\text{X}}_{s,t}=W^{\\text{X}}_{s,t}\\left(\\sum_{i=1}^{d_{\\omega}}A_{i}d\\omega^{\\text{X},i}_{t}\\right)=\\sum_{i=1}^{d_{\\omega}}A_{i}W^{\\text{X}}_{s,t}d\\omega^{\\text{X},i}_{t}\n\nOn the other hand we know, Theorem E.2, that\n\nW s , t X = \u2211 I \u2208 \ud835\udd4e d \u03c9 A I \u200b Sig \u200b ( \u03c9 X ) s , t I = \u2211 k = 0 \u221e \u2211 I \u2208 \ud835\udd4e d \u03c9 k A I \u200b Sig \u200b ( \u03c9 X ) s , t I subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc3c Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c superscript subscript \ud835\udc58 0 subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c W^{\\text{X}}_{s,t}=\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}=\\sum_{k=0}^{\\infty}\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}A_{I}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I} (69)\n\nThe two views are reconciled by noticing that the symmetric group acts on , the space of words of lenth , by permuting the letters and, by commutativity,\n\n\u2200 \u03c3 \u2208 S k . \u2200 I \u2208 \ud835\udd4e d \u03c9 k . A I = A \u03c3 \u200b ( I ) formulae-sequence for-all \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 for-all \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c subscript \ud835\udc34 \ud835\udf0e \ud835\udc3c \\forall\\sigma\\in S_{k}.\\forall I\\in\\mathbb{W}_{d_{\\omega}}^{k}.\\hskip 5.0ptA_{I}=A_{\\sigma(I)}\n\nThen we have\n\n\u2211 I \u2208 \ud835\udd4e d \u03c9 k A I \u200b Sig \u200b ( \u03c9 X ) s , t I = subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c absent \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}A_{I}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}= \u2211 I \u2208 \ud835\udd4e d \u03c9 k 1 k ! \u200b \u2211 \u03c3 \u2208 S k A \u03c3 \u200b ( I ) \u200b Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) = \u2211 I \u2208 \ud835\udd4e d \u03c9 k A I k ! \u200b \u2211 \u03c3 \u2208 S k Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 1 \ud835\udc58 subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 subscript \ud835\udc34 \ud835\udf0e \ud835\udc3c Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c \ud835\udc58 subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}\\frac{1}{k!}\\sum_{\\sigma\\in S_{k}}A_{\\sigma(I)}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}=\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}\\frac{A_{I}}{k!}\\sum_{\\sigma\\in S_{k}}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}\n\nrecalling then how we get to\n\n\u2211 I \u2208 \ud835\udd4e d \u03c9 k A I \u200b Sig \u200b ( \u03c9 X ) s , t I = subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc3c absent \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}A_{I}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{I}= \u2211 I \u2208 \ud835\udd4e d \u03c9 k A I k ! \u200b \u2211 \u03c3 \u2208 S k Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) = \u2211 I \u2208 \ud835\udd4e d \u03c9 k A I k ! \u200b \u220f i = 1 k Sig \u200b ( \u03c9 X ) s , t I i subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c \ud835\udc58 subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 subscript \ud835\udc34 \ud835\udc3c \ud835\udc58 superscript subscript product \ud835\udc56 1 \ud835\udc58 Sig subscript superscript superscript \ud835\udf14 X subscript \ud835\udc3c \ud835\udc56 \ud835\udc60 \ud835\udc61 \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}\\frac{A_{I}}{k!}\\sum_{\\sigma\\in S_{k}}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}=\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}\\frac{A_{I}}{k!}\\prod_{i=1}^{k}\\text{Sig}(\\omega^{\\text{X}})^{I_{i}}_{s,t} = \\displaystyle= \u2211 I \u2208 \ud835\udd4e d \u03c9 k 1 k ! \u200b \u220f i = 1 k A I i \u200b Sig \u200b ( \u03c9 X ) s , t I i = 1 k ! \u200b ( \u2211 i = 1 d \u03c9 A i \u200b Sig \u200b ( \u03c9 X ) s , t i ) k = 1 k ! \u200b ( \u2211 i = 1 d \u03c9 \u222b s t A i \u200b \ud835\udc51 \u03c9 r X , i ) k subscript \ud835\udc3c superscript subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 \ud835\udc58 1 \ud835\udc58 superscript subscript product \ud835\udc56 1 \ud835\udc58 subscript \ud835\udc34 subscript \ud835\udc3c \ud835\udc56 Sig subscript superscript superscript \ud835\udf14 X subscript \ud835\udc3c \ud835\udc56 \ud835\udc60 \ud835\udc61 1 \ud835\udc58 superscript superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 Sig subscript superscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 \ud835\udc61 \ud835\udc58 1 \ud835\udc58 superscript superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc60 \ud835\udc61 subscript \ud835\udc34 \ud835\udc56 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f \ud835\udc58 \\displaystyle\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}^{k}}\\frac{1}{k!}\\prod_{i=1}^{k}A_{I_{i}}\\text{Sig}(\\omega^{\\text{X}})^{I_{i}}_{s,t}=\\frac{1}{k!}\\left(\\sum_{i=1}^{d_{\\omega}}A_{i}\\text{Sig}(\\omega^{\\text{X}})^{i}_{s,t}\\right)^{k}=\\frac{1}{k!}\\left(\\sum_{i=1}^{d_{\\omega}}\\int_{s}^{t}A_{i}d\\omega^{\\text{X},i}_{r}\\right)^{k}\n\nIn particular we see how in the commuting case\n\nW s , t X = \u2211 I \u2208 \ud835\udd4e d \u03c9 A I s \u200b y \u200b m \u200b Sig \u200b ( \u03c9 X ) s , t s \u200b y \u200b m , I subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 subscript \ud835\udc3c subscript \ud835\udd4e subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc34 \ud835\udc3c \ud835\udc60 \ud835\udc66 \ud835\udc5a Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c W^{\\text{X}}_{s,t}=\\sum_{I\\in\\mathbb{W}_{d_{\\omega}}}A_{I}^{sym}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{sym,I} (70)\n\nwhere\n\nA I s \u200b y \u200b m := 1 | I | ! \u200b \u2211 \u03c3 \u2208 S k A \u03c3 \u200b ( I ) = A I Sig \u200b ( \u03c9 X ) s , t s \u200b y \u200b m , I := 1 | I | ! \u200b \u2211 \u03c3 \u2208 S k Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) . formulae-sequence assign subscript superscript \ud835\udc34 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c 1 \ud835\udc3c subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 subscript \ud835\udc34 \ud835\udf0e \ud835\udc3c subscript \ud835\udc34 \ud835\udc3c assign Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c 1 \ud835\udc3c subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c A^{sym}_{I}:=\\frac{1}{|I|!}\\sum_{\\sigma\\in S_{k}}A_{\\sigma(I)}=A_{I}\\quad\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{sym,I}:=\\frac{1}{|I|!}\\sum_{\\sigma\\in S_{k}}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}. B.4.2 Diagonal Expressiveness\n\nTheorem B.14. Fix a compact input set and continuous gates . For any and any\n\nF \u2208 { ( X , t ) \u21a6 \u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X } \ud835\udc39 maps-to \ud835\udc4b \ud835\udc61 \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 F\\in\\left\\{(X,t)\\mapsto\\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\\right\\} (71)\n\nfor and , there exist a choice of hidden dimension and parameters and diagonal such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | F \u200b ( X , t ) \u2212 \u27e8 v , Z t X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc39 \ud835\udc4b \ud835\udc61 \ud835\udc63 subscript superscript \ud835\udc4d X \ud835\udc61 italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|F(X,t)-\\langle v,Z^{\\text{X}}_{t}\\rangle|\\leq\\epsilon (72)\n\nMoreover the \u201dreverse\u201d also holds i.e. given any choice of matrices there is an -close map in the family. Proof. This is just a repetition of the arguments used for the dense case with little more care to get the uniformity in time. One defines the subset of those of type (41) defined by such that for any word and any permutation of it\n\n\u03b1 i I = \u03b1 i \u03c3 \u200b ( I ) \u03b2 j I = \u03b2 j \u03c3 \u200b ( I ) formulae-sequence superscript subscript \ud835\udefc \ud835\udc56 \ud835\udc3c superscript subscript \ud835\udefc \ud835\udc56 \ud835\udf0e \ud835\udc3c superscript subscript \ud835\udefd \ud835\udc57 \ud835\udc3c superscript subscript \ud835\udefd \ud835\udc57 \ud835\udf0e \ud835\udc3c \\alpha_{i}^{I}=\\alpha_{i}^{\\sigma(I)}\\quad\\beta_{j}^{I}=\\beta_{j}^{\\sigma(I)} (73)\n\nThe same argument of Proposition B.10 shows that the uniform closure of the space of linear maps on the is contained in the uniform closure of , and the same bounds show that this latter closure is the same as that of its subset composed of those having entries eventually equal to . Since\n\nSig \u200b ( \u03c9 X ) s , t s \u200b y \u200b m , I := 1 | I | ! \u200b \u2211 \u03c3 \u2208 S k Sig \u200b ( \u03c9 X ) s , t \u03c3 \u200b ( I ) = 1 | I | ! \u200b \u220f i = 1 | I | ( \u03c9 t X , I i \u2212 \u03c9 s X , I i ) , assign Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udc60 \ud835\udc66 \ud835\udc5a \ud835\udc3c 1 \ud835\udc3c subscript \ud835\udf0e subscript \ud835\udc46 \ud835\udc58 Sig superscript subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc61 \ud835\udf0e \ud835\udc3c 1 \ud835\udc3c superscript subscript product \ud835\udc56 1 \ud835\udc3c subscript superscript \ud835\udf14 X subscript \ud835\udc3c \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf14 X subscript \ud835\udc3c \ud835\udc56 \ud835\udc60 \\text{Sig}(\\omega^{\\text{X}})_{s,t}^{sym,I}:=\\frac{1}{|I|!}\\sum_{\\sigma\\in S_{k}}\\text{Sig}(\\omega^{\\text{X}})_{s,t}^{\\sigma(I)}=\\frac{1}{|I|!}\\prod_{i=1}^{|I|}(\\omega^{\\text{X},I_{i}}_{t}-\\omega^{\\text{X},I_{i}}_{s}),\n\nsuch maps can be expressed exactly in the form\n\nP \u200b ( \u03c9 t X ) \u22c5 X 0 + \u222b 0 t Q \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X \u22c5 \ud835\udc43 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 \ud835\udc44 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 P(\\omega^{\\text{X}}_{t})\\cdot X_{0}+\\int_{0}^{t}Q(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\n\nfor polynomial maps fixed in time. The usual compactness and continuity argument, together with an application of Stone-Weiestrass, thus proves that the uniform closure of has the form needed. The final ingredient is the density of the space of linear maps on the in ; this is another consequence of Stone-Weiestrass as seen from Proposition B.17. \u220e\n\nRemark B.15. Notice how here there is no need to augment the paths in creative ways in order to ensure separability of the points. The map is replaced by and the space of polynomials always separates points in .",
    "theoryssms-40": "Remark B.16. It is not necessary to pass trough to prove the previous result, since it directly follows from Proposition B.17. This choice of presentation has been motivated by the conviction of the usefulness of drawing parallels and comparisons. Proposition B.17. Fix a compact set and a -dimensional convex cone containing the origin. The space\n\n\u2130 := S p a n ( \ud835\udd42 \u220b x \u21a6 e \u27e8 \u03b1 , x \u27e9 \u211d d \u2208 \u211d : \u03b1 \u2208 C ) \\mathcal{E}:=Span\\left(\\mathbb{K}\\ni x\\mapsto e^{\\langle\\alpha,x\\rangle_{\\mathbb{R}^{d}}}\\in\\mathbb{R}:\\alpha\\in C\\right)\n\nis uniformly dense in . Proof. This is an application of Stone-Weiestrass: is a sub-algebra since\n\ne \u27e8 \u03b1 , x \u27e9 \u200b e \u27e8 \u03b2 , x \u27e9 \u211d d = e \u27e8 \u03b1 + \u03b2 , x \u27e9 \u211d d superscript \ud835\udc52 \ud835\udefc \ud835\udc65 superscript \ud835\udc52 subscript \ud835\udefd \ud835\udc65 superscript \u211d \ud835\udc51 superscript \ud835\udc52 subscript \ud835\udefc \ud835\udefd \ud835\udc65 superscript \u211d \ud835\udc51 e^{\\langle\\alpha,x\\rangle}e^{\\langle\\beta,x\\rangle_{\\mathbb{R}^{d}}}=e^{\\langle\\alpha+\\beta,x\\rangle_{\\mathbb{R}^{d}}}\n\nand by convexity of the cone; contains the constant function and is clearly point separating since the cone, being -dimensional, it contains a basis of the whole space. \u220e\n\nRemark B.18. The usefulness of stating the previous result in such a general setting is the following: with this formalism we can, for example, restrict to , in this way we would have a method to control the stability (cf. Appendix C.1) of the linear CDEs by choosing the gate with a.s. . Appendix C Stability and Chaining of Diagonal Systems\n\nFor this section consider, unless otherwise stated, a fixed , compact and gates . We will study the stability and chaining of diagonal systems defined by the choice of a matrix such that , where . Note that the present discussion holds even for non-diagonal but commuting matrices, since these can be simultaneously diagonalized (at the cost of considering the complex plane). C.1 Stability\n\nHere we explore the stability of the dynamical system , thus we need to study the eigenvalues of the . Recall how in this setting\n\nW s , t X = exp \u2061 ( \u2211 i = 1 d \u03c9 \u222b s t A i \u200b \ud835\udc51 \u03c9 r X , i ) = exp \u2061 ( diag \u2061 ( \u222b s t V \u200b \ud835\udc51 \u03c9 r X ) ) = exp \u2061 ( diag \u2061 ( V \u200b ( \u03c9 t X \u2212 \u03c9 s X ) ) ) subscript superscript \ud835\udc4a X \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 superscript subscript \ud835\udc60 \ud835\udc61 subscript \ud835\udc34 \ud835\udc56 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f diag superscript subscript \ud835\udc60 \ud835\udc61 \ud835\udc49 differential-d subscript superscript \ud835\udf14 X \ud835\udc5f diag \ud835\udc49 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 W^{\\text{X}}_{s,t}=\\exp{\\left(\\sum_{i=1}^{d_{\\omega}}\\int_{s}^{t}A_{i}d\\omega^{\\text{X},i}_{r}\\right)}=\\exp{\\left(\\operatorname{diag}(\\int_{s}^{t}Vd\\omega^{\\text{X}}_{r})\\right)}=\\exp{\\left(\\operatorname{diag}\\big{(}V(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\big{)}\\right)} (74)\n\nNote that because is continuous and of bounded variation, it can be reparameterised to be Lipschitz continuous, hence absolutely continuous. Thus we can assume that is almost everywhere differentiable and its derivative . The stability of the dynamical system then depends on the alignment between and the singular vectors of . If for all times, where the inequality is coordinate-wise, then has eigenvalues all in thus the system is stable making training easier (Orvieto et al., 2023b). Consider the singular value decomposition (SVD) of the matrix\n\nV = \u2211 k = 1 K \u03c3 k \u200b v k \u200b u k \u22a4 \ud835\udc49 superscript subscript \ud835\udc58 1 \ud835\udc3e subscript \ud835\udf0e \ud835\udc58 subscript \ud835\udc63 \ud835\udc58 superscript subscript \ud835\udc62 \ud835\udc58 top V=\\sum_{k=1}^{K}\\sigma_{k}~{}v_{k}u_{k}^{\\top} (75)\n\nThen, a sufficient condition for stability is that for any\n\n0 > \u03c3 k \u2208 \u211d , 0 \u2264 v k \u2208 \u211d N , and \u27e8 u k , \u03c9 \u02d9 t X \u27e9 \u2265 0 \u200b for any \u200b t \u2208 [ 0 , T ] . formulae-sequence 0 subscript \ud835\udf0e \ud835\udc58 \u211d 0 subscript \ud835\udc63 \ud835\udc58 superscript \u211d \ud835\udc41 and subscript \ud835\udc62 \ud835\udc58 subscript superscript \u02d9 \ud835\udf14 X \ud835\udc61 0 for any \ud835\udc61 0 \ud835\udc47 \\displaystyle 0>\\sigma_{k}\\in\\mathbb{R},\\quad 0\\leq v_{k}\\in\\mathbb{R}^{N},\\quad\\text{and}\\quad\\langle u_{k},\\dot{\\omega}^{\\text{X}}_{t}\\rangle\\geq 0\\ \\text{ for any }t\\in[0,T]. (76)\n\nC.1.1 The case of Mamba\n\nIn the case of Mamba (Gu & Dao, 2023) the matrices are diagonal and\n\nd \u200b \u03c9 t X = s \u200b o \u200b f \u200b t \u200b p \u200b l \u200b u \u200b s \u200b ( W \u200b x t + \u03bb ) \u200b d \u200b t , d \u200b \u03be t X = x t \u2299 d \u200b \u03c9 t X , formulae-sequence \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc61 \ud835\udc60 \ud835\udc5c \ud835\udc53 \ud835\udc61 \ud835\udc5d \ud835\udc59 \ud835\udc62 \ud835\udc60 \ud835\udc4a subscript \ud835\udc65 \ud835\udc61 \ud835\udf06 \ud835\udc51 \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc61 direct-product subscript \ud835\udc65 \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 X \ud835\udc61 d\\omega^{\\text{X}}_{t}=softplus(Wx_{t}+\\lambda)dt,\\quad d\\xi^{\\text{X}}_{t}=x_{t}\\odot d\\omega^{\\text{X}}_{t},\n\nmoreover the proposed choices of are all of type\n\nV = \u2212 \ud835\udc2f \u2297 \ud835\udfcf d \u03c9 \ud835\udc49 tensor-product \ud835\udc2f subscript 1 subscript \ud835\udc51 \ud835\udf14 V=-\\mathbf{v}\\otimes\\boldsymbol{1}_{d_{\\omega}}\n\nfor some choice of . Note that is just a smooth approximation of and that hence mamba is implicitly ensuring that the dynamical system is approximately always well-conditioned. C.2 Chaining\n\nThe diagonal case differs from the general one not only in the fact that the class of approximable functions is much weaker but also in the necessity for the presence of in order to obtain any path-dependence. The term\n\n\u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\n\nbecomes then a crucial component. At first sight one might think that such a term allows to recover at least level two components of the Signature of , unfortunately things are not as easy as they may seem. Notice how inside of the integral time is \u201dgoing backwards\u201d from the perspective of , thus we can in general approximate terms of type\n\n\u222b 0 t \u222b s t \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j = \u222b 1 \u2212 t 1 \u222b 1 \u2212 t r \ud835\udc51 \u03c9 \u2190 r X , i \u200b \ud835\udc51 \u03be \u2190 s X , j = Sig \u200b ( ( \u03c9 \u2190 X , \u03be \u2190 X ) ) 1 \u2212 t , 1 i \u03c9 \u200b j \u03be superscript subscript 0 \ud835\udc61 superscript subscript \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript subscript 1 \ud835\udc61 1 superscript subscript 1 \ud835\udc61 \ud835\udc5f differential-d subscript superscript \u2190 \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \u2190 \ud835\udf09 X \ud835\udc57 \ud835\udc60 Sig subscript superscript superscript \u2190 \ud835\udf14 X superscript \u2190 \ud835\udf09 X subscript \ud835\udc56 \ud835\udf14 subscript \ud835\udc57 \ud835\udf09 1 \ud835\udc61 1 \\int_{0}^{t}\\int_{s}^{t}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}=\\int_{1-t}^{1}\\int_{1-t}^{r}d\\overleftarrow{\\omega}^{\\text{X},i}_{r}d\\overleftarrow{\\xi}^{\\text{X},j}_{s}=\\text{Sig}((\\overleftarrow{\\omega}^{\\text{X}},\\overleftarrow{\\xi}^{\\text{X}}))^{i_{\\omega}j_{\\xi}}_{1-t,1}\n\nwhich are indeed terms of the Signature, but of the reverse paths and ! Proposition C.1. Fix a compact input set , continuous gates and . If the components of are linear combinations of those of , with time-independent weights, then linear functionals on can, uniformly in , approximate arbitrarily well the following level terms of :\n\n\u222b 0 t \u222b 0 s \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j = Sig \u200b ( ( \u03c9 X , \u03be X ) ) 0 , t i \u03c9 \u200b j \u03be superscript subscript 0 \ud835\udc61 superscript subscript 0 \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 Sig superscript subscript superscript \ud835\udf14 X superscript \ud835\udf09 X 0 \ud835\udc61 subscript \ud835\udc56 \ud835\udf14 subscript \ud835\udc57 \ud835\udf09 \\int_{0}^{t}\\int_{0}^{s}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}=\\text{Sig}((\\omega^{\\text{X}},\\xi^{\\text{X}}))_{0,t}^{i_{\\omega}j_{\\xi}}\n\nProof. Under these hypotheses we know that linear functionals on are uniformly dense, for continuous , in\n\n{ ( X , t ) \u21a6 \u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X } . maps-to \ud835\udc4b \ud835\udc61 \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\left\\{(X,t)\\mapsto\\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\\right\\}. Assume and consider the choices\n\n\u03c8 \u200b ( x ) = ( x i \u200b \u27e8 \u03b1 j , x \u27e9 , 0 , \u22ef , 0 ) \u22a4 , \u03d5 \u200b ( x ) = \u2212 ( 0 , \u22ef , 0 , x i , 0 , \u22ef , 0 ) . formulae-sequence \ud835\udf13 \ud835\udc65 superscript superscript \ud835\udc65 \ud835\udc56 subscript \ud835\udefc \ud835\udc57 \ud835\udc65 0 \u22ef 0 top italic-\u03d5 \ud835\udc65 0 \u22ef 0 superscript \ud835\udc65 \ud835\udc56 0 \u22ef 0 \\psi(x)=(x^{i}\\langle\\alpha_{j},x\\rangle,0,\\cdots,0)^{\\top},\\quad\\phi(x)=-(0,\\cdots,0,x^{i},0,\\cdots,0). (77)\n\nso that\n\n\u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 = \u03c9 t X , i \u200b \u03be t X , j \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 d \u200b \u03be s X = \u2212 ( \u03c9 t X , i \u2212 \u03c9 s X , i ) \u200b d \u200b \u03be s X , j . formulae-sequence \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc60 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}=\\omega^{\\text{X},i}_{t}\\xi^{\\text{X},j}_{t}\\quad\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}=-(\\omega^{\\text{X},i}_{t}-\\omega^{\\text{X},i}_{s})d\\xi^{\\text{X},j}_{s}. (78)\n\nTo conclude note that\n\n\u03c9 t X , i \u200b \u03be t X , j = subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 absent \\displaystyle\\omega^{\\text{X},i}_{t}\\xi^{\\text{X},j}_{t}= \u222b s = 0 t \u222b r = 0 t \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j = \u222b s = 0 t \u222b r = 0 s \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j + \u222b s = 0 t \u222b r = s t \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j superscript subscript \ud835\udc60 0 \ud835\udc61 superscript subscript \ud835\udc5f 0 \ud835\udc61 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript subscript \ud835\udc60 0 \ud835\udc61 superscript subscript \ud835\udc5f 0 \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript subscript \ud835\udc60 0 \ud835\udc61 superscript subscript \ud835\udc5f \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\int_{s=0}^{t}\\int_{r=0}^{t}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}=\\int_{s=0}^{t}\\int_{r=0}^{s}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}+\\int_{s=0}^{t}\\int_{r=s}^{t}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s} = \\displaystyle= \u222b 0 t \u222b 0 s \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j + \u222b s = 0 t ( \u03c9 t X , i \u2212 \u03c9 s X , i ) \u200b \ud835\udc51 \u03be s X , j superscript subscript 0 \ud835\udc61 superscript subscript 0 \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 superscript subscript \ud835\udc60 0 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\displaystyle\\int_{0}^{t}\\int_{0}^{s}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}+\\int_{s=0}^{t}(\\omega^{\\text{X},i}_{t}-\\omega^{\\text{X},i}_{s})d\\xi^{\\text{X},j}_{s}\n\nhence\n\n\u222b 0 t \u222b 0 s \ud835\udc51 \u03c9 r X , i \u200b \ud835\udc51 \u03be s X , j = \u03c9 t X , i \u200b \u03be t X , j \u2212 \u222b s = 0 t ( \u03c9 t X , i \u2212 \u03c9 s X , i ) \u200b \ud835\udc51 \u03be s X , j = \u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 + \u222b 0 t \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 \ud835\udc51 \u03be s X superscript subscript 0 \ud835\udc61 superscript subscript 0 \ud835\udc60 differential-d subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc5f differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 superscript subscript \ud835\udc60 0 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc56 \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript 0 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 differential-d subscript superscript \ud835\udf09 X \ud835\udc60 \\int_{0}^{t}\\int_{0}^{s}d\\omega^{\\text{X},i}_{r}d\\xi^{\\text{X},j}_{s}=\\omega^{\\text{X},i}_{t}\\xi^{\\text{X},j}_{t}-\\int_{s=0}^{t}(\\omega^{\\text{X},i}_{t}-\\omega^{\\text{X},i}_{s})d\\xi^{\\text{X},j}_{s}=\\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}+\\int_{0}^{t}\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}\n\nIf we can use the previous result to compute its Signature entries by chaining diagonal linear CDEs.",
    "theoryssms-41": "Theorem C.2. Assume a compact input set . For any with and there is a sequence of linear maps and weights for the following family of chained linear CDEs\n\nd \u200b Z t 1 , X = \u2211 i = 1 d A i ( 1 ) \u200b Z t 1 , X \u200b d \u200b X t i + B ( 1 ) \u200b d \u200b X t \u2208 \u211d N 1 , Z 0 1 , X = Z 0 1 , formulae-sequence \ud835\udc51 superscript subscript \ud835\udc4d \ud835\udc61 1 X superscript subscript \ud835\udc56 1 \ud835\udc51 subscript superscript \ud835\udc34 1 \ud835\udc56 subscript superscript \ud835\udc4d 1 X \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udc4b \ud835\udc56 \ud835\udc61 superscript \ud835\udc35 1 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 superscript \u211d subscript \ud835\udc41 1 subscript superscript \ud835\udc4d 1 X 0 superscript subscript \ud835\udc4d 0 1 \\displaystyle dZ_{t}^{1,\\text{X}}=\\sum_{i=1}^{d}A^{(1)}_{i}Z^{1,\\text{X}}_{t}dX^{i}_{t}+B^{(1)}d{{X}}_{t}\\in\\mathbb{R}^{N_{1}},\\quad Z^{1,\\text{X}}_{0}=Z_{0}^{1}, (79) d \u200b Z t k + 1 , X = \u2211 i = 1 d + 1 A i ( k + 1 ) \u200b Z t k + 1 , X \u200b d \u200b [ W k \u200b Z k , X X ] t i + B ( k + 1 ) \u200b d \u200b X t \u2208 \u211d N k + 1 , Z 0 k + 1 , X = Z 0 k + 1 , formulae-sequence \ud835\udc51 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 1 X superscript subscript \ud835\udc56 1 \ud835\udc51 1 subscript superscript \ud835\udc34 \ud835\udc58 1 \ud835\udc56 subscript superscript \ud835\udc4d \ud835\udc58 1 X \ud835\udc61 \ud835\udc51 subscript superscript matrix subscript \ud835\udc4a \ud835\udc58 superscript \ud835\udc4d \ud835\udc58 X \ud835\udc4b \ud835\udc56 \ud835\udc61 superscript \ud835\udc35 \ud835\udc58 1 \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 superscript \u211d subscript \ud835\udc41 \ud835\udc58 1 subscript superscript \ud835\udc4d \ud835\udc58 1 X 0 superscript subscript \ud835\udc4d 0 \ud835\udc58 1 \\displaystyle dZ_{t}^{k+1,\\text{X}}=\\sum_{i=1}^{d+1}A^{(k+1)}_{i}Z^{k+1,\\text{X}}_{t}d\\begin{bmatrix}W_{k}Z^{k,\\text{X}}\\\\\n{X}\\end{bmatrix}^{i}_{t}+B^{(k+1)}dX_{t}\\in\\mathbb{R}^{N_{k+1}},\\quad Z^{k+1,\\text{X}}_{0}=Z_{0}^{k+1}, (80)\n\nsuch that for some one has\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | S \u200b i \u200b g \u200b ( X ) 0 , t I \u2212 \u27e8 v , Z t | I | \u2212 1 , X \u27e9 | \u2264 \u03f5 subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc46 \ud835\udc56 \ud835\udc54 subscript superscript \ud835\udc4b \ud835\udc3c 0 \ud835\udc61 \ud835\udc63 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc3c 1 X italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|Sig(X)^{I}_{0,t}-\\langle v,Z_{t}^{|I|-1,\\text{X}}\\rangle|\\leq\\epsilon (81)\n\nProof.",
    "theoryssms-42": "For we can apply Prop. C.1. Assume the theorem holds for and let . Fix and such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | S \u200b i \u200b g \u200b ( X ) 0 , t I \u2212 W k \u2212 1 \u200b Z t k \u2212 1 , X | \u2264 \u03f5 M . subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 \ud835\udc46 \ud835\udc56 \ud835\udc54 subscript superscript \ud835\udc4b \ud835\udc3c 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc58 1 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 1 X italic-\u03f5 \ud835\udc40 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|Sig(X)^{I}_{0,t}-W_{k-1}Z_{t}^{k-1,\\text{X}}|\\leq\\frac{\\epsilon}{M}. Again by Prop. C.1 there are a and such that\n\nsup ( X , t ) \u2208 \ud835\udd4f \u00d7 [ 0 , 1 ] | \u222b 0 t W k \u2212 1 \u200b Z s k \u2212 1 , X \u200b \ud835\udc51 X s j \u2212 \u27e8 v , Z t k , X \u27e9 | \u2264 \u03f5 . subscript supremum \ud835\udc4b \ud835\udc61 \ud835\udd4f 0 1 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc58 1 superscript subscript \ud835\udc4d \ud835\udc60 \ud835\udc58 1 X differential-d subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 \ud835\udc63 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 X italic-\u03f5 \\sup\\limits_{(X,t)\\in\\mathbb{X}\\times[0,1]}|\\int_{0}^{t}W_{k-1}Z_{s}^{k-1,\\text{X}}dX^{j}_{s}-\\langle v,Z_{t}^{k,\\text{X}}\\rangle|\\leq\\epsilon. Then\n\n| Sig \u200b ( X ) 0 , t I \u200b j \u2212 \u27e8 v , Z t k , X \u27e9 | \u2264 Sig subscript superscript \ud835\udc4b \ud835\udc3c \ud835\udc57 0 \ud835\udc61 \ud835\udc63 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 X absent \\displaystyle|\\text{Sig}(X)^{Ij}_{0,t}-\\langle v,Z_{t}^{k,\\text{X}}\\rangle|\\leq | \u222b 0 t Sig \u200b ( X ) 0 , s I \u200b \ud835\udc51 X s j \u2212 \u222b 0 t W k \u2212 1 \u200b Z s k \u2212 1 , X \u200b \ud835\udc51 X s j | + | \u222b 0 t W k \u2212 1 \u200b Z s k \u2212 1 , X \u200b \ud835\udc51 X s j \u2212 \u27e8 v , Z t k , X \u27e9 | superscript subscript 0 \ud835\udc61 Sig subscript superscript \ud835\udc4b \ud835\udc3c 0 \ud835\udc60 differential-d subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc58 1 superscript subscript \ud835\udc4d \ud835\udc60 \ud835\udc58 1 X differential-d subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc58 1 superscript subscript \ud835\udc4d \ud835\udc60 \ud835\udc58 1 X differential-d subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 \ud835\udc63 superscript subscript \ud835\udc4d \ud835\udc61 \ud835\udc58 X \\displaystyle|\\int_{0}^{t}\\text{Sig}(X)^{I}_{0,s}dX^{j}_{s}-\\int_{0}^{t}W_{k-1}Z_{s}^{k-1,\\text{X}}dX^{j}_{s}|+|\\int_{0}^{t}W_{k-1}Z_{s}^{k-1,\\text{X}}dX^{j}_{s}-\\langle v,Z_{t}^{k,\\text{X}}\\rangle| \u2264 \\displaystyle\\leq \u222b 0 t | Sig \u200b ( X ) 0 , s I \u2212 W k \u2212 1 \u200b Z s k \u2212 1 , X | \u200b | d \u200b X s j | + \u03f5 superscript subscript 0 \ud835\udc61 Sig subscript superscript \ud835\udc4b \ud835\udc3c 0 \ud835\udc60 subscript \ud835\udc4a \ud835\udc58 1 superscript subscript \ud835\udc4d \ud835\udc60 \ud835\udc58 1 X \ud835\udc51 subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 italic-\u03f5 \\displaystyle\\int_{0}^{t}|\\text{Sig}(X)^{I}_{0,s}-W_{k-1}Z_{s}^{k-1,\\text{X}}||dX^{j}_{s}|+\\epsilon \u2264 \\displaystyle\\leq \u222b 0 t \u03f5 M \u200b | d \u200b X s j | + \u03f5 \u2264 2 \u200b \u03f5 superscript subscript 0 \ud835\udc61 italic-\u03f5 \ud835\udc40 \ud835\udc51 subscript superscript \ud835\udc4b \ud835\udc57 \ud835\udc60 italic-\u03f5 2 italic-\u03f5 \\displaystyle\\int_{0}^{t}\\frac{\\epsilon}{M}|dX^{j}_{s}|+\\epsilon\\leq 2\\epsilon\n\nthus concluding the proof. \u220e\n\nC.2.1 activation choice\n\nModels like Mamba do not only use diagonal matrices but also consider controls of a specific kind:\n\n\u03c9 t X = \u222b 0 t R \u200b e \u200b L \u200b U \u200b ( W \u200b X s + b ) \u200b \ud835\udc51 s subscript superscript \ud835\udf14 X \ud835\udc61 superscript subscript 0 \ud835\udc61 \ud835\udc45 \ud835\udc52 \ud835\udc3f \ud835\udc48 \ud835\udc4a subscript \ud835\udc4b \ud835\udc60 \ud835\udc4f differential-d \ud835\udc60 \\omega^{\\text{X}}_{t}=\\int_{0}^{t}ReLU(WX_{s}+b)ds\n\nThe choice of enforces for all times as seen above, but could, a priori, destroy information about which allows for the recovery, after chaining, of its Signature. Does this choice keep some expressivity? Fortunately almost all of it: since\n\nR \u200b e \u200b L \u200b U \u200b ( x ) \u2212 R \u200b e \u200b L \u200b U \u200b ( \u2212 x ) = x \ud835\udc45 \ud835\udc52 \ud835\udc3f \ud835\udc48 \ud835\udc65 \ud835\udc45 \ud835\udc52 \ud835\udc3f \ud835\udc48 \ud835\udc65 \ud835\udc65 ReLU(x)-ReLU(-x)=x\n\none can choose a linear map which allows to linearly recover\n\n\u03c9 ~ t X = \u222b 0 t X s \u200b \ud835\udc51 s superscript subscript ~ \ud835\udf14 \ud835\udc61 X superscript subscript 0 \ud835\udc61 subscript \ud835\udc4b \ud835\udc60 differential-d \ud835\udc60 \\tilde{\\omega}_{t}^{\\text{X}}=\\int_{0}^{t}X_{s}ds\n\nfrom . By correspondingly modifying the form of and in Eqn. (77) such that\n\n\u03c8 \u200b ( \u03c9 t X ) \u22c5 X 0 = \u03c9 ~ t X , i \u200b \u03be t X , j \u03d5 \u200b ( \u03c9 t X \u2212 \u03c9 s X ) \u22c5 d \u200b \u03be s X = \u2212 ( \u03c9 ~ t X , i \u2212 \u03c9 ~ s X , i ) \u200b d \u200b \u03be s X , j . formulae-sequence \u22c5 \ud835\udf13 subscript superscript \ud835\udf14 X \ud835\udc61 subscript \ud835\udc4b 0 subscript superscript ~ \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc61 \u22c5 italic-\u03d5 subscript superscript \ud835\udf14 X \ud835\udc61 subscript superscript \ud835\udf14 X \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc60 subscript superscript ~ \ud835\udf14 X \ud835\udc56 \ud835\udc61 subscript superscript ~ \ud835\udf14 X \ud835\udc56 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf09 X \ud835\udc57 \ud835\udc60 \\psi(\\omega^{\\text{X}}_{t})\\cdot X_{0}=\\tilde{\\omega}^{\\text{X},i}_{t}\\xi^{\\text{X},j}_{t}\\quad\\phi(\\omega^{\\text{X}}_{t}-\\omega^{\\text{X}}_{s})\\cdot d\\xi^{\\text{X}}_{s}=-(\\tilde{\\omega}^{\\text{X},i}_{t}-\\tilde{\\omega}^{\\text{X},i}_{s})d\\xi^{\\text{X},j}_{s}. (82)\n\none is able, through a similar chaining procedure, to recover arbitrarily deep entries of the Signature of . Appendix D Path-to-Path\n\nDefinition D.1. A map is causal iff for all and paths one has\n\n\u03c9 | [ 0 , t ] = \u03c9 ~ | [ 0 , t ] \u27f9 G \u200b ( \u03c9 , t ) = G \u200b ( \u03c9 ~ , t ) evaluated-at \ud835\udf14 0 \ud835\udc61 evaluated-at ~ \ud835\udf14 0 \ud835\udc61 \ud835\udc3a \ud835\udf14 \ud835\udc61 \ud835\udc3a ~ \ud835\udf14 \ud835\udc61 \\omega|_{[0,t]}=\\tilde{\\omega}|_{[0,t]}\\implies G(\\omega,t)=G(\\tilde{\\omega},t)\n\ni.e. G is causal if it does not look in the future. Proposition D.2. Assume a compact input set , continuous , and . Then for all and all causal there exist an integer , some Feed Forward neural network , and parameters such that\n\nsup X \u2208 \ud835\udd4f sup t \u2208 [ 0 , 1 ] | F \u200b ( Z t X ) \u2212 G \u200b ( \u03c9 X , t ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f subscript supremum \ud835\udc61 0 1 \ud835\udc39 subscript superscript \ud835\udc4d X \ud835\udc61 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc61 italic-\u03f5 \\sup\\limits_{X\\in\\mathbb{X}}\\sup\\limits_{t\\in[0,1]}|F(Z^{\\text{X}}_{t})-G(\\omega^{\\text{X}},t)|<\\epsilon (83)\n\nProof. Fix . By B.7 the space contains all functionals of form\n\n( X , t ) \u21a6 \u27e8 \u03b1 , Sig \u200b ( \u03c9 X ) 0 , t \u27e9 maps-to \ud835\udc4b \ud835\udc61 \ud835\udefc Sig subscript superscript \ud835\udf14 X 0 \ud835\udc61 (X,t)\\mapsto\\langle\\alpha,\\text{Sig}(\\omega^{\\text{X}})_{0,t}\\rangle\n\nthus, by the properties of the signature and by compactness of , for any fixed there is some such that\n\nsup X \u2208 \ud835\udd4f | f \u200b ( X , s 0 ) \u2212 G \u200b ( \u03c9 X , s 0 ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f \ud835\udc53 \ud835\udc4b subscript \ud835\udc60 0 \ud835\udc3a superscript \ud835\udf14 X subscript \ud835\udc60 0 italic-\u03f5 \\sup\\limits_{X\\in\\mathbb{X}}|f(X,s_{0})-G(\\omega^{\\text{X}},s_{0})|<\\epsilon\n\nUsing the fact that and compactness of , we find a finite set of points and such that\n\nsup ( X , s ) \u2208 \ud835\udd4f \u00d7 [ s i \u2212 1 , s i + 1 ] | G \u200b ( \u03c9 X , s ) \u2212 G \u200b ( \u03c9 X , s i ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udc60 \ud835\udd4f subscript \ud835\udc60 \ud835\udc56 1 subscript \ud835\udc60 \ud835\udc56 1 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc60 \ud835\udc3a superscript \ud835\udf14 X subscript \ud835\udc60 \ud835\udc56 italic-\u03f5 \\displaystyle\\sup\\limits_{(X,s)\\in\\mathbb{X}\\times[s_{i-1},s_{i+1}]}|G(\\omega^{\\text{X}},s)-G(\\omega^{\\text{X}},s_{i})|<\\epsilon (84) sup X \u2208 \ud835\udd4f | f i \u200b ( X , s i ) \u2212 G \u200b ( \u03c9 X , s i ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b subscript \ud835\udc60 \ud835\udc56 \ud835\udc3a superscript \ud835\udf14 X subscript \ud835\udc60 \ud835\udc56 italic-\u03f5 \\displaystyle\\sup\\limits_{X\\in\\mathbb{X}}|f_{i}(X,s_{i})-G(\\omega^{\\text{X}},s_{i})|<\\epsilon (85) sup ( X , s ) \u2208 \ud835\udd4f \u00d7 [ s i \u2212 1 , s i + 1 ] | f i \u200b ( X , s ) \u2212 f i \u200b ( X , s i ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udc60 \ud835\udd4f subscript \ud835\udc60 \ud835\udc56 1 subscript \ud835\udc60 \ud835\udc56 1 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b \ud835\udc60 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b subscript \ud835\udc60 \ud835\udc56 italic-\u03f5 \\displaystyle\\sup\\limits_{(X,s)\\in\\mathbb{X}\\times[s_{i-1},s_{i+1}]}|f_{i}(X,s)-f_{i}(X,s_{i})|<\\epsilon (86)\n\nfor . Notice then how for all and\n\n| f i \u200b ( X , s ) \u2212 G \u200b ( \u03c9 X , s ) | \u2264 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b \ud835\udc60 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc60 absent \\displaystyle|f_{i}(X,s)-G(\\omega^{\\text{X}},s)|\\leq | f i \u200b ( X , s ) \u2212 f i \u200b ( X , s i ) | + | f i \u200b ( X , s i ) \u2212 G \u200b ( \u03c9 X , s i ) | + | G \u200b ( \u03c9 X , s i ) \u2212 G \u200b ( \u03c9 X , s ) | \u2264 3 \u200b \u03f5 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b \ud835\udc60 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b subscript \ud835\udc60 \ud835\udc56 subscript \ud835\udc53 \ud835\udc56 \ud835\udc4b subscript \ud835\udc60 \ud835\udc56 \ud835\udc3a superscript \ud835\udf14 X subscript \ud835\udc60 \ud835\udc56 \ud835\udc3a superscript \ud835\udf14 X subscript \ud835\udc60 \ud835\udc56 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc60 3 italic-\u03f5 \\displaystyle~{}|f_{i}(X,s)-f_{i}(X,s_{i})|+|f_{i}(X,s_{i})-G(\\omega^{\\text{X}},s_{i})|+|G(\\omega^{\\text{X}},s_{i})-G(\\omega^{\\text{X}},s)|\\leq~{}3\\epsilon\n\nIt follows that the map linearly interpolating the in time satisfies\n\nsup X \u2208 \ud835\udd4f sup t \u2208 [ 0 , 1 ] | F \u200b ( X ) t \u2212 G \u200b ( \u03c9 X , t ) | < 6 \u200b \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f subscript supremum \ud835\udc61 0 1 \ud835\udc39 subscript \ud835\udc4b \ud835\udc61 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc61 6 italic-\u03f5 \\sup\\limits_{X\\in\\mathbb{X}}\\sup\\limits_{t\\in[0,1]}|F(X)_{t}-G(\\omega^{\\text{X}},t)|<6\\epsilon\n\nTo conclude note that being compact, the take values in a common compact set . There exist then a neural network such that\n\nsup i \u2208 0 , \u2026 , M \u2212 1 sup s \u2208 [ s i , s i + 1 ] | \u03a8 \u200b ( t , z ) \u2212 ( s i + 1 \u2212 s s i + 1 \u2212 s i \u200b z i + s \u2212 s i s i + 1 \u2212 s i \u200b z i + 1 ) | < \u03f5 subscript supremum \ud835\udc56 0 \u2026 \ud835\udc40 1 subscript supremum \ud835\udc60 subscript \ud835\udc60 \ud835\udc56 subscript \ud835\udc60 \ud835\udc56 1 \u03a8 \ud835\udc61 \ud835\udc67 subscript \ud835\udc60 \ud835\udc56 1 \ud835\udc60 subscript \ud835\udc60 \ud835\udc56 1 subscript \ud835\udc60 \ud835\udc56 subscript \ud835\udc67 \ud835\udc56 \ud835\udc60 subscript \ud835\udc60 \ud835\udc56 subscript \ud835\udc60 \ud835\udc56 1 subscript \ud835\udc60 \ud835\udc56 subscript \ud835\udc67 \ud835\udc56 1 italic-\u03f5 \\sup\\limits_{i\\in 0,\\dots,M-1}\\sup\\limits_{s\\in[s_{i},s_{i+1}]}|\\Psi(t,z)-\\left(\\frac{s_{i+1}-s}{s_{i+1}-s_{i}}z_{i}+\\frac{s-s_{i}}{s_{i+1}-s_{i}}z_{i+1}\\right)|<\\epsilon\n\nwhich means that\n\nsup X \u2208 \ud835\udd4f sup t \u2208 [ 0 , 1 ] | \u03a8 \u200b ( t , f 0 \u200b ( X , t ) , \u2026 , f M \u200b ( X , t ) ) \u2212 F \u200b ( X , t ) | < \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f subscript supremum \ud835\udc61 0 1 \u03a8 \ud835\udc61 subscript \ud835\udc53 0 \ud835\udc4b \ud835\udc61 \u2026 subscript \ud835\udc53 \ud835\udc40 \ud835\udc4b \ud835\udc61 \ud835\udc39 \ud835\udc4b \ud835\udc61 italic-\u03f5 \\sup\\limits_{X\\in\\mathbb{X}}\\sup\\limits_{t\\in[0,1]}|\\Psi(t,f_{0}(X,t),\\dots,f_{M}(X,t))-F(X,t)|<\\epsilon\n\nRecalling that we get that so that, given density of linear maps on in the space, can be uniformly approximated. Triangular inequality gives finally\n\nsup X \u2208 \ud835\udd4f sup t \u2208 [ 0 , 1 ] | \u03a8 \u200b ( t , f 0 \u200b ( X , t ) , \u2026 , f M \u200b ( X , t ) ) \u2212 G \u200b ( \u03c9 X , t ) | < 7 \u200b \u03f5 subscript supremum \ud835\udc4b \ud835\udd4f subscript supremum \ud835\udc61 0 1 \u03a8 \ud835\udc61 subscript \ud835\udc53 0 \ud835\udc4b \ud835\udc61 \u2026 subscript \ud835\udc53 \ud835\udc40 \ud835\udc4b \ud835\udc61 \ud835\udc3a superscript \ud835\udf14 X \ud835\udc61 7 italic-\u03f5 \\sup\\limits_{X\\in\\mathbb{X}}\\sup\\limits_{t\\in[0,1]}|\\Psi(t,f_{0}(X,t),\\dots,f_{M}(X,t))-G(\\omega^{\\text{X}},t)|<7\\epsilon\n\nwhich, by arbitrariness of , gives the thesis. \u220e\n\nThe non-linearity is crucial for the path-to-path result. A map of type cannot be approximated arbitrarily well by . In any case, note that in the proof the role of the neural network is only that of interpolating the RKHS elements in the right order and at the right time. All the non-linear complexity of learning the particular is offloaded and taken care of by the RKHS elements. Remark D.3. In the proof we have only considered the part of concerning , but depends linearly on and suggesting that neural networks on have stronger generalization properties. In fact one can prove that it is possible to approximate all continuous , this is done by reconstructing and as in the classical SSM case cf. (Orvieto et al., 2023a). Appendix E Wronskian Matrix Theory\n\nIn this section we obtain a unified theory studying the solutions to general linear CDEs. The results presented here are not new and can be found in different terms in the literature (Friz & Victoir, 2010), despite this we have decided to reproduce them from scratch for completeness, notational reasons and to present a self-contained theory. Theorem E.1. For any choice and there exist a unique map solving the following CDE\n\nW s , t = I \u200b d N + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b W s , \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4a \ud835\udc60 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f W_{s,t}=Id_{N}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}W_{s,\\tau}d\\omega^{i}_{\\tau} (87)\n\nProof. We will use Banach fixed point theorem leveraging the completeness of the space with the uniform norm\n\n\u2225 X \u2225 \u221e := sup s , t \u2208 [ 0 , 1 ] \u2225 X s , t \u2225 o \u200b p assign subscript delimited-\u2225\u2225 \ud835\udc4b subscript supremum \ud835\udc60 \ud835\udc61 0 1 subscript delimited-\u2225\u2225 subscript \ud835\udc4b \ud835\udc60 \ud835\udc61 \ud835\udc5c \ud835\udc5d \\left\\lVert X\\right\\rVert_{\\infty}:=\\sup_{s,t\\in[0,1]}\\left\\lVert X_{s,t}\\right\\rVert_{op}\n\nDefine the map as\n\n\u0393 \u200b ( X ) s , t = I \u200b d N + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b X s , \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i \u0393 subscript \ud835\udc4b \ud835\udc60 \ud835\udc61 \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4b \ud835\udc60 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\Gamma(X)_{s,t}=Id_{N}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}X_{s,\\tau}d\\omega^{i}_{\\tau}\n\nOne has, for and setting , that\n\n\u0393 k + 1 \u200b ( X ) s , t \u2212 \u0393 k + 1 \u200b ( Y ) s , t = \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b ( \u0393 k \u200b ( X ) s , \u03c4 \u2212 \u0393 k \u200b ( Y ) s , \u03c4 ) \u200b \ud835\udc51 \u03c9 \u03c4 i superscript \u0393 \ud835\udc58 1 subscript \ud835\udc4b \ud835\udc60 \ud835\udc61 superscript \u0393 \ud835\udc58 1 subscript \ud835\udc4c \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 superscript \u0393 \ud835\udc58 subscript \ud835\udc4b \ud835\udc60 \ud835\udf0f superscript \u0393 \ud835\udc58 subscript \ud835\udc4c \ud835\udc60 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\Gamma^{k+1}(X)_{s,t}-\\Gamma^{k+1}(Y)_{s,t}=\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}\\left(\\Gamma^{k}(X)_{s,\\tau}-\\Gamma^{k}(Y)_{s,\\tau}\\right)d\\omega^{i}_{\\tau}\n\nwhich iterated gives\n\n\u0393 k + 1 \u200b ( X ) s , t \u2212 \u0393 k + 1 \u200b ( Y ) s , t = superscript \u0393 \ud835\udc58 1 subscript \ud835\udc4b \ud835\udc60 \ud835\udc61 superscript \u0393 \ud835\udc58 1 subscript \ud835\udc4c \ud835\udc60 \ud835\udc61 absent \\displaystyle\\Gamma^{k+1}(X)_{s,t}-\\Gamma^{k+1}(Y)_{s,t}= \u2211 I \u2208 \ud835\udcb2 d | I | = k + 1 \u222b \u03c4 k + 1 = s t \u22ef \u200b \u222b \u03c4 1 = s \u03c4 2 ( \u220f j = k + 1 1 A \u03c4 j I j ) \u200b ( X s , \u03c4 1 \u2212 Z s , \u03c4 1 ) \u200b \u220f j = 1 k + 1 d \u200b \u03c9 \u03c4 j I j subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 \ud835\udc3c \ud835\udc58 1 superscript subscript subscript \ud835\udf0f \ud835\udc58 1 \ud835\udc60 \ud835\udc61 \u22ef superscript subscript subscript \ud835\udf0f 1 \ud835\udc60 subscript \ud835\udf0f 2 superscript subscript product \ud835\udc57 \ud835\udc58 1 1 subscript superscript \ud835\udc34 subscript \ud835\udc3c \ud835\udc57 subscript \ud835\udf0f \ud835\udc57 subscript \ud835\udc4b \ud835\udc60 subscript \ud835\udf0f 1 subscript \ud835\udc4d \ud835\udc60 subscript \ud835\udf0f 1 superscript subscript product \ud835\udc57 1 \ud835\udc58 1 \ud835\udc51 subscript superscript \ud835\udf14 subscript \ud835\udc3c \ud835\udc57 subscript \ud835\udf0f \ud835\udc57 \\displaystyle\\sum_{\\begin{subarray}{c}I\\in\\mathcal{W}_{d}\\\\\n|I|=k+1\\end{subarray}}\\int_{\\tau_{k+1}=s}^{t}\\cdots\\int_{\\tau_{1}=s}^{\\tau_{2}}\\left(\\prod_{j=k+1}^{1}A^{I_{j}}_{\\tau_{j}}\\right)\\left(X_{s,\\tau_{1}}-Z_{s,\\tau_{1}}\\right)\\prod_{j=1}^{k+1}d\\omega^{I_{j}}_{\\tau_{j}} = \\displaystyle= \u2211 I \u2208 \ud835\udcb2 d | I | = k + 1 \u222b \u03c4 \u2208 \u0394 [ s , t ] k + 1 A \u03c4 I \u200b ( X s , \u03c4 1 \u2212 Z s , \u03c4 1 ) \u200b \ud835\udc51 \u03c9 \u03c4 I subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 \ud835\udc3c \ud835\udc58 1 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc58 1 \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f subscript \ud835\udc4b \ud835\udc60 subscript \ud835\udf0f 1 subscript \ud835\udc4d \ud835\udc60 subscript \ud835\udf0f 1 differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f \\displaystyle\\sum_{\\begin{subarray}{c}I\\in\\mathcal{W}_{d}\\\\\n|I|=k+1\\end{subarray}}\\int_{\\tau\\in\\Delta^{k+1}_{[s,t]}}A^{I}_{\\tau}\\left(X_{s,\\tau_{1}}-Z_{s,\\tau_{1}}\\right)d\\omega^{I}_{\\tau}\n\nwhere is the set of words in the alphabet and\n\n\u0394 [ s , t ] k := { ( \u03c4 1 , \u2026 , \u03c4 k ) \u2208 [ 0 , 1 ] k : \u2200 j \u2208 1 , \u2026 , k \u2212 1 . \u03c4 j \u2264 \u03c4 j + 1 } assign subscript superscript \u0394 \ud835\udc58 \ud835\udc60 \ud835\udc61 conditional-set subscript \ud835\udf0f 1 \u2026 subscript \ud835\udf0f \ud835\udc58 superscript 0 1 \ud835\udc58 formulae-sequence for-all \ud835\udc57 1 \u2026 \ud835\udc58 1 subscript \ud835\udf0f \ud835\udc57 subscript \ud835\udf0f \ud835\udc57 1 \\Delta^{k}_{[s,t]}:=\\{(\\tau_{1},\\dots,\\tau_{k})\\in[0,1]^{k}:\\forall j\\in{1,\\dots,k-1}.\\hskip 5.0pt\\tau_{j}\\leq\\tau_{j+1}\\}\n\nA \u03c4 I := \u220f j = k + 1 1 A \u03c4 j I j d \u200b \u03c9 \u03c4 I := \u220f j = 1 k + 1 d \u200b \u03c9 \u03c4 j I j formulae-sequence assign subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f superscript subscript product \ud835\udc57 \ud835\udc58 1 1 subscript superscript \ud835\udc34 subscript \ud835\udc3c \ud835\udc57 subscript \ud835\udf0f \ud835\udc57 assign \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f superscript subscript product \ud835\udc57 1 \ud835\udc58 1 \ud835\udc51 subscript superscript \ud835\udf14 subscript \ud835\udc3c \ud835\udc57 subscript \ud835\udf0f \ud835\udc57 A^{I}_{\\tau}:=\\prod_{j=k+1}^{1}A^{I_{j}}_{\\tau_{j}}\\hskip 10.0ptd\\omega^{I}_{\\tau}:=\\prod_{j=1}^{k+1}d\\omega^{I_{j}}_{\\tau_{j}}\n\nBy defining then one clearly has\n\n\u2225 \u0393 k \u200b ( X ) \u2212 \u0393 k \u200b ( Y ) \u2225 \u221e \u2264 ( d \u200b M \u200b \u2225 \u03c9 \u2225 1 \u2212 v \u200b a \u200b r ) k k ! \u200b \u2225 X \u2212 Y \u2225 \u221e subscript delimited-\u2225\u2225 superscript \u0393 \ud835\udc58 \ud835\udc4b superscript \u0393 \ud835\udc58 \ud835\udc4c superscript \ud835\udc51 \ud835\udc40 subscript delimited-\u2225\u2225 \ud835\udf14 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f \ud835\udc58 \ud835\udc58 subscript delimited-\u2225\u2225 \ud835\udc4b \ud835\udc4c \\left\\lVert\\Gamma^{k}(X)-\\Gamma^{k}(Y)\\right\\rVert_{\\infty}\\leq\\frac{(dM\\left\\lVert\\omega\\right\\rVert_{1-var})^{k}}{k!}\\left\\lVert X-Y\\right\\rVert_{\\infty} (88)\n\nthus definitely (in ) the map is a contraction. By Banach fixed point there exist a unique fixed point . \u220e\n\nTheorem E.2. Under the assumptions of the previous theorem one can write explicitly as\n\nW s , t = \u2211 I \u2208 \ud835\udcb2 d \u222b \u03c4 \u2208 \u0394 [ s , t ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f W_{s,t}=\\sum_{I\\in\\mathcal{W}_{d}}\\int_{\\tau\\in\\Delta^{|I|}_{[s,t]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau} (89)\n\nmoreover if for all the matrix-valued maps are constant on all i.e. then\n\nW s , t = \u2211 I \u2208 \ud835\udcb2 d A I \u200b Sig \u200b ( \u03c9 ) s , t I subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript \ud835\udc34 \ud835\udc3c Sig superscript subscript \ud835\udf14 \ud835\udc60 \ud835\udc61 \ud835\udc3c W_{s,t}=\\sum_{I\\in\\mathcal{W}_{d}}A_{I}\\text{Sig}(\\omega)_{s,t}^{I} (90)\n\nwhere is the Signature of the path . Proof. The second assertion follows from the first by definition of the Signature of a path. Regarding the first notice how the series is absolutely convergent in , uniformly in since\n\n\u2211 I \u2208 \ud835\udcb2 d \u2225 \u222b \u03c4 \u2208 \u0394 [ s , t ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I \u2225 o \u200b p \u2264 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript delimited-\u2225\u2225 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f \ud835\udc5c \ud835\udc5d absent \\displaystyle\\sum_{I\\in\\mathcal{W}_{d}}\\left\\lVert\\int_{\\tau\\in\\Delta^{|I|}_{[s,t]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau}\\right\\rVert_{op}\\leq \u2211 k = 0 \u221e d k \u200b M k \u200b \u2225 \u03c9 \u2225 1 \u2212 v \u200b a \u200b r , [ s , t ] k k ! superscript subscript \ud835\udc58 0 superscript \ud835\udc51 \ud835\udc58 superscript \ud835\udc40 \ud835\udc58 superscript subscript delimited-\u2225\u2225 \ud835\udf14 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f \ud835\udc60 \ud835\udc61 \ud835\udc58 \ud835\udc58 \\displaystyle\\sum_{k=0}^{\\infty}d^{k}M^{k}\\frac{\\left\\lVert\\omega\\right\\rVert_{1-var,[s,t]}^{k}}{k!} = \\displaystyle= e d \u200b M \u200b \u2225 \u03c9 \u2225 1 \u2212 v \u200b a \u200b r , [ s , t ] \u2264 e d \u200b M \u200b \u2225 \u03c9 \u2225 1 \u2212 v \u200b a \u200b r , [ 0 , 1 ] superscript \ud835\udc52 \ud835\udc51 \ud835\udc40 subscript delimited-\u2225\u2225 \ud835\udf14 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f \ud835\udc60 \ud835\udc61 superscript \ud835\udc52 \ud835\udc51 \ud835\udc40 subscript delimited-\u2225\u2225 \ud835\udf14 1 \ud835\udc63 \ud835\udc4e \ud835\udc5f 0 1 \\displaystyle e^{dM\\left\\lVert\\omega\\right\\rVert_{1-var,[s,t]}}\\leq e^{dM\\left\\lVert\\omega\\right\\rVert_{1-var,[0,1]}}\n\nthus for any the series defines an element of . Using the uniformity of this bound and the fact that for all one has\n\nW ~ s , t I := \u222b \u03c4 \u2208 \u0394 [ s , t ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I \u2208 \u03a9 assign superscript subscript ~ \ud835\udc4a \ud835\udc60 \ud835\udc61 \ud835\udc3c subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f \u03a9 \\tilde{W}_{s,t}^{I}:=\\int_{\\tau\\in\\Delta^{|I|}_{[s,t]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau}\\in\\Omega\n\nas a function of , which moreover is uniformly continuous\n\n\u2225 W ~ s 1 , t 1 I \u2212 W ~ s 2 , t 2 I \u2225 o \u200b p = subscript delimited-\u2225\u2225 superscript subscript ~ \ud835\udc4a subscript \ud835\udc60 1 subscript \ud835\udc61 1 \ud835\udc3c superscript subscript ~ \ud835\udc4a subscript \ud835\udc60 2 subscript \ud835\udc61 2 \ud835\udc3c \ud835\udc5c \ud835\udc5d absent \\displaystyle\\left\\lVert\\tilde{W}_{s_{1},t_{1}}^{I}-\\tilde{W}_{s_{2},t_{2}}^{I}\\right\\rVert_{op}= \u2225 \u222b \u03c4 \u2208 \u0394 [ s 1 \u2227 s 2 , t 1 \u2228 t 2 ] | I | ( \u03b4 \u03c4 \u2208 \u0394 [ s 1 , t 1 ] | I | \u2212 \u03b4 \u03c4 \u2208 \u0394 [ s 2 , t 2 ] | I | ) \u200b A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I \u2225 o \u200b p subscript delimited-\u2225\u2225 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 1 subscript \ud835\udc60 2 subscript \ud835\udc61 1 subscript \ud835\udc61 2 subscript \ud835\udeff \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 1 subscript \ud835\udc61 1 subscript \ud835\udeff \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 2 subscript \ud835\udc61 2 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f \ud835\udc5c \ud835\udc5d \\displaystyle\\left\\lVert\\int_{\\tau\\in\\Delta^{|I|}_{[s_{1}\\wedge s_{2},t_{1}\\vee t_{2}]}}(\\delta_{\\tau\\in\\Delta^{|I|}_{[s_{1},t_{1}]}}-\\delta_{\\tau\\in\\Delta^{|I|}_{[s_{2},t_{2}]}})A^{I}_{\\tau}d\\omega^{I}_{\\tau}\\right\\rVert_{op} \u2264 \\displaystyle\\leq M | I | \u200b \u222b \u03c4 \u2208 \u0394 [ s 1 \u2227 s 2 , t 1 \u2228 t 2 ] | I | | \u03b4 \u03c4 \u2208 \u0394 [ s 1 , t 1 ] | I | \u2212 \u03b4 \u03c4 \u2208 \u0394 [ s 2 , t 2 ] | I | | \u200b | d \u200b \u03c9 \u03c4 I | superscript \ud835\udc40 \ud835\udc3c subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 1 subscript \ud835\udc60 2 subscript \ud835\udc61 1 subscript \ud835\udc61 2 subscript \ud835\udeff \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 1 subscript \ud835\udc61 1 subscript \ud835\udeff \ud835\udf0f subscript superscript \u0394 \ud835\udc3c subscript \ud835\udc60 2 subscript \ud835\udc61 2 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f \\displaystyle M^{|I|}\\int_{\\tau\\in\\Delta^{|I|}_{[s_{1}\\wedge s_{2},t_{1}\\vee t_{2}]}}\\left|\\delta_{\\tau\\in\\Delta^{|I|}_{[s_{1},t_{1}]}}-\\delta_{\\tau\\in\\Delta^{|I|}_{[s_{2},t_{2}]}}\\right||d\\omega^{I}_{\\tau}| \u2264 \\displaystyle\\leq M | I | \u200b \u2225 \u03c9 \u2225 [ s 1 \u2227 s 2 , s 1 \u2228 s 2 ] \u222a [ t 1 \u2227 t 2 , t 1 \u2228 t 2 ] | I | , superscript \ud835\udc40 \ud835\udc3c subscript superscript delimited-\u2225\u2225 \ud835\udf14 \ud835\udc3c subscript \ud835\udc60 1 subscript \ud835\udc60 2 subscript \ud835\udc60 1 subscript \ud835\udc60 2 subscript \ud835\udc61 1 subscript \ud835\udc61 2 subscript \ud835\udc61 1 subscript \ud835\udc61 2 \\displaystyle M^{|I|}{\\left\\lVert\\omega\\right\\rVert^{|I|}_{[s_{1}\\wedge s_{2},s_{1}\\vee s_{2}]\\cup[t_{1}\\wedge t_{2},t_{1}\\vee t_{2}]}},\n\none concludes that . Finally notice that is a fixed point of\n\n\u0393 \u200b ( W ~ s , t ) = \u0393 subscript ~ \ud835\udc4a \ud835\udc60 \ud835\udc61 absent \\displaystyle\\Gamma(\\tilde{W}_{s,t})= I \u200b d N + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b ( \u2211 I \u2208 \ud835\udcb2 d \u222b \u03c4 \u2208 \u0394 [ 0 , 1 ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I ) \u200b \ud835\udc51 \u03c9 \u03c4 i \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c 0 1 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\displaystyle Id_{N}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}\\left(\\sum_{I\\in\\mathcal{W}_{d}}\\int_{\\tau\\in\\Delta^{|I|}_{[0,1]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau}\\right)d\\omega^{i}_{\\tau} = \\displaystyle= I \u200b d N + \u2211 I \u2208 \ud835\udcb2 d | I | \u2265 1 \u222b \u03c4 \u2208 \u0394 [ 0 , 1 ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 i \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 \ud835\udc3c 1 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c 0 1 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\displaystyle Id_{N}+\\sum_{\\begin{subarray}{c}I\\in\\mathcal{W}_{d}\\\\\n|I|\\geq 1\\end{subarray}}\\int_{\\tau\\in\\Delta^{|I|}_{[0,1]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau}d\\omega^{i}_{\\tau} = \\displaystyle= \u2211 I \u2208 \ud835\udcb2 d \u222b \u03c4 \u2208 \u0394 [ 0 , 1 ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I = W ~ s , t subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c 0 1 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f subscript ~ \ud835\udc4a \ud835\udc60 \ud835\udc61 \\displaystyle\\sum_{I\\in\\mathcal{W}_{d}}\\int_{\\tau\\in\\Delta^{|I|}_{[0,1]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau}=\\tilde{W}_{s,t}\n\nand conclude by uniqueness. \u220e\n\nProposition E.3. Under the previous conditions, the unique solution of the -dimensional CDE\n\nd \u200b X t = X 0 + \u2211 i = 1 d \u222b \u03c4 = 0 t A \u03c4 i \u200b X \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i \ud835\udc51 subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f 0 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4b \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f dX_{t}=X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=0}^{t}A^{i}_{\\tau}X_{\\tau}d\\omega^{i}_{\\tau} (91)\n\nis given by\n\nX t = W 0 , t \u200b X 0 subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4a 0 \ud835\udc61 subscript \ud835\udc4b 0 X_{t}=W_{0,t}X_{0} (92)\n\nProof. The solutions are unique by standard results (Friz & Victoir, 2010)[Thm. 3.7], moreover\n\nW 0 , t \u200b X 0 = subscript \ud835\udc4a 0 \ud835\udc61 subscript \ud835\udc4b 0 absent \\displaystyle W_{0,t}X_{0}= ( I \u200b d N + \u2211 i = 1 d \u222b \u03c4 = 0 t A \u03c4 i \u200b W 0 , \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i ) \u200b X 0 = X 0 + \u2211 i = 1 d \u222b \u03c4 = 0 t A \u03c4 i \u200b ( W 0 , \u03c4 \u200b X 0 ) \u200b \ud835\udc51 \u03c9 \u03c4 i \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f 0 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4a 0 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4b 0 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f 0 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4a 0 \ud835\udf0f subscript \ud835\udc4b 0 differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\displaystyle\\left(Id_{N}+\\sum_{i=1}^{d}\\int_{\\tau=0}^{t}A_{\\tau}^{i}W_{0,\\tau}d\\omega^{i}_{\\tau}\\right)X_{0}=X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=0}^{t}A_{\\tau}^{i}(W_{0,\\tau}X_{0})d\\omega^{i}_{\\tau}\n\nProposition E.4. The Wronskian matrix has the following properties:\n\n1.",
    "theoryssms-43": "2. 3. Proof. Regarding the first statement notice that for all one has\n\nX ~ t := assign subscript ~ \ud835\udc4b \ud835\udc61 absent \\displaystyle\\tilde{X}_{t}:= W s , t \u200b W r , s \u200b X 0 = ( I \u200b d N + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b W s , \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i ) \u200b W r , s \u200b X 0 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4a \ud835\udc5f \ud835\udc60 subscript \ud835\udc4b 0 \ud835\udc3c subscript \ud835\udc51 \ud835\udc41 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4a \ud835\udc60 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4a \ud835\udc5f \ud835\udc60 subscript \ud835\udc4b 0 \\displaystyle W_{s,t}W_{r,s}X_{0}=\\left(Id_{N}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}W_{s,\\tau}d\\omega^{i}_{\\tau}\\right)W_{r,s}X_{0} = \\displaystyle= W r , s \u200b X 0 + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b ( W s , \u03c4 \u200b W r , s \u200b X 0 ) \u200b \ud835\udc51 \u03c9 \u03c4 i subscript \ud835\udc4a \ud835\udc5f \ud835\udc60 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4a \ud835\udc60 \ud835\udf0f subscript \ud835\udc4a \ud835\udc5f \ud835\udc60 subscript \ud835\udc4b 0 differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\displaystyle W_{r,s}X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}(W_{s,\\tau}W_{r,s}X_{0})d\\omega^{i}_{\\tau} = \\displaystyle= W r , s \u200b X 0 + \u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b X ~ \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i subscript \ud835\udc4a \ud835\udc5f \ud835\udc60 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript ~ \ud835\udc4b \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f \\displaystyle W_{r,s}X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A_{\\tau}^{i}\\tilde{X}_{\\tau}d\\omega^{i}_{\\tau}\n\nand by the previous proposition also\n\nX t := W r , t \u200b X 0 = W r , t \u200b X 0 + \u2211 i = 1 d \u222b \u03c4 = r t A \u03c4 i \u200b X \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i assign subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4a \ud835\udc5f \ud835\udc61 subscript \ud835\udc4b 0 subscript \ud835\udc4a \ud835\udc5f \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc5f \ud835\udc61 superscript subscript \ud835\udc34 \ud835\udf0f \ud835\udc56 subscript \ud835\udc4b \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f X_{t}:=W_{r,t}X_{0}=W_{r,t}X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=r}^{t}A_{\\tau}^{i}X_{\\tau}d\\omega^{i}_{\\tau}\n\nthus and solve the same and coincide at time . This means, by uniqueness, that and coincide for all times; hence and coincide for all times too since for any choice of one has . The second statement follows from the previous one setting first and subsequently exchanging and . To prove the third equality note that\n\n0 = d s \u200b ( W s , t \u200b W t , s ) = ( d s \u200b W s , t ) \u200b W t , s + W s , t \u200b ( d s \u200b W t , s ) 0 subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 0=d_{s}(W_{s,t}W_{t,s})=(d_{s}W_{s,t})W_{t,s}+W_{s,t}(d_{s}W_{t,s})\n\nhence\n\nd s \u200b W s , t = \u2212 W s , t \u200b ( d s \u200b W t , s ) \u200b W t , s \u2212 1 = \u2212 W s , t \u200b ( \u2211 i = 1 d A s i \u200b W t , s \u200b d \u200b \u03c9 s i ) \u200b W t , s \u2212 1 = \u2212 \u2211 i = 1 d W s , t \u200b A s i \u200b d \u200b \u03c9 s i subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 superscript subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 1 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 \ud835\udc51 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udc60 subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 superscript subscript \ud835\udc4a \ud835\udc61 \ud835\udc60 1 superscript subscript \ud835\udc56 1 \ud835\udc51 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 d_{s}W_{s,t}=-W_{s,t}(d_{s}W_{t,s})W_{t,s}^{-1}=-W_{s,t}(\\sum_{i=1}^{d}A^{i}_{s}W_{t,s}d\\omega^{i}_{s})W_{t,s}^{-1}=-\\sum_{i=1}^{d}W_{s,t}A^{i}_{s}d\\omega^{i}_{s}\n\nProposition E.5 (Liouville\u2019s Formula). Under the assumptions of the previous theorems, if then\n\nd \u200b e \u200b t \u200b ( W s , t ) = 1 + \u2211 i = 1 d \u222b \u03c4 = s t t \u200b r \u200b ( A \u03c4 i ) \u200b \ud835\udc51 e \u200b t \u200b ( W s , t ) \u200b \ud835\udc51 \u03c9 \u03c4 i = exp \u2061 ( \u2211 i = 1 d \u222b \u03c4 = s t t \u200b r \u200b ( A \u03c4 i ) \u200b \ud835\udc51 \u03c9 \u03c4 i ) \ud835\udc51 \ud835\udc52 \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 1 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 \ud835\udc61 \ud835\udc5f subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f differential-d \ud835\udc52 \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 \ud835\udc61 \ud835\udc5f subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f det(W_{s,t})=1+\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}tr(A^{i}_{\\tau})det(W_{s,t})d\\omega^{i}_{\\tau}=\\exp\\left(\\sum_{i=1}^{d}\\int_{\\tau=s}^{t}tr(A^{i}_{\\tau})d\\omega^{i}_{\\tau}\\right) (93)\n\nProof. This just follows from the classical case since we can write\n\n\u2211 i = 1 d \u222b \u03c4 = s t A \u03c4 i \u200b W s , \u03c4 \u200b \ud835\udc51 \u03c9 \u03c4 i = \u222b \u03c4 = s t ( \u2211 i = 1 d A \u03c4 i \u200b \u03c9 \u02d9 \u03c4 i ) \u200b W s , \u03c4 \u200b \ud835\udc51 \u03c4 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4a \ud835\udc60 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f superscript subscript \ud835\udf0f \ud835\udc60 \ud835\udc61 superscript subscript \ud835\udc56 1 \ud835\udc51 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f subscript superscript \u02d9 \ud835\udf14 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4a \ud835\udc60 \ud835\udf0f differential-d \ud835\udf0f \\sum_{i=1}^{d}\\int_{\\tau=s}^{t}A^{i}_{\\tau}W_{s,\\tau}d\\omega^{i}_{\\tau}=\\int_{\\tau=s}^{t}\\left(\\sum_{i=1}^{d}A^{i}_{\\tau}\\dot{\\omega}^{i}_{\\tau}\\right)W_{s,\\tau}d\\tau\n\nWe can now state the main result of the section:\n\nTheorem E.6. Under the assumptions of the previous theorems, given continuous functions the unique solution of the -dimensional CDE\n\nX t = X 0 + \u2211 i = 1 d \u222b \u03c4 = 0 t ( A \u03c4 i \u200b X \u03c4 + B \u03c4 i ) \u200b \ud835\udc51 \u03c9 \u03c4 i subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udf0f 0 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udf0f subscript \ud835\udc4b \ud835\udf0f subscript superscript \ud835\udc35 \ud835\udc56 \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udf0f X_{t}=X_{0}+\\sum_{i=1}^{d}\\int_{\\tau=0}^{t}\\left(A^{i}_{\\tau}X_{\\tau}+B^{i}_{\\tau}\\right)d\\omega^{i}_{\\tau} (94)\n\nis given explicitly by\n\nX t = W 0 , t \u200b X 0 + \u2211 i = 1 d \u222b 0 t W s , t \u200b B s i \u200b \ud835\udc51 \u03c9 s i subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4a 0 \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc35 \ud835\udc56 \ud835\udc60 differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 X_{t}=W_{0,t}X_{0}+\\sum_{i=1}^{d}\\int_{0}^{t}W_{s,t}B^{i}_{s}d\\omega^{i}_{s} (95)\n\nwhere is the Wronskian matrix defined by\n\nW s , t = \u2211 I \u2208 \ud835\udcb2 d \u222b \u03c4 \u2208 \u0394 [ s , t ] | I | A \u03c4 I \u200b \ud835\udc51 \u03c9 \u03c4 I subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc3c subscript \ud835\udcb2 \ud835\udc51 subscript \ud835\udf0f subscript superscript \u0394 \ud835\udc3c \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc3c \ud835\udf0f differential-d subscript superscript \ud835\udf14 \ud835\udc3c \ud835\udf0f W_{s,t}=\\sum_{I\\in\\mathcal{W}_{d}}\\int_{\\tau\\in\\Delta^{|I|}_{[s,t]}}A^{I}_{\\tau}d\\omega^{I}_{\\tau} (96)\n\nProof. Given the unique solution one has\n\nd s \u200b ( W s , t \u200b X s ) = subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4b \ud835\udc60 absent \\displaystyle d_{s}(W_{s,t}X_{s})= d s \u200b ( W s , t ) \u200b X s + W s , t \u200b d s \u200b ( X s ) subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4b \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc51 \ud835\udc60 subscript \ud835\udc4b \ud835\udc60 \\displaystyle d_{s}(W_{s,t})X_{s}+W_{s,t}d_{s}(X_{s}) = \\displaystyle= \u2211 i = 1 d ( \u2212 W s , t \u200b A s i \u200b X s + W s , t \u200b A s i \u200b X s + W s , t \u200b B s i ) \u200b d \u200b \u03c9 s i superscript subscript \ud835\udc56 1 \ud835\udc51 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udc60 subscript \ud835\udc4b \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc34 \ud835\udc56 \ud835\udc60 subscript \ud835\udc4b \ud835\udc60 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc35 \ud835\udc56 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d}\\left(-W_{s,t}A^{i}_{s}X_{s}+W_{s,t}A^{i}_{s}X_{s}+W_{s,t}B^{i}_{s}\\right)d\\omega^{i}_{s} = \\displaystyle= \u2211 i = 1 d W s , t \u200b B s i \u200b d \u200b \u03c9 s i superscript subscript \ud835\udc56 1 \ud835\udc51 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc35 \ud835\udc56 \ud835\udc60 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 \\displaystyle\\sum_{i=1}^{d}W_{s,t}B^{i}_{s}d\\omega^{i}_{s}\n\nhence\n\nX t \u2212 W 0 , t \u200b X 0 = W t , t \u200b X t \u2212 W 0 , t \u200b X 0 = \u2211 i = 1 d \u222b s = 0 t W s , t \u200b B s i \u200b \ud835\udc51 \u03c9 s i subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4a 0 \ud835\udc61 subscript \ud835\udc4b 0 subscript \ud835\udc4a \ud835\udc61 \ud835\udc61 subscript \ud835\udc4b \ud835\udc61 subscript \ud835\udc4a 0 \ud835\udc61 subscript \ud835\udc4b 0 superscript subscript \ud835\udc56 1 \ud835\udc51 superscript subscript \ud835\udc60 0 \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript superscript \ud835\udc35 \ud835\udc56 \ud835\udc60 differential-d subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc60 X_{t}-W_{0,t}X_{0}=W_{t,t}X_{t}-W_{0,t}X_{0}=\\sum_{i=1}^{d}\\int_{s=0}^{t}W_{s,t}B^{i}_{s}d\\omega^{i}_{s}\n\nAppendix F ZOH and Exact Solutions\n\nConsider a linear CDE as the one of Eqn.(28)\n\nd \u200b Z t = \u2211 i = 1 d \u03c9 A i \u200b Z t \u200b d \u200b \u03c9 t i + B \u200b d \u200b \u03be t \ud835\udc51 subscript \ud835\udc4d \ud835\udc61 superscript subscript \ud835\udc56 1 subscript \ud835\udc51 \ud835\udf14 subscript \ud835\udc34 \ud835\udc56 subscript \ud835\udc4d \ud835\udc61 \ud835\udc51 subscript superscript \ud835\udf14 \ud835\udc56 \ud835\udc61 \ud835\udc35 \ud835\udc51 subscript \ud835\udf09 \ud835\udc61 dZ_{t}=\\sum_{i=1}^{d_{\\omega}}A_{i}Z_{t}d\\omega^{i}_{t}+Bd\\xi_{t}\n\nand recall how the solution can be explicitly written, for times , as\n\nZ t = W s , t \u200b Z s + \u222b s t W r , t \u200b B \u200b \ud835\udc51 \u03be r subscript \ud835\udc4d \ud835\udc61 subscript \ud835\udc4a \ud835\udc60 \ud835\udc61 subscript \ud835\udc4d \ud835\udc60 superscript subscript \ud835\udc60 \ud835\udc61 subscript \ud835\udc4a \ud835\udc5f \ud835\udc61 \ud835\udc35 differential-d subscript \ud835\udf09 \ud835\udc5f Z_{t}=W_{s,t}Z_{s}+\\int_{s}^{t}W_{r,t}Bd\\xi_{r}\n\nAssume moreover that in the interval both drivers have constant derivative i.e. \u03c9 r = \u03c9 s + \ud835\udc98 \u200b ( r \u2212 s ) \u03be r = \u03be s + \ud835\udc97 \u200b ( r \u2212 s ) formulae-sequence subscript \ud835\udf14 \ud835\udc5f subscript \ud835\udf14 \ud835\udc60 \ud835\udc98 \ud835\udc5f \ud835\udc60 subscript \ud835\udf09 \ud835\udc5f subscript \ud835\udf09 \ud835\udc60 \ud835\udc97 \ud835\udc5f \ud835\udc60 \\omega_{r}=\\omega_{s}+\\boldsymbol{w}(r-s)\\quad\\xi_{r}=\\xi_{s}+\\boldsymbol{v}(r-s)\n\nThen if we get that thus\n\nZ t = e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 s ) \u200b Z s + \u222b s t e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 r ) \u200b B \u200b \ud835\udc97 \u200b \ud835\udc51 r = e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 s ) \u200b Z s + ( \u222b s t e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 r ) \u200b \ud835\udc51 r ) \u200b B \u200b \ud835\udc97 subscript \ud835\udc4d \ud835\udc61 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc60 subscript \ud835\udc4d \ud835\udc60 superscript subscript \ud835\udc60 \ud835\udc61 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc5f \ud835\udc35 \ud835\udc97 differential-d \ud835\udc5f superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc60 subscript \ud835\udc4d \ud835\udc60 superscript subscript \ud835\udc60 \ud835\udc61 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc5f differential-d \ud835\udc5f \ud835\udc35 \ud835\udc97 Z_{t}=e^{\\mathbb{A}_{\\boldsymbol{w}}(t-s)}Z_{s}+\\int_{s}^{t}e^{\\mathbb{A}_{\\boldsymbol{w}}(t-r)}B\\boldsymbol{v}dr=e^{\\mathbb{A}_{\\boldsymbol{w}}(t-s)}Z_{s}+\\left(\\int_{s}^{t}e^{\\mathbb{A}_{\\boldsymbol{w}}(t-r)}dr\\right)B\\boldsymbol{v} (97)\n\nBut the integral can be explicitly solved as\n\n\u222b s t e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 r ) d r = ( \u2212 \ud835\udd38 \ud835\udc98 \u2212 1 e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 r ) | r = s t = \ud835\udd38 \ud835\udc98 \u2212 1 ( e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 s ) \u2212 \ud835\udd40 ) \\int_{s}^{t}e^{\\mathbb{A}_{\\boldsymbol{w}}(t-r)}dr=\\left(-\\mathbb{A}_{\\boldsymbol{w}}^{-1}e^{\\mathbb{A}_{\\boldsymbol{w}}(t-r)}\\right|_{r=s}^{t}=\\mathbb{A}_{\\boldsymbol{w}}^{-1}\\left(e^{\\mathbb{A}_{\\boldsymbol{w}}(t-s)}-\\mathbb{I}\\right) (98)\n\nleaving us with\n\nZ t = e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 s ) \u200b Z s + \ud835\udd38 \ud835\udc98 \u2212 1 \u200b ( e \ud835\udd38 \ud835\udc98 \u200b ( t \u2212 s ) \u2212 \ud835\udd40 ) \u200b B \u200b \ud835\udc97 subscript \ud835\udc4d \ud835\udc61 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc60 subscript \ud835\udc4d \ud835\udc60 superscript subscript \ud835\udd38 \ud835\udc98 1 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \ud835\udc61 \ud835\udc60 \ud835\udd40 \ud835\udc35 \ud835\udc97 Z_{t}=e^{\\mathbb{A}_{\\boldsymbol{w}}(t-s)}Z_{s}+\\mathbb{A}_{\\boldsymbol{w}}^{-1}\\left(e^{\\mathbb{A}_{\\boldsymbol{w}}(t-s)}-\\mathbb{I}\\right)B\\boldsymbol{v} (99)\n\nwhich, setting , can be rewritten as\n\nZ t = e \ud835\udd38 \ud835\udc98 \u200b \u0394 \u200b Z s + ( \ud835\udd38 \ud835\udc98 \u200b \u0394 ) \u2212 1 \u200b ( e \ud835\udd38 \ud835\udc98 \u200b \u0394 \u2212 \ud835\udd40 ) \u200b ( B \u200b \u0394 ) \u200b \ud835\udc97 subscript \ud835\udc4d \ud835\udc61 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \u0394 subscript \ud835\udc4d \ud835\udc60 superscript subscript \ud835\udd38 \ud835\udc98 \u0394 1 superscript \ud835\udc52 subscript \ud835\udd38 \ud835\udc98 \u0394 \ud835\udd40 \ud835\udc35 \u0394 \ud835\udc97 Z_{t}=e^{\\mathbb{A}_{\\boldsymbol{w}}\\Delta}Z_{s}+(\\mathbb{A}_{\\boldsymbol{w}}\\Delta)^{-1}\\left(e^{\\mathbb{A}_{\\boldsymbol{w}}\\Delta}-\\mathbb{I}\\right)(B\\Delta)\\boldsymbol{v} (100)\n\ni.e.",
    "theoryssms-44": "exactly the ZOH scheme. \u25c4 Feeling lucky? Conversion report Report an issue View original on arXiv\u25ba\n\nCopyright Privacy Policy\n\nGenerated on Tue Mar 5 18:20:14 2024 by LaTeXML"
}